[
    {
        "id": "quw3kN7Y3mh",
        "original": null,
        "number": 1,
        "cdate": 1665760702797,
        "mdate": null,
        "ddate": null,
        "tcdate": 1665760702797,
        "tmdate": 1665760702797,
        "tddate": null,
        "forum": "r0otLtOwYW",
        "replyto": "r0otLtOwYW",
        "invitation": "ICLR.cc/2023/Conference/Paper2730/-/Official_Review",
        "content": {
            "confidence": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work.",
            "summary_of_the_paper": "The authors present an energy-guided score model formulation for the task of equivariantly generating molecules. This work builds upon lots of recent references on SDE score matching models, equivariant networks (EGNNs) and specifically the work of Hoogeboom et al (2022), EDM. The main contribution of the paper is the addition of an energy function in the score matching algorithm, which can be used to generate molecules with desired properties.",
            "strength_and_weaknesses": "Overall, the paper is somewhat incremetal but in general technically sound and a pleasure to read.\n\nStrengths:\n* Clear motivation to solve a real problem (inverse molecular design)\n* A lot of effort went into explaining previous methods. This is a fantastic introductory paper that requires no reference reading for context.\n* Simple and elegant formulation\n* Code provided in the supplementary material\n\nWeaknesses:\n* Main results on Tables 1, 2, 3 could be provided with standard deviations to assess how stable results are depending on the chosen seed\n* Supplied code could be cleaned / improved with clearer instructions on how to run the experiments in the paper.\n\nOther comments:\n\n* It would be fantastic if the authors physically motivated the choice for using energy functions (Eq. 6). The reverse SDE is presented without a lot of justification\n* In Section 6 the authors claim that they tried a binary cross-entropy loss for generating molecules with desired structures, but ended up using a mean squared error loss. In Appendix D, however, the binary cross entropy is the one described for this task.\n* It is somewhat unclear to me whether the time-dependent property prediction model is jointly trained with the score model or whether this is trained separately. It would be great if the authors could clarify along these lines.",
            "clarity,_quality,_novelty_and_reproducibility": "The paper is clearly written and provides a thorough related work section to help understand the main contribution of the paper (inverse molecular design).\n\nNovelty-wise this work is somewhat incremental, as it builds on a lot of recent work (e.g. SDE formulation of denoising diffusion models, EGNNs) although to the best of my knowledge it is the first to propose how to do inverse molecular design with these.\n\nThe authors provide code in the supplementary information to reproduce some of the experiments, although the quality of the code could significantly be improved. ",
            "summary_of_the_review": "Overall, this is a good contribution to ICLR. Although the approach is marginally incremental, I believe the work is novel and shows how to tackle a fundamental problem in atomistic ML, how perform inverse molecular design using denoising diffusion models on a regression setting.\n\nI would recommend acceptance upon revision of several minor issues.",
            "correctness": "4: All of the claims and statements are well-supported and correct.",
            "technical_novelty_and_significance": "4: The contributions are significant, and do not exist in prior works.",
            "empirical_novelty_and_significance": "2: The contributions are only marginally significant or novel.",
            "flag_for_ethics_review": [
                "NO."
            ],
            "recommendation": "8: accept, good paper"
        },
        "signatures": [
            "ICLR.cc/2023/Conference/Paper2730/Reviewer_1ipW"
        ],
        "readers": [
            "everyone"
        ],
        "nonreaders": [],
        "writers": [
            "ICLR.cc/2023/Conference",
            "ICLR.cc/2023/Conference/Paper2730/Reviewer_1ipW"
        ]
    },
    {
        "id": "bfwngiOlXN8",
        "original": null,
        "number": 2,
        "cdate": 1666408501979,
        "mdate": null,
        "ddate": null,
        "tcdate": 1666408501979,
        "tmdate": 1670960297577,
        "tddate": null,
        "forum": "r0otLtOwYW",
        "replyto": "r0otLtOwYW",
        "invitation": "ICLR.cc/2023/Conference/Paper2730/-/Official_Review",
        "content": {
            "confidence": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked.",
            "summary_of_the_paper": "This paper proposes a new diffusion model for generating 3D molecules using the guidance energy function. In order to incorporate various energy functions into the proposed framework, the authors theoretically demonstrate that those functions are invariant to transformations, which is an essential feature for 3D molecule representations. The proposed model outperforms its predecessor by a wide margin. Additionally, the representation makes it easier to comprehend how the model performs as intended.",
            "strength_and_weaknesses": "[Strength]\n* Incorporating energy functions is well supported by the theories.\n* In the task of generating molecules with desired quantum properties, the proposed framework significantly improves its baseline, EDM. \n* The paper is easy to read and well organized.\n* The visualizations help to understand how the model behaves in different settings.\n\n\n[Weaknesses]\n* Although their approach is novel, the core model relies on the existing model EDM with just adding energy functions.\n* EDM seems to be generating more stable molecules. Insights behind this would be helpful.\n* Why not compare the model by Gebauer et al. 2022 in the task of generating molecules with target structures? This task seems to be motivated by that paper. \n* The authors, however, include EDM as a baseline. How did you create a molecule with target structures using EDM? This comparison appears to be unfair because there are no explicit terms for target structures in EDM.\n",
            "clarity,_quality,_novelty_and_reproducibility": "* The paper is easy to read and well organized.\n* The energy function is novel, while the other parts appear to be adaptations of existing ones.\n\n",
            "summary_of_the_review": "Despite the fact that the novel part is minor, it is theoretically supported, which is a plus. However, generating molecules with target structures appears to be unfair and requires improvement.",
            "correctness": "2: Several of the paper\u2019s claims are incorrect or not well-supported.",
            "technical_novelty_and_significance": "2: The contributions are only marginally significant or novel.",
            "empirical_novelty_and_significance": "Not applicable",
            "flag_for_ethics_review": [
                "NO."
            ],
            "recommendation": "6: marginally above the acceptance threshold"
        },
        "signatures": [
            "ICLR.cc/2023/Conference/Paper2730/Reviewer_ZV34"
        ],
        "readers": [
            "everyone"
        ],
        "nonreaders": [],
        "writers": [
            "ICLR.cc/2023/Conference",
            "ICLR.cc/2023/Conference/Paper2730/Reviewer_ZV34"
        ]
    },
    {
        "id": "cvOlhFu-tGU",
        "original": null,
        "number": 3,
        "cdate": 1666551639205,
        "mdate": null,
        "ddate": null,
        "tcdate": 1666551639205,
        "tmdate": 1668744454035,
        "tddate": null,
        "forum": "r0otLtOwYW",
        "replyto": "r0otLtOwYW",
        "invitation": "ICLR.cc/2023/Conference/Paper2730/-/Official_Review",
        "content": {
            "confidence": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work.",
            "summary_of_the_paper": "The paper proposes a new method for 3D molecular generation called energy-guided stochastic differential equations (EEGSDE), which introduces an equivariant diffusion model based on SDE formulations. The authors first introduce the problem setting of 3D molecular design, as well as past work in molecular design and related work including diffusion models and guidance of diffusion models. Subsequently, the paper introduces relevant background and formulations (3D molecule representation, equivariance and Center of Mass modeling) and outlines the mathematical details of EEG-SDE, including the SDE formulation and an extension for an equivariant SDE formulation based on an equivariant neural network backbone (EGNN). After outlining the entire algorithmic flow with all relevant and priorly introduced components, the authors introduce a set of molecular design experiments based primarily on the QM9 dataset.\n\nIn their experiments, the authors first train EEG-SDE on the QM9 dataset and compare it's performance to equivariant diffusion models (EDM) along a couple of metrics (MAE, Novelty, Atomic Stability, Molecular Stability). In their formulation, the authors also include a scaling factor, $s$, which serves to modulate the strength of a given loss signal and is varied in many of the authors' experiments. The first set of presented results show general competitiveness with EDM with outperformance along some metrics and lower performance on others. The authors then show an experiment generating molecules based on a target structure where the similarity of the generated molecule to the target structure is based on a molecular fingerprint. Based on the similarity metric EEG-SDE appears to outperform SDE.",
            "strength_and_weaknesses": "**Strengths**\n\n* The paper introduces a new equivariant molecular diffusion method and describes the different pieces, including various definitions and formulations, in great detail. \n* The results presented in the experiments seem to indicate some advantages of using EEG-SDE compared to EDM.\n\n**Weaknesses**\n\n* Some of the figures, especially Figure 1 and Figure 4, could benefit from greater detail to the overall message they are trying to convey. In Figure 1, the different images could have additional labels to guide the reader as to what the different sections represent. In Figure 4, it is unclear what the authors are trying to show with the caption not being clear about the purpose and it being hard accompanying text being hard to find.\n* The results on the GEOM-Drug dataset are only briefly mentioned in the text. It would have been nice to see them included in more cohesive manner, potentially in one of the prior tables. \n* The overall message from the results is somewhat unclear. It would be nice if the paper could summarize some key takeways for EEGSDE based on the results of the experiments?\n\n**Additional Questions**\n\n* Fitting to properties appears to be applicable to one property at a time given the scalar signal. How does the multi-property case shown in Figure 4 work in that instance? Is it mainly a loss over a vector? If so, how is it implemented?\n* Did you consider trying other equivariant models (SE3-Transformer, DimeNet, etc)? Why, why not?\n* It would good to have the definitions for the metrics in Table 1 and Table 2 (Similarity, Novelty, Atomic Stability (AS), Molecular Stability (MS)). Putting them in the appendix is fine.\n* What is the distinction between EDM and this method? A clear distinction would provide more clarity on the novelty - from what I can tell it is the inclusion of SDE formulation. As such, it would be good to clarify the difference between SDE and diffusion models in general terms first. Section 4.1 has SDE definitions, but not a contrast to standard diffusion.\n* How would you compare your work to Torsion Diffusion (Jing, Bowen, et al. \"Torsional Diffusion for Molecular Conformer Generation.\" arXiv preprint arXiv:2206.01729 (2022).)?\n* Could you provide more details on the molecular fingerprint - how does it capture 3D similarity related to positions?",
            "clarity,_quality,_novelty_and_reproducibility": "**Clarity**\n\nClarity in the formulation is detailed and well-written. I think clarity in the results can be improved as indicated in the above sections.\n\n**Quality**\n\nQuality of the presented experiments appears to done well. The general results sections could be improved by adding clearer conclusions based on the experiments.\n\n**Novelty**\n\nWhile the authors introduce a novel equivariant diffusion formulation, it does appear to be a bit incremental from the work performed by EDM which is the primary baseline the authors compare to.\n\n**Reproducibility** \n\nThe authors provide a good amount of detail in their detail and appendix along with a reproducibility statement. ",
            "summary_of_the_review": "While I appreciated the thoroughness of the description of the method and all its different parts, in my view the reasons to reject outweigh the reasons to accept the paper in its current form. The novelty appears a bit incremental compared to EDM and the presentation of the methods and results is a bit unclear to be able to see clear differentiation. \n\n------\nScore revised from 5 -> 6 based on discussion and adjustments made during author response.",
            "correctness": "3: Some of the paper\u2019s claims have minor issues. A few statements are not well-supported, or require small changes to be made correct.",
            "technical_novelty_and_significance": "2: The contributions are only marginally significant or novel.",
            "empirical_novelty_and_significance": "2: The contributions are only marginally significant or novel.",
            "flag_for_ethics_review": [
                "NO."
            ],
            "recommendation": "6: marginally above the acceptance threshold"
        },
        "signatures": [
            "ICLR.cc/2023/Conference/Paper2730/Reviewer_ChXk"
        ],
        "readers": [
            "everyone"
        ],
        "nonreaders": [],
        "writers": [
            "ICLR.cc/2023/Conference",
            "ICLR.cc/2023/Conference/Paper2730/Reviewer_ChXk"
        ]
    },
    {
        "id": "W7aK_4PM2l",
        "original": null,
        "number": 4,
        "cdate": 1667211110629,
        "mdate": null,
        "ddate": null,
        "tcdate": 1667211110629,
        "tmdate": 1670599962583,
        "tddate": null,
        "forum": "r0otLtOwYW",
        "replyto": "r0otLtOwYW",
        "invitation": "ICLR.cc/2023/Conference/Paper2730/-/Official_Review",
        "content": {
            "confidence": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work.",
            "summary_of_the_paper": "In this work, the authors present an extension of equivariant Diffusion Models (as presented by Hoogeboom et al.) for conditional molecular generation. The method, named \u201cEquivariant Energy-Guided SDE\u201d (EEGSDE), introduces an additional property prediction network that acts as a guiding force in the generation process. The property prediction network is trained in parallel with the reverse diffusion process, and the network's gradient is taken to be the additional force. \n\nThe authors evaluate their conditional generation on multiple metrics\u2014generation novelty, atom stability, molecule stability and the mean absolute error given by the trained property classifier. Under these metrics, the main improvement of the work is in terms of MAE and novelty, with the note that it is unclear how representative the novelty metrics are due to the training procedure of the prediction network. ",
            "strength_and_weaknesses": "With their proposed method the authors tackle the currently relevant and exciting problem of conditional molecular generation. The explicit focus on conditional generation is an important contribution to the molecular design space. The paper is very well structured and sufficiently places their contribution in the context of prior work on diffusion models. Although, this connection could be strengthened by making this connection explicit in the name of the method (eg. Equivariant Energy-Guided Diffusion Models). \n\nHowever, there are a number of issues with the paper that I would like to see addressed:\n\n1. Conceptually, how does the conditional generation using the prediction method differ from the conditional generation as done by Hoogeboom et al. Most importantly, what are the differences between conditional samples generated by the presented method and the EDM method? \n2. I believe it would be interesting/needed to include a note as to why the loaded term \u201cEnergy Model\u201d is used to refer to the property prediction model. Aside from the gradient of the property prediction network being used as a guiding force, I do not see any direct relation between the MSE loss and the molecular energy. Using the term \u201cEnergy\u201d in this context might give the reader the impression some form of potential energy or free energy guidance is used. \n3. It is unclear to me how representative the MAE as a metric for evaluation is. Am I correct in assuming that the trained property prediction model of the presented method is used to evaluate the others? \n4. Related, it would be good if the authors could clarify how representative the current novelty scores are and which subsets of the dataset are used for calculating the novelty score for each model. As I understand it, only a subset of the data is used and as such the novelty score should be inflated compared to when using the entire dataset. Contrary to this expectation, the novelty score for the SDM method seems lower than presented in the original paper (Table 2 of Hoogeboom et al.)\n5. Also related, I\u2019m unsure about how representative atom stability and molecular stability are as a metric. Especially in the context of this work where the bonds have to be estimated heuristically. \n",
            "clarity,_quality,_novelty_and_reproducibility": "Clarity: The paper is well-structured and very readable\nQuality: The paper is of high quality in the sense of how the algorithms, tables and figures are organised and presented. \nNovelty: The authors primarily build their work on Equivariant Diffusion models. The introduction of the property prediction process as a guiding force seems however relatively novel. The extent to which this is an effective addition is however unclear at this moment in time.\nReproducibility: Clear training details are missing in the main body of the paper. Code is however made available. ",
            "summary_of_the_review": "At this moment in time, I do not believe the paper to be ready for publication at the ICLR conference. Most importantly, the current questions regarding the metrics used for evaluating the method make it hard to judge the significance of the work. With these questions addressed in the rebuttal, I would be willing to increase my score. \n\n--- \n\nBased on the newly presented results using Gaussian software to compute the properties of generate molecules I have raise my score (5->6). ",
            "correctness": "3: Some of the paper\u2019s claims have minor issues. A few statements are not well-supported, or require small changes to be made correct.",
            "technical_novelty_and_significance": "3: The contributions are significant and somewhat new. Aspects of the contributions exist in prior work.",
            "empirical_novelty_and_significance": "3: The contributions are significant and somewhat new. Aspects of the contributions exist in prior work.",
            "flag_for_ethics_review": [
                "NO."
            ],
            "recommendation": "6: marginally above the acceptance threshold"
        },
        "signatures": [
            "ICLR.cc/2023/Conference/Paper2730/Reviewer_BGNw"
        ],
        "readers": [
            "everyone"
        ],
        "nonreaders": [],
        "writers": [
            "ICLR.cc/2023/Conference",
            "ICLR.cc/2023/Conference/Paper2730/Reviewer_BGNw"
        ]
    }
]