[
    {
        "id": "GebRLGZP1m",
        "original": null,
        "number": 1,
        "cdate": 1666274483158,
        "mdate": null,
        "ddate": null,
        "tcdate": 1666274483158,
        "tmdate": 1666274483158,
        "tddate": null,
        "forum": "4MbGnp4iPQ",
        "replyto": "4MbGnp4iPQ",
        "invitation": "ICLR.cc/2023/Conference/Paper3697/-/Official_Review",
        "content": {
            "confidence": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked.",
            "summary_of_the_paper": "In the proposed work, the authors present a method for de novo drug design conditioned on specific pharmacophores. They do so by using an autoregressive model similar to MoLeR (Maziarz et al 2021) and cleverly extending it to the 3D dimensional case with equivariant/invariant networks. ",
            "strength_and_weaknesses": "Strengths:\n\n* Manuscript very well written\n* First approach of its kind, where the goal is to directly generate a 3D dimensional molecule end-to-end conditioned on a specific pharmacophore.\n* Methodology shows potential for scaffold-hopping.\n* Accompanying code to facilitate method testing\n\n\nWeaknesses:\n* Evaluation limited to the proposed method itself. While the proposed method is currently unique in the sense that it's fully end-to-end, the authors could have compared to other \"multi-step\" approaches such as the ones proposed by Skalic et al. (2019) or Imrie et al. (2021), even if the latter require additional conformation generation / alignment. From a technical point of view the model is novel but its applicability advantage compared to previous approaches remains unclear.\n",
            "clarity,_quality,_novelty_and_reproducibility": "Clarity: Overall, the manuscript is well-written and to a sufficient level of detail so that it can be replicated. The Appendix is also quite thorough in regards to providing sufficient context for sections that for page limitations could not be extended appropriately.\n\nQuality and novelty: As mentioned in the strength & weaknesses section, to my belief, this is the first method of its kind for the task of equivariantly generating molecules end-to-end conditioned on a specific pharmacophore and therefore deserves publication. In terms of quality, I believe that the manuscript could benefit from additional evaluations, particularly considering that there are other more basic techniques (e.g. 3D CNNs captioning networks that have been used for this same task in the past)\n\nReproducibility: The authors have provided supplementary code to reproduce most of the results provided in the manuscript. ",
            "summary_of_the_review": "Overall, this is a good paper and believe that it is technically novel. I think, however, that it would benefit from an extended experiments section where the practical applicability of the method is compared to that of previous approaches.\n\nAdditional comments:\n* One of the main selling points of shape-conditional generation is to generate molecules similar to a specific co-crystallized structure (i.e., in structure=based drug design). The authors could potentially use structure data to generate molecules for a given pharmacophore inside a protein pocket and compare how docking scores (without redocking, only scoring) compare to those of the reference compound.\n* How is the p_{site} MLP computed? Since different fragments will have a variable number of attachment points, does that mean that each fragment type has its own separate MLP?\n* Similarly are the MLPs of p_{focus}, p_{next} and p_{site} separate? If so, do they need a subscript?\n* (On Table 5): Could the authors elaborate on why the graph reconstruction accuracy is so low? Is that a consequence of the autoregressive nature of the model? Similarly, could they comment on the amount of steric clashes (reported 13.1%)?\n* (On the shape-constrained molecular optimization section) Do the authors use an existing genetic algorithm implementation or do they implement their own?\n* Equations are lacking commas and periods when appropriate\n* Figure 2 caption has a typo. (\"encoder-decod er\")",
            "correctness": "3: Some of the paper\u2019s claims have minor issues. A few statements are not well-supported, or require small changes to be made correct.",
            "technical_novelty_and_significance": "4: The contributions are significant, and do not exist in prior works.",
            "empirical_novelty_and_significance": "2: The contributions are only marginally significant or novel.",
            "flag_for_ethics_review": [
                "NO."
            ],
            "recommendation": "6: marginally above the acceptance threshold"
        },
        "signatures": [
            "ICLR.cc/2023/Conference/Paper3697/Reviewer_TAEy"
        ],
        "readers": [
            "everyone"
        ],
        "nonreaders": [],
        "writers": [
            "ICLR.cc/2023/Conference",
            "ICLR.cc/2023/Conference/Paper3697/Reviewer_TAEy"
        ]
    },
    {
        "id": "9MQk2Mmdcp",
        "original": null,
        "number": 2,
        "cdate": 1666560293154,
        "mdate": null,
        "ddate": null,
        "tcdate": 1666560293154,
        "tmdate": 1670377991896,
        "tddate": null,
        "forum": "4MbGnp4iPQ",
        "replyto": "4MbGnp4iPQ",
        "invitation": "ICLR.cc/2023/Conference/Paper3697/-/Official_Review",
        "content": {
            "confidence": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work.",
            "summary_of_the_paper": "The paper studied shape-conditioned 3D molecule generation, which aims to generate molecules with a desirable shape. The author proposed an encoder-decoder architecture, where the encoder can encode both molecular graph representation and molecular shape representation by point clouds. Specifically, the main difference between the proposed model and existing molecular generative models is additionally taking shape (point clouds) as model inputs. Experiments show that the model can enable the shape-constrained generation and optimization of molecules.",
            "strength_and_weaknesses": "Strength:\n\n1. The tackled problem is new for the \"ML for molecule\" community, which hasn't been explored in previous literature.\n2. The chemical background and challenges of this task are greatly explained, making the content friendly to the general ML audience.\n3. The authors conduct comprehensive experiments and ablations to justify many different \n\nWeakness:\n\n1. Overall, the paper is a little hard to follow. As in Fig.2 and Sec.3, the author introduced too many intermediate variables within the neural network parameterizations, with just minor differences in subscripts. This is not very informative and makes the content not coherent enough. I suggest for the methodology part, try to just simply summarize the parameterization of the individual encoders & decoders; besides, make key parts such as the objective function and generation tree more clear and self-contained in the paper.\n2. As shown in Sec.3 problem definition paper, the author claims to generate molecules with \"similar shape\" and \"low similarity molecular representation\". However, I think overall the proposed model just learns to generate existing molecules, without new objectives or RL  methods to explicitly encourage the exploration. The major difference is taking shape as additional inputs. However, as shown in Appendix A.9, actually the performance improvement by taking shapes as inputs are not significant.\n3. Furthermore, the model actually is a combination of \"molecular graph generative models\" and \"torsion scoring models\". This makes me feel like you should also take existing molecular graph generation VAE models as baselines, such as [1]. For example, input $M_S$ into JT-VAE's encoder, and test whether decoder-generated molecules can maybe have competitive results with your model.\n\n[1] Jin, Wengong, Regina Barzilay, and Tommi Jaakkola. \"Junction tree variational autoencoder for molecular graph generation.\" In International conference on machine learning, pp. 2323-2332. PMLR, 2018.",
            "clarity,_quality,_novelty_and_reproducibility": "The content can be understood with effort, but clarity can be still significantly improved. See weakness.1 for details.\n\nThe quality is pretty good. The author provides extensive content for both methods and experiments.\n\nThe tackled task is new but methodology novelty is limited from ML perspective. See Weaknesses 2&3 for details.\n\nThe author provides experimental setups in paper, and also submits their code. Reproducibility is pretty good.",
            "summary_of_the_review": "The paper solves a new task of shape-conditioned molecule generation. I suggest significantly refining the content to make the paper easier to follow. Besides, comparing recent state-of-the-art VAE-based molecular generative models to justify the empirical improvements (see weakness 3).",
            "correctness": "3: Some of the paper\u2019s claims have minor issues. A few statements are not well-supported, or require small changes to be made correct.",
            "technical_novelty_and_significance": "2: The contributions are only marginally significant or novel.",
            "empirical_novelty_and_significance": "2: The contributions are only marginally significant or novel.",
            "flag_for_ethics_review": [
                "NO."
            ],
            "recommendation": "6: marginally above the acceptance threshold"
        },
        "signatures": [
            "ICLR.cc/2023/Conference/Paper3697/Reviewer_UfVq"
        ],
        "readers": [
            "everyone"
        ],
        "nonreaders": [],
        "writers": [
            "ICLR.cc/2023/Conference",
            "ICLR.cc/2023/Conference/Paper3697/Reviewer_UfVq"
        ]
    },
    {
        "id": "Ad-_s6Cny7",
        "original": null,
        "number": 3,
        "cdate": 1666667117729,
        "mdate": null,
        "ddate": null,
        "tcdate": 1666667117729,
        "tmdate": 1666667117729,
        "tddate": null,
        "forum": "4MbGnp4iPQ",
        "replyto": "4MbGnp4iPQ",
        "invitation": "ICLR.cc/2023/Conference/Paper3697/-/Official_Review",
        "content": {
            "confidence": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work.",
            "summary_of_the_paper": "This paper describes a method that can generate a sets of molecules that approximately match an input 3D \"shape\".  The method employs an autoregressive encoder-decoder architecture that learns a representation of the input shape (VN-DGCNN) and partial graph and decodes an updated molecule graph with an additional atom or fragment at each step (inspired by MoLeR). The method use a number of useful heuristics for bonds and angles to limit learning to the rotatable dihedral angles of the small molecule graphs. The authors demonstrate their model on a number of shape-conditioned tasks.\n",
            "strength_and_weaknesses": "The paper is a solid contribution to a reasonably recent area of exploration, the conditional generation of small molecules with 3D coordinates.  The technical aspects of the method are well thought out and described in a clear fashion, though I list a couple of remaining questions and omissions below. The authors demonstrate their method on a reasonable number of synthetic examples, and document its level of success.\n\nOne weakness in the presentation of this paper is the lack of a clear explanation of the rationale and implications from the restriction of chemical space to the combinatorial chemical landscape defined by the chosen set of 100 fragments and their non-ring linkers. I understand the need to demonstrate a method quickly, and perhaps this was the main motivation, however, while reading this work I kept wondering if perhaps the cost of a larger search tree perhaps becomes prohibitive and renders the method impractical. If that's not the case, would it be possible to simply generate molecules atom-by-atom, similar to previous 3D generation models, and let the model learn to enter rings and keep generating ring atoms until they close and so on? Alternatively, could one increase the size of fragments dramatically to include all possible single, double, and triple rings in any of the currently available patents?  Would such a change degrade the reconstruction quality?  Approximately how would the time for generation of a molecule (currently listed as 2--3 seconds of walltime) scale if one increased the size of the fragment library by a factor of 2, 5, 10, 100?\n\nIn terms of coordinates, the model is only learning to generate the rotatable dihedrals, which sounds like a rational way to evaluate a shape-matching model.  However, I wonder how much strain these dihedrals undergo in the final proposed conformation.  Instead of using the procedure to generate Figure 12, could the authors find the local minimum of the MMFF (the force field they used for generating the input conformations) and show the statistics of the shape similarity for these relaxed configurations?  \n\nCould the model drop the dependence on the initial fragment by learning the distribution of such initial fragments in the training set and learning to condition their initial placements on the shape?  I'd imagine that this problem is much easier than learning how to construct a reasonable search tree, and if it is harder than I imagine, then perhaps the authors could use an existing conditional pose generator, deep (or shallow) docking tool, or something else that is efficient as a starting point.  In that way, there will be no need to disclose any information about the test molecule that generated the shape for the final shape-matching task. \n\nA confusing mistake in the paper is the improper description of the work in the pocket2mol paper, which also conditions on 3D inputs (the pocket) and generates complete molecules (not only fragments).  I strongly recommend that the authors improve their otherwise clear review of the related literature at the time of their submission, and amend the relevant clause in the second sentence of the abstract.\n\nFinally, a question that doesn't need to be addressed in the paper, however, I would appreciate any thoughts that the authors might have on the subject below, and perhaps their answer could improve the paper after all.  The method that the authors use to align the molecules, ROCS, also has a GPU implementation that is reasonably scalable and efficient, and could thus render other, less specialized algorithms competitive (e.g. a traditional genetic algorithm that mixes graphs to iteratively optimize the shape scores in an ensemble, or a naive iterative trainable 3D molecule generator that scores and filters partial molecule graphs.)  Additionally, ROCS also can align and score molecules using both shape and color (chemical features)---I expect that a generalization that addresses color in addition to shape would be relevant in a practical drug discovery setting.  It would be trivial to modify an ensemble optimization algorithm to score via shape+color ROCS, however, typical ML methods would require training from scratch.  Is there a missing flexibility in the current wave of neural-network-based acceleration of chemoinformatics tasks and are there any generic ways to go around them to help build flexible building blocks (similar to what VNs did for building SO3 equivariant networks, but now for small molecule drug discovery)?\n",
            "clarity,_quality,_novelty_and_reproducibility": "The quality, clarity, and originality of this work is high.  The authors have provided code and links to the data to ensure reproducibility (though I haven't tested that assumption myself.)  \n",
            "summary_of_the_review": "This paper is a useful, original contribution that can become stronger with minor modifications.\n",
            "correctness": "3: Some of the paper\u2019s claims have minor issues. A few statements are not well-supported, or require small changes to be made correct.",
            "technical_novelty_and_significance": "3: The contributions are significant and somewhat new. Aspects of the contributions exist in prior work.",
            "empirical_novelty_and_significance": "3: The contributions are significant and somewhat new. Aspects of the contributions exist in prior work.",
            "flag_for_ethics_review": [
                "NO."
            ],
            "recommendation": "6: marginally above the acceptance threshold"
        },
        "signatures": [
            "ICLR.cc/2023/Conference/Paper3697/Reviewer_vKuJ"
        ],
        "readers": [
            "everyone"
        ],
        "nonreaders": [],
        "writers": [
            "ICLR.cc/2023/Conference",
            "ICLR.cc/2023/Conference/Paper3697/Reviewer_vKuJ"
        ]
    },
    {
        "id": "tOOj7Lr1Z6k",
        "original": null,
        "number": 4,
        "cdate": 1666682493209,
        "mdate": null,
        "ddate": null,
        "tcdate": 1666682493209,
        "tmdate": 1668675202682,
        "tddate": null,
        "forum": "4MbGnp4iPQ",
        "replyto": "4MbGnp4iPQ",
        "invitation": "ICLR.cc/2023/Conference/Paper3697/-/Official_Review",
        "content": {
            "confidence": "5: You are absolutely certain about your assessment. You are very familiar with the related work and checked the math/other details carefully.",
            "summary_of_the_paper": "The paper designs a novel framework to generate molecules regarding to the point cloud of molecules. The authors make a lot of effort into building the model consisting of VN-DGCNN, GNN, scoring rotatable bonds and so on.",
            "strength_and_weaknesses": "Strength:\n1. The paper proposes a complex generative system for molecular generation with very detailed task-specific model design.\n2. In order to build the molecules with 3D conformation, the proposed method introduces a novel scoring rotatable bonds to learn the rolling angles of each fragment.\n3. The proposed method resolves a critical problem as scaffold hopping in drug design.\n4. The experimental results show the benefits of the proposed method.\n\nWeakness:\n1. The contribution to the machine learning community is limited. The whole model is based on a CVAE framework with two embedding networks, VG-DGCNN and GNN and one fragment-based sequential generative decoder. The scoring rotatable bonds is a novel contribution but incremental to the ML community.\n2. The rolling bonds of the molecules should contain periodicity. However, the output of scoring rotatable bonds is the output of a sigmoid function which is not a periodic function. \n3. Since the base framework follows a CVAE, is the proposed method able to reconstruct the molecules in terms of the point cloud and 2D graph? It is better to report the validity, uniqueness, novelty, and reconstruction rate to indicate whether the model learns the information of molecules properly.\n4. I am curious given a fixed shape, what is the diversity of the generated molecules? Are all generated conformers stable at the lowest energy and still fit to the required shape?\n",
            "clarity,_quality,_novelty_and_reproducibility": "The paper is under very high clarity, quality and reproducibility. However, the novelty to the machine learning community seems to be weak.",
            "summary_of_the_review": "I tend to reject the paper because I still doubt the contribution to the machine learning community. Although I believe it shows solid contribution to the drug discovery community. This work is more suitable to a journal of computational chemistry.",
            "correctness": "3: Some of the paper\u2019s claims have minor issues. A few statements are not well-supported, or require small changes to be made correct.",
            "technical_novelty_and_significance": "3: The contributions are significant and somewhat new. Aspects of the contributions exist in prior work.",
            "empirical_novelty_and_significance": "2: The contributions are only marginally significant or novel.",
            "flag_for_ethics_review": [
                "NO."
            ],
            "recommendation": "6: marginally above the acceptance threshold"
        },
        "signatures": [
            "ICLR.cc/2023/Conference/Paper3697/Reviewer_bX75"
        ],
        "readers": [
            "everyone"
        ],
        "nonreaders": [],
        "writers": [
            "ICLR.cc/2023/Conference",
            "ICLR.cc/2023/Conference/Paper3697/Reviewer_bX75"
        ]
    }
]