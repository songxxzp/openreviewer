[
    {
        "id": "Ot72eMiiYo",
        "original": null,
        "number": 1,
        "cdate": 1666317711092,
        "mdate": null,
        "ddate": null,
        "tcdate": 1666317711092,
        "tmdate": 1666317711092,
        "tddate": null,
        "forum": "6PIrhAx1j4i",
        "replyto": "6PIrhAx1j4i",
        "invitation": "ICLR.cc/2023/Conference/Paper4592/-/Official_Review",
        "content": {
            "confidence": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work.",
            "summary_of_the_paper": "This work presents a hypothesis that the DDPM encoder map coincides with the optimal transport map for common distributions, and it is shown for Gaussians this is indeed the case. Empirical evaluations are done to support this hypothesis.\n",
            "strength_and_weaknesses": "## Strengths:\n* Finding meaningful ways to interpret popular diffusion models like DDPM is a meaningful research direction\n* The paper presents a rigorous proof of the hypothesis for the Gaussian case\n* Experiments were done to compute the exact error between transport costs for low-dimensional synthetic examples as well as qualitatively for image generation tasks.\n\n\n## Weaknesses:\n* I found the novelty of this paper lacking as it does not introduce a new method or significantly new theoretical results.\n* For the Gaussian case, the proof becomes a lot simpler because all intermediate densities are also normal. And it looks like the authors further assume $a(0) = 0$ and I have not found a proof of a more general case in the supplementary materials contrary to what is mentioned in the appendix proof.\n* In Section 3.4, when computing the error between the optimal transport and the one induced by solving the Fokker-Planck equation numerically, I think it might be more useful to compare the difference of transport maps (that is, $\\sum_i ||T(x_i)-T^*(x_i)||^2$ where $T$ is the ODE induced map, and $T^*$ is the optimal transport map). It is possible that the error is very small but the transport maps can still be different.\n* I found the rationale of Section 3.5 a bit questionable, namely we can invert the encoder and just compare the inverted latent codes visually. To me, such evaluation only makes sense if the transport map is just translated by a constant vector. Have the authors tried with different random seeds (and hence different randomization of DDPM networks) when training models for a different dataset? Will the results still be consistent?\n* It was very briefly mentioned that recently Lavenant & Santambrogio found a counterexample to the central hypothesis. In my opinion, the paper needs to do a lot more in explaining whether such a counterexample is a singular case or not, other than mentioning the two maps disagree at a single point (how can two maps disagree at only one point if both maps are continuous enough?) and somehow \"finite number of samples in higher dimensions\" this is not a problem.\n* The numerical solver for the Fokker-Planck equation uses a low-rank TT format which I think might be foreign to the machine-learning community and deserves more explanations, at least in the appendix. For instance, the authors ought to elaborate on \"the standard second-order operator splitting technique\" that involves some exponentiation in time-stepping that I do not follow.\n",
            "clarity,_quality,_novelty_and_reproducibility": "The clarity of the paper is very good, and I saw the source code in the supplementary.\n",
            "summary_of_the_review": "Overall I think the paper lacks novelty and there are some evaluation choices that could be improved. Hence I'm leaning toward rejection.\n",
            "correctness": "4: All of the claims and statements are well-supported and correct.",
            "technical_novelty_and_significance": "2: The contributions are only marginally significant or novel.",
            "empirical_novelty_and_significance": "3: The contributions are significant and somewhat new. Aspects of the contributions exist in prior work.",
            "flag_for_ethics_review": [
                "NO."
            ],
            "recommendation": "5: marginally below the acceptance threshold"
        },
        "signatures": [
            "ICLR.cc/2023/Conference/Paper4592/Reviewer_qZHA"
        ],
        "readers": [
            "everyone"
        ],
        "nonreaders": [],
        "writers": [
            "ICLR.cc/2023/Conference",
            "ICLR.cc/2023/Conference/Paper4592/Reviewer_qZHA"
        ]
    },
    {
        "id": "mo6KEB2F95w",
        "original": null,
        "number": 2,
        "cdate": 1666343112032,
        "mdate": null,
        "ddate": null,
        "tcdate": 1666343112032,
        "tmdate": 1666343112032,
        "tddate": null,
        "forum": "6PIrhAx1j4i",
        "replyto": "6PIrhAx1j4i",
        "invitation": "ICLR.cc/2023/Conference/Paper4592/-/Official_Review",
        "content": {
            "confidence": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked.",
            "summary_of_the_paper": "This paper claims that diffusion-based models actually implement transportation plans between target and Gaussian distributions. It comes with a very pedagogical introduction to both DDPM and optimal transport, and then the rest of the paper is spent doing experiments to show how this claim is verified on many examples. ",
            "strength_and_weaknesses": "As a definite strength, the paper is very readable and a pleasure to read. Its claim is clearly stated, although I am not 100% sure it is actually novel. Still, the experiments are nice and quite convincing.\n\nAs a weakness, maybe I could say that the paper is a bit weak on the theory, which is not a no-go for me. What I feel could be done in a clearer way is to frame the paper as clearly stating an \"hypothesis\" or a \"conjecture\". This could help better understand its contribution, which I believe is pretty exciting and simple to grasp.",
            "clarity,_quality,_novelty_and_reproducibility": "The paper is very clear, its experiments are both very convincing and funny, and it looks like the code will be made reproducible. My guess is: this paper may have a nice impact.",
            "summary_of_the_review": "The paper is a nice read, but I think it is a bit borderline, although I like it.\nI believe it could be improved in the following ways:\n* more references about DDPM and OT and their connections. (For instance you could mention diffusion based OT systems based on Wasserstein flows). \n* This improved state of the art may be done at the expense of putting the details of the  \"method\" part in appendix.\n* a much clearer (title + text) presentation of this paper as stating a conjecture or an hypothesis that DDPM actually construct transportation maps. (plans ?) ",
            "correctness": "2: Several of the paper\u2019s claims are incorrect or not well-supported.",
            "technical_novelty_and_significance": "3: The contributions are significant and somewhat new. Aspects of the contributions exist in prior work.",
            "empirical_novelty_and_significance": "3: The contributions are significant and somewhat new. Aspects of the contributions exist in prior work.",
            "flag_for_ethics_review": [
                "NO."
            ],
            "details_of_ethics_concerns": "N/A",
            "recommendation": "6: marginally above the acceptance threshold"
        },
        "signatures": [
            "ICLR.cc/2023/Conference/Paper4592/Reviewer_R2Hy"
        ],
        "readers": [
            "everyone"
        ],
        "nonreaders": [],
        "writers": [
            "ICLR.cc/2023/Conference",
            "ICLR.cc/2023/Conference/Paper4592/Reviewer_R2Hy"
        ]
    },
    {
        "id": "avwztJVIfn",
        "original": null,
        "number": 3,
        "cdate": 1666533742778,
        "mdate": null,
        "ddate": null,
        "tcdate": 1666533742778,
        "tmdate": 1666533742778,
        "tddate": null,
        "forum": "6PIrhAx1j4i",
        "replyto": "6PIrhAx1j4i",
        "invitation": "ICLR.cc/2023/Conference/Paper4592/-/Official_Review",
        "content": {
            "confidence": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work.",
            "summary_of_the_paper": "This work hypothesizes that the limit maps produced by   DDPMs  coincide with the optimal transport maps, or they are very close to each other with high similarity. The theoretical proofs are given for the cases of the normal source distributions, and experimental results are given for more general distributions, such as the mixtures of uniform distributions. The experiments on real image data sets show that the images sharing the same latent code obtained by diffusion have the similar high level texture features, postures and semantics. Also, the L2 distance seems not suboptimal for visual data. The work bridges the optimal transport theory and the diffusion model. \n\nThe contributions are:\n\n1. theoretically verify that for the case of multivariate normal distributions the Monge optimal transport map coincides with the DDPM encoder map.\n\n2. Numerically verification of the similarity between the optimal transport maps and the DDPM encoder map by solving the Fokker-Planck equation on more general synthetic distributions.\n\n3. Additional qualitative empirical evidence supporting the hypothesis on real image datasets are provided.",
            "strength_and_weaknesses": "The work has many strengths:\n\n1. It raised an interesting hypothesis which bridges DDPM and optimal transport theory, the conjecture is sensible, elegant and inspirational.\n2. Solid theoretical proofs are given for multivariate Gaussian distribution as the source input. Numerical experiments on synthetic data and empirical validations on real images are supporting.\n3. The writing is clear and easy to follow, the mathematical formulations are rigorous and succinct.\n\nThe weaknesses are \n1. The theoretic proofs can be further improved, in appendix between equation (19) and (20), the authors claims the solution is exaction the optimal transport map, the detailed deduction for this claim is missing. I expected to see more details to show this solution satisfies the Brenier Monge-Ampere equation.\n\n2. In the numerical experiment design, the authors simply used the POT library, which algorithm was applied ? Some algorithms are intrinsically approximation and will introduce approximation errors. This need to be carefully analyzed as well to ensure the precision of the experiments.\n\n3. The hypothesis is kind of vague, the DDPM solution and the optimal transport map are close with small deviation. More accurate quantitively estimate will be more convincing. ",
            "clarity,_quality,_novelty_and_reproducibility": "The work is novel to discuss the intrinsic relation between the diffusion model, which has fundamental importance. The manuscript is very well written, the motivations, inspirations are clearly introduced, the major concepts, mathematical formulations, proofs are clean and easy to follow, the experimental design, and algorithmic descriptions are explained thoroughly. The numerical experiments are clearly analyzed. The work is easy to reproduce. ",
            "summary_of_the_review": "This work hypothesizes that the limit maps produced by   DDPMs  coincide with the optimal transport maps, or they are very close to each other with high similarity. The work theoretically verifies the hypothesis for the case of multivariate normal distributions the Monge optimal transport map coincides with the DDPM encoder map, gives the numerical verification of the similarity between the optimal transport maps and the DDPM encoder map by solving the Fokker-Planck equation on more general synthetic distributions, and offers additional qualitative empirical evidence supporting the hypothesis on real image datasets are provided.\n\nThe idea of bridging optimal transport theory and DDPM is inspiring and important. The mathematical proof is rigorous and elegant, the empirical experimental results are encouraging. The hypothesis can be further formulated to be more quantitively  precise. The mathematical proofs can be directly generalized to other well known distributions. More complicated synthesized distributions can be tested for the hypothesis. ",
            "correctness": "3: Some of the paper\u2019s claims have minor issues. A few statements are not well-supported, or require small changes to be made correct.",
            "technical_novelty_and_significance": "3: The contributions are significant and somewhat new. Aspects of the contributions exist in prior work.",
            "empirical_novelty_and_significance": "2: The contributions are only marginally significant or novel.",
            "flag_for_ethics_review": [
                "NO."
            ],
            "details_of_ethics_concerns": "The research is fundamental, and mainly focuses on theoretic aspects.",
            "recommendation": "6: marginally above the acceptance threshold"
        },
        "signatures": [
            "ICLR.cc/2023/Conference/Paper4592/Reviewer_CjpS"
        ],
        "readers": [
            "everyone"
        ],
        "nonreaders": [],
        "writers": [
            "ICLR.cc/2023/Conference",
            "ICLR.cc/2023/Conference/Paper4592/Reviewer_CjpS"
        ]
    },
    {
        "id": "ztkXcaa86T",
        "original": null,
        "number": 4,
        "cdate": 1667471044839,
        "mdate": null,
        "ddate": null,
        "tcdate": 1667471044839,
        "tmdate": 1667471044839,
        "tddate": null,
        "forum": "6PIrhAx1j4i",
        "replyto": "6PIrhAx1j4i",
        "invitation": "ICLR.cc/2023/Conference/Paper4592/-/Official_Review",
        "content": {
            "confidence": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work.",
            "summary_of_the_paper": "This paper provides theoretical and experimental support to the following hypothesis: maps induced by denoising diffusion processes are optimal transport maps between the base and target distributions. For the case of multidimensional Gaussians, the paper provides a complete analytical result. For the general case, it shows this directly for synthetic experiments with mixtures of Gaussian and indirectly, through consequences such as texture preservation, for image data.",
            "strength_and_weaknesses": "### Strengths\n* Theoretical understanding of denoising diffusion processes is important to bring their impressive qualitative performance with images to other applications. As such, the characterization put forth by this paper can give a good starting point to understanding the nature of the resulting maps.\n* The paper is written well, with good overview of the background material, a clear motivation, and directly appreciable results.\n\n### Weaknesses\n* The analytical result is very limited, as it pertains to mapping from Gaussians to Gaussians. At some level it is also unsurprising, considering that Gauss-Markov processes do have energy-optimality properties. This doesn\u2019t mean that the result is trivial, but it begs for additional complementation with empirical results to support the hypothesis.\n* There is a little bit of ambiguity when moving from the discrete processes to their corresponding continuous versions. For example, the difference equation (4) is a backward process, but the corresponding differential equation (6) appears to be a forward one. It is worth saying something about this to ease reading for those who are not immersed in this area.\n* The indirect evidence based on texture similarity in the image data experiments is a very compelling approach. However, it is worth discussing why other reasonable explanations may not work. For example, if the neural network is regularized in all cases to be a Lipschitz map, then the texture similarity could be simply by virtue of that limited distortive ability instead of some global form of transport optimality (though, admittedly, these two concepts could be related.)\n* The numerical results paragraph in the image data experiments (p.9) is unclear. To have the analogue of Section 3.4, I would have expected computing the cost of the Monge map for these images, but it doesn\u2019t seem that\u2019s what is done. A clarification here is necessary.\n",
            "clarity,_quality,_novelty_and_reproducibility": "The paper is written very clearly. The basis of the work, namely recasting diffusion models into continuous SDEs and ODEs and relating flows to transport, is not novel. However, placing everything into this coherent hypothesis and providing clear evidence in support of it is novel, to the best of my knowledge and it is done well. The results appear to be easily reproducible.",
            "summary_of_the_review": "The paper gives compelling evidence that links denoising diffusion processes to optimal transport maps from base to target distributions. This is done clearly and methodically. This may form the basis of a better understanding of the remarkable performance of this approach to generating natural images and of furthering its use in novel applications. Apart from a couple of clarifications, the paper seems worthwhile to share with the community.",
            "correctness": "4: All of the claims and statements are well-supported and correct.",
            "technical_novelty_and_significance": "3: The contributions are significant and somewhat new. Aspects of the contributions exist in prior work.",
            "empirical_novelty_and_significance": "3: The contributions are significant and somewhat new. Aspects of the contributions exist in prior work.",
            "flag_for_ethics_review": [
                "NO."
            ],
            "recommendation": "8: accept, good paper"
        },
        "signatures": [
            "ICLR.cc/2023/Conference/Paper4592/Reviewer_6Sgh"
        ],
        "readers": [
            "everyone"
        ],
        "nonreaders": [],
        "writers": [
            "ICLR.cc/2023/Conference",
            "ICLR.cc/2023/Conference/Paper4592/Reviewer_6Sgh"
        ]
    }
]