[
    {
        "title": "Open the Black Box: Step-based Policy Updates for Temporally-Correlated Episodic Reinforcement Learning"
    },
    {
        "review": {
            "id": "EgFSpoMCac",
            "forum": "mnipav175N",
            "replyto": "mnipav175N",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission5877/Reviewer_DXh7"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission5877/Reviewer_DXh7"
            ],
            "content": {
                "summary": {
                    "value": "This paper proposes an approach for episodic reinforcement learning. In such a setting, the policy outputs a high-level trajectory instead of \na single action per state. This idea has been extensively explored (e.g., hierarchical reinforcement learning). The main technical innovations of this work are (1) optimizing over trajectory chunks instead of the whole trajectory and (2) modeling the correlation between states observed during the chunks. The paper is extensively evaluated in multiple benchmarks."
                },
                "soundness": {
                    "value": "2 fair"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "2 fair"
                },
                "strengths": {
                    "value": "The approach is technically sound. While the change from previous work (Otto et al. 202; Li et al. 2023) is relatively limited, the proposed innovations are novel. \nThe extensive experiments show both the advantages and limitations of the approach."
                },
                "weaknesses": {
                    "value": "The main weaknesses I see in the approach are:\n1. Integrating over multiple timesteps breaks the markov assumption from which the learning objective in Eq. 8 is derived. This is because, given the multi-state parametrization, a state s_t depends on more than s_{t-1}. This is true not only for the proposed approach but also more generally for every method that introduces a dependency between states (e.g. smoothing). Previous work even noticed that such smoothing can hurt performance (see Smith et al., A Walk in the Park: Learning to Walk in 20 Minutes With Model-Free Reinforcement Learning).\n2. The dependence on a hand-picked segment length K. While having some parts of the algorithm heuristically tuned is generally not a problem, I find this parameter to possibly be challenging to pick (due to its dependence on the task) and time-varying. My intuition is that the problem does not appear in the selected experiments due to their simplicity. I guess it will be much more challenging as soon as the time derivative of the reward drastically changes over time.  A cue in this direction is the failure case on the table tennis task, which shows these characteristics (when the ball is close to the end-effector, the robot needs very high-resolution updates, while a longer horizon is sufficient in the waiting times. This problem is not unusual in most robot tasks: for example, in visual navigation or locomotion, the interdependence between states is rarely constant (e.g., when a sudden obstacle appears, one needs to react fast). I think the paper would benefit from studying this aspect in more detail. Could there be a connection between the derivative of the value function and the segment length K? Can it be learned with the task? \n\nA second limitation is in the experimental setup. Specifically:\na) I find some of the results to be difficult to interpret. In Fig. 6b-c, all methods appear to perform similarly in the dense and sparse setting, which I find surprising. Even more so, almost all approaches (including gSDE, which achieves the best performance) perform better with sparse rewards than dense ones. Why is this case? At least for step-wise methods, dense should do better. Why does this happen? \nb) I think that results should be reported for a longer number of interactions. In Fig. 5,6, and 7, the methods do not appear to be fully converged. Showing results up to convergence (as in Fig. 5a) would give a better intuition about the approach's strength in comparison to the baselines.\n\nOther relatively minor limitations:\n1. The baselines are not defined (e.g., what paper is BBRL?)\n2. The comparison of trajectory-based to state-based is not entirely apple to apple since the trajectory methods require an extra low-level controller, possibly specifically tuned to the robot/task. Their data efficiency could be attributed to this prior. In addition, such a low-level controller is difficult to get in some cases, and a simple PD controller won't do (e.g., locomotion). I would mention this disclaimer to the experimental setup.\n3. There is a typo in Eq. 5."
                },
                "questions": {
                    "value": "I would like to see a detailed derivation of the objective in the proposed multi-step setup. In addition, I would appreciate a discussion and possibly experiments on the value of K and a more in-depth analysis to justify the experimental setup."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "6: marginally above the acceptance threshold"
                },
                "confidence": {
                    "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                },
                "first_time_reviewer": {
                    "readers": [
                        "ICLR.cc/2024/Conference/Program_Chairs",
                        "ICLR.cc/2024/Conference/Submission5877/Senior_Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission5877/Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission5877/Reviewer_DXh7"
                    ]
                }
            },
            "number": 1,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission5877/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698032512154,
            "cdate": 1698032512154,
            "tmdate": 1700712055465,
            "mdate": 1700712055465,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "4XDFTJOldx",
                "forum": "mnipav175N",
                "replyto": "EgFSpoMCac",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission5877/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission5877/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Reply to reviewer DXh7, #1"
                    },
                    "comment": {
                        "value": "### **Dear Reviewer DXh7,**\n\nThank you for your valuable and insightful feedback on our work. We have addressed the major concerns you raised to the best of our knowledge. There are still some open questions that we are actively working on, and we are committed to resolving these in the next few days.\n\n### **[Update Log, Nov. 18.2023]**\n\nAddress the major concerns of all reviewers\n\nUpload additional evaluation and ablation study to Supplementary Material\n\n### **[Update Log, Nov. 22, 2023]**\nRestructure the paper's storyline, and address the remaining concerns from the reviewers\n\n### **Novelty and Contribution**\n\nWe wish to re-emphasize the novelty and significant contribution of TCE, which builds upon the foundational of previous works. TCE represents a distinct algorithmic advancement in Episodic Reinforcement Learning, going beyond mere modifications of existing models. Our work is pioneering in its incorporation of step-based information into the policy update process of Episodic RL [1,2,3,4]\u2014a field that traditionally relied on black box optimization methods. Importantly, TCE maintains the inherent benefits of broad exploration and trajectory smoothness that are characteristic of episodic RL.\n\n### **Reference of BBRL**\n\nBBRL stands for Deep Black Box Reinforcement Learning, as described in [4], an episodic RL method that learns trajectories directly in the parameter space. We will update our paper to offer a proper introduction of it.\n\n### **MDP and Learning Objective**\n\n- Our learning framework maintains the Markovian property, as discussed in section 3.1 of [5]. The Markovian property specifically concerns the state transition probability, $p(s_{t+1}, r_{t} | s_{t}, a_{t})$, indicating that the next state and reward depend solely on the current state and action. It does not impose any assumptions on the policy or the decision process. In our policy, we predict the entire trajectory as a sequence of actions at the start of each episode. This approach to action selection is fundamentally similar to other methods, such as repeating actions over consecutive steps [6] and using temporally correlated noise in action sampling [7].\n- We have thoroughly reviewed the paper by [Smith et al]. However, we note that the low-pass filter technique employed in their study is fundamentally different from the approach in our work and other research focused on directly modeling smooth trajectories. One possible failure reason of such a low-pass filter was discussed in the gSDE work [6], as it tends to cancel consecutive pertubations, and will thus lead to poor expoloration.\n- Our learning objective as presented in Equation (8) can be viewed as an approximation of the episodic RL\u2019s learning objective in Equation (1), rather than being derived from other Policy Gradient Method. This approximation is achieved by replacing the trajectory likelihood and advantage with their respective segment-wise versions."
                    }
                },
                "number": 9,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission5877/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700320836807,
                "cdate": 1700320836807,
                "tmdate": 1700675446423,
                "mdate": 1700675446423,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "SengMYBSKh",
                "forum": "mnipav175N",
                "replyto": "EgFSpoMCac",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission5877/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission5877/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Reply to reviewer DXh7, #1"
                    },
                    "comment": {
                        "value": "### **Segment Length (Number) and Value Function Learning**\n\n- The segment length, or the number of segments per trajectory, does indeed affect performance. However, we observed that within an optimal range, such as 10-25 segments per trajectory, this parameter is not overly sensitive compared to other hyperparameters. Thus, we use K=25 in all of our experiments. A detailed study on the influence of the number of segments is provided in the updated supplementary material, Section R.5, which was previously reported in Section C.7.\n- The approach we use in TCE for learning value functions aligns with that of standard RL methods, such as PPO. In our model, the segment length K influences only the policy update and does not affect the learning of the value function. This method of leveraging value functions is a key factor in why TCE achieves faster learning speeds compared to BBRL[4] in most tasks we reported. However, it also leads to a similar performance decline in the table tennis task, mirroring the challenges faced by other step-based RL methods that rely on value function learning.\n\n### **Experiment Settings**\n- Dense and sparse rewards settings    \n    We attribute the observed phenomenon to two main factors. Firstly, as previously discussed in [4], sparse reward settings often provide a clearer task description, aligning the reward structure more directly with the success evaluation criteria. Secondly, for some of the step-based algorithms, we employed a discount factor of 1.0, as opposed to the usual 0.99. This adjustment mitigates the task's sparsity, potentially enhancing the performance of these methods. However, since the task is constrained by a limited number of time steps, the episode return remains within a finite range. Despite these considerations, some step-based algorithms still exhibit poorer performance compared to their counterparts in dense reward settings.\n    \n- Longer training iterations\n    \n    Previsouly, we found a few baelines collapsed after a certain training iterations. And for off-policy methods, due to their update-to-data (UTD) ratio of 1, as suggested in references [6, 7], their training often take 1-2 days in the reported tasks. However, the main challenge is not the collection of samples, but the network updates and the overhead involved in data exchange between the policy and the environments. Considering that off-policy methods are designed for enhanced sample efficiency, their failure to learn effectively from a data volume comparable to that utilized by on-policy methods highlights their inferior performance in the tasks evaluated in the paper.\n    \n\n**References**\n\n[1] Peters, J. and Schaal, S., 2008. Reinforcement learning of motor skills with policy gradients. *Neural networks*, *21*(4), pp.682-697.\n\n[2] Kober, J. and Peters, J., 2008. Policy search for motor primitives in robotics. *Advances in neural information processing systems*, *21*.\n\n[3] Peters, J. and Schaal, S., 2006, October. Policy gradient methods for robotics. In *2006 IEEE/RSJ International Conference on Intelligent Robots and Systems* (pp. 2219-2225). IEEE.\n\n[4] Otto, F., Celik, O., Zhou, H., Ziesche, H., Ngo, V.A. and Neumann, G., 2023, March. Deep black-box reinforcement learning with movement primitives. In *Conference on Robot Learning* (pp. 1244-1265). PMLR.\n\n[5] Sutton, Richard S., and Andrew G. Barto.\u00a0*Reinforcement learning: An introduction*. MIT press, 2018.\n\n[6] Raffin, Antonin, Jens Kober, and Freek Stulp. \"Smooth exploration for robotic reinforcement learning.\"\u00a0*Conference on Robot Learning*. PMLR, 2022.\n\n[7] Haarnoja, T., Zhou, A., Abbeel, P. and Levine, S., 2018, July. Soft actor-critic: Off-policy maximum entropy deep reinforcement learning with a stochastic actor. In *International conference on machine learning* (pp. 1861-1870). PMLR.\n\n[8] Haarnoja, T., Zhou, A., Hartikainen, K., Tucker, G., Ha, S., Tan, J., Kumar, V., Zhu, H., Gupta, A., Abbeel, P. and Levine, S., 2018. Soft actor-critic algorithms and applications. *arXiv preprint arXiv:1812.05905*.\n\n================================================\n\nIf you have any further questions, please feel free to ask us.\n\nThank you.\n\nTCE Authors"
                    }
                },
                "number": 10,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission5877/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700320971144,
                "cdate": 1700320971144,
                "tmdate": 1700670206630,
                "mdate": 1700670206630,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "MWa82ugDFe",
                "forum": "mnipav175N",
                "replyto": "EgFSpoMCac",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission5877/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission5877/Authors"
                ],
                "content": {
                    "title": {
                        "value": "We updated the paper manuscript"
                    },
                    "comment": {
                        "value": "Dear reviewer Dxh7,\n\nSince the rebuttal period is almost over, we are eager to know whether our responses have addressed your concerns properly. Here we humbly ask for your feedback at your convenience such that we may still have the chance to discuss with you and chance to improve our final version before the close of the rebuttal window. Thank you!\n\nAll the best,\n\nTCE authors"
                    }
                },
                "number": 17,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission5877/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700675713576,
                "cdate": 1700675713576,
                "tmdate": 1700675713576,
                "mdate": 1700675713576,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "oI7GZuT7gO",
                "forum": "mnipav175N",
                "replyto": "SengMYBSKh",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission5877/Reviewer_DXh7"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission5877/Reviewer_DXh7"
                ],
                "content": {
                    "title": {
                        "value": "Thank you for your reply"
                    },
                    "comment": {
                        "value": "Thanks for addressing the issues raised in my review. I am happy to increase my score."
                    }
                },
                "number": 20,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission5877/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700712013613,
                "cdate": 1700712013613,
                "tmdate": 1700712013613,
                "mdate": 1700712013613,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "mdQ20qY3vE",
                "forum": "mnipav175N",
                "replyto": "EgFSpoMCac",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission5877/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission5877/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Thank you for your reply"
                    },
                    "comment": {
                        "value": "Dear reviewer DXh7,\n\nThank you for your reply! We sincerely appreciate your approval of our work.\n\nBest regards,\nTCE Authors"
                    }
                },
                "number": 21,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission5877/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700722851740,
                "cdate": 1700722851740,
                "tmdate": 1700722867919,
                "mdate": 1700722867919,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "DFn01HHdOK",
            "forum": "mnipav175N",
            "replyto": "mnipav175N",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission5877/Reviewer_psBV"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission5877/Reviewer_psBV"
            ],
            "content": {
                "summary": {
                    "value": "This is an empirical paper that proposes a segment (sub-trajectory) based reinforcement learning method Temporally-Correlated Episodic RL (TCE).\n\nThis method adopts the trajectory-based policy representation using Probabilistic Dynamic Movement Primitives (ProDMP) [Li et. al 2023]. It parameterizes the trajectory as a full Gaussian distribution, whose parameters are predicted by the policy network. This enables temporally coherent exploration by sampling trajectories from the Gaussian distribution.\n\nSubsequently, they divide the trajectory into segments, and run trust-region policy gradient based on the segment-wise advantage function estimate and the projection technique in [Otto et al. 2021], to update the trajectory parameter. To simplify the computation of the likelihood, they utilize the pairwise technique from Li et. al (2023). \n\nThe efficacy of this approach is demonstrated through a number of robotics manipulation tasks."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "2 fair"
                },
                "contribution": {
                    "value": "2 fair"
                },
                "strengths": {
                    "value": "- Good empirical performance across a variety of tasks and included negative cases like the table tennis with sparse rewards\n- The approach is straight-forward and bridges the gap between the extremes of step-based and trajectory-based reinforcement learning."
                },
                "weaknesses": {
                    "value": "1. The terminology \u201cepisodic RL\u201d could potentially lead to confusion, as it bears similarity to the concept of \u201cepisodic task\u201d contrasted with \u201ccontinuing task\u201d [Sutton and Barto, 2018]. A more fitting term, such as \u201csub-trajectory based RL,\u201d may better capture the essence of the work.\n2. The paper would benefit from a more organized exposition of its contributions. It appears that applying policy gradient to segments is the primary novel component. And this work integrates techniques from Li et al. (2023) and Otto et al. (2021). A clearer differentiation from these prior works would enhance the clarity of the paper.\n3. While hyperparameters are listed in the appendix, the rationale behind their selection remains opaque. Expanding on this would add depth to the methodology.\n4. I feel that the current experimental setup does not sufficiently justify certain design choices. Consider incorporating ablation studies to address the following:  \n    a. The necessity of the differentiable policy projection, as compared to alternatives like those used in PPO.  \n    b. The benefits of employing full covariance over diagonal variance in the trajectory representation, especially in light of the increased computational cost. \n5. Formatting:\n    Certain pages in the main pdf are images, making it impossible to do a text search in the pdf and hindering readability\n6. In Section 2.2, the claim \"The most effective episodic RL approaches directly explore in parameter space\" is presented without supporting references."
                },
                "questions": {
                    "value": "Is there a feasible approach to directly represent each segment, rather than representing the entire trajectory?"
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "6: marginally above the acceptance threshold"
                },
                "confidence": {
                    "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                },
                "first_time_reviewer": {
                    "value": "Yes",
                    "readers": [
                        "ICLR.cc/2024/Conference/Program_Chairs",
                        "ICLR.cc/2024/Conference/Submission5877/Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission5877/Reviewer_psBV",
                        "ICLR.cc/2024/Conference/Submission5877/Senior_Area_Chairs"
                    ]
                }
            },
            "number": 2,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission5877/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698906488634,
            "cdate": 1698906488634,
            "tmdate": 1700734232660,
            "mdate": 1700734232660,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "goigCFV4zU",
                "forum": "mnipav175N",
                "replyto": "DFn01HHdOK",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission5877/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission5877/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Reply to reviewer psBV, #1"
                    },
                    "comment": {
                        "value": "### **Dear reviewer psBV,**\n\nThank you for your valuable feedback, which has been instrumental in enhancing our paper. We have addressed the major concern you raised. Additionally, we are actively working on some open questions that emerged from your insights.\n\n### **[Update Log, Nov. 18.2023]**\n\nAddress the major concerns of all reviewers\n\nUpload additional evaluation and ablation study to Supplementary Material\n\n### **[Ongoing works, Nov. 18.2023]**\n\nRe-organizing the paper structure and re-doing a few experiments.\n\n### **Terminology**\n\nEpisodic Reinforcement Learning (ERL) is a well-established concept, previously applied to learning movement primitives in various studies [1, 2, 3, 4]. This approach shifts the search for solutions from the per-step action space to the trajectory parameter space, thereby promoting broader exploration. In this context, entire trajectories are often treated as single data points, and models are typically trained using black-box optimization methods. \n\nTCE, designed for episodic tasks with a finite horizon, similarly generates a single complete trajectory at the start of each episode, which is then followed until the episode concludes. The key distinction of TCE from earlier ERL approaches lies in its utilization of step-based information from sub-segments of the trajectory, enabling more efficient policy updates.\n\n### **Contribution Statements**\n\nWhile building upon the foundations laid by previous approaches like ProDMP and TRPL, we believe that TCE stands out as a significant algorithmic advancement in RL. As a novel framework, TCE distinguishes itself by integrating step-based information into the policy updates of episodic RL. This integration not only boosts update efficiency but also maintains trajectory smoothness and supports correlated action exploration, both temporally and across degrees of freedom (DoF). TCE is the first work to successfully merge the benefits of both RL methodologies, marking a novel advancement in the field.\n\n### **Hyperparameter Selection**\n\nWe executed a large-scale grid search to fine-tune key hyperparameters for each baseline method.\nFor other hyperparameters, we relied on the values specified in their respective original papers.\nBelow is a list summarizing the parameters we swept through during this process.\n\n- BBRL: Policy net size, critic net size, policy learning rate, critic learning rate, samples per itera-\ntion, trust region dissimilarity bounds, number of parameters per movement DoF.\n\n- TCE: Same types of hyper-parameters listed in BBRL, plus the number of segments per trajectory.\n\n- PPO: Policy network size, critic network size, policy learning rate, critic learning rate, batch size,\nsamples per iteration.\n\n- TRPL: Policy network size, critic network size, policy learning rate, critic learning rate, batch\nsize, samples per iteration, trust region dissimilarity bounds.\n\n- gSDE: Same types of hyper-parameters listed in PPO, together with the state dependent exploration sampling frequency\n\n- SAC/PINK: Policy network size, critic network size, policy learning rate, critic learning rate, alpha learning rate, batch size, Update-To-Data (UTD) ratio."
                    }
                },
                "number": 7,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission5877/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700320322621,
                "cdate": 1700320322621,
                "tmdate": 1700320322621,
                "mdate": 1700320322621,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "9OwLzZYYw5",
                "forum": "mnipav175N",
                "replyto": "DFn01HHdOK",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission5877/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission5877/Authors"
                ],
                "content": {
                    "comment": {
                        "value": "### **Ablation Studies**\n\nWe include additional study in the updated supplementary material. Section R.1 highlights the advantages of using full covariance in enhancing trajectory smoothness. Section R.2 examines the capacity of various methods to model movement correlation, with TCE and BBRL Cov demonstrating the greatest flexibility in trajectory sampling. However, it's crucial to note that the ability to model movement correlation is not the only factor contributing to successful performance. The efficiency of policy updates plays a significant role as well, which is a key reason why TCE outperforms BBRL in the majority of tasks we have reported. Similarly, PINK's performance limitations can be attributed to constraints in learning its Q-function, a challenge it shares with SAC. These factors may account for their relatively poorer performance in some tasks.\n\n### **Formatting Issue**\n\nWe apologize for the inconvenience, this problem is fixed in the updated version of the paper.\n\n### **Approach to directly represent each segment**\n\nSome studies, such as [5], have employed movement primitives to represent individual segments. However, this approach has been shown to underperform compared to methods that model the entire trajectory, like BBRL, as previously discussed in [4].\n\n\n**References**\n\n[1] Peters, J. and Schaal, S., 2008. Reinforcement learning of motor skills with policy gradients. *Neural networks*, *21*(4), pp.682-697.\n\n[2] Kober, J. and Peters, J., 2008. Policy search for motor primitives in robotics. *Advances in neural information processing systems*, *21*.\n\n[3] Peters, J. and Schaal, S., 2006, October. Policy gradient methods for robotics. In *2006 IEEE/RSJ International Conference on Intelligent Robots and Systems* (pp. 2219-2225). IEEE.\n\n[4] Otto, F., Celik, O., Zhou, H., Ziesche, H., Ngo, V.A. and Neumann, G., 2023, March. Deep black-box reinforcement learning with movement primitives. In *Conference on Robot Learning* (pp. 1244-1265). PMLR.\n\n[5] Bahl, Shikhar, et al. \"Neural dynamic policies for end-to-end sensorimotor learning.\"\u00a0*Advances in Neural Information Processing Systems*\u00a033 (2020): 5058-5069.\n\n==============================================\n\nIf you have any further questions, please feel free to ask us.\n\nThank you.\n\nTCE Authors"
                    },
                    "title": {
                        "value": "Reply to reviewer psBV, #1"
                    }
                },
                "number": 8,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission5877/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700320549200,
                "cdate": 1700320549200,
                "tmdate": 1700320571470,
                "mdate": 1700320571470,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "k0ZYWyKXj6",
                "forum": "mnipav175N",
                "replyto": "9OwLzZYYw5",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission5877/Reviewer_psBV"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission5877/Reviewer_psBV"
                ],
                "content": {
                    "comment": {
                        "value": "Thank you to the authors for their detailed response. \n\nMany of my initial concerns have been addressed and I appreciate the inclusion of new ablation experiments.\n\nHowever, I remain unconvinced about the benefits of utilizing a full covariance matrix in your approach.\nI feel that it lacks a baseline of TCE with diagonal covariance: it is not evident that the benefits of full covariance in BBRL Cov would extend to TCE.\n\nAdditionally, I am interested in understanding the training time overhead when using a full covariance compared with that of a diagonal covariance. Could the authors provide details on this?"
                    }
                },
                "number": 13,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission5877/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700556033297,
                "cdate": 1700556033297,
                "tmdate": 1700556033297,
                "mdate": 1700556033297,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "Sam7nUmlZu",
                "forum": "mnipav175N",
                "replyto": "DFn01HHdOK",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission5877/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission5877/Authors"
                ],
                "content": {
                    "title": {
                        "value": "We added an additional ablation study (TCE Cov vs. TCE Std) in supplementary, section R.7"
                    },
                    "comment": {
                        "value": "Dear reviewer psBV,\n\nThank you for your feedback. We are glad to note that our efforts have addressed your concerns. \nTo address the remaining issue, we have included an additional ablation study in the updated supplementary material, Section R.7. It conducts a comparison of TCE against its STD variant using a factorized Gaussian policy for the parameter. The results clearly indicate underperformance by the std version, and we attribute this to its limited capacity in modeling movement correlations.\n\nLink to supplementary: \nhttps://openreview.net/attachment?id=mnipav175N&name=supplementary_material\n\n**Computation cost**\n\nIn terms of computational load, the main distinctions between cov and std policies are\n\n- Computational Cost in Convex Optimization for Trust Region Enforcement\n\n  As discussed in [1], cov policies require additional computational effort to satisfy constraints like the KL divergence in the trust region enforcement. This is because cov policies include off-diagonal elements representing the 'rotation' of the Gaussian distribution, necessitating more time in the projection process compared to std policies.\n\n- Matrix Inversion During Likelihood Computation\n\n  For a cov policy, inverting the covariance matrix during likelihood computation has a time complexity of $O(n^3)$, where $n$ is the dimension of the parameter vector $w$. In contrast, for a std policy, this operation has a time complexity of $O(n)$.\n\nThese factors translate into a 20-50% difference in training time for methods like BBRL when comparing Cov and Std policies.\nHowever, in the case of TCE, our focus is on leveraging step-based information for policy updates, where the likelihood computation is w.r.t. the trajectory, as opposed to the parameter $w$. \nHere, a std distribution in the parameter space maps to a blocked diagonal covariance matrix in the trajectory space, as shown in section R.2, figure 1c. Despite its simpler appearance, this format maintains the same time complexity for likelihood computation as a full trajectory covariance matrix.\nThus, the difference in training TCE Std and TCE Cov is minor, arount 10%.\n\nTo efficiently manage the likelihood computation in trajectory space, we employ techniques that estimate trajectory likelihood using segment-based counterparts. As a result of this approach, the computation time for TCE is approximately twice that of BBRL.\n\n\n**References**\n\n[1] Otto, Fabian, et al. \"Differentiable Trust Region Layers for Deep Reinforcement Learning.\" International Conference on Learning Representations. 2021.\n\n======================================================================\n\nPlease let us know if you have further concerns to our work.\n\nThank you,\n\nTCE Authors."
                    }
                },
                "number": 14,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission5877/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700654019588,
                "cdate": 1700654019588,
                "tmdate": 1700690082600,
                "mdate": 1700690082600,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "X9AIY6u7wu",
                "forum": "mnipav175N",
                "replyto": "Sam7nUmlZu",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission5877/Reviewer_psBV"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission5877/Reviewer_psBV"
                ],
                "content": {
                    "comment": {
                        "value": "Thanks for the clarifications. I appreciate the effort in adding the ablations.\nAs my concerns have been addressed, I am happy to increase the score."
                    }
                },
                "number": 22,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission5877/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700734192972,
                "cdate": 1700734192972,
                "tmdate": 1700734192972,
                "mdate": 1700734192972,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "DIUaLteQ1v",
            "forum": "mnipav175N",
            "replyto": "mnipav175N",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission5877/Reviewer_ALmz"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission5877/Reviewer_ALmz"
            ],
            "content": {
                "summary": {
                    "value": "By using parametric trajectory generators such as Movement Primitives (MP), episodic reinforcement learning techniques tackle robot trajectory generation issues by rephrasing them as contextual optimization. Although these methods are efficient in producing smooth trajectories and detecting certain movement correlations, they do not make use of the temporal structure present in trajectories, leading to less sample efficiency. To overcome these problems, the authors provide the Temporally-Correlated Episodic RL (TCE) technique. By sampling multi-second trajectories in a parameterized space, TCE improves exploration efficiency and ensures high-order trajectory smoothness and movement correlation capture. TCE divides the whole trajectory into smaller parts for policy changes, assessing each part according to its unique benefits."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "2 fair"
                },
                "contribution": {
                    "value": "2 fair"
                },
                "strengths": {
                    "value": "1. Figure 3 efficiently summarizes the entire learning framework.\n\n2. The code base and config files are provided for double-blind review, which enhances the credibility of the study."
                },
                "weaknesses": {
                    "value": "1. I suggest the authors to spend more time re-organizing this paper. The overall description is very messy at present. There is no good connection between the various parts, making it difficult to follow the storyline.\n\n2. Only previous works and their limitations are discussed in the BACKGROUND AND RELATED WORKS section without explaining how they relate to your own work. What's more, there are a lot of claims or conclusions without adding corresponding references, especially in the EPISODIC REINFORCEMENT LEARNING section.\n\n3. The writing of this paper should be improved. The current expression is too redundant, especially in the LIKELIHOOD COMPUTATION OF A SAMPLED TRAJECTORY SEGMENTS section. The author should reasonably remove some content to refine it.\n\n4. The simulation experiment results do not verify the effectiveness of the method. Compared with strong step-based methods, the proposed method does not demonstrate the obvious final performance improvement. Although the variance of the proposed method is the lowest in the CONTACT-RICH MANIPULATION section, the gSDE approach achieves better performance in 2 of 3 tasks. Moreover, the BBRL Cov. algorithm achieves a 20% higher success rate with faster convergence in the HITTING TASK."
                },
                "questions": {
                    "value": "The authors are suggested to experiment with some real scenes. The simulation environments now set by the authors can not provide a big enough challenge to verify the robustness of the algorithm."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "3: reject, not good enough"
                },
                "confidence": {
                    "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 3,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission5877/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1699032929645,
            "cdate": 1699032929645,
            "tmdate": 1699636622667,
            "mdate": 1699636622667,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "lssUWA5srC",
                "forum": "mnipav175N",
                "replyto": "DIUaLteQ1v",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission5877/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission5877/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Reply to reviewer ALmz, #1"
                    },
                    "comment": {
                        "value": "### **Dear reviewer ALmz,**\n\nWe are grateful for the time and effort you have dedicated to reviewing our submission. In response to your valuable feedback, we are currently re-structuring the storyline of our paper to enhance its readability. An updated version will be provided shortly. In the meantime, we have addressed the other concerns and questions you raised to the best of our knowledge, as detailed below.\n\n### **[Update Log, Nov. 18.2023]**\n\nAddress the major concerns of all reviewers.\n\nUpload additional experiment and ablation study to Supplementary Material.\n\n### **[Update Log, Nov. 22, 2023]**\nRestructure the paper's storyline, and address the remaining concerns from the reviewers\n\n### **Writing:**\n\n- We agree with you that the storyline and the connection to other works need to be improved. The revised version will be updated shortly.\n\n### **Experiments:**\n\n- While we acknowledge that certain baselines, such as gSDE in the box-pushing sparse task and BBRL-cov in table tennis, outperform TCE in specific scenarios, we believe that TCE consistently delivers comparable results across most tasks. Notably, in the MetaWorld tasks, TCE not only achieved the highest asymptotic performance but also maintained the most consistent performance profile. This consistency is characterized by successfully solving a majority of tasks and maintaining a high success rate in those it can solve. Although gSDE shows strong results in box-pushing tasks, its overall performance in the MetaWorld's 50 tasks is moderate, and it fails entirely in the table tennis task. In stark contrast, TCE still manages to achieve a commendable success rate of 65% in the latter.\n- Real Scenes\n    \n    We agree that comparing these methods in real-world environments would be very useful. However, as mentioned in our paper, many RL baselines have a problem with smooth movements in their trajectories, which could harm real hardware. Following reviewer dLeV's suggestion, we added a new section on trajectory smoothness in the updated supplementary material (Section R.1). This section shows that most step-based RL methods have very low smoothness, even with well-trained policies. On the other hand, using movement primitives has been successful in real tasks, like imitation learning [1] and Sim2Real transfer in RL [2]. Yet, for real-world applications, we believe it essential to first test and confirm the effectiveness of the policy in a simulation environment before transitioning it to real-world scenarios.\n    \n\n**References**\n\n[1] Gomez-Gonzalez, Sebastian, et al. \"Adaptation and robust learning of probabilistic movement primitives.\" IEEE Transactions on Robotics 36.2 (2020): 366-379.\n\n[2] Klink, Pascal, Hany Abdulsamad, Boris Belousov, and Jan Peters. \"Self-paced contextual reinforcement learning.\" In Conference on Robot Learning, pp. 513-529. PMLR, 2020.\n\n\n================================================\n\nIf you have any further questions, please feel free to ask us.\n\nThank you.\n\nTCE Authors"
                    }
                },
                "number": 6,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission5877/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700320140848,
                "cdate": 1700320140848,
                "tmdate": 1700674855768,
                "mdate": 1700674855768,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "nGCj5sxCQa",
                "forum": "mnipav175N",
                "replyto": "DIUaLteQ1v",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission5877/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission5877/Authors"
                ],
                "content": {
                    "title": {
                        "value": "We updated the paper manuscript"
                    },
                    "comment": {
                        "value": "Dear reviewer ALmz,\n\nwe followed your valuable feedbacks and updated the content of the paper, especially making the structure of Section 3 more concise.\nAs the rebuttal phase is about to finish, we are wondering if our previous responses have addressed your concerns properly. Your feedback will definitely help us reach a more reasonable decision on our submission. \n\n=======================================================================\n\nThe main updates in the manuscript that related to your feedback:\n\n- Revise the abstract and restructure the introduction section to explicitly define the concepts of Step and Episodic RL.\n- Clarify the term \"Open the Black Box\" in the title, as well as the research gap that we want to solve.\n- Emphasize the main contribution of the paper, and discuss how our framework differs from the existing ones.\n- Split the previous Section 2 \"Background and Related Works\" into \n  - a) \"Preliminaries\" as Section 2, focusing on the methods foundational to our framework.\n  - b) \"Related Works\" as a new Section 4, discussing literature approaches that address similiar research gaps.\n- Link Episodic RL to the MDP in Section preliminaries.\n- Review and refine the claims at the end of Section 2.1, ensuring they are supported by relevant references.\n- For each preliminary method discussed in Section 2, clearly state the specific problem it targets and its relevance to Episodic RL.\n- Provide detailed explanations of the mathematical variables used in our framework, including their dimensions.\n- Remove redundant content in Section 3 and streamline its structure for better clarity and conciseness.\n- Include a discussion on the works closely related to ours, with a special focus on the development of Episodic RL\n- Discuss BBRL (Deep Black Box Reinforcement Learning) in detial as it is highly relevant to our work.\n\n=======================================================================\n\nAdditionally, we have included an algorithm box to help understand the paper, along with other newly added evaluations and ablation studies in the updated supplementary material.\n\nLink to updated paper: https://openreview.net/pdf?id=mnipav175N\n\nLink to supplementary material: https://openreview.net/attachment?id=mnipav175N&name=supplementary_material\n\n=======================================================================\n\n\nThank you!\n\nAll the best,\n\nTCE Authors"
                    }
                },
                "number": 16,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission5877/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700675264904,
                "cdate": 1700675264904,
                "tmdate": 1700725592371,
                "mdate": 1700725592371,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "6vPZLpHCql",
            "forum": "mnipav175N",
            "replyto": "mnipav175N",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission5877/Reviewer_dLeV"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission5877/Reviewer_dLeV"
            ],
            "content": {
                "summary": {
                    "value": "The paper proposes a framework called Temporally-Correlated Eposodic RL, which is able to generate smooth trajectories and capture the movement correlation. In particular, the contributions are:\nA. Change the action space to the parameter space of the smooth trajectories.\nB. Reconstruct the temporal correlation using pair information.\nC. Complete trajectory sampling.\nD. Exact likelihood computation for trajectory segments."
                },
                "soundness": {
                    "value": "2 fair"
                },
                "presentation": {
                    "value": "1 poor"
                },
                "contribution": {
                    "value": "1 poor"
                },
                "strengths": {
                    "value": "1. The new parameterization of the trajectory seems to guarantee smoothness by construction."
                },
                "weaknesses": {
                    "value": "1. The novelty of the algorithm is incremental. It is a direct application of Li et al. 2023 to the RL regime, by (1) changing the action space to the parameter space of trajectories, and (2) enlarging the timestep to the segmentation scale.\n\n2. Many terms in the paper are described with words, which makes it hard to understand. I strongly suggest the authors provide mathematical definitions. For example, \n\n- a. Since this is still an RL approach, define the Markov Decision Process first. What is the action space? What is the state space? Now you can explain how your approach differs from traditional RL more clearly, by providing us the details in this different MDP. A tricky question here is that since MDP is Markovian, why do you need the temporal correlation?\n\n- b. It would be more helpful to define the dimensions of $y$, $w$, $\\Sigma$ and $s$.\n\n- c. What are d_mean and d_cov in Equation (4)? Are they Frobenius distances?\n\n3. As a reader, I feel many unimportant texts are taking too many places, which makes it not easy to understand the paper. For example, Sections 3.1, 3.2, and 3.4 don't need so many places to mention, since they are merely (a) complete-trajectory sampling, (b) GAE, and (c) TRPO-like. Instead, providing the pseudo-code for the whole learning process would be more valuable as a complement to Figure 3. Currently, there are too many technical things and curves in Figure 3, which makes it hard to understand the learning procedure from this single figure.\n\n4. The result is not sufficient to show the significance of the proposed method. In particular,\n\n- a. After checking Appendix C.2, I found that the baselines perform generally well when TCE works well. However, there exist some situations where TCE significantly fails and the other baselines still work well, and these situations are not rare, including LeverPull, StickPull, Hammer, ButtonPressTopdown, and ButtonPressTopdownWall. \n\n- b. Furthermore, the curves for SAC and PINK are terminated after 10M and 27M interactions respectively, whereas the other methods terminate at 50M interactions, which is an unfair comparison. It is hard to show the efficiency of this algorithm unless these baselines are finished. The reason is: in many cases, these baselines would raise their success rates nonlinearly during the training process, and we cannot conclude by only inspecting their intermediate performances.\n\n- c. Several key ablation studies are missing to test the soundness of each proposed component. See the questions.\n\nFinally, there are some typos in the paper. For example, in Equation 5, the left curly brace is missing. In Equation 6, the (|s) looks strange, it might be (s) instead."
                },
                "questions": {
                    "value": "1. What does black box in the title stand for? Can you help me accurately define it? Does it mean the dynamics is black-box, or the policy approximator (neural network) is black-box? Though this term is repeated several times in the paper, there is no accurate definition in the paper. Furthermore, since the title says 'open the black box', is your algorithm a white-box algorithm?\n\n2. Is Figure 1 a real experiment, or just an illustrative explanation?\n\n3. It seems that Section 3.1 is just a description of whole-trajectory sampling. Is there any novelty in terms of the exploration here? Doesn't normal RL actor also sample using their own stochastic policy?\n\n4. \n> Notably, the off-policy methods SAC and PINK were trained with less samples than used for on-policy methods due to their limitations in parallel environment utilization.\n\n      What does the limitation refer to here? Why cannot SAC and PINK be deployed to parallel training? (Also, 'fewer' samples, not 'less' samples).\n\n5. In terms of the ablation studies:\n\n- a. The PPO and SAC in this paper are only used to generate low-level actions. However, both of them are general RL frameworks, which should also be applicable even if the action space is changed to the parameter space of the trajectory. And these versions in the parameter space of trajectory are missing as the baselines. You can still claim that these new baselines are just some naive version of TCE since they do not really calculate per-segment credit assignment and there's no exact probability calculation. But, showing how these frameworks work in this new parameter space is still important, since now we can evaluate how this different action space could improve the sample efficiency by itself.\n\n- b. Smoothness comparison. Define a metric for smoothness, and evaluate how all the final trajectories for all the methods perform under this metric. Since you claim that TCE helps the smoothness, then only showing the success rate is not sufficient.\n\n- c. The significance of the exact probability calculation. If you abandon this component and just use the normal p(w) instead of p(y), how would the performance change empirically? \n\n- d. One thing I am wondering is how this temporal correlation helps the sampling complexity. Can you provide the final Sigma for each DoF? Ideally, this matrix should be far from the diagonal matrix, otherwise, we can just use the step-wise algorithm."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "6: marginally above the acceptance threshold"
                },
                "confidence": {
                    "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                },
                "first_time_reviewer": {
                    "value": "Yes",
                    "readers": [
                        "ICLR.cc/2024/Conference/Program_Chairs",
                        "ICLR.cc/2024/Conference/Submission5877/Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission5877/Reviewer_dLeV",
                        "ICLR.cc/2024/Conference/Submission5877/Senior_Area_Chairs"
                    ]
                }
            },
            "number": 4,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission5877/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1699250490108,
            "cdate": 1699250490108,
            "tmdate": 1700675767645,
            "mdate": 1700675767645,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "UyohTPbP1i",
                "forum": "mnipav175N",
                "replyto": "6vPZLpHCql",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission5877/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission5877/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Reply to reviewer dLeV, #1"
                    },
                    "comment": {
                        "value": "### **Dear Reviewer dLeV,**\n\nThank you for your insightful review of our paper. Your feedback has been instrumental in enhancing our work. We have addressed the majority of your concerns and added supplementary material with new experiments and ablations. Currently, we are working on addressing the remaining questions and are in the process of restructuring the paper.\n\n\n**[Update Log, Nov. 18.2023]**\n\nAddress the major concerns of all reviewers.\n\nUpload additional evaluation and ablation study to Supplementary Material\n\n\n**[Update Log, Nov. 22, 2023]**\n\nRestructure the paper's storyline, and address the remaining concerns from the reviewers\n\n\n### **Episodic RL & Black-Box Optimization**\n\nEpisodic Reinforcement Learning (RL), as discussed in references [1,2,3,4], is a distinct branch in the evolution of RL that emphasizes maximizing the return of an entire episode, rather than focusing on the internal dynamics of the environment. This approach shifts the search for solutions from the per-step action space to the trajectory parameter space, thereby promoting broader exploration. In this context, entire trajectories are often treated as single data points, and models are typically trained using black-box optimization methods [5,6,7,8]\n\nThe term 'black box' in our title reflects the essence of these methods, rooted in black-box optimization principles, which tend to overlook the detailed step-based information acquired during interactions with the environment. While these methods excel in expansive exploration and trajectory smoothness, they generally require a larger number of samples for effective policy training. In contrast, step-based RL methods have shown substantial improvements in learning efficiency by leveraging this step-based information.\n\n### **Novelty & Opening the Black Box**\n\nDespite the leverage of previous approaches, we believe TCE has made a distinct algorithmic advancement in the field of RL. As a novel framework, TCE uniquely incorporates step-based information into the policy updates of episodic RL, simultaneously preserving trajectory smoothness and facilitating correlated action exploration both temporally and across DoF. Thus, by effectively integrating the strengths of the two RL methodologies, TCE successfully 'opens the black box\u2019.\n\n### **Writing**:\n\n- Figure 1 is an illustration, not an experiment\n- We will add a MDP description in the updated paper. However, our learning framework maintains the Markovian property, as discussed in the Chapter 3.1 of [9]. The Markovian property specifically concerns the state transition probability, $p(s_{t+1}, r_{t} |~s_{t}, a_{t})$, indicating that the next state and reward depend solely on the current state and action. It does not impose any assumptions on the policy or the decision process.\n- d_mean and d_cov are general notations for discrepancy measures, we specifically use KL-divergence in this work as it has been shown to be effective for policy learning within the parameter space of Motion Primitives [5].\n\n### **Performance against Baselines**\nWhile we recognize that the performance gains in certain environments may be marginal, it is crucial to highlight that our algorithm, TCE, consistently demonstrates superior or at least comparable results in the majority of tasks when benchmarked against robust baselines. A notable example is the table tennis task, where gSDE failed entirely, yet our algorithm achieved a 60% success rate. We acknowledge TCE's underperformance in 5 out of the 50 Metaworld tasks. However, considering the wide variety of task types in Metaworld, this is not unusual. Similar to other baseline methods, which also exhibit variable performance across different tasks, TCE has not been specifically optimized for any individual task. Despite this, it has shown exceptional overall performance across the comprehensive Metaworld benchmark. This not only underscores TCE's robustness but also its adaptability, making it a highly effective method in a broad spectrum of scenarios.\n\n### **Training horizon of off-policy methods**\nThe original SAC employs an update-to-data (UTD) ratio of 1, as suggested in references [10], a configuration known for balancing training stability with sample efficiency. However, this ratio does not leverage the advantages of parallel processing across multiple environments. The main challenge is not the collection of samples, but the network updates and the overhead involved in data exchange between the policy and the environments. This issue often restricts training to a relatively lower number of samples, typically \u2264 10M steps, as described in [10]. Considering that off-policy methods are designed for enhanced sample efficiency, their failure to learn effectively from a data volume comparable to that utilized by on-policy methods highlights their inferior performance in the tasks evaluated in the paper."
                    }
                },
                "number": 4,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission5877/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700319423643,
                "cdate": 1700319423643,
                "tmdate": 1700674721411,
                "mdate": 1700674721411,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "MxA11GJ16h",
                "forum": "mnipav175N",
                "replyto": "6vPZLpHCql",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission5877/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission5877/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Reply to reviewer dLeV, #1"
                    },
                    "comment": {
                        "value": "### **Ablation Studies:**\n\n- We include a smoothness evaluation in the updated supplementary material, Section R.1. The evaluation is conducted using three common smoothness metrics in robotics and motion planning. The comparison shows TCE and the BBRL Cov have achieved the highest smoothness among all the approaches.\n- In Section R.2 of the updated supplementary material, we present a qualitative evaluation of the action correlation for all methods. This evaluation highlights the varying capacities of these methods in modeling movement correlations. Both TCE and BBRL Cov successfully model correlations across both time and inter-DoF. In contrast, the original BBRL and PINK are limited to modeling correlations within individual DoF. gSDE demonstrates the capability to model temporal correlations, but only over a few consecutive time steps. Notably, PPO, TRPL, and SAC do not engage in action correlation modeling.\n    \n    However, it is important to emphasize that the capability to model movement correlation is not the sole determinant of successful performance. The BBRL, for instance, is hindered by an inefficient policy update strategy. Similarly, PINK's performance limitations can be attributed to constraints in learning its Q-function, a challenge it shares with SAC. These factors may account for their relatively poorer performance in some tasks.\n    \n- We agree that including tests for PPO and SAC with Movement Primitives (MP) action space is an important ablation study. Previous work [5] has already shown the ineffectiveness of combining PPO with Movement Primitives (MP).\n    \n    In the updated supplementary material, Section R.3, we include an additional ablation study where we combined SAC with MP parameters as the action space. The results from this study suggest that this combination is not effective. We believe this ineffectiveness arises from the increased dimensionality of the action space, which significantly complicates the learning process for the Q-function.\n    \n- Using p(w) instead of p(y) for likelihood is exactly what BBRL [5] did. We already included that as a baseline, but we agree that more discussion of the method should be included in the experiment section to clarify the differences, and we are currently working on that.\n\n**References:**\n\n[1] Whitley D, Dominic S, Das R, Anderson CW. Genetic reinforcement learning for neurocontrol problems. Machine Learning. 1993 Nov;13:259-84.\n\n[2] Igel, C., 2003, December. Neuroevolution for reinforcement learning using evolution strategies. In *The 2003 Congress on Evolutionary Computation, 2003. CEC'03.* (Vol. 4, pp. 2588-2595). IEEE.\n\n[3] Peters, J. and Schaal, S., 2008. Reinforcement learning of motor skills with policy gradients. *Neural networks*, *21*(4), pp.682-697.\n\n[4] Kober, J. and Peters, J., 2008. Policy search for motor primitives in robotics. *Advances in neural information processing systems*, *21*.\n\n[5] Otto, F., Celik, O., Zhou, H., Ziesche, H., Ngo, V.A. and Neumann, G., 2023, March. Deep black-box reinforcement learning with movement primitives. In *Conference on Robot Learning* (pp. 1244-1265). PMLR.\n\n[6] A. Abdolmaleki, D. Sim\u02dcoes, N. Lau, L. P. Reis, and G. Neumann. Contextual direct policy\nsearch. Journal of Intelligent & Robotic Systems, 96(2):141\u2013157, 2019.\n\n[7] Salimans, J. Ho, X. Chen, S. Sidor, and I. Sutskever. Evolution strategies as a scalable\nalternative to reinforcement learning. arXiv preprint arXiv:1703.03864, 2017.\n\n[8] Tangkaratt, V., Van Hoof, H., Parisi, S., Neumann, G., Peters, J. and Sugiyama, M., 2017, February. Policy search with high-dimensional context variables. In *Proceedings of the AAAI Conference on Artificial Intelligence* (Vol. 31, No. 1).\n\n[9] Sutton, Richard S., and Andrew G. Barto.\u00a0Reinforcement learning: An introduction. MIT press, 2018.\n\n[10] Haarnoja, T., Zhou, A., Abbeel, P. and Levine, S., 2018, July. Soft actor-critic: Off-policy maximum entropy deep reinforcement learning with a stochastic actor. In *International conference on machine learning* (pp. 1861-1870). PMLR.\n\n\n================================================\n\nIf you have any further questions, please feel free to ask us.\n\nThank you.\n\nTCE Authors"
                    }
                },
                "number": 5,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission5877/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700319634198,
                "cdate": 1700319634198,
                "tmdate": 1700321037367,
                "mdate": 1700321037367,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "UmHQHs97Cg",
                "forum": "mnipav175N",
                "replyto": "6vPZLpHCql",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission5877/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission5877/Authors"
                ],
                "content": {
                    "title": {
                        "value": "To reviewer dLeV"
                    },
                    "comment": {
                        "value": "Dear reviewer dLeV,\n\nWe updated the paper manuscript following your valuable feedback.\n\nAs the rebuttal period is near to finish, we are eager to know if our recent responses have sufficiently addressed your concerns. Your insights will definitely guide us towards a more informed decision regarding our submission. We appreciate your feedback and thank you for your time.\n\nAll the best,\n\nTCE Authors"
                    }
                },
                "number": 15,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission5877/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700674548455,
                "cdate": 1700674548455,
                "tmdate": 1700674548455,
                "mdate": 1700674548455,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "6gWrFLQdBs",
                "forum": "mnipav175N",
                "replyto": "UmHQHs97Cg",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission5877/Reviewer_dLeV"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission5877/Reviewer_dLeV"
                ],
                "content": {
                    "title": {
                        "value": "Thank you for your reply"
                    },
                    "comment": {
                        "value": "Thank you for your great effort, and I think most of my concerns are addressed well. Typically, I see \n- the temporal correlation shows the correlation matrix is not diagonal (if possible, please provide a numerical table showing how far it is from the diagonal matrix when the revision phase begins)\n- the proposed method outperforms during the smoothness experiment\n- the SAC in parameter space underperforms\n- the writing is being improved (still, a pseudo-code would be appreciated in the future revision)\n- the technical challenge for running SAC is explained\n\nI guess the main concern is still from the complete failure under specific environments in Meta-World (4 out of 50). In these experiments, the proposed method not only underperform, but yields nearly 0% success rates. This phenomenon is rare to see for some standard algorithms, (for example SAC), since we would expect the method could more or less yield some trajectories with non-zero scores, if the environment is densely rewarded. In the future, a small exploration of why the method fails under these specific environments would be greatly appreciated. Knowing the limitations better and providing the analysis more thoroughly would also help the community be more glad to try your method in the long term.\n\nThe paper itself definitely looks unique due to its orthogonal exploration in providing smooth trajectories. I'm happy to update the score to 6."
                    }
                },
                "number": 18,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission5877/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700677066279,
                "cdate": 1700677066279,
                "tmdate": 1700677066279,
                "mdate": 1700677066279,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    }
]