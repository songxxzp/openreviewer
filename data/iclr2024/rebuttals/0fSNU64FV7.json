[
    {
        "title": "Sorting Out Quantum Monte Carlo"
    },
    {
        "review": {
            "id": "5yeazuxkPO",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission8033/Reviewer_TwGB"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission8033/Reviewer_TwGB"
            ],
            "forum": "0fSNU64FV7",
            "replyto": "0fSNU64FV7",
            "content": {
                "summary": {
                    "value": "This work introduces an interesting neural-network architecture that is antisymmetric, for continuous input variables and potentially usable as an alternative to determinants in neural wave functions applications."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "3 good"
                },
                "strengths": {
                    "value": "The paper is well written and describes the idea in good detail. It is also the first reported application of a sort-based idea that achieves chemical accuracy, at least on small systems."
                },
                "weaknesses": {
                    "value": "The ansatz presented is still applied to relatively small systems. Also, I am fundamentally worried that given the discontinuity, the kinetic energy is not well defined (see questions). As a minor point, the discussion could be slightly improved, mentioning for example that second-quantized approaches are also determinant-free and based on sorting fermions (e.g. https://www.nature.com/articles/s41467-020-15724-9 )."
                },
                "questions": {
                    "value": "Besides the small (minor) comment on the presentation/connection to determinant-free second-quantized approaches (see above), I mainly have two more in-depth questions : \n\n1. My understanding of this and related approaches is that the resulting wave function is not continuous in space. How does this affect the evaluation of the kinetic contribution to the local energy and how can the authors be sure that the resulting discontinuity does not affect the boundary conditions of the problem? It is indeed well known that if one has a singularity in the laplacian of the wave function, the energy can even violate the variational bound and be lower than the exact one. \n\n2. One appealing reason why Slater Determinants are used is because the non-interacting (or, better, mean-field) limit is exactly recovered by the Determinant form. Can the authors prove that a sortlet can efficiently recover (maybe even in a supervised way, if an analytical proof is not possible) the Hartree Fock limit?"
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "6: marginally above the acceptance threshold"
                },
                "confidence": {
                    "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
                },
                "code_of_conduct": {
                    "value": "Yes"
                },
                "first_time_reviewer": {
                    "readers": [
                        "ICLR.cc/2024/Conference/Program_Chairs",
                        "ICLR.cc/2024/Conference/Submission8033/Senior_Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission8033/Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission8033/Reviewer_TwGB"
                    ]
                }
            },
            "number": 1,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission8033/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1697194977801,
            "cdate": 1697194977801,
            "tmdate": 1700728122637,
            "mdate": 1700728122637,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "IPm25m4m1z",
                "forum": "0fSNU64FV7",
                "replyto": "soSKUnV8YI",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission8033/Reviewer_TwGB"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission8033/Reviewer_TwGB"
                ],
                "content": {
                    "title": {
                        "value": "Discontinous local energy"
                    },
                    "comment": {
                        "value": ">  it's important to keep in mind that even for the exact physical solution, it's known that the Kato cusp conditions enforce a discontinuity in the gradient of the wavefunction (see Kato, 1958). Therefore, the Schrodinger equation \n is already known to not be satisfied everywhere in the mathematical sense.\n\nI think the other reviewer was referring to the discontinuity of the local energy E_loc(R)=<R|H|Psi>/<R|Psi> . The exact wave function does not have any discontinuity in the local energy (which is strictly a constant as a function of R, for the exact solution) and the Kato cusp condition is indeed used to enforce that the local energy does not diverge at any point in space. \n\nThis issue of discontinuity is also what I meant in my comment. In general, I agree that there can/should be cusps, but these should be such that they satisfy the boundary conditions of the problem (either on the nodes, or on the boundaries of the box, for a periodic system, for example)."
                    }
                },
                "number": 6,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission8033/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700384199620,
                "cdate": 1700384199620,
                "tmdate": 1700384199620,
                "mdate": 1700384199620,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "34nQML0tex",
            "forum": "0fSNU64FV7",
            "replyto": "0fSNU64FV7",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission8033/Reviewer_G9wz"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission8033/Reviewer_G9wz"
            ],
            "content": {
                "summary": {
                    "value": "In \"Sorting Out Quantum Monte Carlo\", the authors propose an antisymmetrizer for neural wavefunction ans\u00e4tze in quantum Monte Carlo methods based on sorting. Compared to the typical antisymmetrization scheme based on determinants, which scales $O(N^3)$ with the number of electrons $N$, the proposed \"sortlet\" antisymmetrization has $O(N\\log N)$ complexity. The overall complexity of evaluating a sortlet wavefunction is given as $O(N^2\\log N)$ due to the $O(N^2)$ complexity of evaluating the $N$ terms $\\alpha_i(r)$ used in the construction of a sortlet (Eq. 6). The proposed method is applied to variational quantum Monte Carlo calculations of atoms and small molecules with at most ten electrons and compared to an $O(N^2)$-scaling ansatz based on the Vandermonde determinant and the standard $O(N^3)$ antisymmetrization based on determinants. While the sortlet ansatz is superior to the Vandermonde ansatz in all cases and reaches chemical accuracy for some of the smallest systems, its performance for more complicated systems such as the methane molecule is significantly below the standard determinant-based ansatz."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "4 excellent"
                },
                "contribution": {
                    "value": "1 poor"
                },
                "strengths": {
                    "value": "The paper is well written and the proposed method clearly described. The section on variational quantum Monte Carlo is an excellent introduction for readers without a quantum chemistry education and makes the topic very approachable."
                },
                "weaknesses": {
                    "value": "The proposed sortlet ansatz is only tested on very small systems. It performs significantly worse compared to the standard determinant-based ansatz for systems as small as the nitrogen atom (7 electrons). While the authors admit that this is the case (\"our results are far from competitive with those of neural network ansatz with full determinant\"), I do not agree with their statement that the proof-of-concept described in this paper is sufficient evidence that the sortlet ansatz is a promising direction and that their method could become competitive simply by means of additional investments in software engineering. The main problem I see is that the sortlet ansatz, which requires discontinuous $\\alpha$ to be universal, is inherently at odds with using a neural network-based wavefunction, since neural networks are typically quite bad at representing discontinuities. From the results presented in the paper, it is unclear how the sortlet ansatz could be improved in the future to reach competitive results. I think the paper would benefit from additional experiments on larger systems (to assess whether the sortlet ansatz systematically becomes worse with increasing system size) and a detailed analysis *why* the ansatz fails (e.g. for nitrogen)."
                },
                "questions": {
                    "value": "1. The authors show that increasing the number of sortlets reduces the error w.r.t. the ground state for boron (Fig. 3a). How do similar curves look for the \"failure cases\" (e.g. nitrogen)? Is it possible to improve the results by simply adding more sortlets? If not, can the authors identify reasons *why* this is not possible?\n\n2. The $O(N\\log N)$ scaling of sorting versus the $O(N^3)$ complexity of computing a determinant is presented as one of the main motivations of the work. Given that the sortlet ansatz currently only works well for small systems, I wonder how large the computational advantage is in practice. I assume that for methods like FermiNet/PsiFormer, the calculation of the determinant is not actually the bottleneck (for small systems). I therefore suggest the authors show timing comparisons for training until chemical accuracy for the different methods (sortlet/Vandermonde/determinant).\n\n3. When looking at the results presented in Fig. 2, in particular the results for the isolated atoms, it seems that the sortlet method starts to fail as soon as there is more than one unpaired electron in a given subshell. I suggest that the authors try to determine why this is the case. An analysis of the reasons why the sortlet ansatz fails would allow to judge whether it is reasonable to expect improvements with additional engineering effort in the future, or whether such an effort is futile. It might also allow insights into how alternative sub-cubic antisymmetrization methods could (or couldn't) be designed.\n\n4. A very minor point about the use of \"ansatz\": There are several occurences of the word \"ansatz\" where the plural form \"ans\u00e4tze\" would be the gramatically correct form (e.g. \"when designing ansatz\" should be \"when designing ans\u00e4tze\" or \"when designing an ansatz\"). I suggest to change \"ansatz\" to the gramatically correct form \"ans\u00e4tze\" where appropriate."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "3: reject, not good enough"
                },
                "confidence": {
                    "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
                },
                "code_of_conduct": {
                    "value": "Yes"
                },
                "first_time_reviewer": {
                    "value": "Yes",
                    "readers": [
                        "ICLR.cc/2024/Conference/Program_Chairs",
                        "ICLR.cc/2024/Conference/Submission8033/Senior_Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission8033/Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission8033/Reviewer_G9wz"
                    ]
                }
            },
            "number": 2,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission8033/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1697538532484,
            "cdate": 1697538532484,
            "tmdate": 1699636991553,
            "mdate": 1699636991553,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "UFixXkrgC0",
                "forum": "0fSNU64FV7",
                "replyto": "34nQML0tex",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission8033/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission8033/Authors"
                ],
                "content": {
                    "comment": {
                        "value": "Thanks for your review! So when it comes to universality, it is true that our proof, in its construction, uses a discontinuous $\\alpha$ equivariant function. But, as pointed out by another reviewer, the proof given in the original ferminet paper also has the same problem. So if this was a serious issue, like you say \u201cfundamentally at odds\u201d with continuity of neural network used as input, then other neural network wavefunction methods employing a full determinant would have the same problem \u2013 and be unable to accurately model the ground state. This is of course not the case for them, and we believe it also isn\u2019t the fundamental issue for us as well. \n\nRather we think a large part of the performance discrepancy can be explained by design decisions that have all been motivated by their success with determinant based wavefunctions \u2013 i.e the use of the KFAC approximation to stochastic-reconfiguration, the choice of MCMC variant, along with the network architecture and hyperparameters, among other things. Additionally, since the pretraining method used by FermiNet / PsiFormer relies on fitting to the mean-field orbitals, we were unable to apply it with our model. Designing alternative pretraining procedures, as well as modifying the hyperparameters was something we experimented with, but due to computational constraints we were unable to sweep extensively over these choices.\nWe still maintain that our ability to outperform the other $O(N^2)$ vandermonde ansatz is evidence the sortlet approach has merit. We will also be updating the paper to more clearly show the advantages in that regard."
                    }
                },
                "number": 3,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission8033/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700201829562,
                "cdate": 1700201829562,
                "tmdate": 1700201829562,
                "mdate": 1700201829562,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "1E7ieFaggq",
                "forum": "0fSNU64FV7",
                "replyto": "34nQML0tex",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission8033/Reviewer_G9wz"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission8033/Reviewer_G9wz"
                ],
                "content": {
                    "comment": {
                        "value": "I thank the authors for the clarification regarding their universality proof. My original criticism regarding the discontinuity was not formulated clearly enough: My primary concern is not about the proof itself, but about the discontinuity of the local energy, which both Reviewer o8Z6 and Reviewer TwGB seem to share.\n\nRegarding the performance discrepancy: Contrary to the authors, I do not think that it can be explained only by design decisions / network architecture / hyperparameters etc. If this were the case, I think the authors should spend more time improving their model to reach better performance. If significant performance gains were indeed as easy as the authors make them out to be, the current results seem premature for publication.\n\nThe authors have not addressed my points regarding the determinant not being the computational bottleneck for the systems studied and identifying reasons for the failure of their method for specific systems (boron, nitrogen), which I think could be very insightful. I therefore keep my score as is."
                    }
                },
                "number": 7,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission8033/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700467257837,
                "cdate": 1700467257837,
                "tmdate": 1700469472187,
                "mdate": 1700469472187,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "dmFySpU44L",
            "forum": "0fSNU64FV7",
            "replyto": "0fSNU64FV7",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission8033/Reviewer_1VSk"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission8033/Reviewer_1VSk"
            ],
            "content": {
                "summary": {
                    "value": "The paper considers an important challenge in Quantum Chemistry, namely calculating the ground-state energy and its corresponding eigenfunction for gas-phase molecule. Recently, it was introduced to use neural networks as wavefunction parametrization in combination with Quantum Monte Carlo to solve this problem. A common issue is the scaling of the so-called Slater determinant to account for the anti-symmetry of the wavefunction. Evaluation of the Slater determinant scales cubically with the number of particles and therefore accounts for a significant part of the computational cost. The following paper proposes a new technique for anti-symmetrization (removing the necessity of evaluating the Slater determinant) with an improved scaling of O(N log N) with N being the number of particles. They show experimentally that for systems up to Bohr that they can reproduce state-of-the-art results and give a proof for weak universality of their ansatz."
                },
                "soundness": {
                    "value": "2 fair"
                },
                "presentation": {
                    "value": "2 fair"
                },
                "contribution": {
                    "value": "3 good"
                },
                "strengths": {
                    "value": "The following paper considers a challenging topic of removing the dependency on the Slater determinant and by that trying to improve the scaling of recently proposed deep-learning-based wavefunction ans\u00e4tze. Beside the anti-symmetry constrain of the wavefunction another complexity of the problem at hand is the need for highly accurate solutions. Normally, DL-VMC tries to recover the last 1-2mHa of the total energy. \n\nTherefore, the following paper has in my opinion three key strength:\n\n-\tNovelty: The paper introduces to the best of my knowledge a novel idea to reduce the scaling of the anti-symmetrization process. The idea looks promising, and it is able to recover state-of-the-art results, although only for small systems. \n-\tThe paper motivates the underlying problem and therefore introduces the topic to a broader community. (At certain parts I would have preferred a more detailed motivation, see weaknesses)\n-\tThe proposed approach is underlined with a theoretical finding of the potential universality. Additionally, the paper discusses (in detail) their approach in comparison to other methods with similar scaling and motivates its potential strength."
                },
                "weaknesses": {
                    "value": "One concern I have is regarding the claimed scaling of O(N log N) in the abstract. As stated in Sec. 3.1. it is more in the realm of O(N^2 log N) if not worse (see Fig. 3a).\nA more detailed discussion about the need of expansions (K) would help improve the paper. With the current results it is difficult for me to assess if the scaling is actually as proposed.  \n\nAlthough the paper motivates the problem and I am fine with the general structure of the paper, I have problems with the notation and explanation of certain concepts:\n\n**Section 1.3. \u201cWhere did the determinants come from anyway?\u201d**\n\nAnti-symmetry is introduced in eq. (AS) but it is quite difficult to understand the eq. because:\n\n-\tI couldn't find a definition of M.\n-\tWhat does the up and down arrow represent?\n-\tThe positions of the electrons r are not introduced the first time they are used. \n-\tThe anti-sym. (at least in the eq.) is only defined for spin-down electrons (or am I missing something?). \n\n**Section 3.1 \u201cThe Sortlet ansatz\u201d**\n\nThe author might consider explaining their idea in more detail:\n\n-\tIn case of K>1 you are mapping the $\\alpha$ functions to $\\mathbb{R}^{N \\times K}$, is this correct? \n-\tEq. 7 you sum over K with $\\alpha_i$, I am assuming the index i is not the same as in the introduction of the ansatz (eq. 6 and following bullet points)? \n-\tThe exponential with factor $\\gamma$ is to the best of my knowledge also new compared to prev. introduced wavefunction ans\u00e4tze, where you would have an exponential envelope over the electron-nuclei distances. Could the author explain their design choices in more detail?\n-\tIn the complexity paragraph, they state $\\alpha$ can be evaluated in $O(N^2)$. A short sentence that this is related to the computation of electron-electron interactions would give at least an intuition why this might be true. In my opinion this is especially difficult to understand for a reader who doesn\u2019t know the PauliNet, FermiNet & PsiFormer papers in detail. \n\nI have additional (minor) comments regarding the notation (see \u201cadditional comments\u201d). \nI want to stress I don\u2019t think the paper needs to describe the whole field of DL-VMC but maybe the authors want to revise certain parts for better readability to reach a broader community. \n\nWith the current weaknesses I am hesitant to recommend the paper to be accepted at ICLR. My decision is connected to the questions (see \u201cQuestions\u201d) below because I am not convinced regarding the scaling, or in other words the number of expansions (K) needed for accurate results and it is difficult to assess with the given result section. \n\n**Minor additional comments:**\n\n-\tThe paragraph regarding the discussion of the different neural network architectures in Sec. 1.3. (around \u201c\u2026which is allowed non-symmetric\u2026\u201d) might be difficult to understand for a reader not familiar in detail with the work of FermiNet & PauliNet. \nThe authors might consider adding additional details to better explain their argumentation (maybe in the SI). This is just a recommendation. I understand that it is not the task of the authors to explain the whole field of DL-VMC, but since the proposed ansatz requires quite a deep understanding of the topic it might be beneficial to add additional context. \n-\tSec. 2.4 \u201cRemark: Isn\u2019t that estimate biased\u201d: The authors write \u201cthe covariance between the two expectation in (4) via (23)\u201d, do the author maybe mean (22) via (4) and not (23) ((4) and (23) seems to me to be the same equation)?\n-\tIn the proof of Prop. 4. We have n and N, I assume it should be both N?\n-\tIn the Hamiltonian you write $R_I$ but in the notation block $R_i$."
                },
                "questions": {
                    "value": "- Can the author elaborate more on the scaling of their method? \n  - How large do you expect K to be? In Fig. 3a. it seems to be way more than linear. But since it is only one experiment it is difficult to assess.\n- Do you have an intuition why your results are 0.5 Ha away from the FermiNet results for only a slightly larger system (compared to Bohr) for Nitrogen? You mentioned engineering problems, but this is difficult to assess without having a chance to look at the code (hopefully I didn\u2019t miss a reference to the code)."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "5: marginally below the acceptance threshold"
                },
                "confidence": {
                    "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 3,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission8033/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698394274236,
            "cdate": 1698394274236,
            "tmdate": 1699636991421,
            "mdate": 1699636991421,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "n1nfw2wVKb",
                "forum": "0fSNU64FV7",
                "replyto": "dmFySpU44L",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission8033/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission8033/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Clarification on notation issues"
                    },
                    "comment": {
                        "value": "Notation:\n\nThank you for helping us improve the readability of our paper by pointing out notation details. To address each:\n\n- I couldn't find a definition of M.\n\nAh yes, M is just the number of spin up electrons. We use the notation $N^{\\uparrow}, N^{\\downarrow}$ in the rest of the paper, and will make the intro consistent with that choice. \n\n - What does the up and down arrow represent?\n\nThe up and down arrows denote the spin of the particle. The function is only antisymmetric with respect to permutations of particles with the same spin. We will make this clearer.\t\n\n- The positions of the electrons r are not introduced the first time they are used.\nThank you for pointing this out, we will fix this!\n\n- The anti-sym. (at least in the eq.) is only defined for spin-down electrons (or am I missing something?).\n\nWe can see that this can cause confusion; we will make clear that the anti symmetry needs to be enforced for spin up and spin down.\n\n- In case of K>1 you are mapping the  functions to, is this correct?\n\nThat is correct, we all $\\alpha$ terms  are the output to from a single neural network backbone\n\n- Eq. 7 you sum over K with, I am assuming the index i is not the same as in the introduction of the ansatz (eq. 6 and following bullet points)?\n\nYou are correct, they are different indices, we will clarify this\n\n- The exponential with factor is to the best of my knowledge also new compared to prev. introduced wavefunction ans\u00e4tze, where you would have an exponential envelope over the electron-nuclei distances. Could the author explain their design choices in more detail?\n\nAh yes this is also a typo, it was written for the case of a single atom. Of course, for molecular systems we have an exponential envelope over the electron nuclei distances, just like the other ansatze.\n\n- In the complexity paragraph, they state can be evaluated in. A short sentence that this is related to the computation of electron-electron interactions would give at least an intuition why this might be true. In my opinion this is especially difficult to understand for a reader who doesn\u2019t know the PauliNet, FermiNet & PsiFormer papers in detail.\n\nThank you, we will mention that the $O(N^2)$ complexity stems from the electron-electron interactions."
                    }
                },
                "number": 4,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission8033/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700325447099,
                "cdate": 1700325447099,
                "tmdate": 1700325447099,
                "mdate": 1700325447099,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "NfCCCxiIPy",
            "forum": "0fSNU64FV7",
            "replyto": "0fSNU64FV7",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission8033/Reviewer_o8Z6"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission8033/Reviewer_o8Z6"
            ],
            "content": {
                "summary": {
                    "value": "This paper proposed a method based on sorting operations to achieve the anti-symmetry property of the NN-VMC ansatz. Compared with the original determinant ansatz, the proposed algorithm has a favorable computational complexity. The authors conduct experiments on small molecule systems, showing the proposed ansatz has a comparable performance as the baseline methods."
                },
                "soundness": {
                    "value": "2 fair"
                },
                "presentation": {
                    "value": "2 fair"
                },
                "contribution": {
                    "value": "2 fair"
                },
                "strengths": {
                    "value": "It is interesting to design an ansatz with favorable computational complexity."
                },
                "weaknesses": {
                    "value": "1. To the reviewer\u2019s best knowledge, the sorting algorithm in 3-dimensional space (more concretely, any spaces where the dimension is larger than one) is discontinuous. Thus, the proposed ansatz is discontinuous. When calculating the kinetic energy term, it is hard for the mcmc walkers to handle the energy near the discontinuous surface. As a result, the conventional energy calculation method in NN-VMC will lead to a non-variational energy result, which means the energy of the proposed method cannot directly compare with the other NN-VMC methods. \n In section 1.2, the authors claim that some previous works \u2018allude\u2019 to a non-smooth ansatz. However, the corresponding ansatzes are smooth. The discontinuous property is just an assumption of the theoretical analysis. Therefore, those previous works do not suggest using a discontinuous ansatz. The authors must discuss more about the influence of the discontinuous property in the paper.\n\n2. The computational cost of determinants is very small for the systems within 10 electrons. Thus, the acceleration achieved through the proposed ansatz is relatively small in those systems. To demonstrate the effectiveness of the proposed ansatz, the authors should study larger systems."
                },
                "questions": {
                    "value": "The questions are listed in the weakness"
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "3: reject, not good enough"
                },
                "confidence": {
                    "value": "5: You are absolutely certain about your assessment. You are very familiar with the related work and checked the math/other details carefully."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 4,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission8033/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698654657567,
            "cdate": 1698654657567,
            "tmdate": 1699636991303,
            "mdate": 1699636991303,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "5XYFBsWlQw",
                "forum": "0fSNU64FV7",
                "replyto": "NfCCCxiIPy",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission8033/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission8033/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Response to question 1"
                    },
                    "comment": {
                        "value": "We appreciate your effort in reviewing our paper! It seems, however, that there has been some confusion over the design of our proposed ansatz. While our universality proof was based on allowing a discontinuous input function to the sortlet layer \u2013  and as you note, the same concession was made to prove a type of universality in the appendix of the original FermiNet article \u2013  in both cases, this is only relevant to the proof. As we state in Proposition 3 (proof of which can be found in the appendix), our construction is continuous and once differentiable, which is sufficient for the kinetic energy operator to be well defined (by application of the standard Green\u2019s identity $\\langle \\psi | \\Delta \\psi \\rangle = -\\langle \\nabla \\psi | \\nabla \\psi \\rangle$ )\n\nIf you have a specific concern about the proof of proposition 3, we\u2019d be more than happy to clarify any details!"
                    }
                },
                "number": 1,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission8033/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700005222235,
                "cdate": 1700005222235,
                "tmdate": 1700005222235,
                "mdate": 1700005222235,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "eZXByT3I3f",
                "forum": "0fSNU64FV7",
                "replyto": "5XYFBsWlQw",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission8033/Reviewer_o8Z6"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission8033/Reviewer_o8Z6"
                ],
                "content": {
                    "comment": {
                        "value": "Thank you for your clarification and sorry for the misunderstanding. However, the author still has concerns about the non-smooth property of the proposed ansatz. The Schrodinger equation ensures that $\\hat{H}\\psi=E\\psi$. Thus, if the proposed ansatz is just once differentiable, i.e., has a discontinuous local energy, it can not satisfy the Schrodinger equation. The reviewer hopes the author could discuss this problem. \n\nMinor: The index in the appendix eq.(25) may need more clarification or correction, e.g., the index of $\\alpha$ in the first bracket should be $k$ rather than $i$."
                    }
                },
                "number": 2,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission8033/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700105885665,
                "cdate": 1700105885665,
                "tmdate": 1700105885665,
                "mdate": 1700105885665,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "HuHfeWB9U1",
                "forum": "0fSNU64FV7",
                "replyto": "HcsOKEtCB3",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission8033/Reviewer_o8Z6"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission8033/Reviewer_o8Z6"
                ],
                "content": {
                    "comment": {
                        "value": "Thank you for your effort in giving that proof. However, the reviewer has found a counter-example so there may exist some mistakes in that proof.\n\nLet's consider that $\\alpha(x)=x$. Assume that the input space is one-dimensional and there only exist 3 particles. In the region where $x_1>x_2>x_3$, the proposed ansatz gives that $\\psi({\\bf x})=(x_1-x_2)(x_2-x_3)$. Thus, in this region, $\\partial^2_{x_2}{\\psi(\\{\\bf x})}=-1$. In the region where $x_2>x_1>x_3$, the proposed ansatz gives that $\\psi({\\bf x})=-(x_2-x_1)(x_1-x_3)$ and $\\partial^2_{x_2}{\\psi(\\{\\bf x})}=0$. Therefore, the proposed ansatz's second-order derivative is not continuous. The author may recheck their proof or add more property to $\\alpha$ to ensure the continuous.\n\nBesides the discontinuous property, the weakness of system size has not been addressed by the authors. The reviewer would like to point out that this problem is also important. The authors may also pay attention to discuss about this problem."
                    }
                },
                "number": 9,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission8033/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700627106035,
                "cdate": 1700627106035,
                "tmdate": 1700627106035,
                "mdate": 1700627106035,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "pSCpDHVA2u",
                "forum": "0fSNU64FV7",
                "replyto": "08NGGN5u69",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission8033/Reviewer_o8Z6"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission8033/Reviewer_o8Z6"
                ],
                "content": {
                    "comment": {
                        "value": "Thank you for your correction and clarification. The total energy of the ansatz is well-defined if the ansatz is once-differentiable. Although the reviewer still has concerns about evaluating the discontinuous local energy through the standard MCMC method, it is not the main reason for the reviewer to reject the paper.\n\nHowever, the reviewer can not increase the score because another important problem has not been addressed by the authors. The systems studied in this paper are so small that the efficiency improvement of the proposed ansatz is almost negligible, and the total energy of the proposed ansatz is significantly higher than the original ansatz. Combined with the discontinuous property discussed before, the reviewer can not give a higher score for the current version."
                    }
                },
                "number": 12,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission8033/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700730888517,
                "cdate": 1700730888517,
                "tmdate": 1700730888517,
                "mdate": 1700730888517,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    }
]