[
    {
        "title": "Grokking in Linear Estimators -- A Solvable Model that Groks without Understanding"
    },
    {
        "review": {
            "id": "fJnmlGIzXb",
            "forum": "GH2LYb9XV0",
            "replyto": "GH2LYb9XV0",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission1932/Reviewer_VxMM"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission1932/Reviewer_VxMM"
            ],
            "content": {
                "summary": {
                    "value": "This manuscript studies a linear teacher-student model trained with Gradient flow and MSE loss. The authors solve the dynamical training equation which yields to an exponential decay of the initial error with a spectrum of exponents related to the training data covariance matrix. When the input dimension is larger than the number of data-points, this matrix has zero eigenvalues and hence target modes that cannot be learned. Moreover, using Gaussian iid data, this matrix is Wishart, thereby allowing the authors to estimate where the bulk of non-zero spectral modes resides. Following this they find that the asymptotic dependence of the training loss is roughly exponential with a time scale depending on the lower bulk spectrum of the Wishard matrix. In this asymptotic regime, the test loss behaves as the train loss up to a multiplicative factor larger than 1. Hence the time at which the training loss drops below some small threshold (t_{*,train}) is smaller than the time it takes the test loss to do so (t_{*,test}). This delay between t_{*,test} and t_{*,train} is then viewed as a form of Grokking. The authors proceed with extending their results to several other scenarios. Such as networks with vector outputs, weight decay, and two-layer network in the linear/NTK regime."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "2 fair"
                },
                "strengths": {
                    "value": "The authors study a timely topic. \n\nThey lay bare some issues with how Grokking is perceived.  \n\nThe manuscript is clearly written and easy to follow."
                },
                "weaknesses": {
                    "value": "I feel there are two main issues with the current work.\n\n1. Is this Grokking? \n\nGrokking is a somewhat ill-defined phenomenon. However, like many grey area situations, the fact that it is difficult to draw one sharp reason doesn't mean there cannot be a sharp feeling that something does fit. Let me then rationalize several reasons for why I don't think this is grokking: \nA. It is too simple. If this model Groks, everything Groks.   \nB. There aren't any feature learning effects (see for instance Gromov (2023) or Misra (2022)) or beyond NTK effects. \nC. There is only one time scale here, which is (1-\\sqrt{\\Lambda})^{-2}, governing both test and train loss. Hence, looking at the train and validation loss, a practitioner would not be encouraged to do any early stopping here. In contrast, in various Grokking models, there is an over-fitting regime prior to Grokking which can mislead practitioners.  \n\n2. Technical aspects seem quite close to previous results in the literature. \n\nThe training dynamic the authors find is closely related to the e^{-\\Theta t} \\Delta obtained in the NTK work. In fact, up to a standard shift of the inner and outer indices, their data covariance matrix is Theta here. In particular, both have the same non-zero spectrum. I'm sure there are much earlier works which solve this for a linear network. \n\nSimilar factors relating train and test performances, however at infinite time, were also found in Adlahm and Pennington 2020 and https://arxiv.org/abs/2006.09796. Given the expected exponential decay of the discrepancy in linear models, the fact this ratio holds also in the asymptotic dynamics seems expected. At any rate, It'll be good to compare and disentangle the factors the authors find from those."
                },
                "questions": {
                    "value": "The work is clearly written. I don't have any questions."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "3: reject, not good enough"
                },
                "confidence": {
                    "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 1,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission1932/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698065938741,
            "cdate": 1698065938741,
            "tmdate": 1699636124215,
            "mdate": 1699636124215,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "bGDBOibS0O",
                "forum": "GH2LYb9XV0",
                "replyto": "fJnmlGIzXb",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission1932/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission1932/Authors"
                ],
                "content": {
                    "comment": {
                        "value": "Thank you for your thoughtful review and constructing comments and questions. \nWe are glad that you acknowledge the main goal of our work, which is to call for a more serious discussion on what grokking is, and properly define it by multiple metrics that must converge to a clear conclusion.\n\nBefore addressing the weaknesses raised in the review, we must first provide a small correction to how our results were perceived. Most of our analysis was done in the regime $d_{in}/N_{tr}<1$, meaning that there are more training samples than input dimensions. In this case, there are no zero eigenvalues, and the difference between training and generalization loss comes from the mismatch between the covariance matrices for the nonzero eigenvalues.\n\nNext, we address the weaknesses in the order in which they were raised.\n\n1) **Is this grokking?**\n\nThis is indeed an important point that also came up in the reviews of other referees. We agree, and it is in fact one of the main conclusions of our work. Namely: we study a model which does not exhibit any feature learning, no special weight structure or non-monotonicity in its generalization loss evolution, and can still be considered to \"Grok\" if one uses accuracy as the only metric (and this specific case was actually descried as grokking in the Omnigrok paper [Liu 2023]).  Truly, if this nearly trivial model Groks, then any model can Grok.\n\nWe believe that this aspect of delayed generalization should be separated from representation learning grokking which is present in other systems, such as modular arithmetic. However, we believe that some aspects of the proposed mechanism -- namely that the accuracy is simply a step-like-function of the loss that depends on the data covariance -- might be quite general. We provide some preliminary evidence in the new appendix G. \n\nWe agree with the suggestion of tracking both generalization loss and accuracy to define grokking, but even in this scenario there may be other factors, such as optimizer dependence that can induce delayed generalization on the loss, without any deep change in learning behavior. \n\nWe completely rewrote tyhe discussion to better emphasize this point\n\n2) **Similarity to previous works**\n\nWhile we recognize some similarities to previous work, we believe our study makes several novel contributions:\n\nWe provide a closed form solution to the dynamics of training for linear models, rephrasing previous asymptotic analyses in simple Random Matrix Thoery language. This allows us to characterize training dynamics over the full training process and isolate the contribution of different aspects.\n\nBy relating training loss directly to the spectrum of the data covariance matrix, we suggest that perhaps some of our results can be extended beyond the linear regime, as shown by the 2-layer $\\tanh$ example, as well as a new appendix (Appendix G.) in which we examine the dependence of the grokking time on $\\lambda$ for a modular arithmetic task.\n\n3) **Finite time analysis vs previous works:**\nWe agree that previous works have examined the exponential decay of the discrepancy in linear models, and therefore the novelty in our work is relating that same discrepancy with the phenomena of grokking. We added some of your suggestions to the bibliography.\n\nWe hope with these changes the main message of the paper is clearer, while the broader context is more readily accessible, and that upon review of the revised version you find our work suitable to acceptance."
                    }
                },
                "number": 4,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission1932/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700740114896,
                "cdate": 1700740114896,
                "tmdate": 1700740743979,
                "mdate": 1700740743979,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "cIsb4bdjpE",
            "forum": "GH2LYb9XV0",
            "replyto": "GH2LYb9XV0",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission1932/Reviewer_Eifc"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission1932/Reviewer_Eifc"
            ],
            "content": {
                "summary": {
                    "value": "This paper uncovers a surprising fact that linear models can manifest the 'grokking' phenomenon within a teacher-student framework. The author qualitatively predicts the precise dependencies of grokking time on input/output dimensions, sample size, regularization (weight decay), and initialization. Remarkably, these predictions hold true for more intricate models in specific settings. The paper also includes a comprehensive set of empirical validations to support the theoretical analysis."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "2 fair"
                },
                "contribution": {
                    "value": "3 good"
                },
                "strengths": {
                    "value": "The paper is notably well-structured and written. Its strengths can be summarized as follows:\n\n- The paper offers a substantial novelty value, as it explores the grokking phenomenon through a theoretical lens, an area with limited prior analysis. The surprising discovery of grokking in certain linear model scenarios (even without weight decay) adds a unique perspective to the literature. This novel approach contributes significantly to our understanding of grokking from the first principle.\n- The authors provide comprehensive theoretical predictions for their proposed linear model. They not only establish the asymptotic order of grokking time but also consider various related factors. Also, the paper extends its analysis to two-layer networks, both with and without nonlinearity. To further strengthen their claims, the authors conduct an array of extensive experiments that effectively illustrate and validate the theoretical findings."
                },
                "weaknesses": {
                    "value": "Though the paper is of good quality, I believe the paper would improve in the following aspects:\n- The notations are quite dense even for the simplest model at first glance. The paper would benefit from having some explicit definition or intro to the model and all the notations.\n-  The derivation of this paper is concrete. However, all the calculations are in the asymptotic manner. It would be better to see the results be displayed as some rigorous theorem in some limiting case."
                },
                "questions": {
                    "value": "In this linear model, the grokking phenomenon is due to the gap of convergence speed between training and generalization loss. Can it also imply the difference in two-layer networks settings (or in NTK regime), or they have a different mechanism?"
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "8: accept, good paper"
                },
                "confidence": {
                    "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                },
                "first_time_reviewer": {
                    "value": "Yes",
                    "readers": [
                        "ICLR.cc/2024/Conference/Program_Chairs",
                        "ICLR.cc/2024/Conference/Submission1932/Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission1932/Reviewer_Eifc",
                        "ICLR.cc/2024/Conference/Submission1932/Senior_Area_Chairs"
                    ]
                }
            },
            "number": 2,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission1932/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698359041583,
            "cdate": 1698359041583,
            "tmdate": 1699648018224,
            "mdate": 1699648018224,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "NSf9D8cKeO",
                "forum": "GH2LYb9XV0",
                "replyto": "cIsb4bdjpE",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission1932/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission1932/Authors"
                ],
                "content": {
                    "comment": {
                        "value": "Thank you for your thoughtful review and positive appraisal of our work. We are glad that you found our analysis of grokking through a theoretical lens in linear models and neural networks to be a novel contribution that substantially advances understanding. You also highlighted how our comprehensive theoretical predictions and extensive empirical validations effectively supported our claims. These are certainly important strengths of the work.\n\nAt the same time, you raise valid points about areas we can improve. \n\n1) **Notations:**\nWe agree. We edited the manuscript to make the notations clearer and easier to follow. Thank you for your comments.\n\n2) **Theorems:**\nFollowing your comments, we have added a short introduction to the model at hand, clarifying the notations we used. We have also added references to certain theorems which substantiate our asymptotic results in more limiting cases.\n\n3) **NTK limit:**\nThank you for the question. We believe that the answer is that in the lazy regime, i.e. when the kernel remains fixed at initialization $h_t\\simeq h_0$ our analysis will hold for NTK, however any deviation from the strict NTK limit may generate dynamics that differ for our results, in any truly nonlinear settings. This implies that some of our predictions regarding the scaling of grokking time with certain parameters, for instance, $d_{in}$ and $N_{training}$ should hold, at least to some extent, until breaking away fully from linear dynamics."
                    }
                },
                "number": 2,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission1932/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700734955785,
                "cdate": 1700734955785,
                "tmdate": 1700740176660,
                "mdate": 1700740176660,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "4kjID7rnuA",
            "forum": "GH2LYb9XV0",
            "replyto": "GH2LYb9XV0",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission1932/Reviewer_minU"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission1932/Reviewer_minU"
            ],
            "content": {
                "summary": {
                    "value": "This paper proposes a toy model for grokking, a phenomenon where training accuracy rises much before test accuracy. The proposed model is a linear target function on Gaussian data distribution. A student model attempts to estimate parameters with a matching linear model. The authors use random matrix theory (specifically the eigenvalue distribution of the Wishart ensemble) to derive the dynamics of training and test losses under gradient flow. While both train and test losses decrease smoothly in terms of MSE, when plotting a hard classification accuracy, this toy model exhibits a separation of timescales between training accuracy saturation and test accuracy saturation. The authors illustrate that this is entirely due to the difference between the feature covariance matrix on the training distribution and on the test distribution. These results, taken together provide a possible deflationary explanation for grokking, which can occur merely as an artifact of the choice of metric in very simple models, rather than due to a deeper reason related to learning generalizing features at late training time. The authors show that their results can be extended to weight decay, multiple outputs, training a linear neural network with multiple layers, and training deep nonlinear networks in the lazy/kernel regime."
                },
                "soundness": {
                    "value": "4 excellent"
                },
                "presentation": {
                    "value": "2 fair"
                },
                "contribution": {
                    "value": "3 good"
                },
                "strengths": {
                    "value": "This paper has a nice analytically solvable theory of training dynamics which reproduces grokking-like learning curves. The paper uses a basic result in random matrix theory, namely the limiting spectral density of the Marcheko Pastur law to derive the train and test loss dynamics. Due to the model\u2019s simplicity the authors can derive nice asymptotic expressions for the loss at late time and use these to derive a grokking timescale. They show that their theory is predictive in experiments on reasonably large features and datasets sizes."
                },
                "weaknesses": {
                    "value": "While this paper provides an interesting and exactly solvable toy model of grokking, it has some major defects which must be addressed before I can support acceptance. \n\nFirst, the paper lacks a proper comparison to literature on gradient flow dynamics in linear models (see below). In addition the citations are often incorrect or correspond to nonexistent papers. We outline these issues below in section titled Related Work Issues.  \n\nNext, the comparison of the grokking observed in this model and grokking observed in real networks is still unclear. Do the authors think that the proposed statistical effect is the phenomenon at play in grokking in real networks? Below I list some observed phenomena associated with grokking that this theory does not quite capture\n\n1.  Many works on grokking report development of specialized weight structures in deep networks temporally coincident with the improved generalization error. I suspect this form of grokking would correspond to deviation from a linear model which would be outside the scope of explanation in this work. If the authors are not claiming this is a theory of grokking as it is observed in its original settings (like modular arithmetic in transformers), in what sense is this an explanation of grokking? \n2. Another example of a difference between observed dynamics and the present study is that weight decay does not induce more extreme grokking which was reported in Liu et al 2023. \n3. Sometimes in grokking experiments with deep networks, the test loss (MSE) even increases before later decreasing to its final value like in Davies et al 2023 Figure 1. It is unclear if this can happen in the linear model where the errors in each non-null eigendirections decrease exponentially.  \n\nOn the other hand, it could be that the primary point of the paper is motivating the need for more careful research on grokking in the future. For example, what artifacts due to choice metric should experimenters be wary of? How should we distinguish \u201cimprovement in understanding\u201d vs mere statistical noise? Commenting further on this distinction and comparison to phenomena observed in prior works on grokking would greatly improve the paper. \n\n**Issues with Related Work**\n\n1. The authors miss several important works on gradient flow with linear models. Advani & Saxe 2020 (https://www.sciencedirect.com/science/article/pii/S0893608020303117) derive the training and test errors dynamics for the model considered in this paper. Omitting this citation does not do justice to their relevant contribution. In addition, Saxe et al 2013 (https://arxiv.org/abs/1312.6120) derive learning curves for deep linear networks with fixed dataset. \n2. Several other papers which derive asymptotic performance of linear models trained with Gaussian data in the proportional regime with gradient flow.  \n   (a) Mignacco et al 2022 (https://proceedings.neurips.cc/paper/2020/hash/6c81c83c4bd0b58850495f603ab45a93-Abstract.html), Mignacco et al 2022 (https://iopscience.iop.org/article/10.1088/1742-5468/ac841d/meta), \n   (b) Paquette et al 2022 (https://arxiv.org/abs/2205.07069)\n3. The authors also miss the work of Gromov (https://arxiv.org/abs/2301.02679) on the dynamics of grokking in modular arithmetic without regularization. \n4. Several cited papers do not even seem to exist! These include [2] E. Bodin and N. Macris. Dynamics of generalization in learning with gradient descent for piecewise linear neural networks [4] A. Crisanti and H. Sompolinsky. Dynamics of learning in deep linear neural networks: A mean-field approach   [7] S. Goldt, M. M\u2019ezard, F. Krzakala, and L. Zdeborov\u2019a. Modelling the infinite width limit of neural networks with mean field theory \n\nPlease fix these issues."
                },
                "questions": {
                    "value": "**Questions/Comments**\n\n1. Figure 5 Bottom row: Is the reason that the dynamics for the tanh networks are well approximated by linear two layer dynamics because the activation function is linearizable around $\\phi(h) \\sim h$? What if you used a different activation function, for instance, increasing the \u201cgain\u201d of the tanh nonlinearity like $\\tanh(g * h)$ for $g > 1$? For large enough $g$, would we expect the correspondence to the linearized dynamics to break? \n2. Equation 7 is using approximation signs instead of equality. However, I suspect that if one considered the average case error over random teachers where $T \\sim \\mathcal N(0,I)$ then the equation given is exact. Is there any reason to not focus on averaging over random teachers since the data is isotropic?\n3. The authors claim that deep networks in the kernel regime can be described by the same equations except redefinition of the kernel. I believe that the kernel would not only change the eigenvalue spectrum but would also make the train and test dynamics dependent on the decomposition of the teacher T in the eigenbasis of the kernel. This would therefore make the result much less trivial than what is provided here since the test error is not merely a functional of the spectral density."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "5: marginally below the acceptance threshold"
                },
                "confidence": {
                    "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 3,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission1932/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698670254170,
            "cdate": 1698670254170,
            "tmdate": 1699636124048,
            "mdate": 1699636124048,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "0CPyl3Yc01",
                "forum": "GH2LYb9XV0",
                "replyto": "4kjID7rnuA",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission1932/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission1932/Authors"
                ],
                "content": {
                    "comment": {
                        "value": "Thank you for your careful reading and thoughtful comments. We are glad that you believe we presented a sound and comprehensive analysis of our simple model which captures some aspects of grokking.\n\nIn light of the weaknesses and questions brought up, we have made a number of modifications to the text, as detailed below.\n\n* **Comparison to gradient flow in linear models literature and related works:**\n    We apologize for the errors found in the bibliography and the related work section. Particularly, the work of Gromov was one of the motivations for our work and was somehow unintentionally missed. We thank the reviewer for bringing these highly relevant works on linear models (for instance Saxe et al.) and on gradient flow to our attention. they are now incorporated into the main text.\n\n* **Extension of the results to more realistic setups:**\nWe fully agree that our model does not capture all aspects of grokking. As we wrote in our response to other referees, this is actually a main point of our paper: in some cases grokking is just an artifact of the accuracy measure, and does not result from an ``interesting`` thing that goes on in the underlying dynamics. This was stated explicitly in the abstract and the text. We rewrote the discussion to stress this point.\n\nWe agree with your ultimate conclusion: \"...the primary point of the paper is motivating the need for more careful research on grokking in the future. For example, what artifacts due to choice metric should experimenters be wary of? How should we distinguish \u201cimprovement in understanding\u201d vs mere statistical noise?...\" . This was a main goal of this work. Since grokking is ill-defined, even a linear model which does not \"understand\" anything deep, can still \"grok\" because of an artifact.\n\nThat said, it is still possible that at least some aspects of our analysis would extend to realistic setups, for instance the grokking time dependence on $d/N$, at least for some models. That is, at least some of what is currently considered \"grokking\" can be explained using our formalism. We begin to address this point in the new appendix G, but this is clearly an interesting point for future research.\n\nWe stress in the discussion that our work is not intended to be a \"theory of grokking\" in general.\n\nRegarding the specific aspects of grokking that are missing in our model:\n\n1) **Specialized weight structure:**\nSince the linear model does not exhibit any type of feature learning or gains any deep insight during training, there is no specialized structure for the weights. Indeed, this is a deviation from grokking in modular arithmetic. \n\n2) **The effect of weight decay:**\nIn the linear model, the effect of WD can be analytically understood, and in fact the reason for the difference is that they explore WD values in our \"gray\" regime, as our model cannot generalize in that parameter space while their setup can. \nWe have revised our manuscript to explain this point.\n\n3) **Loss increase prior to grokking:**\nIndeed, this is also a feature that does not exist in the linear model, as all the quantities in the model change monotonically with one another, and so unless one appeals to a catapult scale learning rate in the two-layer example, this cannot happen. However, our preliminary results (in the new appendix G) hint that this non-monotonicity might not be crucial for grokking (see figure 8, right panel, where the non monotonicity is present).\n\n**Questions/Comments:**\n\n1) **$\\tanh$ gain:** \nYes, we believe that the near linear behavior of $\\tanh$ is the reason for the matching results, since the analysis would not hold for a general activation function. For instance, we find empirically, that using ReLU activations completely deviates from the simple prediction of $h_t\\simeq h_0$. Extending $g>1$ does break the predictions as well, above a certain threshold. Due to time constraints we were not able to incorporate a discussion in our work.\n\n2) **Averaging over teachers:**\nIt is probably true that the average over teachers would turn approximations to equalities. We show a weaker analytical claim, but a stronger empirical verification: our model give effectively perfect predictions for the dynamics of *individual trajectories*, and not average predicitons on ensembles.\n\n\n\n3) **Teacher decomposition on the kernel**\nThis question requires more substantial analysis - while it is true that the decomposing the teacher in the eigenbasis of the kernel would imply dependence on the eigenfunctions themselves, the question of how these functions evolve during training would likely determine their importance. In the infinite width limit, since the kernel is fixed this effect should not exist, but we agree that there are some non-trivial calculations to be made."
                    }
                },
                "number": 3,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission1932/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700739853925,
                "cdate": 1700739853925,
                "tmdate": 1700739853925,
                "mdate": 1700739853925,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "f1SCaB8VOH",
            "forum": "GH2LYb9XV0",
            "replyto": "GH2LYb9XV0",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission1932/Reviewer_wJux"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission1932/Reviewer_wJux"
            ],
            "content": {
                "summary": {
                    "value": "This paper studies delayed generalization in a linear student-teacher setup with diagonal-covariance Gaussian inputs. The authors also offer some extensions to non-linear 2-layer networks (still in the Gaussian setting). Extensive analytical derivations in the gradient flow regime are shown to match numerical simulations closely."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "2 fair"
                },
                "strengths": {
                    "value": "- The paper is very well-written and easy to follow.\n- Corroborates prior observations on the effect of dataset size on Grokking and distills the delayed generalization behavior down to a very simple toy setup.\n- Theoretically and empirically, the toy setting is well explained and studied thoroughly, from a simple 1-D linear setup to various extensions, including a non-linear 2-layer setting."
                },
                "weaknesses": {
                    "value": "- My biggest worry about the paper is that it does not deviate from the toy setting proposed. While the results are good, and the match between analytical results and empirical behavior is close, the entire investigation leaves out realistic applications and the original setting in which the phenomenon was first observed. Furthermore, it seems like the theory does not cover some phenomena associated with Grokking, and it might just be too far from the original setting to yield practical results.\nThe submission would be substantially stronger with more connections to realistic settings or insights that can transfer across, e.g., tasks, datasets, models, etc.\n\nOverall, I would tend to recommend acceptance because the thorough investigation and the interesting insights on a simplified toy setting outweigh the limited scope."
                },
                "questions": {
                    "value": "- Delayed generalization in many settings can occur after the generalization loss **increases**, whereas the toy setting presented seems to imply monotonic behavior. Could this mean that the phenomenon studied here is qualitatively different from Grokking in the original setting? There is no fixed and precise definition of Grokking, so this is not a big issue, but I think a distinction might be helpful in understanding feature learning dynamics.\n- The effect of label noise does not seem to be completely captured by the theory. I have seen scenarios where the label noise is \u201ccorrected\u201d at Grokking time, still reaching 100% accuracy. Specifically, one can take a *Grokking on modular addition* setup and assign random labels at a certain rate. Generalization accuracy can still reach 100% eventually. Do you have any idea why that\u2019s the case? Is there a way for the toy model to accommodate such \"self-correcting\" behavior?\n\n**Nit:**\nThe figures are nice but can be difficult to parse. In particular, I think it would be easier to understand figures where the theoretical predictions are differentiated for the training and generalization curves (e.g., dashed lines for train, solid for generalization with empirical data shown as points with different markers for train/gen)."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "6: marginally above the acceptance threshold"
                },
                "confidence": {
                    "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 4,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission1932/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698815359033,
            "cdate": 1698815359033,
            "tmdate": 1699636123964,
            "mdate": 1699636123964,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "wI8c5Ax7s7",
                "forum": "GH2LYb9XV0",
                "replyto": "f1SCaB8VOH",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission1932/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission1932/Authors"
                ],
                "content": {
                    "comment": {
                        "value": "Thank you for your positive feedback on our paper. We appreciate you highlighting its clarity and its thorough explanations of the theoretical analysis and empirical results through a tractable model. Below we address the weaknesses and questions raised, in hopes of strengthening the message of our work.\n\n\n**Weaknesses:**\n\nWe agree with your concerns that our conclusions might not extend beyond the linear model, and that our model does not capture some of the phenomena associated with grokking, e.g. a non monotonic loss. A main goal of this work was to highlight that the grokking phenomenon is not sufficiently well defined, and may contain multiple aspects, some of which can be captured (or mimcked?) by a nearly trivial model which shows no feature learning at all. This is indeed the main point we are trying to make, as we hint in the title of the manuscript.\n\nIt should also be noted the model was not introduced in this work - we are analyzing a grokking scenario reported in the Omnigrok paper, and show that grokking in this nonlinear case can be understood in terms of a linear model (as we show in the two layer $\\tanh$ example). That is, at least some of our analytical predictions might extend to nonlinear models. For instance, the change in grokking time as a function of $d_{in}/N_{training}$ is expected to hold in some form for more realistic setups as well. We have added experimental evidence in the revised manuscript that indicate that the grokking time scaling behavior extends for deeper nonlinear networks, for the task of learning modular arithmetic. We hope this change will provide a sufficiently broaden the scope of our work.\n\nQuestions:\n\n1) **Delayed generalization vs. grokking:**\nThis is an excellent question, which is related to the previous point. Indeed, we agree that if grokking is defined by representation learning - hence requiring a dramatic change both in loss and in accuracy, this model does not grok but just pretends to. For instance, grokking in modular arithmetic clearly displays an ascent of the test loss while training accuracy saturates, and a drop of the test loss when the test accuracy increases from 0 to $100\\%$. One of our goals in this work is to precisely separate the effects which depend only on the accuracy measure, from true representation learning. We also have preliminary results which may indicate that even the loss behavior is not necessarily indicative of \"representation grokking\", which we plan to present in future work.\n\n\n2) **Self correction and label noise:**\nIt is true that label noise was only commented upon in a paragraph in the original manuscript, but we can easily explain its effect here. Assume training in the most basic setup, in which $d_{out}=1$ so $S,T$ are vectors and there is a scalar label noise variable $n\\sim\\mathcal{N}(0,\\sigma_n^2)$. Training with label noise in our model can be shown to give the average training loss $\\mathcal{L}_{tr} =Tr(D_0 D_0^T  e^{-4\\eta_0 \\Sigma_t } \\Sigma_t )+\\sigma^2_n$,\nwhile the generalization loss (w/o noise) is unchanged, thus adding noise to test labels will add a similar additive term.\nTherefore, the training dynamics do not change except for an additive constant. It is then possible to tune $n$ and the threshold parameter $\\epsilon$, such that the noise can cause induce grokking precisely when test accuracy saturates. There is no sense of self correction here, just a tuning between noise and the accuracy metric, so it is unclear if this is the same mechanism at work in modular addition. \n We thank you for highlighting this point and we included an appendix explaining this.\n\n**Figures:**\nWe thank you for this comment, and we have reworked our figures to be more clearer and more legible."
                    }
                },
                "number": 1,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission1932/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700734876844,
                "cdate": 1700734876844,
                "tmdate": 1700734876844,
                "mdate": 1700734876844,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    }
]