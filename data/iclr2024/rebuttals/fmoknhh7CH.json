[
    {
        "title": "Harmonic Prior Flow Matching for Multi-Ligand Docking and Binding Site Design"
    },
    {
        "review": {
            "id": "YwGauMkxLj",
            "forum": "fmoknhh7CH",
            "replyto": "fmoknhh7CH",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission6530/Reviewer_jkK7"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission6530/Reviewer_jkK7"
            ],
            "content": {
                "summary": {
                    "value": "This paper focuses on biomolecular designing problems. Two methods, HormonicFlow and FlowSite, are proposed. HarmonicFlow leverages flow matching for generating 3D binding poses of multi-ligands, and this method achieves better performance than the previous SOTA method. Furthermore, FlowSite leverages flow matching for designing binding sites for small molecules, where both discrete (residue types) and continuous (ligand pose) data are jointly generated."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "2 fair"
                },
                "strengths": {
                    "value": "1. HarmonicFlow applies flow matching on 3D binding pose generation for multi ligands. The corresponding experimental results are strong, surpassing the previous method, DiffDock. The method is simple yet effective. \n2. Binding site design is a novel task in machine learning community. This task is important to some real-world applications. As for novelty of methods, to design the residue types of the binding site, it generated both discrete and continuous variables under the framework of flow matching. \n3. Many reasonable tricks are used to improve the performance, such as harmonic prior and structure self-conditioning.\n4. The comprehensive experiments show the ability of both HarmonicFlow and FlowSite. Almost all experiment details are clearly clarified. The results demonstrate the effectiveness of proposed methods."
                },
                "weaknesses": {
                    "value": "There are many other tricks used for training FlowSite and HarmonicFlow, such as many auxiliary losses similar to those in Alpafold2. But there is no related ablation study."
                },
                "questions": {
                    "value": "Because no side-chains are involved in generation, binding affinity cannot be evaluated. Is there any post hoc method to generated side-chains for the designed binding site? If so, from my perspective, evaluation on binding affinity of generated binding sites and given ligands is more rationale."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "6: marginally above the acceptance threshold"
                },
                "confidence": {
                    "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 1,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission6530/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698567697377,
            "cdate": 1698567697377,
            "tmdate": 1699636735192,
            "mdate": 1699636735192,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "6hyJboxPJy",
                "forum": "fmoknhh7CH",
                "replyto": "YwGauMkxLj",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6530/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6530/Authors"
                ],
                "content": {
                    "comment": {
                        "value": "Thank you for the detailed comments and the clear distillation of several strengths of our method, as well as your two suggestions that we address below!\n\nWe are glad to see your appreciation of the novelty of the binding site design task in the ML community and the novelty of our joint flow over discrete and continuous data, considering that there has not been any discrete flow matching work yet.\n\n### Weakness:\n**\u201cThere are many other tricks used for training FlowSite and HarmonicFlow, such as many auxiliary losses similar to those in Alpafold2. But there is no related ablation study.\u201d**\n\n* We agree that our ablations focused on HarmonicFlow and thus added the following additional ablations for both FlowSite and HarmonicFlow that show how all components are relevant for performance:\n\n* FlowSite binding site design (Table 5):\n1. Dropping the auxiliary side-chain torsion angle loss\n2. Dropping the fake ligand data augmentation\n3. Using equivariant instead of invariant layers throughout the architecture\n4. Dropping the auxiliary refinement loss of the Equivariant Refinement TFN layers\n5. Adding noise to the backbone coordinates\n\n| Method                        | BLOSUM score | Recovery |\n|-------------------------------|--------------|----------|\n| NO SIDE CHAIN TORSION LOSS    | 45.9         | 47.7     |\n| BACKBONE NOISE                | 39.6         | 42.4     |\n| NO FAKE LIGAND AUGMENTATION   | 45.5         | 46.7     |\n| NO REFINEMENT LOSS            | 45.7         | 47.6     |\n| ONLY EQUIVARIANT LAYERS       | 29.8         | 35.3     |\n| FLOW SITE discrete loss weight = 0.8 | 46.9    | 47.8     |\n| FLOW SITE discrete loss weight = 0.2 | 47.6    | 49.5     |\n\n\n* 3D structure generation with Harmonic Flow (Table 4):\n1. Using isotropic Gaussian prior instead of harmonic prior\n2. Dropping the auxiliary refinement loss of the Equivariant Refinement TFN layers\n\n| Method                | %<2  | %<2* | Med. |\n|-----------------------|------|------|------|\n| GAUSSIAN PRIOR        | 17.0 | 29.2 | 3.8  |\n| VELOCITY PREDICTION   | 11.9 | 28.8 | 3.8  |\n| STANDARD TFN LAYERS   | 13.7 | 25.4 | 3.6  |\n| NO REFINEMENT LOSS    | 9.8  | 22.1 | 3.7  |\n| NO SELF-CONDITIONING  | 14.3 | 29.8 | 3.7  |\n| HARMONICFLOW \u03c3 = 0    | 18.3 | 31.3 | 3.5  |\n| HARMONICFLOW \u03c3 = 0.5  | 20.5 | 34.5 | 3.4  |\n\n### Questions:\n**\u201cIs there any post hoc method to generated side-chains for the designed binding site?\u201d**\n\nA great question! Multiple methods exist for the task of sidechain packing; however, they commonly are not aware of the ligand. In the updated paper, we improved our discussion in section 4.3 on binding affinity evaluation with respect to how, e.g., multiple residue types might be able to bind a particular ligand. We attempted to address this by developing \u201cBLOSUM score,\u201d which takes evolutionary and physicochemical similarity into account. Ultimately, we think a final evaluation has to be biological validation.\n\n\n---\nThank you for the productive discussion so far! We hope that the improvements might warrant raising your score and we are happy to continue the conversation. Please also find other significant improvements in our general response above and have a great week!"
                    }
                },
                "number": 5,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6530/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700077020588,
                "cdate": 1700077020588,
                "tmdate": 1700077020588,
                "mdate": 1700077020588,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "Rc1HNWDDwd",
                "forum": "fmoknhh7CH",
                "replyto": "YwGauMkxLj",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6530/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6530/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Second comment by authors"
                    },
                    "comment": {
                        "value": "We authors thank you for your initial review and would be very grateful for any further discussion or acknowledgment as to whether any concerns remain after our improvements and responses!"
                    }
                },
                "number": 11,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6530/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700490549917,
                "cdate": 1700490549917,
                "tmdate": 1700490549917,
                "mdate": 1700490549917,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "iPJkyniWSz",
            "forum": "fmoknhh7CH",
            "replyto": "fmoknhh7CH",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission6530/Reviewer_cRSx"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission6530/Reviewer_cRSx"
            ],
            "content": {
                "summary": {
                    "value": "This paper proposes HarmonicFlow, an ODE flow model for generating pocket residue types and molecule structures."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "2 fair"
                },
                "strengths": {
                    "value": "- This paper studies an interesting problem.\n- The writing is generally clear."
                },
                "weaknesses": {
                    "value": "- The problem of multi-ligand binding is interesting, but I am not sure how important this task is. The authors briefly discussed this in Sec 2, and more detailed explanations can be helpful.\n\n- In Sec 1 & 2, the authors highlight that HarmonicFlow is the first DL method to handle multi-ligand docking. One critical question is that how fundamentally different multi-ligand docking is from protein-ligand docking (the existing methods). \nIf they are different, then one question is that the authors compared HarmonicFlow with DiffDock, but they are solving different problems: one for multi-ligand docking and the other for protein-ligand (both single- and multi-ligand) docking. Why their numbers can be compared to each other?\nIf they are the same in terms of the method, then HarmonicFlow is not the first DL method that can handle multi-ligand docking.\n\n- Does this vector field $u$ in Eq 1 have any physical meaning?\n\n- Can authors help summarize the essential difference between score matching / denoising diffusion with the objective (Eq 1&3) in this paper? Because score matching and denoising diffusion can be treated as ODE flow models. Also, is the proposed HarmonicFlow specific for multi-ligand docking? Now it seems that it can also fit for the general protein-ligand docking.\n\n- Many baselines, such as the related works mentioned in Sec 2, are missing in the experiments."
                },
                "questions": {
                    "value": "Please see above."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "5: marginally below the acceptance threshold"
                },
                "confidence": {
                    "value": "5: You are absolutely certain about your assessment. You are very familiar with the related work and checked the math/other details carefully."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 2,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission6530/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698751444036,
            "cdate": 1698751444036,
            "tmdate": 1699636734919,
            "mdate": 1699636734919,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "mfPwT1iSfy",
                "forum": "fmoknhh7CH",
                "replyto": "iPJkyniWSz",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6530/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6530/Authors"
                ],
                "content": {
                    "comment": {
                        "value": "Thank you for the constructive questions that we now better address in the updated text and below! We hope the improvements warrant accepting the paper and are happy to make any further changes.\n\n\n**1, First bullet: \u201cThe problem of multi-ligand binding is interesting, but I am not sure how important this task is [...]  more detailed explanations can be helpful\u201d**\n\n* Multi-ligand binding is indeed an important problem since it is crucial for, e.g., fragment-based drug design, and in our context, it is of interest for enzyme design where we would desire to design a binding site for multiple reactants / starting molecules of a chemical reaction that the enzyme should catalyze.\n\n**2, Second bullet: \u201cthe authors compared HarmonicFlow with DiffDock, but they are solving different problems: one for multi-ligand docking and the other for protein-ligand (both single- and multi-ligand) docking.\u201d**\n\n* We apologize for the following being unclear in the text and improved our description:\nThe current implementation of DiffDock can actually only do single ligand docking. We compare HarmonicFlow (which can do both single- and multi-ligand docking) with DiffDock\u2019s product space diffusion on a single-ligand benchmark. HarmonicFlow is not specific to only multi-ligand docking. Meanwhile, for our multi-ligand experiments, we compare with the diffusion process of EigenFold in Table 4. We hope the updated manuscript makes this sufficiently clear and welcome any further feedback!\n\n**3, Third bullet: \u201cDoes this vector field u in Eq 1 have any physical meaning?\u201d**\n\n* An excellent question! In general we want to be careful with such physics interpretations. The direction the vector field points in is where the expected x_1 is given that we currently are at x_t. At times very close to t=1 this can become similar to the direction of the forces on the atoms if our training data is from the Boltzmann distribution of the molecules.\n\n**4.1 Fourth bullet first part: \u201csummarize the essential difference between score matching / denoising diffusion with the objective (Eq 1&3) in this paper?\u201d**\n\n* Another great question in our opinion! Flow matching and denoising diffusion are indeed similar, with flow matching being a generalization of diffusion models. The quantity $u_t(x | x_0, x_1)$ that we regress against in equation 3 is a conditional vector field that points to a data sample (obtained by, e.g., the vector $x_1 - x_0$). Meanwhile, in diffusion models, we regress against the conditional score, which is a vector pointing toward the steepest ascent in a noised distribution. This way, in flow matching, we learn a drift that we can integrate to sample while in diffusion models, we have a predefined arbitrary drift that we have to combine with the learned score to sample. Please let us know if we can clarify this any further and if any questions remain!\n\n**4.2 Fourth bullet second part: \u201cis the proposed HarmonicFlow specific for multi-ligand docking?\u201d**\n\n* HarmonicFlow is not specific to multi-ligand docking and can also be used for single-ligand docking which we hope is now better made clear in the updated text!\n\n**5, Fifth bullet: \u201cMany baselines, such as the related works mentioned in Sec 2, are missing in the experiments.\u201d**\n\n* We adapt our related work section and baseline explanation in the experiments to better reflect the following:\n\n* With respect to HarmonicFlow: the works in section 2 (apart from DiffDock\u2019s diffusion process, which we compare with) all require sidechain positions of the protein as input which is not available in our final application of interest \u2014 binding site design \u2014 where we aim to predict the side-chain identities.\n\n* With respect to FlowSite: of the mentioned inverse folding methods, we chose PiFold since it currently has the state-of-the-art recovery rate. \n\n---\n\nThank you for the great questions! We hope the improvements that arose from them might warrant raising your score and we are happy to continue the conversation. Please also find other significant improvements in our general response above!"
                    }
                },
                "number": 4,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6530/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700077001537,
                "cdate": 1700077001537,
                "tmdate": 1700077001537,
                "mdate": 1700077001537,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "FozX3vnvsP",
                "forum": "fmoknhh7CH",
                "replyto": "iPJkyniWSz",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6530/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6530/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Second comment by authors"
                    },
                    "comment": {
                        "value": "We authors thank you for your initial review and would be very grateful for any further discussion or acknowledgment as to whether any concerns remain after our improvements and responses!"
                    }
                },
                "number": 9,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6530/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700490463631,
                "cdate": 1700490463631,
                "tmdate": 1700490463631,
                "mdate": 1700490463631,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "YRxoBnPBIV",
            "forum": "fmoknhh7CH",
            "replyto": "fmoknhh7CH",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission6530/Reviewer_XYXw"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission6530/Reviewer_XYXw"
            ],
            "content": {
                "summary": {
                    "value": "The author introduces the flow matching-based algorithm for multi-ligand docking and binding site design. The results show both FLOWSITE and HARMONICFLOW achieved the start-of-art performance. Noticeably, the FLOWSITE is the first deep-learning method for designing ligand binding pockets."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "4 excellent"
                },
                "contribution": {
                    "value": "3 good"
                },
                "strengths": {
                    "value": "1. In general, the writing is great. The contribution is clearly presented, and the method is well-introduced.\n2. The evaluation is fair and the improvement is significant.\n3. The limitation of FLOWSITE is well introduced."
                },
                "weaknesses": {
                    "value": "Most of the technology is just an application of the existing methods which prevents the paper from getting higher scores in machine learning conferences."
                },
                "questions": {
                    "value": "How fast are the two methods in terms of inference speed?"
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "6: marginally above the acceptance threshold"
                },
                "confidence": {
                    "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 3,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission6530/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698778233550,
            "cdate": 1698778233550,
            "tmdate": 1699636734633,
            "mdate": 1699636734633,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "igwf38jM03",
                "forum": "fmoknhh7CH",
                "replyto": "YRxoBnPBIV",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6530/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6530/Authors"
                ],
                "content": {
                    "comment": {
                        "value": "Thank you for the positive review! We are glad you find the improvements significant and appreciate our discussion of FlowSite\u2019s limitations.\n\n### Weaknesses:\n\u201cMost of the technology is just an application of the existing methods which prevents the paper from getting higher scores in machine learning conferences.\u201d\n\nWe think our work provides 3 main important pieces of novelty: 1. We provide the first flow matching process to jointly generate discrete and continuous data, which we consider a novelty given that there is no work on discrete flow matching yet. 2. We think next to technical novelty, the novelty of the application is also important - our work is the first to tackle binding site design with deep learning. 3. Ours is (among another ICLR submission) the first to investigate flow matching for biomolecular structures.\n\n### Questions:\n\u201cHow fast are the two methods in terms of inference speed?\u201d\n\nAn excellent question and we provide these details in the updated manuscript! Averaged over 4350 generated samples, the average runtime of HarmonicFlow is 0.223 seconds per generated structure and that of FlowSite is 0.351 seconds per sequence.\n\n---\n\nThank you for the discussion so far! We hope the clarifications and our other significant improvements in our general response might warrant raising your score!"
                    }
                },
                "number": 3,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6530/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700076982975,
                "cdate": 1700076982975,
                "tmdate": 1700076982975,
                "mdate": 1700076982975,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "EOGpBioVtR",
                "forum": "fmoknhh7CH",
                "replyto": "YRxoBnPBIV",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6530/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6530/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Second comment by authors"
                    },
                    "comment": {
                        "value": "We authors thank you for your initial review and would be very grateful for any further discussion or acknowledgment as to whether any concerns remain after our improvements and responses!"
                    }
                },
                "number": 10,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6530/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700490532359,
                "cdate": 1700490532359,
                "tmdate": 1700490532359,
                "mdate": 1700490532359,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "EOKsjQb0WF",
                "forum": "fmoknhh7CH",
                "replyto": "EOGpBioVtR",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6530/Reviewer_XYXw"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6530/Reviewer_XYXw"
                ],
                "content": {
                    "comment": {
                        "value": "Thank you for the additional details \u2013 they are valuable. However, I prefer to maintain my original score as they haven't substantially altered my opinion. I acknowledge that there are some technical novelties in the paper but I personally believe they are insufficient to get a score of 8."
                    }
                },
                "number": 12,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6530/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700549970187,
                "cdate": 1700549970187,
                "tmdate": 1700549970187,
                "mdate": 1700549970187,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "mtBr2Thhl0",
            "forum": "fmoknhh7CH",
            "replyto": "fmoknhh7CH",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission6530/Reviewer_k1W9"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission6530/Reviewer_k1W9"
            ],
            "content": {
                "summary": {
                    "value": "The paper propose FlowSite as a new generative model of protein pocket residue types and ligand conformations.\n\nMethodology novelties include 1) replace diffusion with flow matching; 2) use harmonic priors; and 3) modified model architecture.\n\nComputational results on (multiple) docking and binding site design are analyzed."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "2 fair"
                },
                "strengths": {
                    "value": "1. Good organization.\n\n2. Elevation in final performances.\n\n3. Sufficient ablation studies.\n\n4. Fake ligand augmentation is an interesting proposal."
                },
                "weaknesses": {
                    "value": "1. Overall the paper is much of a summarization of known techs: harmonic priors are discussed in EigenFold; self-conditioning is applied in CV/ RFdiffusion; replacing diffusions with flow matching is well studied in CV; and model architecture improvements are somehow trivial. \n\n2. Three applications are proposed in this paper, while except for docking, multiple docking / binding site generation are not well investigated. The idea of multiple ligand docking itself is interesting, but not well studied. As it is mentioned in the title I'd expect some impressive case studies of multiple docking and some analysis of significance in the result. I would suggest the authors be more focused.\n\n3. Backbone flexibility is not allowed in the entire picture. All experiments are done on PDBBind which provides accurate holo structures of proteins. This very much limited the significance of improvements on figures in this paper.\n\n4. Baselines are weak."
                },
                "questions": {
                    "value": "1. Are sidechains configurations by any means included as data inputs?\n\n2. I would expect some analysis of the ODE dynamics, especially with regard to the joint dynamics of residue types and molecular conformations."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "Yes, Research integrity issues (e.g., plagiarism, dual submission)"
                    ]
                },
                "details_of_ethics_concerns": {
                    "value": "A shortened version of this paper is submitted to and accepted by NeurIPS GenBio. Ideas, figures and data are all the same. Check https://openreview.net/forum?id=XgkYO1S2vM ."
                },
                "rating": {
                    "value": "5: marginally below the acceptance threshold"
                },
                "confidence": {
                    "value": "5: You are absolutely certain about your assessment. You are very familiar with the related work and checked the math/other details carefully."
                },
                "code_of_conduct": {
                    "value": "Yes"
                },
                "first_time_reviewer": {
                    "readers": [
                        "ICLR.cc/2024/Conference/Program_Chairs",
                        "ICLR.cc/2024/Conference/Submission6530/Senior_Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission6530/Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission6530/Reviewer_k1W9"
                    ]
                }
            },
            "number": 4,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission6530/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698815056955,
            "cdate": 1698815056955,
            "tmdate": 1700551271477,
            "mdate": 1700551271477,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "LK6y1NLuSC",
                "forum": "fmoknhh7CH",
                "replyto": "mtBr2Thhl0",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6530/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6530/Authors"
                ],
                "content": {
                    "comment": {
                        "value": "We appreciate your time taken for reviewing and are glad you find the fake ligand augmentation interesting and see the ablation studies as a strength.\n\nRegarding the Dual submission ethics concerns:\n* We think there might be a confusion about the GenBio workshop having proceedings. The ICLR 2024 dual submission policy (https://iclr.cc/Conferences/2024/CallForPapers) states, \u201cpapers that [...] have been presented at workshops (i.e., venues that do not have publication proceedings) do not violate the policy.\u201d Does this address your Ethics concerns?\n\n### Weaknesses:\n**1, \u201cOverall the paper is much of a summarization of known techs\u201d**\n\n* We argue that there are 3 critical points of novelty that might be overlooked. We provide the first flow matching process to jointly generate discrete and continuous data, which we consider a novelty given that there is no work on discrete flow matching yet. Secondly, we think next to technical novelty, the novelty of the application is also important - our work is the first to tackle binding site design with deep learning. Thirdly, ours is (among another ICLR submission) the first to investigate flow matching for biomolecular structures, which exhibit (also in diffusion models) different behavior than CV. \n\n**2, \u201cI'd expect some impressive case studies of multiple docking [...] I would suggest the authors be more focused\u201d.**\n\n* Thank you for the suggestion! We now included several case studies that were randomly picked from the test set and show how HarmonicFlow produces more realistic bond lengths and bond angles and respects physical constraints better. We acknowledge that our work indeed does not focus on multi ligand docking - we describe the problem and evaluate it since we see it as important for binding site design when the goal is to design binders for multiple molecules, such as reactants in an enzyme. In our updated version, we clarify this focus - we are happy to also change the title if you think that is a better description of the work.\n\n**3, \u201cBackbone flexibility is not allowed in the entire picture. All experiments are done on PDBBind, which provides accurate holo-structures of proteins.\u201d**\n\n* We agree that for a full docking pipeline the performance on apo structures is interesting next to the holo performance. In our work, we evaluate docking performance only for the purpose of  binding site design as required for our task definition which we chose for its alignment with the state-of-the-art traditional binding site and enzyme design approach of (https://www.nature.com/articles/s41586-023-05696-3) where the starting point is also a fixed backbone structure that is not altered. \n\n**4, \u201cBaselines are weak.\u201d**\n\n* We added another new stronger baseline to Table 3 based on the anonymous ICLR 2024 submission DiffDock-Pocket [1]. It operates similar to our ground truth position comparison model, except that the fixed positions are given by a sample from DiffDock-Pocket, a recent state-of-the-art pocket level docking tool. We note that, as we are the first to consider this task, there are no existing baselines for it yet.\n\n| Method              | BLOSUM Score | Recovery Percentage |\n|---------------------|--------------|---------------------|\n| DiffDock-Pocket Pos | 42.6         | 45.0                |\n| FlowSite (ours)     | 47.6         | 49.5                |\n\n### Questions:\n**1, Are sidechains configurations by any means included as data inputs?**\n\n* They are not used as inputs and only a quantity that we predict as auxiliary target.\n\n**2, \u201cI would expect some analysis of the ODE dynamics\u201d**\n\n* Thank you for the suggestion! We now included a plot (Figure 11) of the evolution of FlowSite's x_1 prediction's RMSD and the evolution of the output entropy of the residue type probabilities. The results show how a more determined structure prediction correlates with a decrease in uncertainty of the residue type prediction.\n\n---\n\nThank you for the constructive conversation! We hope the improvements that arose from your suggestions might warrant raising your score and we are happy to continue the discussion."
                    }
                },
                "number": 2,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6530/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700076966075,
                "cdate": 1700076966075,
                "tmdate": 1700076966075,
                "mdate": 1700076966075,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "n3vLUKalFW",
                "forum": "fmoknhh7CH",
                "replyto": "mtBr2Thhl0",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6530/Reviewer_k1W9"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6530/Reviewer_k1W9"
                ],
                "content": {
                    "title": {
                        "value": "Rebuttal reply"
                    },
                    "comment": {
                        "value": "Thank you for the clarification of ethical concerns and other issues. \n\n1) the ethical concerns are resolved.\n\n2) thanks for the ode analysis which basically solves my concerns in the black-box issue about the ODE.\n\n3) the analysis of binding site design and multiple ligand docking is addressed, but the binding site design part is not well benchmarked against other inverse folding / inpainting baselines beyond PiFold. In fact, I would expect some larger elevation in the recovery rate because most of the sequences are given. The visualization results themselves are also not convincing to display the model's accuracy.\n\n4) about the concern \u201coverall the paper is much of a summarization of known techs\u201d, the author's reply still does not resolve my concerns. Indeed applications of techs transfering from one domain to another is interested, but current results are far from being strong enough to persuade a drug designer in believing the outputs from the model.\n\noverall I would give this a 5."
                    }
                },
                "number": 13,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6530/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700551238239,
                "cdate": 1700551238239,
                "tmdate": 1700551238239,
                "mdate": 1700551238239,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "ENVouL3BEm",
            "forum": "fmoknhh7CH",
            "replyto": "fmoknhh7CH",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission6530/Reviewer_4Vb5"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission6530/Reviewer_4Vb5"
            ],
            "content": {
                "summary": {
                    "value": "The problem is to predict the structure of the binding pocket for a set of ligands, given the structure of the protein backbone and the 2D structure of the ligand(s). The authors introduce two flow matching models: HarmonicFlow (predicts the 3D structure of the pocket without residue types) and FlowSite (predicts both the 3D structure of the pocket and residue types).\n\nIn the main text, there are three groups of experiments:\n\nQ1. Comparisons of HarmonicFlow with:\n- DiffDock on PDBBind,\n- EigenFold on MOAD.\n\nQ2. Estimation of correctly predicted residues in the binding site on PDBBind and MOAD datasets.\n\nQ3. Ablation studies for Flow matching design choices.\n\nIn addition, the authors introduce fake ligand data augmentation and recycling strategy for the flow model."
                },
                "soundness": {
                    "value": "1 poor"
                },
                "presentation": {
                    "value": "2 fair"
                },
                "contribution": {
                    "value": "2 fair"
                },
                "strengths": {
                    "value": "FlowSite shows better quality than the methods to which it was compared in the reported settings."
                },
                "weaknesses": {
                    "value": "- The paper is rather hard to follow.\n- The design of most experiments is not clear to me (see questions)."
                },
                "questions": {
                    "value": "1. In Q1, the approach is verified on a problem of site-specific docking. Why do you think that the quality of docking tells much about the quality of side-chain prediction (DiffDock can perform this task without this information)? Moreover, for me, it is not fair to compare FlowSite with a blind docking algorithm in a site-specific setting.\n2. In Q2, you compare the ground truth amino acids with the predicted ones. Is it a fair surrogate metric for de novo generation, when for a given set of ligands and backbone coordinates there potentially can be many different answers? An algorithm that can generate pockets with a better binding affinity than affinity of pockets from the dataset, will have a low score.\n3. The output of the flow-matching model should also depend on the sampled initial conditions. In Q2 experiments, do you consider a single run of the noise sampling? Have you tried to sample many different noise vectors and compare the outputs?\n4. You said that it is not feasible to estimate the energy. Why? I suppose that the energy of the designed protein and the affinity of the complexes can be somehow estimated using traditional or machine learning methods. At least, it is possible to use the all-atoms confidence model from DiffDock and compare scores of complexes.\n5. In many experiments, you mentioned the oracle method that has access to the ground truth ligand structure. What exactly is this method?\n6. How much time does it take to train your model on PDBBind and MOAD?"
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "5: marginally below the acceptance threshold"
                },
                "confidence": {
                    "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                },
                "first_time_reviewer": {
                    "value": "Yes",
                    "readers": [
                        "ICLR.cc/2024/Conference/Program_Chairs",
                        "ICLR.cc/2024/Conference/Submission6530/Senior_Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission6530/Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission6530/Reviewer_4Vb5"
                    ]
                }
            },
            "number": 5,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission6530/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698838383163,
            "cdate": 1698838383163,
            "tmdate": 1699636734333,
            "mdate": 1699636734333,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "jEHAzUOsSG",
                "forum": "fmoknhh7CH",
                "replyto": "ENVouL3BEm",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6530/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6530/Authors"
                ],
                "content": {
                    "comment": {
                        "value": "Thank you for the time taken to review our work and for the excellent questions that helped improve the paper!\n\n\nWe understand how these questions arose - we updated the text to contain the following answers to your questions. We hope this makes the paper easy to follow and the experiment setup sufficiently clear. Please let us know if further changes are required.\n\n1.1 **Question: \u201cWhy do you think that the quality of docking tells much about the quality of side-chain prediction (DiffDock can perform this task without this information)?\u201d**\n\n* A great question! While DiffDock does not use side-chain atom positions, it does use the residue identities as features, which improves performance as the experiments without residue identities in Table 5 show. We are confident that a good structure prediction aids residue-type prediction since the recovery rate is 51.4% when using the ground truth ligand positions as input compared to 41.8% when using random ligand positions. \n\n1.2 **Regarding the concern of comparing with DiffDock\u2019s product space diffusion, which was originally developed for Blind docking.**\n\n* This is an important concern! However, the work \u201cDiffDock-Pocket: Diffusion for Pocket-Level Docking with Sidechain Flexibility\u201d (https://openreview.net/forum?id=1IaoWBqB6K) now shows that the product space diffusion employed in a similar way as in our work is a strong pocket level docking method (although they use side-chain atom positions which are not available in our application). We now cite this paper to clarify this.\n\n2, **Regarding using amino acid recovery for known pockets as metrics and that there can be multiple right answers, not only the residues in the ground truth data.**\n\n* This is correct and an important point! The recovery metric has been shown to be a good proxy for downstream performance in the inverse folding literature (https://www.science.org/doi/10.1126/science.add2187 PMPNN, https://arxiv.org/abs/2306.16819 GRADEIF) and we try to improve over it with our BLOSUM metric which allows for multiple solutions by taking evolutionary and physicochemical similarity of residues into account. We now better discuss your concern in the 4.3 Metrics paragraph, and in our conclusion, we acknowledge how, ultimately, biological validation is required to fully evaluate, which is ongoing work.\n\n3, **Question \u201cHave you tried to sample many different noise vectors and compare the outputs?\u201d**\n\n* We indeed generate 10 samples per complex and evaluate the average quality. In the updated text, we now also provide the standard deviation over these samples, which is 1.16 Angstrom RMSD for Distance-Pockets on the time split (similar for all settings) and \n2.5% for the recovery rate and 1.8 Blosum score on PDBBind.\n\n4, **Estimating binding free energy or using DiffDock\u2019s confidence model as proxy.**\n\n* Our discussion of the following was unclear in the text, and we improved it in the update: DiffDock\u2019s confidence model and common computational binding affinity correlates would require the ligand and side chain atom positions as input, which none of the methods (except ours) produce. Thus, we could only produce a number for FlowSite with no comparison. Further, DiffDock\u2019s confidence model was never trained on negatives, meaning that it cannot distinguish between binders and non-binders, and there is no evidence for it as a correlate for binding affinity.\n\n5, **\u201cyou mentioned the oracle method that has access to the ground truth ligand structure. What exactly is this method?\u201d**\n\n* Thank you for pointing out our insufficient explanation, which we now improved! This is the same architecture as FlowSite, but instead of using the predicted ligand positions, the ground truth crystal structure ligand positions are used as input and not altered. In practice, this information would not be known during inference.\n\n6, **Question: \u201cHow much time does it take to train your model on PDBBind and MOAD?\u201d**\n\n* We now included this in the paper: on PDBBind, FlowSite took 58.6 hours, and on MOAD 115.6 hours. Both on an RTX A600 GPU.\n\n---\nThank you for the productive discussion! We hope that the improvements might warrant raising your score and we are happy to continue the conversation and make further changes. Please also find other significant improvements in our general response above!"
                    }
                },
                "number": 1,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6530/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700076930452,
                "cdate": 1700076930452,
                "tmdate": 1700076930452,
                "mdate": 1700076930452,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "KWQXRScs0C",
                "forum": "fmoknhh7CH",
                "replyto": "ENVouL3BEm",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6530/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6530/Authors"
                ],
                "content": {
                    "comment": {
                        "value": "We authors thank you for your initial review and would be very grateful for any further discussion or acknowledgment as to whether any concerns remain after our improvements and responses!"
                    },
                    "title": {
                        "value": "Second comment by authors"
                    }
                },
                "number": 7,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6530/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700490274821,
                "cdate": 1700490274821,
                "tmdate": 1700490388011,
                "mdate": 1700490388011,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    }
]