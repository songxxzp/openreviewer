[
    {
        "title": "SpecFormer: Guarding Vision Transformer Robustness via Maximum Singular Value Penalization"
    },
    {
        "review": {
            "id": "B0yqfEF9ql",
            "forum": "mivL0akE5E",
            "replyto": "mivL0akE5E",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission6667/Reviewer_B7sA"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission6667/Reviewer_B7sA"
            ],
            "content": {
                "summary": {
                    "value": "This paper proposes SpecFormer, a method to improve the adversarial robustness of Vision Transformer (ViT) models. The authors first provide a theoretical analysis of the local Lipschitz continuity of the self-attention mechanism, and establish its connection with the robustness of ViT models. Based on this, they propose a Maximum Singular Value Penalization (MSVP) algorithm that can effectively control the local Lipschitz constant of attention layers to improve model robustness."
                },
                "soundness": {
                    "value": "4 excellent"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "4 excellent"
                },
                "strengths": {
                    "value": "The novel formulation of studying ViT robustness from the perspective of local Lipschitz continuity provides an insightful theoretical framework. Establishing this connection between self-attention mechanisms and model robustness is a creative combination of existing theories that opens up new possibilities.\nThe proposed MSVP algorithm is simple, novel, yet ingenious. By seamlessly integrating spectral control into ViT self-attention, it enhances robustness with minimal overhead. This creative application in a new domain removes limitations of prior empirical defenses.\nExperiments on various datasets and models solidly verify the efficacy and consistency of the methods. The superior performance shows this is a significant advancement with real-world impact.\nThe writing is lucid, and the derivations are meticulous. The theoretical analysis firmly grounds the technical innovation on solid mathematical principles. The paper quality is publication-worthy."
                },
                "weaknesses": {
                    "value": "Some steps in the proof are a little bit concise that are not easy to understand. For instance, in the proof of Theorem 4.3, can you explain in detail the steps involved in utilizing Cauchy\u2019s inequality and boundedness of input space to arrive at inequality (36)? Adding these intermediate deductions would help enhance the clarity of the theoretical derivations.\nMore visual results, such as attention maps, can be provided to further visually demonstrate the impact of the proposed method on safeguarding the attention mechanism under malicious attacks."
                },
                "questions": {
                    "value": "Can the method be easily applied to other real-life datasets such as surveillance videos, facial recognition, or remote sensing images to enhance vision safety, in addition to experimental datasets like CIFAR and ImageNet?\nCan this method be extended to domains beyond vision, such as NLP, to enhance adversarial robustness in text processing tasks?\nWhat is the efficiency of the method, i.e, can it be implemented in plain GPUs?"
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "8: accept, good paper"
                },
                "confidence": {
                    "value": "5: You are absolutely certain about your assessment. You are very familiar with the related work and checked the math/other details carefully."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 1,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission6667/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698319641608,
            "cdate": 1698319641608,
            "tmdate": 1699636763045,
            "mdate": 1699636763045,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": []
    },
    {
        "review": {
            "id": "aoIY8Zfyj5",
            "forum": "mivL0akE5E",
            "replyto": "mivL0akE5E",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission6667/Reviewer_J9Ns"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission6667/Reviewer_J9Ns"
            ],
            "content": {
                "summary": {
                    "value": "The paper proposes SpecFormer, a novel approach to enhance ViTs\u2019 resilience against adversarial attacks. It first provides a theoretical analysis that connects the local Lipschitz continuity of ViTs to their robustness against adversarial attacks. Based on this analysis, SpecFormer introduces a Maximum Singular Value Penalization (MSVP) algorithm that restricts the Lipschitz constant of the self-attention layers by penalizing the maximum singular values of the projection matrices. This helps regulate the extent of output variations when perturbations are introduced, making the model more robust. The authors integrates MSVP into ViT's training using the power iteration method to compute the maximal singular value of each attention layer. The authors then demonstrate the effevtiness of there approach on CIFAR, ImageNet and Imagenette datasets."
                },
                "soundness": {
                    "value": "2 fair"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "2 fair"
                },
                "strengths": {
                    "value": "Given the current popularity of the self-attention layer, investigating the robustness of this type of layer is important. The current approach studies the local Lipschitz of the self-attention layer, which is a very interesting direction of research."
                },
                "weaknesses": {
                    "value": "**In its current form, the paper has several weaknesses:**\n\n**Major weaknesses:**\n- The proposed bound takes advantage of the global Liscphitz of the linear mapping operations in the self-attention layer. This results in a very loose bound that is quadratic in N, the Frobenius norm of the input and delta. The looseness of the bound is clear when $\\delta_0 = 0$. \n- The proposed regularization based on the bound is a simple spectral regularization. However, it is not clear how the bound is affected since the regularization only focuses on the maximum singular values of the weights. The norm of the inputs may actually grow across the different layers of the model to compensate for the decrease of the spectral norm of the weights.\n- I believe that the resulting robustness is a simple case of obfuscated gradients as described in [1]: the model is not particularly more robust, it is the attacks that are less effective, especially with such weak attacks as FGSM or PGD-2 with 2/255 of the attack budget. This misunderstanding is clear from these two statements: \n\n``The proposition above suggests that when the maximum singular value of the weight matrices is small, the function f\u03b8 becomes less sensitive to input perturbations, which can significantly enhance adversarial robustness.``\n\n``we can independently control the maximum singular values of these three weight matrices to imbue the model with adversarial robustness.``\n\nThe robustness from Lipschitz continuity is an inherent trade-off between the Lipschitz _and the margin_ of the classifier, as explicitly described in [2]. Reducing only the Lipschitz can have no impact on robustness if the margin is also reduced (which is often the case). \n\n**On the choice of the norm:**\n- The authors state: \"The 2-norm is the most commonly used norm in Euclidean space\". While the choice of the $\\ell_2$ norm is perfectly reasonable, the $\\ell_\\infty$ norm is also highly studied in the adversarial robustness community. I would not say that the $\\ell_2$ norm is \"the most widely used norm\". \n- The authors state: \"the sensitivity of a model to input perturbations is closely related to the 2-norm of the weight matrices\". The sensitivity with respect to the $\\ell_2$ norm is related to the 2-norm of the weight matrices, but one can still define the sensitivity with respect to any $\\ell_p$ norm.  \n- The bound proposed in the paper is a bound on the local Lipschitz constant with respect to the $\\ell_2$ norm. Therefore, it is not clear why the authors evaluate their approach against FGSM, which is a $\\ell_\\infty$ attack. It is also not clear whether the PGD attack used for the experiments is with respect to the $\\ell_2$ or $\\ell_\\infty$ norm. A study of robustness against the linf norm can be done even though the proposed approach works for $\\ell_2$, but mixing both $\\ell_2$ and linf in the tables is confusing. \n\n**On the structure of the paper:**\n- In my opinion, the half page on page 4 on Lipschitz continuity could be condensed. Global Lipschitz and local Lipschitz are well-defined concepts in adversarial robustness. \n- Theorem 4.2 is trivial and in my opinion not necessary. \n- The whole section on power iteration is not necessary, the power method has been used many times in deep learning [2, 3, 4, 5, 6] and is a well-known concept. Also, the proof of convergence of the power iteration in the appendix doesn't seem to serve any clear purpose other than to fill space in the appendix. A reference to the relevant papers would suffice.\n- Based on these comments, the authors could save space in the main paper and move Appendix D \"Comparison with existing bounds\" and the results on ImageNet to the main paper. Appendix D is interesting and would be better placed in the main paper. \n\n[1] Athalye et al. Obfuscated Gradients Give a False Sense of Security: Circumventing Defenses to Adversarial Examples  \n[2] Tsuzuku et al. Lipschitz-Margin Training: Scalable Certification of Perturbation Invariance for Deep Neural Networks  \n[3] Farnia et al. Generalizable Adversarial Training via Spectral Normalization  \n[4] Meunier et al. A Dynamical System Perspective for Lipschitz Neural Networks  \n[5] Miyato et al. Spectral Normalization for Generative Adversarial Networks  \n[6] Yoshida et al. Spectral Norm Regularization for Improving the Generalizability of Deep Learning"
                },
                "questions": {
                    "value": "- Can the authors comment on the impact of the regularization on the bound, specifically with respect to the input norm of each layer?\n- Can the authors about the norm used in the experimental settings?"
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "details_of_ethics_concerns": {
                    "value": "NA"
                },
                "rating": {
                    "value": "3: reject, not good enough"
                },
                "confidence": {
                    "value": "5: You are absolutely certain about your assessment. You are very familiar with the related work and checked the math/other details carefully."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 2,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission6667/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698332630541,
            "cdate": 1698332630541,
            "tmdate": 1699636762887,
            "mdate": 1699636762887,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": []
    },
    {
        "review": {
            "id": "3dUiyjXIHo",
            "forum": "mivL0akE5E",
            "replyto": "mivL0akE5E",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission6667/Reviewer_Q4D5"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission6667/Reviewer_Q4D5"
            ],
            "content": {
                "summary": {
                    "value": "The paper aims to improve the robustness of Vision Transformer using spectral normalization. During training the spectral norm of weight matrices in Transformer are estimated using power method and is added to the training loss. The theoretical results include a local Lipschitz bounds of self-attention which are correlated with the spectral norm of weight matrices.\n\nThe proof of this paper consists of two parts. The first part derives the Jacobian of one self-attention layer in Transformer. The second part bound the norm of the Jacobian around a  ball of input X. Although the theorem is presented and useful, I cannot regard this paper as a \u201ctheory\u201d paper because the techniques used to derive and bound Jacobian are standard (e.g., using triangle inequalities). This is fine for a paper focusing more on the empirical side.\n\nMy main concern for this paper is that the theoretical results are loose and are not directly connected to the experiments part (see below); the empirical results used weak adversarial attacks and training methods that are far from the current state-of-the-art. So I tend to reject the current version of this paper, but I am happy to reevaluate the paper based on new results from the authors."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "2 fair"
                },
                "strengths": {
                    "value": "1. The robustness and Lipschitzness of transformer-based architectures are not well explored in the literature. A majority of papers studying robustness used convolutional neural networks. This paper nicely provides new results to fill this gap.\n\n2. The theoretical results, while straightforward, are new in the sense that existing literature considers only the global Lipschitz bounds.\n\n3. The writing of this paper is clear and easy to follow. Sufficient implementation details are given in the experiment section and also in the appendix."
                },
                "weaknesses": {
                    "value": "1. Although the paper provides some bounds on local Lipschitz constants, it is rather loose and is likely vacuous in practical networks. In particular, the N(N+1)B factor can be really large. Here N is the number of tokens and B is the Frobenius norm of the input of this layer. The three factors multiplied together give a factor of about a thousand or more.\n\n2. Some \u201ctheorems\u201d and \u201cpropositions\u201d (including 4.2 and 5.1) are textbook results. I feel it is not needed to write them as theorems in the paper. They do not add to the technical contribution of this paper.\n\n3. The theory part and the experiments are disconnected: the main theorem presented is about the L2 norm of the attention layer, but the actual attack is done with PGD attack with Linf perturbation of 2/255 and 8/255.\n\n4. The baselines presented in experiments are far from state-of-the-art. It would be better to actually show whether this method can improve upon a state-of-the-art adversarial defense training method. For example, https://robustbench.github.io lists many training methods can can achieve over 60% robust accuracy on CIFAR10."
                },
                "questions": {
                    "value": "1. Can you evaluate the numerical values of the Lipschitz constants according to Theorem 4.3 for the networks trained in this work vs vanilla neural networks?\n\n2. Can you provide results using PGD with more steps and also autoAttack? FGSM and 20 step PGD are pretty weak and cannot truly evaluate model robustness.\n\n3. Can you provide results for L2 norm robustness? This is a more relevant setting to the theory developed in this work."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "5: marginally below the acceptance threshold"
                },
                "confidence": {
                    "value": "5: You are absolutely certain about your assessment. You are very familiar with the related work and checked the math/other details carefully."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 3,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission6667/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1699379472742,
            "cdate": 1699379472742,
            "tmdate": 1699636762775,
            "mdate": 1699636762775,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": []
    }
]