[
    {
        "title": "Symmetry Leads to Structured Constraint of Learning"
    },
    {
        "review": {
            "id": "vYHlkZaQSS",
            "forum": "zMR2dTNdft",
            "replyto": "zMR2dTNdft",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission834/Reviewer_Wp9T"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission834/Reviewer_Wp9T"
            ],
            "content": {
                "summary": {
                    "value": "This paper studies how loss function symmetries affect learning. The authors propose a general definition, namely mirror reflection symmetry, which unifies common symmetries including rescaling, rotation, and permutation symmetry. They then prove that every mirror symmetry leads to a structured constraint, which becomes a favored solution when the weight decay or gradient noise is large. The theoretical framework is applied to explain various phenomena in gradient based learning and to suggest new algorithms that enforce constraints."
                },
                "soundness": {
                    "value": "2 fair"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "3 good"
                },
                "strengths": {
                    "value": "Deriving properties of learning from symmetry in the loss function alone is original. This approach poses little assumption on the architecture, thus making the conclusions more general than previous studies. \n\nBesides bringing a novel perspective, the new framework based on symmetry provides explanations to a wide range of phenomena in neural network training. Its ability to unify the theory behind these phenomena demonstrates the usefulness of the proposed approach.\n\nThe writing is clear, and each theorem is accompanied by helpful and intuitive explanations."
                },
                "weaknesses": {
                    "value": "Section 2.1 mentions ReLU network as an example with rescaling symmetry. ReLU networks are not differentiable at some points in the parameter space. However, the proof of theorem 1 assumes that $\\ell_0$ is twice differentiable, at least in the neighborhood of all points with $(u,w)=(0,0)$. \n\nDepending on the geometry of the loss function, $\\gamma$ that satisfies (21) may diverge close to (u,w)=(0,0). Hence, while Theorem 1 part 2 can be interpreted as locally favoring solutions (u,w)=(0,0), the required regularization strength can be too large to make this interpretation meaningful. Part 2 of theorem 2 and 3 have the same issue.\n\nSome derivations in the main text skip steps, which makes it hard to follow for readers less familiar with related work. For example, it would be helpful to include some background information or reference for the escape rate of SGD in the third paragraph on page 7. In the following paragraph, the assumption that $H(x)$ commutes with $H(x\u2019)$ might need a justification.\n\nWhile the theory is successful in explaining various known phenomenon in training, there is limited evidence of its potential in guiding practices. Including some applications, such as experiments to back up the effectiveness of the algorithm in Section 4.6, could make the value of the theory more convincing."
                },
                "questions": {
                    "value": "Lemma 2.1 in (Simsek 2021) also characterizes an attractive subspace derived from symmetry. Could the authors comment on whether this subspace is related to the stationary condition (Definition 3)?\n\nRegarding footnote 5, would it be possible to prove that a twice differentiable function with bounded parameters cannot have a negatively diverging Hessian eigenvalue?"
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "5: marginally below the acceptance threshold"
                },
                "confidence": {
                    "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                },
                "first_time_reviewer": {
                    "value": "Yes",
                    "readers": [
                        "ICLR.cc/2024/Conference/Program_Chairs",
                        "ICLR.cc/2024/Conference/Submission834/Senior_Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission834/Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission834/Reviewer_Wp9T"
                    ]
                }
            },
            "number": 1,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission834/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1697822132936,
            "cdate": 1697822132936,
            "tmdate": 1699636011014,
            "mdate": 1699636011014,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "DiBPFt8QWC",
                "forum": "zMR2dTNdft",
                "replyto": "vYHlkZaQSS",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission834/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission834/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Reply part 1"
                    },
                    "comment": {
                        "value": "Thank you for the detailed feedback. We answer both the weaknesses and questions below. \n\nWeaknesses:\n\n**1. Section 2.1 mentions ReLU network as an example with rescaling symmetry. ReLU networks are not differentiable at some points in the parameter space. However, the proof of theorem 1 assumes that $\\ell_0$ is twice differentiable, at least in the neighborhood of all points with $(u,w)=(0,0)$.**\n\nThis is true. As is clear from the requirement that the loss function needs to be differentiable, the theorems do not apply to the rescaling symmetry due to the ReLU activation. We have made this point clear in the manuscript. \n\n\n**2. Depending on the geometry of the loss function, $\\gamma$ that satisfies (21) may diverge close to (u,w)=(0,0). Hence, while Theorem 1 part 2 can be interpreted as locally favoring solutions (u,w)=(0,0), the required regularization strength can be too large to make this interpretation meaningful. Part 2 of theorem 2 and 3 have the same issue.**\n\nThanks for this criticism. We acknowledge that part 2 of these theorems is qualitative in nature, and giving a quantitative estimate of the required $\\gamma$ remains an important open problem and can be highly problem-dependent. However, please let us explain why this is not really a weakness but a feature of the theory.\n\nFirst of all, we would like to point out that there is no divergence close to (u,w) = (0,0). The divergence is only possible if the loss function is not differentiable at (0,0), which is not possible by the assumption of twice-differentiability.\n\nSecondly, we note that it is possible to construct a dataset such that the required $\\gamma$ is arbitrarily large -- however, this is not a problem but a feature. The magnitude of the required $\\gamma$ is in general proportional to the strength of the correlation in the data. The best example to illustrate this problem is the simple 1d regression problem with rescaling symmetry: $L=(uwx-y)^2 + \\gamma(u^2 + w^2)$. The minimizers of this objective are identical to the classical lasso objective (where $\\gamma$ is equivalent to the regularization coefficient of the L1 penalty in lasso). At what $\\gamma$ does $(0,0)$ become a sparse solution? The analytical solution is known: $\\gamma=|xy|$. Namely, a sparse solution is preferred precisely when the regularization is stronger than the feature. By increasing $|xy|$, one can certainly make the required $\\gamma$ arbitrarily large, but the same \"problem\" exists in lasso -- the stronger the data correlation, the larger the required L1 penalty to get a sparse solution. Therefore, this is not really a problem of the regularization method -- it merely reflects the (desired) fact that a strong regularization is required to prevent an easy overfitting. \n\nThirdly, we would like to point out that, empirically, this is not really a problem for common deep learning problems. The reason is that the required $\\gamma$ to cause a collapse in a certain direction can be approximated with the smallest eigenvalue of the Hessian in this direction. In deep learning, empirical works have found that the majority of the eigenvalues of the Hessian of a network is close to zero, with only a few large outliers (for example, see https://arxiv.org/abs/1706.04454). Therefore, for the majority of the direction to collapse/become sparse, only a small $\\gamma$ is required. This is also consistent with our experiments in Figure 1 and Appendix A."
                    }
                },
                "number": 6,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission834/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700459513918,
                "cdate": 1700459513918,
                "tmdate": 1700459513918,
                "mdate": 1700459513918,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "EtM020DRgQ",
                "forum": "zMR2dTNdft",
                "replyto": "vYHlkZaQSS",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission834/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission834/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Reply part 2"
                    },
                    "comment": {
                        "value": "**3. Some derivations in the main text skip steps, which makes it hard to follow for readers less familiar with related work. For example, it would be helpful to include some background information or reference for the escape rate of SGD in the third paragraph on page 7. In the following paragraph, the assumption that $H(x)$ commutes with $H(x')$ might need a justification.**\n\nThanks for this criticism. When the dynamics follows SGD with minibatch noise, the local dynamics (and attractivity) is characterized by the Lyapunov exponent of the random matrix product process. The characterization of the Lyapunov exponent for this problem is a well-known open problem (see below). We have updated the manuscript to point to the study of escape rates for these problems. \n\nRegarding the commutation approximation, we use this approximation to give a qualitative characterization of the Lyapunov exponent and highlight its nonlinear dependence on the learning rate, batch size, and gradient distribution. This approximation suffices for our qualitative discussion. That being said, it should be noted that it is not a very accurate approximation, and the computation and estimation of the Lyapunov exponent for this process is, in fact, a well-known open problem for the field of dynamical systems and ergodic theory. For example, see Maximal Lyapunov exponents for random matrix products | SpringerLink for its discussion and advanced methods for estimating the Lyapunov exponents. We have also added these parts to the manuscript to help clarify this point to the readers.\n\n\n\n**4. While the theory is successful in explaining various known phenomenon in training, there is limited evidence of its potential in guiding practices. Including some applications, such as experiments to back up the effectiveness of the algorithm in Section 4.6, could make the value of the theory more convincing.**\n\nThanks for this suggestion. We have now added an experiment to compare the learning dynamics of a vanilla ResNet18 and ResNet18 with the rescaling symmetry (a special case of the proposed DCS algorithm). The experiment shows that there is no significant difference between the final performance and the training time between the two, while the ResNet18 with the rescaling symmetry is sparse overall. See Section A4.\n\n\nQuestions:\n\n**1. Lemma 2.1 in (Simsek 2021) also characterizes an attractive subspace derived from symmetry. Could the authors comment on whether this subspace is related to the stationary condition (Definition 3)?**\n\nThanks for pointing to this relevant lemma from Simsek et al. This lemma characterizes the stationarity of the symmetry subspace due to the permutation symmetry when training proceeds with gradient flow. In agreement with our result, the symmetry subspace identified in Simsek agrees with our identification of the stationary condition for the permutation. The difference is that, certainly, our theory deals with discrete-time SGD under the minibatch stochasticity. We have added a discussion of this point to the manuscript. \n\n**2. Regarding footnote 5, would it be possible to prove that a twice differentiable function with bounded parameters cannot have a negatively diverging Hessian eigenvalue?**\n\nYes. By the definition of the $C_2$ function class, we know that the second partial derivatives of the loss function are continuous. When restricted to a closed and bounded domain, a continuous function is bounded. Therefore, the Hessian matrix is always bounded, which implies that its eigenvalues are also bounded."
                    }
                },
                "number": 7,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission834/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700459567228,
                "cdate": 1700459567228,
                "tmdate": 1700459567228,
                "mdate": 1700459567228,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "x846a86hbn",
                "forum": "zMR2dTNdft",
                "replyto": "EtM020DRgQ",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission834/Reviewer_Wp9T"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission834/Reviewer_Wp9T"
                ],
                "content": {
                    "comment": {
                        "value": "Thank you for your response. I appreciate the added clarifications and the new experiment that compares learning dynamics with and without the rescaling symmetry. However, while I agree that the qualitative nature of the part 2 of theorem 1-3 is a feature of these theorems, I am not convinced that this does not affect the significance of the result. Therefore, I am inclined to maintain my score."
                    }
                },
                "number": 9,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission834/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700719731715,
                "cdate": 1700719731715,
                "tmdate": 1700719731715,
                "mdate": 1700719731715,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "tQoa2M661Q",
            "forum": "zMR2dTNdft",
            "replyto": "zMR2dTNdft",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission834/Reviewer_HdbE"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission834/Reviewer_HdbE"
            ],
            "content": {
                "summary": {
                    "value": "A novel theory of neural network symmetries is put forward which is loss function and architecture agnostic. Namely, a class of mirror symmetries are defined which includes rescaling, permutation, and rotation symmetries, and these mirror symmetries are shown to interact with weight decay to create absorbing states that cause network training to preferentially converge to certain low-rank solutions. The implications of this theory on empirical phenomena, including block structure Hessians, SGD convergence to saddle points, neural collapse, and regularization, are discussed."
                },
                "soundness": {
                    "value": "4 excellent"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "3 good"
                },
                "strengths": {
                    "value": "The paper covers a lot of ground and generally presents its contents clearly and in a well-organized fashion. It gives an elegant and very intriguing perspective on loss landscapes through symmetry alone. It also unifies many different symmetries under the common language of $O$-symmetries, which looks to be a powerful mathematical perspective. The theory disentangles the effects of symmetries from weight decay and other regularization techniques on the loss landscape, which could enable new avenues of attack on controlling the minima that training converges to."
                },
                "weaknesses": {
                    "value": "My main concern is that the relevance of the work could be made explicit, as at first glance it seems to restate obvious results (such as that zeroed weights remain zero throughout training). In particular it would be nice to get a summary of how changes to weight decay, learning rate, and the amount of mirror symmetries affect empirical outcomes, such as more weight decay = more likely to fall into symmetry-induced stationary conditions.\n\nIn section 4.4, I don't believe this theory should take credit for the solution of adding random gradient noise, since it seems a trivial way to eliminate all stationary conditions regardless of whether they are caused by symmetry or not (the random bias method is more relevant). In general the connections in 4.4 require more work and empirical evidence in order to understand which are caused by symmetry and which are not. Overall, the main implications of this paper could be hammered out more strongly, while less central ideas like relating collapse to \"phase transitions\" and the DCS algorithm could be cut or left as a mention in the discussion.\n\nMinor problems:\n- Some details/notations could be explained more thoroughly, such as: define \"structured constraint\" when it is introduced, what is $R$ referring to in (3), same symbol $O$ is used for both mirror and order in (8), definition of $\\lambda$ versus $\\eta$ in (9).\n- The statement \"Notably, Entezari et al. (2021) empirically showed that neural networks under SGD\nlikely converge to the same type of solution if we take permutation symmetry into consideration\" isn't quite right, as Entezari conjectures this and follow-up work Ainsworth et al. shows something weaker (linear connectivity between pairs of solutions)."
                },
                "questions": {
                    "value": "Adding a fixed random bias to all parameters clearly prevents $O$-symmetries, but would there still be symmetries present? E.g. if two weights could previously be mirrored about a hyperplane through the origin, after adding the bias they can now be mirrored about a parallel hyperplane that is offset by the bias vector. How does this method eliminate the structured constraints such as in figure 3?"
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "8: accept, good paper"
                },
                "confidence": {
                    "value": "2: You are willing to defend your assessment, but it is quite likely that you did not understand the central parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                },
                "first_time_reviewer": {
                    "value": "Yes",
                    "readers": [
                        "ICLR.cc/2024/Conference/Program_Chairs",
                        "ICLR.cc/2024/Conference/Submission834/Senior_Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission834/Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission834/Reviewer_HdbE"
                    ]
                }
            },
            "number": 2,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission834/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698813467322,
            "cdate": 1698813467322,
            "tmdate": 1699636010933,
            "mdate": 1699636010933,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "1TmoEEYqYx",
                "forum": "zMR2dTNdft",
                "replyto": "tQoa2M661Q",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission834/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission834/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Reply"
                    },
                    "comment": {
                        "value": "Thanks for the detailed feedback and the encouraging review. We answer both the weaknesses and questions below.\n\n**1. My main concern is that the relevance of the work could be made explicit, as at first glance it seems to restate obvious results (such as that zeroed weights remain zero throughout training). In particular it would be nice to get a summary of how changes to weight decay, learning rate, and the amount of mirror symmetries affect empirical outcomes, such as more weight decay = more likely to fall into symmetry-induced stationary conditions.**\n\nThanks for this suggestion. We have updated the introduction to explicitly discuss the contributions early in the manuscript. We included more discussion of previous works in the introduction to clarify the motivation of our work from the beginning. In particular, prior to our work, symmetry has been studied in a case-by-case manner. Our work is the first to study symmetry through a unified framework. Second, previous works mostly take the perspective that symmetry creates saddle points and thus hinders training. In contrast, our current work considers how symmetry has a regularization effect and leads to structures and constraints of learning. We also include more detail when describing our contribution.\n\n**2. In section 4.4, I don't believe this theory should take credit for the solution of adding random gradient noise, since it seems a trivial way to eliminate all stationary conditions regardless of whether they are caused by symmetry or not (the random bias method is more relevant). In general the connections in 4.4 require more work and empirical evidence in order to understand which are caused by symmetry and which are not. **\n\nThanks for this comment. It is not our intention to take credit for adding random gradient noise to the training, as it has been used in deep learning practice and proposed by previous authors in various situations. In the context of the loss of plasticity problem, it has also been proposed by previous authors as a solution. We have added a reference and clarified this point in the revision.\n\nMinor problems: \n\n**1. Some details/notations could be explained more thoroughly, such as: define \"structured constraint\" when it is introduced, what is R referring to in (3), same symbol O  is used for both mirror and order in (8), definition of $\\lambda$ versus $\\eta$ in (9).**\n\nThanks for pointing out these problems. We have removed the inconsistent notations and clarified the meanings of these words and notations in the updated manuscript. (3): $R$ should be $\\Omega$. (8): We now avoid using $O$ to denote order. (9): $\\eta$ should be $\\lambda$.   \n\n\n**2. The statement \"Notably, Entezari et al. (2021) empirically showed that neural networks under SGD likely converge to the same type of solution if we take permutation symmetry into consideration\" isn't quite right, as Entezari conjectures this and follow-up work Ainsworth et al. shows something weaker (linear connectivity between pairs of solutions)**\n\nThanks for pointing this out. We intended to say that there exists various empirical evidence supporting the conjecture that SGD converges to the same type of solution if we take permutation symmetry into consideration. We have removed this part from the manuscript as it is not an essential discussion for us.\n\nQuestion:\n\n**1. Adding a fixed random bias to all parameters clearly prevents O-symmetries, but would there still be symmetries present? E.g. if two weights could previously be mirrored about a hyperplane through the origin, after adding the bias they can now be mirrored about a parallel hyperplane that is offset by the bias vector. How does this method eliminate the structured constraints such as in figure 3?**\n\nThis is a very good question. In short, it is usually not symmetries that lead to bad solutions but the fact that these symmetries tend to appear together with small-norm solutions that are low-capacity. This is especially true in the case of $O$-mirror symmetries, which pass through the origin. However, when the symmetry does not pass through the origin, the symmetric solutions often do not coincide with small-norm solutions (which are preferred when there is weight decay), and are thus more likely to be benign. To give an example, consider the problem $L=(uwx -y)^2$. Here, the symmetry solution is $u=w=0$, which is also low-capacity. When we add a bias, say $L=((u-0.1)(w-0.1)x -y)^2$,  the situation is different. The symmetric solution no longer coincides with a small-norm solution, and in this case, adding weight decay actually prevents convergence to the symmetric solution and is helpful for optimization. We have added this discussion to the manuscript."
                    }
                },
                "number": 5,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission834/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700459381911,
                "cdate": 1700459381911,
                "tmdate": 1700459390058,
                "mdate": 1700459390058,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "Sq0SZ0gWzF",
            "forum": "zMR2dTNdft",
            "replyto": "zMR2dTNdft",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission834/Reviewer_Z5Gq"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission834/Reviewer_Z5Gq"
            ],
            "content": {
                "summary": {
                    "value": "The paper considers a connection between the symmetries of the weights of a neural network and the constraints of the loss function. The authors proof that mirros symmetries lead to pre-defined certain behaviours of gradient-based model learning. For instance, rescaling symmetry of weights, leads to sparsity, rotation - to low-rankness and permutation leads to ensembling.\n\nWhile the paper presents 4 theorems with possibly useful application, the flow of the paper, the content, require a significant revision."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "1 poor"
                },
                "contribution": {
                    "value": "2 fair"
                },
                "strengths": {
                    "value": "- The authors present four theorems. Each theorem is well-written on its own, and the proofs are correct, with a clear and easy-to-follow flow.\n- The authors show that the paper has numerous connections to various fields in machine learning, which potentially opens up many possibilities for practical applications."
                },
                "weaknesses": {
                    "value": "The main weakness of the paper is that the text itself does not allow the reader to immediately position the contributions of the paper in the realm of machine learning. It is not clearly stated what alternatives to this approach exist.\n\n- The motivation of the paper is not clearly stated in the very beginning of the paper. The importance of the contribution becomes more and more clear only to the very end.\n- There is no \"Related work\" section. The way it is presented in Section 4 does not sound coherent and does not allow the reader to properly position the work.\n- The overall flow of the paper is not smooth. It jumps back and forth, there is no structure, there is no clear finale.\n- There is no clear section with experiments. Figure 1 demonstrates some results. However, the results seem more like an illustration rather than a solid experiment. It should be built as an experiment with its motivation, details, and explanation. And it should be in the main part of the paper.\n- Overall, the experiments do no convince."
                },
                "questions": {
                    "value": "- In Eq 11, you suggest a reparametrization where $\\theta$ is replaced with $u, v, w$. Does it mean that the total number of trainable parameters will increase by a factor of 3?\n- Can you elaborate on the dynamics with which the neural network is sparsified if a scaling symmetry exists? Do you have any estimates on how long it will take for a weight to become less than $\\epsilon \\ll 1$? I can imagine, that in practice, due to the stochastic nature of optimization, the mechanism will work differently."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "5: marginally below the acceptance threshold"
                },
                "confidence": {
                    "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 3,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission834/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698932746777,
            "cdate": 1698932746777,
            "tmdate": 1699636010875,
            "mdate": 1699636010875,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "bWsmmOInEE",
                "forum": "zMR2dTNdft",
                "replyto": "Sq0SZ0gWzF",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission834/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission834/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Reply part 1"
                    },
                    "comment": {
                        "value": "Thank you for the detailed feedback. We answer both the weaknesses and questions below. \n\nWeaknesses:\n\n**1. The motivation of the paper is not clearly stated in the very beginning of the paper. The importance of the contribution becomes more and more clear only to the very end.**\n\nWe have updated the introduction in great detail to clarify the contribution and related works from the beginning of the work. We have significantly revised the introduction to clarify the motivation and background of our work. In particular, prior to our work, symmetry has been studied case-by-case. Our work is the first to study symmetry through a unified framework. Second, previous works mostly take the perspective that symmetry creates saddle points and thus hinders training. In contrast, our current work considers how symmetry has a regularization effect and leads to structures and constraints of learning.\n\n**2. There is no \"Related work\" section. The way it is presented in Section 4 does not sound coherent and does not allow the reader to properly position the work.**\n\nAs we answered in weakness 1, we have updated the introduction to discuss the related works more extensively from the beginning. We also updated the main text overall to remove incoherent wording carefully. That being said, if you give more specific references regarding which part of the discussion in section 4 is not sufficiently coherent, we are happy to revise that part as well.\n\n**3. The overall flow of the paper is not smooth. It jumps back and forth, there is no structure, there is no clear finale.**\n\nThanks for this criticism. We have modified the last paragraph in the introduction to delineate the structure of the paper clearly. In short, our structure flows as follows: introduction -> three specific examples -> general theory -> implications. In terms of the finale, we have made some minor revisions to the conclusion to condense the points we want to make. If you think there is any specific aspect of the conclusion that would be improved, we are happy to hear and make further revision.\n\n**4. There is no clear section with experiments. Figure 1 demonstrates some results. However, the results seem more like an illustration rather than a solid experiment. It should be built as an experiment with its motivation, details, and explanation. And it should be in the main part of the paper.**\n\nThanks for the criticism. First of all, we would like to point out that the main contribution of our work is theoretical and conceptual, and these experiments are indeed intended to be illustrations of the theoretical results.\nSecondly, an illustrative experiment can be solid at the same time, and we believe that our experimental results are solid. Due to space constraints, the experimental details are all presented in Section A2 with great technical detail and explanation. What we have included in the main texts are results and summaries from these experimental analyses.\nThat being said, to improve the comprehensibility of these experimental results, we have included more references and explanations of the experiments in the main text. See the newly added Section 4.7 in the revision.\n\n**5. Overall, the experiments do no convince.** \n\nWith the added explanation and experimental details we added to answer point 4, we believe that the experiments are now convincing. If you think any specific point is unclear, please let us know so that we can provide more detail."
                    }
                },
                "number": 3,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission834/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700459062257,
                "cdate": 1700459062257,
                "tmdate": 1700459062257,
                "mdate": 1700459062257,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "tYQDTcAcgl",
                "forum": "zMR2dTNdft",
                "replyto": "Sq0SZ0gWzF",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission834/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission834/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Reply part 2"
                    },
                    "comment": {
                        "value": "Questions: \n\n**1. In Eq 11, you suggest a reparametrization where $\\theta$  is replaced with $u, w, v$. Does it mean that the total number of trainable parameters will increase by a factor of 3?**\n\nYes, but not necessarily. The factor of 3 is an upper bound, which is only required when one wants a complicated constraint. In more common situations, one can greatly reduce the number of parameters required. For example, one only needs to add a single parameter to introduce a rescaling symmetry, which equivalently adds a simple sparsity constraint to one parameter. To introduce simple sparsity constraints to all the parameters, one only needs to double the amount of the parameters. Another good example is group sparsity, where one only needs to add one single parameter for each group. Normally, the number of sparse groups is equal to the number of input features (such as in a feature selection problem), and so the number of additional parameters (of the order of hundreds or thousands) is far less than the total number of parameters (of the order of a million and above).\n\nAlso, we would like to comment that multiplying the training parameters by a factor of 2 or three is usually not too much of a problem for modern GPU-based training. This is because when the training proceeds with minibatch training, the predominant cost of memory and computation comes from the dynamic cost of computation over the minibatch, not from the static cost of increasing the number of parameters by a factor of two or three. See the newly added experiment in Section A4.\n\n\n**2. Can you elaborate on the dynamics with which the neural network is sparsified if a scaling symmetry exists? Do you have any estimates on how long it will take for a weight to become less than $\\epsilon \\ll 1$? I can imagine, that in practice, due to the stochastic nature of optimization, the mechanism will work differently.**\n\nThis is in fact a good and important open question. One can obtain a rough estimate in simplest scenarios when training proceeds with gradient flow (GF). Consider optimizing a problem $L =(uvx -y)^2$ with GF -- this problem can be exactly solved, and the learning time scale can be found to be $1 / \\eta x y$, where $\\eta$ is the learning rate, and $xy$ can be identified with the strength of the signal in the training data. Therefore, the training loss decreases by one order after $1 / \\eta x y$. This can be compared with the case when there is no rescaling symmetry: $L=(ux-y)^2$, where the relaxation time scale is $1/\\eta x^2$. The two time scales are different, but neither is categorically better than the other. Roughly speaking, one would expect that learning with symmetry will not be significantly slower than without symmetry. \n\nWe also performed an experiment to compare the learning dynamics of a vanilla ResNet18 and ResNet18 with the rescaling symmetry. The experiment shows that there is no significant difference between the final performance and the training time between the two, while the ResNet18 with the rescaling symmetry is sparse overall. See the newly added Section A4."
                    }
                },
                "number": 4,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission834/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700459124464,
                "cdate": 1700459124464,
                "tmdate": 1700459124464,
                "mdate": 1700459124464,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "8QVXOWXAuP",
            "forum": "zMR2dTNdft",
            "replyto": "zMR2dTNdft",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission834/Reviewer_tSGN"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission834/Reviewer_tSGN"
            ],
            "content": {
                "summary": {
                    "value": "The paper presents a framework that analyze the local and global geometry of neural network with L2 regularization, using the loss symmetries, without any knowledge about the underlying network's architecture. The paper deals with 4 types of symmetries (rescaling, rotation, permutation and mirroring) and describes how each symmetry affects the geometry of the loss landscape with respect to the regularization coefficient. The paper uses the framework to analyze 5 different real world phenomenons and implement one algorithm."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "3 good"
                },
                "strengths": {
                    "value": "The paper presents a novel approach to understand how symmetries in the loss function of a neural network regardless of their underlying architecture. It enumerates multiple real world application to justify the technique's importance."
                },
                "weaknesses": {
                    "value": "The paper is hard to read and has some mathematical inaccuracies, I'll enumerate some of problems I encountered:\n\n(1) The proof of theorem 4: there is a recurring typo writing ker(O) instead of ker(O^T) and the RHS of eq. 52 should be multiplied by -1 for the proof to hold\n\n(2) Assumptions 1 and 2 are given without any explanation. It isn't self-evident that these are reasonable assumptions for real-world scenarios.\n\n(3) Chapter 2.2 uses both big omega and R as rotation matrices, but R wasn't declared. In addition, item 1 in theorem 2 doesn't says for which gammas the theorem holds (I assume from the context it is for every gamma).\n\n(4) In the line below equation 9, eta is used for learning rate, but it looks like gamma instead in subsequent paragraphs."
                },
                "questions": {
                    "value": "No questions."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "6: marginally above the acceptance threshold"
                },
                "confidence": {
                    "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
                },
                "code_of_conduct": {
                    "value": "Yes"
                },
                "first_time_reviewer": {
                    "readers": [
                        "ICLR.cc/2024/Conference/Program_Chairs",
                        "ICLR.cc/2024/Conference/Submission834/Senior_Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission834/Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission834/Reviewer_tSGN"
                    ]
                }
            },
            "number": 5,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission834/-/Official_Review"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1700733671902,
            "cdate": 1700733671902,
            "tmdate": 1700824211389,
            "mdate": 1700824211389,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "g8rmWAnyi2",
                "forum": "zMR2dTNdft",
                "replyto": "8QVXOWXAuP",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission834/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission834/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Author reply"
                    },
                    "comment": {
                        "value": "Thanks for the criticism. While this criticism is posted less than 2 hours before the rebuttal period ends, we do our best to make a revision and rebuttal. In summary, there is no mistake in the proof, and the assumptions we made are well-justified. We feel that the criticisms are perhaps due to misunderstanding and are only targeted at minor problems.\n\n**The paper is hard to read and has some mathematical inaccuracies**\n\nThanks for the criticism. We have updated the manuscript to improve accuracy. We have also significantly updated the introduction to clarify our motivation and contribution from the beginning. In addition, if you could be more specific about why the paper is hard to read, we can revise that part accordingly.\n\n**(1) The proof of theorem 4: there is a recurring typo writing ker(O) instead of ker(O^T)**\n\nThanks for pointing out. The typo has been fixed. \n\n**The RHS of eq. 52 should be multiplied by -1 for the proof to hold**\n\nWe believe this is a misunderstanding of the proof. The RHS of Eq. (52) does not need to be multiplied by -1 for the proof to hold.  We have rewritten the proof of this part to improve its notational clarity and give all the details after Eq. (52) to clarify the steps.\n\n**(2) Assumptions 1 and 2 are given without any explanation. It isn't self-evident that these are reasonable assumptions for real-world scenarios.**\n\nFirst of all, we do give explanations of these assumptions in the immediate context.\n\nLet us focus on assumption 1, as it relates to our main contribution. Essentially, assumption 1 assumes that the Hessian of the loss function is lower bounded. This is a minimal smoothness assumption and not a strong assumption at all. It is satisfied by, for example, any convex function. The meaning is also quite clear. Having a negative eigenvalue in the Hessian means that the loss can be locally concave, and its magnitude can be regarded as a measure of \"local concavity\" -- in this language, the assumption basically assumes that the local concavity does not diverge -- which is a very weak condition.\n\nMathematically, this is also not a problem because this assumption can be easily replaced by requiring the loss function to have a bounded domain. This is because any $C_2$ function on a closed and bounded domain must have a bounded Hessian, which implies that its eigenvalues are also bounded. Assuming that the parameters are constrained in a compact set is certainly benign, as well-trained large neural networks tend to stay close to their initialization. \n\nThe fact that this assumption is benign is also supported by empirical evidence. Any existing work that empirically computes the Hessian spectrum has only found very small negative eigenvalues in the Hessian (not to mention a diverging negative Hessian eigenvalue). For a classical example, see https://arxiv.org/abs/1706.04454. Alternatively, within the regime of NTK, the loss function is essentially convex. In summary, for almost all practical concerns, assumption 1 is benign and should leads to no problem.\n\nNow, let us take a step back. Even if assumption 1 is problematic, it only affects item 4 of Theorem 4, which is the least important of our result. In fact, none of our major discussion really relies on item 4 of Theorem 4. We find it difficult to understand why this criticism justifies a soundness score of 1 and/or rejection.\n\nFor assumption 2, we point out that assumption 2 only appears in the appendix, is not central to our main result, and only serves the purpose of discussing the relationship of our result with previous results. That being said, it rationale is well-explained in the context where it appears. See the discussion above and below Assumption 2.\n\n**(3) Chapter 2.2 uses both big omega and R as rotation matrices, but R wasn't declared.** \n\nHere, $\\Omega$ is used for the rotation symmetry. $R$ is used for the double rotation symmetry. Also, we point out that $R$ is defined exactly in the sentence where it is introduced, which we quote here: \"A more common symmetry is a ``double\" rotation symmetry, where $\\ell_0$ depends on two matrices $U$ and $W$ and satisfies $\\ell_0(U, W) = \\ell_0(UR, R^TW)$, for any orthogonal matrix $R$ and any $U$ and $W$.\"\n\n**In addition, item 1 in theorem 2 doesn't says for which gammas the theorem holds (I assume from the context it is for every gamma).**\n\nThis is true. Item 1 holds for any $\\gamma$ (even for negative $\\gamma$), and so there is no need to state this.\n\n\n**(4) In the line below equation 9, eta is used for learning rate, but it looks like gamma instead in subsequent paragraphs.**\n\nThanks for pointing this out. We have fixed this typo."
                    }
                },
                "number": 11,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission834/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700739070467,
                "cdate": 1700739070467,
                "tmdate": 1700739305273,
                "mdate": 1700739305273,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    }
]