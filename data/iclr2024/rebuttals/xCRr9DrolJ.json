[
    {
        "title": "Score Regularized Policy Optimization through Diffusion Behavior"
    },
    {
        "review": {
            "id": "7832Yekkn7",
            "forum": "xCRr9DrolJ",
            "replyto": "xCRr9DrolJ",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission6831/Reviewer_f3qQ"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission6831/Reviewer_f3qQ"
            ],
            "content": {
                "summary": {
                    "value": "This paper aims to improve the inference efficiency of diffusion models in the context of offline reinforcement learning, by proposing a deterministic inference policy from critic models and pretrained diffusion behavior models. The pretrained diffusion behavior models are then utilized to regularize the policy gradient. Experiments are conducted on D4RL in locomotion tasks, the speed is improved without an evident performance drop."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "2 fair"
                },
                "contribution": {
                    "value": "3 good"
                },
                "strengths": {
                    "value": "- The research problem of improving inference efficiency for diffusion models in offline reinforcement learning is interesting and worth investigating.\n\n- The paper is well organized and written in general, with motivations and methods well explained (but somewhat unclear to me).\n\n- The experiments show evident improvement in time cost and demonstrate the effectiveness."
                },
                "weaknesses": {
                    "value": "- Some implementation details are unclear, while the Fig.1 shows the comparison of the inference efficiency, the actual time cost for training is not mentioned. (In Appendix C, it seems the actual time used for training is not specified?)\n\n- I get a bit confused by some high-level assumptions in this work. Essentially, I believe there are two types of distributions that matter in the context of Diffusion models for offline RL, namely the actual data distribution and the learnable Gaussian kernel (noise) distribution (which is pre-scheduled on the mean values with fixed variance). If the actual learnable $\\pi_\\theta$ is used as the appropriation/predictor of the policy distribution (which I believe is the case according to Eq. 9?), then what is the difference between this proposed paradigm and the Gaussian case, while the latter is believed to be lacking in expressivity, as mentioned by the authors in the intro and Fig.2, however the $\\pi_\\theta$ that you are sampling from is also a Gaussian with known variance and learnable mean value.\n\n- Following my previous point, which I think is also related to the choice of $t$ in Sec. 4.2 and also in Eq. 9. If I misunderstood the actual usage of distribution here, and the proposed SRPO method actually uses the actual distribution, which corresponds to $x_0$ (or somewhere close to $x_0$), as the optimal policy that you are trying to sample from, then the expressivity concern does not exist, but then in this case, the entropy term in Eq. 9 does not hold, because we don\u2019t have any prior on the actual distribution of $x_0$ also on its variance?"
                },
                "questions": {
                    "value": "Please see the weaknesses for details. Overall, I think I get confused by the distributions from the DMs and the actual deployment in the context of RL in this work, as well as the rationale/motivation behind it."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "6: marginally above the acceptance threshold"
                },
                "confidence": {
                    "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                },
                "first_time_reviewer": {
                    "value": "Yes",
                    "readers": [
                        "ICLR.cc/2024/Conference/Program_Chairs",
                        "ICLR.cc/2024/Conference/Submission6831/Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission6831/Reviewer_f3qQ",
                        "ICLR.cc/2024/Conference/Submission6831/Senior_Area_Chairs"
                    ]
                }
            },
            "number": 1,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission6831/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1697737090891,
            "cdate": 1697737090891,
            "tmdate": 1700317812912,
            "mdate": 1700317812912,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "x4R6YgFzkH",
                "forum": "xCRr9DrolJ",
                "replyto": "7832Yekkn7",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6831/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6831/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Official Response to Reviewer f3qQ (1/2)"
                    },
                    "comment": {
                        "value": "We sincerely thank reviewer f3qQ for his interest and detailed feedback on our work. His valuable feedback has significantly contributed to enhancing the clarity and overall presentation of our paper. **We have updated the manuscript with more experimental illustrations and improved presentations** (particularly in section 3).\n\n**Q1: The actual time cost for training is not mentioned (in Appendix C).**\n\n**A1:** The actual time cost for training was actually provided in Section 6.2 of the paper (Figure 7), where we compared training and evaluation time between our work and several baselines in detail. We present Figure 7 in tabular form below:\n\n| Algorithm    | Training Time (h)  | Evaluation Time (h) | Total Time (h)  | Evaluation/Total (\\%)  |\n|--------------|:-----------------:|:-------------------:|:-------------------:|:-----------------:|\n| IQL          | 4.36            | 0.40               | 4.76                 | 8.4            |\n| DiffusionQL  | 14.3            | 8.66               | 22.96                 | 37.7            |\n| IDQL         | 6.57            | 16.9               | 23.47                |  72.0            |\n| SRPO(Ours)   | 9.32            | 0.38               | 9.7                |  3.9            |\n\n(Suppose each experiment requires 2,000K gradient steps for training, 50(times)*20(seeds) episodes of evaluation, test on Nvidia A40 GPUs)\n\n\n**Q2: Overall, I think I get confused by the distributions from the DMs and the actual deployment in the context of RL in this work**\n\n**A2:** We appreciate the opportunity to clarify the confusion, primarily regarding the definitions of $\\pi_\\theta(s)$ and $\\pi_{\\theta, t}(\\cdot|s)$. **We have updated the manuscript, adding Figure 5 and Figure 10 to help better illustrate our idea.** Below is a summarization of the main distributions from the Diffusion Models:\n\n\n|   Diffusion time  |  &emsp;     $t=0$                       |       | &emsp;&emsp;&emsp;&emsp; $t \\in (0,1)$  |\n|:--------:|:---------:|:-----:|:-----:|\n|                       |           |         diffusion (add noise)       |               |\n| behavior data:  |  $ \\mu(a\\|s)   $ | ----------------------------------> | $\\mu_t(a_t\\|s)$ | \n|                       |           |                |          \u2193     |               | \n|  *diffusion''modeling*    |           |               |         supervise(Eq.13)      |   \n|                       |           |                |         \u2193      |               | \n|behavior model:  |  $ \\epsilon_\\psi(a\\|s)   $ |  | $\\epsilon_\\psi(a_t\\|s,t)$ |\n|                       |\u2193  |         <--------------  +$Q_\\phi(s,a)$  **-------------->**   |        **\u2193**      |               | \n|  *score''regularization*    |        supervise(Eq.10)   |               |         **supervise(Eq.15)**      |   \n|                       |         \u2193  |                |         \u2193      |               | \n| policy model:  |  $ \\pi_\\theta(s)   $ | **------------(define by diffusion)---------->** | **$\\pi_{\\theta, t}(\\cdot\\|s) $:=$\\mathcal{N}(\\cdot\\|\\alpha\\_t \\pi_\\theta(s),\\sigma_t^2 I ) $** |\n|                       |           |      **<---------------(supervise)---------------**           |               |               | \n\n\n(The method proposed in Section 4.2 of the paper is highlighted in **boldface**.)\n\n- $\\mu(a|s)$: The underlying behavior policy for behavior dataset $D^{\\mu}$.\n- $\\mu_t(a|s)$: The noisy version of $\\mu(a|s)$, defined by the forward diffusion process (Eq.4 in paper).\n- $\\epsilon\\_\\psi(a\\_t|s,t)$: The diffusion behavior model learned to represent $\\nabla_a \\log \\mu\\_t(a|s)$ for a series of $t\\in(0,1)$. We need $\\epsilon\\_\\psi$ to regularize gradient when optimizing policy $\\pi\\_\\theta$. \n- $\\pi_\\theta(s)$: A deterministic policy which is actually **used for evaluation**.\n- $\\pi\\_{\\theta, t}(\\cdot|s)$: The noisy (diffused) version of $\\pi\\_\\theta(s)$. **Note that** $\\pi\\_{\\theta, t}(\\cdot|s)$ **is defined by** $\\pi\\_\\theta(s)$. Its mean is $\\alpha\\_t \\pi\\_\\theta(s)$. It has fixed variance. As a result, **when we optimize $\\pi\\_{\\theta, t}(\\cdot|s)$, we are essentially optimizing the underlying evaluation policy $\\pi\\_\\theta(s)$.** $\\pi\\_{\\theta, t}(\\cdot|s)$ is **not** used for evaluation.\n\n\n**Why optimize $\\pi\\_{\\theta, t}(\\cdot|s)$ as in Eq.15? Why not just directly optimize $\\pi\\_\\theta(s)$ as in Eq.10?** (since we do not actually use $\\pi\\_{\\theta, t}(\\cdot|s)$)\n\n1. Our goal is to leverage the pretrained diffusion model $\\epsilon_\\psi(a_t|s,t)$ at every $t \\in (0,1)$, not just at $t=0$ (Eq. 15). Proposition 1 in our paper (proof in Appendix B) demonstrates the equivalence between minimizing $KL(\\pi_\\theta(s) || \\mu(a|s))$ and minimizing $KL(\\pi_{\\theta, t}(\\cdot|s) || \\mu_t(a|s))$.\n2. When $t$ is always 0, Eq.15 and Eq.10 become identical, making Eq.10 a special case of Eq.15.\n3. Utilizing pretrained diffusion models across all $t \\in (0,1)$ empirically improves performance. See Section 6.3 for ablations, and see Figure 5,10 for illustrations."
                    }
                },
                "number": 3,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6831/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700139021946,
                "cdate": 1700139021946,
                "tmdate": 1700140169745,
                "mdate": 1700140169745,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "Rb33VbFEEQ",
                "forum": "xCRr9DrolJ",
                "replyto": "7832Yekkn7",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6831/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6831/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Official Response to Reviewer f3qQ (2/2)"
                    },
                    "comment": {
                        "value": "**Q3: The final policy that you are sampling from is also a Gaussian, which is believed to be lacking in expressivity.  So what is the point of introducing diffusion models?**\n\n**A3:** \nWhile the diffusion **behavior** model $\\mu_\\psi(a|s)$, does **not** enhance the expressivity of the final evaluation policy $\\pi\\_\\theta$, they better represent the behavior distribution $\\mu(a|s)$. This **leads to more accurate behavior regularization and, consequently, better learning of $$\\pi_\\theta$**.**\n\n\nEmpirically, our method significantly outperforms traditional behavior regularization methods like BCQ, BEAR, and BRAC in the D4RL benchmarks, as shown in Table 1 of the paper. These methods use VAE models for behavior modeling, which we believe cannot fully capture complex behavior policies.\n\n**We've also conducted additional qualitative experiments in 2D settings to support our claims**, comparing our method with previous ones and assessing the generative modeling capabilities of VAEs versus Diffusion. The results are included in the newly added Figures 4 and 9 of the paper.\n\n\n**Q4:The rationale/motivation behind our work. (high-level assumptions?)**\n\n**A4:** Our method aims to effectively and efficiently capture the \"mode\" of $\\pi^*$, focusing on training a deterministic or Gaussian policy $\\pi^{\\text{gauss}}\\_{\\theta} (s) = \\arg \\max\\_a \\mu(a|s) \\ e^{\\beta Q(s, a)} $ **instead of a diverse one** $\\pi_\\theta^{\\text{diff}}(a|s) \\propto \\mu(a|s) \\ e^{\\beta Q(s, a)}$.\n\n\nIf there are two (multiple) optimal policies for one single task, our method will simply choose either one of them deterministically. Our assumption is that in many scenarios, inference speed is of much higher priority than policy diversity. For instance, in robotics, we often do not care about how many ways our robot can solve a task. Contrastively, we do care about whether our policy is optimal and efficient (we need high control frequency!). Also, current evaluation metrics of the D4RL benchmark only emphasize policy optimality and ignore policy diversity.\n\n**Q5: If I misunderstood the actual usage of distribution here, ... in this case, the entropy term in Eq. 9 does not hold.**\n\n**A5:** As clarified in **A4**, our evaluation policy is either deterministic or Gaussian, so the reviewer's understanding of its usage is correct. Therefore, the entropy term in Eq. 9 remains valid."
                    }
                },
                "number": 4,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6831/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700139918158,
                "cdate": 1700139918158,
                "tmdate": 1700145628462,
                "mdate": 1700145628462,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "iaQzXefuK9",
                "forum": "xCRr9DrolJ",
                "replyto": "Rb33VbFEEQ",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6831/Reviewer_f3qQ"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6831/Reviewer_f3qQ"
                ],
                "content": {
                    "title": {
                        "value": "Thanks for the rebuttal"
                    },
                    "comment": {
                        "value": "I appreciate the authors' efforts in rebuttal. I think the diffusion modeling part seems clearer to me after reading the responses, and I am open to leaving the other reviewers to assess the RL part."
                    }
                },
                "number": 11,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6831/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700317785721,
                "cdate": 1700317785721,
                "tmdate": 1700317785721,
                "mdate": 1700317785721,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "384fAwl08y",
            "forum": "xCRr9DrolJ",
            "replyto": "xCRr9DrolJ",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission6831/Reviewer_cVKT"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission6831/Reviewer_cVKT"
            ],
            "content": {
                "summary": {
                    "value": "The paper addresses the slow inference issue of diffusion policies and proposes an offline RL algorithm to avoid iterative diffusion sampling process during policy evaluation by leveraging a critic model and a pretrained diffusion model. \nThe proposed method, SRPO, consists of three components: a critic model realized by the IQL, a pretrained diffusion model to explicitly model the behavior policy, and a policy extraction module utilizing the pretrained behavior model to regularize the policy gradient.\nExperimental results on D4RL benchmark suggest the proposed method can achieve higher computational efficiency especially during inference compared to other diffusion-based policies, while maintaining comparable performance by exploiting the modeling expressiveness of diffusion models.\nThe main contribution of this paper is to employ a pretrained diffusion behavior model, which can approximate the score function of the behavior distribution in offline datasets, to regularize the policy gradient during the optimization of the actor."
                },
                "soundness": {
                    "value": "2 fair"
                },
                "presentation": {
                    "value": "4 excellent"
                },
                "contribution": {
                    "value": "3 good"
                },
                "strengths": {
                    "value": "1. The paper clearly states its motivation and presents a clear illustration to demonstrate the derivation of the proposed method, SRPO.\n2. The paper provides reproducible details for its experiments, and make a relatively comprehensive comparison with both conventional behavior regularization methods and recent diffusion-based policies in offline RL, in terms of task performance and computational efficiency."
                },
                "weaknesses": {
                    "value": "1. The paper mainly aims to improve the computational efficiency of diffusion-based polices, which is highlighted in computation-sensitive contexts such as robotics as stated in the paper, yet there is no experiment concerning the robot scenarios especially with real data. If such experimental results are provided, the central claim made by the paper can be more convincing.\n2. The novelty of the proposed method is limited as it seems to be a combination of previous work, and especially an incremental work based on IDQL (Hansen-Estruch et al., 2023), though it has been compared in the experiments. The main difference between the two work is the policy extraction process, which is the main contribution of this paper but does not provide adequate contribution to the community."
                },
                "questions": {
                    "value": "1. In Table 1, where do the results of baselines come from? Are they reported from original papers or all have been re-implemented for comparison\uff1f\n2. In section 6.2, the paper claims that SRPO \"completely avoids diffusion sampling throughout both training and evaluation procedures\". But it is considered that the pretrained diffusion model for behavior policy still requires iterative sampling during the pretraining phase, which is also visualized in Fig 5 when compared to IDQL. This claim needs further explanation.\n3. In Fig 5, are the results averaged across all locomotion tasks?"
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "8: accept, good paper"
                },
                "confidence": {
                    "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                },
                "first_time_reviewer": {
                    "readers": [
                        "ICLR.cc/2024/Conference/Program_Chairs",
                        "ICLR.cc/2024/Conference/Submission6831/Senior_Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission6831/Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission6831/Reviewer_cVKT"
                    ]
                }
            },
            "number": 2,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission6831/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698156485791,
            "cdate": 1698156485791,
            "tmdate": 1700620848372,
            "mdate": 1700620848372,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "tMpuxaN4Ef",
                "forum": "xCRr9DrolJ",
                "replyto": "384fAwl08y",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6831/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6831/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Official Response to Reviewer cVKT (1/2)"
                    },
                    "comment": {
                        "value": "We thank the reviewer for his valuable feedback. We seek to address the reviewer's concern by expanding experimental evaluations and clarifying the contributions of our paper.\n\n\n\n\n**Q1: The novelty of the proposed method is limited as it seems to be a combination of previous work, and especially an incremental work based on IDQL.**\n\n**A1** We respectfully disagree with this assessment for several reasons:\n\n1. **Our method is not a combination of previous works.** We propose score regularization, which leverages a pretrained diffusion model to **regularize optimization gradients instead of loss** during policy training. To the best of our knowledge, this is a novel and unique optimization strategy. Prior to our work, diffusion models in RL were limited to direct action sampling in an iterative and time-intensive manner. Our approach marks a significant departure from this.\n2. **Our proposed score-regularization method is a general policy-optimization method instead of being incremental to IDQL.** While we have followed the framework of IDQL and SfBC for behavior modeling and IQL (or IDQL) for critic training to aid comparison and understanding, our score-regularization method is a broadly applicable policy optimization technique, not merely an extension of IDQL. Plus, the training of critics and behavior models is not claimed as a contribution in our paper.\n3. **We have conducted additional experiments combining our method with other diffusion-RL methods (diffusers and SfBC) to showcase its versatility.** We maintained the original critic training pipelines for diffusers and SfBC and the behavior training pipeline for SfBC, then derived a new inference policy using our method. Experimental results are shown below. We test all tasks in 3 random seeds using a single shared behavior model due to a severe time limit. We will update the complete results in the paper before camera-ready submission.\n\n\n| Environment      | SfBC  | **SfBC+SRPO** (new)| Diffuser | **Diffuser+SRPO** (new) | IDQL  | **IDQL+SRPO**(original paper) |\n|------------------|-------|-----------|----------|---------------|-------|-----------|\n| HalfCheetah-ME   | 92.6  | 93.3      | 79.8     | 92.1          | 95.9  | 92.2      |\n| Hopper-ME        | 108.6 | 95.7      | 107.2    | 91.2          | 108.6 | 100.1     |\n| Walker2d-ME      | 109.8 | 110.3     | 108.4    | 112.8         | 112.7 | 114.0     |\n| HalfCheetah-M    | 45.9  | 60.9      | 44.2     | 58.0          | 51.0  | 60.4      |\n| Hopper-M         | 57.1  | 89.3      | 58.5     | 57.6          | 65.4  | 95.5      |\n| Walker2d-M       | 77.9  | 83.3      | 79.7     | 75.4          | 82.5  | 84.4      |\n| HalfCheetah-MR   | 37.1  | 46.4      | 42.2     | 45.9          | 45.9  | 51.4      |\n| Hopper-MR        | 86.2  | 100.0     | 101.3    | 93.7          | 92.1  | 101.2     |\n| Walker2d-MR      | 65.1  | 80.3      | 61.2     | 82.9          | 85.1  | 84.6      |\n| **Average**          | 75.6  | 84.4      | 75.3     | 78.8          | 82.1  | 87.1      |\n| **Inference time**          | 315.0  | 1.0      | 1669.0     | 1.0          | 47.5  | 1.0      |\n\n\n**Q2: The policy extraction process ... does not provide an adequate contribution to the community.**\n\n**A2** We would like to share some of the observations that drive us to study computational efficiency in diffusion-based RL.\n\n1. When replicating experiments in IDQL, we find that policy evaluation takes 8 hours if we evaluate 50*10 episodes in total in an experiment, while policy training only takes 6 hours.\n  \n2. Numerous diffusion-RL works [3,4,5,6,7] describe acceleration techniques in their paper such as parallel computing to accelerate training (details in section 5.2 of the paper).\n\n3. Recently, a series of methods have been proposed, similarly aiming to solve the computational efficiency problem in diffusion-based RL. For example, [7] proposes an approximate sampling approach. [8,9] use consistency models to replace diffusion models.\n\nTo conclude, we think **computational efficiency, especially action sampling speed which we increase by more than 25x times, is a big concern for diffusion-based RL community.**\n\n\n[3] Planning with diffusion for flexible behavior synthesis (ICML 2022)\n\n[4] Offline reinforcement learning via high-fidelity generative behavior modeling  (ICLR 2023)\n\n[5] Contrastive energy prediction for exact energy-guided diffusion sampling in offline reinforcement learning. (ICML 2023)\n\n[6] Diffusion policies as an expressive policy class for offline reinforcement learning. (ICLR 2023)\n\n[7] Efficient diffusion policies for offline reinforcement learning (NeurIPS 2023)\n\n[8] Consistency Models as a Rich and Efficient Policy Class for Reinforcement Learning (https://arxiv.org/abs/2309.16984)\n\n[9] Boosting Continuous Control with Consistency Policy (https://arxiv.org/abs/2310.06343)"
                    }
                },
                "number": 6,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6831/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700142845909,
                "cdate": 1700142845909,
                "tmdate": 1700145406301,
                "mdate": 1700145406301,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "GIgcntIeYC",
                "forum": "xCRr9DrolJ",
                "replyto": "384fAwl08y",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6831/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6831/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Official Response to Reviewer cVKT (2/2)"
                    },
                    "comment": {
                        "value": "**Q3: There is no experiment concerning the robot scenarios especially with real data (to demonstrate the computational efficiency of the algorithm).**\n\n**A3:** (To avoid possible confusion, the D4RL tasks in our paper are basically all simulation-based tasks concerning the robotics scenarios. We hypothesize that the reviewer actually means experiments on real robots and real data instead of simulation data.)\n\nWe definitely agree with the reviewer that experimental results on real robots could provide valuable insights. \nHowever, we currently lack the necessary hardware setups and expertise to conduct such experiments. \nDespite this limitation, we believe our evaluation remains robust for several reasons:\n\n1. Among all the 10+ baselines we compare with, **only a single baseline method (Decision Diffuser[1]) has conducted experiments on real robots.** \n2. In this paper, we focus on the theoretical derivation and benefits of the SRPO algorithm because it is theoretically novel. **Applying SRPO in real-world robotic hardware involves extensive engineering practices that are mostly orthogonal to the core focus of our original article.** These practices include hardware setup, data collection, and bridging the sim2real gap. Addressing these aspects **might divert the attention from the theoretical contributions of our paper**, which we aim to emphasize.\n3. The primary aim of our work is to address the computational efficiency challenges in diffusion-RL methods. **This contribution is significant on its own, even without the deployment in real-world robotics.** One of the notable advantages is the reduction in evaluation time, which, in previous works like IDQL, constituted up to 50 $\\%$ of the training time. This efficiency is also crucial for integrating diffusion models in online RL, where using a diffusion policy during the data collection phase is currently impractical due to time constraints[2].\n4. Compared with other diffusion RL methods, **the benefit of fast inference speed is inherent to our algorithm design, regardless of whether our method is deployed in real-world robots.**\n\nOverall, while we recognize the value of real-world experiments, we sincerely hope that the reviewer can understand our dilemma here and finds it acceptable that we demonstrate effectiveness and efficiency only in simulation-based tasks. We believe this does not harm the key contribution of our method.\n\n\n[1] Is conditional generative modeling all you need for decision making? (ICLR 2023)\n\n\n[2] Policy Representation via Diffusion Probability Model for Reinforcement Learning (https://arxiv.org/pdf/2305.13122.pdf)\n\n\n\n**Q4: In Table 1, where do the results of baselines come from?**\n\n**A4** They all come from the original paper except for BEAR, which we refer to D4RL benchmark's white paper due to unavailability in the original paper.\n\n\n**Q5: It is considered that the pretrained diffusion model for behavior policy still requires iterative sampling during the pretraining phase which is visualized in Fig 5 when compared to IDQL.**\n\n**A5:** Neither IDQL nor our method requires iterative sampling during the pretraining phase. \n\nReference code for IDQL:  https://github.com/philippe-eecs/IDQL/blob/6b071e7a1eea57bd93956f2b0a9e07a68081a096/jaxrl5/agents/ddpm_iql/ddpm_iql_learner.py#L426\n\nThe pipeline (simplified) is \n\n1. Sample $s, a_0$ from dataset, $t$ from $(0,1)$, Gaussian noise $\\epsilon$\n\n2. Add noise to $a\\_0$ based on $t$ and $\\epsilon$ to form $a\\_t$\n\n3. Optimize MSE loss between $\\epsilon$ and $\\epsilon\\_\\theta(a\\_t)$\n\n**Q6: In Fig 5, are the results averaged across all locomotion tasks?**\n\n**A6** Yes, they are. \n\nNote that for hopper and walker2d environments, the episode may terminate in less than 1000 steps during evaluation (e.g., the robot falls to the ground). This causes too much randomness for evaluation, so we manually normalize the evaluation time hypothesizing that all episodes have a length of 1000."
                    }
                },
                "number": 7,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6831/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700142943907,
                "cdate": 1700142943907,
                "tmdate": 1700143015871,
                "mdate": 1700143015871,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "D1m0mS0sMd",
                "forum": "xCRr9DrolJ",
                "replyto": "tMpuxaN4Ef",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6831/Reviewer_cVKT"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6831/Reviewer_cVKT"
                ],
                "content": {
                    "comment": {
                        "value": "I acknowledge the answers provided by the authors to clarify some of my confusions. The main contribution of this paper, I think, is to derive a novel policy optimization objective from a behavior policy modeled via a pretrained diffusion model, and the objective is designed to increase the inference speed of diffusion-based polices. This is a critical issue in diffusion-based policies, and the paper has already mentioned and compared some work with similar motivation. One question is that why the work [7] mentioned in Section 5.2 is not compared in the experiments? Are there some particular reasons for the choice of baselines?"
                    }
                },
                "number": 9,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6831/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700208249475,
                "cdate": 1700208249475,
                "tmdate": 1700208249475,
                "mdate": 1700208249475,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "AKz6aDBqgl",
                "forum": "xCRr9DrolJ",
                "replyto": "384fAwl08y",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6831/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6831/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Thank you for your engagement! Response to further questions."
                    },
                    "comment": {
                        "value": "We are glad to see we can clarify some confusion of the reviewer and that the contribution of our paper is acknowledged. \n\n**If we have resolved the reviewer's concern, we sincerely hope that the reviewer could consider raising the score (or increasing confidence).**\n\n**Q7: Why is work [7] not compared with?**\n\n**A7:** Work [7] is a very interesting work also studying the computational efficiency of diffusion RL. However, it was not included in our comparisons due to specific reasons:\n\n1. Work [7] mainly aims to improve computational efficiency during the **training phase**, with basically no improvement in evaluation speed (Our method mainly increases evaluation speed).   As quoted in Section 5.1 of [7]: *EDP\nw/o DPM and DQL (JAX) are on par with each other regarding sampling speed*.  The official code, linked below, demonstrates that the proposed acceleration techniques are not utilized during evaluation. Consequently, EDP's inference speed matches that of D-QL, which we have already compared in Figure 1, achieving a 25-fold speed increase.\n\nhttps://github.com/sail-sg/edp/blob/b019648e3db9f8d035d3bf0897a8643bc5ab2369/diffusion/trainer.py#L349\n\nhttps://github.com/sail-sg/edp/blob/b019648e3db9f8d035d3bf0897a8643bc5ab2369/diffusion/trainer.py#L100\n\n2. Regarding the performance metrics in Table 1, Work [7] was omitted mainly due to page limitations. We prioritized other baselines that exhibited higher D4RL performance. Nonetheless, we include a comparison with Work [7] in the table below for reference:\n\n\n| Algorithm                   | Mujoco (average) | Antmaze (average) |\n|-----------------------------|------------------|-------------------|\n| TD3+BC + [7]                | 85.5             | 29.8              |\n| CRR + [7]                   | 78.3             | 43.8              |\n| IQL + [7]                   | 79.9             | 73.4              |\n| (D)IQL with SRPO (ours)     | 87.1             | 73.6              |\n\n\n3. Another minor consideration is the codebase of Work [7], which is based on JAX, known for faster execution compared to the Pytorch code used in our selected baselines.\n\n\n**Q8: Are there some particular reasons for the choice of baselines?**\n\n**A8:** Our selection of baselines was guided by their relevance to our algorithm and the extent to which they are recognized and understood in the field:\n\n1. The five chosen diffusion-based RL methods are all well-acknowledged diffusion RL baselines. \n\n2. As an early and influential paper, BEAR formally discusses behavior regularization policy optimization methods in offline RL, utilizing a VAE-based approach.\n\n3. TD3+BC is a renowned Gaussian-based regularization method, widely recognized in the community.\n\n4. IQL is a well-known weighted regression method and is frequently used as a baseline in recent studies."
                    }
                },
                "number": 10,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6831/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700228651161,
                "cdate": 1700228651161,
                "tmdate": 1700229307973,
                "mdate": 1700229307973,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "Sh71BgaJKn",
                "forum": "xCRr9DrolJ",
                "replyto": "384fAwl08y",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6831/Reviewer_cVKT"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6831/Reviewer_cVKT"
                ],
                "content": {
                    "comment": {
                        "value": "Thanks for the authors' explanations. I have raised my score accordingly."
                    }
                },
                "number": 15,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6831/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700466280056,
                "cdate": 1700466280056,
                "tmdate": 1700621209006,
                "mdate": 1700621209006,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "OlMuMhIkSv",
                "forum": "xCRr9DrolJ",
                "replyto": "384fAwl08y",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6831/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6831/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Could you update the official review rating?"
                    },
                    "comment": {
                        "value": "Dear reviewer,\n\nWe are glad that our responses helped and would like to thank you for raising the score of our paper. However, we notice that the official OpenReview rating has not been updated, this will make the system and the AC unable to track the ratings for our paper.\n\n**Could you update the rating score of our paper to the OpenReview system, please?**\n\n1. Navigate to the **original** official review section (the first one above).\n\n2. Click on the *edit* button.\n\n3. Select the new rating (8) to replace the original one (6).\n\nThank you in advance!"
                    }
                },
                "number": 18,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6831/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700546350142,
                "cdate": 1700546350142,
                "tmdate": 1700632686460,
                "mdate": 1700632686460,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "U3GQvgP6Ow",
            "forum": "xCRr9DrolJ",
            "replyto": "xCRr9DrolJ",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission6831/Reviewer_fYZE"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission6831/Reviewer_fYZE"
            ],
            "content": {
                "summary": {
                    "value": "This paper proposes the use of pre-trained diffusion model for the behavior regularized offline policy optimization objective. The work shows a careful derivation of how pre-trained diffusion models, using the score function, can be replaced in the existing behavior regularized objective. The trick is to use the behavior policy distribution\u2019s score function, and the paper claims to show faster compute time compared to existing approaches. Experimental results are demonstrated using the D4RL benchmark."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "2 fair"
                },
                "contribution": {
                    "value": "2 fair"
                },
                "strengths": {
                    "value": "Algorithmically, the paper provides an interesting insight showing that in behavior regularized policy optimization objective, the gradient of the diverse term is indeed related to the score function of the behavior policy distribution. This therefore allows the use of pre-trained diffusion models to be used in these objectives.\n\nThe challenge of measuring the divergence term in offline regularized objective is generally difficult, where typically a separate model is needed to approximate the behavior model. Equation (9) provides a simple trick following equation (8) to show exactly where pre-trained diffusion models can be used for the behavior distribution, where the diffusion model e(a|s, t) can approximate the grad log term of the behavior policy. This is an interesting and novel insight to derive the algorithm, making use of the widely available pre-trained diffusion models these days."
                },
                "weaknesses": {
                    "value": "The paper is a bit hard to follow; while the claims are justified, the paper is not so well written and seems convoluted. I believe this is also because the key idea/trick of the paper is to use pre-trained diffusion models in existing offline rl objectives, so the paper tries to lay out the context for that. However, it makes the paper rather difficult to follow, to completely understand the full contribution of the work. \n\n\nSince the key idea is to use existing pre-trained diffusion models, I expected that other than the algorithmic contribution, the paper can do a much thorough job at more experimental evaluations? It would be useful to see existing setups where behavior regularized policy optimization is used, including toy examples, and perhaps provide a comprehensive qualitative study of the use of different pre-trained diffusion models in this context?\n\nExperimental results probably need to be more thorough; there are only marginal benefits from the SRPO objective and it is not clear whether the proposed approach leads to empirical benefits. It would be helpful to do more qualitative studies on the objective and the use of different pre-trained diffusion models."
                },
                "questions": {
                    "value": "See questions in the weakness section. \n\nThe key algorithmic pipeline is to integrate the SRPO technique with implicit Q learning. I wonder what happens if the SRPO objective is used in other behavior regularized offline rl objectives? Since the key algorithmic novelty comes through the derivation, it would be helpful if the authors can do more thorough experimental evaluation. Otherwise, the novel contributions of the paper are unclear."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "3: reject, not good enough"
                },
                "confidence": {
                    "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 3,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission6831/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698685977566,
            "cdate": 1698685977566,
            "tmdate": 1699636790088,
            "mdate": 1699636790088,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "Rhr7cIBFhw",
                "forum": "xCRr9DrolJ",
                "replyto": "U3GQvgP6Ow",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6831/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6831/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Official Response to Reviewer fYZE (1/2)"
                    },
                    "comment": {
                        "value": "We thank reviewer fYZE for his valuable feedback and his acknowledgment of our theoretical contribution. Although the current rating does not align with our expectations, we find that concerns primarily revolve around experimentation and presentation. Constructive suggestions have been provided. We seek to address the reviewer's concern by expanding experimental evaluations and improving presentation. \n\n**Q1: While the claims are justified, the paper is not so well written and seems convoluted.  ..the key idea/trick of the paper is ..., so the paper tries to lay out the context for that. However, it makes the paper rather difficult to follow**\n\n**A1:** We sincerely thank the reviewer for this valuable suggestion. Recognizing the concerns you have raised about the clarity and organization of our paper, we have undertaken significant revisions, **particularly in Section 3**, to enhance readability and coherence.\n\nPreviously, we structured the paper to evolve naturally from our dual objectives: integrating diffusion models and pursuing computational efficiency, which then led to the development of our SRPO algorithm. However, we acknowledge that this structure, rather than clarifying, inadvertently made the paper convoluted.\n\nIn response to your feedback, we have implemented the following revisions:\n\n1. We have shifted the narrative to **directly introduce the SRPO algorithm**, followed by an analysis of its benefits and a comparison with prior methodologies. This \"straight to the point\" approach clarifies our contributions without the need for extensive background exposition.\n2. We have removed unnecessary background information and considerations that were not directly relevant to the derivation of the SRPO algorithm.\n3. Sections 3.1 and 3.2 have been merged into a single section to make our presentation more cohesive and compact.\n\n**Q2: It would be useful to see existing setups where behavior regularized policy optimization is used, including toy examples**\n\n**A2:** Based on the reviewer's suggestion, **we have conducted additional experiments. Visualization results are provided** in Appendix A of the paper.\n\n1. We compare our proposed method against other behavior regularization methods, including BCQ, BEAR, and TD3+BC, across six tasks set in 2D bandit environments (Figure 4, Figure 9). \n\n2. To illustrate the advantages of using diffusion models over VAE models for behavior modeling, we conducted qualitative experiments. The diffusion and VAE models tested were nearly equivalent in terms of the number of parameters and network depth (Figure 9).\n\nOur findings highlight that Gaussian-based regularization methods, such as TD3+BC, tend to underperform in scenarios with complex behavior distributions, even in 2D settings. Rather than adhering closely to the behavioral actions, the learned policy often gravitates towards **the center of mass** of behavioral actions. VAE-based regularization methods, on the other hand, more frequently result in policies that select actions outside the dataset support, compared with our method. We attribute this to the generative capacity gap between diffusion and VAE models.\n\n**Q3: It would be helpful to do more qualitative studies on the objective.**\n\n**A3:** The two most important design choices in our policy optimization objective are the weighting function $w(t)$ and the temperature $\\alpha$. **We provide more qualitative results in the paper.**\n\n1. On the weighting function $w(t)$. In order to illustrate the empirical benefits of ensembling multiple diffusion times for score regularization, we calculate and visualize the density map learned by diffusion behavior models at different diffusion times $t$. Then we provide qualitative results to compare the regularization effect without the ensembling technique proposed in Section 4.2 of the paper. **(Figure 5, Figure 10, and Figure 11)**\n\n2. On the temperature $\\alpha$. We vary the temperature $\\alpha$. We provide qualitative results in Figure 12 and quantitative results in **Figure 15**."
                    }
                },
                "number": 1,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6831/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700136845038,
                "cdate": 1700136845038,
                "tmdate": 1700143148525,
                "mdate": 1700143148525,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "n9PkpA5Hdr",
                "forum": "xCRr9DrolJ",
                "replyto": "U3GQvgP6Ow",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6831/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6831/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Official Response to Reviewer fYZE (2/2)"
                    },
                    "comment": {
                        "value": "**Q4: More thorough experimental results ... on the use of different pre-trained diffusion models.**\n\n**A4:** (We interpret the reviewer's reference to different pre-trained diffusion models as applying our method to various previous diffusion-based RL literature.)\n\nTo further validate the effectiveness of our policy extraction scheme, we have **additionally applied our proposed score-regularization method to two additional diffusion-based Offline RL methods beyond IDQL**. Experimental results are given below.\n\nThese baselines are recognized diffusion-RL methods. Previously, they rely on an iterative diffusion sampling scheme for action selection, a process that is both time-consuming and highly stochastic. By integrating our proposed policy extraction scheme, **we observe improvements in both overall performance and inference speed**.\n\n\n| Environment      | SfBC  | **SfBC+SRPO** (new)| Diffuser | **Diffuser+SRPO** (new) | IDQL  | **IDQL+SRPO**(original paper) |\n|------------------|-------|-----------|----------|---------------|-------|-----------|\n| HalfCheetah-ME   | 92.6  | 93.3      | 79.8     | 92.1          | 95.9  | 92.2      |\n| Hopper-ME        | 108.6 | 95.7      | 107.2    | 91.2          | 108.6 | 100.1     |\n| Walker2d-ME      | 109.8 | 110.3     | 108.4    | 112.8         | 112.7 | 114.0     |\n| HalfCheetah-M    | 45.9  | 60.9      | 44.2     | 58.0          | 51.0  | 60.4      |\n| Hopper-M         | 57.1  | 89.3      | 58.5     | 57.6          | 65.4  | 95.5      |\n| Walker2d-M       | 77.9  | 83.3      | 79.7     | 75.4          | 82.5  | 84.4      |\n| HalfCheetah-MR   | 37.1  | 46.4      | 42.2     | 45.9          | 45.9  | 51.4      |\n| Hopper-MR        | 86.2  | 100.0     | 101.3    | 93.7          | 92.1  | 101.2     |\n| Walker2d-MR      | 65.1  | 80.3      | 61.2     | 82.9          | 85.1  | 84.6      |\n| **Average**          | 75.6  | 84.4      | 75.3     | 78.8          | 82.1  | 87.1      |\n| **Inference time**          | 315.0  | 1.0      | 1669.0     | 1.0          | 47.5  | 1.0      |\n\nBaselines details: \n\n1. Diffusers trains a discrete-time diffusion behavior model and has a transformer architecture. The critic model is trained by following the existing classifier guidance method.\n\n2. SfBC also trains a continuous-time diffusion behavior model with an encoder-decoder architecture. The critic model is training through implicit planning.\n\nDue to time constraints, we tested all tasks using three random seeds and a single shared behavior model. We intend to provide complete results before the camera-ready submission.\n\n\n**Q5: There are only marginal benefits from the SRPO  objective and it is not clear whether the proposed approach leads to empirical benefits.**\n\n**A5:** We respectfully disagree with the reviewer on this comment. We contend that the SRPO objective offers clear and significant benefits over previous approaches:\n\n1. A pivotal advantage of the SRPO objective is its **substantially faster inference speed** \u2013 at least 25 times quicker than various leading diffusion-based RL methods. This is not a marginal benefit but a fundamental improvement. **This benefit is inherent to our design;** unlike previous diffusion-based RL methods, which require iterative diffusion sampling during training or evaluation, our approach streamlines this process.\n\n2. **The experimental results, particularly after this revision, support our claims**. Our experiments detailed in responses A3 and A4, as well as in Table 1 and Appendix A, consistently demonstrate that SRPO can lead to empirical performance improvements in both D4RL benchmarks and 2D environments, outperforming previous methods.\n\n3. Compared to traditional VAE-based behavior regularization methods, our carefully derived score regularization method enables the effective utilization of more powerful diffusion modeling techniques. To the best of our knowledge, **similar objectives have not been explored in prior Offline RL literature**."
                    }
                },
                "number": 2,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6831/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700136982668,
                "cdate": 1700136982668,
                "tmdate": 1700638907406,
                "mdate": 1700638907406,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "nTDx7rMNNX",
                "forum": "xCRr9DrolJ",
                "replyto": "U3GQvgP6Ow",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6831/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6831/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Please let us know if we have resolved your concerns"
                    },
                    "comment": {
                        "value": "Dear reviewer,\n\nWe were wondering if our responses and revision have resolved your concerns since only three days are left for the discussion phase. Based on your suggestions, we have undertaken significant revisions to our manuscript. We conduct three additional types of experiments (both qualitatively and quantitatively) and enhance the way we organize our narrative structure. Please let us know if these changes meet your expectations. We are eager to engage in further discussions and continue improving our work.\n\nBest regards,\n\nThe Authors"
                    }
                },
                "number": 13,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6831/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700458467559,
                "cdate": 1700458467559,
                "tmdate": 1700458467559,
                "mdate": 1700458467559,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "LuHMKegStG",
                "forum": "xCRr9DrolJ",
                "replyto": "U3GQvgP6Ow",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6831/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6831/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Your feedback is critical to us"
                    },
                    "comment": {
                        "value": "Dear reviewer,\n\nWe were wondering if our responses and revision have resolved your concerns since only two days are left for discussion. we have undertaken significant revisions to our manuscript based on your suggestions. We conduct three additional types of experiments (both qualitatively and quantitatively) and enhance the way we organize our narrative structure. Please let us know if these changes meet your expectations. We are eager to engage in further discussions and continue improving our work.\n\nBest regards,\n\nThe Authors"
                    }
                },
                "number": 19,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6831/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700547484768,
                "cdate": 1700547484768,
                "tmdate": 1700547484768,
                "mdate": 1700547484768,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "hBJCeUynrF",
                "forum": "xCRr9DrolJ",
                "replyto": "U3GQvgP6Ow",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6831/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6831/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Awaiting your valuable feedback before deadline"
                    },
                    "comment": {
                        "value": "Dear Reviewer,\n\nWe fully appreciate the demands on your time, particularly during this busy period. As today marks the **final day of the discussion stage**, we are writing to kindly request your feedback on our responses. Your insights are crucial to addressing any remaining concerns you may have regarding our submission.\n\nPlease note that after November 22nd, while you are welcome to reassess or comment on our work at your convenience, our ability to respond may be limited. Therefore, we are particularly keen to engage in a constructive dialogue with you before the imminent deadline. Your feedback is not only valuable to us but also essential for the final evaluation of our work.\n\nBest,\n\nSubmission 6831 Authors"
                    }
                },
                "number": 20,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6831/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700637921671,
                "cdate": 1700637921671,
                "tmdate": 1700639011366,
                "mdate": 1700639011366,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "UNtvxW5VVc",
            "forum": "xCRr9DrolJ",
            "replyto": "xCRr9DrolJ",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission6831/Reviewer_bNEQ"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission6831/Reviewer_bNEQ"
            ],
            "content": {
                "summary": {
                    "value": "This paper introduces a score regularized policy optimization algorithm (SRPO) based on behavior diffusion, aiming to address the problem of heterogeneous behavior distributions in offline reinforcement learning. The algorithm utilizes a pre-trained behavior diffusion model to score-normalize policy gradients and presents a practical method based on behavior diffusion and implicit Q-learning. The paper provides a detailed explanation of SRPO's principles, implementation, and optimization techniques, and it validates the effectiveness of the algorithm through experiments."
                },
                "soundness": {
                    "value": "4 excellent"
                },
                "presentation": {
                    "value": "4 excellent"
                },
                "contribution": {
                    "value": "4 excellent"
                },
                "strengths": {
                    "value": "In the offline reinforcement learning setting, the paper introduces a novel approach that leverages the diffusion model. This method uses the powerful modeling capabilities of the diffusion model while avoiding the extensive time-consuming iterative inference stage."
                },
                "weaknesses": {
                    "value": "The final policy used by the algorithm is still based on a Gaussian distribution. This Gaussian policy might not capture complex distributions as effectively as the diffusion model when dealing with complex offline datasets. The key concern here is whether the complex distribution information modeled by the pretrained diffusion behavior can be adequately captured by a policy based on a Gaussian distribution."
                },
                "questions": {
                    "value": "1. DIQL should be IDQL in the first and second paragraph of section 6.1.\n2. Why do different Gaussian-based policies have significantly varying inference times, as shown in Figure 1?"
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "8: accept, good paper"
                },
                "confidence": {
                    "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 4,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission6831/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698838496929,
            "cdate": 1698838496929,
            "tmdate": 1699636789982,
            "mdate": 1699636789982,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "HcwsBhIqIG",
                "forum": "xCRr9DrolJ",
                "replyto": "UNtvxW5VVc",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6831/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6831/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Official Response to Reviewer bNEQ"
                    },
                    "comment": {
                        "value": "We thank reviewer bNEQ for his expertise and insightful comments. We give a point-to-point response to the raised concerns below and hope they may help increase the reviewer's confidence in our work.\n\n**Q1: This Gaussian policy might not capture complex distributions as effectively as the diffusion model when dealing with complex offline datasets.**\n\n**A1:**\nWe partially agree with the reviewer. In our opinion, diffusion models are beneficial for offline RL for mainly two reasons:\n\n1. The behavior dataset $\\mu(a|s)$ is complex.\n\n2. The optimal policy $\\pi^* \\propto  \\mu(a|s) \\ e^{\\beta Q(s, a)}$ is potentially complex (multi-modal).\n\nIf referring to problem 1, our proposed method captures complex behavior distributions effectively and **efficiently** by utilizing a diffusion behavior model. No Gaussian model is used.\n\nIf referring to problem 2, we use a Dirac (gaussian) policy to capture the mode of $\\pi^*$:\n\n$\\pi^{\\text{gauss}}\\_{\\theta} (s) = \\arg \\max\\_a \\mu(a|s) \\ e^{\\beta Q(s, a)} $ instead of $\\pi_\\theta^{\\text{diff}}(a|s) \\propto \\mu(a|s) \\ e^{\\beta Q(s, a)}$.\n\n**We agree with the reviewer that the Gaussian policy cannot capture complex $\\pi^{\\*}$. This is simply not our intention.** \nIf there are two optimal policies for one single task, our method will simply choose either one of them deterministically. Our observation is that in many scenarios, inference speed is of much higher priority than policy diversity. For instance, in robotics, we often do not care about how many ways our robot can solve a task. Contrastively, we do care about whether our policy is optimal and efficient (hardware-friendly). Also, current evaluation metrics of the D4RL benchmark only emphasize policy optimality and ignore policy diversity.\n\nStill, we believe a better trade-off between inference speed and policy diversity exists and could be a future direction of our work.\n \n**Q2: The key concern here is whether the complex distribution information modeled by the pretrained diffusion behavior can be adequately captured by a policy based on a Gaussian distribution.**\n\n**A2:** We really appreciate this insightful comment. \n\nTheoretically, since SRPO can be thought of as performing gradient descent in the action space: $\\arg \\max\\_a [\\log \\mu(a|s) + \\beta Q(s, a)]$, it is possible that the learned policy gets stuck in a local optimal and thus fails to capture the mode of $\\pi^*$. \n\nTo address this problem, our work proposes to ensemble diffusion score estimators at diffusion times $t\\in (0,1)$ to make the gradient landscape smoother. This part is explained in section 4.2 and analyzed in Appendix B of the paper. **We have newly added an illustration in Figure 5 and Figure 10 in the revisited paper.** Ablation studies in Section 6.3 also support the effectiveness of our proposed method. \n\n**Empirically, we feel confident about SRPO's ability to capture complex distribution information modeled by the pre-trained diffusion in offline RL.** Besides reported evaluation numbers, our confidence also comes from DreamFusion (a text-to-3D research winning the Outstanding Paper Award of ICLR2023), which inspires our work. DreamFusion seeks to learn a Dirac 3D model from a pre-trained large-scale image diffusion model. Their method similarly adopts a score distillation method to supervise the training of another Dirac (Gaussian) 3D model. Experimental results show that Gaussian-based policy can already capture complex and high dimensional distribution successfully **even in complex image space** (https://dreamfusion3d.github.io/).\n\n\n**Q3: DIQL should be IDQL in the first and second paragraph of section 6.1.**\n\n**A3:** We sincerely thank the reviewer for the careful reading. The typo is fixed now.\n\n**Q4: Why do different Gaussian-based policies have significantly varying inference times, as shown in Figure 1?**\n\n**A4:** Actually inference times for Gaussian-based policies are very similar. They only look that way because the x-axis is in the log scale in Figure 1.\n\n|                | Ours | BEAR | IQL  | CQL  | AWAC | BCQ | DT   | IDQL  | Diffuser |\n|:---------------|:-----|:-----|:-----|:-----|:-----|:----|:-----|:------|:---------|\n| Inference time | 1.28 | 1.28 | 1.43 | 2.32 | 2.86 | 9.0 | 31.6 | 60.83 | 2136.4   |\n\nps. AWAC takes a longer time for action sampling simply because it is a 4-layer MLP, while ours is a 2-layer MLP."
                    }
                },
                "number": 5,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6831/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700141057901,
                "cdate": 1700141057901,
                "tmdate": 1700141057901,
                "mdate": 1700141057901,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "OXTpCC6GhI",
                "forum": "xCRr9DrolJ",
                "replyto": "UNtvxW5VVc",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6831/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6831/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Please let us know if we have resolved your concerns"
                    },
                    "comment": {
                        "value": "Dear reviewer,\n\nWe were wondering if our responses have resolved your concerns. We hope that these clarifications can serve to enhance your confidence in the ratings of our work. Should you have any further questions or require additional insights, please feel free to reach out. We are fully committed to providing any necessary information to support your assessment.\n\nWarm regards,\n\nThe Authors"
                    }
                },
                "number": 14,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6831/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700459494558,
                "cdate": 1700459494558,
                "tmdate": 1700459494558,
                "mdate": 1700459494558,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    }
]