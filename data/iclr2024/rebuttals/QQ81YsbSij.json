[
    {
        "title": "Learning Conditional Policy for Crystal Design using Offline Reinforcement Learning"
    },
    {
        "review": {
            "id": "sfC7ahnCox",
            "forum": "QQ81YsbSij",
            "replyto": "QQ81YsbSij",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission6527/Reviewer_NogB"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission6527/Reviewer_NogB"
            ],
            "content": {
                "summary": {
                    "value": "The paper tries to design novel and stable crystalline materials conditioned on a desired band gap. The authors turn the problem into a sequential decision-making problem and use offline RL algorithms to learn an effective policy to design materials. They design the reward function for material design. For experiments, they compare their methods against behavior cloning, random policy, etc, and demonstrate the effectiveness."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "2 fair"
                },
                "strengths": {
                    "value": "+ They formulate the crystal design problem into an offline RL problem which utilizes total energy and band gap values to get reward functions. By using DFT calculations, they can optimize the rewards thus solving the crystal structure problems;\n+ They built an offline dataset from the Materials Project so that offline RL algorithms could learn from the dataset;\n+ The illustration and explanation of the material designs are easy to understand for ML people, the authors abstract away the complex details and make an effort in the presentation to make the paper accessible."
                },
                "weaknesses": {
                    "value": "- I am in no way a crystal design expert, but from the experiments, it feels like lacking strong baselines.  The authors compare their method to some natural baselines deviated from their proposed method (CQL). It would be great if the authors could compare/mention the state-of-the-art methods used in the field of crystal design;"
                },
                "questions": {
                    "value": "The expert reviewer on DFT/crystal designs should do their gatekeeping job on the paper. From my educated guess from an RL researcher's point of view, the paper is ok."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "5: marginally below the acceptance threshold"
                },
                "confidence": {
                    "value": "2: You are willing to defend your assessment, but it is quite likely that you did not understand the central parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                },
                "first_time_reviewer": {
                    "readers": [
                        "ICLR.cc/2024/Conference/Program_Chairs",
                        "ICLR.cc/2024/Conference/Submission6527/Senior_Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission6527/Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission6527/Reviewer_NogB"
                    ]
                }
            },
            "number": 1,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission6527/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698653719596,
            "cdate": 1698653719596,
            "tmdate": 1700624614203,
            "mdate": 1700624614203,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "aMn7PmzX6L",
                "forum": "QQ81YsbSij",
                "replyto": "sfC7ahnCox",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6527/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6527/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Author's Response"
                    },
                    "comment": {
                        "value": "We would like to thank you for your review, and for your constructive comments about the paper. We truly appreciate your points on the clarity of the paper. Please find the explanations for your comments below. \n___\n> *From the experiments, it feels like lacking strong baselines*\n\nFor our experiments, we primarily focused on **unconditional baselines (random, behavioral cloning, and unconditioned CQL)** for a better understanding of whether conditioning helps in improving the property of interest. As suggested by **Reviewer ffhH**, it would also be interesting to compare the performance with conditional baselines with approaches like behavioral cloning (supervised training on materials that have the target property). We are currently working on this aspect. \n___\n> *It would be great if the authors could compare/mention the state-of-the-art methods used in the field of crystal design*\n\nDiffusion models[1], GANs[2][3], and RL[4] have been used to address the crystal design problem. Other approaches are cited in **Section 2** in the paper. However, as stated in our response to **Reviewer b3qf**, there are various reasons why a direct comparison of our approach with those models is difficult.  An important reason is that most approaches that use DFT for evaluation focus only on a small chemical space or have shape constraints (e.g. cubic). Further, our way of formulating the problem as a sequential decision-making process to predict atom types is entirely different from existing approaches to material design. We do not predict the structure, making it difficult to compare our approach with models that generate the structure. Lastly, none of the previous studies focused on band gap directed inverse design of crystals. \n___\n**We wish to thank the reviewer for the positive ratings and feedback. If you are satisfied with our response and the updated draft, it would be great if there is any scope for improvement of your rating. If you have more questions, we would be happy to answer them.**\n___\n**References**\n\n[1] Xie, Tian, et al. \"Crystal diffusion variational autoencoder for periodic material generation.\" arXiv preprint arXiv:2110.06197 (2021).\n\n[2] Zhao, Yong, et al. \"Physics guided deep learning for generative design of crystal materials with symmetry constraints.\" npj Computational Materials 9.1 (2023): 38.\n\n[3] Zhao, Yong, et al. \"High\u2010throughput discovery of novel cubic crystal materials using deep generative neural networks.\" Advanced Science 8.20 (2021): 2100566. \n\n[4] Pan, Elton, Christopher Karpovich, and Elsa Olivetti. \"Deep reinforcement learning for inverse inorganic materials design.\" arXiv preprint arXiv:2210.11931 (2022)."
                    }
                },
                "number": 7,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6527/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700536182920,
                "cdate": 1700536182920,
                "tmdate": 1700536182920,
                "mdate": 1700536182920,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "tuBkeDDbZN",
                "forum": "QQ81YsbSij",
                "replyto": "aMn7PmzX6L",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6527/Reviewer_NogB"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6527/Reviewer_NogB"
                ],
                "content": {
                    "comment": {
                        "value": "As I said, I am in no way an expert in material design. After reading my fellow reviewers' comments (especially from the reviewer ffhH) and the authors' rebuttal, I think the paper does not qualify as a good scientific material design application of offline RL algorithms. Thus, I have lowered my score."
                    }
                },
                "number": 9,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6527/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700624759666,
                "cdate": 1700624759666,
                "tmdate": 1700624759666,
                "mdate": 1700624759666,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "DejoSWLrry",
            "forum": "QQ81YsbSij",
            "replyto": "QQ81YsbSij",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission6527/Reviewer_W7dF"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission6527/Reviewer_W7dF"
            ],
            "content": {
                "summary": {
                    "value": "This work focuses on inverse design for crystal structures which has a desired band gap. They model the problem as a MDP, and apply off-the-shelf algorithms from offline RL. \n\nThe results are evaluated by DFT, therefore, might be promising. But I'm not an expert on band gap, so I cannot judge whether the results are strong."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "2 fair"
                },
                "strengths": {
                    "value": "RL-based inverse design for 3D structures is relatively under-explored. This work proves that RL methods have the potential to resolve some challenges of inverse design in science."
                },
                "weaknesses": {
                    "value": "1. No novel algorithm is proposed. But for application-oriented research, novel algorithm is not always necessary. The focus here is on implementing and adapting existing methods in a novel context.\n2. The analyses of the results are limited.  It would be beneficial to quantify how many new structures were generated and clarify whether the algorithm simply reproduces known structures from the training set. Given that conservative RL is used, I suspect the output is close to the training set.\n3. Since DFT is actually included in the loop, how about using online RL? Is there any chance to find some novel materials through automated exploration."
                },
                "questions": {
                    "value": "See above."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "5: marginally below the acceptance threshold"
                },
                "confidence": {
                    "value": "2: You are willing to defend your assessment, but it is quite likely that you did not understand the central parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                },
                "first_time_reviewer": {
                    "readers": [
                        "ICLR.cc/2024/Conference/Program_Chairs",
                        "ICLR.cc/2024/Conference/Submission6527/Senior_Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission6527/Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission6527/Reviewer_W7dF"
                    ]
                }
            },
            "number": 2,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission6527/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698764080722,
            "cdate": 1698764080722,
            "tmdate": 1700632808475,
            "mdate": 1700632808475,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "xbDC2R3DBw",
                "forum": "QQ81YsbSij",
                "replyto": "DejoSWLrry",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6527/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6527/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Author's Response"
                    },
                    "comment": {
                        "value": "We wish to thank you for your review and acknowledgement of our contribution to the underexplored avenue of RL-based inverse design of materials. We have provided explanations for your comments and concerns below.\n___\n> *No novel algorithm is proposed. But for application-oriented research, novel algorithm is not always necessary. The focus here is on implementing and adapting existing methods in a novel context.*\n\nWe acknowledge and agree with your comment. The primary area of our submission is **\u201capplications to physical sciences (physics, chemistry, biology, etc.)\u201d**, one of the topics in ICLR 2024 (https://iclr.cc/Conferences/2024/CallForPapers), and while our approach relies on the CQL approach, the construction of our DFT-integrated workflow is unique and novel to the best of our knowledge. \n___\n> *The analyses of the results are limited. It would be beneficial to quantify how many new structures were generated and clarify whether the algorithm simply reproduces known structures from the training set. Given that conservative RL is used, I suspect the output is close to the training set.*\n\nThe pre-simulation metrics in **Section 5.1** of the paper indicate the accuracy and similarity (substitutions with similar atoms) of the trained models on the validation data. While the accuracy, which measures the percentage of accurately predicted atoms globally, was between **36-50%** for all models on the validation dataset, the fraction of exactly reconstructed crystals (i.e., all atoms match the ground truth in a crystal) was extremely low (0-7% depending on the model). This could be due to two reasons: 1) the optimization objective of CQL[1] aims not just to fit the dataset (as in BC), but to balance the tradeoff between minimizing the Bellman error and being conservative, 2) the offline policy is trained with batches of transitions i.e., $(s, a, s^{\\prime}, r)$, but during test time we perform a rollout starting from an initial state $\\boldsymbol{s_0}$. This makes it harder for the learned policy to exactly reconstruct the crystals. Nevertheless, this contributes to the novelty of the generated crystals \u2013 more than 90% of the generated crystals of all models had a different composition compared to the corresponding ground truth crystals. **Figure 3** in our updated draft shows examples of generated crystals that have the desired property of interest when the corresponding true crystals lie outside the desired range. While the model does reconstruct the crystals in the training set more accurately than the validation set, the points discussed above hold for the training set, too, and this prevents it from reaching the maximum accuracy (100%). About your comment on the extent of the analysis, we have added results for more design targets (2 eV and 3 eV) and added a new metric **(out-of-distribution design)** in our latest draft of the paper (Figure 2). \n___\n> *Since DFT is actually included in the loop, how about using online RL? Is there any chance to find some novel materials through automated exploration?*\n\nDirectly using reward signals from DFT calculators in an online reinforcement learning setup is extremely difficult to train because of the large computation time of DFT simulations. However, we believe that the learned offline policy could serve as a good initial policy (thereby incorporating inductive bias) for online RL, and this would be the immediate future work. For online experiments, it is more reasonable to start with a single or a small batch of crystal skeletons in a way that the training process does not take a very long time. \n___\n\n**We would like to thank the reviewer for the constructive feedback and positive rating. We hope our responses answered your queries, and are happy to answer more if required. If you are satisfied with the replies and the updated draft, it would be great if there is any scope for improvement in your score for our submission.**\n___\n**References**\n\n[1] Kumar, Aviral, et al. \"Conservative q-learning for offline reinforcement learning.\" Advances in Neural Information Processing Systems 33 (2020): 1179-1191."
                    }
                },
                "number": 6,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6527/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700534649983,
                "cdate": 1700534649983,
                "tmdate": 1700534649983,
                "mdate": 1700534649983,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "P4btaybBSm",
            "forum": "QQ81YsbSij",
            "replyto": "QQ81YsbSij",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission6527/Reviewer_b3qf"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission6527/Reviewer_b3qf"
            ],
            "content": {
                "summary": {
                    "value": "The authors formalize the problem of crystal design as a MDP, produce an offline dataset for this MDP, and train CQL policies conditioned on the band gap desired in order to attempt to design novel semiconductors. They evaluate a conditional CQL policy along side a random policy, behavior cloning, and an unconditional CQL policy. \n\nThey evaluate whether the crystal is valid, whether the total energy is low enough, and whether the generated and true band-gap distributions are accurate. \n\nThey find that conditional policies generate materials closer to the desired band gap range, that greater conditioning seems to lead to better outputs, that unconditional policies recreate the original distirbution of data better, and that random policies do not generate good output."
                },
                "soundness": {
                    "value": "2 fair"
                },
                "presentation": {
                    "value": "2 fair"
                },
                "contribution": {
                    "value": "1 poor"
                },
                "strengths": {
                    "value": "Crystal design is an important problem for society and it is important that we bring our best tools to bear. Determining whether ML can be helpful and how best to apply it is a useful scientific enterprise and it seems this paper is a step in that direction. It seems that the authors have created 1) a useful new method, 2) a dataset that might be of independent value to the matsci community. These are both valuable."
                },
                "weaknesses": {
                    "value": "This paper is not suitable for the program of ICLR, as it doesn\u2019t advance the state of the art in machine learning. CQL is at this point a widely known algorithm and the application to crystal design is not one which pushes ML forward.\n\nIt is also not clear to me that the MDP formalism is the correct one for this problem setting. It seems to me that using a conditional generative model over the entire data would be a more natural choice (think diffusion model or autoregressive transformer). The authors don\u2019t evaluate against those baselines which I think might be better suited."
                },
                "questions": {
                    "value": "Have people tried generative modeling approaches to this problem? How well did they work? Can we quantitatively compare?\n\nIs there a venue in materials science that would be more appropriate for this work?"
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "3: reject, not good enough"
                },
                "confidence": {
                    "value": "5: You are absolutely certain about your assessment. You are very familiar with the related work and checked the math/other details carefully."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 3,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission6527/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698787576823,
            "cdate": 1698787576823,
            "tmdate": 1699636733773,
            "mdate": 1699636733773,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "AlcbwIxNeQ",
                "forum": "QQ81YsbSij",
                "replyto": "P4btaybBSm",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6527/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6527/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Author's Response"
                    },
                    "comment": {
                        "value": "We thank you for the review and feedback, and for acknowledging the importance of the crystal design problem. We appreciate your comment on the usefulness of our method to the material science community. Please find our comments for your questions and concerns below. \n___\n> *This paper is not suitable for the program of ICLR, as it doesn\u2019t advance the state of the art in machine learning.*\n\nWe wish to clarify that the primary area of our submission is **\u201capplications to physical sciences (physics, chemistry, biology, etc.)\u201d**, which is mentioned as one of the topics/tracks in ICLR 2024\u2019s call for papers (https://iclr.cc/Conferences/2024/CallForPapers) and therefore represents an important area for ICLR. \n___\n> *CQL is at this point a widely known algorithm and the application to crystal design is not one which pushes ML forward.*\n\nWe acknowledge that our approach relies on the CQL approach for the offline training. However, to the best of our knowledge, our crystal design pipeline is novel, where we have leveraged large datasets and **first-principles DFT calculations**, and integrated them into the offline RL training process \u2013 while DFT helps in accurate estimation of properties like energy and band gap, the cost of computation is very high. It takes a few seconds to several minutes (~2 minutes on average) to compute the reward for each input crystal. Through our approach, we demonstrate promising results for band-gap-directed crystal design, highlight the challenges and scope for future work, and propose to release a benchmark dataset for the benefit of the material discovery community. We believe that this is a solid contribution to the **\u201capplications to physical sciences\u201d** track in ICLR.\n___\n> *It is also not clear to me that the MDP formalism is the correct one for this problem setting. It seems to me that using a conditional generative model over the entire data would be a more natural choice (think diffusion model or autoregressive transformer). The authors don\u2019t evaluate against those baselines which I think might be better suited.*\n\nDiffusion models have previously been studied for material design[1]. However, this involves predicting the identities/properties of all atoms at once with no sequential process involved. The case is the same for other generative models like GAN. We believe that by framing this problem as a sequential decision-making process, the important aspects of **exploration, credit assignment, and \u2018learning to search solutions\u2019 are more intuitive**, especially when integrated with DFT \u2013 this could help in improving the explainability of the model. MDP formalism has proven very useful in small molecule discovery (drug design)[5][6], and is also of interest to the material discovery community[7]. We primarily focused on unconditional baselines (random, behavioral cloning, and unconditioned CQL) in our experiments for an understanding of whether conditioning helps in improving the property of interest. We are currently working on evaluating diffusion and decision transformer-based conditional models for band gap directed crystal design. \n___\n> *Have people tried generative modeling approaches to this problem? How well did they work? Can we quantitatively compare?*\n\nCDVAE[1] is the first approach to address the crystal structure design problem using a diffusion model. However, there is no integration of first-principles DFT properties, and only approximate metrics and properties were used for performance evaluation. Other works focused on generative models like GANs, with the most recent one being [2], where generated crystals were evaluated using DFT. Another work is [3], which used a distributional graphormer model to generate carbon-based crystal structures. While the performances of these methods are promising, the reasons why we cannot perform a direct comparison of these models with our approach are mentioned below. \n- Many approaches that use DFT focus only on small chemical systems, with lesser number of elements in the vocabulary, or have constraints on the shape of crystals. For instance, Distributional graphormer[3] generates only carbon-based crystal structures. CubicGAN[4] focuses only on cubic crystals. However, a conditional variant of the GAN model proposed by [2] could be more suitable for comparison with our model in terms of property-directed generation. We are working on the same. \n- Some of the metrics used by structure generation models (e.g., structural validity as in [1]) cannot be directly used for comparison with our model, since we do not generate the structure. \n- None of the previous studies focused on inverse design of crystals (without structural or composition constraints) with band gap as the property of interest."
                    }
                },
                "number": 4,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6527/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700532812415,
                "cdate": 1700532812415,
                "tmdate": 1700536333747,
                "mdate": 1700536333747,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "yZfWAeLU1f",
            "forum": "QQ81YsbSij",
            "replyto": "QQ81YsbSij",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission6527/Reviewer_ffhH"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission6527/Reviewer_ffhH"
            ],
            "content": {
                "summary": {
                    "value": "This paper tackles the problem of inversely designing crystals by using offline reinforcement learning on a materials dataset with recomputed DFT property labels. The goal of this work is to learn a conditional policy that can efficiently perform atom substitution of given crystal skeletons, such that the resulting material satisfies a given target condition. It is shown that the learned conditional policy outperforms several baselines on a crystal design task where the generated materials have to satisfy particular band gap constraints."
                },
                "soundness": {
                    "value": "2 fair"
                },
                "presentation": {
                    "value": "2 fair"
                },
                "contribution": {
                    "value": "2 fair"
                },
                "strengths": {
                    "value": "The paper is clearly written and the use of offline RL is well-motivated by the prohibitively expense DFT calculations that would be required in an online setting. To my knowledge, this is also the first paper that uses offline RL for materials design. Limitations of the approach are clearly communicated, too. \n\nOverall, the chosen approach makes sense and the definition of the reward function and the Q-function are reasonable. Having DFT energies and band gap values consistently calculated with QE could be useful for researchers that cannot afford commercial DFT software."
                },
                "weaknesses": {
                    "value": "As the authors point out, the paper addresses a vastly simplified problem. The policy has a very limited action space, and is basically just learning a more efficient way to substitute atoms. I do not see any evidence that the approach could be easily extended/scaled to a more complex action space as described in the future work section, so I am not sure how useful this approach is in practice. The RL approach itself is not very original since it is mostly a straightforward adaptation of CQL. And while I appreciate the effort to generate the dataset with QE, I would have liked to see more details about how the dataset was generated (e.g., which settings have been used and how were failures handled) if this is one of the main contributions of the paper.\n\nThe paper also has substantial flaws in its methodology. First of all, total energy says nothing about thermodynamic stability; instead, energy above convex hull is a much better measure. Secondly, I found the presented baselines pretty weak since they are either random or completely oblivious of the target condition (if I understand correctly). For example, a stronger BC baseline might be to train the policy on only those materials whose band gap values are close to the target condition. Finally, I would have liked to see how the generated crystals look like.\n\nIn terms of presentation, I found the quality of the tables and figures to be quite low. Given that this is an RL for materials design paper, I also would have liked to see a few more references at this intersection. See below for a few examples (however, note that I have not checked all of them thoroughly):\nSui et al. (2021). Deep Reinforcement Learning for Digital Materials Design.\nLaw et al. (2022). Upper-Bound Energy Minimization to Search for Stable Functional Materials with Graph Neural Networks.\nPan et al. (2022). Deep Reinforcement Learning for Inverse Inorganic Materials Design.\nZheng et al. (2022). Designing mechanically tough graphene oxide materials using deep reinforcement learning.\n\nMinor comments:\n- p. 1: \"large and discrete space\" - While the search space in the paper is discrete, the space of all possible materials is not discrete.\n- p. 2: \"in the Materials Project database\" - citation missing\n- p. 3: \"is the is the\" -> \"is the\"\n- p. 3: \"230 having the\" -> \"230 has the\"\n- Table 2: Given that the table does not add much additional information, I would suggest to move this to the appendix"
                },
                "questions": {
                    "value": "1. Could you please provide more information regarding how the dataset was generated?\n2. How is the initial crystal skeleton $G_0$ for each episode chosen/sampled?\n3. How do the crystals generated by the policy look like? Are they sensible?"
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "3: reject, not good enough"
                },
                "confidence": {
                    "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
                },
                "code_of_conduct": {
                    "value": "Yes"
                },
                "first_time_reviewer": {
                    "value": "Yes",
                    "readers": [
                        "ICLR.cc/2024/Conference/Program_Chairs",
                        "ICLR.cc/2024/Conference/Submission6527/Senior_Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission6527/Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission6527/Reviewer_ffhH"
                    ]
                }
            },
            "number": 4,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission6527/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698801037915,
            "cdate": 1698801037915,
            "tmdate": 1699636733661,
            "mdate": 1699636733661,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "xePYL4HaAV",
                "forum": "QQ81YsbSij",
                "replyto": "yZfWAeLU1f",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6527/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6527/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Author's Response"
                    },
                    "comment": {
                        "value": "Thank you for the insightful analysis of the paper. The strengths you mentioned about the reasonableness and usefulness of our methodology and the clarity of the paper are very encouraging. We also appreciate the domain-related comments in your review. Please find our answers to your questions and concerns below. \n___\n> *The policy has a very limited action space, and is basically just learning a more efficient way to substitute atoms.*\n\nWhile this problem is a simplified version of the overall goal of full crystal structure design, we wish to point out that our action space comprises **88 elements** in the periodic table (the action space is larger than most of the common RL benchmarks like Atari), and the mapping between the crystal structure and DFT properties is quite complex for any model to learn, which is why we consider this as a \u2018learning to search\u2019 problem. Our main hypothesis is the following \u2013 among the combinatorial possibilities of atom substitutions given a skeleton of a crystal, there exist some substitutions that result in better stability and have the desired property of interest, and the RL model is expected to search for these solutions. Further, the challenges such as less exploration in offline RL and underestimation of DFT-based band gaps, pose additional difficulties. Also, through this work, we aim to accelerate **high-throughput virtual screening (HTVS)**, which commonly substitutes atoms in existing crystal structures to determine novel crystals \u2013 this has resulted in augmentations of popular crystal structure databases such as the **Materials Project**[1].\n___\n> *I do not see any evidence that the approach could be easily extended/scaled to a more complex action space as described in the future work section, so I am not sure how useful this approach is in practice.*\n\nOur future work includes extending the action space to continuous variables like the position of atoms and the lattice structure, in addition to the discrete atom types. This would involve modeling discrete and continuous policies together (or handling multiple action types), which is currently an interesting problem in the RL community. Based on the promising results of previous works that have attempted to tackle this multi-dimensional complex action space, we believe this to be feasible for future work [2][3]. Building on these works for learning policies for atom type and structure generation is a useful extension of our contribution, which addresses the overall problem of designing crystals without prior information about the structure. The inherent challenges of this are yet to be investigated, but we believe that our DFT-integrated offline RL pipeline and evaluation strategies would be very helpful for this challenging design setting. \n___\n> *I would have liked to see more details about how the dataset was generated (e.g., which settings have been used and how were failures handled) if this is one of the main contributions of the paper*\n\nThanks for the suggestion. We have updated our submission with **Section A.4** in the Appendix, which explains the details of the DFT computations and handling of failures.  As explained in **Section 4.4**, we construct state trajectories using crystals in the Materials Project dataset; an example of a trajectory is shown in **Figure 1a** in the paper. Further details are provided in our response to your question on how the dataset was generated.\n___\n> *Total energy says nothing about thermodynamic stability; instead, energy above convex hull is a much better measure.*\n\nAt present, through our unique reward scheme, we only aim to design crystals with desired band gap that are generally considered stable so they can be used for practical purposes. This is also why the coefficient of the energy term in our reward formulation ($\\alpha_1$) is lower than that of the property distance term ($\\alpha_2$). However, we understand and acknowledge your concern about total energy. We are constantly looking for reward schemes that better capture the energetic properties of the crystals in a relative sense rather than absolute. While the energy above the convex hull is the best-known measure of a crystal\u2019s stability [4], this metric is conditioned on the elements present in the crystal and is computationally expensive to calculate for a large number of crystals with varying compositions. We are currently redoing our analysis with **formation energy**, which is not as expensive as energy above convex hull but a more reasonable metric to incorporate in the reward function since it represents a better approximation for crystal stability."
                    }
                },
                "number": 1,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6527/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700527280704,
                "cdate": 1700527280704,
                "tmdate": 1700527280704,
                "mdate": 1700527280704,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "DwPjjSvuSw",
                "forum": "QQ81YsbSij",
                "replyto": "yZfWAeLU1f",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6527/Reviewer_ffhH"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6527/Reviewer_ffhH"
                ],
                "content": {
                    "comment": {
                        "value": "Thank you for your reply. \n\nI agree that substitution is a widely used approach and a more efficient way to do that might be valuable, at least for systems with four or more distinct atom types. My main concern with the future work is not that it is difficult to model, but that it will make the problem significantly harder. In particular, it is much more complex than molecular design since the number of elements is much larger, there are much more degrees of freedom, and there are complex interactions with the lattice.\n\nI disagree that energy above hull is too expensive to compute, but I think formation energy would also be acceptable given that this is an ML conference, so I appreciate your efforts. If you really cannot afford to compute energy above hull for every generated structure, I believe a reasonable compromise would be to use formation energy for the reward but additionally compute energy above hull only on the crystals generated via the validation set.\nIf you could show that your approach still works in this case, I would be willing to revise my score from 3 to 5. However, as it stands I will maintain my current score."
                    }
                },
                "number": 10,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6527/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700653756376,
                "cdate": 1700653756376,
                "tmdate": 1700654324409,
                "mdate": 1700654324409,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    }
]