[
    {
        "title": "The Closeness of In-Context Learning and Weight Shifting for Softmax Regression"
    },
    {
        "review": {
            "id": "YesyecDS90",
            "forum": "6uUmpPvqUU",
            "replyto": "6uUmpPvqUU",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission6804/Reviewer_ahEK"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission6804/Reviewer_ahEK"
            ],
            "content": {
                "summary": {
                    "value": "The authors aim at improving our understanding of in-context learning\nfrom a theoretical perspective. Previous work has proved that\na simplified self-attention layer can \"in-context learn\" the gradient step of a linear\nregression. The authors propose to show the same in the case\nof a softmax regression, which they propose as an intermediate step between\nthe linear regression and the actual operation done by self-attention.\nThe appendix contains empirical results that compare self-attention\nto softmax regression and that corroborate the theoretical findings."
                },
                "soundness": {
                    "value": "2 fair"
                },
                "presentation": {
                    "value": "1 poor"
                },
                "contribution": {
                    "value": "2 fair"
                },
                "strengths": {
                    "value": "1. The problem considered, i.e. a theoretical understanding of\n  in-context learning is significant with the rise of LLMs.\n\n2. The abstract is well-written.\n\n3. The review of previous work positions the paper well and makes clear what are the novel contributions.\n\n4. In the appendix there is an empirical verification that a softmax regression model and a single SA layer are similar on one gradient descent step. The empirical approach seems sound as it follows previous work."
                },
                "weaknesses": {
                    "value": "1. I had quite a bit of trouble reading the paper. I was unable to fill\n  quite a few logical steps that I deem significant. I have left questions\n  regarding them."
                },
                "questions": {
                    "value": "My initial rating inclines towards rejection (with low confidence in my assessment): upon reading the paper I am missing a few logical steps that I deem significant. I have left questions regarding these; if you could clarify them it would greatly help me to improve my assessment of the\npaper.\n\n**Major Questions**:\n  1. Definition 1.3: I miss the motivation for why this would advance\n    the understanding of in-context learning for the Transformer.\n    It seems that the problem solved by Self-Attention would involve the\n    matrix A quadratically in the exponential, while here A appears\n    linearly in the exponential. Could you elaborate on why this intermediate step is useful for analyzing\n    what would happen in the Transformer?\n\n  1. Upon reading the text a few times, I still do not understand why\n    the bounds of **Thm 5.1** and **Thm 5.2**  would imply that the\n    transformation induced by the layer would approximate the gradient step, or if I understood **Oswald et. al** correctly, that at least there is \n    a choice of layer parameters that would make it approximate the gradient step.\n\n**Minor Questions**:\n* (page 2, first equation): I do not  understand why one needs to introduce a generalized attention formulation if the considered problem is quite simplified."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "5: marginally below the acceptance threshold"
                },
                "confidence": {
                    "value": "2: You are willing to defend your assessment, but it is quite likely that you did not understand the central parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                },
                "first_time_reviewer": {
                    "value": "Yes",
                    "readers": [
                        "ICLR.cc/2024/Conference/Program_Chairs",
                        "ICLR.cc/2024/Conference/Submission6804/Senior_Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission6804/Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission6804/Reviewer_ahEK"
                    ]
                }
            },
            "number": 1,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission6804/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698408973973,
            "cdate": 1698408973973,
            "tmdate": 1699636786477,
            "mdate": 1699636786477,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "DWG6nyZAvI",
                "forum": "6uUmpPvqUU",
                "replyto": "YesyecDS90",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6804/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6804/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Rebuttal by Authors"
                    },
                    "comment": {
                        "value": "Thank the reviewer for the feedback. We provide our responses as follows:\n\nResponse to Question 1:\n\nThe motivation behind Definition 1.3 (Softmax Regression) is to bridge the gap between the simple linear models studied in prior work [1] and the more complex softmax-based models used in actual LLMs\u200b\u200b. While in a full Transformer model, matrix 'A' appears quadratically in the exponential, our setting of 'A' in the exponential allows for a tractable analysis while still capturing essential characteristics of the softmax function. This formulation makes our analysis more relevant to actual Transformer models in LLMs than purely linear models, yet more manageable than full quadratic models.\n\n\nResponse to Question 2:\n\nThanks for your careful reading. Let us emphasize the high level idea of our results here. A self-attention layer update can be treated as an update to the tokenized document $A$ [1]. The gradient descent can be treated as an update to the model parameter $x$ here. In the softmax regression loss function, these  two update can be treated as the change of the value $b$ here. Hence, by showing the similarity between the change of $b$, we show the closeness between them. In [1], they show the change of some specified parameters by gradient descent approximate the ability of in-context learning. This does not contradict the results stated in [1] but rather adds a new dimension to understanding the interplay between layer transformations and gradient steps.\n\nResponse to the Minor Question:\n\nOur approach acknowledges the value of simplicity as an initial foundation, drawing from a range of theoretical papers [2,3,4,5]. Starting with a simpler version allows us to build a solid starting point for understanding the broader context. \n\n\n[1] Von Oswald, J., Niklasson, E., Randazzo, E., Sacramento, J., Mordvintsev, A., Zhmoginov, A., & Vladymyrov, M. (2023, July). Transformers learn in-context by gradient descent. In International Conference on Machine Learning (pp. 35151-35174). PMLR.\n\n[2] Alman, Josh, and Zhao Song. \"Fast attention requires bounded entries.\" arXiv preprint arXiv:2302.13214 (2023).\n\n[3] Deng, Yichuan, Sridhar Mahadevan, and Zhao Song. \"Randomized and deterministic attention sparsification algorithms for over-parameterized feature dimension.\" arXiv preprint arXiv:2304.04397 (2023).\n\n[4] Kitaev, Nikita, \u0141ukasz Kaiser, and Anselm Levskaya. \"Reformer: The efficient transformer.\" arXiv preprint arXiv:2001.04451 (2020).\n\n[5] Katharopoulos, Angelos, et al. \"Transformers are rnns: Fast autoregressive transformers with linear attention.\" International conference on machine learning. PMLR, 2020."
                    }
                },
                "number": 4,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6804/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700617359909,
                "cdate": 1700617359909,
                "tmdate": 1700617359909,
                "mdate": 1700617359909,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "PhNIpYmptw",
                "forum": "6uUmpPvqUU",
                "replyto": "DWG6nyZAvI",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6804/Reviewer_ahEK"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6804/Reviewer_ahEK"
                ],
                "content": {
                    "title": {
                        "value": "Reviewer Reply"
                    },
                    "comment": {
                        "value": "Thanks for the reply. I decided to keep my score after reading the other reviews."
                    }
                },
                "number": 6,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6804/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700637599364,
                "cdate": 1700637599364,
                "tmdate": 1700637599364,
                "mdate": 1700637599364,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "J6x8RpBkH4",
            "forum": "6uUmpPvqUU",
            "replyto": "6uUmpPvqUU",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission6804/Reviewer_f4vr"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission6804/Reviewer_f4vr"
            ],
            "content": {
                "summary": {
                    "value": "This work studies the in-context learning based on a softmax regression mostly approaching the vanilla self-attention and gives the upper bounds of the data transformations driven by gradient descent for a single self-attention layer. \nNevertheless, the paper's structure appears to lack the necessary depth to fully elucidate critical findings, such as the significance of their contributions to advancing our understanding of in-context learning beyond existing literature."
                },
                "soundness": {
                    "value": "2 fair"
                },
                "presentation": {
                    "value": "1 poor"
                },
                "contribution": {
                    "value": "2 fair"
                },
                "strengths": {
                    "value": "This work examined the in-context learning process based on a softmax regression, aiming to  illustrating Transformer\u2019s attention mechanism."
                },
                "weaknesses": {
                    "value": "1. The structure appears insufficient to fully elucidate the internal mechanisms of in-context learning relying on a single self-attention layer.\n2. The significance of the findings, such as the upper bounds of data transformation, is somewhat understated, rendering them supplementary to prior research.\n3. Certain mathematical proofs and deductions may benefit from a more concise presentation, potentially relocating them to the appendix, while experimental results could find a more prominent place in the main paper."
                },
                "questions": {
                    "value": "Could you consider reorganizing the paper to enhance its comprehensiveness and clarity? One suggestion is to separate the model definitions and theorems from the introductory section for better clarity."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "5: marginally below the acceptance threshold"
                },
                "confidence": {
                    "value": "2: You are willing to defend your assessment, but it is quite likely that you did not understand the central parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                },
                "first_time_reviewer": {
                    "value": "Yes",
                    "readers": [
                        "ICLR.cc/2024/Conference/Program_Chairs",
                        "ICLR.cc/2024/Conference/Submission6804/Senior_Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission6804/Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission6804/Reviewer_f4vr"
                    ]
                }
            },
            "number": 2,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission6804/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698714443727,
            "cdate": 1698714443727,
            "tmdate": 1699636786363,
            "mdate": 1699636786363,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "inqqGoCXCt",
                "forum": "6uUmpPvqUU",
                "replyto": "J6x8RpBkH4",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6804/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6804/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Rebuttal by Authors"
                    },
                    "comment": {
                        "value": "Thank the reviewer for the feedback. We provide our responses as follows:\n\nResponse to Weakness 1:\n\nWe would like to clarify that our approach follows previous work [1]\u200b\u200b to study in-context learning in the simplified setting of a single self-attention layer, which allows for a more controlled analysis and clearer insights. Importantly, our work goes a step further by incorporating the crucial softmax unit, a component that was further simplified for the linear setting in the previous work. This inclusion is significant as the softmax unit is integral to the functioning of LLMs, particularly in the context of natural language processing tasks. We believe that this approach, while simplified, provides valuable insights into the in-context learning mechanisms of LLMs and lays the groundwork for more complex analyses in the future.\n\nResponse to Weakness 2:\n\nWe appreciate the feedback and will take steps to highlight the importance and novelty of these findings more clearly in our revised manuscript. Our work provides a significant extension to the existing body of research, and we aim to ensure that this is adequately reflected and understood by our readers.\n\nResponse to Weakness 3 and Question 1:\n\nThanks for the feedback on the presentation of the paper. We will definitely consider your suggestions to improve the clarity and flow of the paper, allowing readers to more easily grasp the theoretical framework before delving into the specific results and their implications.\n\n[1] Von Oswald, J., Niklasson, E., Randazzo, E., Sacramento, J., Mordvintsev, A., Zhmoginov, A., & Vladymyrov, M. (2023, July). Transformers learn in-context by gradient descent. In International Conference on Machine Learning (pp. 35151-35174). PMLR."
                    }
                },
                "number": 3,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6804/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700617264075,
                "cdate": 1700617264075,
                "tmdate": 1700617264075,
                "mdate": 1700617264075,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "WxFgQsSoUa",
                "forum": "6uUmpPvqUU",
                "replyto": "inqqGoCXCt",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6804/Reviewer_f4vr"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6804/Reviewer_f4vr"
                ],
                "content": {
                    "comment": {
                        "value": "Thanks very much for your reply!"
                    }
                },
                "number": 5,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6804/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700634604844,
                "cdate": 1700634604844,
                "tmdate": 1700634604844,
                "mdate": 1700634604844,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "u4p1xHqz34",
            "forum": "6uUmpPvqUU",
            "replyto": "6uUmpPvqUU",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission6804/Reviewer_QA3Q"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission6804/Reviewer_QA3Q"
            ],
            "content": {
                "summary": {
                    "value": "This paper is about clarifying the relationship between in-context learning in LLMs and weight shifting for softmax regression.\nThe paper tries to understand in-context learning of Transformer models, specifically self-attention, in the perspective of softmax regression.\nThe optimization of the attention module could be seen as the following softmax regression problem: $\\min_{X \\in \\mathbb{R}^{d\\times d}} \\lVert D^{-1} \\exp ( AXA^\\top ) -B \\rVert_F $ where $A \\in \\mathbb{R}^{n \\times d}$ is a matrix for document having length $n$ and embedding size $d$, $X$ a weight matrix, and $B$ the target distribution for the probabilities resulting from softmax.\nBeyond prior work that simplified the above definition by $\\min_x \\lVert Ax - b \\rVert_2 $ s.t. $A \\in \\mathbb{R}^{n\\times d}, b \\in \\mathbb{R}^n $, it uses the following more formulation which is proposed in Deng et al. (2023b) and argued to be more close to the definition: $ \\min_{x \\in \\mathbb{R}^d} \\lVert \\langle \\exp(Ax), \\mathbf{1}_n \\rangle^{-1} \\exp(Ax) - b \\rVert_2. $\n\nFrom the above formulation, the loss function following Deng et al. (2023b), which can further be simplified by the shorthand form $ L_{\\exp}(x) = 0.5 \\lVert c(x) \\rVert_2^2 $ where $ c(x):=f(x)-b, f(x)=\\alpha(x)^{-1} \\exp(Ax), \\alpha(x):=\\langle \\exp(Ax), \\mathbf{1}_n \\rangle. $\n\nThen, Lipschitz bounds for $ \\lVert f(x_{t+1}) - f(x_t) \\rVert_2 $ and $ \\lVert f(A_{t+1}) - f(A_t) \\rVert_2 $ are used to bound\n$ \\lVert \\tilde{b} - b \\rVert_2 $ with respect to  $ \\lVert f(A_{t+1}) - f(A_t) \\rVert_2, $ which reveals the relationship between softmax weight shifting and in-context learning."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "2 fair"
                },
                "contribution": {
                    "value": "2 fair"
                },
                "strengths": {
                    "value": "- Rich explanation on preliminaries\n- Mathematical notations are defined thoroughly"
                },
                "weaknesses": {
                    "value": "- More comparison with the work from Deng et al. (2023b) is needed, which seemingly to be the work most closely related to this work.\n- It is hard to distinguish this work's contribution and other prior work's contribution. For example, some important definitions and theorems are already proven in Deng et al. (2023b). I believe this could be made more clear.\n- Organization of the content is preferred to be more focused on what to be proven. i.e. \"why bounding the single step of $x$ and $A$ relates to clarifying the relationship between in-context learning and softmax weight shift.\n\nTypo:\nLipschtiz \u2192 Lipschitz"
                },
                "questions": {
                    "value": "- See above"
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "5: marginally below the acceptance threshold"
                },
                "confidence": {
                    "value": "2: You are willing to defend your assessment, but it is quite likely that you did not understand the central parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                },
                "first_time_reviewer": {
                    "value": "Yes",
                    "readers": [
                        "ICLR.cc/2024/Conference/Program_Chairs",
                        "ICLR.cc/2024/Conference/Submission6804/Senior_Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission6804/Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission6804/Reviewer_QA3Q"
                    ]
                }
            },
            "number": 3,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission6804/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698809862755,
            "cdate": 1698809862755,
            "tmdate": 1699636786252,
            "mdate": 1699636786252,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "sc4bPLbel6",
                "forum": "6uUmpPvqUU",
                "replyto": "u4p1xHqz34",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6804/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6804/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Rebuttal by Authors"
                    },
                    "comment": {
                        "value": "Thank the reviewer for the feedback. We provide our responses as follows.\n\nResponse to Weakness 1:\n\nWe believe our contributions are distinct and significant compared to Deng et al. (2023b). Concretely, Deng et al. (2023b) focuses primarily on softmax regression in a broader context, whereas our work specifically studies the in-context learning capabilities of transformer-based large language models from a softmax regression perspective. Our main results in Section 5, including the Lipschitz bounds and the bounded shift for in-context learning (Theorems 5.1 and 5.2)\u200b\u200b, are unique contributions that extend beyond the scope of Deng et al. (2023b). We will add a more detailed comparison in the revised paper to clarify these differences.\n\nResponse to Weakness 2:\n\nOur paper builds upon the understanding of in-context learning in LLMs, specifically addressing how the self-attention computation with the softmax unit impacts this learning process. We have established bounds on data transformations in the transformer architecture, which was not explicitly covered by Deng et al. (2023b). Moreover, our experimental validation supports our theoretical findings, further distinguishing our work. We will emphasize these points more clearly in the revised manuscript to highlight our unique contributions.\n\nResponse to Weakness 3:\n\nWe appreciate the feedback on the organization of our paper. In the revision, we will restructure the content to focus more on our primary contributions.\n\nThank you for pointing out the typo. We will correct \"Lipschtiz\" to \"Lipschitz\" in the revised paper."
                    }
                },
                "number": 2,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6804/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700617221959,
                "cdate": 1700617221959,
                "tmdate": 1700617221959,
                "mdate": 1700617221959,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    }
]