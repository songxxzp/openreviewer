[
    {
        "title": "Self-Distilled Disentanglement for Counterfactual Prediction"
    },
    {
        "review": {
            "id": "H9y9tJuIgR",
            "forum": "L0b0vryZRX",
            "replyto": "L0b0vryZRX",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission209/Reviewer_YeKP"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission209/Reviewer_YeKP"
            ],
            "content": {
                "summary": {
                    "value": "This paper proposes two novel theorems (Theorems 4.1 & 4.2) to disentangle the representations of instrumental variables, confounders, and adjustable variables from pre-treatment variables and bypass MI estimation between high-dimensional representations from the perspective of information theory."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "3 good"
                },
                "strengths": {
                    "value": "- This paper considers an important problem in causal inference and proposes two novel theorems to disentangle the representations of instrumental variables, confounders, and adjustable variables from pre-treatment variables. The results demonstrate the effectiveness of the proposed algorithm.\n\n- This paper provides a comprehensive review of the literature on counterfactual prediction and disentangled representation learning. The paper is well-organized."
                },
                "weaknesses": {
                    "value": "Incorrect Definiton about $I(A; B \\mid C)$, which should not denote conditional mutual information. If $I(Z ; Y\\mid T)$ represents conditional mutual information, then in Eqs. (2,3,4), it is evident that the conditional mutual information $I(Z ; Y \\mid T) \u2260 0$, as the open of the collider structure $Z \u2192 T \u2190 \\\\{C, U\\\\}$ will make $Z$ dependent on $\\\\{C, U\\\\}$ when $T$ is fixed as a condition, which consequently results in the dependence of Z and $Y$ through $\\\\{C, U\\\\}$. Then the authors use the conditional mutual information in the chain rule of mutual information again. The authors should clarify this point and differentiate the definition $I(Z ; Y \\mid T)$ in Eqs. (2,3,4) from the definition of conditional mutual information. The relevant content may need to be restated."
                },
                "questions": {
                    "value": "- Is it necessary to use a shallow network for $Q^z_T$ and $Q^c_T$? Why not use a network of the same size as the reference network?\n\n- The optimization directions of the losses $L\\left(Q_T^z, T\\right) + L\\left(Q_T^c, T\\right)$ and $L\\left(Q_T^c, Q_T^z\\right)$ may be different or conflicting because the former aims to maximize the predictive abilities of $z$ and $c$ on $T$ (the predictive abilities of $c$ and $z$ on $T$ are different), while the latter actually implies forcing a better-performing model to reduce its predictive abilities. This can be achieved by modifying either the predictive network or the representation network. In essence, it is a non-zero-sum game problem. Only when all three are equal to 0 does it mean that $D[\\mathcal{P}_T^{R_z} \\| \\mathcal{P}_T^{R_c}]=0$. \nOtherwise, minimizing the loss of self-distilled disentanglement does not necessarily mean minimizing $D[\\mathcal{P}_T^{R_z} \\| \\mathcal{P}_T^{R_c}]$. I am not sure if I have missed any important parts, but it clearly requires further clarification. Additionally, the Teacher network only aims at enhancing information prediction abilities and does not seem to be the focus of this paper? I will adjust my scores based on the author's response."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "6: marginally above the acceptance threshold"
                },
                "confidence": {
                    "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 1,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission209/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698486809227,
            "cdate": 1698486809227,
            "tmdate": 1699635946399,
            "mdate": 1699635946399,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "lWt25C0VJA",
                "forum": "L0b0vryZRX",
                "replyto": "H9y9tJuIgR",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission209/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission209/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Response to Weaknesses and Questions"
                    },
                    "comment": {
                        "value": "**Weaknesses - Response:**\n\nFirstly, we acknowledge there is an issue with the interpretation of the disentanglement process for variable Z within the context of the associated loss function in Formula 4. Our initial concept was grounded in the understanding that when using the treatment label T as the feature to predict outcome Y, the information in Z might become redundant. Therefore, we sought to disentangle Z from X by minimizing the KL-divergence between the predicted distribution of Y conditioned on both Rz and T, and the predicted distribution of Y conditioned solely on T, i.e., ${D}_{KL}\\left[ p(Y \\mid {Z},{T}) \\Vert p(Y \\mid T) \\right]$. This served as the motivation for the design of the loss function used in subsequent experiments, and empirical studies have demonstrated its effectiveness. However, we recognize the inadequacy of the previous explanation. Therefore, in the updated version, we have removed the misleading description of the conditional mutual information $I (Z; Y|T)$. We appreciate your insightful feedback!\n\n**Questions - Response:**\n\n- **The Necessity of the Shallow Network:** A shallow network design for Z and C is necessary. As shown in Equation 11, we aim to directly obtain the predicted distribution of T based on Z and C, facilitating the disentanglement of C. This predicted distribution is precisely achieved by designing two shallow networks for Z and C. The retain network consolidates shared information from Z and C, and therefore, it should incorporate more parameters. A deep network is subsequently introduced to output predictions. This is the rationale behind our design of different shallow and deep networks.\n\n- **Clarification on the Loss Function:** We didn't specify whether it's a zero-sum or non-zero-sum problem. In theory, to minimize the mutual information between $R_z$ and $R_c$, we theoretically only need to minimize either $D_{KL}[P^{R_z}\\_{T}|P_T]$ or $D_{KL}[P^{R_c}\\_{T}| P_T]$ (we elaborate on choosing $D_{KL}[P^{R_z}\\_{T}|P_T]$ for clarity) and $D_{KL}[P^{R_z}\\_{T}|P ^{R_c}\\_T]$. The corresponding loss functions are $L (Q^Z\\_T, T)$ and $L (Q^Z\\_T, Q^C\\_T)$. However, in practice, including only these two components in the model loss makes convergence challenging, resulting in unsatisfactory performance. We speculate that this is due to a lack of sufficient supervised information guiding the updating direction of the prediction network for $R_c$. Therefore, we introduce the minimization of $D_{KL}[P^{R_c}\\_{T}| P_T]$ (corresponding loss function $L (Q^C_T, T)$) to expedite loss convergence. Empirical results indicate that this loss function design improves disentanglement and counterfactual prediction performance, suggesting that, while not precise, it helps the model approach the optimum more quickly. We acknowledge that the original theoretical statements were not rigorous and have modified formulas 10 and 11 in section 4.2, further explaining loss functions in Section 4.3 in the updated version. \n\n    Your understanding of the teacher network is correct. We can set up a deep prediction network and and use its supervision information to train the shallow prediction models. From this perspective, our approach is essentially a self-distillation model and that\u2019s why we name our method as **S**elf-**D**istilled **D**isentanglement, i.e., $SD^2$.  Therefore, the teacher model is utilized to enhance the network's prediction capability, thereby facilitating the distillation and disentanglement process."
                    }
                },
                "number": 6,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission209/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700485265250,
                "cdate": 1700485265250,
                "tmdate": 1700485265250,
                "mdate": 1700485265250,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "BlsLHQhnnV",
                "forum": "L0b0vryZRX",
                "replyto": "lWt25C0VJA",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission209/Reviewer_YeKP"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission209/Reviewer_YeKP"
                ],
                "content": {
                    "comment": {
                        "value": "I appreciate the author's response, and I intend to maintain my score as is. The score for this paper is marginally above the acceptance threshold. The paper introduces two interesting theorems (Theorems 4.1 and 4.2) aimed at identifying the representations of instrumental variables, confounders, and adjustable variables from pre-treatment variables.\n\nThis work represents a commendable attempt in the field of causal disentanglement. However, the transition from theory to methodology in this paper seems not very smooth. Following the author's response, I agree that using self-distillation networks might provide a more promising estimation framework. But, the neural framework's depth in this paper, consisting of only 2 or 3 layers in prediction networks (Tables 7 & 8), appears limited. In such instances, would employing a shallower network as students to retain the model be beneficial?\n\nGiven that the neural framework used in the experimental section of this paper is not originally deep (with only 2/3 layers), is it necessary to employ an even shallower network in this scenario?"
                    }
                },
                "number": 7,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission209/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700566364744,
                "cdate": 1700566364744,
                "tmdate": 1700566364744,
                "mdate": 1700566364744,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "3UpXIQtJHl",
            "forum": "L0b0vryZRX",
            "replyto": "L0b0vryZRX",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission209/Reviewer_wJ78"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission209/Reviewer_wJ78"
            ],
            "content": {
                "summary": {
                    "value": "This paper addresses the task of disentangling the underlying factors of observational datasets in causal inference. The paper proposes a novel disentanglement method that is capable of dissecting instrumental variables and confounders. The authors provide theoretical guarantees for their solution. They also evaluate their proposed method by conducting extensive experiments and show empirically that it outperforms SOTA."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "4 excellent"
                },
                "contribution": {
                    "value": "3 good"
                },
                "strengths": {
                    "value": "- The ideas in the paper are presented clearly; it\u2019s an easy paper to read and follow.\n- The paper provides a good coverage of the related literature and clearly points out its contribution to the research area.\n- Great use of probabilistic graphical models to clearly motivate the proposed solution.\n- The idea of using mutual information to address disentanglement, as well as handling its challenges is interesting.\n- The experiments are extensive and cover a wide range of scenarios."
                },
                "weaknesses": {
                    "value": "- Some captions are not descriptive enough of the contents of the figures. E.g., Fig. 1(b) and (c).\n- Use of inline equations should be avoided if possible.\n- It\u2019s best to state each finding in a separate bullet-point.\n- When referring to the appendix, it\u2019s best to also indicate its section number, to make it easier to find."
                },
                "questions": {
                    "value": "- I\u2019m not quite sure about the method\u2019s name, specifically, what is being \u201cdistilled\u201d here? Is this referring to dissected factors from X?\n- What is being measured in the radar charts in Figure 3(b)? The caption states it shows \u201cthe contribution of actual and other variables to the decomposed representations\u201d; how is this measured?\n- It is stated in the paper that \u201cthe IV-based methods perform worse than the non-IV-based ones under the continuous scenario\u201d but no reference or discussion is included. Please elaborate why."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "8: accept, good paper"
                },
                "confidence": {
                    "value": "5: You are absolutely certain about your assessment. You are very familiar with the related work and checked the math/other details carefully."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 2,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission209/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698639334011,
            "cdate": 1698639334011,
            "tmdate": 1699635946328,
            "mdate": 1699635946328,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "IOpXYFmNE3",
                "forum": "L0b0vryZRX",
                "replyto": "3UpXIQtJHl",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission209/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission209/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Response to Weaknesses and Questions"
                    },
                    "comment": {
                        "value": "**Weaknesses - Response:**\n\nThank you for your advice. We have incorporated your suggestions into the updated version of the paper by adding more captions for Figure 1, transcribing all inline equations into display equations, breaking down the findings into separate bullet points and stating specifying the section numbers in the appendix when referenced, aiming to improve the paper's readability.  \n\n**Questions - Response:**\n\n- **Method's name:** Here, \"distillation\" refers to a framework design that utilizes deep classifiers (for binary scenarios) or regressors (for continuous scenarios) to guide shallow ones in knowledge extraction, thereby promoting disentanglement performance.\n\n    Technically, the optimization of equation (8a, 8b, 9a, 9b) can be realized by training prediction networks about $Y$. Additionally, we can set up a deep prediction network from $T$, $A$, $C$ to $Y$ and use its supervision information to train the shallow prediction models. From this perspective, our approach is essentially a self-distillation model. Therefore, we name our method as **S**elf-**D**istilled **D**isentanglement, i.e., $SD^2$.\n\n- **Metrics in radar charts:** Following [2] and [3], we use the first (second) slice to denote the weight matrix that connects the variables in X belonging (not belonging) to the actual variables. The polygons\u2019 radii in Figure 3b are scaled between 0: 0.09 and quantify the average weights of the first slice (in red) and the second slice (in blue). For better readability, we have added the description for this metric in Section 5.3.2. Thanks for the question.\n\n- **Discussion under the continuous scenario:** This outcome highlights the significant issue of confounding bias stemming from the treatment regression stage in IV-based methods. It emphasizes the essential need to disentangle confounding factors ($C$) from observed variables ($X$) and subsequently address confounding bias led by $C$. We appreciate your question, and we have integrated this discussion into the updated version.\n\n[2]. Negar Hassanpour and Russell Greiner. Learning disentangled representations for counterfactual regression. In International Conference on Learning Representations, 2019.\n\n[3]. Learning decomposed representation for counterfactual inference. arXiv preprint arXiv:2006.07040, 2020."
                    }
                },
                "number": 5,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission209/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700480556585,
                "cdate": 1700480556585,
                "tmdate": 1700480556585,
                "mdate": 1700480556585,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "0ZlHyvdxjF",
            "forum": "L0b0vryZRX",
            "replyto": "L0b0vryZRX",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission209/Reviewer_pgv6"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission209/Reviewer_pgv6"
            ],
            "content": {
                "summary": {
                    "value": "This paper proposes a method for representation learning for causal inference building on an existing disentanglement-based approach, by giving a method for optimizing the mutual information between two components of the representation without engaging in an intractible high-dimensional mutual information estimation problem. The authors discuss how to do this optimization by MI estimation with distillation problems and prove equivalencies in optimization problems. Empirically, they demonstrate that their method is better able to estimate ATEs, and through ablations show that their disentanglement is successful and that there is an advantage to avoiding the MI estimation step with their method."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "2 fair"
                },
                "contribution": {
                    "value": "3 good"
                },
                "strengths": {
                    "value": "- nice empirical results, showing a good win for their more flexible method as well as disentanglement results in controlled settings\n- seems like some clever methods for avoiding problematic MI estimation\n- draws good connections between deep learning approaches and causal formulations"
                },
                "weaknesses": {
                    "value": "My main issue with this paper is around clarity - I don't quite follow the novel/interesting parts, specifically through Sec 4. I think a lot of extra care could be taken rewriting here and could result in a nice paper. Specifically:\n- Eq 3: both parts confuse me. On the left: it seems like the constraint I(Z; Y | T) = 0 contradicts the statement from the bottom of p3 about this inducing dependence through a collider. on the right: I'm not sure where this inequality constraint comes from, or why it's necessary\n- Eq 4: this notation is confusing to me: I'm not clear on what variable is being minimized here. I think this could benefit from extra clarity spelling this out. Additionally, isn't I(Z, Y | T) a constant? should this be R_z? what precisely is the difference?\n- What does it precisely mean to say that \"the mutual information between R_a and R_c is all related to Y during the training phase\"? And how would this be ensured by setting up prediction models that go out of R?\n- Corollary 4.3: I don't understand this notation (10a-c, 11a-c)- does this mean minimizing all 3? minimizing the smallest? Again, I think clearer notation could be used around statements around optimization\n- Sec 4.2: I don't follow a lot of these architectural choices: I think the \"retain network\" and \"teacher networks\" could have their roles explained more, as well as the relationship between the deep and shallow networks.\n- Eq 12: a lot of this notation seems a little messy and leaves me uncertain: is W defined anywhere? the sampling weights w, and hyperparameters \\alpha and \\beta all look like global scalars in L_SD2, but I know that w should be w_i (example-wise weights), and so I'm not sure about \\alpha and \\beta - again these aren't defined anywhere\n- what is the metric in 3b representing \"contribution of actual variables?\"\n\n\nSmaller notes:\n- top of p5: you say A is independent of C and Z - do you mean here that C is independent of A and Z? that seems to align more closely with the topic of the paragraph.\n- I find the notation mk, mz, etc. to be confusing - these look like products to me rather than single variables. Maybe consider using m_k etc.\n- it would be good to see more information on the contrast between your method and DRCFR"
                },
                "questions": {
                    "value": "- is there an implicit assumption in this method that T, Y are causally downstream of X? what other assumptions are required for this method to work well?"
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "3: reject, not good enough"
                },
                "confidence": {
                    "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 3,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission209/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698785391387,
            "cdate": 1698785391387,
            "tmdate": 1699635946257,
            "mdate": 1699635946257,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "d3KevAMYge",
                "forum": "L0b0vryZRX",
                "replyto": "0ZlHyvdxjF",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission209/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission209/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Response to Weaknesses and Questions"
                    },
                    "comment": {
                        "value": "**Weaknesses-Response:**\n\n- Eq 3: Firstly, we acknowledge there is an issue with the interpretation of the disentanglement process for variable Z within the context of the associated loss function in Formula 4. Our initial concept was grounded in the understanding that when using the treatment label T as the feature to predict outcome Y, the information in Z might become redundant. Therefore, we sought to disentangle Z from X by minimizing the KL-divergence between the predicted distribution of Y conditioned on both Rz and T, and the predicted distribution of Y conditioned solely on T, i.e., ${D}_{KL}\\left[ p(Y \\mid {Z},{T}) \\Vert p(Y \\mid T) \\right]$. This served as the motivation for the design of the loss function used in subsequent experiments, and empirical studies have demonstrated its effectiveness. However, we recognize the inadequacy of the previous explanation. Therefore, in the updated version, we have removed the misleading description of the conditional mutual information $I (Z; Y|T)$. We appreciate your insightful feedback!\n\n- Eq 4: In equation (4), we aim to minimize the KL-divergence between the predicted distribution of Y from $R_z$, T and the predicted distribution of Y from T, i.e., ${D}_{KL}\\left[ p(Y \\mid {Z},{T}) \\Vert p(Y \\mid T) \\right]=-\\int p(Y \\mid {Z},{T})log \\frac{p(Y \\mid {Z},{T})}{p(Y \\mid T)} dY$. In the revised version, we have removed the relevant statements about $I (Z; Y | T)$. The reasons are detailed in the response to Q1.\n\n- During the training phase, to obtain reasonable representations for C and A, we set up two separate prediction networks from R_c and R_a to Y, which means we use Y as supervisory information to guide the training process of R_c and R_a. This is the only information shared between R_c and R_a during the training process. Therefore, the mutual information between R_a and R_c is all related to Y, and the information contained in Ra that is related to Rc but unrelated to Y is 0 at this stage.\n\n- Corollary 4.3: Thanks for your advice. Here, the notation used in Equation 10 and 11 refers to minimizing all three KL-Divergence together, and we have added related statements in Corollary 4.3 based on your and Reviewer Yekp\u2019s suggestions for better clarity.\n\n- Sec 4.2: We acknowledge that the definitions for these networks need to be sufficiently clear. Below is a brief explanation of these modules, which we have updated in Sec 4.2. **\u201cRetain network\u201d** here represents the neural network for retaining the information from both Z and C. **\u201cDeep networks\u201d** and **\u201cShallow networks\u201d** are named based on their relative proximity to $R_a$ and $R_c$. Essentially, both are classifiers (for binary scenarios) or regressors (for continuous scenarios).\n\n- Eq. 12: Thank you for your correction. $W$ represents the model weight parameters involved in the $L_2$ regularization loss. As you comprehend, $\\alpha, \\beta, \\gamma$ are global scalars, and $w$ should be example-wise weights. Thus, we modify Eq. 12 in the revised version.\n\n- Metric for \u201ccontribution of actual variables\u201d: Following [2] and [3], we use the first(second) slice to denote the weight matrix that connects the variables in X belonging (not belonging) to the actual variables. The polygons\u2019 radii in Figure 3b are scaled between 0: 0.09 and quantify the average weights of the first slice (in red) and the second slice (in blue). For better readability, we have added the description for this metric in Section 5.3.2.\n\n- top of p5: Thank you for pointing out our mistakes. The correct statement is, indeed, \"C is independent of A and Z.\" We have corrected this statement in the new version.\n\n- Maybe consider using m_k etc: Thank you for your suggestion. We have made corrections based on your advice.\n\n- More information of DRCFR: Thank you for your suggestion. We have added relevant statement \u201c a baseline that ensures the disentanglement of A by proposing Prop 3.1, yet does not provide disentangling solutions for Z and C\u201d in Section 5.3.2 in the new version.\n\n\n**Questions - Response:**\n\nYour understanding is correct. As illustrated in Figure 1, T and Y are causally downstream components of different underlying factors in X in the context of our study.\n\nWe share the same assumptions for identifying the treatment effects with [1]. Specifically, suppose the generated IVs satisfy three conditions (Relevance, Exclusion, Unconfoundedness) of valid IVs, additional assumptions are necessary to identify the average causal effect (ACE) of T on Y. Adequate assumptions encompass homogeneity in the causal impact of T on Y, uniformity in the relationship between Z and T, and the absence of effect modification. On the basis of [1], we did not introduce additional conditions for identifiability, as our primary contribution lies in designing an algorithm to identify instrumental variables that satisfy the given conditions. We have also incorporated the description regarding identifiability into Section 3 of the revised paper."
                    }
                },
                "number": 3,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission209/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700478596250,
                "cdate": 1700478596250,
                "tmdate": 1700486666982,
                "mdate": 1700486666982,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "eLubiUmZ8m",
                "forum": "L0b0vryZRX",
                "replyto": "O1UPqnQqxE",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission209/Reviewer_pgv6"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission209/Reviewer_pgv6"
                ],
                "content": {
                    "title": {
                        "value": "Response"
                    },
                    "comment": {
                        "value": "Thanks for the clarifications. I'll consider raising my score in conversation with other reviewers."
                    }
                },
                "number": 11,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission209/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700663723374,
                "cdate": 1700663723374,
                "tmdate": 1700663723374,
                "mdate": 1700663723374,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "DApAO7ncx7",
            "forum": "L0b0vryZRX",
            "replyto": "L0b0vryZRX",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission209/Reviewer_FUp5"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission209/Reviewer_FUp5"
            ],
            "content": {
                "summary": {
                    "value": "This paper aims to develop an estimator that estimates causal effects in the presence of unobserved confounding while avoid the need to explicitly assume knowledge of an instrumental variable. Instead, they aim to disentangle instruments from confounders and then estimate the effects. They derive an information theoretic approach to separating instruments from confounders and find that it give strong performance on the benchmarks that they tested."
                },
                "soundness": {
                    "value": "1 poor"
                },
                "presentation": {
                    "value": "2 fair"
                },
                "contribution": {
                    "value": "2 fair"
                },
                "strengths": {
                    "value": "* I really like the idea of finding ways to go beyond assuming access to IVs to address unobserved confounding.\n * The method offers strong performance on benchmark datasets.\n * The method makes no distributional assumptions, so if correct, this would make it far more general than anything that has come before it... unfortunately I don't think that it is correct (see counter examples below)"
                },
                "weaknesses": {
                    "value": "The method works by minimizing the conditional mutual information between instruments and response given the treatment, $I(Z;Y | T)$, under the claim that the *exclusion* assumption implies that $I(Z;Y | T) = 0$. Unfortunately, this claim is incorrect, because it ignores that conditioning on $T$ opens a collider between $Z$ and $Y$ via $U$ (also via $C$, but the authors are aware of this). Here is an explicit counter example showing that the mutual information is not zero in general:\n\n$ U \\sim Bern(0.5 )$\n\n$ Z \\sim Bern(0.5 )$\n\n$T = XOR(Z, U)$\n\n$Y = XOR(T,U)$\n\nwhere $XOR$ is the exclusive or function that evaluates to 1 if either argument is 1 but not both. Notice, that $H(Y | T)$ is just 1, since all the randomness in $Y$ comes from $U$ which has entropy $1$ by construction. More importantly, if you work through all the possible outcomes of the above system, you will see that, conditional on $T$, $Z$ is always equal to $Y$ (i.e. $H(Y | T, Z) = 0$), but that they are conditionally independent when you condition on both $T$ and $U$. For example, if $T = 1$, then when $z=0$ we know $U=1$ (since otherwise $T$ would not be 1), and hence $Y = XOR(1, 1) = 0 = z$. \n\nThis is an extreme example, but it highlights that the claim is surely not true in general. Also - the authors make no assumptions on the functional form of the structural equation that determines $Y$, and we know from the LATE (local average treatment effects) framework and Pearl's work on bounding treatment effects, that it is impossible to non parametrically identify the treatment effect with access to an instrument. So there are surely more necessary assumptions for the method to work in general.\n\nThe simulation results are very strong, so I don't know whether there is just a missing assumption and the method works under additional assumptions, or if there are mistakes in the simulations too."
                },
                "questions": {
                    "value": "Can you give sufficient conditions under which this method identifies the treatment effect?"
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "3: reject, not good enough"
                },
                "confidence": {
                    "value": "2: You are willing to defend your assessment, but it is quite likely that you did not understand the central parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 4,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission209/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1699160733850,
            "cdate": 1699160733850,
            "tmdate": 1699635946174,
            "mdate": 1699635946174,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "mv3WUttUEz",
                "forum": "L0b0vryZRX",
                "replyto": "DApAO7ncx7",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission209/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission209/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Response to Weaknesses and Questions"
                    },
                    "comment": {
                        "value": "**Weaknesses-Response:**\n\nFirstly, we acknowledge there is an issue with the interpretation of the disentanglement process for variable Z within the context of the associated loss function in Formula 4. Our initial concept was grounded in the understanding that when using the treatment label T as the feature to predict outcome Y, the information in Z might become redundant. Therefore, we sought to disentangle Z from X by minimizing the KL-divergence between the predicted distribution of Y conditioned on both Rz and T, and the predicted distribution of Y conditioned solely on T. This served as the motivation for the design of the loss function used in subsequent experiments, and empirical studies have demonstrated its effectiveness. However, we recognize the inadequacy of the previous explanation. Therefore, in the updated version, we have removed the misleading description of the conditional mutual information $I (Z; Y|T)$. We appreciate your insightful feedback!\n\n**Questions-Response:**\n\nWe share the same assumptions for identifying the treatment effects with [1]. Specifically, suppose the generated IVs satisfy three conditions (Relevance, Exclusion, Unconfoundedness) of valid IVs, additional assumptions are necessary to identify the average causal effect (ACE) of T on Y. Adequate assumptions encompass homogeneity in the causal impact of T on Y, uniformity in the relationship between Z and T, and the absence of effect modification. On the basis of [1], we did not introduce additional conditions for identifiability, as our primary contribution lies in designing an algorithm to identify instrumental variables that satisfy the given conditions. We have also incorporated the description regarding identifiability into Section 3 of the revised paper.\n\n[1]. Fernando Pires Hartwig, Linbo Wang, George Davey Smith, and Neil Martin Davies. Average causal effect estimation via instrumental variables: the no simultaneous heterogeneity assumption. Epidemiology, 34(3):325\u2013332, 2023."
                    }
                },
                "number": 2,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission209/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700466432261,
                "cdate": 1700466432261,
                "tmdate": 1700466432261,
                "mdate": 1700466432261,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "HAc6bKEcz4",
                "forum": "L0b0vryZRX",
                "replyto": "mv3WUttUEz",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission209/Reviewer_FUp5"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission209/Reviewer_FUp5"
                ],
                "content": {
                    "comment": {
                        "value": "Hartwig et al [2023] assume knowledge of which variable is the instrument. Without that knowledge, their results do not apply - and you are assuming that you do not know which variable in $X$ is the instrument. You can only apply Hartwig et al's assumptions if your method successfully identifies the instrument and as I showed in the counter example, your method will not recover the instrument in general. So you need additional assumptions that explain when it will succeed."
                    }
                },
                "number": 8,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission209/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700580909515,
                "cdate": 1700580909515,
                "tmdate": 1700580909515,
                "mdate": 1700580909515,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "JzCWEyBVYs",
                "forum": "L0b0vryZRX",
                "replyto": "DApAO7ncx7",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission209/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission209/Authors"
                ],
                "content": {
                    "comment": {
                        "value": "Thanks for your comment! To ensure the disentanglement of Z, we minimize the KL-divergence between the predicted distribution of Y conditioned on both Rz and T, and the predicted distribution of Y conditioned solely on T, i.e., ${D}_{KL}\\left [ p (Y \\mid {Z}, {T}) \\Vert p (Y \\mid T) \\right] $. Our initial concept was grounded in the understanding that when using the treatment label T as the feature to predict outcome Y, the information in Z might become redundant. In addition, we set up the representation network of Z and make it align with the causal structure depicted in Figure 1(a) to ensure the generated IVs satisfy three conditions of valid IVs. Identifiability of disentangled representation is challenging, but empirical progress has been made in this direction, for example, [2]. Our method further advances the disentanglement performance. The experimental results in the main paper, Appendix validate the effectiveness of our generated IVs. Thus, following [1], the only assumption in our work is that we can recover the valid IVs from observed features.\n\n[1] Louizos, C.; Shalit, U.; Mooij, J. M.; Sontag, D.; Zemel, R.; and Welling, M. 2017. Causal effect inference with deep\nlatent-variable models. Advances in neural information processing systems, 30.\n\n[2] Wu, A.; Kuang, K.; Xiong, R.; Zhu, M.; Liu, Y.; Li, B.; Liu, F.; Wang, Z.; and Wu, F. 2023. Learning Instrumental\nVariable from Data Fusion for Treatment Effect Estimation. In Proceedings of the AAAI Conference on Artificial Intelligence, volume 37, 10324\u201310332."
                    }
                },
                "number": 9,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission209/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700636636876,
                "cdate": 1700636636876,
                "tmdate": 1700636676595,
                "mdate": 1700636676595,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    }
]