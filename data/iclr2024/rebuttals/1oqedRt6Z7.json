[
    {
        "title": "Convolutional Deep Kernel Machines"
    },
    {
        "review": {
            "id": "Qe1oh86SDh",
            "forum": "1oqedRt6Z7",
            "replyto": "1oqedRt6Z7",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission5645/Reviewer_jw8S"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission5645/Reviewer_jw8S"
            ],
            "content": {
                "summary": {
                    "value": "The paper proposes convolutional deep kernel machines (DKMs) which builds upon a previous work of DKM while considers only settings with small-scale and low-dimensional data. The authors first introduce how DKM parameterizes the intermediate kernel matrices in NNGP limit by modifying the objective function. The convolutional DKM is then constructed by incorporating convolutional structure into the kernel function with Gaussian prior on the filter weights. To reduce its computational complexity, the authors leverage the idea of inducing point approach by eliminating spatial structure in inducing points while keeping spatial structure in the remaining data points. The proposed model is tested on several benchmark computer vision datasets with different sets of structures and hyperparameters and compared to other kernel-based models."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "4 excellent"
                },
                "contribution": {
                    "value": "3 good"
                },
                "strengths": {
                    "value": "\u2022\tTo my knowledge, the proposed inter-domain inducing point approach seems to be novel and work well in the given context.\n\n\u2022\tThe authors conduct a comprehensive study of different architectures and hyperparameters of the proposed method.\n\n\u2022\tThe paper is clearly written and well organized."
                },
                "weaknesses": {
                    "value": "The scope and applications of convolutional DKM are somewhat limited. From my perspective, a main purpose of kernel-based methods (i.e., NNGP, NTK, DMK, etc.) is to help explain the learning mechanism of Bayesian NNs instead of giving state-of-the-art performance on regression or classification tasks (as can be observed in Table 3). It is thus desirable to briefly discuss how the proposed method contributes to this domain (i.e., explaining the learning scheme of Bayesian convolutional NNs)."
                },
                "questions": {
                    "value": "\u2022\tThe authors state that DKMs are derived from deep GPs where the width of the intermediate layers goes to infinity, but it seems that the kernel function in Section 4 is calculated based on finite number of channels (i.e., $N_l$ is finite). Can authors provide some clarification?\n\n\u2022\tIt is not clear whether the kernel matrix $\\textbf{K}\\_{\\text{Conv}}$ is positive-definite by defining $\\textbf{F}_{i}^{l}$ using learnable parameter $\\textbf{C}^{l}$, or at least a priori (i.e., before training). Can authors give some intuition on this?\n\n\u2022\tWhy is the convolutional DKM compared with other models only on CIFAR-10 but not CIFAR-100 in Table 3?"
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "8: accept, good paper"
                },
                "confidence": {
                    "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                },
                "first_time_reviewer": {
                    "value": "Yes",
                    "readers": [
                        "ICLR.cc/2024/Conference/Program_Chairs",
                        "ICLR.cc/2024/Conference/Submission5645/Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission5645/Reviewer_jw8S",
                        "ICLR.cc/2024/Conference/Submission5645/Senior_Area_Chairs"
                    ]
                }
            },
            "number": 1,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission5645/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698262172949,
            "cdate": 1698262172949,
            "tmdate": 1700637737046,
            "mdate": 1700637737046,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "aThV8nTpGG",
                "forum": "1oqedRt6Z7",
                "replyto": "Qe1oh86SDh",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission5645/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission5645/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Author Response"
                    },
                    "comment": {
                        "value": "Please see **Overall summary** at the top, which describes major changes, including dramatically improved performance on CIFAR-10 (from 91.7\\% in the original manuscript to 92.7\\% in this version), and a revamped introduction section that more clearly explains the motivation of our work.\n\n**Theoretical contributions of the convolutional DKM.**\nAbsolutely!  We have rewritten the introduction to highlight that there is a large body of work in the NNGP and NTK literature, attempting to push up the performance of these methods.  There is good theoretical reason for doing this.  In particular, we want to know whether infinite-width neural networks capture the \"essence\" of what makes neural networks work so well, or whether there is something missing.  Indeed, it does seem that NNGPs underperform relative to finite NNs, suggesting that NNGPs are indeed missing something fundamental. One hypothesis is that this missing piece is representation learning.  However, we can't really be sure that this is the case, given the numerous practical differences between NNGPs and finite NNs.  One way to confirm this hypothesis would be to develop an infinite-width NNGP-like approach that somehow includes representation learning.  We do exactly that, and find that we do indeed get improved performance over NNGPs (92.7\\% vs the best NNGP result of 91.2\\% from Adlam et al. 2023). Furthermore, the DKM framework provides a handle (the regularisation strength hyperparameter $\\nu$) to smoothly interpolate between the NNGP kernel regime and the fully-representation-learning regime (see Table 1).\n\n\nQuestions:\n> The authors state that DKMs are derived from deep GPs where the width of the intermediate layers goes to infinity, but it seems that the kernel function in Section 4 is calculated based on finite number of channels (i.e.,  is finite). Can authors provide some clarification?\n\nHere, we're taking inspiration from neural networks to derive an inter-domain inducing point scheme for the infinite width limit, so we necessarily intermix the kernel and feature-based viewpoint.  There's two tricks here as we move from the feature-based to the kernel-based viewpoint.\n\nFirst, we use expressions like Eq. 15, which are valid when $\\mathbf{H}$ has a finite or infinite number of features.\n\nSecond, in e.g.\\ Eq. 19 and 20, we use a standard trick from the NNGP literature.\nIn particular, the distribution over all features (indexed $\\lambda$) is IID.\nTherefore, we consider a particular feature, (the $\\lambda$th feature) in Eq. 19 and 20, but the derivation applies to all (potentially infinitely many) features.\n\n\n> It is not clear whether the kernel matrix  is positive-definite by defining \n using learnable parameter , or at least a priori (i.e., before training). Can authors give some intuition on this?\n\nThe kernel defined in (Eq. 17) is just the covariance of a random vector, so it has to be positive semi-definite. \nSpecifically, Eq. 17 can be rewritten as,\n\n$\\mathbf{K}^{\\rm{Conv}} = \\mathbb{E}[\\mathbf{f}_{\\lambda}  \\mathbf{f}\\_{\\lambda}^T]$\n\nwhere, $\\mathbf{f}^T = (\\mathbf{f}^{\\rm i}\\_\\lambda \\mathbf{f}^{\\rm t}_\\lambda)^T$.\nWe use $C$ to define $\\mathbf{f}^{\\rm_i}$, but the kernel would be positive semi-definite for any choice of $\\mathbf{f}^{\\rm_i}$.\n\n> Why is the convolutional DKM compared with other models only on CIFAR-10 but not CIFAR-100 in Table 3?\n\nPrevious methods take so long to run that they tend to only give results on CIFAR-10 (but we're happy to include comparisons on CIFAR-100 if you know of any relevant ones)."
                    }
                },
                "number": 6,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission5645/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700579717453,
                "cdate": 1700579717453,
                "tmdate": 1700579717453,
                "mdate": 1700579717453,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "RqS64gCyQZ",
                "forum": "1oqedRt6Z7",
                "replyto": "aThV8nTpGG",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission5645/Reviewer_jw8S"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission5645/Reviewer_jw8S"
                ],
                "content": {
                    "comment": {
                        "value": "Thank you for your clarifications on my questions. I definitely think the transition from the feature-based to the kernel-based viewpoint deserves further elaboration. Apart from that, my assessment of the novelty and contribution of this work to the Bayesian learning of Neural Networks remains unchanged, and I'm open to raising the score if the authors add these explanations to the updated manuscript."
                    }
                },
                "number": 7,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission5645/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700637639777,
                "cdate": 1700637639777,
                "tmdate": 1700637639777,
                "mdate": 1700637639777,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "padhhRa0ul",
            "forum": "1oqedRt6Z7",
            "replyto": "1oqedRt6Z7",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission5645/Reviewer_hjfZ"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission5645/Reviewer_hjfZ"
            ],
            "content": {
                "summary": {
                    "value": "This paper formulates the convlutional deep kernel machines based on the framework of a very recent work (Yang et al. 2023), which presents a modified  Neural Network Gaussian Process (NNGP) for retaining a better representation learning. In this work, the authors formulate the convolutional operations in deep kernel machines built upon the convolutional kernel, apply the NNGP framework from (Yang et al. 2023) with an ELBO objective attained, further utilize the sparse GP technique with specific consideration to the convolutional kernel case for yielding a tracble training scheme with the induced points, and conduct experiments mainly mirroring ResNet20 with good results compared to other kernel techniques."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "2 fair"
                },
                "strengths": {
                    "value": "In general, the elements involved in the work and the used technique framework are clear. Despite of the \"a bit giant\" title, the content presented in the work reflect what the title conveys, so the focus of this work is  well presented."
                },
                "weaknesses": {
                    "value": "However, for the work itself, I found a bit struggling to appreciate the (both theoretical and practical) benefits of applying the proposed method."
                },
                "questions": {
                    "value": "### Major concerns:\n1. In the presented content, it does not clearly elaborate or reveal the classical benefits of using kernel method (e.g., more interpretation, primal-dual representation and optimization, analytical results from RKHS, or [1] etc), nor provide practical values of using this method (e.g., varying the architecture besides ResNet20, a possibility of using a simple architecture). \n\nBesides, Would it be possible  that the GP-relied framework in this deep kernel machine shall have advantages in dealing uncertainty in data/images with better robustness or generalization ability. I would suggest the authors to articulate this aspect.\n\n[1] Bohn, B., Rieger, C., & Griebel, M. (2019). A representer theorem for deep kernel learning. The Journal of Machine Learning Research, 20(1), 2302-2333.\n\n2. To my personal experience, the title of this paper looks too \"giant\", as there exist different lines of work which try to deepen kernel machines w.r.t. different principles, setups and goals. The DKM is basically relying on the NNGP framework (Yang et al. 2023) and the convolution kernel. Besides the cited work in the paper, parts of other work regarding deep kernel machines can involve (**not limited to**):\n \nMairal, Julien, et al. \"Convolutional kernel networks. Advances in neural information processing systems 27 (2014),\n\nMairal, Julien. \"End-to-end kernel learning with supervised convolutional kernel networks.\" Advances in neural information processing systems 29 (2016), \n\nChen, Dexiong, Laurent Jacob, and Julien Mairal. \"Recurrent kernel networks.\" Advances in Neural Information Processing Systems 32 (2019), and some other works of Julien Mairal https://lear.inrialpes.fr/people/mairal/resources/pdf/Ohrid_CKN.pdf, where neural networks are involved quite a lot towards a deep architecture.\n\nSuykens, Johan AK. \"Deep restricted kernel machines using conjugate feature duality.\" Neural computation 29.8 (2017), \n\nTonin, Francesco, et al. \"Deep Kernel Principal Component Analysis for Multi-level Feature Learning.\" arXiv preprint arXiv:2302.11220 (2023), \n\nAchten, Sonny, et al. \"Semi-Supervised Classification with Graph Convolutional Kernel Machines.\" arXiv preprint arXiv:2301.13764 (2023), \n\nand other works of Johan AK Suykens, where the primal-dual framework retaining feature maps (e.g., NNs) in the primal and kernel tricks in the dual is a central idea. I would suggest to have a more comprehensive review on deep kernel machines in related work, though they are designing the model differently. It might also help to distinguish the unique benefits of the proposed method.\n\n\n### Minor aspects:\n1. A configuration figure presenting the convolutional kernel, the deep  architecture and the flow of optimization with sparse GP can be helpful for illustration I suppose.\n\n2. Some typos and non-mathemcatical edits, e.g., the 2nd paragraph under Table 3 on page 8.\n\n3. In the provided codes, there are different variants of nonlinear kernels. But I didn't notice a clear descriptions on how these nonlinear units are chosen or considered.\n\n4. How about the empirical efficiency difference on varying the inducing points setups in Table 2?\n\n5. In Table 1, many factors are investigated, and in different sections mostly the performances did not changge drastically in the compared techniques and were similar to other sections. The evaluation is comprehensive, but the conlusion is less focused, as we would hope to quickly get which factors are the most important ones. I these results don't change much and all attain good results, and then a mild suggestion or a global defaulting setting can be a take-away message."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "5: marginally below the acceptance threshold"
                },
                "confidence": {
                    "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 2,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission5645/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698657839201,
            "cdate": 1698657839201,
            "tmdate": 1699636586773,
            "mdate": 1699636586773,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "IZZD915N3i",
                "forum": "1oqedRt6Z7",
                "replyto": "padhhRa0ul",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission5645/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission5645/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Author Response (1/2)"
                    },
                    "comment": {
                        "value": "Please see **Overall summary** at the top, which describes major changes, including dramatically improved performance on CIFAR-10 (from 91.7\\% in the original manuscript to 92.7\\% in this version), and a revamped introduction section that more clearly explains the motivation of our work.\n\n**Benefits of our approach**\n\nAt present, there are three primary benefits of our approach.\n\nFirst, our work addresses a number of theoretical questions arising in the NNGP literature.  These include:\n* Is it possible to obtain an infinite-width, NNGP-like limit in which representation learning can occur?\n* Current NNGPs underperform relative to finite NNs.  One hypothesis that might explain this underperformance is that NNGPs have a fixed kernel, and thus lack representation learning.  While that hypothesis is plausible, it is not easy to confirm, given the huge differences between NNGPs and finite NNs.  To confirm this hypothesis, we really need a variant of the NNGP that somehow includes representation learning.  That's precisely what we develop in this paper.  And we show that by introducing representation learning into NNGPs, you indeed get a considerable performance boost (from 91.2\\% in Adlam et al. (2023) to 92.7\\% here). Furthermore, as seen in the updated results in Table 1, varying our regularisation strength allows us to smoothly interpolate between the NNGP regime and the representation-learning regime.\nAll this suggests that it is indeed the lack of representation learning that is causing at least part of the underperformance of NNGPs relative to finite NNs. This has been hypothesised in the past (e.g. David MacKay. Introduction to gaussian processes. 1998) but we are the first to empirically show this on meaningful datasets like CIFAR-10.\n\nSecond, our work forms a bridge, allowing us us to connect the fantastic collection of prior work that you point out in your review to current work on NNGPs.\n\nThird, improved performance against previous kernel methods.  Our best result is 92.7\\% as opposed to previous results from kernel methods with parameters (89.8\\%; Mairal 2016) and without parameters (91.2\\%; Adlam et al. 2023).\n\n\n\n**Additional related work**\nThanks for highlighting this awesome collection of related work!  We have updated the Related Work to include a thorough discussion of all of it (also see below).  We hope that our paper can drive renewed interest and attention towards this collection of prior work, by highlighting: \n* the potential excellent performance of deep kernel methods on datasets such as CIFAR-10\n* theoretical relationships between the broad family of deep kernel methods and \"fashionable\" topics, such as representation learning in infinite-width neural networks.\nIn any case, we'd be excited to follow up with the authors of this work! (Anonymity permitting, of course.)\n\nAt a high-level, there are two key differences to this past work.  \n\nFirst, this work lacks a theoretical link to representation learning in infinite-width neural networks, and thus cannot be used to address the theoretical questions addressed by our work. But there are other differences in the details.\n\nSecond, it seems that a lot of this work (e.g. Mairal et al. 2014, Mairal 2016, Johan 2017, Dexiong et al. 2019, Achten et al. 2023) uses a (convolutional/recurrent) neural network like structure to obtain a finite-dimensional projection/approximation of an underlying fixed kernel. In that sense, this work resembles (or could be used to get) an efficient approximation of NNGP-like kernels. In contrast, our objective (Eq. 5) is fundamentally not a projection/approximation of an underlying, fixed kernel.  Instead, it allows \"full\" flexibility in the Gram matrices/kernels, resembling exactly the type of flexibility in the kernel that you'd get in a deep GP or a finite, deep neural network.\n\n> [1] Bohn, B., Rieger, C., & Griebel, M. (2019). A representer theorem for deep kernel learning. The Journal of Machine Learning Research, 20(1), 2302-2333.\n\nDeep kernel learning is of course very different to our approach.\nIn deep kernel learning, you train a neural network, and feed the outputs of that network into a kernel.\nIn contrast, in a DKM approach, there is no neural network: there are no features and no weights.\nInstead, there are just kernels (or structured approximations to kernels).\n\n> Tonin, Francesco, et al. \"Deep Kernel Principal Component Analysis for Multi-level Feature Learning.\" arXiv preprint arXiv:2302.11220 (2023),\n\nThis is an unsupervised feature extraction method."
                    }
                },
                "number": 4,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission5645/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700578902730,
                "cdate": 1700578902730,
                "tmdate": 1700578902730,
                "mdate": 1700578902730,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "cjlcvSJtdJ",
                "forum": "1oqedRt6Z7",
                "replyto": "padhhRa0ul",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission5645/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission5645/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Author Response (2/2)"
                    },
                    "comment": {
                        "value": "**Title too broad?**\nWe agree that the term \"deep kernel machine\" is perhaps quite broad.  Your comment raises a bit of a dilemma: the use of the term \"Deep Kernel Machine\" in this context was introduced by Yang et al.  While their paper was formally published in 2023 at ICML, the paper (and terminology) was established on arXiv as early as 2021.  Moreover, there are other terms such as \"Deep kernel learning\" which seem very broad, but in practice are used to refer to a very specific way of combining a neural network and a kernel, (\"Deep kernel learning\" Wilson et al. 2015). Do you have any suggestions about how to resolve this dilemma?\n\n**Uncertainty**\nThe three key advantages of our approach are outlined at the top of this response.\nUnfortunately, as we take the infinite-width limit, we lose the straightforward Bayesian interpretation, so the implied uncertainty properties are unclear, and we leave this for future work.\n\n**Minor aspects:**\n\n\n> Some typos and non-mathemcatical edits, e.g., the 2nd paragraph under Table 3 on page 8.\n\nThanks, fixed!\n\n> In the provided codes, there are different variants of nonlinear kernels. But I didn't notice a clear descriptions on how these nonlinear units are chosen or considered.\n\nIn practice, we just use the arccos kernel corresponding to the relu nonlinearity, to ensure a close correspondence to CNNs.\n\n> How about the empirical efficiency difference on varying the inducing points setups in Table 2?\n\nWe have now added this to the paper in Table 2. We include the times below for the reviewers' convenience.\n| Number of Inducing Points          | Time per Epoch (seconds) |\n|------------------------------------|--------------------------|\n| 16/32/64                           | 45                       |\n| 32/64/128                          | 54                       |\n| 64/128/256                         | 82                       |\n| 128/256/512                        | 155                       |\n| 256/512/1024                       | 420                      |\n| 512/1024/2048                      | 1380                      |\n\n\n> In Table 1, many factors are investigated, and in different sections mostly the performances did not changge drastically in the compared techniques and were similar to other sections. The evaluation is comprehensive, but the conlusion is less focused, as we would hope to quickly get which factors are the most important ones. I these results don't change much and all attain good results, and then a mild suggestion or a global defaulting setting can be a take-away message.\n\nSee the \"Benchmark performance\" paragraph for a description of how these experiments informed our choice of defaults for subsequent experiments."
                    }
                },
                "number": 5,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission5645/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700578921087,
                "cdate": 1700578921087,
                "tmdate": 1700578921087,
                "mdate": 1700578921087,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "1TiLCTbD6U",
                "forum": "1oqedRt6Z7",
                "replyto": "cjlcvSJtdJ",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission5645/Reviewer_hjfZ"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission5645/Reviewer_hjfZ"
                ],
                "content": {
                    "title": {
                        "value": "Thanks for the rebuttal"
                    },
                    "comment": {
                        "value": "I would like to thank the authors for the replies. This work provides a link to the infinite-width neural network and uses some acceleration scheme via the usage of inducing points to make the kernel computation tractable. My concerns on the practical potential and the theoretical significance w.r.t. kernel tricks still remain, such as the empirical advantages (other benefits apart from the accuracy, e.g., hierarchical feature learning, more interpretability, etc can be considered, as simply the accuracy advantages can be reached by many methods) and the heritage of natural benefits from kernel trick or duality interpretation or Bayesian interpretation. \n\nOn the scalability empirical experiments, I have no further requirement, as indeed such experimental setups are sufficient especially in the class of kernel methods, though some tuning parameters and the selection of  inducing points need to be determined and the model complexity and computation are worth further considerations.  \n\nOn the title, some key words related to Gaussian Process, infinite-widd neural network, Bayesian neural network can be involved, reflecting that this work is an extension upon this type of deep kernels in  (Yang et al. 2023). \n\nUp to the current version, I would like to keep my score; if in an acceptance, I would suggest the authors to further elaborate the discussions with the existing kernel methods, admitting their merits and also comparing with the focus in this work upon NNGP with infinite width, in the mean time articulate more also on the limitations of this work with outlooks for broader readers."
                    }
                },
                "number": 9,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission5645/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700691015436,
                "cdate": 1700691015436,
                "tmdate": 1700691015436,
                "mdate": 1700691015436,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "25OoToysDE",
            "forum": "1oqedRt6Z7",
            "replyto": "1oqedRt6Z7",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission5645/Reviewer_3QEZ"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission5645/Reviewer_3QEZ"
            ],
            "content": {
                "summary": {
                    "value": "The paper extends the work of deep kernel machines with infinite-width Bayesian NN to convolutional networks. While the extension of the base model to convolutional networks is quite straightforward, making it efficient with inducing points is more challenging and is where the main technical novelty of this paper is."
                },
                "soundness": {
                    "value": "2 fair"
                },
                "presentation": {
                    "value": "1 poor"
                },
                "contribution": {
                    "value": "3 good"
                },
                "strengths": {
                    "value": "- The work is a significant contribution to the field of infinite-width NN\n- The extension to sparse convolutional DKM is novel\n- The method has good results on several standard benchmarks."
                },
                "weaknesses": {
                    "value": "- I found the definition of $C^\\ell$ in Eq. 18 very confusing and unintuitive. This should be the inducing points equivalent of the BNN convolution operation in Eq. 8. However this involves summing over all of the inducing points in the previous layer. This is unusual and isn't part of any standard convolution.\n- Experiments only show accuracy and NLL, and while this is fine for standard machine learning models, the benefit of the Bayesian approach is mostly in the other benefits it adds besides plain accuracy. It would make the paper much better if you show that your VI approximation still holds these properties with additional evaluations on these benchmarks like calibration or out-of-distribution detection.\n- The writing needs improvement. English editing is needed to make the paper read like a more coherent text, instead of disjoint sentences."
                },
                "questions": {
                    "value": "My main question is about Eq. 18 and the reason behind mixing all the previous inducing points."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "5: marginally below the acceptance threshold"
                },
                "confidence": {
                    "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 3,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission5645/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698679394885,
            "cdate": 1698679394885,
            "tmdate": 1699636586644,
            "mdate": 1699636586644,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "ObDDZ1QyNG",
                "forum": "1oqedRt6Z7",
                "replyto": "25OoToysDE",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission5645/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission5645/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Author Response"
                    },
                    "comment": {
                        "value": "Please see **Overall summary** at the top, which describes major changes, including dramatically improved performance on CIFAR-10 (from 91.7\\% in the original manuscript to 92.7\\% in this version), and a revamped introduction section that more clearly explains the motivation of our work.\n\n**Eq. 18** \nAgreed: this isn't intuitive, but it is one of the key contributions in our framework.  \nWe could use inducing points that look like images/feature maps, but if we did that the memory usage would be far too high (as explained in the paper).\nInstead, we worked hard to come up with memory-efficient inter-domain inducing points that are just a flat vector, with no spatial structure.\nYou can see that because the $F_{i,\\lambda}^{\\rm i}$ and $H^{\\rm i}_{i', \\mu}$ just have channel indices ($\\lambda$ and $\\mu$) or inducing point indices ($i$ or $i'$), and don't have any spatial indicies.\n\nBut in Eq. 18, we have the convolutional weights, $W_{d \\mu, \\lambda}$, which does have spatial structure; how does that work?\nThe answer is that the ``inner'' multiplication by C,\n\n$\\sum_{i'} C_{di , i'} H^{\\rm i}_{i', \\mu}$\n\nhas a result that has indices $i, d, \\mu$.  i.e.\\ this inner multiplication gives a bunch of image patches, which we can combine with the weights, $W_{d \\mu, \\lambda}$! In short, we multiply spatial-less inducing points by various weights C to form spatial patches, and then convolve these with the convolutional weights W.\n\n\n**Benefits of Convolutional DKMs**\n> Experiments only show accuracy and NLL, and while this is fine for standard machine learning models, the benefit of the Bayesian approach is mostly in the other benefits it adds besides plain accuracy. It would make the paper much better if you show that your VI approximation still holds these properties with additional evaluations on these benchmarks like calibration or out-of-distribution detection.\n\nThe two key advantages of the DKM approach are described in the \"Overall summary\".  First, the DKM approach gives improved performance over previous kernel methods.  Our best result is 92.7\\% as opposed to previous results from kernel methods with parameters (89.8\\%; Mairal 2016) and without parameters (91.2\\%; Adlam et al. 2023).  Second, our results have important implications for our theoretical understanding about the importance of representation learning in NNs (see modified Introduction). In particular, our new results show much more clearly in Table 1 how our regularisation strength hyperparameter allows the DKM framework to smoothly interpolate between the fixed NNGP kernel regime and the fully-expressive representation learning regime.\nUnfortunately, as we take the infinite-width limit, we lose the straightforward Bayesian interpretation, so the implied uncertainty properties are unclear, and we leave this for future work.\n\n**Writing**\nWe have copy edited the paper with a native English speaker."
                    }
                },
                "number": 3,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission5645/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700578397309,
                "cdate": 1700578397309,
                "tmdate": 1700578525846,
                "mdate": 1700578525846,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "2KML5wtZ7q",
            "forum": "1oqedRt6Z7",
            "replyto": "1oqedRt6Z7",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission5645/Reviewer_5yKS"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission5645/Reviewer_5yKS"
            ],
            "content": {
                "summary": {
                    "value": "This paper proposes an extension of deep kernel machines to leverage convolutions. It is based on the patch-based inter-domain inducing points in the convolutional GP literature. The main difference between convolutional DKMs and convolutional DGPs is that DKMs allow to perform representation learning--the Gram matrix is not fixed as in NNGPs but learnable, while regularized by a NNGP prior. Therefore, the model can have a large number of trainable parameters. Together with the convolutional structure, the model achieves 92% on CIFAR10, which outperforms previous convolutional GP methods and NNGP/NTKs."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "2 fair"
                },
                "contribution": {
                    "value": "2 fair"
                },
                "strengths": {
                    "value": "* The proposed convolutional DKM model has strong performance on classification benchmarks. 92% accuracy on CIFAR10 is quite impressive if we classify DKM into the broad class of kernel methods. \n\n* The technical development is sound--the proposed model formulation and training algorithms are sensible and computationally efficient."
                },
                "weaknesses": {
                    "value": "* The contribution seems incremental. The proposed method is a combination of DKMs and the inter-domain inducing points used in convolutional (D)GPs.\n\n* The objective for learning parametric gram matrices is regularized by a NNGP prior: $KL(N(0, G^\\ell) \\| N(0, K(G^{\\ell-1}))$ computed from the gram matrix of the previous layer. Although this seems a sensible objective function to enable representation learning, it is unclear what the first principle is behind it. It is mentioned briefly in the paper \"Formally, the DKM objective is the evidence lower bound (ELBO) for an infinite-width DGP in the Bayesian representation learning limit.\" It would be great to see a proof on this.\n\n* The results are quite impressive if we categorize the proposed method into the \"kernel method\" class. However, I feel more evidences are needed to justify that this is a fair comparison. For example, the number of parameters in DKMs is much larger than NNGPs and convolutional (D)GPs due to the trainable gram matrices. It would be good to report these numbers in experiments and compare to a ResNet with the same number of parameters. Would the regularization bring any advantages over a such a ResNet? \n\n* One big benefit of (D)GPs is that they can produce uncertainty estimates. Do convolutional DKMs exhibit similar capabilities? Are their predictions well-calibrated? Answering these questions could greatly strengthen the paper."
                },
                "questions": {
                    "value": "Please see above questions."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "details_of_ethics_concerns": {
                    "value": "N/A"
                },
                "rating": {
                    "value": "5: marginally below the acceptance threshold"
                },
                "confidence": {
                    "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 4,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission5645/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698844969511,
            "cdate": 1698844969511,
            "tmdate": 1699636586522,
            "mdate": 1699636586522,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "GDwJ1bWZkt",
                "forum": "1oqedRt6Z7",
                "replyto": "2KML5wtZ7q",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission5645/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission5645/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Author response"
                    },
                    "comment": {
                        "value": "Please see **Overall summary** at the top, which describes major changes, including dramatically improved performance on CIFAR-10 (from 91.7\\% in the original manuscript to 92.7\\% in this version), and a revamped introduction section that more clearly explains the motivation of our work.\n\n**Novelty of convolutional inter-domain inducing point method for DKMs**\nAs discussed in the Introduction and Related Work, standard inducing point approaches for Convolutional GPs don't work, because they require features at each layer, while the DKM only gives us Gram matrices.  Working out how to get things to work efficiently, while working in the Gram matrix domain is highly non-trivial, and the key reason that the math in the paper is a bit painful.\n\nAdditionally, the dramatic differences between the methods come out in the experiments.\nOur radically different approach from convolutional DGPs allows us to scale to much deeper models (e.g. Dutordoir et al. 2020 only went up to three layers), and hence allowed achieve dramatically improved performance (Dutordoir et al. only got 76.17\\% on CIFAR-10, while we got 92.7\\%).\n\n**Derivation of DKM objective**\nPlease see Appendix A (which was present in the original manuscript) for a first-principles derivation, or the original DKM paper (Yang et al. 2023).\n\n**Appropriate baselines**\nYou're right that the best comparison perhaps isn't the \"parameter-free\" NNGP methods.  The best comparison would be against other kernel methods that also have trainable parameters. We didn't originally include them, as there aren't many such methods, and they don't tend to perform as well as NNGPs.  Nonetheless, we've updated Table 3 to include such methods, including convolution DGPs (up to 76.17\\% on CIFAR-10 with Dutordoir et al. 2020), and convolutional kernel networks (up to 89.8\\% with Mairal, 2016). Our approach gives considerable performance improvements, with our best result being 92.7\\%.\n\n**The benefits of convolutional DKMs**\nThe two key advantages of the DKM approach are described in the \"Overall summary\".  First, the DKM approach gives improved performance over previous kernel methods.  Our best result is 92.7\\% as opposed to previous results from kernel methods with parameters (89.8\\%; Mairal 2016) and without parameters (91.2\\%; Adlam et al. 2023).  Second, our results have important theoretical implications for our theoretical understanding about the importance of representation learning in NNs (see modified Introduction). In particular, our new results show much more clearly in Table 1 how our regularisation strength hyperparameter allows the DKM framework to smoothly interpolate between the fixed NNGP kernel regime and the fully-expressive representation learning regime, thus demonstrating that representation learning is a key component for successful deep models.\n\nUnfortunately, as we take the infinite-width limit, we lose the straightforward Bayesian interpretation, so the implied uncertainty properties are unclear, and we leave this for future work."
                    }
                },
                "number": 2,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission5645/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700577961030,
                "cdate": 1700577961030,
                "tmdate": 1700577961030,
                "mdate": 1700577961030,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    }
]