[
    {
        "title": "Molecule Generation by Heterophilious Triple Flows"
    },
    {
        "review": {
            "id": "oz4IzJItZl",
            "forum": "bZHz9WYs9z",
            "replyto": "bZHz9WYs9z",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission5318/Reviewer_VenB"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission5318/Reviewer_VenB"
            ],
            "content": {
                "summary": {
                    "value": "This paper introduces a new framework called Heterophilous Triple Flows (HTFlows) for generating molecules with desired properties. It discusses the limitations of existing approaches, such as graph neural networks with heterophily, and proposes HTFlows as a solution to address these issues and improve performance on chemoinformatics benchmarks."
                },
                "soundness": {
                    "value": "2 fair"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "3 good"
                },
                "strengths": {
                    "value": "The presentation is clear.\n\nThe contribution is good if more evidence is provided"
                },
                "weaknesses": {
                    "value": "See below"
                },
                "questions": {
                    "value": "1. Researchers already find that heterophily is not always harmful and homophily assumption is not always necessary for GNNs [1,2,3,4]. How does this paper align with these works?\n\n2. Heterophily was usually studied in node classification tasks when graph-aware models underperform graph-agnostic models. I'm not sure if heterophily will also cause performance degradation of graph-aware models in generative tasks. Do you have any evidence or references? If the answer is yes, it would be a good contribution.\n\n3. In equation (2), what is S?\n\n4. Ablation study is missing. How does each component in heterophilious message passing contribute to the performance gain?\n\nIf the authors can answer the above questions well, I will raise my score.\n\n\n[1] Is Homophily a Necessity for Graph Neural Networks?. In International Conference on Learning Representations 2022.\n\n[2] Revisiting heterophily for graph neural networks. Advances in neural information processing systems, 35, 1362-1375.\n\n[3] When do graph neural networks help with node classification: Investigating the homophily principle on node distinguishability. arXiv preprint arXiv:2304.14274.\n\n[4] Demystifying Structural Disparity in Graph Neural Networks: Can One Size Fit All?. arXiv preprint arXiv:2306.01323."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "6: marginally above the acceptance threshold"
                },
                "confidence": {
                    "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                },
                "first_time_reviewer": {
                    "readers": [
                        "ICLR.cc/2024/Conference/Program_Chairs",
                        "ICLR.cc/2024/Conference/Submission5318/Senior_Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission5318/Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission5318/Reviewer_VenB"
                    ]
                }
            },
            "number": 1,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission5318/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698532945465,
            "cdate": 1698532945465,
            "tmdate": 1700691000853,
            "mdate": 1700691000853,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "wdq6oqu7nx",
                "forum": "bZHz9WYs9z",
                "replyto": "oz4IzJItZl",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission5318/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission5318/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Reply to review VenB"
                    },
                    "comment": {
                        "value": "Thank you for providing constructive feedback that has allowed us to clarify essential aspects of this paper. We believe our response has adequately responded to your concerns.\n\n**Q1:** *There are many literatures showing that heterophily is not always harmful. How does my paper align with these?*  \n**A1:** We thank the reviewer for pointing out these works. We are amending the related work section to include these works. We summarize the relation to these works as follows:\n\n* Paper [1] points when the cross-class neighbour similarity is stronger than intra-class similarity, which keeps the post-aggregated embeddings of different classes distinguishable, then the data heterophily is not that harmful for node classification. \n* Paper [2] claims their newly designed aggregated homophily is a good indicator of the model expressiveness. However, it\u2019s not very surprising that this homophily indicator is highly correlated with the performance of the model on certain data, since it combines the information from the data (node features, aggregation operator and labels) and model structure (assumption on model type: simplifying graph convolutional networks). In the model design, we share a similar idea: trying to process lower/higher frequency information separately in different channels. At the same time, we are different: For example, while handling high-frequency info, we avoid the information exchange between highly different nodes but keep smoothing the similar clusters. ACM capture high-frequency data by the graph Laplacian, which cares more about the graph topology (this idea comes from graph signal processing)\n* Paper [3] verifies that compared with homophily, GNN performance on node classification is more related to intra- and inter-class Node Distinguishability (ND). In molecular generation, graph distinguishability is much more important than ND.\n* Paper [4] defines the majority pattern (homophilic nodes in homophilic graph/ heterophilic nodes in the heterophilic graph) and shows that GNN is superior to graph-agnostic models on the majority patterns but worse on minority patterns. It tries to reveal how does the heterophily influence the GNN performance on node classification.\n\nIn general, all these papers [1,2,3,4]:\n* Focus on the deeper insights between homophily and the GNN model performance on the node classification task. The heterophily matters in different styles: the difference with node classification and graph generation is discussed at the general reply.\n* They try to discover the more essential factor (compared with heterophily) which affects the model performance. At the same time, we develop our methods, motivated by noticing the possible lossing information during training from the inspiration of heterophily.\n\n\n\n**Q2:**  What is the problem of data heterophily in molecular generation tasks? any evidence or reference?\n**A2:** Key to the generative model is learning the data distribution, which possibly contains special patterns underlying the data domain. Here the data is graph-structured, so an expressive model can distinguish different graphs. The smoothing embeddings from the message passing scheme will decrease the expressiveness of models. Thus it is natural to build structure to mitigate this problem. This is the motivation for us to design different flows to capture more information and avoid missing certain types of information. We have included an example analysis in the general reply to all reviewers.\n\n**Q3:** In equation (2), what is $S$?  \n**A3:** In the ACLs (affine coupling layers), the input $X$ is split to two parts $X_1, X_2$ by the masking matrix. One part $X_1$ is updated by another part $X_2$ in the following style. For reversibility, the transformation is chosen to be an affine map, then $X_1$ is updated by the factorization matrix $S$ and translation matrix $T$ to be $SX_1+T$. And $S, T$ are generated from $f(X_1)$, where the $f$ is the coupling function. To avoid the negative factor, we choose $\\log S, T = f(X_1)$, as mentioned in Equation (2). The coupling function $f$ is defined to be the GNN with heterophilous message passing layer in Equation (9): $ACL^{(GNN_i^\\gamma, \\mathbf{M}_i)}$\n\n**Q4:** *Ablation study is missing. How does each component in heterophilious message passing contribute to the performance gain?*  \n**A4:** Our model adds structure caring about heterophily/homophily based on MoFlow. And MoFlow utilizes the traditional GNN so loses the high-frequency information on heterophilic data. Thus MoFlow could be viewed as a single flow (HTFlows without heterophily and homophilic flows) as ablation. And there is also an example analysis in the general reply.\n\n**References**  the same as the reviewer given."
                    }
                },
                "number": 6,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission5318/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700512731360,
                "cdate": 1700512731360,
                "tmdate": 1700512731360,
                "mdate": 1700512731360,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "Rx2NDfqaW4",
                "forum": "bZHz9WYs9z",
                "replyto": "wdq6oqu7nx",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission5318/Reviewer_VenB"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission5318/Reviewer_VenB"
                ],
                "content": {
                    "comment": {
                        "value": "Thanks for the response. The authors have addressed most of my concerns and I think studying heterophily problem for generative models is a very interesting topic. Thus, I will increase my rating to 6. Good luck."
                    }
                },
                "number": 8,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission5318/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700691125544,
                "cdate": 1700691125544,
                "tmdate": 1700691125544,
                "mdate": 1700691125544,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "hpQ4QLqJ9A",
            "forum": "bZHz9WYs9z",
            "replyto": "bZHz9WYs9z",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission5318/Reviewer_LyRR"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission5318/Reviewer_LyRR"
            ],
            "content": {
                "summary": {
                    "value": "This paper proposes the heterophyllous triple flow model to handle the heterogeneity of molecular graph generation. Its key idea is to introduce multiple interactive flows which \"capture\" heterophily patterns in the molecular space."
                },
                "soundness": {
                    "value": "1 poor"
                },
                "presentation": {
                    "value": "2 fair"
                },
                "contribution": {
                    "value": "1 poor"
                },
                "strengths": {
                    "value": "This paper tackles the problem of generating heterophilious molecular graphs, where vertices may have different features (e.g., atom types) even when they are adjacent to each other."
                },
                "weaknesses": {
                    "value": "### Weak experiments\n\nMy main criticism is that the experiments are not enough to verify the practical relevance of the proposed work. \n\nThe authors seem to consider the baselines proposed by Verma et al., 2022 as state-of-the-art. However, there exists a plethora of molecular generative models since the work of Verma et al., 2022. Just to list a few examples, one could consider STGG (Ahn et al., 2022), GDSS (Jo et al., 2022), Digress (Vignac et al., 2022), and GraphARM (Kong et al., 2023). The authors could even consider SMILES-LSTM (which demonstrates surprisingly good performance) for more comprehensive baselines. \n\n### Lack of justification \n\nI was unable to find a good justification for why the proposed flow network better generates heterophilious graphs. The only explanation I got was that \"binary masking ensures that only part of the input is transformed, allowing the model to retain certain features while altering others, enabling the flow to capture intricate data distribution characteristics\". I do not understand why retaining certain features is related to \"capturing intricate data distribution characteristics\"."
                },
                "questions": {
                    "value": "I think one could easily incorporate the heterophilious nature by parameterizing molecular generative models with GNNs specifically designed to mitigate over smoothing and better recognize heterophilious graphs. Could the authors provide explanation on why simply using such heterophilic GNNs cannot resolve the considered issue?"
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "3: reject, not good enough"
                },
                "confidence": {
                    "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 2,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission5318/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698729117383,
            "cdate": 1698729117383,
            "tmdate": 1699636533477,
            "mdate": 1699636533477,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "BF78KRU2xr",
                "forum": "bZHz9WYs9z",
                "replyto": "hpQ4QLqJ9A",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission5318/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission5318/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Reply to review LyRR"
                    },
                    "comment": {
                        "value": "We appreciate your valuable feedback, which has assisted us in clarifying crucial elements of this paper. We trust that our reply could adequately deal with your apprehensions and results in an improved rating\n\n**Q1:** *Weak experiments: more SOTA experiments should be included.*  \n**A1:** Many of the SOTA methods do not have code available for reproducing the runs to generate the chemoinformatics metrics. Also copying over partial results from the papers directly does not seem feasible or fair as the evaluation setups differ. For example, in STGG (in the appendix) FCD-qm9 is 0.58 and FCD-zinc is 0.2778, which are even better than the ground truth values we get. They also utilised chemical rules in the learning process, while we hope to learn the data distribution without hand-tailoring this prior knowledge.\n\nLike most of the methods, GDSS, DiGress and GraphARM don\u2019t provide the comprehensive cheminformatics metrics evaluation on QM9 or ZINC, which brings difficulties to merge the results. The main baseline for our work is MoFlow, on which we demonstrate the benefits of the heterophilous flow approach and show to outperform it. \n\n**Q2:** Why the proposed flow network better at generating heterophilious graphs?\n**A2:** Our model is not aiming to be better at generating heterophilious graphs, but to avoid lose information from heterophilious data points during training. Molecular generation cares more about distribution learning. Please see our general reply to all reviewers, where there is an example analysis about problems on heterophilous data and how our model benefits.\n\n**Q3** Why not just utilize heterophilic GNNs but design this structure?\n\n**A3** The difference between node classification and graph generation task are discussed at general reply. For molecular generation task, graph distribution learning requires avoiding any possible information loss. The existing heterophilic GNN could mitigate oversmoothing problem for node classification. The heterophilic GNNs are good at making heterophilic nodes distinguishable. But it\u2019s not enough for simply replacing traditional GNN by it in current problem scenorias, because it may ignores the subtle low-frequency in the homophilic data. Keeping both traditional GNN (in central flow) and extra two flows helps the model get distinguishable embeddings (from both low and high frequency) for all types of graph-structured data points."
                    }
                },
                "number": 5,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission5318/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700512662440,
                "cdate": 1700512662440,
                "tmdate": 1700512662440,
                "mdate": 1700512662440,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "S9aawZYNzy",
                "forum": "bZHz9WYs9z",
                "replyto": "BF78KRU2xr",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission5318/Reviewer_LyRR"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission5318/Reviewer_LyRR"
                ],
                "content": {
                    "comment": {
                        "value": "Thank you for the detailed rebuttal.\n\nQ1. I resonate with the authors on the difficulties of reproducing the baselines. However, the baselines, e.g., Digress, have open-source implementation. The authors could have run the code to obtain the molecules and measure the cheminformatics metrics. At least, the authors could have compared their method with SMILES-LSTM.\n\nQ2. I believe the interactions described by the authors can already be captured by using a regular GNN. It is an oversimplification to describe GNN as a simple heat conduction process, and I think the authors should provide a more formal description of \"avoiding losing information from heterophilious data points\" to be persuasive.\n\nQ3. Unfortunately, I could not fully understand your argument. However, from your argument, it seems that combining traditional GNNs with the ones developed for mitigation of oversmoothing would solve the information loss problem. However, my main concerns are more on Q1 and Q2."
                    }
                },
                "number": 12,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission5318/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700739791357,
                "cdate": 1700739791357,
                "tmdate": 1700739791357,
                "mdate": 1700739791357,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "3oH8O4gSzK",
                "forum": "bZHz9WYs9z",
                "replyto": "hpQ4QLqJ9A",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission5318/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission5318/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Thank you - please see our response"
                    },
                    "comment": {
                        "value": "Thank you for your comments. \n\n1) Please note that the baseline MoFlow we compared with is known to strongly outperform baselines such as RNNs/LSTMs and advanced flow models such as GraphAF, and methods such as Junction tree VAEs etc. Since we improve upon MoFlow, we inherit the benefits with respect to these baselines. \n\n2, 3) Please see our global response, where we give a concrete example of how GNNs fail to take into account the effect of heterophily in generative settings, and how our modelling helps overcome this issue.  \n\nThank you again for your feedback, and we hope this addresses your concerns."
                    }
                },
                "number": 13,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission5318/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700740758707,
                "cdate": 1700740758707,
                "tmdate": 1700740916093,
                "mdate": 1700740916093,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "WjcdTYqvLQ",
                "forum": "bZHz9WYs9z",
                "replyto": "3oH8O4gSzK",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission5318/Reviewer_LyRR"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission5318/Reviewer_LyRR"
                ],
                "content": {
                    "comment": {
                        "value": "Thank you for the swift reply and sorry for being late to engage with the reviewer discussion phase. \n\nI am still not very convinced by the provided arguments, but I will try to understand them, further discuss them with other reviewers, and adjust my scores accordingly."
                    }
                },
                "number": 14,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission5318/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700741471619,
                "cdate": 1700741471619,
                "tmdate": 1700741471619,
                "mdate": 1700741471619,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "Pr9nlChcsC",
            "forum": "bZHz9WYs9z",
            "replyto": "bZHz9WYs9z",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission5318/Reviewer_AKoh"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission5318/Reviewer_AKoh"
            ],
            "content": {
                "summary": {
                    "value": "This paper aims to tackle the problems of using GNNs for molecule generalization under the heterophilious input setting, where some conventional GNNs could fail on this setting due to their strong homophilious assumption. Specifically, the paper designs a new GNN model with three interactive flows to capture heterphiliy patterns in the molecular space. The effectiveness of the proposed model are validated by the experiments on several benchmark datasets for molecule generation and modelling."
                },
                "soundness": {
                    "value": "2 fair"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "2 fair"
                },
                "strengths": {
                    "value": "1. The paper is clear and well-structured.\n \n 2. The proposed ACL blocks in the model are shown to be inherently inversable."
                },
                "weaknesses": {
                    "value": "1. The level of homophily in a graph is defined based on node labels in GNN literature, where high homophily is observed when neighboring nodes share the same labels, and vice versa. However, In the design of the paper\u2019s heterophilious message passing layer, i.e., equation (6), they define the homophily of nodes as the cosine similarity between pair node embeddings. This could be problematic since the cosine similarity between pair node embeddings might not align with their labels. As a result, the proposed model may inherently fail to work well in the cases that the cosine similarity between pair node embeddings is not aligned with their labels.\n\n 2. Numerous GNN architectures have been developed for heterophilic graphs, where they have been demonstrated their effectiveness for heterophilious graphs comes from their ability to work as high-pass filters. However, there is no solid justification indicating that the proposed heterophilic flows can effectively handle heterophilic graphs. Additionally, it is also not clear that the benefits of the designed heterophilic flows, as compared to directly adapting existing heterophilic GNN structures for molecular generalization. More discussion here would be helpful.\n\n 3. Lack of ablation studies on different components. The proposed model consists of several components, including bond flow and heterophilious atom flow. Moreover, the heterophilic atom flow encompasses three interacting flows: the central, homophilic, and heterophilic flows. It remains unclear which component is most crucial or how each contributes to the model's overall performance. A detailed breakdown and analysis would provide greater clarity.\n\n 4. The paper claims that existing GNN models for molecule generalization have overlooked the repulsions between dissimilar atoms and are vulnerable to oversmoothing. However, it is not evident that the proposed model effectively addresses the oversmoothing issue. It would be better to provide more explanations on this and conduct experiments to validate the oversmoothing claim.\n \n 5. Given that this study seeks to address the challenges of heterophily and oversmoothing in GNNs for molecular generalization, it would be beneficial to delve deeper into papers on GNNs concerning heterophilious graphs and oversmoothing problems in the related work section."
                },
                "questions": {
                    "value": "Please refer to the weaknesses."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "5: marginally below the acceptance threshold"
                },
                "confidence": {
                    "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 3,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission5318/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698824769381,
            "cdate": 1698824769381,
            "tmdate": 1699636533334,
            "mdate": 1699636533334,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "srsPuhBYSM",
                "forum": "bZHz9WYs9z",
                "replyto": "Pr9nlChcsC",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission5318/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission5318/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Reply to review AKoh"
                    },
                    "comment": {
                        "value": "Thank you for your constructive feedback that helped us elucidate some important aspects of this work. We hope our response has sufficiently addressed your concerns, and translates into an increased score.\n\n**Q1:** *The potential insonsistency between node embeddings and labels. The reviewer finds defining cosine similarity as homophily is problematic.*  \n**A1:** This inconsistency appears in the node classification task as discussed in the general reply. Here the node features are the one-hot encoding of the node label (atom type). Since the node label is the learning target during the molecule generation, we need to design a substitute way to approximate the homophily/heterophily. The flow maps the sampled Gaussian embeddings back to the one-hot encoding of atom type (label), to be consistent with the definition of homophily of the final layer, we extend this concept to the intermediate layers as the cosine similarity between the node embeddings.\n\n1. The node features $x_v$ of node $v$ is initialized by the one-hot encoding of atom type. we can write this to be  this node \n$$ x_v = [1_{v=C}, 1_{v=N}, 1_{v=O}, 1_{v=F} ] $$\ne.g. for atom C, the node feature is $[1,0,0,0]$.\n\n2. In the flow, the node features are mapped into latent space with a Gaussian distribution. During the molecular generation process, we sample Gaussian distributed random vectors and map them back to node features at the final layer, then this feature is transferred to a node label. It means we don't know the node label until the final layer. To define the homophily for a node in the intermediate layer without a label, we choose the similarity between the half-transferred embeddings to be the homophily. This definition style is also consistent with the final layer.\n\n**Q2.1:** *Need to show the designed heterophilic flows expressive on heterophilic graphs.*  \n**A2.1:** This is not a node classification task but a generation task. It could be easy to show the ratio of the heterophilic nodes is correctly classified. But here for the generation task, the model is supposed to learn the data distribution, with as least missing information as possible. Traditional GNNs will smooth the high-frequency information on the graph easily. We provide example analysis and discussion in the general answer. \n\n**Q2.2:** *Why design the heterophilic flows but not directly adapt existing heterophilic GNN?*  \n**A2.2:** The difference between node classification and graph generation task are discussed at general reply. For molecular generation task, graph distribution learning requires avoiding any possible information loss. The existing heterophilic GNN could mitigate oversmoothing problem for node classification. The heterophilic GNNs are good at making heterophilic nodes distinguishable. But it's not enough for simply replacing traditional GNN by it in current problem scenorias, because it may ignores the subtle low-frequency in the homophilic data. Keeping both traditional GNN (in central flow) and extra two flows helps the model get distinguishable embeddings (from both low and high frequency) for all types of graph-structured data points.\n\n\n\n**Q3:** *The ablation study on different flows suggested.*   \n**A3:** Our model adds structure caring about heterophily/homophily based on MoFlow. And MoFlow utilizes the traditional GNN so loses the high-frequency information on heterophilic data. Thus MoFlow could be viewed as a single flow (HTFLows without heterophily and homophilic flows) for ablation study.\n\n**Q4:** *How does the model overcomes the issue of oversmoothing?*  \n**A4:** There is disscusion and example analysis in the general reply.\n\n**Q5:** *Suggestion: more content about heterophily in the related work section.*  \n**A5:** Following reviewer **VenB**'s comments, we are amending the related work section with more details and background on heterophily."
                    }
                },
                "number": 4,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission5318/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700512612706,
                "cdate": 1700512612706,
                "tmdate": 1700512612706,
                "mdate": 1700512612706,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "fbpdipZWes",
            "forum": "bZHz9WYs9z",
            "replyto": "bZHz9WYs9z",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission5318/Reviewer_x2it"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission5318/Reviewer_x2it"
            ],
            "content": {
                "summary": {
                    "value": "This paper proposes HTFlows, a flow-based method for molecular graph generation. It addresses heterophily in molecules while existing molecular graph generation methods using graph neural networks make a homophily assumption that neighboring nodes have similar features. HTFlows uses multiple interactive normalizing flows to model homophilic, heterophilic, and central node patterns to capture nuanced molecular dependencies. Extensive experiments benchmark performance on QM9 and ZINC-250K datasets in molecule generation and property optimization tasks. Key results show HTFlows achieves high validity without extra checks, optimizes target properties well, and generates high-quality diverse molecules."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "2 fair"
                },
                "strengths": {
                    "value": "This paper effectively addresses the challenge of modeling heterophily in molecular graphs, a problem that challenges conventional homophily-based approaches. The proposed interactive multi-flow architecture enables the capture of nuanced molecular patterns across varying homophily-heterophily levels, enhancing versatility in representation. The paper rigorously evaluates the proposed method across various metrics on standard molecule datasets. The performance of HTFlows is comprehensively demonstrated by comparing it to state-of-the-art baselines like GraphDF and MoFlow."
                },
                "weaknesses": {
                    "value": "The proposed HTFlows only brings improvements on limited metrics when compared to state-of-the-art baselines (as listed in Table A4, A5, and Table 3), which constrains its contribution and impact. Besides, it is unclear about the connections between the improved metrics and the introduced heterophilious triple flows. It would be more convincing to bring theoretical analysis and ablation study to demonstrate the effect of emphasizing heterophily."
                },
                "questions": {
                    "value": "1. Why the mixing of ACL in the heterophilous atom flow are performed one by one for each atom type rather than in parallel?\n2. It seems that the histograms in Fig. 6 and 7 do not match the results in Table A4 and A5. For example, why the molecular weights in Fig.6 are mainly 75~175, but the mean molecular weights in Table A4 are much smaller? Besides, as shown in Figure 7, the molecular weights of GraphDF seem to have a significantly lower mean value than MoFlow and HTFlows based on their histograms, but HTFlows has the lowest mean molecular weight as listed in Table A5."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "5: marginally below the acceptance threshold"
                },
                "confidence": {
                    "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                },
                "first_time_reviewer": {
                    "readers": [
                        "ICLR.cc/2024/Conference/Program_Chairs",
                        "ICLR.cc/2024/Conference/Submission5318/Senior_Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission5318/Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission5318/Reviewer_x2it"
                    ]
                }
            },
            "number": 4,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission5318/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1699234535811,
            "cdate": 1699234535811,
            "tmdate": 1700716836044,
            "mdate": 1700716836044,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "yZGRD9aOJ8",
                "forum": "bZHz9WYs9z",
                "replyto": "fbpdipZWes",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission5318/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission5318/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Reply to reviewer x2it"
                    },
                    "comment": {
                        "value": "We thank the reviewer for their comments. We reply to each concern/question below in the order received.\n\n**Q1:** *Limited improvement on all metrics.*  \n**A1:** We focus on showing the benefits of our HTFlows framework over MoFlow, which can be seen as a base. Rather than cherry-picking just a few metrics where we excel, we on purpose show a wide range of chemoinformatics metrics. Some of the metrics are a bit of a trade-off; improvement on one metric can have a negative influence on other metrics. For example, if a model would always generate molecules with only carbons, it will get 100% validity, but the diversity should be low. Especially on QM9 (that other works typically test on), we achieve very good performance overall.\n\n**Q2:** *What are the connections between the heterophily and the improved metrics?*.  \n**A2:**  Generative model aims to learn the distributions related to several important patterns from the dataset. Most GNN-based models fail to capture enough information from the heterophilic graph data since the message-passing scheme smooths the graph embeddings after several layers. These improved metrics are good indicators showing the better distribution learning of our model.\n\n**Q3:** *The HTFlows' structure: why design mixing ACL iteratively but not in parallel?*  \n**A3:** The different flows learn different types of information. We design the interactions for different channel so that they could also utilize the information from other patterns. However, for the reversibility, ACL updates one part of data by another part, which means there is always an order for which part is updated (impossible to update all at the same time, otherwise the structure is not reversible anymore). More layers of the current design can also make sure enough interactions compared to parallel design.\n\n**Q4:** *Inconsistency between weight histogram (Fig 6,7) and tables (Table A4, A5)*  \n**A4:** They are consistent. As described in App. C, the metrics in Table A4\u2013A5 are the Wasserstein distance/discrepancy metric between the generated molecules and the original data set, summarizing the histogram result into one number."
                    }
                },
                "number": 3,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission5318/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700512324058,
                "cdate": 1700512324058,
                "tmdate": 1700512324058,
                "mdate": 1700512324058,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "UtEl3gU4LB",
                "forum": "bZHz9WYs9z",
                "replyto": "yZGRD9aOJ8",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission5318/Reviewer_x2it"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission5318/Reviewer_x2it"
                ],
                "content": {
                    "comment": {
                        "value": "Thanks for the authors' response that addresses my concerns and questions. I have increased my score to 5 based on the revised version."
                    }
                },
                "number": 10,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission5318/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700717073414,
                "cdate": 1700717073414,
                "tmdate": 1700717073414,
                "mdate": 1700717073414,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    }
]