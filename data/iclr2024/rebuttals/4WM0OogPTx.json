[
    {
        "title": "Learning from Sparse Offline Datasets via Conservative Density Estimation"
    },
    {
        "review": {
            "id": "f4z9l1dyeC",
            "forum": "4WM0OogPTx",
            "replyto": "4WM0OogPTx",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission6012/Reviewer_6pFf"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission6012/Reviewer_6pFf"
            ],
            "content": {
                "summary": {
                    "value": "The paper proposes an Offline RL algorithm called Conservative Density Estimation (CDE) incorporating pessimism within the stationary distribution space. Extensive empirical study shows that CDE outperforms existing baselines in both the sparse-reward settings and the scarce-data settings."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "4 excellent"
                },
                "strengths": {
                    "value": "The authors present a novel method of mixing pessimistic-based methods with DICE-style methods. Unlike other pessimistic methods that balance pessimism using a hyperparameter called a penalty coefficient, CDE finds the optimal balance based on theoretical grounds. The paper also introduces a new way to convert dense-reward MuJoCo tasks into a sparse-reward setting based on the trajectory return. Together with the scarce-data setting experiments, the two additional benchmarks can help test the robustness of offline RL algorithms. Finally, the arguments provided by the authors are mathematically sound."
                },
                "weaknesses": {
                    "value": "1. \u00a73.2.1 states that the strong duality holds due to Slater's condition. The fact that the optimization problem of our interest satisfies Slater's condition does not seem trivial.\n\n2. The RHS of (7) may not exist. For example, $\\tilde{A}(s, a)$ might be negative.\n\n3. According to \u00a7B.2.2, the authors set $d^*(s)$ as a uniform distribution on the state in the successful trajectories. It would have been better if this explanation were included in the main paper. I am doubtful that this distribution will be close to $\\tilde{w}^*(s, a)\\hat{d}^{\\mathcal{D}}(s, a)$, though.\n\n### Minor comments\n\n1. (18), (19) \u21d2 the summation should also be over $s$ and $s'$, respectively\n\n2. (29) \u21d2 $d^{\\mathcal{D}}$ in the second expectation \u2192 $\\mu$"
                },
                "questions": {
                    "value": "1. How are the OOD actions sampled? Do you just sample a random action and reject it if it is in distribution?\n\n2. Does Slater's condition also hold for optimization problems dealing with infinite-dimensional vectors (i.e., functions)?"
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "8: accept, good paper"
                },
                "confidence": {
                    "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                },
                "first_time_reviewer": {
                    "value": "Yes",
                    "readers": [
                        "ICLR.cc/2024/Conference/Program_Chairs",
                        "ICLR.cc/2024/Conference/Submission6012/Senior_Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission6012/Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission6012/Reviewer_6pFf"
                    ]
                }
            },
            "number": 1,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission6012/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698796790956,
            "cdate": 1698796790956,
            "tmdate": 1699636644901,
            "mdate": 1699636644901,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "et3rhakv5R",
                "forum": "4WM0OogPTx",
                "replyto": "f4z9l1dyeC",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6012/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6012/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Response to Reviewer 6pFf"
                    },
                    "comment": {
                        "value": "We thank the reviewer for careful review and valuable suggestions. \n\n- **W1. Why does the Slater's condition of optimization problem in eq.(2)~(4) hold.**\n  \n  Thanks for pointing out this question. Here the Slater's condition is that there exists a strictly feasible $d(s,a)$ s.t. the equality constraint in eq.(3) holds while constraint in eq.(4) is satisfied with strict inequality. One strictly feasible solution is empirical dataset distribution $d^D(s,a)$: (1) Bellman flow constraint $\\sum_a d^D(s,a)=(1-\\gamma)\\rho_0(s) + \\mathcal{T}_* d^D(s)$ holds because the dataset is sampled from real environment; (2) $d^D(s,a)=0<\\epsilon \\mu(s,a),\\forall s,a\\in\\text{supp}(\\mu)$ by definition of $\\mu$. Therefore, the Slater's condition holds.\n  \n  We have added it in appendix A.1 in revision to make our statement more clear.\n  \n- **W2. RHS of eq.(7) may not exist when $\\tilde{A}(s,a)<0$**\n  \n  Actually, it still holds when $\\tilde{A}(s,a)<0$ because we assume $(f')^{-1}(x)>0, \\forall x\\in \\mathbb{R}$ in Assumption 1. \n  In practice, we adopt soft-chi function as $f$ as mentioned in **training details** in page 7, where\n  $$\n  f_{\\text{soft}-\\chi^2}(x) = \n  \\begin{cases}\n  x\\log x -x +1, 0<x<1\\\\\\\\\n  (x-1)^2/2,x\\geq 1\n  \\end{cases}\n  $$\n  Therefore, \n  $$\n  (f')^{-1}(x) = \n  \\begin{cases}\n  e^{x},x<0\\\\\\\\\n  x+1,x\\geq 0\n  \\end{cases}\n  $$\n  This satisfies the above assumption and thus we still can compute RHS of eq.(7) when $\\tilde{A}(s,a)<0$.\n \n- **W3. Set $d^{*}(s)$ as a uniform distribution on the state in the successful trajectories. Why is it close to $\\tilde{w}(s,a)\\hat{d}^D(s,a)$.**\n  \n  $d^*(s)$ denotes the state distribution of optimal policy $\\pi^*$, and $\\pi^*$ should always succeed in any trajectory. So we believe it is reasonable to approximate $d^*(s)$ as the empirical distribution of the given successful trajectories.\n  \n  The empirical distribution can be close to the state margin of $d^*(s,a)$ (i.e., $\\sum_a \\tilde{w}(s,a)\\hat{d}^D(s,a)$): the state-action pair $(s,a)$ in failed trajectories should have a smaller importance ratio $\\tilde{w}(s,a)$ than $(s,a)$ in successful trajectories; therefore, the density of $s$ from successful trajectories should also be much larger than $s$ from failure ones. Meanwhile, since it is infeasible to do summation of $\\sum_a \\tilde{w}(s,a)\\hat{d}^D(s,a)$ over $a$ in continuous space to directly compute the state margin, we use the approximation for easy computation.\n  \n\n- **Q1. How are the OOD actions sampled? Do you just sample a random action and reject it if it is in distribution?** \n  \n  Yes, we uniformly sample an action and reject it if it is in distribution.\n  \n- **Q2. Does Slater's condition also hold for optimization problems dealing with infinite-dimensional vectors (i.e., functions)?**\n  \n  Yes. In fact, the stationary distribution $d:\\mathcal{S}\\times\\mathcal{A}\\rightarrow [0,1]$ is indeed a function if we consider continuous state-action space, which is the case of our experiment. Meanwhile, we can observe that the empirical dataset distribution $d^D(\\cdot, \\cdot)$ is still strictly feasible for optimization in eq.(2)~(4). Therefore, the Slater's condition still holds.\n  \n- **Minor issues.** \n  \n  Thanks for your careful check, we have corrected them in revision.\n\nThanks again for your feedback. We hope our response addresses your main concerns."
                    }
                },
                "number": 5,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6012/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700163891737,
                "cdate": 1700163891737,
                "tmdate": 1700167496545,
                "mdate": 1700167496545,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "uvi08eiWob",
                "forum": "4WM0OogPTx",
                "replyto": "et3rhakv5R",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6012/Reviewer_6pFf"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6012/Reviewer_6pFf"
                ],
                "content": {
                    "comment": {
                        "value": "Thank you for your detailed response.\n\n**W1** Under stochastic transition dynamics, I believe the Bellman flow constraint does not hold for $d^{\\mathcal{D}}$ because the LHS is a discrete distribution while the RHS is a continuous one.\n\n**W2** I thought the assumption was $f'(x)\\ge 0$ for all $x$. Sorry for the confusion."
                    }
                },
                "number": 9,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6012/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700649395934,
                "cdate": 1700649395934,
                "tmdate": 1700649395934,
                "mdate": 1700649395934,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "0DhMM0eKRU",
            "forum": "4WM0OogPTx",
            "replyto": "4WM0OogPTx",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission6012/Reviewer_MKs2"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission6012/Reviewer_MKs2"
            ],
            "content": {
                "summary": {
                    "value": "The paper proposes a density estimation-based offline RL algorithm that aims to incorporate the strengths of value penalization-based offline RL methods and DICE-based offline RL methods. The proposed method outperforms the certain baselines in considered sparse reward D4RL tasks."
                },
                "soundness": {
                    "value": "2 fair"
                },
                "presentation": {
                    "value": "2 fair"
                },
                "contribution": {
                    "value": "2 fair"
                },
                "strengths": {
                    "value": "- The proposed method outperforms the considered baselines significantly in maze2d tasks.\n- The motivation which is to achieve the best of both worlds (between the value penalization methods and the DICE-based methods) is solid."
                },
                "weaknesses": {
                    "value": "- Some clarifications are required in the introduction section. 1) \"pessimism-based techniques may be prone to over-pessimism, especially in high-dimensional state-action spaces\" => why is over-pessimism a bigger problem for high-dimensional state-action spaces? 2) \"regularization methods often struggle with the tuning of the regularization coefficient\" => Why does the author think this is true? The cited paper seems to be about DICE and not about regularization methods. Additionally, IQL (which is a baseline considered in the paper) uses the same hyperparameters for experiments in the same domain, just like the proposed method.\n- The considered tasks are not thorough. First, there are no experiment results on D4RL Gym *-medium-replay datasets, which contain trajectories that vary significantly in performance. These datasets can test if the proposed method can handle datasets with mixed quality. Second, on Adroit, I am curious on why the authors did not include the *-cloned datasets while including *-human datasets. Third, some important tasks with sparse reward are missing: Antmaze and Kitchen. These tasks are much harder than simple maze2d and at the same time have sparse rewards.\n- Some important baselines are missing. To name a few, DecisionTransformer [1] and Diffuser [2] also claim they have strength in the sparse reward settings.\n\n[1] Chen et al., Decision Transformer: Reinforcement Learning via Sequence Modeling, NeurIPS 2021.\n\n[2] Janner et al., Planning with Diffusion for Flexible Behavior Synthesis, ICML 2022."
                },
                "questions": {
                    "value": "- On sparse-MuJoCo tasks, how does the proposed method and the baselines perform if you change the cut-off percentile (which is currently 75)?\n- How does the proposed method perform compared to the baselines on dense reward settings?"
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "5: marginally below the acceptance threshold"
                },
                "confidence": {
                    "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 2,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission6012/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698834030221,
            "cdate": 1698834030221,
            "tmdate": 1699636644807,
            "mdate": 1699636644807,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "2blZrz7s4q",
                "forum": "4WM0OogPTx",
                "replyto": "0DhMM0eKRU",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6012/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6012/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Response to Reviewer MKs2 (1/2)"
                    },
                    "comment": {
                        "value": "We thank the reviewer for valuable feedback.\n\n- **W1. Some clarifications are required in the introduction section.** \n\n  - **Why is over-pessimism a bigger problem for high-dimensional state-action spaces?**\n    \n    Our statement is based on (1) the accurate data distribution estimation is more difficult when space is high-dimensional, and (2) it is relatively harder to overcome over-pessimism issue with large estimation error on data distribution [1][2]. But we also concede that the over-pessimism is not necessarily more severe when space is high-dimensional. We have modified our statements accordingly and thanks for pointing it out.\n    \n  - **Why do regularization methods struggle with the tuning of the regularization coefficient?**\n  \n    We do agree many offline RL methods can achieve good performances on different tasks with similar hyper-parameters such as IQL or TD3+BC. However, there are also some methods [3][4] requiring finetuning the regularization coefficient. \n    \n    Although the cited paper is DICE-based, it adds a f-divergence regularization in the objective. This paper also finetunes the coefficient in different tasks.\n  \n  Thanks for your careful check. We update statements in revision and make them more rigorous now.\n  \n\n- **W2. The considered tasks are not thorough.**\n  \n  Thanks for your questions. We add more experiment results as follows.\n  - Mujoco medium-replay tasks.\n    |                 | BCQ      | CQL       | IQL      | TD3+BC    | CDE (Ours)   |\n    | --------------- | -------- | --------- | -------- | --------- | ------------ |\n    | halfcheetah-m-r | 91.0\u00b12.2 | 48.0\u00b114.9 | 70.7\u00b13.7 | 61.0\u00b116.3 | **95.2\u00b13.5** |\n    | walker2d-m-r    | 85.7\u00b18.4 | 78.3\u00b111.2 | 4.0\u00b14.9  | 84.4\u00b17.3  | **90.4\u00b15.0** |\n    | hopper-m-r      | 91.4\u00b15.2 | 87.0\u00b15.1  | 0.0\u00b10.0  | 89.0\u00b14.1  | **93.3\u00b14.6** |\n    \n    CDE exceeds the compared baselines on medium-replay tasks.\n    \n  - Adroit cloned tasks.\n    |                 | BCQ  | CQL  | IQL     | CDE (Ours)    |\n    | --------------- | ---- | ---- | ------- | ------------- |\n    | pen-cloned      | 44.0 | 39.2 | 37.3    | **56.9\u00b113.2** |\n    | hammer-cloned   | 0.4  | 2.1  | 2.1     | **3.3\u00b11.7**   |\n    | door-cloned     | 0.0  | 0.4  | **1.6** | 0.3\u00b10.1       |\n    | relocate-cloned | -0.3 | -0.1 | -0.2    | **0.4\u00b10.3**   |\n    \n    We did not include them in our original manuscript because both the offline data (collected by a policy which is trained by behavioral cloning on human \"tasks\") and final performances are similar to \"human\" tasks. Our method still obtains the best or comparable performances on most tasks. We have added the new experiments in appendix B.3.2 in revision.\n    \n  - Antmaze and kitchen tasks.\n    \n    In antmaze and kitchen tasks, the initial distributions are significantly different between training and test settings, which violates the basic assumption of CDE. For the antmaze tasks, the starting point can be anywhere in the offline dataset but is always at the same corner when tested. The mismatch also happens on kitchen tasks. On the contrary, the optimization objective of CDE (eq.(6)) is given by initial distribution $\\rho_0$ and $d^D$, requiring the consistency of initial distribution. As we mentioned in \"Conclusion\" section, one direction to overcome this inconsistency is to incorporate goal-conditioned setting, which we leave as a future work.\n    \n- **W3. Some baselines are missing, e.g., DT and Diffuser.**\n  \n  Thanks for your suggestion on baselines. We add comparison as follows (we report normalized score for maze2d and success rate for sparse mujoco).\n  |                           | Decision Transformer | Diffuser     | CDE (Ours)     |\n  | ------------------------- | -------------------- | ------------ | -------------- |\n   maze2d-umaze              | 21.1\u00b125.4            | 113.9\u00b13.1    | **134.1\u00b110.4** |\n  | maze2d-medium             | 29.7\u00b113.3            | 121.5\u00b12.7    | **146.1\u00b113.1** |\n  | maze2d-large              | 41.7\u00b114.1            | 123.0\u00b16.4    | **210.0\u00b113.5** |\n  | halfcheetah-medium        | 39.7\u00b11.9             | 66.7\u00b110.2    | **82.0\u00b18.6**   |\n  | walker2d-medium           | 10.3\u00b12.1             | 46.3\u00b116.7    | **53.0\u00b111.7**  |\n  | hopper-medium             | 63.0\u00b119.9            | **94.0\u00b12.8** | 85.5\u00b15.7       |\n  | halfcheetah-medium-expert | 0.0\u00b10.0              | 0.0\u00b10.0      | **95.2\u00b12.9**   |\n  | walker2d-medium-expert    | 0.0\u00b10.0              | 74.0\u00b111.0    | **97.0\u00b12.8**   |\n  | hopper-medium-expert      | 0.0\u00b10.0              | 92.7\u00b15.0     | **97.0\u00b11.4**   |\n  \n  Our method exceeds DT and diffuser on most tasks. Despite of its notable performances in dense reward setting, the performances of DT drop remarkably in sparse reward setting, indicating DT heavily relies on dense reward to train the transformer and supervise policy learning."
                    }
                },
                "number": 6,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6012/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700164281534,
                "cdate": 1700164281534,
                "tmdate": 1700167381214,
                "mdate": 1700167381214,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "9gU3hkIiLE",
                "forum": "4WM0OogPTx",
                "replyto": "0DhMM0eKRU",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6012/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6012/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Response to Reviewer MKs2 (2/2)"
                    },
                    "comment": {
                        "value": "- **Q1. The performances on sparse-mujoco with different cut-off percentiles.**\n  \n  Since CDE exceeds the baselines by a large margin on \"-medium-expert\" tasks, we test the performances with 90 percentile and 50 percentile as cut-off thresholds on \"-medium\" level tasks. The results are as follows:\n\n  **The success rate of CDE and baselines with cut-off percentile=90**\n  |                    | BCQ       | CQL          | IQL      | TD3+BC    | CDE (Ours)    |\n  | ------------------ | --------- | ------------ | -------- | --------- | ------------- |\n  | halfcheetah-medium | 25.8\u00b111.7 | **88.0\u00b11.8** | 56.0\u00b13.6 | 48.5\u00b121.2 | 81.2\u00b12.9      |\n  | walker2d-medium    | 34.8\u00b110.6 | 1.5\u00b10.7      | 3.3\u00b12.1  | 2.5\u00b13.5   | **53.5\u00b114.8** |\n  | hopper-medium      | 1.2\u00b10.8   | 65.3\u00b16.3     | 0.0\u00b10.0  | 0.0\u00b10.0   | **74.2\u00b15.7**  |\n  \n  **The success rate of CDE and baselines with cut-off percentile=50**\n  |                    | BCQ      | CQL          | IQL      | TD3+BC    | CDE (Ours)   |\n  | ------------------ | -------- | ------------ | -------- | --------- | ------------ |\n  | halfcheetah-medium | 73.7\u00b12.5 | **99.3\u00b10.9** | 93.5\u00b11.1 | 37.0\u00b124.1 | 92.5\u00b12.8     |\n  | walker2d-medium    | 38.0\u00b11.2 | 47.6\u00b117.1    | 18.7\u00b12.5 | 15.7\u00b110.8 | **67.0\u00b15.0** |\n  | hopper-medium      | 9.3\u00b11.9  | **90.0\u00b10.8** | 6.0\u00b17.8  | 0.0\u00b10.0   | 88.0\u00b15.7     |\n  \n  When the percentile decreases, the reward becomes denser, and the threshold of success is lower. Therefore, the most baselines have higher success rate. We notice that CDE keeps relative high performance with 90 cutoff percentile. Meanwhile, CDE still obtains comparable performances with 50 percentile (CQL performs well in original 75 percentile setting).\n  \n- **Q2. The performance on dense reward settings.**\n\n  We directly adopt the reported scores of baselines from original paper or D4RL benchmark and compare CDE with them. \n  |                           | BCQ       | CQL      | IQL      | TD3+BC   | CDE           |\n  | ------------------------- | --------- | -------- | -------- | -------- | ------------- |\n  | halfcheetah-medium        | 40.7      | **49.1** | 47.4     | 48.3     | 43.3\u00b12.9      |\n  | walker2d-medium           | 54.5      | 82.9     | 78.3     | **83.7** | 73.8\u00b14.4      |\n  | hopper-medium             | 53.1      | 64.6     | **66.3** | 59.3     | 51.2\u00b13.7      |\n  | halfcheetah-medium-expert | 64.7      | 85.8     | 86.7     | **90.7** | 75.6\u00b17.2      |\n  | walker2d-medium-expert    | **110.9** | 109.5    | 109.6    | 110.1    | 107.7\u00b110.4    |\n  | hopper-medium-expert      | 57.5      | 102.0    | 91.5     | 98.0     | **108.6\u00b14.8** |\n  \n  While CDE may not outperform the baselines in dense reward settings, it achieves a significantly higher success rate when reward is sparse, which indicates that the baseline performances are predominantly reliant on dense rewards, thereby highlighting the effectiveness of CDE for sparse-reward offline data.\n\nReferences:\n\n[1] Provably good batch off-policy reinforcement learning without great exploration\n\n[2] Bellman-consistent pessimism for offline reinforcement learning\n\n[3] Conservative q-learning for offline reinforcement learning\n\n[4] Mildly conservative Q-learning for offline reinforcement learning"
                    }
                },
                "number": 7,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6012/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700164441011,
                "cdate": 1700164441011,
                "tmdate": 1700164441011,
                "mdate": 1700164441011,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "WcTEkP1sbM",
            "forum": "4WM0OogPTx",
            "replyto": "4WM0OogPTx",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission6012/Reviewer_HRnW"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission6012/Reviewer_HRnW"
            ],
            "content": {
                "summary": {
                    "value": "This paper proposes a new offline RL method, called Conservative Density Estimation (CDE). It builds upon the DICE work by utilizing the state-action occupancy stationary distribution. However, the DICE type work requires the assumption on the concentrability, and the boundedness of the IS ratio for stable training. This paper tries to address this by introducing pessimism on the state-action stationary distribution, via a similar principle like conservative Q-learning."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "3 good"
                },
                "strengths": {
                    "value": "- This paper points out the two type of approaches for offline RL, conservative Q-value based, which might perform worse under sparse reward setting due to iterative Bellman update; and DICE based, which implicitly relies on the concentrability. The proposed method nicely combines these two approaches, via a pessimism approach on the state-action stationary occupancy, which is a neat idea especially on the sparse reward setup.\n\n- The paper is very well-written and easy to read. The method is very well-motivated, and clearly described, from policy evaluation to policy extraction. It also shows theoretical guarantees regarding to the concentrability bound, as well as performance gap. \n\n- The experiments on sparse reward settings and small data regime is interesting, and support the CDE's effectiveness, especially at the sparse reward setup."
                },
                "weaknesses": {
                    "value": "- Some parts of the method need to be dived into more details, for example, the CDE policy update happens when the value function converges. This also marks a difference compared with classical actor-critic methods, is it a key component in improving the empirical performance? \n\n- More hyper-parameters introduced by the algorithm, such as the max OOD IS ratio, the mixture coefficient, etc. The ablation study on the mixture coefficient is interesting, demonstrating the robustness and giving some empirical guidelines on how to pick them. However, the study of max OOD IS ratio, though interesting, it does not provide any meaningful guidelines on how to choose them for various environments and applications. \n\n- A clear understanding between CDE and CQL is missing, one is pessimism on the state-action state-action occupancy stationary distribution, the other is on the value function. Figure 2(d) only probably only shows the performance of CQL for a fixed pessimism-coefficient, it would be great to compare these two methods in detail, both theoretically and empirically."
                },
                "questions": {
                    "value": "See Weakness."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "6: marginally above the acceptance threshold"
                },
                "confidence": {
                    "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 3,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission6012/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1699133162904,
            "cdate": 1699133162904,
            "tmdate": 1699636644695,
            "mdate": 1699636644695,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "YGjFouNMTZ",
                "forum": "4WM0OogPTx",
                "replyto": "WcTEkP1sbM",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6012/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6012/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Response to Reviewer HRnW"
                    },
                    "comment": {
                        "value": "We thank the reviewer for valuable review and address the concerns as follows.\n\n- **W1. The effectiveness of \"warm-up\" stage for value function training.**\n  \n  We use \"warm-up stage\" to refer to \"policy update happens when the value function converges\". We adopt warmup because (1) the value function is not well learned in the early stage and thus it cannot well guide the policy learning at that time, and (2) warm-up also reduces the computation overhead because policy update is stopped. \n\n  Meanwhile, the warm-up stage does not influence the final performances significantly. We give an ablation study on maze2d tasks (w. warm-up means stopping policy update at the beginning; w.o. warm-up means training value and policy together from start) and present results as follows:\n  | Task          | w. warmup  | w.o. warmup |\n  | ------------- | ---------- | ----------- |\n  | maze2d-umaze  | 134.1\u00b110.4 | 136.2\u00b113.2  |\n  | maze2d-medium | 146.1\u00b113.1 | 141.7\u00b117.3  |\n  | maze2d-large  | 210.0\u00b113.5 | 205.4\u00b115.4  |\n   \n  \n- **W2. More parameter studies. The study of max OOD IS ratio does not provide guideline.**\n\n  We include more parameter studies in appendix B.4 in original manuscript. We can observe that the performance of CDE is not sensitive to the most hyperparameters except max OOD IS ratio and mixture coefficient. For mixture coefficient, we can simply choose $\\zeta$ to be close to 1 (e.g., set $\\zeta=0.9$) by analysis in fig.3.\n  \n  For the max OOD IS ratio, we agree that this study does not directly offer guidance on selecting $\\tilde{\\epsilon}$ when encountering new tasks. Nonetheless, by consistently employing the same $\\tilde{\\epsilon}$ across all experiments, we demonstrate its broad applicability to a variety of tasks. Meanwhile, our parameter study in appendix B.4.1 also shows that CDE is relatively resilient to the change of $\\tilde{\\epsilon}$. But we also admit that we may need to fine-tune it for specific new tasks.\n  \n  \n- **W3. Compare CDE and CQL in detail, both theoretically and empirically.**\n  \n  Thanks for your suggestions. \n  \n  As the reviewer mentioned, CDE and CQL apply pessimism on state-action occupancy distribution and Q-value function respectively. But in theory, we can also link them by the eq.(7), which shows that the optimal IS ratio is related to the value function. The main difference is that CQL adds an expectation of Q value on OOD region as a soft regularization with coefficient $\\alpha$ while CDE enforces a direct constraint on IS ratio (can be also viewed as a constraint on advantage value by eq.(7)), which allows for more precise control on conservativeness for CDE. \n  \n  We also provides some empirical results on maze2d-large task*. We test the performances of CQL with different regularization coefficient $\\alpha$.\n  | $\\alpha$     | 0.1      | 0.5  | 1.0      | 5.0     | 10.0    |\n  | ------------ | -------- | ---- | -------- | ------- | ------- |\n  | maze2d-large | -0.1\u00b11.1 | 98.2\u00b124.8 | 57.8\u00b18.1 | 4.5\u00b13.7 | 0.4\u00b13.0 |\n  \n  We can observe that CQL does achieve high score with $\\alpha=0.5$. However, compared to CDE (see table 10 in appendix for parameter study of CDE), CQL's performance exhibits extreme sensitivity to the choice of $\\alpha$. This sensitivity creates a challenging balance in fine-tuning the hyperparameter, oscillating between over-pessimism and substantial extrapolation error in OOD regions.\n  \n  (*) We directly adopt results of CQL ($\\alpha=5.0$) from D4RL benchmark in our original manuscript, which is a little different from the re-run results with $\\alpha=5.0$.\n  \nThanks again and we hope our response addresses your main concerns."
                    }
                },
                "number": 4,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6012/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700163543339,
                "cdate": 1700163543339,
                "tmdate": 1700166146844,
                "mdate": 1700166146844,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "WZAczUe8lr",
            "forum": "4WM0OogPTx",
            "replyto": "4WM0OogPTx",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission6012/Reviewer_voqr"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission6012/Reviewer_voqr"
            ],
            "content": {
                "summary": {
                    "value": "In this work the authors propose CDE, an offline algorithm that builds upon a similar formulation as that of the DICE method of Nachum et al. In DICE the state-action distribution is optimized in order to maximize the reward under that distribution subject to an f-divergence regularization between the visit distribution and the empirical distribution under observed data. In additiona this optimization problem is constrained such that the state-action visit distribution is a valid discounted distribution under the initial-state and transition model of the MRP. Where CDE departs from DICE is in introducing an additional constraint such that the state-action distribution function evaluated at any state-action is less than a multiplicative factor of epsilon of some alternative distribution mu defined to have support only over out-of-distribution actions, and where mu is restricted to have the same marginal state distribution as the empirical distribution. Given this formulation the state-action distribution can then be optimized and the policy implied by this distribution can be extracted from the distribution. Additionally the authors extend the f-divergence to include an f-divergence with an extended distribution which mixes the empirical and mu distribution which a trade-off factor.\n\nBased on these results the authors present some theoretical results bounding the importance ratio and bound the performance gap. The authors also provide a number of results on maze2d tasks and sparse mujoco tasks, predominantly showing that their method outperforms other comparable offline RL algorithms."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "3 good"
                },
                "strengths": {
                    "value": "Overall the paper was quite good and the algorithm was well presented, albeit quite dense. The theoretical results do add to the paper (although I'm not sure how much) and the results were quite good and well presented."
                },
                "weaknesses": {
                    "value": "Overall the paper was good and from my perspective merits inclusion at ICLR. My only real criticism of the work lies in its presentation, which although good I felt was dense. And the precise differences with e.g. DICE could have been made more clear, i.e. I would have liked to see more discussion of the effects of the additional constraint. To that end I'm not sure how much was added by the theoretical contributions of this work which could have been rather spent on explaining these differences at a higher level. And to be clear, I think the theorem(s) are useful, but since the proof itself and some of the underlying assumptions could not be included due to space constraints I'm not sure if these would not have been better moved into the appendix as a whole."
                },
                "questions": {
                    "value": "See above."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "8: accept, good paper"
                },
                "confidence": {
                    "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                },
                "first_time_reviewer": {
                    "readers": [
                        "ICLR.cc/2024/Conference/Program_Chairs",
                        "ICLR.cc/2024/Conference/Submission6012/Senior_Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission6012/Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission6012/Reviewer_voqr"
                    ]
                }
            },
            "number": 4,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission6012/-/Official_Review"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1699638853705,
            "cdate": 1699638853705,
            "tmdate": 1699638853705,
            "mdate": 1699638853705,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "JKtUfEKIY7",
                "forum": "4WM0OogPTx",
                "replyto": "WZAczUe8lr",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6012/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6012/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Response to Reviewer voqr"
                    },
                    "comment": {
                        "value": "We thank the reviewer for valuable review and address the main concerns as follows.\n- **Precise differences with DICE could have been made more clear; more discussion of the effects of the additional constraint.**\n  \n  We summarize the key differences of CDE from previous DICE method:\n  \n  1. In theory, CDE has an upper bound for concentrability ratio on OOD regions (Proposition 3). We also derive the upper bound in context of function approximation (Theorem 1). Therefore, the additional constraint avoids the arbitrarily large IS ratio and can mitigate issues caused by extrapolation error on OOD regions.\n  2. We further derive the performance gap bound in Theorem 2, which is absent in previous DICE paper. \n  3. Empirically, we verify the effectiveness of additional constraint on various tasks. The OOD constraint can reduce potential extrapolation error so we study the situations where offline data are scarce (i.e., the occupied state-action pairs are sparse in the whole space) and thus the OOD issue is more severe. From fig.1, we can find that CDE significantly outperforms optidice when offline data are limited.\n  \n- **The theorem part can be better organized, e.g., to make the statement of theorem, assumption, and proof as a whole.**\n  \n  Thanks for your suggestion. As you mentioned, we may not be able to insert proof into main text. So we repeat the statement of theorems in appendix to make them more readable and we also keep them in main test. The modification can be found in appendix part in revision.\n\nThanks again for your feedback and we will emphasize them in the paper. We are more than glad to clarify it if you have further questions.\n\nReferences:\n\n[1] Nachum, Ofir, and Bo Dai. \"Reinforcement learning via fenchel-rockafellar duality.\" arXiv preprint arXiv:2001.01866 (2020).\n\n[2] Lee, Jongmin, et al. \"Optidice: Offline policy optimization via stationary distribution correction estimation.\" International Conference on Machine Learning. PMLR, 2021."
                    }
                },
                "number": 3,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6012/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700163150168,
                "cdate": 1700163150168,
                "tmdate": 1700165780561,
                "mdate": 1700165780561,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    }
]