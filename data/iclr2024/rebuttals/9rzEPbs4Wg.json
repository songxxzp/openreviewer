[
    {
        "title": "Improving Generalization and Safety of Deep Neural Networks with Masked Anchoring"
    },
    {
        "review": {
            "id": "fZxBWasaIu",
            "forum": "9rzEPbs4Wg",
            "replyto": "9rzEPbs4Wg",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission7985/Reviewer_8fzY"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission7985/Reviewer_8fzY"
            ],
            "content": {
                "summary": {
                    "value": "The authors explore the anchoring\u2019s role in the generalization and safety properties of models. Based on this insight, the authors uncover that anchoring can be a training mechanism to improve generalization and safety."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "3 good"
                },
                "strengths": {
                    "value": "The authors show the relationship between generalization ability and residual sensitivity.\n\nThis paper is well-written and easy to follow, and the method is simple and implementable.\n\nThe experimental results are extensive."
                },
                "weaknesses": {
                    "value": "Masking probability $\\alpha$ is a hyperparameter in the algorithm, which is difficult to estimate in practice.\n\nMasking can reduce the sensitivity of the model to residual, but why can masking promote the smoothness of the model?"
                },
                "questions": {
                    "value": "Please refer to the questions in the Weaknesses."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "6: marginally above the acceptance threshold"
                },
                "confidence": {
                    "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 1,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission7985/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698483769229,
            "cdate": 1698483769229,
            "tmdate": 1699636983484,
            "mdate": 1699636983484,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "WrJeNjeyq2",
                "forum": "9rzEPbs4Wg",
                "replyto": "fZxBWasaIu",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission7985/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission7985/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Author Response - Reviewer 8fzY"
                    },
                    "comment": {
                        "value": "Thank you for the positive assessment of our work. If our responses sufficiently address all the concerns raised, we request you to improve the score and champion our paper.\n\n> **Choice of hyper-parameter $\\alpha$:** \n\n+ The parameter $\\alpha$ directly controls the schedule of residual corruption during training. Simply put, arbitrarily increasing $\\alpha$ will start to adversely affect the training convergence and eventually the ID performance itself. In our study, we selected it solely based on two factors: We wanted to use a high value of $\\alpha$ (for improved generalization), such that it can converge in the same number of epochs as that of anchoring w/o RAM, and can produce validation accuracies comparable (or better) than the non-anchored model. \n\n+ Based on our experiments with CIFAR-10, CIFAR-100 and ImageNet across multiple architectures (RegNet, ResNet, WRN40-2, DEIT, ViTb and SWINv2) $\\alpha = 0.2$ is a recommended setting. Similar to any existing regularization strategy (e.g., Mixup) adopted for improving generalization, RAM with high $\\alpha$ might have the risk of producing models with reduced sensitivity towards anomalous data (i.e., compared to anchoring w/o RAM). However, we find that with $\\alpha = 0.2$, the anomaly rejection trade-off is minimal and interestingly, it can even lead to higher rejection AUROC scores using networks with higher capacity (e.g., SWINv2-B, updated Table 2 in the paper).\n\n> **How does RAM help anchoring?** \n\nPlease check our detailed answer to this central question in the summary response. For completion, we include a summary here.\n\n+ To clarify this, we begin by considering generalization to an OOD test sample. In the tuple $(\\mathrm{r}, \\Delta)$ for the test sample $\\mathrm{x}_t$, the anchor $\\mathrm{r} \\in P(R)$ and it is possible that $\\Delta = \\mathrm{x}_t - \\mathrm{r}$ can be novel to P($\\Delta$). Thus, by exposing the model to more diverse combinations of $(\\mathrm{r}, \\Delta)$ during training, generalization can be improved. A naive way to improve the diversity of P($\\Delta$) (or equivalently P($X, \\Delta$)) is to consider a wider anchor distribution (i.e., $P(R) \\supset P(X) $). However, it is non-trivial to characterize the anchor distribution and arbitrarily improve its diversity; and increasing anchor diversity will lead to a combinatorially larger space (anchor, residual) pairs, which can in turn require larger number of epochs to effectively converge.\n\n+ We adopt an alternative approach to increasing diversity of P($\\Delta$) by making the residuals noisy, and propose a simple implementation in the form of RAM. Given the inherent challenge in defining a suitable residual noise distribution (and inferring its hyperparameters), we define the noise distribution to be same as the anchor distribution itself, i.e., P(R) = P(N) = P(X), and implement it efficiently using the RAM regularizer. Formally, for a given tuple $(\\mathrm{r}, \\mathrm{x} - \\mathrm{r})$, anchor masking zeroes out the anchor while keeping the residual fixed, i.e., $(\\mathrm{0}, \\mathrm{x} - \\mathrm{r})$. Generally, the tuple for making a prediction for $\\mathrm{x}$ with a zero anchor (note: zero vector is a valid anchor in our anchor distribution) will be written as $(\\mathrm{0}, \\mathrm{x})$. However, in anchor masking this can be interpreted as making a prediction using the zero anchor, but with a noised residual $\\mathrm{x} + \\mathrm{\\epsilon}$ where $\\mathrm{\\epsilon} = -\\mathrm{r}$ and $\\mathrm{\\epsilon} \\in P(N)$."
                    }
                },
                "number": 8,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission7985/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700327338873,
                "cdate": 1700327338873,
                "tmdate": 1700327722396,
                "mdate": 1700327722396,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "SsAo5DFIRQ",
            "forum": "9rzEPbs4Wg",
            "replyto": "9rzEPbs4Wg",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission7985/Reviewer_LRUp"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission7985/Reviewer_LRUp"
            ],
            "content": {
                "summary": {
                    "value": "The authors propose an extension to the method of anchoring, Random Anchor Masking (RAM), based on their empirical evaluation of anchoring on more typical Deep Neural Networks (DNNs) and tasks than it has been evaluated on in the past. \n\nAnchoring is a recently proposed methodology designed to improve uncertainty estimation of DNNs by representing input samples as the difference (i.e. residuals) from a different randomly chosen sample within the training set (the anchor). As such, when used at inference time, anchored models are better able to estimate uncertainty since the residuals of an input not within distribuition are likely to be quite large. While anchoring has shown some success in uncertainty estimation on small scale benchmarks, the authors highlight that it has not been evaluated as much on more typical DNN architectures/problems, nor has it been evaluated in the context of other problems where distribution shifts occour, such as outliers, generalization under distribution shift and linear probing, calibration, robustness and outlier rejection. The authors proceed to evaluate standard anchoring on these problems with CIFAR-10/CIFAR-100 and ImageNet dataset variants relevant to the problem and on ResNet/WideResNet CNNs and Vision Transformers.\n\nDespite the relatively good performance of anchoring on these problems, the authors are concerned that when the residual is large, such as would be expected in distribution shift, an anchored model may suffer significantly decreased generalization because it overfits the anchor. The authors propose to extend anchoring by simply masking (i.e. zeroing) the anchor (after residual calculation) with a probability $\\alpha$. In other words, they dropout the anchor with probability $\\alpha$, introducing noise in the anchored training process. For a small $\\alpha$ this might be expected to reduce any dependence the model might learn on the anchors themselves and improve generalization on slightly OOD samples. The authors demonstrate results in a similar empirical analysis as used for standard anchoring and compare results with anchored and non-anchored models. Finally, the authors highlight that their results often show a trade-off for RAM/anchoring with generalization and each problem they evaluated, e.g. calibration. They describe how the hyper parameter $\\alpha$ affects this tradeoff, and propose some methodology to mitigate it."
                },
                "soundness": {
                    "value": "4 excellent"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "4 excellent"
                },
                "strengths": {
                    "value": "* Overall a very well-written and presented paper (with the notable exception of figure captions/labels).\n* Clear motivation and clear method, although some of the design decisions for the method could be explained better.\n* Very good background on explaining anchoring and why it might be interesting for other problems with distribution shift as an underlying cause/factor.\n* Results are overall presented well in tables, and clear, again with the exception that some aspects are never explained (i.e. +/- is what exactly).\n* The paper doesn't just propose a new anchoring method, but also evaluates the existing anchoring methodology on a wide range of problems within the deep learning literature, including robustness, calibration, OOD samples, corruption and linear probing/adaption.\n* Reasonable evaluation of the proposed method, and existing anchoring methodology, using appropriate datasets (CIFAR-10/CIFAR-100/ImageNet, and the task variants of these) and a wide range of DNN models, including ResNet/WideResNet CNNs and a Vision Transformer.\n* Almost all of the presented results for RAM beat the baselines models modestly with and without anchoring, with perhaps the exception of calibration which is much closer. Overall the results across a wide range of problems are quite impressive, again compared to the baselines.\n* The analysis on the trade-off for generalization v.s. each task, e.g. calibration, is welcome and in particular Figure 2 is great to give a high-level overview of what this tradeoff is for some variants of the hyper parameter $\\alpha$."
                },
                "weaknesses": {
                    "value": "* Why this type of added noise during training v.s. say residual noise, or other noise applied to the mask? While the intuition of noisy training reducing the model overfitting on anchors makes sense, the intuition as to why the authors believe anchor overfitting is a problem isn't completely obvious to me.\n* RAM is a very unfortunate acronym to be using in computer circles, while I appreciate the acronym isn't made up and is meaningful, it would probably be best to come up with another one.\n* Not clear to me if the same $\\alpha$ is applied to the whole batch, or is per-sample. The text in section 3.1 makes it sounds like the former, but that doesn't make sense to me, it seems very strange to mask out a whole batch's anchors instead of a random subset, e.g. like dropout.\n* Calibration results appear to be relatively weak, with many of the results presented being within the variance(?) of baselines.\n* The captions of figures/tables and labelling of figures is weak, with little explanation to be found within a figure's caption, and labels missing from elements of figures - e.g. missing $\\alpha$ on the legend of Figure 2(a). Ideally figures and tables should almost be self-contained, but I found myself having to read the text quite a bit to figure out each one.\n* While the authors compare the performance of RAM w.r.t. the models with and without anchoring on standard task-specific datasets (here I use task to loosely mean problems such as calibration, corruption, robustness, etc). For example while using corrupted ImageNet-C, they do not compare with state-of-the-art methods on that dataset. I personally am willing to forgive this, as the authors do not claim state-of-the-art results on these tasks, and appear to be the first to evaluate anchoring on these tasks at all.\n* Little discussion apparently on the effect of adding noise to training on the training time of the model, typically when we add noise to training and make it more difficult, it might be expected that training would take longer to reach the same generalization.\n* Not clear how the $\\alpha$ hyperparameter values found throughout the paper are decided on"
                },
                "questions": {
                    "value": "* Is $\\alpha$ is applied to the whole batch, or is it per-sample? In 3.1 \"...RAM completely masks the anchors in the tuple for a given batch during training...\". If it is for the whole batch, why would you do it this way instead of per-sample, which aligns more with the objective of adding some noise to training (i.e. dropout).\n* What is the +/- shown in results, as I don't see it explained anywhere in the paper, i.e. is it variance, stddev, ...? Ideally this should be explained in the captions of the figures themselves.\n* Is RAM close to state-of-the-art on any of the datasets it is evaluated with, e.g. ImageNet-C, etc? If not, how far away from SOTA is it, and what do you think it would take to bring anchoring closer to SOTA in these tasks?\n* You claim no computational overhead in section 4.2 for RAM w.r.t. anchoring, which I believe given the method. However, anchoring itself does have a computational overhead over standard methods of training since the first (and most computationally expensive) layer of e.g. a CNN is effectively doubled in size. What is the trade-off on this front? Is the tradeoff reasonable for large models still, i.e. ViT?\n* Furthermore, since we are making training harder vis-a-vis dropout, what is the increase in training time to reach the same generalization as anchored models? What about compared to models without anchoring?"
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "8: accept, good paper"
                },
                "confidence": {
                    "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 2,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission7985/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698887942100,
            "cdate": 1698887942100,
            "tmdate": 1699636983328,
            "mdate": 1699636983328,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "2roriVH5zQ",
                "forum": "9rzEPbs4Wg",
                "replyto": "SsAo5DFIRQ",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission7985/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission7985/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Author Response - Reviewer LRUp"
                    },
                    "comment": {
                        "value": "Thank you for your positive feedback. Here is our detailed response to all your questions.\n\n**1. Choice of Acronym RAM:** \n\nWe understand how this terminology can be confusing. Following reviewer advice, we will use MAR (Masking Anchors Randomly) as the new acronym. We have not changed it yet so that the other reviewers do not get confused.\n\n**2. Implementation of RAM:** \n\nThe reviewer is right in pointing out that the parameter $\\alpha$ controls the schedule of residual corruption during training -- across an entire batch. However, this is only an implementation choice and one can consider alternative approaches, and the observations will not change. For example, the residual corruption can be applied to $\\alpha \\%$ of samples from each batch or this can be included as an additional loss objective with a pre-specified penalty.\n\n**3. Complexity of Anchored Training w/o and w/ RAM:** \n\nFrom an optimization standpoint, anchored training becomes increasingly challenging as the combinatorial space of (anchor, residual) pair grows. For example, with CIFAR-10 or CIFAR-100, anchored training converges effectively with the same training recipe in the same number of epochs as the standard training. However, with ImageNet (regardless of the architecture), for the same training recipe, anchored training requires $20$ additional epochs to converge to the same level of validation loss. However, the training efficiency itself is not significantly different from non-anchored models. Note that, including RAM regularization ($\\alpha = 0.2$ in all experiments) does not impact the training behavior and requires the same number of epochs as standard anchoring. Here we show the comparisons for the SWINv2-B model trained on ImageNet.\n\n\n|     Model     | Anchoring? | RAM? | # Epochs | Model Size (MB) | Time (s) ImageNet-Test  (16 GPUs) | ID Acc. | OOD Acc.ImageNet-C (Sev 5.) |\n|:-------------:|:----------:|:----:|:--------:|:---------------:|:---------------------------------:|:-------:|:---------------------------:|\n|               |     No     |  No  |    300   |      336.37     |                33.0               |  84.06  |             45.7            |\n| SWINv2 (base) |     Yes    |  No  |    320   |      336.40     |                38.0               |  84.11  |             47.6            |\n|               |     Yes    |  Yes |    320   |      336.40     |                38.0               |  84.09  |            **48.16**            |\n    \n\n**4. Improving captions of Tables and Figures:** \n\nThanks for this comment. We have expanded the figure and table captions for better clarity.\n\n**5. Hyperparameter Selection:** \n\nFor all experiments reported in the paper, we follow the training recipes from the torchvision (https://pytorch.org/vision/stable/models.html) and directly used the same hyper-parameter configurations. The only difference was increasing the number of epochs for the case of imagenet ($20 more epochs).\n\nFor the hyperparameter $\\alpha$, we selected it solely based on two factors: We wanted to use a high value of $\\alpha$ (for improved generalization), such that it can converge in the same number of epochs as that of anchoring w/o RAM, and can produce validation accuracies comparable (or better) than the non-anchored model. Based on our experiments with CIFAR-10, CIFAR-100 and ImageNet across multiple architectures (RegNet, ResNet, WRN40-2, DEIT, ViTb and SWINv2) $\\alpha = 0.2$ is a recommended setting.\n\n**6. What is the $\\pm$ shown in results?** \n\nWe apologize for this oversight. $\\pm$  in the calibration metric indicates the standard deviation across all OOD datasets (ImageNet-C, Imagenet-$\\bar{\\text{C}}$, ImageNet-v2, ImageNet-R and ImageNet-S) and we have made this clear in the updated version.\n\n\n**7. SoTA Comparison:** \n\nThe key claim of this work is that, across dataset sizes (CIFAR-10 to Imagenet), architectures (ResNet to ViT) and network sizes (5M to 88M parameters), anchored training can provide significant gains in OOD generalization, anomaly rejection and adaptation, compared to vanilla training. We do not attempt to establish SoTA generalization performance, since top results are often obtained via model souping[1] or by fine-tuning large scale pre-trained models[2]. However, we emphasize that, when the train recipe includes high-capacity architectures or advanced training strategies (Mixup, EMA, label-smoothing, cutmix), anchoring continues to improve over the base models in all these cases, showing promise to be effective even with SoTA recipes involving large-scale pre-training and ensembling. In the updated conclusions, we have highlighted that integrating anchoring (w/ RAM) into these SoTA approaches is an important future direction of work.\n\n[1] M. Wortsman et al. Model soups: averaging weights of multiple fine-tuned models improves accuracy without increasing inference time, ICML 2022\n\n[2] S.Goyal et al. Finetune like you pretrain: Improved finetuning of zero-shot vision models, CVPR 2023."
                    }
                },
                "number": 9,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission7985/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700328018770,
                "cdate": 1700328018770,
                "tmdate": 1700328018770,
                "mdate": 1700328018770,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "QnqOwViOqN",
                "forum": "9rzEPbs4Wg",
                "replyto": "2roriVH5zQ",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission7985/Reviewer_LRUp"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission7985/Reviewer_LRUp"
                ],
                "content": {
                    "comment": {
                        "value": "I'd like to thank the authors for their rebuttal, and apologize for my late participation in the rebuttal period - this was due to exceptional circumstances.\n\nI believe the authors have addressed most of my questions/concerns, and hopefully by including the better figures and descriptions of some aspects of their methodology, this has also strengthened the paper significantly."
                    }
                },
                "number": 19,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission7985/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700679109123,
                "cdate": 1700679109123,
                "tmdate": 1700679109123,
                "mdate": 1700679109123,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "226B1PHz3D",
            "forum": "9rzEPbs4Wg",
            "replyto": "9rzEPbs4Wg",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission7985/Reviewer_GTiz"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission7985/Reviewer_GTiz"
            ],
            "content": {
                "summary": {
                    "value": "This paper investigates a recent architecture named anchoring.  By evaluating important tasks of out-of-distribution generalization, task adaptation, anomaly detection, and calibration, the authors give a comprehensive study of anchoring for the safety and generalization of deep neural networks. Based on this, a simple modification called Random Anchor Masking (RAM) is proposed and it shows significant performance gains over both standard anchoring and non-anchored models. Extensive experiments across datasets of varying size and complexity (CIFAR10- 100/ImageNet) as well as architectures of varying scales (RegNet/ResNet/WRN/ViT) are conducted, which verify the effectiveness of the proposed RAM methods."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "3 good"
                },
                "strengths": {
                    "value": "1. This paper investigates a new and novel topic named anchoring, from the perspective of improving the generalization and safety of deep neural networks.\n2. This paper is well-written and easy to follow.\n3. The proposed method is simple but effective, and it gives some insight by linking the improved generalization behavior of anchored models to their sensitivity to the space of residuals.\n4. Extensive experiments across datasets of varying size and complexity (CIFAR10- 100/ImageNet) as well as architectures of varying scales (RegNet/ResNet/WRN/ViT) are conducted, which verify the effectiveness of the proposed RAM methods."
                },
                "weaknesses": {
                    "value": "1. The proposed RAM method aims at improving the smoothness of the relationship between residual and target labels. However, why does such an easy strategy work on so many datasets and applications? It seems that more analysis and explanations should be given, apart from the extensive experiments showing that it works.\n2. According to the impact of masking probability alpha on generalization and safety metrics, it shows a direct correlation between alpha and corruption accuracy. However, why such a correlation is held? Will this correlation be held for more datasets or applications?"
                },
                "questions": {
                    "value": "Please see the weaknesses section."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "details_of_ethics_concerns": {
                    "value": "No ethics review is needed."
                },
                "rating": {
                    "value": "6: marginally above the acceptance threshold"
                },
                "confidence": {
                    "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 3,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission7985/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1699196574707,
            "cdate": 1699196574707,
            "tmdate": 1699636983207,
            "mdate": 1699636983207,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "NMwzYdt4YH",
                "forum": "9rzEPbs4Wg",
                "replyto": "226B1PHz3D",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission7985/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission7985/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Author Response - Reviewer GTiz"
                    },
                    "comment": {
                        "value": "Thank you for a positive assessment of our paper. If our response sufficiently addresses your questions, we request you to improve the score and champion our paper.\n\n**1. Why does anchored training and the RAM regularizer lead to better generalization?** \n\nPlease check our detailed answer to this central question in the overall response. For completion, we include a summary here. While we have not theoretically characterized the behavior of RAM, our hypothesis is rooted in existing theory and our expanded empirical results provide clear evidence for the hypothesis. However, motivated by the empirical success of anchoring, we plan to carry out a theoretical study on generalization in anchored models as part of our future work (as specified in the updated Conclusion section).\n\n-   In essence, anchoring involves representing an input $\\mathrm{x}$ as a combination of an anchor $\\mathrm{r}$ and the residual $(\\mathrm{x} - \\mathrm{r})$, while maintaining all other aspects of the conventional neural network. This method capitalizes on the lack of shift invariance in Neural Tangent Kernels (NTKs) induced by common neural networks. Anchored training employs different anchors for the same sample across epochs to marginalize the effect of anchor choice during inference. While it may seem akin to data augmentation, anchoring is fundamentally different in that it combinatorially expands the space of (anchor, residual) pairs with different anchor choices and enables exploration of a richer class of hypotheses, and does not manipulate the inputs. However, as our experiments show, anchoring can be combined with any additional data augmentation technique.\n\n-   Now, let us consider generalizing to an OOD test sample. In the tuple $(\\mathrm{r}, \\Delta)$ for the test sample $\\mathrm{x}_t$, the anchor $\\mathrm{r} \\in P(X)$ and it is possible that $\\Delta = \\mathrm{x}_t - \\mathrm{r}$ can be novel to $P(\\Delta)$. Thus, by exposing the model to more diverse combinations of $(\\mathrm{r}, \\Delta)$ during training, generalization can be improved. A naive way to improve the diversity of $P(\\Delta)$ (or equivalently $P(X, \\Delta)$) is to consider a wider anchor distribution (i.e., $P(C) \\supset P(X) $). However, it is non-trivial to characterize the anchor distribution and arbitrarily improve its diversity; and increasing anchor diversity will lead to a combinatorially larger space (anchor, residual) pairs, which can in turn require larger number of epochs to effectively converge.\n\n-   We adopt a simpler alternative by making the residuals noisy, and propose a simple implementation in the form of RAM. Given the inherent challenge in defining a suitable noise distribution (and inferring its hyperparameters), we define the noise distribution to be same as the anchor distribution itself, i.e., $P(C) = P(N) = P(X)$, and implement it efficiently using the RAM regularizer. Formally, for a given tuple $(\\mathrm{r}, \\mathrm{x}-\\mathrm{r})$, anchor masking can be reinterpreted as $(\\mathbf{0}, \\mathrm{x} + \\epsilon)$ where $\\epsilon \\in P(N)$. In other words, we want to identify the true label for $\\mathrm{x}$ with the zero anchor, given the noisy residual.\n\n-   Finally, network capacity plays a significant role in effectively leveraging the increased diversity produced by RAM. For example, with ImageNet, as we move from RegNet (5M) to SWINv2-B (88M), we witness larger performance improvements over both anchoring w/o RAM as well as standard training (see updated Table 1 in the paper).\n\n**2. Choice of $\\alpha$ and the Generalization-Anomaly Rejection Trade-off:**\n\n-   The parameter $\\alpha$ directly controls the schedule of residual corruption during training. Simply put, arbitrarily increasing $\\alpha$ will start to adversely affect the training convergence and eventually the ID performance itself. Hence, we recommend a nominal value of $\\alpha=0.2$, which we empirically find to converge in the same number of epochs as anchoring w/o RAM across all architectures, and to result in much improved generalization.\n\n-   Similar to any existing regularization strategy (e.g., Mixup) adopted for improving generalization, RAM with high $\\alpha$ has the risk of producing models with reduced sensitivity towards anomalous data (i.e., compared to anchoring w/o RAM) [1]. We find that with $\\alpha = 0.2$, the anomaly rejection trade-off is minimal and interestingly, it can even lead to higher rejection AUROC scores with networks with higher capacity (e.g., SWINv2-B, updated Table 2 in the paper).\n\n[1] Hendrycks, Dan, et al. \"Pixmix: Dreamlike pictures comprehensively improve safety measures.\", CVPR 2022."
                    }
                },
                "number": 7,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission7985/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700327120731,
                "cdate": 1700327120731,
                "tmdate": 1700327120731,
                "mdate": 1700327120731,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "rHFaYke5kz",
            "forum": "9rzEPbs4Wg",
            "replyto": "9rzEPbs4Wg",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission7985/Reviewer_auhR"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission7985/Reviewer_auhR"
            ],
            "content": {
                "summary": {
                    "value": "In this paper, the authors try to provide a high-level understanding of the advantages of the anchoring method, which is believed to offer the enhanced generalization capability of deep models. Also, the authors propose a variant of the popular anchoring method, which masks the anchor sample to achieve further improvements in generalization. Their simple yet effective method is widely evaluated on various tasks and model architectures to confirm the advantages of their strategy."
                },
                "soundness": {
                    "value": "2 fair"
                },
                "presentation": {
                    "value": "2 fair"
                },
                "contribution": {
                    "value": "2 fair"
                },
                "strengths": {
                    "value": "**Strength 1**: The authors try to provide a comprehensive benefit of anchoring by evaluating the set of related tasks, which have been done separately but are commonly related to the generalization capability of models. Specifically, the corruption robustness benchmarks, including a set of `-C' tasks, the anomaly detection benchmarks, and the various kinds of downstream transfer learning tasks, are largely considered. I believe that the extensive and collective evaluations can provide a comprehensive understanding of the strength of the anchoring methods."
                },
                "weaknesses": {
                    "value": "**Weakness 1:** The main motivation of this work seems to offer a 'clear' understanding of the benefits of anchoring, but I feel that the provided explanation is not sufficient to understand anchoring thoroughly. The main reason for this critique is that the analysis remains empirical observations rather than trying to provide theoretical analysis. Most of the researchers conjecture that random perturbations on inputs, e.g., data augmentations with noise or corruptions, or the interpolations between samples, e.g., a family of methods with Mixup such as Mixup, Manifold mixup, CutMix, etc, are linked to the improved generalization of models by letting models face the diversity beyond clean data sample-wise training. However, pushing the 'high-level conjecture' forward 'theoretical proofs' is crucial. I feel that this work has tried to do that, but is quite limited in providing the empirical observations and conjectures, without theoretical proofs.\n\n**Weakness 2:** It is hard to find an explicit logical link between the proposed strategy (i.e., Random Anchoring Masking) and the understanding of anchoring. Why do we have to randomly mask the anchor in order to improve the generalization? Are there any further insights into the proposed strategy beyond the simple objective of imposing higher diversity on models?\n\n**Weakness 3:** The paper is not well organized. For example, it would have been better to organize Related Work to clearly analyze the previous works on both technical and theoretical sides. I know that the author's analyses of the prior works are spread into multiple sections in this version of the article. However, it is better to show a designated section to emphasize the uniqueness of this work beyond prior efforts is strongly required. Also, I guess that the Conclusion section is missing.\n\nThere are some minor corrections, including typos.\n- In '2.1 Preliminaries', at the 'Notations' part: \"of distinct classes..\" -> \"of distinct classes.\"\n- In the third sentence of '3. An Anchoring Perspective to Generalization': \"it was was\" -> \"it was\""
                },
                "questions": {
                    "value": "**Q1:** As pointed out in 'Weakness 1', would you provide any theoretical support to clearly understand the advantages of anchoring and the proposed masked anchoring method?\n\n**Q2:** As aforementioned in 'Weakness 2', would you provide the logical reasoning of the masking-based approach for anchoring?"
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "5: marginally below the acceptance threshold"
                },
                "confidence": {
                    "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
                },
                "code_of_conduct": {
                    "value": "Yes"
                },
                "first_time_reviewer": {
                    "value": "Yes",
                    "readers": [
                        "ICLR.cc/2024/Conference/Program_Chairs",
                        "ICLR.cc/2024/Conference/Submission7985/Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission7985/Reviewer_auhR",
                        "ICLR.cc/2024/Conference/Submission7985/Senior_Area_Chairs"
                    ]
                }
            },
            "number": 4,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission7985/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1699530446444,
            "cdate": 1699530446444,
            "tmdate": 1700733404381,
            "mdate": 1700733404381,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "72pITIkvUt",
                "forum": "9rzEPbs4Wg",
                "replyto": "rHFaYke5kz",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission7985/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission7985/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Author Response - Reviewer auhR"
                    },
                    "comment": {
                        "value": "Thank you for your comments and questions. Following your feedback, we have expanded the background, reorganized the results and clearly stated our findings. If our responses sufficiently address all the concerns raised, we request you to improve the score and champion our paper.\n\n**1. How does anchoring work and why does RAM lead to better generalization?**\n\nIn order to clarify how anchoring works and why the proposed RAM regularization leads to improved generalization, we have provided a detailed explanation in the overall response. Here we include an expanded version. While we have not theoretically characterized the behavior of RAM, our hypothesis is rooted in existing theory and our expanded empirical results provide clear evidence for the hypothesis. However, motivated by the empirical success of anchoring, we plan to carry out a theoretical study on generalization in anchored models as part of our future work (see updated Conclusion section).\n\n+ In regard to theoretical foundations for anchoring, we directly refer to two key results: (a) In [1], it was shown that **centering a dataset using different constant inputs will lead to different solutions**, due to inherent lack of shift invariance in NTKs induced by commonly adopted neural networks. Anchored training uses different anchors for the same sample across different epochs with the goal of marginalizing out the effect of anchor choice at inference time. But in this process, it implicitly explores a large class of hypotheses and enforces prediction consistency; (b) In [2], it was theoretically showed that an anchored model can **demonstrate improved extrapolation behavior at test time, when the anchor $\\mathrm{x} \\in P(X)$ and the residual for the unseen sample $\\Delta \\in P(\\Delta)$**. However, neither of these works rigorously studied the generalization behavior of anchored models on large-scale datasets, architectures or even practical distribution shifts. We have also accordingly updated the background section.\n\n+ While the idea of enforcing prediction consistency across different anchor choices might appear similar to data augmentation, we want to clarify that **anchoring does not impose any invariance to data characteristics**, but only expands the combination of (anchor, residual) pairs with each additional anchor. \n\n+ For the first time, we systematically study the viability of anchoring as a training protocol across dataset sizes (CIFAR-10 to Imagenet), architectures (ResNet to ViT) and network sizes (5M to 88M parameters). In this context, we also study other key properties such as calibration, anomaly rejection and adaptation (both ID and OOD evaluation). We have entirely reorganized the results section for clarity. \n\n+ Let us consider generalizing to an OOD test sample. In the tuple $(\\mathrm{r}, \\Delta)$ for the test sample $\\mathrm{x}_t$, the anchor $\\mathrm{r} \\in P(X)$ and it is possible that $\\Delta = \\mathrm{x}_t - \\mathrm{r}$ can be novel to $P(\\Delta)$. Thus, by **exposing the model to more diverse combinations of $(\\mathrm{r}, \\Delta)$ during training, generalization can be improved**. A naive way to improve the diversity of $P(\\Delta)$ (or equivalently $P(X, \\Delta)$) is to consider a wider anchor distribution (i.e., $P(C) \\supset P(X) $). However, it is non-trivial to characterize the anchor distribution (e.g., for ImageNet) and arbitrarily improve its diversity; and increasing anchor diversity will lead to a combinatorially larger space of (anchor, residual) pairs, thus requiring a larger number of epochs to effectively converge.\n\n+ We adopt an alternative approach to increasing diversity of $P(\\Delta)$ by **making the residuals noisy, and propose a simple implementation in the form of RAM**. Given the challenge in defining a suitable residual noise distribution, we define the noise distribution to be same as the anchor distribution itself, i.e., $P(C) = P(N) = P(X)$. Formally, for a given tuple $(\\mathrm{r}, \\mathrm{x}-\\mathrm{r})$, anchor masking zeroes out the anchor while keeping the residual fixed, i.e., $(\\mathbf{0}, \\mathrm{x}-\\mathrm{r})$. Generally, the tuple for making a prediction for $\\mathrm{x}$ with a zero anchor (note: zero vector is a valid anchor) will be written as $(\\mathbf{0}, \\mathrm{x})$. However, anchor masking can be interpreted as **making a prediction using the zero anchor, but with a noised residual $\\mathrm{x} + \\epsilon$** where $\\epsilon \\in P(N)$. \n\n+ Finally, network capacity plays an important role in effectively leveraging the increased diversity produced by RAM. For example, with ImageNet, as we move from RegNet (5M) to SWINv2-B (88M), we witness larger generalization performance improvements over both anchoring w/o RAM as well as standard training (see updated Table 1).\n\n[1] J.J. Thiagarajan et al. Single model uncertainty estimation via stochastic data centering, Neurips, 2022.\n\n[2] A. Netanyahu et al. \"Learning to Extrapolate: A Transductive Approach.\" ICLR 2023."
                    }
                },
                "number": 6,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission7985/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700326979666,
                "cdate": 1700326979666,
                "tmdate": 1700326979666,
                "mdate": 1700326979666,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "4UIXAVEVLD",
                "forum": "9rzEPbs4Wg",
                "replyto": "qRAIQjadgC",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission7985/Reviewer_auhR"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission7985/Reviewer_auhR"
                ],
                "content": {
                    "title": {
                        "value": "Thanks for the response"
                    },
                    "comment": {
                        "value": "Dear Authors,\n\nI truly appreciate the kind response and careful revision of the manuscript.\nFirst of all, I feel that the revised manuscript is much easier to follow and shows a clear logical flow to reach the proposed algorithm. Again, thanks to the revision.\nAlso, your insights on the reasons for gains from RAM allow me to capture a high-level understanding of why RAM improves performance. However, as you responded, it seems to remain at a conjecture level but does not reach a theoretical level.\nI can say that the additional explanation indeed promotes a better understanding of readers, but I am keeping to expect this work to provide further in-depth theoretical analysis. For example, as you described, [2] provides a theoretical foundation for the improved extrapolation behavior of anchoring; then, what happens for RAM? I guess that RAM is a simple manipulation of the anchor pair, so it is probably straightforward to further formulate the extrapolation behavior of RAM by stepping on the results from [2]. Albeit the weakness, I slightly leaned to increase my rating due to the improvements from your revision, but I have a raising concern as follows.\n\nIn the revised manuscript, a set of more complicated ViT-based architectures is largely considered. Unfortunately, when seeing the results in Table 1-4, the performance gains of RAM seem to be ambiguous. It contrasts with clear gains in ResNet architectures (Table 5). \nFor OOD (Table 1), RAM generally seems to be the best. But for the Calibration test (Table 2), RAM achieves the top for 19 cases, naive anchoring achieves 15 cases, and non-anchoring takes the remaining 8 cases; which makes me worry about the dominance of RAM over baselines. For the LP-based adaptation on ImageNet-1K, RAM achieves the best 'Average' for 3 backbone cases, but seems to be inferior to others for the remaining two backbone cases; it also seems to be ambiguous gains. Lastly, the LP-based adaptation on DomainNet, RAM does not seem to be the best; it achieves a few numbers of top accuracies in 'Average'.\nThe new concern makes me worry about the applicability of RAM to larger architectures, and curious about the reasons for different behavior between the ResNet group and the ViT group.\n\nBy considering all the positive and negative viewpoints, I want to increase my rating to 5 (marginal below the acceptance) from 3 (reject). Again, I really appreciate your extensive efforts to revise your manuscript."
                    }
                },
                "number": 22,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission7985/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700733344201,
                "cdate": 1700733344201,
                "tmdate": 1700733344201,
                "mdate": 1700733344201,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "NY0tZ0GJfC",
            "forum": "9rzEPbs4Wg",
            "replyto": "9rzEPbs4Wg",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission7985/Reviewer_rVkq"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission7985/Reviewer_rVkq"
            ],
            "content": {
                "summary": {
                    "value": "This paper extends the anchoring-based training of deep neural networks with a Random Anchor Masking (RAM) technique. The authors observed that this simple RAM strategy can significantly improve multiple metrics under domain shift setting. The empirical evaluation is conducted on CIFAR-10/100 and ImageNet datasets, which shows the positive results by considering the RAM technique in anchoring-based training. Another observation is the trade-off between OOD generalization and anomaly detection, demonstrating that models that achieved superior gains in generalization performance tend to exhibit a trade-off in their ability to detect OOD samples. The authors investigated the effect of masking ratio $\\alpha$ on this trade-off."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "3 good"
                },
                "strengths": {
                    "value": "1. The study of anchoring-based training and inference is interesting. Especially, there are some evidences that this training strategy can benefit some safety-aware metrics.\n\n2. The proposed masking-based strategy is simple to implement. The empirical evaluation shows the benefits of this simple strategy.\n\n3. The illustrative experiment in Figure 1 shows clear motivation for the proposed strategy, where models training by anchoring+RAM seem can better estimate the uncertainty for corrupted samples."
                },
                "weaknesses": {
                    "value": "1. RAM proposed in this paper is very simple and easy to implement, which is a great advantage. However, the principle and explanation behind this simple strategy are essential. The authors have provided some motivation for this masking strategy, but further explanation of the underlying principles can further improve the quality of the article. For example, the authors mentioned that \"this noisy training induced by RAM enforces the model to improve smoothness between the target and the residuals leading to better calibrated predictions\". How RAM improves smoothness and how this smoothness leads to better calibration can be further explained.\n\n2. For some other findings in the experiment, such as the trade-off between generalization and OOD detection, this paper only provided some simple experimental results. The reasons behind these phenomena were not deeply analyzed. Is this phenomenon also present in other methods?\n\n3. In inference, multiple random anchors can be used to obtain predictions and the variance can be interpreted as an estimate of the epistemic uncertainty. This is very similar with the simple deep ensemble strategy, the comparison with ensemble-based methods could be provided.\n\nMinor issues: \"was was argued\" ==> \"was argued\", \"results in 2\" ==> \"results in Table 2\", \"Figure 3a depicts\" ==> \"Figure 2a depicts\"."
                },
                "questions": {
                    "value": "Please refer to weaknesses section."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "6: marginally above the acceptance threshold"
                },
                "confidence": {
                    "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 5,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission7985/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1699534734724,
            "cdate": 1699534734724,
            "tmdate": 1699636982972,
            "mdate": 1699636982972,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "jXaCnESiC9",
                "forum": "9rzEPbs4Wg",
                "replyto": "NY0tZ0GJfC",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission7985/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission7985/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Author Response - Reviewer rVkq"
                    },
                    "comment": {
                        "value": "Thank you for your positive comments and the questions. If our responses sufficiently address all the concerns raised, we request you to improve the score and champion our paper.\n\n**How does anchoring work and why does RAM lead to better generalization?**\n\nIn order to clarify how anchoring works and why the proposed RAM regularization leads to improved generalization, we have provided a detailed explanation in the overall response. Here we include an expanded version of that with some additional comments to address your questions. While we do not theoretically establish the utility of RAM, our hypothesis is rooted in existing theory and our expanded empirical results provide clear evidence for the hypothesis.\n\n-   In essence, anchoring involves representing an input $\\mathrm{x}$ as a combination of an anchor $\\mathrm{r}$ and the residual $(\\mathrm{x} - \\mathrm{r})$, while maintaining all other aspects of the conventional neural network. This method capitalizes on the **lack of shift invariance in Neural Tangent Kernels (NTKs)** induced by common neural networks. Anchored training employs different anchors for the same sample across epochs to marginalize the effect of anchor choice during inference. \n\n+ While **it may seem akin to data augmentation, anchoring is fundamentally different** in that it combinatorially expands the space of (anchor, residual) pairs with different anchor choices and does not manipulate the inputs. However, as our experiments show, anchoring can be combined with any additional data augmentation technique.\n\n-   For the first time, we systematically study the viability of anchoring as a training protocol across dataset sizes (CIFAR-10 to Imagenet), architectures (ResNet to ViT) and network sizes (5M to 88M parameters). In this context, we also study other key properties like calibration, anomaly rejection and adaptation (both ID and OOD evaluation). We have entirely reorganized the results section for clarity.\n\n-   Now, let us consider generalizing to an OOD test sample. In the tuple $(\\mathrm{r}, \\Delta)$ for the test sample $\\mathrm{x}_t$, the anchor $\\mathrm{r} \\in P(X)$ and it is possible that $\\Delta = \\mathrm{x}_t - \\mathrm{r}$ can be novel to $P(\\Delta)$. Thus, by exposing the model to more diverse combinations of $(\\mathrm{r}, \\Delta)$ during training, generalization can be improved. A naive way to improve the diversity of $P(\\Delta)$ (or equivalently $P(X, \\Delta)$) is to consider a wider anchor distribution (i.e., $P(C) \\supset P(X) $). However, it is non-trivial to characterize the anchor distribution and arbitrarily improve its diversity; and increasing anchor diversity will lead to a combinatorially larger space (anchor, residual) pairs, which can in turn require larger number of epochs to effectively converge.\n\n-   We adopt an alternative approach to increasing diversity of $P(\\Delta)$ by making the residuals noisy, and propose a simple implementation in the form of RAM. Given the inherent challenge in defining a suitable residual noise distribution (and inferring its hyperparameters), we define the noise distribution to be same as the anchor distribution itself, i.e., $P(C) = P(N) = P(X)$. Formally, for a given tuple $(\\mathrm{r}, \\mathrm{x}-\\mathrm{r})$, anchor masking zeroes out the anchor while keeping the residual fixed, i.e., $(0, \\mathrm{x}-\\mathrm{r})$. Generally, the tuple for making a prediction for $\\mathrm{x}$ with a zero anchor (note: zero vector is a valid anchor) will be written as $(\\mathbf{0}, \\mathrm{x})$. However, in anchor masking this can be interpreted as making a prediction using the zero anchor, but with a noised residual $\\mathrm{x} + \\epsilon$ where $\\epsilon \\in P(N)$.\n\n**2. Trade-off between OOD Generalization and Anomaly Rejection:** \n\nThe parameter $\\alpha$ controls the schedule of residual corruption during training. Arbitrarily increasing $\\alpha$ can adversely affect the training convergence and eventually the ID performance itself. Hence, we recommend a nominal value of $\\alpha=0.2$, which we empirically find to converge in the same number of epochs as anchoring w/o RAM across all architectures, and to result in much improved generalization. Similar to any existing approach (e.g., Mixup) adopted for improving generalization, RAM with high $\\alpha$ could lead to reduced sensitivity towards anomalous data [1]. However, we find that with $\\alpha = 0.2$, the anomaly rejection trade-off is minimal and interestingly, it can even lead to higher rejection AUROC scores with networks with higher capacity (e.g., SWINv2-B, updated Table 2).\n\n[1] Hendrycks, Dan, et al. \"Pixmix: Dreamlike pictures comprehensively improve safety measures.\", CVPR 2022."
                    }
                },
                "number": 4,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission7985/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700325942424,
                "cdate": 1700325942424,
                "tmdate": 1700325942424,
                "mdate": 1700325942424,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "7dHad34ixk",
                "forum": "9rzEPbs4Wg",
                "replyto": "dhmLrZ4sah",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission7985/Reviewer_rVkq"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission7985/Reviewer_rVkq"
                ],
                "content": {
                    "title": {
                        "value": "Thanks for the response"
                    },
                    "comment": {
                        "value": "Thanks for your response.\n\n- The first question is actually asking the intuition behind the proposed RAM rather than the basic anchoring training strategy. Despite reviewing the response, I still find it challenging to comprehend the intuition regarding how RAM enhances smoothness and how this improved smoothness contributes to better calibration.\n\n- The second question concerns the intuition what causes this observed trade-off. While the authors mention similarities to other approaches like Mixup, a direct answer to this question is not provided.\n\n- The results presented in the response for the third question appear to be impressive.\n\nThank you again for taking the time to answer my questions. Based on the response, I would like to keep my score unchanged."
                    }
                },
                "number": 11,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission7985/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700574212065,
                "cdate": 1700574212065,
                "tmdate": 1700574212065,
                "mdate": 1700574212065,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "e29CjmGM58",
            "forum": "9rzEPbs4Wg",
            "replyto": "9rzEPbs4Wg",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission7985/Reviewer_BVnY"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission7985/Reviewer_BVnY"
            ],
            "content": {
                "summary": {
                    "value": "Authors present an overview on the benefits of anchoring for training deep models, and provide a novel technique named Random Anchor Masking (RAM) in which the anchor is masked with a given probability $\\alpha$, thus only the residual $x-r$ is used for prediction. The empirical results show that with this approach better results are achieved than with standard anchoring."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "3 good"
                },
                "strengths": {
                    "value": "- The proposed method does not require any changes to optimization, as it operates only in the input layer\n\n- The experimental evaluation is performed on multiple datasets and architecture complexity \n\n- The paper is well written"
                },
                "weaknesses": {
                    "value": "I am not an expert on anchoring, so the main issues I encouter in this work are: \n\n- It is not trivial for me to understand why modelling $P(X,\\Delta|Y)$ should provide better results than just $P(X|Y)$\n\n- It is not clear to my why masking the anchor should provide better resutlts. Author say that masking \"enforces an otherwise insuficient residual to make accurate prediction\". If $\\Delta$ is not sufficient for accurate prediction, shouldn't this lead to just overfitting the training set?"
                },
                "questions": {
                    "value": "- I don't understand if the anchor is chosen always from the training set, also during test. I think it should be, as the anchor label is used as ground truth. I think this should be made clearer\n\n- How does RAM compare to sota methods for OOD or debiasing on tasks such as ImageNet-C? Does it achieve comparable performance or is there a significant gap?"
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "6: marginally above the acceptance threshold"
                },
                "confidence": {
                    "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                },
                "first_time_reviewer": {
                    "value": "Yes",
                    "readers": [
                        "ICLR.cc/2024/Conference/Program_Chairs",
                        "ICLR.cc/2024/Conference/Submission7985/Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission7985/Reviewer_BVnY",
                        "ICLR.cc/2024/Conference/Submission7985/Senior_Area_Chairs"
                    ]
                }
            },
            "number": 6,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission7985/-/Official_Review"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1699881263576,
            "cdate": 1699881263576,
            "tmdate": 1700587383936,
            "mdate": 1700587383936,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "I2bHrhlZRK",
                "forum": "9rzEPbs4Wg",
                "replyto": "e29CjmGM58",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission7985/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission7985/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Author Response - Reviewer BVnY"
                    },
                    "comment": {
                        "value": "We thank you for the positive feedback. If our responses sufficiently address all the concerns raised, we request you to improve the score and champion our paper.\n\n**1. Why does Anchoring help?**  \n\nKindly check our detailed answer to this central question in the overall response. For completion, we include a summary here.\n\nIn essence, anchoring involves representing an input $\\mathrm{x}$ as a combination of an anchor $\\mathrm{r}$ and the residual $\\mathrm{x} - \\mathrm{r}$, while maintaining the other training conditions of conventional neural networks. **This method capitalizes on the lack of shift invariance in Neural Tangent Kernels induced by common neural networks**. Anchored training employs different anchors for the same sample across epochs to marginalize the effect of anchor choice during inference. While it may seem akin to data augmentation, anchoring is fundamentally different in that it combinatorially expands the space of (anchor, residual) pairs with different anchor choices and enables exploration of a richer class of hypotheses, and does not manipulate the inputs. However, as our experiments show, **anchoring can be combined with any additional data augmentation technique**.\n\n**2. How does RAM work and Risk of Overfitting:** \n\nKindly check our detailed answer to this central question in the overall response. For completion, we include a summary here.\n\nTo clarify this, we begin by considering generalization to an OOD test sample. In the tuple $(\\mathrm{r}, \\Delta)$ for the test sample $\\mathrm{x}_t$, the anchor $\\mathrm{r} \\in P(X)$ and it is possible that $\\Delta = \\mathrm{x}_t - \\mathrm{r}$ can be novel to P($\\Delta$). Thus, by exposing the model to more diverse combinations of $(\\mathrm{r}, \\Delta)$ during training, generalization can be improved. A naive way to improve the diversity of $P(\\Delta)$ (or equivalently $P(X, \\Delta)$) is to consider a wider anchor distribution (i.e., $P(R) \\supset P(X) $). However, it is non-trivial to characterize the anchor distribution and arbitrarily improve its diversity; and increasing anchor diversity will lead to a combinatorially larger space (anchor, residual) pairs, thus requiring larger number of epochs to effectively converge.\n\nWe adopt an alternative approach to increasing diversity of $P(\\Delta)$ by **making the residuals noisy**, and propose a simple implementation in the form of RAM. Given the inherent challenge in defining a suitable residual noise distribution, we define the noise distribution to be same as the anchor distribution itself, i.e., $P(C) = P(N) = P(X)$, and implement it efficiently using the RAM regularizer. Formally, for a given tuple $(\\mathrm{r},\\mathrm{x} - \\mathrm{r})$, anchor masking zeroes out the anchor while keeping the residual fixed, i.e., $(0, \\mathrm{x} - \\mathrm{r})$. Generally, the tuple for making a prediction for $\\mathrm{x}$ with a zero anchor (note: zero vector is a valid anchor in our anchor distribution) will be written as $(0, \\mathrm{x})$. However, **in anchor masking this can be interpreted as making a prediction using the zero anchor, but with a noised residual** $\\mathrm{x} + \\epsilon$ where $\\epsilon = -\\mathrm{r}$ and $\\epsilon \\in P(N)$.\n\n**3. Anchor Selection at Test Time:** \n\nDuring both training and testing, **the anchors are sampled from the anchor distribution $P(R)$**, which is set to the training distribution $P(X)$ itself. However, given that anchoring explicitly marginalizes the choice of anchor, **any random training sample (or a small number of them) can be used to obtain predictions at inference time**. We also emphasize that, during anchoring, the **anchor's label is never used** and the anchor sample only contributes to the residual computation.\n\n**4. Comparison with SoTA:** \n\nThe key claim of this work is that, across dataset sizes (CIFAR-10 to Imagenet), architectures (ResNet to ViT) and network sizes (5M to 88M parameters), **anchored training can provide significant gains in OOD generalization, anomaly rejection and adaptation, compared to vanilla training**. We do not attempt to establish SoTA generalization performance, since top results are often obtained via model souping [1] or by fine-tuning large scale pre-trained models [2]. However, we emphasize that, **when the train recipe includes high-capacity architectures or advanced training strategies (Mixup, EMA, label-smoothing, cutmix), anchoring continues to improve over the base models** in all these cases, showing promise to be effective even with SoTA recipes involving large-scale pre-training and ensembling. In the updated conclusions, we have highlighted that integrating\u00a0anchoring (w/ RAM) into these SoTA approaches is an important future direction of work.\n\n[1] M. Wortsman et al. Model soups: averaging weights of multiple fine-tuned models improves accuracy without increasing inference time, ICML 2022\n\n[2] S.Goyal et al. Finetune like you pretrain: Improved finetuning of zero-shot vision models, CVPR 2023."
                    }
                },
                "number": 3,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission7985/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700325515893,
                "cdate": 1700325515893,
                "tmdate": 1700325515893,
                "mdate": 1700325515893,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "RciKM75LHc",
                "forum": "9rzEPbs4Wg",
                "replyto": "I2bHrhlZRK",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission7985/Reviewer_BVnY"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission7985/Reviewer_BVnY"
                ],
                "content": {
                    "comment": {
                        "value": "Thanks for your response. I confirm my current score"
                    }
                },
                "number": 12,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission7985/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700585216683,
                "cdate": 1700585216683,
                "tmdate": 1700585216683,
                "mdate": 1700585216683,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "fGNKpOnvjf",
                "forum": "9rzEPbs4Wg",
                "replyto": "UgQ3gmGTEZ",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission7985/Reviewer_BVnY"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission7985/Reviewer_BVnY"
                ],
                "content": {
                    "comment": {
                        "value": "I do not have further questions. Regarding last point (OOD generalization), I find it reasonable that RAM does not beat sota OOD generalization techniques (but I do think that a comparison, perhaps in the appendix, can be relevant in the scope of the work). While I am not reasonably sure about raising to full accept, I will gladly raise my confidence score for my current rating."
                    }
                },
                "number": 15,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission7985/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700587367413,
                "cdate": 1700587367413,
                "tmdate": 1700587367413,
                "mdate": 1700587367413,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    }
]