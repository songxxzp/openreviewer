[
    {
        "title": "A Theory of Non-Linear Feature Learning with One Gradient Step in Two-Layer Neural Networks"
    },
    {
        "review": {
            "id": "TRhw5JAGBw",
            "forum": "MY8SBpUece",
            "replyto": "MY8SBpUece",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission8250/Reviewer_nmYk"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission8250/Reviewer_nmYk"
            ],
            "content": {
                "summary": {
                    "value": "This paper studies how neural networks learn the features with different learning rates. Specifically, this paper considers a setup of two-layer neural network under one-step GD with the step size $\\eta=n^\\alpha$, where $n$ is the number of training samples. \nThis paper provides a theoretical characterization of how a specific choice of $\\alpha$ influences the neural network's ability to learn various types of features."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "2 fair"
                },
                "contribution": {
                    "value": "2 fair"
                },
                "strengths": {
                    "value": "The paper goes beyond the NTK region and characterizes the performance of the neural networks with a relatively large learning rate. Instead of doing lazy training, this paper shows the ability of neural networks to learn features and characterize the relationship between the learning rate and the learned features by the weights."
                },
                "weaknesses": {
                    "value": "1. Assuming that the data follows a zero-mean Gaussian distribution is strong, and whether real-world data satisfies this assumption can vary. Specifically, when considering Gaussian data, it is assumed to exhibit symmetric properties, which are necessary for the proofs. However, it's important to recognize that not all real-world data inherently possesses such symmetrical properties.\n\n2. The assumptions for the activation function are unclear. I had a hard time understanding Condition 2.3 and Condition 2.4. Could the authors directly tell us which activation functions satisfy these conditions? \n\n3. More discussions are needed for the magnitude of $c_\\star$. For example, for some common activation functions, like ReLU and Sigmoid,  where $M$ can go to infinity, I would like to learn about the dependence of the sample complexity.\n\n4. I noticed that the theoretical results regarding the training loss are only provided for the cases where $\\ell$ equals 1 and 2. While the authors mentioned that results for the general case of $\\ell$ can be found in the Appendix, I believe it is essential to include and discuss these results in the main content.\n\n5. Show the decrease in training loss may not be surprising.  Instead, the focus should be on generalization and test error.\n\n6. Emphasizing the technical challenges involved in deriving the proofs would make it easier to appreciate the technical novelty. Currently, it's challenging to discern these technical aspects when looking at the LONG proofs in the Appendix.\n\n7. We need some experiments of higher-order feature learning to justify the theoretical findings in Theorem 4.1. \n\n8. We need some numerical experiments on real data and deep neural networks to justify the theoretical findings. Currently, due to the strong assumptions on the input data and activation functions, it's challenging to envision practical applications."
                },
                "questions": {
                    "value": "1. The setup of this paper and Zhenmei et al.2022 seems significantly different from my POV, but both are counted as feature learnings. It would be better to clarify the field of feature learning and how they are connected. \n\n2. The values of training error and test error are quite confusing. It would be helpful if the authors included some baseline measures to assess the algorithm's performance. Specifically, it's challenging to see the significance of studying an algorithm with a large test error.  While it may be caused by the scaling issue, the authors should consider making adjustments to avoid any misunderstanding.\n\n3. How does Figure 2 change as the number of iterations increases?"
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "5: marginally below the acceptance threshold"
                },
                "confidence": {
                    "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                },
                "first_time_reviewer": {
                    "value": "Yes",
                    "readers": [
                        "ICLR.cc/2024/Conference/Program_Chairs",
                        "ICLR.cc/2024/Conference/Submission8250/Senior_Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission8250/Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission8250/Reviewer_nmYk"
                    ]
                }
            },
            "number": 1,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission8250/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698708791870,
            "cdate": 1698708791870,
            "tmdate": 1699637026166,
            "mdate": 1699637026166,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "p9EdekqdD5",
                "forum": "MY8SBpUece",
                "replyto": "TRhw5JAGBw",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission8250/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission8250/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Part 1/2"
                    },
                    "comment": {
                        "value": "We thank the reviewer for their valuable comments.\nWe tried to answer each point in detail below.\nPlease let us know if the reviewer has other concerns/questions regarding our paper.\nWe are happy to discuss this further.\n\nWe have uploaded a revised version of the manuscript on OpenReview. Please note that the numbering of theorems and sections has changed in the revised version. We are using the new numbering in our rebuttal.\n\n**Weaknesses**\n\n1- Isotropic Gaussian input is a standard assumption in many theoretical studies. See e.g. (Mei \\& Montanari (2022); Hu \\& Lu (2023); Adlam et al. (2022); Damian et al. (2022)). \nSome of previous work adds more structure to the input by allowing general covariance structure to study specific problems in learning such as covariate shift (see e.g., Mel \\& Pennington (2023); Tripuraneni et al. (2022)). However, this often requires very technical tools such as operator-valued free probability, and is an interesting direction for future work.\nMean zero assumption can be also relaxed by techniques similar to Tripuraneni et al. (2022); Lee et al. (2023). We have mentioned this point in the limitations section in the revised manuscript.\n\n\n2- Since the Hermite polynomials form an orthonormal basis of $L^2(\\mu)$, where $\\mu$ is the standard Gaussian measure on $\\mathbb{R}$, any activation in $L^2(\\mu)$ admits the Hermite expansion.\nIn Condition 2.3, we additionally require that $c_1 \\neq 0$ and a certain decay rate.\nIn the limitation section, we discuss why this assumption is necessary.\nMany popular activation functions including (centered) ReLU, tanh, sigmoid satisfy Condition 2.3.\nWe added this discussion in the revision.\n\n3- In the revision, we changed Condition 2.4 to infinite sum.\nAs mentioned above, as long as $\\sigma_\\star$ is square-integrable, it will admit a Hermite expansion.\nAt the moment, we are not sure how this is related to sample complexity.\nWe would be happy to provide answers if you could clarify your question on the sample complexity. \n\n4- We moved the general $\\ell$ result to the main text in the revision.\nWe note that due to space limitations, it was not possible to include the full formula for the limiting error. \n\n5- We added a limitations section to the end of this paper discussing this point. In Section 4 of the paper, we wanted to demonstrate that the emergence of spikes in the spectrum of the feature matrix will indeed translate to going beyond linear models for large enough step size through the analysis of training loss. Unlike the training loss, the test error does not allow a simple expression such as Lemma K.2. Specifically, the bias term in the test error will contain a term involving two resolvent matrices with the covariance matrix of the learned features multiplied in the middle (see equation C.10 in Ba et al. (2022)). The strategy that we use to simplify such expressions is to use Woodbury formula to take out the spike terms from the resolvent matrices and study terms appearing in the expansion. However, for the case of this complicated formula, one needs to study various forms of interactions between the spike terms. We find that this would require a much more laborious calculation, and since our paper is already quite long (cca 50 pages total), we believe it is better suited for follow-up work.\n\n6- We have added *proof idea* sections after the theorems to briefly emphasize the techniques and challenges involved in proving each result.\n\n7- We repeated the experiment in Section 5 with a target function with cubic term.\nSee Figure 4 in the revised manuscript.\nWe observe that the cubic part is learned with a large enough step size.\n\n\n8- In the supplementary material, we included additional experiments on the MNIST dataset (see Figure 5 and 6 in the revised manuscript).\nWe plot the histogram of the singular values of the feature matrix after one gradient step with $\\eta = n^{0.29}$ in Figure 5.\n\nAlthough the MNIST dataset does not satisfy our theoretical conditions (Gaussian input, single-index model, etc.), we empirically observe similar phenomena such as emergence of spikes after one-step gradient update.\nWe would like to emphasize that the main purpose of our work is to gain a deeper understanding of feature learning through analysis of a simple toy model.\nModern deep learning operates based on vague intuitions and works for mysterious reasons.  It is a grand challenge understand its behavior, and any progress in the area is valuable in our view.\nThus, we believe fundamental research is necessary for future advances in the field. The use of simple theoretical models to demystify various phenomenon in deep learning (such as double descent, etc.) has been a very active and successful area of research (see e.g., Mei \\& Montanari, (2022), etc.)."
                    }
                },
                "number": 4,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission8250/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700236817754,
                "cdate": 1700236817754,
                "tmdate": 1700236817754,
                "mdate": 1700236817754,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "wRMdMfcKxH",
                "forum": "MY8SBpUece",
                "replyto": "p9EdekqdD5",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission8250/Reviewer_nmYk"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission8250/Reviewer_nmYk"
                ],
                "content": {
                    "comment": {
                        "value": "Thanks for the author's reply. \n\nFor point 3, I am wondering how the sample complexity (or performance) changes as $c^\\star$ changes."
                    }
                },
                "number": 9,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission8250/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700677364922,
                "cdate": 1700677364922,
                "tmdate": 1700677364922,
                "mdate": 1700677364922,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "T07BWtGtJj",
                "forum": "MY8SBpUece",
                "replyto": "TRhw5JAGBw",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission8250/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission8250/Authors"
                ],
                "content": {
                    "comment": {
                        "value": "We thank the reviewer for the comments and the clarification.\n\nFor example, when looking at the results in Corollary 4.5 (in particular, the expressions for $\\Delta_1$ and $\\Delta_2$), we can see the effect of changing $c_\\star$ on the benefit we gain from doing the one-step gradient update. In particular, we can see how increasing $c_\\star$ while keeping $c_{\\star, 1}$ (for the $\\ell = 1$ case) and $c_{\\star, 1}, c_{\\star, 2}$ (for the $\\ell = 2$ case) constant, will reduce the benefit of the gradient update. Please also refer to the discussion below Corollary 4.5.\n\nIn general, Theorem 4.4 and Corollary 4.5 fully characterize the limiting value of the loss (in the high-dimensional proportional regime of Condition 2.1) as a function of $c_\\star$ (and $\\phi = d/n$, etc.).\n\nShould you have any further questions, we are more than happy to answer."
                    }
                },
                "number": 10,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission8250/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700678427282,
                "cdate": 1700678427282,
                "tmdate": 1700679050590,
                "mdate": 1700679050590,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "9UoPwUnDuw",
            "forum": "MY8SBpUece",
            "replyto": "MY8SBpUece",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission8250/Reviewer_boim"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission8250/Reviewer_boim"
            ],
            "content": {
                "summary": {
                    "value": "The paper delves into the feature learning capabilities of two-layer fully-connected neural networks. It builds on the understanding that with a constant gradient descent step size, only linear components of the target function can be learned. The research introduces a varying learning rate that grows with sample size, which results in the emergence of multiple rank-one components in the feature matrix, each representing a specific polynomial feature. Through spectral analysis, it's shown that the feature matrix's spectrum undergoes phase transitions based on the learning rate, leading to the addition of separated singular values or \"spikes\". These spikes, as the paper demonstrates, are aligned with polynomial features of varying degrees, influencing the neural network's ability to learn non-linear components. The study establishes that the training and test errors of the updated networks are determined by the initial feature matrix and these spikes, with specific cases illustrating the network's capacity to learn quadratic components of the target function."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "3 good"
                },
                "strengths": {
                    "value": "Strength:\n1. Paper is well organized\n2. I think this paper has a good contribution to understanding the learning dynamics of non-linear features by networks, with concrete improvements over Ba et al. 2022."
                },
                "weaknesses": {
                    "value": "Weakness:\n1. Based on my understanding, the core advantage of the proposed analysis is from the Hermite expansion of the activation layer, which can characterize higher-order nonlinearity and explain more non-linear behaviors than the orthogonal decomposition used in Ba et al. 2022. Please clarify this.\n2. The required condition on the learning rate (scaling with the number of samples) is not scalable. I never see a step size grows with the sample size in practice, which will lead to unreasonably large learning rate when learning on large-scale dataset. I understand the authors need a way to precisely characterize the benefit of large learning rates, but this condition is not realistic itself."
                },
                "questions": {
                    "value": "Question:\nIn Figure 3 left/middle: is the total number of training steps fixed? I.e. more iterations for small LR, and fewer iterations for large LR? This is important for a fair comparison between small and large learning rates."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "6: marginally above the acceptance threshold"
                },
                "confidence": {
                    "value": "2: You are willing to defend your assessment, but it is quite likely that you did not understand the central parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 2,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission8250/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698816516875,
            "cdate": 1698816516875,
            "tmdate": 1699637026045,
            "mdate": 1699637026045,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "x4uCvIe1ZE",
                "forum": "MY8SBpUece",
                "replyto": "9UoPwUnDuw",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission8250/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission8250/Authors"
                ],
                "content": {
                    "comment": {
                        "value": "We thank the reviewer for their valuable comments.\nWe tried to answer each point in detail below.\nPlease let us know if the reviewer has other concerns/questions regarding our paper.\nWe are happy to discuss this further.\n\nWe have uploaded a revised version of the manuscript on OpenReview. Please note that the numbering of theorems and sections has changed in the revised version. We are using the new numbering in our rebuttal.\n\n**Weaknesses**\n\n1- The core contribution of this paper is that we consider a step size $\\eta \\asymp n^\\alpha, \\alpha \\in (0, \\frac{1}{2})$ that grows with the sample size $n$ and examine how the learned features change with $\\alpha$. We show that large enough $\\alpha$ can enable learning nonlinear features that is impossible when the step size is constant. Ba et al. (2022) only studied the learned features when the step size is constant. \n\n2- Giant step sizes have recently gained a lot of attention in the deep learning theory community. See e.g., (Dandi et al. 2023). One can heuristically think of one giant step as an approximation to taking multiple small steps.\n\nWe would like to emphasize that the main purpose of our work is to gain a deeper understanding of feature learning through analysis of a simple toy model.\nModern deep learning operates based on vague intuitions and works for mysterious reasons.  It is a grand challenge understand its behavior, and any progress in the area is valuable in our view.\nThus, we believe fundamental research is necessary for future advances in the field. The use of simple theoretical models to demystify various phenomenon in deep learning (such as double descent, etc.) has been a very active and successful area of research (see e.g., Mei \\& Montanari, (2022), etc.).\n\n\n**Questions**\n\n1- In all the experiments in the paper, we stick to the one gradient step update and only change the step size."
                    }
                },
                "number": 3,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission8250/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700236795307,
                "cdate": 1700236795307,
                "tmdate": 1700236795307,
                "mdate": 1700236795307,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "EYOY3XmNT0",
            "forum": "MY8SBpUece",
            "replyto": "MY8SBpUece",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission8250/Reviewer_w1FP"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission8250/Reviewer_w1FP"
            ],
            "content": {
                "summary": {
                    "value": "The authors studied the effect of feature learning in a two-layer neural network, where the first-layer weight matrix receives one gradient update with large learning rate, and the target function is a single-index model. The main contribution is a spike decomposition of the feature matrix, where the corresponding singular vectors contain polynomial features of different degrees\ndepending on the scaling of step size $\\eta$. This allows the authors to compute the asymptotic training error under a Gaussian equivalence conjecture and quantify the improvement in the loss due to feature learning."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "3 good"
                },
                "strengths": {
                    "value": "This submission generalizes the result in (Ba et al. 2022) to step sizes that scales with $\\eta\\asymp n^\\alpha$ for $\\alpha\\in (0,1/2)$, and provides a precise description of the nonlinear feature learning after one gradient update. Moreover, the authors identified a sequence of phase transitions with respect to the learning rate scaling, where a degree-$\\ell$ spike appears when the exponent of the step size exceeds $\\alpha^2>1-\\frac{1}{\\ell}$. This finding may motivate random matrix theory research on similar nonlinear spiked matrix models."
                },
                "weaknesses": {
                    "value": "My main concern is that unlike (Ba et al. 2022), the theoretical results in the current submission does not translate to learning guarantees for the studied single-index teacher. As a result, it is unclear if a larger learning rate provides any statistical benefits, so the claim that *\"for large enough step sizes, the model can learn non-linear components of the teacher function\"* is not supported.  \nIn Figure 3 the authors plotted the test error which exhibits improvement due to the learning of the quadratic component, but such improvement is not proved, and the experimental setting is only for target function with information exponent $s=1$. In fact, by inspecting the formulae for $\\Delta$, it appears that the test error cannot improve for $s>1$.   \nThis limitation needs to be explicitly mentioned in the main text."
                },
                "questions": {
                    "value": "I have the following questions regarding the figures in the main text. \n\n1. In Figure 2, do the crosses represent the theoretical predictions of the spike location? If so, how are these values obtained? \n\n2. In Figure 3, do the solid lines correspond to the analytic predictions based on Theorems 4.4 and 4.5? If so, why do we observe fluctuations in the curve?"
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "6: marginally above the acceptance threshold"
                },
                "confidence": {
                    "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 3,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission8250/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1699428140688,
            "cdate": 1699428140688,
            "tmdate": 1699637025901,
            "mdate": 1699637025901,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "T1cD6XdORz",
                "forum": "MY8SBpUece",
                "replyto": "EYOY3XmNT0",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission8250/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission8250/Authors"
                ],
                "content": {
                    "comment": {
                        "value": "We thank the reviewer for their valuable comments.\nWe tried to answer each point in detail below.\nPlease let us know if the reviewer has other concerns/questions regarding our paper.\nWe are happy to discuss this further.\n\nWe have uploaded a revised version of the manuscript on OpenReview. Please note that the numbering of theorems and sections has changed in the revised version. We are using the new numbering in our rebuttal.\n\n**Weaknesses**\n\n\n1-  Unlike the training loss, the test error does not allow a simple expression such as Lemma K.2. Specifically, the bias term in the test error will contain a term involving two resolvent matrices with the covariance matrix of the learned features multiplied in the middle (see equation C.10 in Ba et al. (2022)). The strategy that we use to simplify such expressions is to use Woodbury formula to take out the spike terms from the resolvent matrices and study terms appearing in the expansion. However, for the case of this complicated formula, one needs to study various forms of interactions between the spike terms. We find that this would require a much more laborious calculation, and since our paper is already quite long (cca 50 pages total), we believe it is better suited for follow-up work. \n\nIn the nonlinear random matrix theory community, it is common to only derive the limiting training loss  after the study of the spectrum of the feature matrix (see e.g., Pennington \\& Worah (2017); Louart et al. (2017), etc.). Deriving the precise asymptotics for the test loss is a very interesting problem and we leave it as a future work.\n\n\nWe have added this to a limitation section at the end of the paper in the revised manuscript.\nAlso, we changed out statement to \"Moreover, for large enough step sizes, \nthe model can fit non-linear components of the teacher function.\"\n\n\n2- We thank the reviewer for pointing this out. It is true that when learning single index functions, with one gradient step, in the proportional regime, the information exponent needs to be one in order for the gradient step to be beneficial. This is also true for the results of Ba et al. (2022).  Recently, Dandi et al. (2023) showed that for single index models with information exponent $\\kappa$, there are hard directions such that learning them will require $\\Theta(d^\\kappa)$ samples. \nThey also show that with one gradient step, and a sample size $\\Theta(d)$, only a single direction of a multi-index target function can be learned. In the present work, we study the problem of learning nonlinear components of a single-index target function with $\\kappa = 1$. We clarified these points in the related works, and the limitations section that can be found in the revised manuscript.\n\n**Questions**\n\n1- In this plot, the crosses are showing the location of the singular values, based on simulations.\n\n2- In this plot, the the curves are drawn using simulation results. Note that the convergence can be very slow in this problem. For example note that when $\\ell = 2$, we need to have a large enough $n$, $N$, $d$ such that terms like $n^{1/2}/\\eta^2$ to go to zero with $\\eta = n^{\\alpha}$ with $\\alpha \\in (1/4, 1/3)$  (Section K.2.1, analysis of terms (4,2) and (2,4)).\nFor example, if we choose $\\alpha = 0.3$, making $n^{1/2}/\\eta^2 = 0.01$ requires $n = 10^{20}$.\nIn other words, with small $n, N, d \\approx 10^{3} \\sim 10^4$ that can be handled with a personal computer and academic cluster that we have access to, we cannot expect the simulated result to closely match the asymptotics.\nWe believe some prior works in the polynomial scaling settings might have experienced the same scalability issue, and therefore they could only provide cartoons demonstrating the staircase plot (see e.g.,  Ghorbani et al. (2020), Misiakiewicz (2022), etc.)."
                    }
                },
                "number": 1,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission8250/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700236788360,
                "cdate": 1700236788360,
                "tmdate": 1700236788360,
                "mdate": 1700236788360,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "0TAzEvsybP",
            "forum": "MY8SBpUece",
            "replyto": "MY8SBpUece",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission8250/Reviewer_EiLn"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission8250/Reviewer_EiLn"
            ],
            "content": {
                "summary": {
                    "value": "This paper studied the spikes in the feature map matrix of a two-layer neural network with large step gradient descent (GD) on mean square loss. When learning rate $\\eta=n^\\alpha$ with $\\frac{\\ell-1}{2\\ell}<\\alpha<\\frac{\\ell}{2\\ell+\\ell}$, there will be $\\ell$ large spikes in the feature map matrix (or the Conjugate Kernel matrix) and these spikes are correlated to the degree $\\ell$ Hermite components of the target function. The asymptotic training errors for ridge regression of this trained feature map matrix has been presented in the proportional limit. This paper fills the gap in the learning rates, when $1\\ll\\eta\\ll\\sqrt{n}$, in Ba et al. (2022)."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "3 good"
                },
                "strengths": {
                    "value": "Despite its technical nature, the paper is very well written. The particular setting the authors study is novel and interesting for both the random matrix theory community and deep learning theory. The detailed analysis of the scaling of learning provides us with a more comprehensive understanding of the features learned in GD training processes, although the authors only consider one step of GD. The result is precise and clean, showing the asymptotic improvement in the loss for potential feature learning."
                },
                "weaknesses": {
                    "value": "1. A limitations section is missing. In the conclusion section, the authors should state the limitations of the assumptions and the results. The authors only proved the improvement of training loss in this two-stage training process for neural networks (NNs). There is a lack of analysis for generalization errors, although I understand there may be some difficulty with this kind of theoretical result. There should be some remark or discussion on this, or providing some conjectures related to the generalization error.    \n\n2. Additional simulations are needed. In Section 5, there are only cases for linear and quadratic target functions. It would be better to provide more simulations for training and testing errors with more complicated target functions to show the feature learning when $\\eta$ is sufficiently large. There is no empirical simulation for the staircase phenomenon in Figure 3 (Right).\n\n3. Theorems 4.4 and 4.5 rely on Conjecture 4.3. However, this conjecture is not well stated in the main text. It would be also better to explain the difficulty of the proof and why this conjecture cannot be proved by previous results like Hu&Lu, (2023) and Ba et al. (2022)."
                },
                "questions": {
                    "value": "1. In Section 2.1, the scaling of the neural network is different from Ba et al. (2022). In Ba et al. (2022), they used a mean-field regime with learning rate $\\eta\\sqrt{N}$ and there is an extra $1/\\sqrt{N}$ for the second layer $\\mathbf{a}$. Is this regime the same as the setting of this paper?\n\n2. The initialization of $\\mathbf{W}_0$ is sampled from a uniform distribution on the unit sphere, which is different from the Gaussian initialization of Ba et al. (2022). I guess this initialization will make the analysis simpler, e.g. Lemma B.1 can be applied directly. This should be mentioned somewhere in the paper and explain why you use this initialization.\n\n3. Condition 2.3 assumes that $\\sigma$ has bounded first three derivatives but this won't be true if you consider the general polynomial activation function, which is set in Theorem 3.3. For Theorems 3.4, 4.1-4.2, and 4.4-4.5, do you only consider $\\sigma$ as a polynomial or center ReLU function? I am confused why Theorem 3.3 needs polynomial activation functions which may contradict with Condition 2.3.\n\n4. For Figure 2, are the locations of the spikes and the alignments empirically simulated or can you predict them from your theory? From Theorem 3.4, these alignments should converge to one, right?\n\n5. In Theorem 3.3, how about the case when $\\alpha=(\\ell-1)/(2\\ell)$? Any observations in this critical regime?\n\n6. [1] and [2] also studied the initial feature matrix $\\\\mathbf{F}_{0}$. And [1] also presented the limit of training error for random feature ridge regression but with a slightly different definition than yours.\n\n7. Above Theorem 3.4, vector $\\mathbf{w}_i$ is not defined.\n\n8. Below (4), why does $c_{>1}$ also include $c_1$?\n\n9. For Theorems 4.4 and 4.3, can you say something about some extreme cases? For instance, $n\\gg N,d$ or $N\\gg n,d$. \n\n10. In Section 4.2, why not present the theory of training loss for general $\\ell$ like Appendix L? Can Appendix L directly cover Theorems 4.4 and 4.3? Besides, using Appendix L, can you plot Figure 3 (Right) and show that the training loss is always decreasing?\n\n11. I cannot see how Figure 3 (Left and Middle) matches Theorems 4.4 and 4.3 for training loss with $\\log\\eta/\\log n<1/4$ or $1/4<\\log\\eta/\\log n<1/3$. You may need to point out the threshold in the figures. Besides, in the middle figure, why is the testing error increasing for setting 1 with a large learning rate? Can you explain this phenomenon here? It seems like in this case, we do not have improvement for feature learning. Besides, there should be a benchmark, the prediction risk for the best linear model in this figure to compare with the feature learning.\n\n12. In Appendix A, a typo for the definition of $\\mathbf{R}_{0}$.\n\n13. Lemma B.1, do you need to require $\\\\|a\\\\|=\\\\|b\\\\|=1$?\n\n14. In the proof of proposition 3.1, how do you use Lemma J.1 to derive the limit of $\\boldsymbol{\\beta}^\\top\\boldsymbol{\\beta}_{\\*}$?\n\n15. In the proof of Theorem 3.4, how do you show the rank of the sum of the spikes is exactly $\\ell$? Is it easy to see that $(\\tilde{\\mathbf{X}}\\boldsymbol{\\beta})^{\\odot k}$ are linearly independent for different $k$?\n\n16. In the final result of Appendix L, why is $c_{\\*,0}$ also included in the asymptotic difference of the training errors? In $\\ell=1,2$, there is no $c_{\\*,0}$; see (5) and (6). And What is $M$ in the summation? There should be some discussion about this result.\n\n\n\n==================================================================================================\n\n[1] Louart, et al. \"A random matrix approach to neural networks.\"  \n\n[2] Fan and Wang. \"Spectra of the conjugate kernel and neural tangent kernel for linear-width neural networks.\""
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "details_of_ethics_concerns": {
                    "value": "N/A"
                },
                "rating": {
                    "value": "5: marginally below the acceptance threshold"
                },
                "confidence": {
                    "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
                },
                "code_of_conduct": {
                    "value": "Yes"
                },
                "first_time_reviewer": {
                    "value": "Yes",
                    "readers": [
                        "ICLR.cc/2024/Conference/Program_Chairs",
                        "ICLR.cc/2024/Conference/Submission8250/Senior_Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission8250/Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission8250/Reviewer_EiLn"
                    ]
                }
            },
            "number": 4,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission8250/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1699602440557,
            "cdate": 1699602440557,
            "tmdate": 1699637025778,
            "mdate": 1699637025778,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "FBezcvsEBs",
                "forum": "MY8SBpUece",
                "replyto": "0TAzEvsybP",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission8250/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission8250/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Part 1/3"
                    },
                    "comment": {
                        "value": "We thank the reviewer for their valuable comments. We tried to answer each point in detail below. Please let us know if the reviewer has other concerns/questions regarding our paper. We are happy to discuss this further.\n\nWe have uploaded a revised version of the manuscript on OpenReview. Please note that the numbering of theorems and sections has changed in the revised version. We are using the new numbering in our rebuttal.\n\n**Weaknesses**\n\n1- We thank the reviewer for the suggestion to write a limitations section. We have written a limitation section at the end of the paper in the revised manuscript. \n\nIn Section 4 of the paper, we wanted to demonstrate that the emergence of spikes in the spectrum of the feature matrix will indeed translate to going beyond linear models for large enough step size through the analysis of training loss. Unlike the training loss, the test error does not allow a simple expression such as Lemma K.2. Specifically, the bias term in the test error will contain a term involving two resolvent matrices with the covariance matrix of the learned features multiplied in the middle (see equation C.10 in Ba et al. (2022)). The strategy that we use to simplify such expressions is to use Woodbury formula to take out the spike terms from the resolvent matrices and study terms appearing in the expansion. However, for the case of this complicated formula, one needs to study various forms of interactions between the spike terms. We find that this would require a much more laborious calculation, and since our paper is already quite long (cca 50 pages total), we believe it is better suited for follow-up work.\n\nIn the nonlinear random matrix theory community, it is common to only derive the limiting training loss  after the study of the spectrum of the feature matrix (see e.g., Pennington \\& Worah (2017); Louart et al. (2017), etc.). Deriving the precise asymptotics for the test loss is an interesting problem and we leave it as a future work. \n\n2- Regarding your point on conducting experiments for the staircase plot in Figure~3 (Right), for example note that when $\\ell = 2$, we need to have a large enough $n$, $N$, $d$ such that terms like $n^{1/2}/\\eta^2$ to go to zero with $\\eta = n^{\\alpha}$ with $\\alpha \\in (1/4, 1/3)$  (Section K.2.1, analysis of terms (4,2) and (2,4)).\nFor example, if we choose $\\alpha = 0.3$, making $n^{1/2}/\\eta^2 = 0.01$ requires $n = 10^{20}$.\nIn other words, with small $n, N, d \\approx 10^{3} \\sim 10^4$ that can be handled with our personal computers and academic clusters at the moment, we cannot expect the simulated result to closely match the asymptotics.\nWe believe some prior works in the polynomial scaling settings might have experienced the same scalability issue, and therefore they could only provide cartoons demonstrating the staircase plot (see e.g.,  Ghorbani et al. (2020), Misiakiewicz (2022), etc.). \n\nWe repeated the experiment in Section 5 with a target function with cubic term.\nSee Figure 4 in the revised manuscript.\nWe observe that the cubic part is learned with a large enough step size.\n\n3- Our results in Section 4.2 rely on a Gaussian equivalence\nconjecture for the untrained features $\\mathbf{F}_0$ (and not the trained features $\\mathbf{F}$). In the proofs of Section 4.2, by the application of Woodbury's formula, and taking out the spike terms in $\\mathbf{F}$ from the resolvent matrix $\\mathbf{R}$ to reduce the problem to a problem involving  $\\mathbf{F}_0$ and spikes, and we only need a Gaussian equivalence theorem to linearize $\\mathbf{F}_0$; as it is common in the literature of random features models. The Gaussian equivalence conjecture we use, despite being very similar to the results discussed in Section J, does not directly follow from prior work. One can try to use the Lindeberg exchange idea used by Hu \\& Lu (2023) and Bosch et al. (2023) to try to prove this specific conjecture. Although this approach might work, due to the complication form of the terms under consideration (listed in Section I),  we have not yet been able to prove this specific form of Gaussian equivalence conjecture, despite some serious attempts.\nWe have also discussed this in the limitations section."
                    }
                },
                "number": 2,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission8250/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700236789436,
                "cdate": 1700236789436,
                "tmdate": 1700236789436,
                "mdate": 1700236789436,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    }
]