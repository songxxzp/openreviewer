[
    {
        "title": "Improving Generalization in Equivariant Graph Neural Networks with Physical Inductive Biases"
    },
    {
        "review": {
            "id": "DAGw1W9bZr",
            "forum": "3oTPsORaDH",
            "replyto": "3oTPsORaDH",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission6713/Reviewer_mXJL"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission6713/Reviewer_mXJL"
            ],
            "content": {
                "summary": {
                    "value": "## Summary\n\nThe paper investigates the integration of physical inductive biases, equivariant Graph Neural Networks (GNNs), and Neural Ordinary Differential Equations (ODEs) to improve model prediction accuracy. The authors validate their approach on 3 datasets: N-body, molecular dynamics, and captured human motion data. The technical contributions are sound though not groundbreaking. Given the paper's strengths and incremental contribution, I recommend a borderline acceptance.\n\n## Detailed Comments\n\n### Contributions\n\n1. The paper shows that the error bound between the predictions and the ground truth outperforms previous methods focused on average accelerations.\n2. It establishes that when the incremental function is either E(3) or O(3), the combined Neural ODE and equivariant GNN also possess these properties.\n3. It shows enough empirical validation and ablation studies for later scholars to save their time and make proper choices.\n\n### Comments and Suggestions\n\na) Lack of Visual Illustration: Apart from human motion data, the paper does not provide visual illustrations for any of the datasets. This makes it challenging to grasp the scope of the method's applicability, especially for readers not specialized in fields like molecular dynamics or N-body systems.\n\nb) Figure 4 Inconsistency: The first column in Figure 4 is hard to interpret due to inconsistent color coding of initial conditions and predictions across different columns. It would be helpful to maintain color consistency.\n\nc) Unclear experiment in Figure 2: It is unclear which experiment or dataset Figure 2 refers to, leading to possible confusion for the readers.\n\nd) Inconsistent Sectioning for Human Motion Experiment: Unlike the other experiments, the human motion experiment is not provided a standalone section, making it confusing for readers.\n\ne) Future Direction on Scalability: The paper could benefit from discussing scalability issues for large graphs. Since all examples in the paper involve graphs with fewer than 1,000 nodes, it would be interesting to explore the method's applicability to larger networks. Some relevant references include:\n\n- [MultiScale MeshGraphNets](https://arxiv.org/abs/2210.00612)\n- [Multi-GPU Approach for Training of Graph ML Models on large CFD Meshes](https://arxiv.org/abs/2307.13592)\n- [Efficient Learning of Mesh-Based Physical Simulation with BSMS-GNN](https://arxiv.org/abs/2210.02573)\n- [LazyGNN: Large-Scale Graph Neural Networks via Lazy Propagation](https://arxiv.org/abs/2302.01503)\n\n## Conclusion\n\nThe paper presents a sound technical approach integrating physical inductive biases, equivariant GNNs, and higher-order Neural ODEs to improve model prediction accuracy. It's a sound but not groundbreaking paper. Therefore, I recommend a borderline acceptance for this paper."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "2 fair"
                },
                "strengths": {
                    "value": "See above"
                },
                "weaknesses": {
                    "value": "See above"
                },
                "questions": {
                    "value": "See above"
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "6: marginally above the acceptance threshold"
                },
                "confidence": {
                    "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
                },
                "code_of_conduct": {
                    "value": "Yes"
                },
                "first_time_reviewer": {
                    "value": "Yes",
                    "readers": [
                        "ICLR.cc/2024/Conference/Program_Chairs",
                        "ICLR.cc/2024/Conference/Submission6713/Senior_Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission6713/Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission6713/Reviewer_mXJL"
                    ]
                }
            },
            "number": 1,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission6713/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698359135074,
            "cdate": 1698359135074,
            "tmdate": 1699636771197,
            "mdate": 1699636771197,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "CY1mQEsR3z",
                "forum": "3oTPsORaDH",
                "replyto": "DAGw1W9bZr",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6713/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6713/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Response to Reviewer mXJL"
                    },
                    "comment": {
                        "value": "Thank you for the provided comments and helpful suggestions! We have enhanced our paper accordingly.\n\n>Comment a: Lack of Visual Illustration.\n\nThanks for the instructive suggestion. We have included visualizations of N-body systems in the revised version. \n\n\n>Comment b: Inconsistent color in Figure 4.\n\nThanks for the comment. We have corrected the colors of Figure 4.\n\n>Comment c: Figure 2 description.\n\nThanks for raising this issue. Figure 2 is a case study of charged N-body systems where EGNN and SEGNO are trained to predict positions after 1000ts. We have added it to the Figure 2 caption in the revised version.\n\n>Comment d: Inconsistent Sectioning for Human Motion Experiment.\n\nWe apologize for the confusion. We adjust section arrangements to enhance readability in the revised version.\n\n>Comment e: Future Direction on Scalability.\n\nThank you for providing insightful future direction and valuable references! We agree that it is a very interesting point to explore our framework to solve the dynamics of large graphs. Analogous to our work, a feasible solution is to parameterize the target partial differential equation (PDE) via a GNN and incorporate solvers to train the model. We have added the references and will explore them in future work."
                    }
                },
                "number": 5,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6713/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700230330253,
                "cdate": 1700230330253,
                "tmdate": 1700230330253,
                "mdate": 1700230330253,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "gigrBTekQZ",
                "forum": "3oTPsORaDH",
                "replyto": "DAGw1W9bZr",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6713/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6713/Authors"
                ],
                "content": {
                    "title": {
                        "value": "A Summary of Our Rebuttal"
                    },
                    "comment": {
                        "value": "Thanks very much for your time and valuable suggestions. In the rebuttal period, we have added additional visualizations of N-body systems in Appendix, corrected Figure 4 colors, Figure 2 description, and inconsistent sectioning for the human motion experiment. We also appreciate the insightful future direction and valuable references. We have added it as future work in the revised version.\n\nWould you mind checking our responses and confirming whether you have any further questions?\n\nAny comments and discussions are welcome!\n\nThanks for your attention and best regards."
                    }
                },
                "number": 16,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6713/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700704710420,
                "cdate": 1700704710420,
                "tmdate": 1700704710420,
                "mdate": 1700704710420,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "qCvgybi8Lx",
            "forum": "3oTPsORaDH",
            "replyto": "3oTPsORaDH",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission6713/Reviewer_rsLd"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission6713/Reviewer_rsLd"
            ],
            "content": {
                "summary": {
                    "value": "The authors present an innovative graph neural network framework that introduces second-order continuity into the modeling process. Unlike traditional discrete updates in other graph neural networks, they employ neural ordinary differential equations to capture continuous trajectories. This approach preserves the equivariance property of the underlying graph neural networks. Their model is rigorously evaluated across a range of standard test systems, including time evolution of N-body systems, molecular trajectories, and human motion trajectories. In all experiments, their model consistently outperform existing methods."
                },
                "soundness": {
                    "value": "4 excellent"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "4 excellent"
                },
                "strengths": {
                    "value": "- The paper is well written and structured\n- The authors introduce a novel framework for graph neural networks that incorporates second-order continuity by utilizing neural ODEs. This innovation enables more accurate modeling of physical systems, as many are governed by second-order laws.\n- Their approach stands out by allowing the modeling of continuous trajectories, in contrast to existing graph neural networks that rely on discrete updates.\n- They rigorously prove the claims they make, such as the preservation of equivariance and the derivation error bounds. \n- Their model undergoes extensive testing on various time series prediction tasks, consistently outperforming previous models and showcasing its superior performance.\n-  The insightful ablation study underscores the significance of incorporating second-order dynamics and utilizing a continuous model instead of a discrete one.\n\nIn conclusion, I consider this paper to be a significant and valuable addition to the community, and I recommend its acceptance."
                },
                "weaknesses": {
                    "value": "- Run times for the various methods are not reported. Given the neural ODE nature of SEGNO, it's reasonable to assume that this model might have longer execution times compared to some of its competitors. It would be advantageous to include these run times in the appendix, with brief mentions in the main text for clarity."
                },
                "questions": {
                    "value": "- Can SEGNO be included in a Markov Chain Monte Carlo (MCMC) framework aimed at accelerating Molecular Dynamics simulations, a common application for predicting future trajectory states? Typically, such applications require Metropolis-Hastings corrections to asymptotically sample from the equilibrium distribution.\n\n- Graph neural networks are known for their transferability, as demonstrated by other methods on the QM9 dataset. While acknowledging the difference in tasks, do the authors envision the potential for SEGNO to be employed in a similarly transferable manner?"
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "8: accept, good paper"
                },
                "confidence": {
                    "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                },
                "first_time_reviewer": {
                    "value": "Yes",
                    "readers": [
                        "ICLR.cc/2024/Conference/Program_Chairs",
                        "ICLR.cc/2024/Conference/Submission6713/Senior_Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission6713/Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission6713/Reviewer_rsLd"
                    ]
                }
            },
            "number": 2,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission6713/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698794930587,
            "cdate": 1698794930587,
            "tmdate": 1699636771081,
            "mdate": 1699636771081,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "KXOyPj2eUc",
                "forum": "3oTPsORaDH",
                "replyto": "qCvgybi8Lx",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6713/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6713/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Response to Reviewer rsLd"
                    },
                    "comment": {
                        "value": "We really appreciate the reviewer for listing the detailed strengths, which have clearly recognized the novelty and contributions of our paper. As requested by the reviewer, we have experimentally shown the running time of all models.\n\n>Weakness 1: Running time of models.\n\nThanks for your suggestion! We evaluate the running time of each model on N-body systems with Telsa T4 GPU and report the average forward time in seconds for 100 samples. The results are listed below:\n\n| Model | Linear | GNN | GDE | TFN | SE(3)-Tr.| Radial Field | EGNN | GMN | SEGNN | SEGNO |\n| :---- | :---- | :---- | :---- | :---- | :---- | :---- | :---- | :---- | :---- | :---- |\n| Time(s)| 0.0002 | 0.0064 | 0.0088 | 0.0440 | 0.2661 | 0.0052 | 0.0126 | 0.0137 | 0.0315 | 0.0277 |\n\nWe can observe that SEGNO's forward time (0.0227s) remains competitive compared to the best baseline SEGNN (0.0315s), indicating its efficiency.\n\n>Question 1: Can SEGNO be included in a Markov Chain Monte Carlo (MCMC) framework\uff1f\n\nThe reviewer has raised an interesting question that would serve as a possible future direction. Although both SEGNO and the MCMC framework (Metropolis-Hastings) aim to explore molecular dynamics, they are different in the following aspects:\n* SEGNO primarily focuses on simulating the time-dependent evolution inherent in Newtonian dynamics.\n* MCMC framework is targeted towards thermodynamic analysis of molecular systems at equilibrium, rather than dynamic simulations of how systems evolve over time.\n\nGiven their different operational domains and objectives in molecular dynamics, integrating SEGNO with the MCMC framework remains a challenging task. However, a possible solution is to replace the target ODE of SEGNO with a Stochastic Differential Equation (SDE). Thus, MCMC framework can be employed to estimate parameters within the SDE. We will explore it in the future.\n\n>Question 2: Do the authors envision the potential for SEGNO to be employed in a similarly transferable manner?\n\nYes! We agree that it is a very interesting and promising point to explore. To investigate the model transferability across different systems, we train models on 5-body Gravity systems and test them on 10-body and 20-body systems. The goal is to predict the positions after 1000ts. The results are as follows:\n\n| System | EGNN | GMN | SEGNN | SEGNO |\n| :---- | :---- | :---- | :---- | :---- |\n| 10-body | 0.566 | 0.716 | 0.333 | $\\textbf{0.152}$ | \n| 20-body | 1.985 | 1.323 | 3.937 | $\\textbf{0.850}$ | \n\nWe can observe that although SEGNO does not train on trajectories of 10-body and 20-body systems, it achieves significantly better performance, demonstrating its transferability across different systems.\n\nMoreover, for transferability across different tasks, since the goal of SEGNO is to model second-order dynamical systems (i.e., Eq.1), it can be naturally generalized to predict other dynamic states such as energy and momentum."
                    }
                },
                "number": 6,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6713/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700230453776,
                "cdate": 1700230453776,
                "tmdate": 1700230453776,
                "mdate": 1700230453776,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "eO3yQRAmak",
                "forum": "3oTPsORaDH",
                "replyto": "KXOyPj2eUc",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6713/Reviewer_rsLd"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6713/Reviewer_rsLd"
                ],
                "content": {
                    "comment": {
                        "value": "I appreciate the response and the inclusion of additional experiments. My initial rating remains unchanged, as I am content with the overall outcome."
                    }
                },
                "number": 11,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6713/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700597988908,
                "cdate": 1700597988908,
                "tmdate": 1700597988908,
                "mdate": 1700597988908,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "kqJsJpeHqA",
            "forum": "3oTPsORaDH",
            "replyto": "3oTPsORaDH",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission6713/Reviewer_GrTs"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission6713/Reviewer_GrTs"
            ],
            "content": {
                "summary": {
                    "value": "In this work, authors combine neural ODE with equivariant GNN to propose a second order equivariant GNODE (SEGNO). Authors prove that the SEGNO maintains equivariance. The study prove that the discrepancy between the trajectory learned by SEGNO and the ground truth is bounded. Results show that the SEGNO provides relatively superior performance on various dynamical systems."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "2 fair"
                },
                "strengths": {
                    "value": "1. Learning dynamical systems with physics-based inductive bias is an important problem to be studied.\n2. Combining equivariance with NODE is an interesting approach. \n3. Several interesting and varied datasets are considered for empirical examples including n-body systems, MD22, and motion capture datasets. \n4. The results show that the SEGNO outperforms baselines for several tasks including molecular dynamics, and motion capture."
                },
                "weaknesses": {
                    "value": "1. The idea of combining GNODE with an equivariant GNN is fairly straightforward. In fact, there are several works on GNODE that employ a second-order bias (Gruver et al., Bishnoi et al., both cited in the paper). While the backbone GNN can have some effect on the GNODE (as shown in the work: Thangamuthu, A., Kumar, G., Bishnoi, S., Bhattoo, R., Krishnan, N.M. and Ranu, S., 2022. Unravelling the performance of physics-informed graph neural networks for dynamical systems. Advances in Neural Information Processing Systems, 35, pp.3691-3702.), there are no restrictions on employing an equivariant GNN backbone with GNODE. Thus, the novelty of the work may be limited.\n\n2. In the present work, GMN is used as the backbone GNN along with the GNODE based inductive bias. The choice of the specific backbone may be appropriate for some datasets such as motion capture. However, the architecture does not perform well for molecular datasets or even n-body systems. Evaluation on additional backbone architectures is missing.\n\n3. The baselines considered are simple and not necessarily SOTA. For the MD22, there are several equivariant GNNs such as DimeNet, NequIP, Allegro, MACE, BOTNet, Equiformer, etc. (and many more newer architectures) that have shown SOTA performance. It is not clear why such advanced baselines or graph architectures are not used.\n\n4. The metrics used for comparison does not necessarily capture the complete picture regarding the dynamics. There are several metrics such as energy violation error, momentum error, rollout error etc. in the literature. Moreover, for atomic structures additional metrics such as JS divergence of the radial distribution functions capture how well the predicted the structure is similar to the ground truth. Such metrics have not been included in the present work leading to an incomplete evaluation. \n\n5. There are several works on articulated rigid body in the literature including physics-informed GNNs such as Hamiltonian NNs, and Lagrangian graph neural networks for articulated body. Comparison with such baselines are not included in the work."
                },
                "questions": {
                    "value": "1. Authors may rephrase the text ``accurately approximate'' in the proof of theorem 4.2?\n2. Theorem 4.1 is a standard proof for any dynamical system and is not specifically related to SEGNO. It is not clear why this is a property of SEGNO and discussed under section 4. Authors may comment.\n3. Proposition 4.2 is trivially dependent on the universal approximation theorem and is not needed to be stated as a proposition. Essentially, it proves that a NN can approximate the function $f(q,h)$ by minimizing the error between $q_{\\theta}$ predicted by a NN and the ground truth $q$. This how every NN is trained. Authors may explain why this warrants a separate proof. \n4. The present work focusses on combining equivariant GNNs with GNODEs. There are several ways of considering baselines. One set of baselines would be different equivariant architectures directly employing a data-driven approach to predict the dynamics. This is how some of the baselines are included in the present work. However, extensive literature shows that physics-informed inductive bias such GNODE, Hamiltonian GNN, and Lagrangian GNN can provide superior performance. Comparison with other such physics-informed GNNs such as Hamiltonian and Lagrangian GNN would have been insightful. \n5. Another set of baselines would be GNODE with different equivariant backbone architectures. This has not been extensively evaluated in the present work. In the present work, authors employ GMN as the backbone. While it makes sense for the motion capture video, it is not clear why GMN would be a good backbone for the MD simulation dataset. Backbones such as NequIP would be better for such cases. Authors are encouraged to evaluate this."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "5: marginally below the acceptance threshold"
                },
                "confidence": {
                    "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 3,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission6713/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1699188902216,
            "cdate": 1699188902216,
            "tmdate": 1699636770981,
            "mdate": 1699636770981,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "U0SOHVBnvS",
                "forum": "3oTPsORaDH",
                "replyto": "kqJsJpeHqA",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6713/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6713/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Response to Reviewer GrTs - (1/3)"
                    },
                    "comment": {
                        "value": "Thanks for your constructive comments! We try our best to address your concerns about the novelty and theoretical findings. As suggested by the reviewer,  extensive additional experiments including additional baselines, metrics, and backbones, are conducted to further support our contributions. \n\n### On the novelty.\n>Weakness 1: The idea of combining GNODE with an equivariant GNN is fairly straightforward.\n\nThanks for the comment. We would like to clarify that our contributions do **NOT** lie in the combinations of GNODE and equivariant GNNs. Existing studies[1,2] mainly employ a GNN that iteratively updates the latent representation to forecast the average acceleration. We distinguish our novelty and significance in the following aspects:\n\n* Our goal of providing theoretical insights to build Graph Neural ODE is novel and has never been explored before as far as we know. We show that a second-order Graph Neural ODE that iteratively updates positions instead of latent representations, can obtain bounded error of instantaneous acceleration and position through minimizing position discrepancy.\n* We thank the reviewer for raising the comparison with the works[1,2]. We validate our findings in novel applications (e.g., molecular and human motion dynamics) where the geometric property is crucial and propose incorporating equivariant GNNs to fulfill this inductive bias. Empirical results demonstrate our model has better generalization ability.\n* Thanks for your reference[1]. We agree that it is feasible to change NODE[1] backbones to equivariant GNNs. Nevertheless, it is still not clear whether such replacement affects the equivariant property of models. Our Proposition 3.1 provides a guarantee to build an equivariant GNODE.\n\n\nThanks for your valuable references. We have added discussions of these papers in the revised version. We believe such a discussion can clarify the main contribution of our paper.\n\n[1] Unravelling the performance of physics-informed graph neural networks for dynamical systems. NeurIPS, 2022.\n\n[2] Enhancing the inductive biases of graph neural ode for modeling dynamical systems. ICLR, 2023.\n\n[3] Deconstructing the inductive biases of hamiltonian neural networks. ICLR, 2022.\n\n### Compared with advanced force field prediction models, such as NequIP and Allegro.\n\nThanks for your suggestions. We would like to clarify that the goal of baselines such as DimeNet, NequIP, and Allegro, is force field prediction, which is different from our task as follows:\n* **Force field prediction** is a static task that mainly takes atom positions as input, and outputs molecular energy and atom forces. To ensure the conservation of energy, the force predictions are partial gradients of predicted energy.\n* **Trajectory prediction** is a dynamic task that mainly takes atom positions and velocity as input, and outputs future atom positions.\n\n>Weakness 3: It is not clear why advanced baselines, such as DimeNet, NequIP, Allegro, MACE, BOTNet, Equiformer, etc., are not used.\n\nThanks for your suggestion. We add empirical comparison on MD22 with official implementation [Nequip](https://github.com/mir-group/nequip)[1] and [Allegro](https://github.com/mir-group/allegro/tree/main)[2]. The models take atom positions and numbers as input and optimize the errors between geometric outputs (generally treated as predicted forces) and true positions. We try our best to tune the model and the results are as follows:\n\n| Molecule | NequIP | Allegro | SEGNO | \n| :----|:----|:----|:----|\n| Ac-Ala3-NHMe |  $12.060$ | $11.785$ | $0.779$|\n| DHA |  $13.275$ | $13.126$ | $0.887$ |\n| Stachyose |  $11.375$ | $11.164$ | $0.816$ |\n| AT-AT |  $9.178$ | $9.032$ | $0.501$ |\n| AT-AT-CG-CG |  $8.959$ | $8.866$ | $0.617$ |\n| Buckyball Catcher | $5.418$ | $5.331$ | $0.390$ |\n| Double-walled | $3.852$ | $3.794$ | $0.325$ |\n\n\nIt can be observed they do not perform well in this setting due to the lack of dynamic information.\n\n>Question 5: Backbones such as NequIP would be better for such cases.\n\nWe are grateful for advising us to consider NequIP as backbones, which is an important direction to improve model performance. However, as shown in the above results, it is non-trivial to incorporate dynamic geometric features (e.g., velocity) in the framework of irreducible representations. The ways that map velocity into high-order irreducible representations, design interaction modules, and decode dynamic states from irreducible representations are still an open problem. Thus, we are interested in exploring them in future works. We provide the results of the EGNN backbone in the following responses."
                    }
                },
                "number": 7,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6713/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700231103963,
                "cdate": 1700231103963,
                "tmdate": 1700231103963,
                "mdate": 1700231103963,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "vsqUg3gkFt",
                "forum": "3oTPsORaDH",
                "replyto": "kqJsJpeHqA",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6713/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6713/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Response to Reviewer GrTs - (2/3)"
                    },
                    "comment": {
                        "value": "### Additional backbone.\n\n>Weakness 2: Evaluation on additional backbone architectures is missing.\n\nThanks for the suggestion. We report the results of EGNN and GMN backbones as follows:\n\n| SEGNO Backbone | EGNN | GMN | \n| :----|:----|:----|\n| Ac-Ala3-NHMe |  $0.801$ | $0.779$|\n| DHA |  $0.909$ |  $0.887$ |\n| Stachyose |  $0.841$ |  $0.816$ |\n| AT-AT |  $0.525$ |  $0.501$ |\n| AT-AT-CG-CG |  $0.641$ |  $0.617$ |\n| Buckyball Catcher | $0.401$ |  $0.390$ |\n| Double-walled | $0.328$ | $0.325$ |\n\nWe can observe that employing the GMN backbone achieves better results, which could be attributed to its multi-channel feature representation.\n\n### Additional metrics and physics-informed GNN baselines.\n\n>Weakness 4: There are several metrics such as energy violation error, momentum error, rollout error etc. in the literature.\\\n>Weakness 5 & Question 4: Comparison with physics-informed GNNs.\n\nThank you for raising the comparison with physics-informed GNNs. As suggested by the reviewer, we thoroughly compare the rollout position, energy, and momentum errors of our SEGNO with those of GNODE and HGNN on N-body systems [1]. GNODE and HGNN aim to predict future acceleration and Hamiltonian respectively. All models are trained by minimizing the errors between the prediction and dynamic states (e.g., positions or acceleration) after 100 timesteps (a 0.001 second as 1 timestep). The results are shown as follows:\n\nOn Charged N-body systems:\n\n| Rollout | ts=100 |  ts=500 |ts=1000 | ts=1500 | ts=2000|\n| :----|:----|:----|:----|:----|:----|\n| HGNN |  $2.16$|  $11.47$|$21.95$| $30.40$ | $36.89$|\n| GNODE |  $0.36$|  $5.41$|$14.05$| $21.61$ | $27.39$|\n| SEGNO | $\\textbf{0.06}$|  $\\textbf{4.26}$ |$\\textbf{12.26}$| $\\textbf{19.42}$ | $\\textbf{25.08}$ |\n\n| Energy | ts=100 |  ts=500 |ts=1000 | ts=1500 | ts=2000|\n| :----|:----|:----|:----|:----|:----|\n| HGNN |  $1.94$|  $7.49$|$11.36$| $14.10$ | $15.53$|\n| GNODE |  $0.82$|  $5.82$|$10.87$| $14.07$ | $15.78$|\n| SEGNO | $\\textbf{0.79}$|  $\\textbf{5.74}$ |$\\textbf{9.93}$| $\\textbf{12.66}$ | $\\textbf{14.05}$ |\n\n| Momentum | ts=100 |  ts=500 |ts=1000 | ts=1500 | ts=2000|\n| :----|:----|:----|:----|:----|:----|\n| HGNN |  $10.12$|  $33.37$|$45.98$| $51.67$ | $54.38$|\n| GNODE |  $4.17$|  $28.65$|$43.97$| $50.84$ | $54.06$|\n| SEGNO | $\\textbf{2.17}$|  $\\textbf{28.39}$ |$\\textbf{43.81}$| $\\textbf{50.46}$ | $\\textbf{53.54}$ |\n\nOn Gravitational N-body systems:\n| Rollout | ts=100 |  ts=500 |ts=1000 | ts=1500 | ts=2000|\n| :----|:----|:----|:----|:----|:----|\n| HGNN |  $3.26$|  $16.78$|$30.83$| $40.07$ | $45.94$|\n| GNODE |  $0.32$|  $6.42$|$17.53$| $26.17$ | $32.16$|\n| SEGNO | $\\textbf{0.04}$| $\\textbf{5.62}$ |$\\textbf{16.84}$| $\\textbf{25.71}$ | $\\textbf{31.82}$ |\n\n| Energy | ts=100 |  ts=500 |ts=1000 | ts=1500 | ts=2000|\n| :----|:----|:----|:----|:----|:----|\n| HGNN |  $2.78$|  $10.73$|$16.10$| $19.50$ | $22.34$|\n| GNODE |  $0.68$|  $7.46$|$14.40$| $18.39$ | $20.85$|\n| SEGNO | $\\textbf{0.11}$| $\\textbf{7.38}$ |$\\textbf{13.58}$| $\\textbf{16.94}$ | $\\textbf{18.89}$ |\n\n| Momentum | ts=100 |  ts=500 |ts=1000 | ts=1500 | ts=2000|\n| :----|:----|:----|:----|:----|:----|\n| HGNN |  $6.99$|  $25.65$|$39.12$| $46.08$ | $49.96$|\n| GNODE |  $2.35$|  $21.43$|$36.93$| $44.92$ | $49.19$|\n| SEGNO | $\\textbf{0.75}$| $\\textbf{21.40}$ |$\\textbf{36.88}$| $\\textbf{44.65}$ | $\\textbf{48.42}$ |\n\nWe can observe that SEGNO consistently outperforms GNODE and HGNN in rollout errors. Although SEGNO is only trained on the system positions,  it achieves comparable performance on energy and momentum errors with GNODE, which further validates our findings.\n\n[1] Unravelling the performance of physics-informed graph neural networks for dynamical systems. NeurIPS, 2022."
                    }
                },
                "number": 8,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6713/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700231264516,
                "cdate": 1700231264516,
                "tmdate": 1700231824136,
                "mdate": 1700231824136,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "t4JsxUtzn1",
                "forum": "3oTPsORaDH",
                "replyto": "kqJsJpeHqA",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6713/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6713/Authors"
                ],
                "content": {
                    "comment": {
                        "value": "### On the theoretical findings.\nIn the following, we provide additional details to eliminate the confusion. It's important to note that these details do **Not** affect the correctness or contributions of our theoretical findings.\n\n\n>Question 2: Why is Theorem 4.1 a property of SEGNO? \n\nApologize for the confusion. We agree that Theorem 4.1 is a general statement regarding the uniqueness of solutions for dynamic systems. This statement serves as the prerequisite for Proposition 4.2 that SEGNO is capable of approximating the instantaneous acceleration of such a unique trajectory. We acknowledge that the current section title may potentially lead to misunderstandings. Thus we change the title as follows:\n* Section 4 -> SEGNO Analysis\n* Theorem 4.1 -> Lemma 4.1\n\n\n>Question 1: Authors may rephrase the text `accurately approximate` in the proof\\\nQuestion 3: Why Proposition 4.2 warrants a separate proof? \n\n\nWe apologize for the confusion caused by the omission of some technical details in the proof. The non-trivial aspects of the proof mainly lie in demonstrating that minimizing the position loss $|| \\mathbf{q}\\_{\\theta}^{(t\\_{1})} - \\mathbf{q}^{(t\\_{1})} ||\\_p$ can enable neural networks to approximate the acceleration $f(\\mathbf{q}^{(t)})$. Previous studies either directly predict the tartget position $\\mathbf{q}^{(t\\_{1})}$ by minimizing position loss $|| \\mathbf{q}\\_{\\theta}^{(t\\_{1})} - \\mathbf{q}^{(t\\_{1})} ||\\_{p}$[1,2] or approximate acceleration $f(\\mathbf{q}^{(t)}, \\mathbf{h})$ using acceleration loss $|| f\\_{\\theta}(\\mathbf{q}\\_{\\theta}^{(t)}) - f(\\mathbf{q}^{(t)})||\\_{p}$[3]. \n\nIn contrast, SEGNO has the ability to convert position loss into acceleration loss. In the meantime, it's a common practice to leverage the universal approximation theorem to establish the universal approximation capability of NNs within deep learning community[4,5,6]. Therefore, according to the aforementioned analysis and universal approximation theorem, it can be shown that SEGNO is capable of approximating acceleration $f(\\mathbf{q}^{(t)}, \\mathbf{h})$ with position loss.\n\nDue to the space constraints, we provide only a concise discussion here. For the complete mathematical derivation, we kindly refer the reviewer to the proof presented in the revised version. Additionally, we would like to re-emphasize that, while Proposition 4.2 seems intuitive, this property has made significant contributions in the following aspects: \n* To the best of our knowledge, it's the first theoretical justification that NNs equipped with SEGNO framework possess the capability to approximate the unique acceleration using position loss.\n* Empirically, it enables SEGNO to recover latent trajectories between input and output states, as illustrated in Fig. 2.\n\n\nRegarding your concern about the term ``accurately approximate``, we agree that it introduces ambiguity pertaining to the level of accuracy. To address the vagueness, we'll rephrase the text to replace ``accurately approximate`` with simple ``approximate``.\n\n[1] V\u0131ctor Garcia Satorras, Emiel Hoogeboom, and Max Welling. E (n) equivariant graph neural networks. ICML, 2021.\n\n[2] Wenbing Huang, Jiaqi Han, Yu Rong, Tingyang Xu, Fuchun Sun, and Junzhou Huang. Equivariant graph mechanics networks with constraints. ICLR, 2022.\n\n[3] Alvaro Sanchez-Gonzalez, Jonathan Godwin, Tobias Pfaff, Rex Ying, Jure Leskovec, and Peter Battaglia. Learning to simulate complex physics with graph networks. ICML, 2020.\n\n[4] Universal Invariant and Equivariant Graph Neural Networks. NeurIPS, 2019.\n\n[5] A Universal Approximation Theorem of Deep Neural Networks for Expressing Probability Distributions. NeurIPS, 2020.\n\n[6] Deep network approximation: achieving arbitrary accuracy with fixed number of neurons. JMLR, 2022."
                    },
                    "title": {
                        "value": "Response to Reviewer GrTs - (3/3)"
                    }
                },
                "number": 9,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6713/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700231791474,
                "cdate": 1700231791474,
                "tmdate": 1700231878983,
                "mdate": 1700231878983,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "vzS35YHa88",
                "forum": "3oTPsORaDH",
                "replyto": "kqJsJpeHqA",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6713/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6713/Authors"
                ],
                "content": {
                    "title": {
                        "value": "A Summary of Our Rebuttal"
                    },
                    "comment": {
                        "value": "Thanks very much for your time and valuable comments. As the discussion will close in a few hours, we would be grateful if you could allocate some time to review our response.\n\nWe understand that you have a multitude of responsibilities, thus **we have summarized our response** as follows:\n\n\n* We add discussions of existing GNODEs to clarify the main contribution of our paper ([Response-(1/3)](https://openreview.net/forum?id=3oTPsORaDH&noteId=U0SOHVBnvS)).\n* We add advanced force field prediction models as baselines ([Response-(1/3)](https://openreview.net/forum?id=3oTPsORaDH&noteId=vsqUg3gkFt)).\n* We empirically compare our model with physics-informed GNN baselines w.r.t. the rollout position, energy, and momentum errors ([Response-(2/3)](https://openreview.net/forum?id=3oTPsORaDH&noteId=vsqUg3gkFt)).\n* We evaluate the performance of different backbones ([Response-(2/3)](https://openreview.net/forum?id=3oTPsORaDH&noteId=vsqUg3gkFt)).\n* We provide additional details to eliminate the confusion about our theoretical findings ([Response-(3/3)](https://openreview.net/forum?id=3oTPsORaDH&noteId=t4JsxUtzn1)).\n\nWould you mind checking our responses and confirming whether you have any further questions?\n\nAny comments and discussions are welcome!\n\nThanks for your attention and best regards."
                    }
                },
                "number": 15,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6713/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700704609590,
                "cdate": 1700704609590,
                "tmdate": 1700704609590,
                "mdate": 1700704609590,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    }
]