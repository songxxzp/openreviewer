[
    {
        "title": "When, Why and How Much? Adaptive Learning Rate Scheduling by Refinement"
    },
    {
        "review": {
            "id": "4FZglwOntM",
            "forum": "1JPfHljXL4",
            "replyto": "1JPfHljXL4",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission239/Reviewer_CaT7"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission239/Reviewer_CaT7"
            ],
            "content": {
                "summary": {
                    "value": "This paper proposes a refined study of learning rate schedule for SGD. It presents last iterate convergence results. The proposed method automatically yields learning rate warm-up and rapid learning rate annealing near the end of training. The authors also conduct comprehensive numerical experiment to illustrate the performance of the proposed method."
                },
                "soundness": {
                    "value": "2 fair"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "2 fair"
                },
                "strengths": {
                    "value": "This work proposes a novel refinement method, which uses a prior training run to produce an improved schedule to use in future runs. This method is guaranteed in a last iterate convergence fashion and can be generalized beyond SGD, which are more realistic.\nBased on this method, a practical method is proposed. Comprehensive experiments validate the performance of the schedule refinement method."
                },
                "weaknesses": {
                    "value": "The theory appears to be more of a heuristic that doesn't directly address practical implementation.\nSome places need further clarifications."
                },
                "questions": {
                    "value": "1.  In Figure 1, how do you define warm-up? Why the refined schedule starts from nearly zero? Does this lead to slow update at the beginning? Is there any way this can be improved?\n2. In the analysis of Th 3, $w_t$ and $g_t$ are assumed to be conditionally independent. Based on that, equation (2) presents a last iteration problem-dependent regret bound. However, the chosen $w_t$ does not satisfy the independent assumption, which means equation (2) does not hold. How you argue this setting of $w_t$ still minimizes the bound?  What is the impact here? \n3. What is the definition of median_filter? How it ensures the gradient norm sequence does not change significantly after refinement?\n4. It seems that the theory is weak, only useful in a heuristic way. What is the novelty in your proof?\n In addition, it is restricted to convex functions. How about cases of non-convex functions under further assumptions?"
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "5: marginally below the acceptance threshold"
                },
                "confidence": {
                    "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 1,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission239/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698630406223,
            "cdate": 1698630406223,
            "tmdate": 1699635949447,
            "mdate": 1699635949447,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "CO3iy1VfLq",
                "forum": "1JPfHljXL4",
                "replyto": "4FZglwOntM",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission239/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission239/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Response"
                    },
                    "comment": {
                        "value": "Thanks for these questions, they really hit at the heart of our paper. We will try and address them individually.\n* Our schedules actually start slightly above 0, with the precise value depending on the norm sequence, although the difference from 0 is not perceptible in the plots unless you zoom in a lot. The use of such small initial LR here is similar to those used in major frameworks such as FairSeq that we use for our GPT and BERT experiments, and as far as we are aware is the most common approach.\n* This is the major subtlety in our work, thank you for asking for clarification on this. Due to the dependence, this setting is only exactly usable with hindsight. However, by using the gradient norms from a previous run, rather than the current run, there is no longer a dependence. As long as the rough shape of the gradient norm sequence matches on the second run, then our bound gives us an improvement. We use a smoothing filter to avoid a dependence on the exact gradient norm, only the smoothed shape of the sequence. \nWe can't guarantee that the gradient norm sequence stays similar, but this appears to hold strongly in practice. The key point is that it only needs to hold approximately for the bound to be an improvement, and we can even calculate the improvement after the run! We find that our bound is between 9 to 1.5 times better than the bound for the linear decay schedule across the set of deep learning problems we considered.\n* Our median filter is precisely the implementation in SciPy. Thank you for pointing this out, we forgot to include the precise definition!\n* Our theory has a major theoretical novelty: it is the first to establish that for any weight sequence for the regret, there is a corresponding *closed form* learning rate schedule that achieves last iterate convergence matching with the optimal rate possible for that weight sequence. This was not known before, and indeed many people we have discussed this result with thought that this was impossible!\n* The surprising fact that the linear decay schedule is *exactly* optimal for non-smooth convex optimization (even without weighting) could also be considered a novelty of our work, although it also appears in concurrent work by Zamani and Glineur published online in late July (which is within the concurrent work window for ICLR).\n\n* While our theory is restricted to the convex setting, it is already known that last-iterate rates for the general stochastic non-convex setting are impossible (https://arxiv.org/pdf/1910.01845.pdf Sec 3.1). It's remarkable that the convex analysis yields methods that work both across the convex and nonconvex settings, and we don't yet understand why. We do see a larger advantage in our convex experiments from using refinement methods and in our non-convex experiments.\n\nPlease let us know if you have any further questions, we see that you have a generally favorable review of our work, and we hope you will consider our work as publication worthy."
                    }
                },
                "number": 5,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission239/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1699905573764,
                "cdate": 1699905573764,
                "tmdate": 1700151936541,
                "mdate": 1700151936541,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "pJV2Y7gGxl",
            "forum": "1JPfHljXL4",
            "replyto": "1JPfHljXL4",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission239/Reviewer_HeFS"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission239/Reviewer_HeFS"
            ],
            "content": {
                "summary": {
                    "value": "The paper proposes a set of learning rate schedules in deep learning from convex optimization theory. The theory can partially explain the popular linear decay schedule and highlights the importance to decrease the learning rate at the ending phase of training. The paper also evaluates the performance of different learning rate schedules on an extensive set of experiments and supports the use of linear-decay learning rate schedules."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "3 good"
                },
                "strengths": {
                    "value": "The paper proposes an interesting theoretical framework to explain the linear decay schedule in deep learning. The theory can also be used to build the learning rate schedule for not only SGD, but also element-wise algorithms like Adam. Numerically, the paper introduces a series of new techniques in algorithm 1 and 2, including median filter, $\\ell_2$ norm inverse weighting, and $\\ell_1$ norm inverse weighting."
                },
                "weaknesses": {
                    "value": "1. The authors should emphasize that their theory is based on convex optimization. In theorem 3 and 8, the assumption that $f$ is a convex function should be clearly stated.\n\n2. For experiments in section 3.2, it is not very clear which algorithm is used. Is it SGD with $\\ell_2$ norm inverse weighting or Adam with $\\ell_1$ norm inverse weighting?\n\n3. Also, authors can provide more details about \"a sweep of learning rates on a grid\" for the refined schedule. Why should we sweep over any parameter in the refined schedule? Based on algorithm 1 or 2, the refined schedule does not contain any additional tuning parameter than $\\tau$."
                },
                "questions": {
                    "value": "It seems that the schedule refinement requires two times computation resources than the standard linear decay or cosine schedule. Is there a way to improve that?"
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "6: marginally above the acceptance threshold"
                },
                "confidence": {
                    "value": "2: You are willing to defend your assessment, but it is quite likely that you did not understand the central parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                },
                "first_time_reviewer": {
                    "value": "Yes",
                    "readers": [
                        "ICLR.cc/2024/Conference/Program_Chairs",
                        "ICLR.cc/2024/Conference/Submission239/Senior_Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission239/Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission239/Reviewer_HeFS"
                    ]
                }
            },
            "number": 2,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission239/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698813059111,
            "cdate": 1698813059111,
            "tmdate": 1699635949346,
            "mdate": 1699635949346,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "HOxsaLN5KZ",
                "forum": "1JPfHljXL4",
                "replyto": "pJV2Y7gGxl",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission239/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission239/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Response"
                    },
                    "comment": {
                        "value": "Thank you for the detailed comments. As you say, we are missing some details regarding our theoretical assumptions and the specific setup of the experiments. We address these points individually below. We will also update the camera ready with these answers.\n\n* You're absolutely correct that we only analyze learning rate schedules in the convex setting. We will update the statement of both Theorems to reflect this clearly. Learning rates overall are not as well understood in the non-convex setting, and we are actively working on extending our work to that setting, but the theoretical obstacles are formidable. Currently last-iterate bounds are known to be impossible for the general stochastic non-convex setting (https://arxiv.org/pdf/1910.01845.pdf Sec 3.1), so a different approach is required.\n* For the experiments in Section 3.2, we use inverse/L2 norm squared for the SGD problems (ImageNet, RCNN, CIFAR) and Adam for the remaining problems, with inverse L1 norm. Currently this is not clearly stated in the experiments section but partially discussed in Section 2.1. We apologize. \n* For the learning rate sweep, we used a [1, 2, 5]]x10^i grid, for varying i. We sweep the baseline learning rate, the quantity that multiplies the schedule, for every problem. We include the sweep here for the refinement schedule also, so the level of tuning for the refinement schedule is the same as all other schedules. We do not sweep \u03c4 , the same value is used for all experiments and visualizations.\n* Our method does require two training runs in the case when you have no existing gradient norm logs to base the schedule on. We are actively researching methods that provide similar adaptivity in a more online fashion, and we believe such approaches are an exciting research frontier, there is currently no known adaptive methods that work well for single runs.\n\n\nWe see that your opinion of our work is overall favorable, and we hope that with these revisions you will revise your score. We think our work has the potential for immediate impact with the community, given it is simple to use and provides substantial improvements in practice. Thank you!"
                    }
                },
                "number": 4,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission239/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1699905492452,
                "cdate": 1699905492452,
                "tmdate": 1699905492452,
                "mdate": 1699905492452,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "SgVuOznWR6",
            "forum": "1JPfHljXL4",
            "replyto": "1JPfHljXL4",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission239/Reviewer_NM9Z"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission239/Reviewer_NM9Z"
            ],
            "content": {
                "summary": {
                    "value": "This paper investigates the learning rate schedules for SGD and study the convergence of the last iteration. The proposed method achieves a problem-adaptive learning rate schedule without using the crude constant bounds on the gradient norms, and proved to be effective via numerical experiments."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "2 fair"
                },
                "strengths": {
                    "value": "1. This paper investigates the last iteration convergence for SGD and shows that the best choice is the linear decay schedule. This finding is also validated by solid numerical experiments. Overall, the authors present interesting results in this paper.\n2. This paper is well-organized and easy for readers to follow. The proofs in the paper seem correct to me."
                },
                "weaknesses": {
                    "value": "1. The contribution of this paper is limited. The $\\frac{1}{\\sqrt{T}}$ convergence is not new, and it would be better if the authors could highlight the difference (novelty) and the challenge in the analysis of this paper.\n\n2. The statement that the best strategy is the linear decay schedule seems not to be well supported. Although in the author's analysis, the proposed method can be reduced to the decay, it cannot theoretically prove that it is better than other methods."
                },
                "questions": {
                    "value": "See Weaknesses Part"
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "5: marginally below the acceptance threshold"
                },
                "confidence": {
                    "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
                },
                "code_of_conduct": {
                    "value": "Yes"
                },
                "first_time_reviewer": {
                    "value": "Yes",
                    "readers": [
                        "ICLR.cc/2024/Conference/Program_Chairs",
                        "ICLR.cc/2024/Conference/Submission239/Senior_Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission239/Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission239/Reviewer_NM9Z"
                    ]
                }
            },
            "number": 3,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission239/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698823198531,
            "cdate": 1698823198531,
            "tmdate": 1699635949280,
            "mdate": 1699635949280,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "asoIlWoeB0",
                "forum": "1JPfHljXL4",
                "replyto": "SgVuOznWR6",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission239/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission239/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Response"
                    },
                    "comment": {
                        "value": "Thank you for the appreciative comments, we are grateful that you find our work easy to follow, given the complexity of the subject matter!\n\n# Contribution\nOur contribution has both a theoretical and practical aspect. \n\n### Theory\nIn terms of the theory, as you state, the convergence rate of 1/sqrt(T) for the convex Lipschitz complexity class is well known and achieved by SGD with a linear decay schedule. This rate is worst-case optimal, as simple problems can be constructed where no method can do better. \n\nOur contribution is a learning rate schedule that is *adaptive*, in that it takes advantage of problem structure when it is available, while still working as well as a non-adaptive schedule on worst case problems. In this case, the linear-decay schedule is optimal for the worst-case, where the gradient norms are all of approximately equal magnitude. In the common case where gradient norms increase or decrease over time, our method can be significantly faster! Comparing upper bounds, we find that our upper bound is tighter than the linear decay bound by a range from 9 to 1.5 times for the deep learning problems considered, a very significant practical difference.\n\nOur upper bound is always at least as tight as that for the linear decay schedule, but as you state, we do not prove that refinement is actually superior, just that it has a tighter upper bound in some situations. We think this is still a very significant contribution, as no scheduling method was known prior to our work that could achieve a better upper bound!\n\n### Practice\nOur practical contributions are also very significant by themselves. We provide the largest ever comparison of learning rate scheduling methods to appear in the literature. This is a useful reference for practitioners looking to choose a learning rate schedule to use, as our comparison covers a very large and diverse set of problems.\n\nIn terms of our refinement method, we are able to show clear improvement on the majority of problems over the current state-of-the-art schedule in use, a major achievement. There are no existing efficient adaptive methods for learning rate scheduling that have shown any improvement over common default schedules.\n\n### Linear decay schedule\nOur statement that the linear decay schedule is the best non-adaptive schedule was intended to be an empirical observation based on our experiments. We are sorry for the confusion there, we will clarify this in the camera ready. \n\n# Overall comments\nWe hope that our discussion of the weaknesses that you point out will go some way in swaying you regarding the significance of our work. We believe our method provides a very valuable contribution to the literature even given the limitations you mention."
                    }
                },
                "number": 3,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission239/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1699905428342,
                "cdate": 1699905428342,
                "tmdate": 1699905428342,
                "mdate": 1699905428342,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "BiF3q8ksjh",
            "forum": "1JPfHljXL4",
            "replyto": "1JPfHljXL4",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission239/Reviewer_BqWo"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission239/Reviewer_BqWo"
            ],
            "content": {
                "summary": {
                    "value": "This paper delivers an advanced examination of learning rate schedules in the context of stochastic gradient descent. The authors depart from conventional techniques and introduce a novel approach to derive a problem-adaptive learning rate schedule. Furthermore, the paper conducts an extensive evaluation of learning rate schedules, establishing that their schedule refinement technique yields further enhancements."
                },
                "soundness": {
                    "value": "4 excellent"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "3 good"
                },
                "strengths": {
                    "value": "1. The authors offer a comprehensive theoretical analysis of the problem-adaptive learning rate schedule, providing detailed insights into its workings.\n\n2. The authors conduct an extensive evaluation of learning rate schedules, directly comparing classical and modern schedules. Their findings reveal a clear hierarchy among these schedules, offering valuable insights into their relative effectiveness."
                },
                "weaknesses": {
                    "value": "1. One limitation of this paper is the absence of theoretical analysis in non-convex settings, which is particularly relevant in deep learning problems.\n\n2. From a theoretical perspective, it is not evident how the proposed method outperforms other classical learning rate schedules. Clarifying the advantages of this approach in comparison to traditional methods is essential for a comprehensive understanding of its efficacy."
                },
                "questions": {
                    "value": "1.Regarding the deep learning experiments:\n1.1. It's not explicitly mentioned whether GPT, RoBERTa, and ViT train from scratch. Additional details on the training process would be beneficial.\n1.2. Table 4 indicates that after an extended training period (epochs=30), the cosine learning rate schedule yields superior results compared to the linear decay schedule. It's a valid inquiry to explore whether, with even longer training, the same pattern might emerge for GPT and RoBERTa training\u2014i.e., whether cosine decay becomes more advantageous.\n1.3. It would be valuable to clarify whether the learning rate scheduling method labeled 'Cosine' refers to the classic cosine decay or cosineannealing learning rate schedule.\n\n2.Adagrad is known to perform well under convex settings and has strong theoretical support in such scenarios. . However, it is crucial to investigate whether this paper demonstrates that the proposed method surpasses Adagrad, both theoretically and empirically. Further elaboration, as well as empirical comparisons, would be required to draw a definitive conclusion in this regard.\n\n3.Can Theorem 8 be applied to the LAMB optimizer?"
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "5: marginally below the acceptance threshold"
                },
                "confidence": {
                    "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 4,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission239/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698829834498,
            "cdate": 1698829834498,
            "tmdate": 1699635949211,
            "mdate": 1699635949211,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "mjYRVWrJsA",
                "forum": "1JPfHljXL4",
                "replyto": "BiF3q8ksjh",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission239/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission239/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Response"
                    },
                    "comment": {
                        "value": "Thank you for the constructive feedback. You raise some excellent points which we would like to address one-by-one:\n\n* For the GPT, RoBERTa and ViT problems, our training runs are not fine-tuning (i.e., they are trained from scratch). Sorry for omitting this, we will include this information in the camera ready. Our experiments are significantly larger scale than any prior work on scheduling. We have endeavored to provide experiments truly comprehensive enough to draw concrete conclusions.\n* Good Point! Any training run that significantly overfits the data would potentially see the same problem as observed for CIFAR, so we would expect that this could occur with GPT and RoBERTa training if they were trained for a much longer time. It's much harder for the gradient norm to completely collapse on those problems but it could occur, particularly if training on small datasets. We will add a note on this to the paper. Thank you for pointing this out! \nWe think that this issue can be mitigated by using the gradient norms on held out data rather than the training data, however that obviously complicates the implementation of the method. We are currently investigating this direction.\n* We debated including AdaGrad comparison in this paper. For the majority of problems considered, AdaGrad does significantly worse than Adam in practice, so it's hard to do a fair comparison, as Adam+Refinement is much better than AdaGrad by itself. AdaGrad can be combined with refinement, and could potentially be another interesting baseline. We can include a comparison in the Appendix if you think it would be useful, please let us know!\n* Yes, our approach can be combined with the LAMB optimizer, it just requires deriving the formula for the weighted norm to measure gradients in. A layer-wise weighted L1 norm will likely be a good approximation for practical use.\n\n## Weakness\n1) For the stochastic non-convex setting, there is existing theory (https://arxiv.org/pdf/1910.01845.pdf) that shows that any last-iterate rate is actually impossible (Sec. 3.1). It's an interesting research question to determine what additional assumptions are needed in the non-convex setting to \u201cbridge-the-gap\u201d, as seemingly the convex case is much more representative of the scheduling behavior in practice for deep learning problems, and as yet nobody understands why. We are hoping to make progress on this but it's a difficult problem.\n2) We believe our theoretical rate for the refinement method provides a strong indication of when our method is expected to outperform the linear decay baseline. In any situation when the gradient norm sequence is not flat, our bound is tighter than the linear decay method's bound, by a factor that we can concretely compute after observing the gradient norm sequence. Our bound is always at least as good as the linear decay bound.\n\nWe ran these numbers, and it ranges from a factor of 9 to a factor of 1.5 for the deep learning problems considered. This doesn't guarantee an improvement as we are just comparing two upper bounds, but we believe it's indicative of when our method has an advantage. \nThis guarantee can be made more concrete by considering classes of problems where the gradient norms change over time in a structured way, such as strongly-convex problems, or problems satisfying relative smoothness conditions. We intend to pursue this direction in follow-up work.\n## Overall\nWe appreciate the very positive view you take of our paper. We hope that we have addressed your questions above. We believe our paper has the potential to be very impactful, as we have a method that was derived from a strong theoretical foundation, and also works extremely well in practice, out-performing strong baselines in the majority of problems. We believe this is the first practical method developed for learning rate scheduling for deep learning problems. We hope that you will consider raising your score to an 8 in light of our comments. Thank you!"
                    }
                },
                "number": 2,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission239/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1699905231596,
                "cdate": 1699905231596,
                "tmdate": 1699908637101,
                "mdate": 1699908637101,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "ZvogDK8T91",
            "forum": "1JPfHljXL4",
            "replyto": "1JPfHljXL4",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission239/Reviewer_eGse"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission239/Reviewer_eGse"
            ],
            "content": {
                "summary": {
                    "value": "This paper presents a refined study of learning rate scheduling for last iterate convergence of stochastic gradient methods. This automatically yields warmup and annealing schedules, and predicts a linear decay when gradient information is unavailable. The paper also presents an extension to co-ordinate wise methods and supplements this with empirical studies on many deep learning benchmarks including LLMs. Interestingly, this paper presents a learning rate scheduling scheme for any no-regret learning method into one that offers a last iterate convergence guarantee."
                },
                "soundness": {
                    "value": "4 excellent"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "4 excellent"
                },
                "strengths": {
                    "value": "- A very refined characterization of learning rate scheduling that captures various nuances relating to warmup, annealing etc. It recovers several practically effective heuristics that have lacked theoretical support in prior works.\n- A reasonably thorough treatment of empirical benchmarking with many deep learning problems of interest."
                },
                "weaknesses": {
                    "value": "The paper's writing can be made clearer about notions of anytime optimality versus developing schemes that work assuming a known end time (as is done in this paper), and what are the challenges in developing an algorithm for the unknown end time case?"
                },
                "questions": {
                    "value": "- What sequence of learning rates obtain optimal rates in terms of gradient norm? Can this potentially address the limitation mentioned at the end of this paper?\n- Can the authors comment on whether one can utilize the doubling trick (Hazan and Kale 2014) to make progress on the unknown end time case?\n- Another popular heuristic in practice (and in theory) is that of batch size doubling. Can the authors comment on how (or whether) these results can be connected with how to set batch sizes in practice?"
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "8: accept, good paper"
                },
                "confidence": {
                    "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 5,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission239/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1699333182393,
            "cdate": 1699333182393,
            "tmdate": 1699635949138,
            "mdate": 1699635949138,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "EkdEQAFWEW",
                "forum": "1JPfHljXL4",
                "replyto": "ZvogDK8T91",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission239/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission239/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Response"
                    },
                    "comment": {
                        "value": "Thanks for the valuable feedback! To answer your points:\n* Any-time convergence is, we believe, the next big unsolved problem in learning rate scheduling. There are no existing approaches that perform well in practice. We are actively researching techniques that bridge this performance gap. We will add more discussion of this to the paper following your suggestion.\n* If the learning rate was set using the gradient norms computed on held-out data, rather than the training data, this will avoid the issues we see on problems that contain overfitting. We are actively researching this and other solutions.\n* This is a good idea! The use of restarting with doubling could be used to give any-time rates. There is usually some performance overhead to doubling methods in practice, but it's definitely worth trying out. Thank you for the suggestion.\n* This is an interesting question. It would be worth looking at how the gradient norm graphs change as the batch size is increased. Without some experimental guidance on what occurs, it's hard to guess what the behavior would be. If we make a theoretical assumption such as the additive or multiplicative noise assumptions, then we could analyze the behavior very concretely.\n\nPlease let us know if you have any other questions."
                    }
                },
                "number": 1,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission239/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1699904859123,
                "cdate": 1699904859123,
                "tmdate": 1699904859123,
                "mdate": 1699904859123,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    }
]