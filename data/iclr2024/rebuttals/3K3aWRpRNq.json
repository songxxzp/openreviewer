[
    {
        "title": "Reducing Atomic Clashes in Geometric Diffusion Models for 3D Structure-Based Drug Design"
    },
    {
        "review": {
            "id": "UB2uTyVZIT",
            "forum": "3K3aWRpRNq",
            "replyto": "3K3aWRpRNq",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission3193/Reviewer_2tn2"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission3193/Reviewer_2tn2"
            ],
            "content": {
                "summary": {
                    "value": "The authors noticed the problem of spatial clash between the generated molecule and protein in existing generative methods. They proposed to formulate it as a constrained optimization problem and solve it by modifying the sampling process employing a proximal operator based on a diffusion model. They also provided a theoretical justification of their method. They compared their method with state-of-the-art generative methods, and their experiments show that the clash ratio is effectively reduced by employing this technique."
                },
                "soundness": {
                    "value": "2 fair"
                },
                "presentation": {
                    "value": "2 fair"
                },
                "contribution": {
                    "value": "2 fair"
                },
                "strengths": {
                    "value": "The clash ratio is effective reduced with the proposed technique."
                },
                "weaknesses": {
                    "value": "1. Novelty: The authors are not the first to discuss the problem of spatial clash. The novelty is limited.\n2. Biological Motivation: What is the motivation behind constraining the minimal distance between the protein and the generated molecules to be more than 2\u00c5 - a constant? Is it assuming that this distance is not conditioned on the properties of the protein and the generated molecules?\n3. Biological Motivation Again: Why 2\u00c5 is an appropriate threshold? Is there any underlying biological insight? It is true that this threshold fits well on the Crossdocked2020 dataset, does it still hold for other datasets?\n4. Performance: The performance gain on most benchmarks seems to be marginal, e.g. validity, novelty, uniqueness, diversity, SA, QED, Lipinski, and bond distributions.\n5. Clarity: The authors mentioned Van der Waals force and Hydrogen Bonding in their abstract. Can their model better capture these interactions?"
                },
                "questions": {
                    "value": "N/A"
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "3: reject, not good enough"
                },
                "confidence": {
                    "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                },
                "first_time_reviewer": {
                    "value": "Yes",
                    "readers": [
                        "ICLR.cc/2024/Conference/Program_Chairs",
                        "ICLR.cc/2024/Conference/Submission3193/Senior_Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission3193/Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission3193/Reviewer_2tn2"
                    ]
                }
            },
            "number": 1,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission3193/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698156379468,
            "cdate": 1698156379468,
            "tmdate": 1699636267214,
            "mdate": 1699636267214,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "7BlSTEGKb8",
                "forum": "3K3aWRpRNq",
                "replyto": "UB2uTyVZIT",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission3193/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission3193/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Rebuttal"
                    },
                    "comment": {
                        "value": "Thank you for taking the time to read and review our paper! Please see our responses below. We have started working on the corresponding changes. I hope that our response has sufficiently addressed your inquiry. All our modifications have been distinctly marked in blue font within the main body of the text. \n\n**W1**: Novelty: Both PoseCheck and Decomp have recognized clash issues. However, the former does not offer a solution, while the latter's approach has certain drawbacks, which we have highlighted in the theoretical issues section of our paper's appendix B.4. We also implemented their methods in TargetDiff for comparison. The experimental outcomes demonstrate that our method attains greater stability while reducing clash to a similar degree as theirs, suggesting that our approach is more effective in addressing clash problems.\n\n**W2, W3**: 2\u00c5 Motivation: The threshold we set at 2\u00c5 is not arbitrary. Firstly, from a chemical standpoint, when two atoms are sufficiently close, a bond forms between them. Secondly, the statistical pair distribution analysis reveals that there are virtually no pair distances smaller than 2\u00c5 in the crossdocked training dataset. Thirdly, the statistical results of the real dataset PDBbind (as shown in Appendix C.1) indicate that most pairing distances are indeed more than 2\u00c5. Lastly, PoseCheck also tackles the steric clash issue, defining pairwise distances between molecular atoms and protein atoms in a manner similar to our definition. Their definition slightly deviates from ours, as they set a threshold of 0.5\u00c5 based on bond lengths. In summary, considering the factors mentioned above, we establish the threshold at 2\u00c5.\n\n**W4**: Performance: Our main objective is to minimize clash while maintaining the performance of other metrics unaffected by this reduction. We have carried out a series of benchmark experiments, encompassing validity, novelty, uniqueness, diversity, SA, QED, and Lipinski. The experimental outcomes suggest that our approach does not diminish the model's original generative abilities and efficiently reduces unreasonable sampling.\n\n**W5**: Clarity: We have highlighted the significance of Van der Waals forces and Hydrogen Bonding because we believe that the pairwise distance between atoms is crucial for these two types of forces. These forces can effectively manifest only when the atoms are at an appropriate distance from each other."
                    }
                },
                "number": 1,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission3193/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700654484980,
                "cdate": 1700654484980,
                "tmdate": 1700654484980,
                "mdate": 1700654484980,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "wC8A9B78wk",
                "forum": "3K3aWRpRNq",
                "replyto": "7BlSTEGKb8",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission3193/Reviewer_2tn2"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission3193/Reviewer_2tn2"
                ],
                "content": {
                    "title": {
                        "value": "Thank the authors for the rebuttal"
                    },
                    "comment": {
                        "value": "W2, W3: I see the intuition of the authors' work, and I see the soundness in a statistical sense, but I still don't think the method is sound in a biological sense.\n\nW5: Can authors justify this claim? (e.g. in experiments)\n\nFor the reasons above, I keep my score."
                    }
                },
                "number": 7,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission3193/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700712520452,
                "cdate": 1700712520452,
                "tmdate": 1700712520452,
                "mdate": 1700712520452,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "cjGKHQ9kRS",
            "forum": "3K3aWRpRNq",
            "replyto": "3K3aWRpRNq",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission3193/Reviewer_7c1E"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission3193/Reviewer_7c1E"
            ],
            "content": {
                "summary": {
                    "value": "There are some intermolecular atomic clashes between the generated ligand molecule and protein pockets. To tackle this issue, the authors of the paper propose a new sampling process specifically designed to prevent such unwanted collisions. This is accomplished by integrating a non-convex constraint within the current Langevin Dynamics (LD) of GDM, aided by the use of proximal regularization techniques. This new process forces molecular coordinates to adhere to set physical constraints. Crucially, the proposed method doesn't require any changes to be made to the training process of GDMs. Empirical evaluations have shown that this method significantly reduces atomic clashes compared to the original LD process of GDMs."
                },
                "soundness": {
                    "value": "2 fair"
                },
                "presentation": {
                    "value": "2 fair"
                },
                "contribution": {
                    "value": "1 poor"
                },
                "strengths": {
                    "value": "1. The problem formulation and presentation are clear. \n2. The method is rationale and theoretical analysis is provided.\n3. The proposed method improves the connectivity, mean CR, and stability of generated ligand molecules."
                },
                "weaknesses": {
                    "value": "1. This method is not novel to some extent, which is some kind of similar to the validity guidance proposed in DecompDiff.  \n2. The experimental results on molecular properties of generated ligands are not satisfying. The improvement on Vina score is only marginal. It is notable that vina score is one of the most metrics for structure-based drug design and strongly related to intermolecular spatial interaction between pockets and generated ligands."
                },
                "questions": {
                    "value": "Can the author provide more comparison between the validity guidance proposed in DecompDiff and proximal sampling proposed in this paper? Can the vina score be further improved?"
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "3: reject, not good enough"
                },
                "confidence": {
                    "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 2,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission3193/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698568334957,
            "cdate": 1698568334957,
            "tmdate": 1699636267122,
            "mdate": 1699636267122,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "tiKk5hDbCv",
                "forum": "3K3aWRpRNq",
                "replyto": "cjGKHQ9kRS",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission3193/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission3193/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Rebuttal"
                    },
                    "comment": {
                        "value": "Thank you for taking the time to read and review our paper! Please see our responses below. We have started working on the corresponding changes. I hope that our response has sufficiently addressed your inquiry. All our modifications have been distinctly marked in blue font within the main body of the text. \n\n**W1, Q1**: Compare:  In response to the reviewer's suggestion, we have integrated the gradient guidance method (Decompdiff) into the targetdiff model and assessed its performance. As illustrated in Table 1, this approach also effectively reduces the clash ratio. Furthermore, our method exhibits greater stability compared to Decompdiff, as indicated by the nearly equal average clash ratios. We provide additional details on the theoretical limitations of Decompdiff in Appendix B.4. Our strategy employs the proximal Langevin algorithm (PLA) for conducting inference on diffusion models. Since the sampling procedure for these models involves the application of an inexact Langevin algorithm (ILA), we first present a convergence analysis for the proximal inexact Langevin algorithm (PILA) within the context of sampling. In contrast, the Decompdiff method lacks such theoretical guarantee.\n| Method | Validity | Diversity | Novelty | Uniqueness | Connectivity | Mean CR | Stability |\n|:----------:|:---------:|:------------:|:----------:|:----------------:|:----------------:|:-------------:|:----------:|\n| Raw      |  98.31%\t| 0.7107 |\t100%   |\t98.77%       |\t85.38%     |    12.31% |\t74.86%|\n| Gradient(Decomp) |94.31%\t| 0.6504 |\t100% | 99.39% | 74.46%\t | 1.86%  | 73.08% |\n|Proximal(ours)\t|98.15%\t| 0.7093 |\t100% |99.77%\t | 76.62%\t | 1.92%  | 75.15% |\n\n**W2**: Vina score: We posit that the Vina score has a strong correlation with the data distribution learned by the model. On one hand, our primary objective is to minimize clash, and our experimental outcomes convincingly show that our approach accomplishes this by decreasing the average clash ratio while maintaining the distribution of most generated molecules. On the other hand, we consider the observed marginal improvement in the Vina score to be in line with expectations, as it aligns with the degree of clash ratio reduction."
                    }
                },
                "number": 2,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission3193/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700654487435,
                "cdate": 1700654487435,
                "tmdate": 1700654487435,
                "mdate": 1700654487435,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "soeIFoMSjK",
            "forum": "3K3aWRpRNq",
            "replyto": "3K3aWRpRNq",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission3193/Reviewer_F9wF"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission3193/Reviewer_F9wF"
            ],
            "content": {
                "summary": {
                    "value": "The authors introduce a technique that is applied during inference to minimize the of atomic steric clashes when generating molecules within a 3D protein pocket. The proposed method doesn't require retraining the diffusion model as it only involves changing the sampling process during inference. The authors benchmark their method against existing techniques like DiffSBDD and PMDM, demonstrating that their approach yields fewer atomic clashes without compromising other properties such as binding affinity, synthetic accessibility etc. Overall, this work effectively tackles the issue of steric atomic clashes in generative diffusion models within the context of SBDD."
                },
                "soundness": {
                    "value": "2 fair"
                },
                "presentation": {
                    "value": "2 fair"
                },
                "contribution": {
                    "value": "2 fair"
                },
                "strengths": {
                    "value": "1. The authors clearly identifies steric atomic clashes (ligand atoms too close to protein atoms) as a major shortcoming of current geometric diffusion models for structure based drug design. The authors provide strong evidence that this violates physical principles such as Van der Waals force and Hydrogen Bonding.\n\n2. The authors introduces a new proximal constrained sampling technique to reduce atomic clashes, the usage of proximal regularization handles the non-convex distance constraints elegantly. This approach is novel in the context of structure based diffusion models for drug design.\n\n3. The proposed method only modifies the sampling process (at inference time), requiring no changes to model training. This makes the approach easy to implement on top of existing pre-trained diffusion models. The experimental results demonstrate effectiveness using TargetDiff without modification to its training."
                },
                "weaknesses": {
                    "value": "1. The method is only evaluated on one dataset (CrossDock2020) with a single model (TargetDiff). Unclear if the benefits generalize to other datasets (PDBBind) and diffusion models (DiffSBDD).\n\n2. Proximal constrained sampling adds extra computational costs during inference. Could be prohibitively expensive for large datasets or real-time usage and there is no extensive discussion of added computational cost in the paper."
                },
                "questions": {
                    "value": "1. The authors note the proximal constrained sampling adds computational overhead. Were there any optimizations considered to improve efficiency and make the approach scale well to larger datasets? What is the impact on runtime?\n\n2.The authors briefly discuss binding affinity (Vina scores) in their results. However,  this results section is not extensive. A more thorough evaluation could include a case study where molecules generated by the proposed method are compared against an experimental xtal structure. Assessing the 3D overlap between the generated molecules and the ligand bound xtal structure would provide valuable insights.\n\n3. Could the proposed sampling technique be extended to other diffusion-based docking algorithms, such as DiffDock?\n\n### Typos:\n\nThere are several typos in the paper. For example, \"tTargetDiff\", \"2Abetween\" in the Introduction."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "6: marginally above the acceptance threshold"
                },
                "confidence": {
                    "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
                },
                "code_of_conduct": {
                    "value": "Yes"
                },
                "first_time_reviewer": {
                    "value": "Yes",
                    "readers": [
                        "ICLR.cc/2024/Conference/Program_Chairs",
                        "ICLR.cc/2024/Conference/Submission3193/Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission3193/Reviewer_F9wF",
                        "ICLR.cc/2024/Conference/Submission3193/Senior_Area_Chairs"
                    ]
                }
            },
            "number": 3,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission3193/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698598997810,
            "cdate": 1698598997810,
            "tmdate": 1700687096690,
            "mdate": 1700687096690,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "Nb7JKlX0Iw",
                "forum": "3K3aWRpRNq",
                "replyto": "soeIFoMSjK",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission3193/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission3193/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Rebuttal"
                    },
                    "comment": {
                        "value": "Thank you for taking the time to read and review our paper! Please see our responses below. We have started working on the corresponding changes. I hope that our response has sufficiently addressed your inquiry. All our modifications have been distinctly marked in blue font within the main body of the text. \n\n**W1**: Other dataset: We use TargetDiff as our base model without retraining it. Since TargetDiff is trained exclusively on CrossDock, we only tested on CrossDock to ensure a fair comparison. On the other hand, we tested our framework on DiffSBDD, another diffusion-based molecular generative model. See the table below for the results of DiffSBDD.\n| Time | Influence | Validity | Diversity | Novelty | Uniqueness | Mean CR |\n|:------:|:------------:|:----------:|:-----------:|:----------:|:----------------:|:-------------:|\n|         | normal     |\t100% |  0.8246   | 100%\t  |  97.44%\t| 17.17%    |\n| 300   | K=1, b=10 |\t99.78%  |\t0.8277 | 100%\t | 96.82%\t| 9.64% |\n| 200   | K=1, b=10 |100%     |\t0.8284 |100%\t | 96.88%\t | 9.95% |\n| 150   | K=1, b=10 |100%     |\t0.8263 |100%\t |  96.76% |10.37% |\n\n**W2, Q1**: Computational cost: In the process of proximal sampling, the optimization of the solution is carried out using the LBFGS solver. This solver exhibits a second-order convergence rate, signifying that the time required for the solution process is minimal (as shown in the table below). Moreover, as the atomic position sampled at time t is already in proximity to the optimal solution we aim to obtain, both the number of iterations and the time spent on them are considerably reduced.\n| Targetdiff | Raw | 500-0 | 300-0 | 150-0 | \n|:------------:|:------:|:--------:|:-------:|:--------:|\n|Time(s)   |17.30 | 22.28 | 18.03 | 18.40 | \n\n**Q2**: Larger dataset: We are not entirely certain about the reviewer's inquiry concerning the 'larger dataset'. In real-world applications, sampling is usually performed on a single protein. As displayed in the table associated with question W2 above\uff0c we have evaluated the average time needed to sample an individual molecule. The time consumption associated with this process indicates that our approch can be employed for large-scale sampling.\n\n**Q3**: Case study: In Appendix C.3, we have provided a visual analysis of the results between the clash and non-clash scenarios, demonstrating the effectiveness of our approach.\n\n**Q4**: Diffdock\uff1aIn the docking procedure using DIFFDOCK, the inputs consist of the molecule's random conformations and the protein structure. The molecule undergoes overall rotations and translations, followed by dihedral angle adjustments to achieve a proper fit between the molecular structure and the protein pocket. Conversely, our approach on clash caculation directly works with the molecule's 3D coordinates. As a result, applying our method to DIFFDOCK is not trivial."
                    }
                },
                "number": 3,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission3193/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700654495956,
                "cdate": 1700654495956,
                "tmdate": 1700654495956,
                "mdate": 1700654495956,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "gfTpYwsfBw",
                "forum": "3K3aWRpRNq",
                "replyto": "Nb7JKlX0Iw",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission3193/Reviewer_F9wF"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission3193/Reviewer_F9wF"
                ],
                "content": {
                    "comment": {
                        "value": "Thanks for addressing the questions and running experiments with DiffSBDD. I really appreciate it. I'm raising my score to 6."
                    }
                },
                "number": 5,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission3193/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700687082252,
                "cdate": 1700687082252,
                "tmdate": 1700687082252,
                "mdate": 1700687082252,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "28VJ154cPZ",
            "forum": "3K3aWRpRNq",
            "replyto": "3K3aWRpRNq",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission3193/Reviewer_xcbL"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission3193/Reviewer_xcbL"
            ],
            "content": {
                "summary": {
                    "value": "In this paper, the authors propose to augment one pocket-conditioned ligand generation (ie TargetDiff) by introducing extra constraints to the Langevin MCMC steps. In particular, the proposed constraint aims at reducing the number of steric clashes of generated molecules. The proposed constraint is not used during training and can be applied on sampling on the fly. The approach is compared to some baselines on the task CrossDocket2020 dataset."
                },
                "soundness": {
                    "value": "2 fair"
                },
                "presentation": {
                    "value": "1 poor"
                },
                "contribution": {
                    "value": "2 fair"
                },
                "strengths": {
                    "value": "- The main idea of the paper\u2014reduce the number of clashes on molecules generated by diffusion-based models\u2014is intuitive and well-grounded. Diffusion-based generative models are known to oversee clashes when generating models.\n- The proposed approach is only applied during sampling stage, making it applicable to different models based on the score function.\n- The results on the reported metrics are good, but I am not convinced those are the right metrics (see below)."
                },
                "weaknesses": {
                    "value": "- The paper is not well written and hard to follow. There are many terms that are mentioned without any definition and some notations are wrong.\n- The paper also lacks many details of the implementation and make reproduction difficult.\n- The authors uses a cut-off of 2A to consider clash vs non-clash. This seems a very ad-hoc choice. Why did the authors use this number? PoseCheck (Harris et al23) consider a threshold of .5A, which sounds more reasonable.\n- There is not much detail in how clash is computed. Since the main contribution of the paper is to reduce the number of clashes, it could be nice to have more details about this metric, how the numbers would change if you change the definition of clash used, etc.\n- The choice of evaluation metrics made by the authors are not the best. I am really confused why on Table 1, they show Hoogeboom et al 22 metrics (a model that deals with unconditional generation). These metrics are far from the best. You can think of at least using the metrics proposed by MiDi (Vegnac et al23). But since this is pocket-conditional generation task, we are also interested in how to do the generated ligand bind to the pocket and how stable it is (eg metrics related to docking score, strain energies, protein-ligand interactions, etc). See for example the metrics in TargetDiff and in PoseCheck)."
                },
                "questions": {
                    "value": "- See above for questions\n- It would be nice to see this model applied in other diffusion-based generative model (eg SBDDDiff), since it should be agnostic to the type of diffusion model used. Did the authors try any of these experiments?"
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "3: reject, not good enough"
                },
                "confidence": {
                    "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 4,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission3193/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698767181011,
            "cdate": 1698767181011,
            "tmdate": 1699636266942,
            "mdate": 1699636266942,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "2JFVB3bHL6",
                "forum": "3K3aWRpRNq",
                "replyto": "28VJ154cPZ",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission3193/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission3193/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Rebuttal 1"
                    },
                    "comment": {
                        "value": "Thank you for taking the time to read and review our paper! Please see our responses below. We have started working on the corresponding changes. I hope that our response has sufficiently addressed your inquiry. All our modifications have been distinctly marked in blue font within the main body of the text. \n**W1**: We sincerely appreciate the reviewer's comments and have made the necessary improvements to the revised manuscript accordingly. \n\n**W2**: Lack details: Thanks to the reviewer for the suggestions. In response to these valuable comments, we have taken the initiative to provide a more detailed description in our manuscript regarding the computational process. Notably, we have employed the LBFGS as the solver for the proximal objective function. Furthermore, for the convenience of readers and to provide a more comprehensive understanding, we have included the pseudocode in the appendix.  \n\n**W3**: Cut-off 2\u00c5: The reviewer might have some misunderstanding of PoseCheck (Harris et al23). Recalling the PoseCheck, They define a clash as occurring when the pairwise distance between a protein and ligand atom falls below the sum of their van der Waals radii, with a clash tolerance of 0.5\u00c5. For instance, Taking into account that the C-C bond distance is 1.5\u00c5, adding the 0.5\u00c5 threshold results in 2.0\u00c5. Given that common chemical bonds are typically smaller than 2.0\u00c5, we believe our 2\u00c5 cut-off is a reasoning choice, rather than an arbitrary one.\n\n**W4**: Calculate clash: We apologize if our earlier explanation concerning the calculation of clashes was unclear. Let us offer a more comprehensive clarification. We have established a threshold of 2.0 \u00c5. As a result, if the pairwise distance between any protein atoms and molecule atoms falls below this threshold, we regard the molecule as having a clash. The simplified calculation formula is as follows: $d=min(norm(x_l -x_p))$, where $x_l$ and $x_p$ represent the positions of arbitrary atoms within the molecule and protein, respectively. A clash is detected when at least one pair of atomic distances between the molecule's and protein's atoms is less than the 2\u00c5 threshold. For each protein target, we generate 100 molecules and subsequently determine the clash rate by counting the frequency of clashes. In our revised manuscript, we have clarified the clash computation process in the evaluation section.\n\n**W5**: Evaluation metric: We are grateful for your insights. For both unconditional (de novo design) and conditional (Structure-Based Drug Design, SBDD) generation tasks, it is essential to ensure that the generated molecules possess optimal validity and connectivity. These metrics are crucial because they influence the applicability of the generated molecules in downstream tasks. Upon reviewing MiDi, we noticed that, besides atom stability, all other evaluation metrics have been employed in our experiments. Additionally, atom stability can be encompassed within connectivity. We have also adhered to the vina score metric mentioned in the Targetdiff model. In response to the reviewer's query about the docking score, docking score is a broad concept, and different algorithms will give out different docking scores. Here, we respectfully propose that, in our paper, we use Qvina2 (Alhossary et al., 2015) to measure the docking score and represent it as vina score. Since the protein-ligand interaction is a state determined by docking score and strain energy, it is regrettable that PoseCheck does not provide information on calculating strain energy. As a result, we cannot adopt their approach in this aspect.\n\n**Q1**: Other model\uff1aWe utilize our method in the DiffSBDD model, and the outcomes (as shown in the table below) regarding the mean clash rate indicate the effectiveness of our approach in reducing the clash ratio across various models.\n| Time | Influence | Validity | Diversity | Novelty | Uniqueness | Mean CR |\n|:------:|:------------:|:----------:|:-----------:|:----------:|:----------------:|:-------------:|\n|         | normal     |\t100% |  0.8246   | 100%\t  |  97.44%\t| 17.17%    |\n| 300   | K=1, b=10 |\t99.78%  |\t0.8277 | 100%\t | 96.82%\t| 9.64% |\n| 200   | K=1, b=10 |100%     |\t0.8284 |100%\t | 96.88%\t | 9.95% |\n| 150   | K=1, b=10 |100%     |\t0.8263 |100%\t |  96.76% |10.37% |"
                    }
                },
                "number": 4,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission3193/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700654504959,
                "cdate": 1700654504959,
                "tmdate": 1700654504959,
                "mdate": 1700654504959,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "drZvxAtd6d",
                "forum": "3K3aWRpRNq",
                "replyto": "28VJ154cPZ",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission3193/Reviewer_xcbL"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission3193/Reviewer_xcbL"
                ],
                "content": {
                    "comment": {
                        "value": "We thank the authors for their feedback. We appreciate the extra clarifications and we would recommend the authors to add them on a future revision of the manuscript. I still disagree with the choice of metrics used to benchmark methods. In particular, the metrics used by the authors are not similar to MiDi (many of the more interesting metrics related to the distances of distributions are missing). \nFor the reasons above, I keep my rating as is."
                    }
                },
                "number": 6,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission3193/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700688910325,
                "cdate": 1700688910325,
                "tmdate": 1700688910325,
                "mdate": 1700688910325,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    }
]