[
    {
        "title": "Effective Offline Environment Reconstruction when the Dataset is Collected from Diversified Behavior Policies"
    },
    {
        "review": {
            "id": "OUJOU80Egv",
            "forum": "Zh047FhXqI",
            "replyto": "Zh047FhXqI",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission7281/Reviewer_U3YJ"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission7281/Reviewer_U3YJ"
            ],
            "content": {
                "summary": {
                    "value": "This paper studies the offline policy evaluation (OPE) problem. The authors propose Policy-Conditioned Model (PCM) learning, which learns a dynamics model that depend on the policy to be evaluated. In contrast, traditional model learning learn a unified dynamics model from a dataset that is agnostic to policy. Theoretical analysis are provided to justify the effectiveness of PCM. Experiments are also conducted to show the advantage of the proposed method over prior works."
                },
                "soundness": {
                    "value": "2 fair"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "2 fair"
                },
                "strengths": {
                    "value": "1. This paper is well-written and easy to follow.\n2. The intuition is straightforward and the algorithm is neat.\n3. The theoretical part provide mathematical justification for the intuition of the algorithm."
                },
                "weaknesses": {
                    "value": "1. The Related Work does not seem comprehensive enough to me. It should include more recent works on OPE and MBORL. I did not find citation of OPE later than 2020. For MBORL, COMBO, ROMI and many more later works are missing. I suggest adding a more comprehensive Related Work.\n2. I am not fully convinced by the experiment. As mentioned in the paper, PCM adopt more advanced network architecture to enhance performance so that even the PAM achieves better performance. Does this mean that the advantage of PCM may not come from the algorithmic novelty but from the better network architecture instead?\n3. As an experiment paper, I do not think the experiments conducted are extensive enough, more tasks should be tested.\n\nMinor Mistakes:\nFigure 2 and 3 seem to have spacing issues. The legends are partially screened by the captions\nIn some formulae (e.g. 5 and 8), the parentheses should wrap the content inside."
                },
                "questions": {
                    "value": "1. Can the authors explain Figure 2(c) in more detail, how are the quantities calculated?\n2. Can the authors explain the experiment methodology in more detail, as mentioned in Weakness 2\n3. In Figure 3, what does the data for percentage 0% and 100% look like. Also, the differences of value gaps does not seem substantial to me, is it the case?\n4. How does PCM perform on other tasks besides mujoco? Specifically, D4RL has maze, antmaze, carla etc. besides mujoco."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "details_of_ethics_concerns": {
                    "value": "The authors touched on this subject in the last section of the Appendix"
                },
                "rating": {
                    "value": "3: reject, not good enough"
                },
                "confidence": {
                    "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 1,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission7281/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698740948454,
            "cdate": 1698740948454,
            "tmdate": 1699636869798,
            "mdate": 1699636869798,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "cNGwdpI23G",
                "forum": "Zh047FhXqI",
                "replyto": "OUJOU80Egv",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission7281/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission7281/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Official response"
                    },
                    "comment": {
                        "value": "Thanks for the insightful suggestions on our paper. We response the questions and concerns as follows:\n\n### **Q1: The Related Work does not seem comprehensive enough to me. It should include more recent works later than 2020.**\n\nThank you for the suggestion. We have included additional related work in the main text, covering topics such as COMBO, ROMI, and others later than 2020.\n\n### **Q2: As mentioned in the paper, PCM adopt more advanced network architecture to enhance performance so that even the PAM achieves better performance. Does this mean that the advantage of PCM may not come from the algorithmic novelty but from the better network architecture instead?**\n\nThank you for your critical observation. We understand the concern that the improvements might be attributed to advanced network architectures rather than the algorithmic novelty of PCM itself.\n\nTo address this concern, we emphasize that both PCM and PAM employ identical network architectures in all our experiments, as detailed in Appendix B.2 of our paper. Specifically, both models use a 4-layer feedforward MLP with 200 hidden units per layer. Each layer follows the structure LayerNorm(x + Dropout(Activation(Linear(x)))). The primary distinction between PCM and PAM lies in the addition of a policy encoder in PCM. This encoder generates a policy embedding, which is then used as an additional input for PCM. However, this is the only architectural difference, ensuring that any performance discrepancies are attributable to this specific module rather than overall architectural enhancements.\n\nOur results in Table 1 in the mainbody substantiate this point. They demonstrate that both the shared architecture and the unique policy-conditioned module of PCM are instrumental in reducing value gaps.  This indicates that the performance advantage of PCM is indeed a result of the algorithmic innovation introduced by the policy-conditioned module, rather than merely an outcome of an advanced network architecture. \n\nFurthermore, to bolster our comparison and validate the efficacy of PCM, we have also implemented PCM with a standard MLP architecture. The results of this implementation can be found in the general response. This implementation verify that the PCM mechanism consistently aids in reducing value gaps across different architectures. \n\n\n### **Q3: I do not think the experiments conducted are extensive enough, more tasks should be tested.**\n\nThanks for your valuable suggestion. We have supplemented five datasets for OPE task, including ant-medium-replay, ant-medium-expert, halfcheetah-medium-expert, hopper-medium-expert, and walker2d-medium-expert. Similarly, our method also outperforms other methods significantly on these tasks.  Please see Table 3 to Table 6 for raw results in our revised paper and full discussion in the general response.\n\n### **Q4: Can the authors explain Figure 2(c) in more detail, how are the quantities calculated?**\n\nIn our experiment, we constructed a set of 10 distinct policies. These policies were then used to generate datasets on which our PCM was trained, resulting in 10 unique vector policy embeddings corresponding to each policy. We evaluated the performance of each policy using models conditioned on each of the 10 embeddings. The value gap was calculated for each pairing, providing a matrix of outcomes.\n\nSpecifically, in Figure 2(c), each cell in row i, column j, quantifies the value gap when policy j is evaluated using the PCM adapted with embedding i. The heatmap's intensity indicates the magnitude of the value gap, with darker colors representing larger gaps. This visual representation allows us to observe how well the model, when conditioned with a specific policy embedding, can adapt and evaluate other policies. \n\n### **Q5: In Figure 3, what does the data for percentage 0% and 100% look like. Also, the differences of value gaps does not seem substantial to me, is it the case?**\n\nWe would like to directly compare the value gaps of PAM and PCM and also investigate the influence of different levels of dataset diversity on them. To do so, we construct datasets with varying levels of diversity (0\\%, 20\\%, 50\\%, 80\\%, 100\\%), where the percentage indicates that the dataset is created from the replay buffer of SAC until the policy reaches the specific level of performance.\n\n### **Q6: How does PCM perform on other tasks besides mujoco? Specifically, D4RL has maze, antmaze, carla etc. besides mujoco.**\n\nThe reason for not including maze, antmaze, carla, etc. is that these datasets are collected by a single policy, which is inconsistent with the diversified nature of datasets we discuss in our paper.  However, we agree that more tasks should be evaluated in our experiments, and as mentioned in response to Q3, we have included more tasks for evaluation.\n\n### **Q7: Figure 2 and 3 seem to have spacing issues.**\n\nThanks for pointing out this formatting issue. We have fixed them in our revised paper."
                    }
                },
                "number": 7,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission7281/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700507951701,
                "cdate": 1700507951701,
                "tmdate": 1700508581399,
                "mdate": 1700508581399,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "pVtrz3P2dB",
                "forum": "Zh047FhXqI",
                "replyto": "cNGwdpI23G",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission7281/Reviewer_U3YJ"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission7281/Reviewer_U3YJ"
                ],
                "content": {
                    "comment": {
                        "value": "Thank you for the explanations!\n\nI might have missed some parts of the revised paper but I did not find you including COMBO, ROMI, etc. Could you tell me where exactly are they? As far as I know, the list of popular MBORL can be long.\n\nI appreciate that the authors added more experiments. I understand that given the rebuttal time constraint, it is impossible to add many experiments. But still, I think as an empirical work, the evaluation should be more comprehensive. For example, how does the algorithm perform on the 'random' datasets? I do think there are some valuable points in this paper but comprehensive evaluation is also important. It is all right if the performances are not the best if the authors provide reasonable explanations.\n\nI choose to retain my score and I encourage the authors conduct further investigation on this method."
                    }
                },
                "number": 10,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission7281/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700567845290,
                "cdate": 1700567845290,
                "tmdate": 1700567845290,
                "mdate": 1700567845290,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "WvAOFxjJdD",
                "forum": "Zh047FhXqI",
                "replyto": "OUJOU80Egv",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission7281/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission7281/Authors"
                ],
                "content": {
                    "comment": {
                        "value": "Thank you for your prompt response and continued engagement with our work. We appreciate your valuable insights and would like to address the concerns raised.\n\n1. **Inclusion of COMBO, ROMI, etc. in Related Work**: We apologize for the oversight in our previous submission where the updated related work section was mistakenly omitted. We have rectified this error and submitted a new version of the manuscript. The updated related work now includes a comprehensive discussion on models such as COMBO, ROMI, and others, reflecting a broader spectrum of popular MBORL approaches.\n\n2. **Comprehensive Evaluation Concerns**: We acknowledge your concern regarding the comprehensiveness of our evaluation. We want to clarify that the 'random' dataset does not align with the assumptions of our approach, as it is generated from a single random policy rather than the multi-source policies our method is designed for. After adding the results in medium-expert datasets (thanks to the reviewer BstF's suggestion), we believe that our experiments **have covered all tasks in the D4RL dataset that involve multi-source policy collections**. We believe these additions make our experimental evaluation more robust and comprehensive.\n\nWe are committed to conducting further investigations to refine our method and extend its applicability. We hope that the revisions and clarifications provided address your concerns and demonstrate the rigor of our approach. Should you have any additional questions or require further clarification, we are readily available to engage in further discussions."
                    }
                },
                "number": 11,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission7281/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700575841067,
                "cdate": 1700575841067,
                "tmdate": 1700580829511,
                "mdate": 1700580829511,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "2YYepzCO1H",
            "forum": "Zh047FhXqI",
            "replyto": "Zh047FhXqI",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission7281/Reviewer_BstF"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission7281/Reviewer_BstF"
            ],
            "content": {
                "summary": {
                    "value": "The paper proposes a policy-conditioned dynamics model for off-policy evaluation. The proposed methods achieved good performance on the robotic tasks, with bounded model error under their assumptions."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "2 fair"
                },
                "strengths": {
                    "value": "S1.\tThe paper is well written, especially introduction and methodology are clearly described.\n\nS2.\t The proposed method achieves better results compared to baselines, on selected tasks in robotic tasks."
                },
                "weaknesses": {
                    "value": "W1.\tThe ideas of assuming mixed-type of data and leveraging evaluation policies to improve state-action visitation are not very interesting. Similar assumptions and problems were investigated by recent OPE work [1], which also conducted experiments on D4RL. The major claim, \u201cmodel learning from offline datasets collected by numerous behavior policies in fact implies a problem of data fitting from a mixture of multi-source data distributions, which is ignored in current model learning paradigms (in Introduction) looks overstrong, which should be carefully scoped, given there are already works investigating such scenarios (e.g., [1-2]). \n\nW2.\tExperiments may not be thoroughly designed. \n\n(i) Only using 3 tasks out of overall 20 tasks in D4RL environment and 3 out of 9 RLUnplugged environment, without a well reason. The main content doesn\u2019t accurately or explicitly describe such experimental settings, given they do not strictly follow the referred benchmark DOPE. In D4RL, Ant-related tasks are totally ignored. Though authors describe that they consider data collected by diverse policies, it may not be a strong reason for not using all types of tasks to evaluate the robustness and effectiveness of the proposed method. At least \u201cmedium-expert\u201d tasks, which are mixed-type datasets, should be included as well. \n\n(ii) For off-policy selection, some baselines (e.g., IS) are not included. I think they are still able to be compared, by using the policy with the maximum OPE values. For off-policy evaluation, it might be also helpful to evaluate if recent works with similar ideas can be considered, as mentioned in (1).\n\n\nW3.\tReproducibility is hard to evaluate. There is no code supplementary. Raw results of absolute error without normalization are not provided as in [1], raw results of each task are not provided. Those makes it hard to be further utilized by interested researchers and limit potential impacts.\n\n\nMinor:\n1.\tFigure 3: Part of labels on x axis is covered by captions.\n\nReferences\n[1] Gao, Q., Gao, G., Chi, M., & Pajic, M. (2022, September). Variational Latent Branching Model for Off-Policy Evaluation. In The Eleventh International Conference on Learning Representations.\n\n[2] Zhang, G., & Kashima, H. (2023, June). Behavior estimation from multi-source data for offline reinforcement learning. In Proceedings of the AAAI Conference on Artificial Intelligence (Vol. 37, No. 9, pp. 11201-11209)."
                },
                "questions": {
                    "value": "See Weaknesses"
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "5: marginally below the acceptance threshold"
                },
                "confidence": {
                    "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 2,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission7281/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698825030508,
            "cdate": 1698825030508,
            "tmdate": 1699636869663,
            "mdate": 1699636869663,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "Q78lJUla3F",
                "forum": "Zh047FhXqI",
                "replyto": "2YYepzCO1H",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission7281/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission7281/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Official response"
                    },
                    "comment": {
                        "value": "Thanks for the insightful suggestions on our paper. We response the questions and concerns as follows:\n\n### **Q1: The ideas of assuming mixed-type of data and leveraging evaluation policies to improve state-action visitation are not very interesting. Similar assumptions and problems were investigated by recent OPE work [1], which also conducted experiments on D4RL. The major claim, \u201cmodel learning from offline datasets collected by num... current model learning paradigms\" (in Introduction)  looks overstrong, which should be carefully scoped, given there are already works investigating such scenarios (e.g., [1-2]).**\n\nThank you for your insightful comments and the referenced articles. Upon careful consideration, we maintain the validity of our claim and provide the following clarifications:\n\nRegarding the work in [1], while it shares similarities with our approach in encoding historical data, the purposes differ significantly. [1] focuses on \u201clearning a compact and disentangled latent representation space from offline trajectories, which can better capture the dynamics underlying environments\u201d. In contrast, our work is centered on obtaining representations for policy representation. This divergence in objectives leads to distinct training methodologies: [1] employs a variational inference framework to construct an ELBO for a robust environmental representation space, whereas we use the representation as an extra input for model prediction, aiming solely at reconstructing the policy to encode its representation. As we clarified to ****reviewer Ag2q****, our contribution does not lie in the specific technical implementation of using RNNs to encode trajectory features. To our knowledge, this particular application of policy-conditioned methods to enhance policy learning in the context of diverse offline RL datasets is a novel contribution. It surpasses existing methods by focusing on aligning policies with the prediction emphasis of dynamic models, deviating from the primarily trajectory-encoding approach in prior research.\n\nRegarding [2], the discussion revolves around the diversity of dataset sources in a model-free offline policy learning setting. In this context, the issue of policy being multi-source is intuitively obvious, as the direct goal is to imitate and optimize the offline data's policy. However, in a model-based scenario, the hidden multi-source data distribution caused by multiple source policies and the potential to leverage this feature for enhanced model generalization are not as readily apparent.\n\nIn summary, our assertion that model learning from offline datasets collected by numerous behavior policies implies a problem of data fitting from a mixture of multi-source data distributions remains unaddressed in current literature. Therefore, our claim is not overstated but rather highlights a novel aspect that has not been formally proposed until now. \n\n\n### **Q2: In D4RL, Ant-related tasks are totally ignored. Though authors describe that they consider data collected by diverse policies, it may not be a strong reason for not using all types of tasks to evaluate the robustness and effectiveness of the proposed method. At least \u201cmedium-expert\u201d tasks, which are mixed-type datasets, should be included as well.**\n\nThanks for the valuable suggestion. We have supplemented five datasets for OPE task, including ant-medium-replay, ant-medium-expert, halfcheetah-medium-expert, hopper-medium-expert, and walker2d-medium-expert. Similarly, our method also outperforms other methods significantly on these tasks. Please see Table 3 to Table 6 for raw results in our revised paper and full discussion in the general response.\n\n### **Q3: For off-policy selection, some baselines (e.g., IS) are not included. I think they are still able to be compared, by using the policy with the maximum OPE values. For off-policy evaluation, it might be also helpful to evaluate if recent works with similar ideas can be considered, as mentioned in (1).**\n\nThanks for the valuable suggestion. In previous version, we selected FQE as the baseline for comparison since it the best baseline in OPE tasks. Following the suggestion, we have additionally evaluated IS and DICE for off-policy selection, which is shown in Page 23 Table 8-9 in the appendix, and Table 2 in the main body. We observe that IS indeed has more competitive performance (59.4% performance gain) than FQE (20.6% performance gain) but still falls behind PCM (71.7% performance gain).\n\n### **Q4: Reproducibility is hard to evaluate. There is no code supplementary. Raw results of absolute error without normalization are not provided as in [1], raw results of each task are not provided.**\n\nWe are glad to opensource our code after accpetion. Raw results are on Page 19-20 (Table 4-7) in our paper.\n\n### **Q5: Figure 3: Part of labels on x axis is covered by captions.**\n\nThanks for pointing out this formatting issue. We have fixed them in our revised paper."
                    }
                },
                "number": 6,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission7281/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700506302563,
                "cdate": 1700506302563,
                "tmdate": 1700506310567,
                "mdate": 1700506310567,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "aBxpKT6Aji",
            "forum": "Zh047FhXqI",
            "replyto": "Zh047FhXqI",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission7281/Reviewer_ENii"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission7281/Reviewer_ENii"
            ],
            "content": {
                "summary": {
                    "value": "In reinforcement learning, it is crucial to have an accurate environment dynamics model to evaluate different policies' value in tasks like offline policy optimization and policy evaluation. However, the learned model is known to have large value gaps when evaluating target policies different from data-collection policies. This issue has hindered the wide adoption of models as various policies are needed for evaluation in these downstream tasks. In this paper, the authors focus on one of the typical offline environment learning scenarios where the offline datasets is collected from diversified policies. They utilize an implicit multi-source nature in this scenario and propose an easy-to-implement yet effective algorithm, policy-conditioned model (PCM) learning, for accurate model learning. PCM is a meta-dynamics model that is trained to be aware of the evaluation policies and on-the-fly adjust the model to match the evaluation policies' state-action distribution to improve the prediction accuracy. They provide a theoretical analysis and experimental evidence to demonstrate the feasibility of reducing value gaps by adapting the dynamics model under different policies. Experiment results show that PCM ourperforms the existing SOTA off-policy evaluation in the DOPE benchmark with *a large margin*, and derives significantly better policies in offline policy selection and model prediction control compared with the standard model learning method."
                },
                "soundness": {
                    "value": "2 fair"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "3 good"
                },
                "strengths": {
                    "value": "1. The environment model learning under the setting of dataset is collected from diversified behavior policies is an interesting topic and has positive contribution to the research community. This problem is actually common in practice considering that the large decision mdel often relies on the world model reconstructed from the diversed policy behaviors.\n2. The description of problem modeling and analysis is clear. The whole paper is generally well organized.\n3. The proposed solution in this paper is concise enough and it will be enlightening for subsequent research."
                },
                "weaknesses": {
                    "value": "1. The universality of the dataset collected from diversified behavior policies has not been comprehensively elaborated which limits the meaning of this problem. \n2. The relationship between the proposed solution and the challenges in the setting of dataset collected from diversified behavior policies is not clarified well. It is still unknown or at least confusing the difference between the setting of the dataset collected from homogeneous behavior policies and the dataset collected from diversified behavior policies. And what are the additional challenges brought by this new setting and how the proposed approach help solve these challenges?\n3. Though the authors have paid much attention to how to adapt the learned environment model for various policies in different downstream tasks, how to overcome the challenges of the diverse upstream dataset is less covered in the paper.\n4. The experiments in this paper is still not sufficient enough. Though conducting experiments on different tasks and providing corresponding insightful analysis, the authors are suggested to introduce more environments and baselines to help demonstrate the applicability and superiority of the proposed method."
                },
                "questions": {
                    "value": "1. The authors are encouraged to provide more visualizations to the representations of different learned policies by PCM in various environments.\n2. The authors are expected to provide more evidence and supporting materials on why choosing OPE, OPS, and MPC as the downstream tasks to validate the effectiveness of the proposed method.\nSee the weaknesses above."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "6: marginally above the acceptance threshold"
                },
                "confidence": {
                    "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 3,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission7281/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698842441999,
            "cdate": 1698842441999,
            "tmdate": 1699636869568,
            "mdate": 1699636869568,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "g5j4dJdygu",
                "forum": "Zh047FhXqI",
                "replyto": "aBxpKT6Aji",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission7281/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission7281/Authors"
                ],
                "content": {
                    "title": {
                        "value": "official response (part 1)"
                    },
                    "comment": {
                        "value": "Thank you for all of the insightful questions on our paper. We response the questions and concerns as follows:\n\n\n### **Q1: The universality of the dataset collected from diversified behavior policies has not been comprehensively elaborated which limits the meaning of this problem.**\n\nThank you for your valuable feedback regarding the universality of the dataset derived from diversified behavior policies in our research. We acknowledge the importance of this aspect and have addressed it more comprehensively in our revised manuscript.\n\nIn practical scenarios, the multi-source nature of offline datasets is a common phenomenon, particularly in fields such as robotic manipulation, autonomous driving, and sequential recommendation. These domains often involve data collected from a diverse array of policies. These include parameterized policies, rule-based policies, and human behavior policies, each contributing unique and realistic dimensions to the dataset.\n\nIn our revised paper, we have expanded the introduction to include a detailed discussion of this aspect, illustrating the relevance and applicability of our approach to real-world scenarios. To support our argument, we have referenced several key studies:\n\n1. \"Roboturk: A crowdsourcing platform for robotic skill learning through imitation\" and \"What matters in learning from offline human demonstrations for robot manipulation\" [1,2] highlight the significance of varied data sources in robotic manipulation.\n2. \"BDD100K: A diverse driving video database with scalable annotation tooling\" and \"Scalability in perception for autonomous driving: Waymo open dataset\" [3,4] underscore the diversity in autonomous driving datasets.\n3. \"Open bandit dataset and pipeline: Towards realistic and reproducible off-policy evaluation\" and \"Kuairec: A fully-observed dataset and insights for evaluating recommendation systems\" [5,6] elucidate the variety in datasets used for sequential recommendation.\n\nThese references substantiate the universality and practical importance of multi-source datasets in offline RL research, aligning closely with the objectives and scope of our study.\n\nWe believe that this enhanced discussion in our paper now adequately addresses the concern raised and underscores the significance and applicability of our research in diverse real-world contexts.\n\n[1] Roboturk: A crowdsourcing platform for robotic skill learning through imitation.\n\n[2] What matters in learning from offline human demonstrations for robot manipulation.\n\n[3] BDD100K: A diverse driving video database with scalable annotation tooling.\n\n[4] Scalability in perception for autonomous driving: Waymo open dataset.\n\n[5] Open bandit dataset and pipeline: Towards realistic and reproducible off-policy evaluation.\n\n[6] Kuairec: A fully-observed dataset and insights for evaluating recommendation systems.\n\n### **Q2: It is still unknown or at least confusing the difference between the setting of the dataset collected from homogeneous behavior policies and the dataset collected from diversified behavior policies. And what are the additional challenges brought by this new setting and how the proposed approach help solve these challenges?**\n\nThank you for the valuable comments. In our revised manuscript, we have expanded our discussion in this regard, particularly in the methodology section, to address these concerns more comprehensively.\n\nThe key distinction in our research lies in the comparison between datasets collected from homogeneous behavior policies and those from diversified behavior policies. Traditional approaches often rely on the simplification of using data from a single-behavior policy, which does not fully capture the complexity and variability found in real-world applications. In contrast, our study focuses on the multi-source nature of data, which is more representative of realistic scenarios, as explained in our previous response.\n\n**The unique aspect of our approach is not about addressing new challenges presented by diversified datasets but rather about leveraging the additional information inherent in such settings.** In a multi-source dataset, different trajectories may originate from varying policies, but the transition data within each trajectory are consistently generated by the same policy. This distinct feature provides valuable insights for dynamics model learning, which is a central aspect of our proposed method.\n\nBy acknowledging and utilizing this additional information, our approach goes beyond the limitations of  algorithms designed for single-source datasets. It recognizes and exploits the nuances in multi-source data that are often overlooked in more simplified formulations. We believe this refined perspective, now thoroughly discussed in our paper, underscores the novelty and relevance of our research in addressing the complexities of real-world data in AI applications."
                    }
                },
                "number": 4,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission7281/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700493943927,
                "cdate": 1700493943927,
                "tmdate": 1700494282668,
                "mdate": 1700494282668,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "AK8TJ6B9Tp",
                "forum": "Zh047FhXqI",
                "replyto": "aBxpKT6Aji",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission7281/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission7281/Authors"
                ],
                "content": {
                    "title": {
                        "value": "official response (part 2)"
                    },
                    "comment": {
                        "value": "### **Q3: Though the authors have paid much attention to how to adapt the learned environment model for various policies in different downstream tasks, how to overcome the challenges of the diverse upstream dataset is less covered in the paper.**\n\nThank you for your valuable observation regarding our paper's focus on adapting learned environmental models to various policies in different downstream tasks.\n\nWe would like to clarify that our research fundamentally revolves around leveraging the diversity of datasets to learn a more accurate and faithful environmental model. The diverse nature of the dataset is not just a condition for our method but rather the cornerstone upon which our approach is built. Hence, our primary aim is to demonstrate how to effectively utilize the inherent diversity in datasets to enhance environmental model learning.\n\nGiven this focus, the challenges posed by the diverse nature of the dataset are integral to our research. However, the explicit discussion on overcoming these challenges may appear less prominent as our method inherently embraces and capitalizes on this diversity, rather than viewing it as a hurdle to be overcome.\n\nWe appreciate your input and have made efforts in our revised manuscript to articulate this aspect more clearly, ensuring that our approach's alignment with the premise of diverse datasets is well understood.\n\n### **Q4: Though conducting experiments on different tasks and providing corresponding insightful analysis, the authors are suggested to introduce more environments and baselines to help demonstrate the applicability and superiority of the proposed method.**\n\nThank you for your constructive suggestion regarding the scope of experiments in our paper. In response to your feedback, we have expanded our experimental framework by including additional datasets that further illustrate the applicability and effectiveness of our proposed method.\n\nIn our revised manuscript, we have incorporated results from five new datasets for the Off-Policy Evaluation (OPE) task. These datasets are ant-medium-replay, ant-medium-expert, halfcheetah-medium-expert, hopper-medium-expert, and walker2d-medium-expert. The inclusion of these diverse environments enables a more comprehensive evaluation of our method across different contexts and challenges. \n\nOur updated results, which can be found in the general response, demonstrate that our method continues to significantly outperform other methods on these additional tasks. This further substantiates our method's superiority and versatility in various settings.\n\nWe believe that these enhancements to our experimental section address your concerns and effectively showcase the robustness and generalizability of our approach. \n\n### **Q5: The authors are encouraged to provide more visualizations to the representations of different learned policies by PCM in various environments.**\n\nThese new visuals provide a clearer and more comprehensive representation of how different learned policies by PCM perform in diverse environments. You can find these enhancements on Page 21, where we have meticulously illustrated the dynamics of different policies in action. The results show that PCM can effectively identify similar policies and distinguish different policies.  We believe that these visual aids will significantly augment the reader's understanding and appreciation of our method's capabilities.\n\n### **Q6: The authors are expected to provide more evidence and supporting materials on why choosing OPE, OPS, and MPC as the downstream tasks to validate the effectiveness of the proposed method. See the weaknesses above.**\n\nThese tasks correspond to the discussion in related works. OPE is the task most relevant to the \u201cvalue gap\u201d. Since OPE needs to evaluate the value of a target policy and therefore we can expect that a more accurate model that has a smaller value gap should do better in OPE. OPS is a task derived from offline RL. For the offline RL setting, it tends to be not allowed to select a desirable policy from many candidates via evaluating them in the real environment, thus OPS is a key process for offline RL, which is also be attain great importance in other work [7]. MPC is a task to consider whether our model can be applied to decision/control rather than only policy evaluation. We don\u2019t consider policy learning in our paper since policy learning with a learned model in the offline setting always needs to incorporate some additional designs, like ensemble, uncertainty quantification, and penalty  [8, 9], which introduce more variables and make it difficult to evaluate whether the improvement of policy learning is due to the more accurate model.\n\n[7] NeoRL: A near real-world benchmark for offline reinforcement learning.\n\n[8] MOPO: model-based offline policy optimization.\n\n[9] Model-Bellman inconsistency for model-based offline reinforcement learning."
                    }
                },
                "number": 5,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission7281/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700494263801,
                "cdate": 1700494263801,
                "tmdate": 1700494350666,
                "mdate": 1700494350666,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "6bwflWQcIX",
            "forum": "Zh047FhXqI",
            "replyto": "Zh047FhXqI",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission7281/Reviewer_Ag2q"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission7281/Reviewer_Ag2q"
            ],
            "content": {
                "summary": {
                    "value": "The paper proposes a method called PCM to tackle the complex model learning process in RL for offline policy optimization and evaluation. When offline dataset is collected by a diverse set of behavior policies, it might be challenging to train a single dynamics model with tolerable error due to model capacity. To this end, PCM proposes to divide the dataset into subtasks associated with different behavior policies, and train policy-conditioned dyanamics model to improve the value gap."
                },
                "soundness": {
                    "value": "2 fair"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "2 fair"
                },
                "strengths": {
                    "value": "1. The paper proposes to reduce modeling error of the MDP dynamics by learning policy-conditioned models associated with different data-collecting behavior policies, which is connected to popular context-based meta-learning paradigms such as [1][2][3].\n\n2. The motivating example of \"Varied dynamics models for different policies\" in section 4.3 is interesting. \n\n3. The authors conduct a wide range of experiments to demonstrate the superiority of proposed PCM.\n\n[1] Efficient off-policy meta-reinforcement learning via probabilistic context variables.\n\n[2] Focal: Efficient fully-offline meta-reinforcement learning via distance metric learning and behavior regularization.\n\n[3] Fast Adaptation to New Environments via Policy-Dynamics Value Functions."
                },
                "weaknesses": {
                    "value": "1. **Limited technical contributions**.  The central idea of the paper is training policy-conditioned dynamics models instead of a single model on a diverse offline RL dataset to achieve better modeling error. However, the idea of using MDP-conditioned embeddings for training a universal model in deep RL is not new, see for example [9][10][11].\n\n2. **Gap between theory and experiments**: I also find the main theorem of the paper, Proposition 4.2 a relatively trivial result. On the RHS of (8), the training error minus the adaptation gain is precisely the model error on the LHS. It only shows that the generalization error can be bounded given a Lipshitz assumption, without explictly modeling the effect of policy embedding. The main argument seems to be that the adaptation gain of PCM is positive but zero for PAM. However, one can simply fine-tune PAM given the data of a new policy $\\pi$ to achieve a positive adaptation gain, which is also a stronger baseline should be compared in experiments in 5.3.1 (see point 3). Therefore, **it's not convincing enough why policy-conditioned PCM is superior given the theory**, which is supposed to be the main contribution of the paper. \n\n3. **Missing important model-based baselines**. As mentioned in 5.3.1, naive PAM significantly outperforms other competitive baselines of off-policy evaluation because the authors use better architectures than MLP. Thanks for being honest and transparent about this point. However, since the key contribution PCM is policy-conditioned design of dynamics model, I believe it's important to see whether PCM outperforms other competitive **model-based OPE baselines when using the same architecture**. A simple finetuned PAM on unseen task should also be compared as a stronger basline (see point 2).\n\n4. The review of related work of model-based offline RL is inadequate. In this submission, the related work only refers to those published before 2021 and there are more recently published works such as PMDB[1], VMG[2], RAMBO[3], COUNT-MORL[4], ROSMO[5], CABI[6], AMPL[7], CBOP[8]. I personally do not agree with the authors' perspective that MBORL are generally categorized into two groups: MPC and PL. For example, AMPL[7] focuses on the model learning process but can not be categorized into policy learning, CABI[6] focuses on the model data augmentation, RAMBO[3] focuses on the mini-max optimization about the offline dataset. Even, as far as I know, the MPC methods only covers a relatively small portion of the model-based offline RL methods. \n\n    Also, the setting of the paper seems to be more related to the so-called compositional/functional RL [12], which should be discussed and some of the baselines should be compared.\n\nMinor issues in presentation:\n\n1. What is $W$ in Proposition 4.2?\n\n2. In Fig 2.c, shouldn't the expected outcome look like a diagonal matrix, since evaluating on the same policy where the embedding is trained (diagonal entry) should give the best performance?\n\n[1] Model-Based Offline Reinforcement Learning with Pessimism-Modulated Dynamics Belief\n\n[2] VALUE MEMORY GRAPH: A GRAPH-STRUCTURED WORLD MODEL FOR OFFLINE REINFORCEMENT LEARNING\n\n[3] Robust Adversarial Model-Based Offline Reinforcement Learning\n\n[4] Model-based Offline Reinforcement Learning with Count-based Conservatism\n\n[5] EFFICIENT OFFLINE POLICY OPTIMIZATION WITH A LEARNED MODEL\n\n[6] Double Check Your State Before Trusting It: Confidence-Aware Bidirectional Offline Model-Based Imagination\n\n[7] A Unified Framework for Alternating Offline Model Training and Policy Learning\n\n[8] CONSERVATIVE BAYESIAN MODEL-BASED VALUE EXPANSION FOR OFFLINE POLICY OPTIMIZATION\n\n[9] Focal: Efficient fully-offline meta-reinforcement learning via distance metric learning and behavior regularization\n\n[10] Fast adaptation to new environments via policy-dynamics value functions.\n\n[11] Universal Value Function Approximators.\n\n[12] A survey on continual learning and functional composition."
                },
                "questions": {
                    "value": "See Weakness above."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "3: reject, not good enough"
                },
                "confidence": {
                    "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 4,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission7281/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698843117820,
            "cdate": 1698843117820,
            "tmdate": 1699636869466,
            "mdate": 1699636869466,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "6nCadgGNt3",
                "forum": "Zh047FhXqI",
                "replyto": "6bwflWQcIX",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission7281/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission7281/Authors"
                ],
                "content": {
                    "title": {
                        "value": "official response (part 1)"
                    },
                    "comment": {
                        "value": "Thank you for your insightful comments. we response the questions and concerns as follows:\n### **Q1: Limited technical contributions. The central idea of the paper is training policy-conditioned dynamics models instead of a single model on a diverse offline RL dataset to achieve better modeling error. However, the idea of using MDP-conditioned embeddings for training a universal model in deep RL is not new, see for example [9][10][11].**\n\nWhile we appreciate the references to existing literature on MDP-conditioned methods in deep RL, we believe that the technical contributions of this paper is beyond the method implementation itself. The paper presents a novel perspective on leveraging MDP-conditioned dynamics models, particularly in the context of offline RL datasets. \n\nWe would like to first highlight the distinct aspects of our approach. \n\n- The referenced works, such as Universal Successor Features Approximators [11], FOCAL [9], and Policy-Dynamics Value Functions [10], indeed employ MDP-conditioned methods. However, these approaches primarily focus on adapting to diverse environmental conditions and reward structures through modifications prior to policy application.\n- In contrast, our work diverges significantly in both intent and implementation. We utilize policy-conditioned methods not as a means to adapt to environmental variability, but rather to enable different policies to learn more effectively from a dynamic model tailored to the dataset's diversity. This approach specifically targets the reduction of value gaps, a critical aspect in offline RL that has not been the primary focus of the aforementioned studies.\n\nTo the best of our knowledge, this particular application of policy-conditioned methods to enhance policy learning in the context of diverse offline RL datasets represents a novel contribution. It extends beyond the scope of existing methods by prioritizing the alignment between policies and the prediction focus of dynamic models, which is a departure from the primarily environment-focused adaptations in prior research.\n\nWe believe this clarification underscores the unique technical contributions of our work and its significance in advancing the field of deep reinforcement learning.\n\n### **Q2: It only shows that the generalization error can be bounded given a Lipshitz assumption, without explictly modeling the effect of policy embedding. The main argument seems to be that the adaptation gain of PCM is positive but zero for PAM.**\n\nThe analysis is in fact an ideal case where the policy information could be perfectly injected into the model, under which case the generalization to other policies naturally relies on the Lipschitz continuity of the learned model. \n\nThe policy embedding is a practical method to realize such the information injection mechanism, however, it is hard in general to analyze the effect of the concrete embedding, and we resort to the adaptation gain argument, which is an overall description of the model adaptation effect. In the previous submission, we discussed three possible mode of the adaptation in Appendix A.3, where the Case 2 Imaginary retraining is an ideal model of fine-tuning PAM for the target policy. However, it is just \u201cimaginary\u201d since it requires the real target domain data, which is inaccessible in our setting as well as many realistic situations, and we regard it as a ceiling of model accuracy for any practical PCM algorithms. If we cannot obtain the target policy data, the PAM can never be tuning specially for the target policy, and the adaptation gain is exactly zero. We believe the case 3 Intermediate adaptation reflects the adaptation effect of practical PCM methods, which lies between the two extreme cases of perfect adaptation ( case 2. imaginary retraining) and zero adaptation gain (case 1. direct match) and is able to partially reduce the extrapolation error. The empirical results in Sec 5.2 provides evidence to support this discussion."
                    }
                },
                "number": 1,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission7281/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700493361877,
                "cdate": 1700493361877,
                "tmdate": 1700494832970,
                "mdate": 1700494832970,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "h4m2dWpE8K",
                "forum": "Zh047FhXqI",
                "replyto": "6bwflWQcIX",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission7281/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission7281/Authors"
                ],
                "content": {
                    "title": {
                        "value": "official response (part 2)"
                    },
                    "comment": {
                        "value": "### **Q3: One can simply fine-tune PAM given the data of a new policy\u00a0to achieve a positive adaptation gain, which is also a stronger baseline should be compared in experiments in 5.3.1.**\n\nWe appreciate your suggestion to compare our PCM with a fine-tuned PAM as a baseline in our experiments. However, we would like to clarify a key practical limitation associated with fine-tuning PAM for new policies, particularly in an offline policy evaluation/learning setting.\n\nFine-tuning PAM parameters for new policies, while theoretically feasible, is not practically viable in our context. This approach necessitates interactions of the new policies with the real environment to gather target domain experiences, which is prohibitive in offline settings where such interactions are not possible or desired. In contrast, our PCM is designed to adapt to new policies at runtime without the need for model parameter fine-tuning or real-world interaction experiences with the target policies. As mentioned above, we analysed this  in Appendix. For full discussion, please refer to case 2 (imaginary retraining) in Appendix A.3, which actually is the ideal adaptation method. \n\nNevertheless, recognizing the theoretical value of fine-tuned PAM as an algorithm for comparison, we have included its performance in our revised paper to serve as an upper-bound comparison. This inclusion provides a perspective on the *optimal* adaptation gain achievable under less constrained conditions. The following table presents the value gaps for both PAM and fine-tuned PAM, compared with PCM:\n\n|  | PAM | PAM(fine-tuned) | PCM |\n| --- | --- | --- | --- |\n| halfcheetah-medium-replay | 0.49\u00b10.09 | 0.25\u00b10.07 | 0.31\u00b10.08 |\n| walker2d-medium-replay | 0.38\u00b10.07 | 0.18\u00b10.06 | 0.25\u00b10.05 |\n\nThese results show that while there is a margin between PCM and the optimally fine-tuned PAM, PCM nonetheless achieves substantial adaptation gains compared with the original PAM. This demonstrates the practical efficacy and adaptability of PCM in offline policy evaluation/learning scenarios. Due to time limitations, we will add all results to other tasks later.\n\nWe believe this additional comparison enriches our experimental analysis and provides a more comprehensive understanding of PCM's performance relative to other approaches.\n\n### **Q4: I believe it's important to see whether PCM outperforms other competitive\u00a0model-based OPE baselines when using the same architecture. A simple finetuned PAM on unseen task should also be compared as a stronger baseline (see point 2)**\n\nThank you for your valuable feedback regarding the comparison of our PCM with other model-based and model-free OPE methods. \n\nFirstly, it is important to note that among the baselines considered in our study, PAM is the only model-based OPE method. The remaining baselines are model-free OPE methods. This distinction is crucial as it ensures a fair and relevant comparison within the context of model-based OPE approaches.\n\nRegarding the suggestion to compare our approach with a fine-tuned PAM on unseen tasks, we argue that a fine-tuned PAM should not be considered an additional baseline. This is due to its reliance on real interaction trajectories of the target policies, which diverges from the primary objective of OPE methods - to evaluate policies without necessitating further real-world interactions.\n\nFurthermore, to bolster our comparison and validate the efficacy of PCM, we have also implemented PCM with a standard Multilayer Perceptron (MLP) architecture. This implementation demonstrates that the PCM mechanism consistently aids in reducing value gaps across different architectures. The results of this implementation can be found in the general response."
                    }
                },
                "number": 2,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission7281/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700493549185,
                "cdate": 1700493549185,
                "tmdate": 1700508615649,
                "mdate": 1700508615649,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "Ivhu7YnUsR",
                "forum": "Zh047FhXqI",
                "replyto": "6bwflWQcIX",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission7281/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission7281/Authors"
                ],
                "content": {
                    "title": {
                        "value": "official response (part 3)"
                    },
                    "comment": {
                        "value": "### **Q5: The review of related work of model-based offline RL is inadequate.**\n\nThank you for your comments regarding the review of related work in our paper. Our approach to categorizing related work is based on how the models are utilized within the offlineRL framework.\n\nSpecifically, we distinguish between methods that use models for model predictive control (MPC), where policies are generated through planning, and those used for policy learning (PL). This classification is designed to evaluate the effectiveness of models in facilitating downstream tasks, which is central to our study.\n\nConsidering the recent works you mentioned, we acknowledge that they indeed present novel approaches within the model-based offline RL domain. For instance, AMPL [7] and RAMBO [3] integrate dynamic-model training with policy learning, and CABI [6] focuses on generating new datasets for offline RL policy learning in an adversarial manner. According to our classification principle, these methods primarily support policy learning as they leverage dynamics models for this purpose.\n\nWe have chosen this classification scheme because it aligns closely with the objectives of our research and informs the design of our experiments. While we recognize other valid methods of classification, we believe our approach is more pertinent to the specific issues and questions our paper addresses. To this end, we have updated our manuscript to include additional related works in the main text, thereby providing a more comprehensive overview.\n\nRegarding your point about compositional/functional RL, we respectfully disagree with the applicability of this concept to our work. Compositional RL typically assumes that tasks can be broken down into subtasks, which is not an assumption we make in our approach. Our method focuses on learning representations about tasks without decomposing them into subfunctions, distinguishing it from compositional methods.\n\nWe hope this response adequately addresses your concerns and provides clarity on our classification rationale and its relevance to our research objectives.\n\n### **Q6: What is\u00a0$W_1$\u00a0in Proposition 4.2?**\n\nWe apologize for the omitted explanation for it. Here, $W_1$\u00a0is the Wasserstein-1 distance.\n\n### **Q7: In Fig 2.c, shouldn't the expected outcome look like a diagonal matrix, since evaluating on the same policy where the embedding is trained (diagonal entry) should give the best performance?**\n\nThe ideal result is that it appears as a diagonal matrix. However, due to some randomness in experiments, it\u2019s hard to get an exact, \u201cperfect\u201d diagonal matrix. The result shown in Fig 2.c is close to a diagonal matrix, in which we can see that the model error near the diagonal is small while the error away from the diagonal is large."
                    }
                },
                "number": 3,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission7281/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700493641542,
                "cdate": 1700493641542,
                "tmdate": 1700494300015,
                "mdate": 1700494300015,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    }
]