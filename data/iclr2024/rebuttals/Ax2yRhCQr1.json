[
    {
        "title": "Understanding Augmentation-based Self-Supervised Representation Learning via RKHS Approximation and Regression"
    },
    {
        "review": {
            "id": "JvbPfnS7iP",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission3894/Reviewer_dUJ6"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission3894/Reviewer_dUJ6"
            ],
            "forum": "Ax2yRhCQr1",
            "replyto": "Ax2yRhCQr1",
            "content": {
                "summary": {
                    "value": "This paper gives a theoretical analysis of how the distribution of augmentations affects the accuracy of contrastive learning methods, building on previous work that has studied this problem through the lens of RKHS regression, and focusing on nonparametric encoder-complexity-independent bounds. The authors first discuss the augmentation operator and show that it induces a pair of dual operators with corresponding eigenfunction decompositions. They then introduce the concepts of *augmentation complexity* (based on the infinity norm of a kernel defined by the augmentations) and the *ratio trace* (which roughly characterizes \"how much\" of the eigenspaces of the corresponding RKHS are captured by a given encoder).\n\nThe authors then prove a number of results based on these quantities. First, they show that the error of a downstream predictor can be decomposed into an approximation-error term (how closely the function can be recovered from the learned encoder's representation) and a downstream-estimation-error term (how well the linear readout actually recovers this function). Second, they consider approximating the top-d eigenspace of the RKHS using only a finite pretraining dataset, and show that this can be used to bound the approximation error term.\n\nFinally, the authors consider how their \"augmentation complexity\" measurement translates to real augmentations, focusing on masking transformations. They give theoretical values for it for the hypercube examples discussed in Cabannes et al. (2023), and also show how to estimate it for masked language modeling on the `wikipedia-simple` dataset."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "3 good"
                },
                "strengths": {
                    "value": "**[S1]** The paper is overall clearly written and easy to follow, and the authors do a good job introducing the problem and explaining their analysis. I found the \"proof sketches\" for the main results to be very useful as well.\n\n**[S2]** The formalism of the dual operators and the isometry property are quite elegant. The authors build on previous work but present the previously-studied concepts in an insightful way, and clearly lay out the underlying structure produced by the augmentation distribution.\n\n**[S3]** The main results in sections 3 and 4 go further than previous work in characterizing how much information the augmentations alone can provide about the function of interest. In particular, Theorem 1 shows how the error of a function decomposes into approximation and estimation error, and furthermore identifies how the approximation error component depends on the \"trace gap\"; Theorem 2 then shows that finding the empirical top eigenspace can lead to small approximation error even if $\\lambda_{d+1}$ and $\\lambda_d$ are close.\n\n**[S4]** The analysis of the augmentation complexity of real augmentations is quite interesting, both for the theoretical values for particular masking strategies and for the empirical estimation of the augmentation complexity of real augmentations used for masked language modeling."
                },
                "weaknesses": {
                    "value": "**[W1]** This work focuses on analyzing the effect of the augmentations alone, without considering the impact of inductive biases. I understand that this was an intentional choice, and I do think that this makes the analysis of augmentations more \"pure\". However, such an approach means that the theoretical results here may not have much explanatory power for real augmentations.\n\n~~Relatedly, I think the paper makes some unjustified claims regarding the power of their analysis for tasks where inductive biases are important.~~\n\n- ~~(a) The authors state that they \"disentangle the effects of the model and the augmentation\", but it's not clear to me what is being disentangled. This seems to be primarily an analysis of the augmentation distribution, with the model's role being just to achieve a good ratio trace with respect to those annotations. I'm not sure how easy it would be to extend this analysis to models with more structured inductive biases.~~\n- ~~(b) In the appendix, the authors state that their analysis \"clearly refutes the claim in Saunshi et al. (2022) that learning guarantees independent of the model inductive bias are necessarily vacuous\", but I disagree with this claim and don't think it is justified (see questions below).~~\n\n*Edit: The authors have addressed the unjustified claims. Also, I think the theoretical contributions of studying augmentations alone are valuable even if they don't fully explain the success of large-scale self-supervised learning, so this isn't a major concern.*\n\n**[W2]** The analysis starts from a strong assumption that the target function $f^*$ lies in a particular RKHS and satisfies a particular soft invariance condition. However, it's difficult to tell what this assumption actually means, or whether it would be true in practice. In particular, the RKHS membership seems quite strict, and adding even an arbitrarily small perturbation to $f^*$ might cause the assumption to no longer hold. (There is a bit of discussion in the appendix, but it's not clear to me what effect this would actually have on the main results.)\n\n*Edit: The authors have noted that assuming functions lie in a particular RKHS is standard for learning theory work and necessary to get statistical guarantees.*\n\n~~**[W3]** I think part of Proposition 1 is incorrect, or at least incorrectly stated. I also have a small concern about the asymptotic statements concerning Theorem 2. (These should hopefully be minor issues that are easy to address.)~~\n\n*Edit: Addressed in the revision.*\n\n**[W4]** The empirical results about real augmentations suggest that the true augmentation complexity of real-world datasets is *massive* (on the order of $\\kappa \\approx 10^{100}$). As such, it seems likely that the bounds in Theorem 1 and Theorem 2 would be effectively vacuous for real-world data.\n\n*Edit: As the authors point out, this is analogous to the standard curse of dimensionality for bounds based on model complexity, so it's not specific to their analysis.*"
                },
                "questions": {
                    "value": "**On inductive biases.** In the appendix, you state \"the nonparametric analysis established in this work clearly refutes the claim in Saunshi et al. (2022) that learning guarantees independent of the model inductive bias are necessarily vacuous\". I don't think this is true. As I understand it, Saunshi et al. show that when augmentations are approximately disjoint, the eigenspectrum of $\\Gamma\\Gamma^*$ decays extremely slowly, with many of the eigenvalues of $\\Gamma\\Gamma^*$ being close to 1 (or, under their notation, many eigenvalues of the normalized Laplacian $L_\\circ = I - A_\\circ$ being close to 0). This means that the approximation error of the top-d eigenspace is necessarily very large. I think this same analysis also applies to your results; Saunshi et al.'s approximately-disjoint augmentations would imply $\\lambda_{d+1} \\approx 1$ and so your $\\tau \\approx 1$, leading to a blowup in the first term of your equation 14.\n\nIf I'm correct, I think this deserves more discussion, and I don't think you can say that you've refuted the claims of Saunshi et al. I also think the paper could be improved by giving more context about the relationship of your results to those of Saunshi et al. For instance, is there any relationship between your augmentation complexity and Saunshi et al.'s approximately-disjoint augmentations? One might expect that approximately-disjoint augmentations would imply a high augmentation complexity; if so, that could be useful to discuss.\n\nAlso, what do you mean by \"disentangle the effects of the model and the augmentation\"? It's not clear to me how the presented results disentangle these effects, although I do think they give a clear explanation of the role of the augmentations in particular.\n\n\n**Interpreting the soft invariance criterion.** Can you give any intuition about what satisfying Assumption 1 actually means in practice? It seems unlikely to me that functions of practical interest could be *exactly* represented as expectations of some function $g$ on augmentations, and I also don't see any way to verify whether or not Assumption 1 holds.\n\n**Part (iv) of Proposition 1.** Proposition 1 part (iv) states that $g^*$ satisfies Assumption 1. This doesn't make sense to me; Assumption 1 is a statement about $f^*$, not $g^*$. Do you mean to say that $g^*$ satisfies Equation (1)?\n\nThe proof of part (iv) also seems potentially incorrect. In particular I'm not sure how $\\langle g^*, (I - \\Gamma \\Gamma^*) g^* \\rangle_{P_A} \\le \\epsilon ||g^*||^2_{P_A}$ implies $\\langle g_0, (I - \\Gamma \\Gamma^*) g_0 \\rangle_{P_A} + ||g_1||^2_{P_A}  \\le \\epsilon (||g_0||^2_{P_A} + ||g_1||^2_{P_A})$; shouldn't $||g_1||^2_{P_A}$ be $\\langle g_1, (I - \\Gamma \\Gamma^*) g_1 \\rangle_{P_A}$ instead? It also seems like your proof here implies that $R(\\Gamma^*) \\subseteq \\mathcal{F}_B(\\Gamma; \\epsilon)$ for all $\\epsilon$. But that doesn't seem like it could be true; perhaps I'm misunderstanding something.\n\n**Asymptotic behavior of Theorem 2.** In Theorem 2, don't the quantities $\\overline{\\lambda}_d^{-1}$ and $\\gamma_G$ potentially depend on $N$? It seems like that could affect the asymptotic behavior of the bound in equation (20). Can you say anything about the convergence or boundedness of these quantities?\n\n**Relationship of this analysis to that of Johnson et al. (2023).** I noticed that parts of your analysis resemble some of the statements of Johnson et al. (2023) at a high level; in particular, your soft invariance assumption is similar to their \"approximate view invariance\" assumption, and the decomposition in Theorem 1 is somewhat similar to their bound in Proposition 4.2. The details are different (their analysis focuses on approximating functions $\\mathcal{A} \\to \\mathbb{R}$ rather than $\\mathcal{X} \\to \\mathbb{R}$ and doesn't include the approximation error of the encoder) but it might still be worth including a brief discussion of the similarities.\n\n**Other suggestions / comments.**\n- Section 2 states \"Similar to RIP, this property clarifies the the role of augmentation: The augmentation defines a set of features (eigenfunctions) ordered by their a priori relevance to the target function.\" This wasn't clear to me; how does the isometry property relate the relevance of the eigenfunctions to the target function?\n- The definition of $||f||\\_n^2$ in section 3 doesn't seem to be used anywhere in the main paper.\n- It took me a while to locate the definition of $\\hat{f}$ when reading Theorem 1; perhaps you could add a reference back to equation (9) where it is defined.\n- Section 4 discusses the empirical eigenspace $\\hat{\\mathcal{H}}\\_d$ before actually defining what it is, which was a bit disorienting; it might make sense to define it at the start of section 4 instead of at the end of page 6."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "8: accept, good paper"
                },
                "confidence": {
                    "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
                },
                "code_of_conduct": {
                    "value": "Yes"
                },
                "first_time_reviewer": {
                    "readers": [
                        "ICLR.cc/2024/Conference/Program_Chairs",
                        "ICLR.cc/2024/Conference/Submission3894/Senior_Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission3894/Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission3894/Reviewer_dUJ6"
                    ]
                }
            },
            "number": 1,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission3894/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1697427157335,
            "cdate": 1697427157335,
            "tmdate": 1700582985430,
            "mdate": 1700582985430,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "2aZmnUkL5I",
                "forum": "Ax2yRhCQr1",
                "replyto": "JvbPfnS7iP",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission3894/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission3894/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Clarification"
                    },
                    "comment": {
                        "value": "Dear Reviewer dUJ6,\n\nThank you for your time in reviewing this paper! We are still finalizing our response to you, and will submit it within the next 10 hours. Your review has an exceptionally high quality, and we want to make sure that our response could be equally good. We are definitely looking forward to having a discussion with you.\n\nBest regards,  \nAuthors"
                    }
                },
                "number": 7,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission3894/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700253198323,
                "cdate": 1700253198323,
                "tmdate": 1700253198323,
                "mdate": 1700253198323,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "lGFNSx5soI",
                "forum": "Ax2yRhCQr1",
                "replyto": "JvbPfnS7iP",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission3894/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission3894/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Author Response (1/2)"
                    },
                    "comment": {
                        "value": "Thank you so much for your constructive comments! We have uploaded a new version of our paper, and would like to answer your questions below.\n### Comments\n1. **What we mean by \u201cdisentangle the effects of the model and the augmentation\u201d**:\nWe mean that our bounds (a) are nonparametric, (b) do not depend on any model complexity or inductive bias, and hence (c) allow the user to choose any model of any size and architecture for the encoder $\\hat{\\Phi}$, which is what\u2019s actually learned during upstream (see our remark in Section 3). Comparing our bounds to prior work:\n    - HaoChen et al. (2021) and Saunshi et al. (2022): Their bounds contain model complexity (e.g. Rademacher complexity) and thus depend on the model.\n    - Cabannes et al. (2023): Their bounds are nonparametric, similar to ours. However, they assumed the function class to be a subset of the RKHS of a predefined kernel $K$, which is determined by the model architecture. Thus, their results are still model-dependent.\n\nA major novelty of our work compared to prior work is removing the effect of the model and only focusing on the augmentation. We believe that this is important, because it helps \u201cclearly lay out the underlying structure produced by the augmentation distribution\u201d, as the reviewer also pointed out.\n\n2. **What does $f^{\\star}$ lie in a particular RKHS mean, and is this assumption reasonable?**\n    - First, we\u2019d like to note that: Assuming the target function to belong to some (usually compact) function class is necessary for proving any nonparametric learning guarantee. Such assumptions are known as *priors* in statistical learning; the seminal works (DeVore et al.,  2004; Bauer et al., 2007) have discussed in detail why priors are inevitable for statistical guarantees.\n    - An RKHS (or more generally, a separable Hilbert space, e.g. Fischer & Steinwart (2020)) is a common choice of such a prior in most existing learning theory work. A concern is that, regardless of the definition of this Hilbert space, a small perturbation can make $f^*$ no longer belong to the space, as the reviewer pointed out. However, this has not been deemed a serious issue in learning theory community, since if the perturbation is small enough (e.g. on a subset of measure zero), then it won\u2019t have a large impact on the statistical guarantees.\n    - **Interpreting our Assumption 1**: Our induced RKHS is determined by the augmentation, which is selected based on human prior knowledge of $f^*$. Thus, so long as the human prior knowledge is correct, \u201c$f^*$ belonging to the induced RKHS\u201d can be derived from the soft invariance condition. For instance, if the augmentation is image translation and we know that image semantics are invariant w.r.t. translation, then soft invariance implies that $f^*$ belongs to the RKHS induced by translation.\n\nOf course, a good model architecture also can contain human prior knowledge, like the design of convolutional networks. Cabannes et al. (2023) had a discussion on this in their Appendix D.3, where they considered linearization of one-block convolutional networks. However, in general, it is not quite clear how the inductive bias of a deeper, more complicated practical model (that cannot be linearized) can be formulated as a kernel.\n\nDeVore et al. Mathematical methods for supervised learning. 2004.  \nBauer et al. On Regularization Algorithms in Learning Theory. 2007.  \nFischer & Steinwart. Sobolev Norm Learning Rates for Regularized Least-Squares Algorithms. 2020.\n\n3. **Regarding the claim in Saunshi et al. (2022):**\n    - We\u2019d like to first clarify that we interpret \u201cnon-vacuous\u201d as \u201cmeaningful\u201d, rather than \u201cclose to empirical observations\u201d. We do believe that our bounds, which do not contain any model complexity, are meaningful. We are definitely not claiming anything strong such as \u201caugmentation is all you need\u201d, and we emphasize in Appendix A that combining inductive biases of the model class can lead to tighter bounds. What we do claim is that, if the augmentation is good enough (which is a strong assumption), then we can achieve good generalization without the help of model inductive bias. This is why we disagree with Saunshi et al.\u2019s strong claim that any guarantees independent of the inductive bias are vacuous.\n    - Regarding the disjoint augmentation example in Saunshi et al. (2022): Thank you for this great question! This example showcases a poor choice of augmentation, for which $K_X$ defined in our Eqn. (3) is zero everywhere, so surely our bounds won\u2019t work. Their observation was that even for this very bad augmentation, we can still obtain generalization guarantees if there is a good model (feature map). To see why: Suppose there is a good feature map $\\Phi$. Then, the augmentation $x \\mapsto a$ is disjoint and thus is very bad. However, the augmentation $x \\mapsto \\Phi(a)$ is not disjoint and in fact could be quite good. And if we view $x \\mapsto \\Phi(a)$ as the augmentation, then our model-free bounds work again."
                    }
                },
                "number": 8,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission3894/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700279549924,
                "cdate": 1700279549924,
                "tmdate": 1700279549924,
                "mdate": 1700279549924,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "AahaI4owLr",
                "forum": "Ax2yRhCQr1",
                "replyto": "Ntg4QGjoxO",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission3894/Reviewer_dUJ6"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission3894/Reviewer_dUJ6"
                ],
                "content": {
                    "title": {
                        "value": "Discussion"
                    },
                    "comment": {
                        "value": "Thanks for the responses and the updated manuscript. Some follow-up comments:\n\n**Disentangling:** I see. I interpreted \"disentangle the effects of the model and the augmentation\" as meaning something like \"separately account for the effects of model inductive biases and augmentation choices\", but it sounds like you intended something like \"account for the effects of augmentations without making unnecessary assumptions about the model\"? I'd suggest rewording the statements in the conclusion (and appendix A) to make this a bit more explicit and to emphasize that you're focusing on the effects of the augmentation, not the effects of the model.\n\n**Relationship to Saunshi et al. (2022)** I agree you've shown that, if the augmentation is good enough, you can achieve good generalization without inductive biases. But I don't think you're correctly interpreting the claims of Saunshi et al. (2022). Looking back at their paper, I interpret their main claims to be:\n- \"previous analyses for contrastive learning are vacuous in the disjoint augmentation setting, due to existence of bad minimizers of the contrastive loss\",\n- there exist function-class-dependent bounds that are non-vacuous under disjoint augmentations,\n- in practice, real-world contrastive learning tasks may be in the disjoint augmentations regime, and the contrastive loss does not necessarily correlate with downstream performance\n\nAs far as I can tell, Saunshi et al. (2022) only claim that model-agnostic bounds are vacuous \"in some settings\", and in particular in the context of the disjoint or approximately-disjoint augmentations regimes. I do not think they are claiming that these bounds are vacuous for *every* augmentation distribution, just that they are vacuous for *some* realistic augmentation distributions. So I think your results are still compatible with their claims.\n\n**Exponential dependency:** That's a good point, I agree model-complexity-based bounds are likely to have this problem as well in practice, and that giving tight bounds for big foundation models isn't necessary for the contribution to be meaningful.\n\n**Part (iv) of Proposition 1:** This still looks incorrect to me. I interpret part (iv) as implying that, for any $f^* \\in R(\\Gamma^*)$, we also have $f^* \\in F(\\Gamma; \\epsilon)$ for all $\\epsilon$, because it is of the form $f^* = \\Gamma^* g^*$ for a $g^*$ that satisfies Equation 1. So that would imply $R(\\Gamma^*) \\subseteq F(\\Gamma; \\epsilon)$ for all $\\epsilon$. But that doesn't make sense. The proof also seems circular to me, since it argues that Equation 1 is equivalent to something that implies Equation 1.\n\nI'm actually not sure what you're trying to show here, so maybe I've been misinterpreting it. Maybe you're trying to say something like \"if $f^*$ satisfies Assumption 1 for any $g^*$, then it must also satisfy it for this particular $g^*$\"? In that case, don't you need to start with $f^* \\in F(\\Gamma; \\epsilon)$ rather than $f^* \\in R(\\Gamma^*)$? (It would be redundant to explicitly state that $f^* \\in R(\\Gamma^*)$ if you were already assuming Assumption 1, which is why I interpreted this as an arbitrary $f^* \\in R(\\Gamma^*)$.)\n\nAlso, your proof of Proposition 1 also still references \"property (v)\" which has been removed.\n\n**Asymptotic behavior of Theorem 2:** Thanks, that makes sense. I'd suggest adding a qualification to your statement \"the gap between $\\tau$ and its optimal value is $O(N^{\u22121/2})$\" then, maybe something like \"(ignoring potential dependence of $\\gamma_G$ and $\\overline{\\lambda}_d^{-1}$ on $N$)\".\n\n**Comparing to Johnson et al. (2023)**: Thanks for the clarifications and for discussing the equivalence of the assumptions in Section 2. I  agree the theorem and proposition are quite different so I don't think adding a comparison in the remark of Theorem 1 is necessary. (I guess the closest connection to Prop 4.2 of Johnson et al. (2023) would be to use the true top-$d$ eigenspace and obtain $\\tau^2 = \\lambda_{d+1}$, which you discuss a bit in Section 4 already.)\n\n**Regarding RIP:** I still find the remark after Eqn. (8) to be confusing even in the new version. It seems like existing uses of the RIP are about matrices with nearly-orthonormal columns. I don't see how this connects to preserving variance, or how it relates to PCA. Also, I think the RIP needs to hold for every vector, whereas your Eqn. (8) seems to only hold for functions in $F_B(\\Gamma; \\epsilon)$. And it's still not clear to me why \"The augmentation defines a set of features (eigenfunctions) ordered by their a priori relevance to the target function\" is related to the isometry property; I agree that it's true but it seems unrelated to Equation 8."
                    }
                },
                "number": 11,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission3894/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700447748619,
                "cdate": 1700447748619,
                "tmdate": 1700447748619,
                "mdate": 1700447748619,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "nivwNo7Zvy",
                "forum": "Ax2yRhCQr1",
                "replyto": "fYunJBuVe1",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission3894/Reviewer_dUJ6"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission3894/Reviewer_dUJ6"
                ],
                "content": {
                    "title": {
                        "value": "Discussion and updated review"
                    },
                    "comment": {
                        "value": "Thanks for making those changes and for clarifying part (iv) of Prop 1.\n\nFairly minor suggestion: I think the statement of Part (iv) in the above OpenReview comment is clear, but I noticed that the version in the current paper revision is a bit different and unnecessarily redundant (it says \"$g_0$ satisfies Eqn. (1). Choose $g^* = g_0$, then $g^*$ satisfies Eqn. (1)\"), so I'd suggest using the version from the comment above instead.\n\nBased on this discussion and the changes to the paper, I've raised my score to 8."
                    }
                },
                "number": 13,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission3894/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700583420290,
                "cdate": 1700583420290,
                "tmdate": 1700583420290,
                "mdate": 1700583420290,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "7TGEzRJfwi",
            "forum": "Ax2yRhCQr1",
            "replyto": "Ax2yRhCQr1",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission3894/Reviewer_kPdq"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission3894/Reviewer_kPdq"
            ],
            "content": {
                "summary": {
                    "value": "The authors consider augmentation-based representation learning, where a feature map is learned from an unlabelled dataset augmented using some mechanism. \nThe paper provides a learning theory for this setup using a regression problem, where the regressor is linear in the learned features. \n\nThe authors consider an augmentation mechanism defined by a conditional distribution $p(a|x)$, which modifies a data point $x$ to an augmented sample $a$ stochastically. \nGiven this mechanism, the regression function is defined by the conditional expectation $\\mathbb{E}[g(A)|x]$ of some function $g$. \nFor this, the authors show that the problem may be described by an RKHS, and using this framework, they investigate the role of the feature map and augmentation."
                },
                "soundness": {
                    "value": "2 fair"
                },
                "presentation": {
                    "value": "2 fair"
                },
                "contribution": {
                    "value": "2 fair"
                },
                "strengths": {
                    "value": "The theoretical framework introduced in the paper is interesting and original. \nThe authors introduce an RKHS structure to the representation learning problem. Specifically, the target function $\\mathbb{E}_A[g(A)|x]$ may be considered as an element of an RKHS whose kernel is given by the augmentation-induced joint distribution . \nThe framework thus enables us to quantitively analyse the performance of a downstream regressor using a kernel machinery, as well as establishes a criterion of good representation (approximation to the basis of the RKHS)."
                },
                "weaknesses": {
                    "value": "### Clarity \nA major issue is the lack of clarify. The paper is currently dense, not accessible to a general audience (as someone who is not well-versed in the area, I find the paper really challenging to read), and thus requires a major revision. Because of this, I have to admit that I have not fully understood the contribution of the paper. Specific comments are summarised below. \n \n### Significance \nThere are some elements that make the evaluation of significance difficult: \n* It is not clear how reasonable the assumption on the target function is. It seems that the assumption is conveniently introduced so that we can analyse the problem using a particular RKHS. Is there any motivating example for using $\\mathbb{E}_A[g^*(A)|x]$ as a target? It should be more straightforward to work with (functions on ) the augmentation space $\\mathcal{A}$ rather than $\\mathcal{X}$, as in Johnson et al., 2023.  \n* The encoder has to be of the form (10), as otherwise $\\hat{\\Psi}$ are not included in the RKHS. Therefore, the claim that the encoder $\\hat{\\Psi}$ can be arbitrary is not accurate to me. \n* The soft-invariance assumption is not straightforward to interpret. How does it measure \"invariance\"? Since $\\mathbb{E}[g(A)|x]$ and $g(a)$ are functions on different sets, the invariance is not well-defined.\n* The dimensionality dependency on the upper bound seems to be very pessimistic, as the authors admitted. I \n\nComments: \n* The problem is not well presented. It would have been more helpful if the authors had provided a high-level problem description and define symbols accordingly (e.g., as in the introduction of Johnson et al., 2023). For example, how representation learning is performed is not really mentioned using symbols in the paper (e.g., $\\hat{\\Phi}$ is not mentioned up to page 4). \n* Some symbols are loosely defined or mentioned before formally defined; e.g., $\\hat{\\mathcal{H}}_d$ is mentioned before the formal definition of \\hat{H}_{\\Gamma}. \n* Presentation of technical results could be improved. For instance, Proof Sketch of Theorem 1 only decomposes Theorem 1 into two parts, repeating what is mentioned in the remark, and thus could be omitted. \n* For Proposition 1, the authors might want to check Chapter 11 of \"An Introduction to the Theory of Reproducing Kernel Hilbert Spaces\" by Paulsen and Raghupathi.  \n* Using the same symbol for different density functions is confusing ($p(a)$ and $p(x)$). \n* Section 5. The term \"strong\" augmentation is obscure. One may consider an augmentation distribution that is independent of $x$, in which case the augmentation complexity is 1. Is the dependency between $A$ and $X$ considered a measure of \"strong\"?"
                },
                "questions": {
                    "value": "* (9) requires a suitable regularisation that depends on $B$ and $\\varepsilon$. In some sense, the analysis addresses a well-specified case. What happens if this is violated? \n* (12): Why is $G^{-1/2}$ required?\n* \"As shown in Wang et al. (2022b), there is...\": Is this an existence statement?"
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "5: marginally below the acceptance threshold"
                },
                "confidence": {
                    "value": "2: You are willing to defend your assessment, but it is quite likely that you did not understand the central parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 2,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission3894/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1699302334680,
            "cdate": 1699302334680,
            "tmdate": 1699636348291,
            "mdate": 1699636348291,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "awwE1oanbq",
                "forum": "Ax2yRhCQr1",
                "replyto": "7TGEzRJfwi",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission3894/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission3894/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Author Response"
                    },
                    "comment": {
                        "value": "Thank you for your review. We have uploaded a new version of our paper and we invite the reviewer to check it out. We would like to answer to your questions as follows:\n\n**Clarity**: Thank you very much for this feedback! We agree that our paper is on the denser side and needs to be improved in terms of clarity. We have updated the paper based on the comments from the reviewers, including notation clarification, added illustrative examples, and rephrasing. Please let us know if there are further changes that you would like to see; we do hope our paper provides sufficient background to be self-inclusive, and would really appreciate your feedback.\n\n\n### Significance\n1. **Motivation and necessity of Assumption 1**: First, we\u2019d like to note that assuming the target function to belong to some function class is a necessity (rather than a convenience) for proving any nonparametric learning guarantee, and an RKHS is a common choice in lots of prior work. Second, in our Proposition 1 we show a duality between the eigenfunctions on $A$ and the eigenfunctions on $X$, and this essentially says that working with $A$ is equivalent to working with $X$ up to an invertible transformation. Please also refer to our discussion on Assumption 1 in Appendix A for more details.\n\n2. **Clarification on the arbitrary encoder**: We apologize for the confusion. What we meant is that $\\hat{\\Phi}$ over $A$ can be an arbitrary function, while $\\hat{\\Psi}$ over $X$ is always defined as the average encoder of $\\hat{\\Phi}$ in this work. As we mentioned in Section 3, in practice during upstream people train $\\hat{\\Phi}$ instead of $\\hat{\\Psi}$, so they can use any model of any size and any architecture. We made this point clearer in Section 3 of the updated pdf.\n\n3. **Interpreting the soft invariance**: The soft invariance is almost equivalent to Assumption 1.1 in Johnson et al. (2023), except that it adds a $\\lVert g^* \\rVert _{P _A}^2$ on the right so that it is homogeneous; we have clarified this in the updated pdf. Essentially, the soft invariance says that if $A, A\u2019$ are augmented from the same original sample $X$, then the predictor would give them similar predictions. Similar conditions have appeared in lots of prior work, including Haochen et al. 2021; Saunshi et al. 2022; Johnson et al. 2023.\n    - Could the reviewer please clarify which equation they are referring to by \u201c$E[g(A) | x]$ and $g(a)$ are functions on different sets\u201d? We couldn\u2019t find in which equation we are comparing functions of different spaces.\n\n4. **Dimensionality dependency**: We\u2019d like to reemphasize that this dependency is a common issue and not a peculiar problem of our paper, as discussed in Section 5.1 and Section 6. Specifically, note that the more well-known model complexity based generalization bounds also cannot evade the curse of dimensionality. \n### Comments\nWe would also like to thank the reviewer for the comments, and we have updated the paper accordingly. Two further clarifications:\n- **\"Strong\" augmentation**: the strength of an augmentation is determined by the joint distribution over $A$ and $X$, and can be quantitatively measured by the augmentation complexity introduced in this work. The reviewer pointed out that if $A$ and $X$ are independent, then the augmentation complexity is 1. This is correct, but please note that in practice any meaningful $A$ should depend on $X$ since $A$ is \u201caugmented\u201d from $X$, and hence the two should never be independent.\n- Regarding Chapter 11 of the book by Paulsen and Raghupathi, could you please specify which results in Chapter 11 we should focus on?\n\n\n### Questions\n1. **How to implement Eqn. (9) if the exact values of $B$ and $\\epsilon$ are unknown**: thank you for the good question! In practice, one only needs to have an estimated upper bound $M$ of $\\frac{ B }{ \\sqrt{1-\\epsilon} }$, and our bound of $\\lVert \\hat{f} - f^* \\rVert$ is $O(M)$, so it will not make too much difference if $M$ has the same order as $\\frac{ B }{ \\sqrt{1-\\epsilon} }$. This is the common practice for least-squares regression, including kernel ridge regression, where one doesn\u2019t know the theoretical optimal regularization coefficient but uses an estimated value instead.\n\n2. **Why is $G^{-1/2}$ required**: $G^{-1/2}$ is used for normalization. We added this clarification in the updated pdf.\n\n3. **\u201cAs shown in Wang et al.\u201d**: This is not an existence statement. We meant that Wang et al. showed this equation; we have edited this sentence in the updated pdf.\n\n\nWe hope that this response has addressed all your questions and concerns. The reviewer writes a very detailed, thoughtful and constructive review, which we really appreciate. We welcome the reviewer to have further discussions with us."
                    }
                },
                "number": 3,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission3894/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700249039461,
                "cdate": 1700249039461,
                "tmdate": 1700249039461,
                "mdate": 1700249039461,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "0eBh5h5nZg",
                "forum": "Ax2yRhCQr1",
                "replyto": "7TGEzRJfwi",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission3894/Reviewer_kPdq"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission3894/Reviewer_kPdq"
                ],
                "content": {
                    "title": {
                        "value": "Quick response"
                    },
                    "comment": {
                        "value": "Thank you to the authors for the detailed response -- I will have a closer look. \nPlease let me share a quick (and minor) response. \n\nFirst of all, we don't have an individual response Reviewer to dUJ6. Is this okay?\n\nRe: Chapter 11 of the book by Paulsen and Raghupathi, Section 11.2 in this chapter treats the RKHS defined by an integral operator (the range space construction), and so Proposition 11.1 is an instance of this. Also there are some superfluous notation and symbols (e.g., do we really need to display the Radon-Nikodym derivative, given that we have a concrete density function and don't use measure theoretic results?). \n\nRe: soft-invariance, the following comment is not that important, but I just want to clarify what I meant (and the reason I found the term soft-invariance a bit weird). I do not expect a response to this comment. \n\nMy understanding of (1) is that this inequality controls the conditional variance of $g$ (averaged over x), and my comment is based on this interpretation. \nif a function is (exactly) invariant under some transformation, then we should expect the transformed function lies in the same set (i.e,, if $\\tilde{g}$ is the transformed version of $g$, then we expect $\\tilde{g} = g$ if $g$ is invariant). \nIf the transformation is taking conditional expectation, then $g$ cannot be invariant since the conditional expectation maps $g$, which is a function of $a$, to a function of $x$. If $\\mathcal{A}=\\mathcal{X}$, I think calling the assumption soft-invariant makes sense, in that $g$ is invariant with respect to the Markov kernel (the conditional expectation); that is $g$ is soft-invariant as a function of $x$, if the distance between $\\tilde{g}$ and $g$ is small, where $\\tilde{g}(x) = \\int g(x') P(d x'|x) $ with $ P(d x'|x) $ the augmentation distribution."
                    }
                },
                "number": 5,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission3894/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700252782105,
                "cdate": 1700252782105,
                "tmdate": 1700252975053,
                "mdate": 1700252975053,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "dD8WwpAQ52",
            "forum": "Ax2yRhCQr1",
            "replyto": "Ax2yRhCQr1",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission3894/Reviewer_umfH"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission3894/Reviewer_umfH"
            ],
            "content": {
                "summary": {
                    "value": "The paper builds upon recent work on self-supervised representation learning to study the effect of augmentation on the generalization properties. The key insights are that 1) augmentation can be seen as introducing a natural kernel $K_X$ between the inputs, kernel which has to be estimated based on the unlabeled data, 2) the labeled data serves then to find a linear predictor, whose generalization performance is bounded by the authors, with a bound that crucially depends on some quantities related to the augmentation procedure. The main point for the proof is an assumption, called 'isometry' (w.r.t. the augmentation) by the authors, on the optimal solution. Numerical experiments on estimating these quantities are then performed."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "2 fair"
                },
                "contribution": {
                    "value": "3 good"
                },
                "strengths": {
                    "value": "I appreciated the goal of the paper and that it improves on the presentation of some of its competitors. The discussions and remarks were enlightening and I chuckled when reaching the Appendix (A, B) to see the anticipation of some of my questions or critiques. The article clearly involved some work and the literature review appears quite adequate. The presence of the experiments nicely complements the theoretical part, justifying in particular the interest of introducing $\\kappa$ in the analysis."
                },
                "weaknesses": {
                    "value": "The key proof element is Assumption 1. I wished Section 2.1 was written differently so as to improve its clarity, emphasizing the assumptions that really matter based on my understanding, that is 1) $\\Gamma \\Gamma^*$ is Hilbert-Schmidt 2) eq. (8) + $f^* \\in R(\\Gamma^*)$ rather than the more obscure (1) or Ass.1. The writing of Proposition 1 can be definitely improved.\n\nI think the comparison with the source condition of Cabannes et al. could be more developped since the authors' assumption ($f^* \\in R(\\Gamma^*)$) looks quite similar. I looked for the formula corresponding to (1) in HaoChen et al. but could not find it. Also the final predictor of Definition 1 used a bound constraint on the norm, I am not sure whether it is common in some literature since I am used rather to regularized versions. These formulations require better justification I would say. I also have doubts with the comparison with the RIP."
                },
                "questions": {
                    "value": "- Which formula corresponding to (1) can be found in HaoChen et al.?\n- Can you quote some articles that used a bound constraint on the final predictor as you do? In general imposing constraints simplifies proofs, is this reason of your choice?\n- Can you give examples of augmentations that do not lead to $\\int K_X(x,x) dp(x) <\\infty$? $p(a|x)=\\delta_x$ for instance? Similarly, give some examples where $\\Gamma \\Gamma^*$ is clearly Hilbert-Schmidt (Gaussian blur I guess)? I ask this because it is not a given that $K_X(x,x)\\in\\mathbb{R}$ in my opinion. There are kernel integral operators that are not related to RKHSs.\n- Is it true that (8) implies that $u_i \\approx 0$ for $\\lambda_i < 1-\\epsilon$? It seems to me to be the case. Eq.(8) can then be interpreted as requiring that $f^*$ is mostly encoded only on the first eigenvalues of $\\Gamma \\Gamma^*$, in other words that it is 'simple/low dimensional', and that has little to do with RIP I would say. Please discuss further this aspect, and if possible suggest a reformulation of Sec 2.1.\n\nI would upgrade my score if these questions and those of the other reviewers are answered.\n\nThe authors could underline that Cabanes et al. also restrict themselves to the quadratic loss despite the contrastive inspiration coming from classification, and use the arguments in Cabanes et al. to justify it through calibration.\n\nMinor:\n- p2 please add some context words, 'upstream/unlabeled', 'downstream/labeled' to simplify the reading for non-experts.\n- p3 last line $\\phi$ not $\\phi(a)$ which are values\n- p4 'the the'\n- Quoting Forrest Gump, ``my mama always said'' never to start a sentence with a mathematical expression."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "6: marginally above the acceptance threshold"
                },
                "confidence": {
                    "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                },
                "first_time_reviewer": {
                    "value": "Yes",
                    "readers": [
                        "ICLR.cc/2024/Conference/Program_Chairs",
                        "ICLR.cc/2024/Conference/Submission3894/Senior_Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission3894/Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission3894/Reviewer_umfH"
                    ]
                }
            },
            "number": 3,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission3894/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1699528632731,
            "cdate": 1699528632731,
            "tmdate": 1699636348207,
            "mdate": 1699636348207,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "HF19ov1zKt",
                "forum": "Ax2yRhCQr1",
                "replyto": "dD8WwpAQ52",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission3894/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission3894/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Author Response"
                    },
                    "comment": {
                        "value": "Thank you for your review. We have uploaded a new version of our paper and we invite the reviewer to check it out. We would like to answer to your questions as follows:\n\n### Comments\n1. **Improving the clarity of Section 2.1**: Thank you for the suggestion! Please note that we have largely revised Section 2.1, including adding an example of BERT that explains the notations, clarifying Eqn. (1), revising Proposition 1, and a new remark after Eqn. (8).\n\n2. **Comparing to Cabannes et al. (2023)**: As we mentioned in Section 6, the main difference is that Cabannes et al. (2023) assumed the function class to be a subset of $H$, which is the RKHS of a __pre-selected__ kernel $K$ (which they said is determined by the model architecture). On the other hand, the main goal of this work is to decouple the effect of model and augmentation, in order to derive model-free learning guarantees. As a result, our paper does not have a \u201cpre-selected kernel\u201d. The only element that is pre-selected in our work is the augmentation method, which gives rise to the kernels. This helps isolate the effect of augmentation, allowing us to investigate its precise role.\n\n3. **The connection between our isometry property and RIP**: Thank you for this great question. Our isometry property can be considered as a counterpart for RIP in infinite-dimensional functional spaces: RIP says that in finite-dimensional vector spaces, for a matrix $M$ and a vector $v$, $Mv$ preserves most variance of $v$, and therefore the classical method PCA finds the principal components that keep the most variance. Similarly, our isometry property says that $\\Gamma^* \\Gamma f^*$ preserves most variance of $f^*$ (the fraction of variance that is lost is less than $\\epsilon$). Regarding whether $f^*$ can be encoded by the top eigenfunctions depends on how fast the eigenvalues of $\\Gamma^* \\Gamma$ decay: If it is fast enough then this is true, otherwise this is false. We have largely revised Section 2.1. Please let us know if the new version is clearer.\n### Questions\n1. **Correspondence of Eqn. (1) in Haochen et al.**: We apologize for the confusion. We meant to say that the Laplacian over the augmentation graph was introduced in Haochen et al. (2021), and the same soft invariance condition was introduced in Johnson et al. (2023) in their Assumption 1.1. We have clarified this in Section 2.1 in the updated pdf.\n\n2. **Bound on the RKHS norm in the estimator**: The norm bound can be considered as a capacity constraint and is necessary for proving any guarantees; for reference, please see Chapter 13 of Wainwright (2019). In general, there are two typical ways of estimating the regression function in nonparametric least-squares estimation: either restricting the optimization problem to some appropriately chosen subset (usually needs to be bounded), or adding a regularizer as in kernel ridge regression. In our particular case, using a regularizer is the same as adding a constraint on the RKHS norm, as shown in Lemma 35 of Cabannes et al. (2023).\n3. **Unbounded kernels**: This is a good question. For our work,  $\\Gamma \\Gamma^*$ is Hilbert-Schmidt because $\\lVert K \\rVert_{\\infty}$ is bounded (by $\\kappa^2$). To the best of our knowledge, a bounded $\\lVert K \\rVert_{\\infty}$ is required by most statistical guarantees of kernel methods, from classical ones to more recent results. For examples of unbounded kernels and kernels not associated with an RKHS, please see Chapter 4 of Christmann and Steinwart (2008), as well as other papers from Ingo Steinwart. However, the learning guarantees provable for unbounded kernels are very limited, and they are far beyond the scope of this work.\n4. **Is $u _i \\approx 0$ for $\\lambda _i < 1 - \\epsilon$?**\n    - Not necessarily, and here is a simple example: Suppose $\\lambda _1 = 1$ and $\\lambda _2 = 1 - \\epsilon - \\alpha$, for some very small $\\alpha > 0$. And all other eigenvalues are 0. Then, Eqn. (8) is equivalent to $ \\frac{\\alpha}{1 - \\epsilon - \\alpha} u _2^2 \\le \\epsilon u _1^2 $, which holds as long as $\\frac{u _2^2}{u _1^2} \\le \\frac{\\epsilon (1 - \\epsilon - \\alpha)}{\\alpha}$. Thus, $u _2$ can be very large, even much larger than $u _1$ if $\\alpha$ is very small. \n    - Moreover, $f^*$ is not necessarily low-dimensional. For example, if $\\lambda _1 = 1$ and $\\lambda _2 = \\lambda _3 = \\cdots = \\lambda _{1000} = 1 - \\epsilon - \\alpha$, then with the same argument, $f^*$ can have 1000 dimensions.\n\nThank you also for the detailed writing suggestions in your minor comments. We have updated the draft accordingly.\n\nWe hope that this response has addressed all your questions and concerns. The reviewer raises some great questions which we really appreciate, and we welcome the reviewer to have further discussions with us."
                    }
                },
                "number": 2,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission3894/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700248774108,
                "cdate": 1700248774108,
                "tmdate": 1700248774108,
                "mdate": 1700248774108,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "tGwtlm1Awx",
            "forum": "Ax2yRhCQr1",
            "replyto": "Ax2yRhCQr1",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission3894/Reviewer_tXrm"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission3894/Reviewer_tXrm"
            ],
            "content": {
                "summary": {
                    "value": "The work provides a statistical analysis of augmentation-based pretraining using the so-called augmentation operator. This operator is naturally introduced and several properties of this operator are stated. Upper and lower error bounds, which apply to arbitrary encoders, are derived. The augmentation complexity is emphasized as a central object contributing to error analysis in both learning and augmentation."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "2 fair"
                },
                "contribution": {
                    "value": "4 excellent"
                },
                "strengths": {
                    "value": "The paper gives a structured foundation for augmentation based learning. The augmentation operator is well motivated and its central role is well highlighted. The obtained error bounds show, in a good way, a separation in the contribution of the model and the augmentation. The analysis seems rigorous and, personally, I find the appearance of the spectral properties of the augmentation intriguing."
                },
                "weaknesses": {
                    "value": "-I find the text very dense and compressed; and thus not easy to read. I acknowledge that the task of fitting the results and concepts in the 9 page limit is difficult. Therefore, I would suggest that the authors consider whether the text is better published in a journal with fewer page restrictions.\n-Some concepts could be motivated more. That is particularly helpful for readers less familiar with the topic\n-I find, that the assumptions and notations should be pointed out more clearly (see questions)"
                },
                "questions": {
                    "value": "General remarks\n\n-The assumptions and notations should be pointed out more clearly. For instance\n\n       -it seems it is assumed, but I did not see it stated explicitly, that $P_\\mathcal{A}$ has a density, and that $p(a|x)$ and $p(x|a)$ exist.\n\n       -What is A in E(g(A)|x). Similarly, X is not defined as a random variable (it is clear from the context but should be defined).\n      \n       -The notational difference between $p$ and $p(\\cdot,\\cdot)$ is small.\n\n-Is $\\hat{\\psi}$ always assumed to be of the form (10) or is (10) just an example?\n\n-Can you explain the choice of the distribution $P_{AX}$ a bit more? Particularly, it could be emphasized how the conditional distribution $P(\\cdot |x)$ has to be given. You can refer to the given examples.\n\n-Can your approach be used to build or suggest an augmentation-based pretraining? Maybe under assumptions on prior information on the distribution $P_X$?\n\n-Proposition 1, (iv): What does it mean that g* satisfies Assumption 1? Assumption 1 is an Assumption on $f^* \\in \\mathcal{L}^2(P_X)$, or does the statement in (iv) refer to (1)? The proof of statement (v) is done in the proof of statement (iv); I think those parts can be moved to the proof of statement (v).\n\n-In (1), how are A and A' drawn from $p(\\cdot |x)$? A motivation for (1) would be helpful. The space $\\mathcal{F}_B(\\Gamma;\\epsilon)$ is a central object, it would be good to motivate it more.\n\n-Can Assumption 1 be verified; is it a restrictive assumption?\n\n-Can $\\epsilon$ or violation of Assumption 1 be inferred during the learning process?\n\n-Definition 3: Is $G^{-1}$ well-defined, even if $d = \\infty$?\n\n-Remark after Lemma 2: What is $\\|\\cdot\\|_n$?\n\n-How is $d$ chosen? Equation (20) would motivate to choose $d$ such that there is a large gap between $\\lambda_d$ and $\\lambda_{d+1}$, but your result improves such a guess for $d$ compared to HaoChen21 and Saunshi22.\n\n-Is $\\bar{\\phi}$ an eigenfunction of $\\Gamma^*\\bar{\\Gamma}$? If so, how restrictive is the condition $\\hat{\\phi} = \\bar{\\phi}$; is this just the choice of the encoder?\n\n-It is good to see a separation of model and augmentation in the error analysis. Do you think a combination, for instance, through augmentation based on the model, can be fruitful, too?\n\n-Does Lemma 9 need a condition on boundedness of the matrix $QDQ^T$ or absolute convergence of the sum $\\sum\\limits_{i = 1}^\\infty \\lambda_i q_i^T q_i$?\n\n\nMinor comments:\n\n-Did you compute the ``sweet spot\" mentioned in the introduction? Can it be computed?\n\n-In Section 2.1 some reference for conditional expectation and RKHS could be added.\n\n-Proof of Proposition 1: The proof should also contain showing that $\\mathcal{H}_\\Gamma$ is complete.\n\n-Are $K_X$ and $K_A$ square integrable? It seems so from (4) and necessary from the proof of the statement that $\\Gamma^*\\Gamma$ and $\\Gamma\\Gamma^*$ are integral operators. Are conditions on P_AX$ needed that (4) holds?\n\n-Below Definition 2: I don't think that convexity of $D_{\\chi^2}$ is needed because the bound $S_\\lambda\\leq \\kappa^2$ follows from (11), via $\\kappa^2 \\geq K_X(x,x) = S_\\lambda$.\n\n-First sentence of Section 3: Assumption 1 could be mentioned to recall the bound for $\\|f^*\\|$ in $H_{\\Gamma}$.\n\n-Lemma 5: Below Lemma 5, it is mentioned that the required 4th order bound holds. Why is the condition for such a bound included in the statement of the lemma?\n\n-Around Definition 2 you can refer to Examples 1,2,3 for examples of the augmentation complexity.\n\n-Are there exponential lower bounds on $\\kappa$ in Examples 2,3?\n\nTypo: Page 4: \"the the\", the word ``the\" was used two times"
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "6: marginally above the acceptance threshold"
                },
                "confidence": {
                    "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                },
                "first_time_reviewer": {
                    "value": "Yes",
                    "readers": [
                        "ICLR.cc/2024/Conference/Program_Chairs",
                        "ICLR.cc/2024/Conference/Submission3894/Senior_Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission3894/Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission3894/Reviewer_tXrm"
                    ]
                }
            },
            "number": 4,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission3894/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1699532232321,
            "cdate": 1699532232321,
            "tmdate": 1699636348116,
            "mdate": 1699636348116,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "qgBmUsfEB1",
                "forum": "Ax2yRhCQr1",
                "replyto": "tGwtlm1Awx",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission3894/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission3894/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Author Response"
                    },
                    "comment": {
                        "value": "Thank you so much for your detailed review! We have uploaded a new version of our paper which we invite you to check out. \n\n### General remarks\n1. **Notations**: We added a concrete example in Section 2, which clarifies how $P _{AX}$ can be chosen. Regarding your questions:\n    - $P _A$, $p(a|x)$ and $p(x|a)$: In Section 2.1, paragraph 2: \u201cData augmentation induces a joint distribution $P _{AX}$, with marginal distributions $P _A$ and $P _X$\u201d. Thus, $P _A$ exists from marginalization, similarly for $p(a|x)$ and $p(x|a)$.\n    - $A$ and $X$: All capital letters (in normal font) are random variables; we have added this clarification.\n    - $p$: In the updated pdf, we changed $p(x)$ to $P _X (x)$, and $p(a)$ to $P _A (a)$. The remaining $p(\\cdot)$ should be clear from context.\n    -  $A, A\u2019, F _B(\\Gamma; \\epsilon)$: $A, A\u2019$ are two augmentations from the same original sample $X$. $F _B(\\Gamma; \\epsilon)$ comes from the soft invariance similar to prior work.\n2. **Definition of $\\hat{\\Psi}$**: We would like to clarify that what we mean by \u201carbitrary\u201d in Section 3 is that $\\hat{\\Phi}$ can be an arbitrary function; And in this work $\\hat{\\Psi}$ is always the average encoder of $\\hat{\\Phi}$ defined by Eqn. (10). As we mentioned before Eqn. (10), in practice during upstream people train $\\hat{\\Phi}$ instead of $\\hat{\\Psi}$, so they can use an arbitrary encoder of any size and architecture. \n3. **Suggesting new augmentations**: Our method can compare between augmentations, but new augmentations depend on human prior knowledge of the downstream task.\n4. **Whether Assumption 1 can be verified**: While it is not practically easy to find the exact value of $\\epsilon$ to verify Assumption 1, we noted after Eqn. (8) that the exact value of $\\epsilon$ does not affect the fact that the top-d eigenfunctions is optimal.\n5. **Is $G^{-1}$ well defined**: $\\hat{\\Phi}$ is explicitly assumed to be full-rank (see the paragraph above Definition 3), so $G^{-1}$ is well-defined. We have added clarifications in the updated pdf.\n6. **What is $\\lVert \\cdot \\rVert _n$**: This notation is not used in the main body, but only in our proof. We have moved this to the appendix.\n7. **Choose d with a large gap between $\\lambda _d$ and $\\lambda _{d+1}$**: We would like to clarify that a large gap between $\\lambda _d$ and $\\lambda _{d+1}$ is not necessary for our results. In fact, this is one of our major improvements over Haochen et al. (2021) and Saunshi et al. (2022). Their bounds depend on $(\\lambda _d - \\lambda _{d+1})^{-1}$. However, in reality $\\lambda _d$ decays quite fast, so this gap is usually much smaller than $\\lambda _d$. e.g. see Figure 1 of https://openreview.net/pdf?id=ByxY8CNtvr. Meanwhile, our bound does not depend on this gap but only $\\lambda _d^{-1}$. Also, we are not suggesting practitioners to \u201cguess for $d$\u201d using our bounds. After all, our results are just upper bounds, not the real test error.\n8. **Regarding $\\hat{\\phi} = \\bar{\\phi}$**: In Section 4, we study the special case $\\hat{\\phi} = \\bar{\\phi}$, the Monte-Carlo approximation of the optimal encoder. This is not a restriction, but rather an interesting special case because many popular self-supervised learning methods amount to this, as pointed out in Appendix C.\n9. **Combining augmentation and model**: Yes, combining the augmentation complexity based bounds in this work, and previous model complexity based bounds, can lead to tighter bounds, as we discussed in Appendix A.\n10. **Lemma 9**: $Q D _{\\lambda} Q^{\\top}$ is a $d \\times d$ matrix where $Q, D$ are both bounded entrywise, hence the product $Q D _{\\lambda} Q^{\\top}$ is also bounded.\n### Minor comments\n1. **How to find the \u201csweet spot\u201d in augmentation strength**: We consider this as mainly an empirical observation determined by validation, demonstrated in Figure 3(c). \n2. **Reference for RKHS**: Added in Section 2.2.\n3. **Are $K_X, K_A$ square integrable**: Yes: $K _X$ is assumed to be square integrable after Eqn. (4), and $K _A$ is square integrable due to Proposition 1.\n4. **Fourth moment condition in Lemma 5**: Lemma 5 is a general result for any $\\hat{\\phi}$, so it needs the fourth moment condition. Lemma 6 and Theorem 2 considers the special case $\\hat{\\phi} _i = \\bar{\\phi} _i$, and the fourth moment condition holds for this special case. We have added this clarification.\n5. **Exponential lower bounds for $\\kappa$**: There is no exponential lower bound. $\\kappa$ can be polynomial if the augmentation is very strong; for example, in supervised pretraining where each sample is \u201caugmented\u201d to its upstream class.\n\nWe have also adopted your other suggestions, including updating (iv) and the proof of proposition 1, referring to examples 1-3 around Definition 2, revising the sentence after Definition 1, recalling $\\lVert f^* \\rVert$ in Section 3, etc.\n\nThank you again such a detailed, thoughtful and constructive review. We hope that we have addressed your questions and concerns, and welcome any further discussions."
                    }
                },
                "number": 1,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission3894/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700248478265,
                "cdate": 1700248478265,
                "tmdate": 1700248478265,
                "mdate": 1700248478265,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "5qIz4sxm22",
                "forum": "Ax2yRhCQr1",
                "replyto": "tGwtlm1Awx",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission3894/Reviewer_tXrm"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission3894/Reviewer_tXrm"
                ],
                "content": {
                    "title": {
                        "value": "Response to authors"
                    },
                    "comment": {
                        "value": "My comments and remarks have been well addressed. Thank you to the authors.\n\nThe notations have been adapted and clarified. My questions have been mostly answered. I still have three (whose responses do not need to be included in the paper)\n\n1. Concerning \"Suggesting new augmentations\": Thank you for your response. I would like to continue shortly on this subject. Once one is able to compare between different augmentations one can choose the best. This is why I was wondering if your bounds give rise to suggestions for augmentation, too.\n\n2. I find particularly interesting one of the concerns of reviewer dUj6 on the condition about where $f^*$ lives. I have read the authors' response to the question by reviewer dUj6 and it made me wonder if the case $f^* \\notin H$ just adds an additional simple term to the error analysis (such as $err(f^*,\u2026) = err_H(f,\u2026) + \\vert\\vert f-f^*\\vert\\vert_V$ where $V$ is a space with less regularity (making it more likely to have $f^* \\in V$ than having $f^* \\in H$) and $f$ is a (well-chosen) element in $H$.\n\n3. Why would the authors not suggest using their analysis to \u201cguess d\u201d? Does it relate to tightness of the error bounds?"
                    }
                },
                "number": 15,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission3894/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700584193958,
                "cdate": 1700584193958,
                "tmdate": 1700584373479,
                "mdate": 1700584373479,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "YYk6rZnF73",
                "forum": "Ax2yRhCQr1",
                "replyto": "tGwtlm1Awx",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission3894/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission3894/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Author Response"
                    },
                    "comment": {
                        "value": "Thank you for your discussion! We are glad that our previous response has answered most of your questions. We would like to respond to your new comments as follows:\n1. **Suggesting new augmentations**: This is a great question. Let us provide a rough argument: For example, our analysis could explain why patchifying and discretizing an image into tokens (such as in ViT) is a good idea compared to pixel-level augmentation. For MAE, if we directly mask an image at the pixel level, then this augmentation is almost disjoint (as pointed out by Saunshi et al. 2022), and thus is quite bad. With patchifying and discretizing, we can make the masking augmentation less disjoint and thereby lower its augmentation complexity, leading to better generalization. Similarly, this argument could explain why discretizing techniques such as VQ-VAE or VQ-GAN can be helpful. Fully justifying this argument would require an extensive empirical study, which we leave to a future paper.\n\n2. **What if $f^{\\star}$ does not belong to $H$, but is very close to $H$?** We have a discussion on this question in Appendix A. Here we\u2019d like to provide a more detailed discussion. The short answer to your question is: Assuming $f^*$ belonging to some function class is inevitable, but it is indeed possible to relax $f^* \\in H$ such that $f^*$ belongs to some larger class, under some extra assumptions.\n    - First, we have to assume that $f^*$ belongs to *some* function class, which usually requires $\\lVert f^* \\rVert _{\\infty}$ to be bounded. Only assuming $f^*$ is close to $H$ is not sufficient for proving any bound. For example, for $f^* \\in H$, suppose we add a tiny perturbation $f^* \\rightarrow \\tilde{f}^*$, such that $\\tilde{f}^*$ is unbounded on a subset $X _0$ whose measure is very small but positive. Then, even though $\\lVert f^* - \\tilde{f}^* \\rVert _{L^2(P _X)}$ can be very small, we still cannot prove any bound unless no training sample belongs to $X _0$, whose asymptotic probability is 0 when there are infinitely many samples. Basically, a single training sample from $X _0$ would have an uncontrollable effect on the predictor. \n    - Second, relaxing \u201c$f^* \\in H$\u201d is possible: We can assume that $f^*$ belongs to some larger function class. One such relaxation was done by Fischer & Steinwart (2020), who considered the \u201cpower spaces\u201d $H^p$. The smaller $p$ is, the larger $H^p$ will be. And for $p < 1$, $H^p$ is not necessarily an RKHS, but still a separable Hilbert space. The reviewer could intuitively think of $H^p$ as the RKHS of $K^p$, assuming that $H^p$ is an RKHS. Then, Fischer & Steinwart proved tight statistic bounds under the assumptions that $f^* \\in H^p$, the eigenvalues of $H$ decay fast enough, and $\\lVert f^* \\rVert _{\\infty}$ is bounded (this is still inevitable). \n\nFrom a theoretical perspective, $f^* \\in H$ is indeed relaxable, but we feel that such relaxation would provide little extra help for people to understand the role of augmentation. That\u2019s why in this work, we just assume that $f^* \\in H$.\n\nFischer & Steinwart. Sobolev Norm Learning Rates for Regularized Least-Squares Algorithms. 2020.\n\n3. **Why we are not suggesting to \u201cguess d\u201d**: In this work, we show the following trade-off controlled by $d$: A smaller $d$ leads to larger approximation error because the encoder has lower representational capacity, but a larger $d$ leads to larger estimation error because the encoder contains more noise, and thus gives rise to a higher downstream sample complexity. We do not claim that we can estimate the best $d$ that minimizes `real approximation error + real estimation error`, because what we have proved are upper bounds, and the $d$ that minimizes `approximation error bound + estimation error bound` need not to be the optimal $d$, even if the bounds are tight. \n    - In statistical learning, \u201can upper bound is tight\u201d is usually in a minimax sense, which means that one can prove a lower bound by constructing an example of a very bad task, and the upper bound is tight if it coincides with this lower bound on this worst-case example. But real tasks are rarely worst-case, so the upper bound can rarely match the real test error on a real task. This is why we cannot claim that we can estimate the best $d$ just with our upper bounds, even if they are extremely tight.\n\nWe are very happy to have further discussions with you, thank you again!"
                    }
                },
                "number": 16,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission3894/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700602807424,
                "cdate": 1700602807424,
                "tmdate": 1700624778188,
                "mdate": 1700624778188,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    }
]