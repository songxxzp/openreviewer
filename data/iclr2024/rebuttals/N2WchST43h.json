[
    {
        "title": "A Sublinear Adversarial Training Algorithm"
    },
    {
        "review": {
            "id": "2uzSC29lw2",
            "forum": "N2WchST43h",
            "replyto": "N2WchST43h",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission6712/Reviewer_5dfS"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission6712/Reviewer_5dfS"
            ],
            "content": {
                "summary": {
                    "value": "The authors consider fully connected one hidden layer neural networks with shifted ReLU activations and develop an adversarial training algorithm with cost $o(mnd)$ per iteration by applying half-space reporting data structure. To do that, the authors rely on three main techniques:\n1. approximation via pseudo-network sufficiently precise with high probability\n2. using shifted ReLU functions instead of standard ones to attain $o(mnd)$ time complexity per training iteration\n3. use a tree data structure to find the neurons that need updating more quickly (Half-space reporting)\n\nThe algorithm consists of a loop that first calculates the adversarial training set and the indices of the activated neurons for each element of the training set, then doing a gradient update for all active neurons. A series of theorems and lemmata are presented, analyzing the proposed algorithm, which is followed by a time complexity analysis. The reviewer did not check the proofs in the appendix."
                },
                "soundness": {
                    "value": "2 fair"
                },
                "presentation": {
                    "value": "1 poor"
                },
                "contribution": {
                    "value": "2 fair"
                },
                "strengths": {
                    "value": "- Adversarial training algorithms and their analysis is an important problem in the field of adversarial robustness. \n- The assumptions seem reasonable."
                },
                "weaknesses": {
                    "value": "- The relevance of the paper remains unclear. Is it theoretically relevant or also practically?\n- The restriction to 1 hidden layer networks is strong. \n- The Paper is hard to read, the reasoning jumps back and forth. The reviewer recommends a thorough rewrite. It would be good if the authors first introduce concepts and then use them. An example is the \"query, insert, remove\" from the data structure in Algorithm 1 (Page 6) that gets introduced in Section 5 (Page 8). Similarly, Theorem 1.1 (Page 2) has a reference to Equation 2 (Page 4). The paper seems to be rushed, also reads that way. \n\nTypos:\n\t- 3.1 the typesetting of $\\ell_p$ \n\t- The inequality in Theorem 4.1 seems to be the wrong way round. \n\t- In theorem 4.3: \"$T = \\Theta(\\epsilon^{-2} K^2)$. in Algorithm\""
                },
                "questions": {
                    "value": "- Are the contributions of the paper mainly of theoretical or also practical interest? Can the algorithm be efficiently parallelized? Are efficient vectorized/GPU implementations possible? What are the memory requirements of the algorithm? \n- Page 3: what is the definition for an $\\epsilon$-net?\n- What about deeper networks? On an intuitive level, the reviewer does not see a reason that the complexity should worsen there."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "3: reject, not good enough"
                },
                "confidence": {
                    "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 1,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission6712/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698747923120,
            "cdate": 1698747923120,
            "tmdate": 1699636771302,
            "mdate": 1699636771302,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "Wm2TfxV0eL",
                "forum": "N2WchST43h",
                "replyto": "2uzSC29lw2",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6712/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6712/Authors"
                ],
                "content": {
                    "comment": {
                        "value": "Thank you for your meticulous review and valuable suggestions. We will revise the typos in the next version. We would like to respond to your questions respectively:\n1. Our paper is theoretically relevant and analyzes the convergence guarantee of adversarial training procedures on a two-layer neural network with shifted ReLU activation, demonstrating that only a sublinear number of neurons (o(m)) are activated for each input data per iteration\u200b and developing an algorithm for adversarial training with time cost o(mnd) per iteration by applying half-space reporting data structure.\n2. The generalization of our method to multiple layers is a very interesting question. However, as the main purpose of our submission is to build an algorithm with guaranteed performance and rigorous analysis, we focus on over-parametrized two-layer neural network, which is a common object studied in many recent works about neural tangent kernel [1,2,3,4,5,6] and theoretical papers about deep learning [7,8,9]. We also note that there are new empirical results on multi-layer neural network settings [10,11].  We highly appreciate such efforts and would make theoretical analysis of multiple-layer neural network settings our future work.  \n3. We thank you for pointing out the writing improvement suggestions. We will update the overall structure in the next version. \n\nAs for your questions:\n1. The contribution of this paper is a theoretical. The introduced half-space reporting data structure used in this paper will take additional $O(n \\log n)$ space [12] . To have an intuitive understanding of the level of such additional memory usage, we would point out that the weights of neural networks takes $O(n d)$ space. So when the neural network is over-parameterized, i.e., $d$ is very large, the additional memory usage by our algorithm is not the dominant term in space complexity.\n2. The definition of $\\epsilon$-net is defined as follows: Given a metric space $(X, d)$, a subset $Y$ of $X$ is said to be an  $\\epsilon$-net if\n\n    (i) For $a, b \\in Y$ , we have $d(a, b) \\ge \\epsilon$, and\n\n    (ii) For all $x \\in X$, there exists an $a \\in Y$ such that $d(x, a) < \\epsilon$.\n3. As for deeper NN, please refer to point (2) in the weakness part response.\n\n[1] Zeyuan Allen-Zhu, Yuanzhi Li, and Yingyu Liang. Learning and generalization in overparameterized neural networks, going beyond two layers. In NeurIPS. arXiv preprint arXiv:1811.04918, 2019a.\n\n[2] Arthur Jacot, Franck Gabriel, and Cl  \u0301ement Hongler. Neural tangent kernel: Convergence and generalization in neural networks. In Advances in neural information processing systems, pages 8571\u20138580, 2018.\n\n[3] Zeyuan Allen-Zhu, Yuanzhi Li, and Zhao Song. A convergence theory for deep learning via over-parameterization. In ICML, 2019b.\n\n[4] Zeyuan Allen-Zhu, Yuanzhi Li, and Zhao Song. On the convergence rate of training recurrent neural networks. In NeurIPS, 2019c\n\n[5] Yi Zhang, Orestis Plevrakis, Simon S Du, Xingguo Li, Zhao Song, and Sanjeev Arora. Over-parameterized adversarial training: An analysis overcoming the curse of dimensionality. Advances in Neural Information Processing Systems, 33:679\u2013688, 2020.\n\n[6] Simon S Du, Xiyu Zhai, Barnabas Poczos, and Aarti Singh. Gradient descent provably optimizes over-parameterized neural networks. In ICLR, 2019.\n\n[7] Zhong, Kai, et al. \"Recovery guarantees for one-hidden-layer neural networks.\" International conference on machine learning. PMLR, 2017.\n\n[8] Du, Simon, et al. \"Gradient descent finds global minima of deep neural networks.\" International conference on machine learning. PMLR, 2019.\n\n[9] Mei, Song, Andrea Montanari, and Phan-Minh Nguyen. \"A mean field view of the landscape of two-layer neural networks.\" Proceedings of the National Academy of Sciences 115.33 (2018): E7665-E7671.\n\n[10] Beidi Chen, Tharun Medini, James Farwell, Charlie Tai, Anshumali Shrivastava, et al. Slide: In defense of smart algorithms over hardware acceleration for large-scale deep learning systems. Proceedings of Machine Learning and Systems, 2:291\u2013306, 2020\n\n[11] Beidi Chen, Zichang Liu, Binghui Peng, Zhaozhuo Xu, Jonathan Lingjie Li, Tri Dao, Zhao Song, Anshumali Shrivastava, and Christopher Re. Mongoose: A learnable lsh framework for efficient neural network training. In International Conference on Learning Representations, 2021.\n\n[12] Pankaj K Agarwal, David Eppstein, and Jiri Matousek. Dynamic half-space reporting, geometric optimization, and minimum spanning trees. In Annual Symposium on Foundations of Computer Science, volume 33, pages 80\u201380. IEEE COMPUTER SOCIETY PRESS, 1992"
                    }
                },
                "number": 1,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6712/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700439977292,
                "cdate": 1700439977292,
                "tmdate": 1700441040208,
                "mdate": 1700441040208,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "thC8xtsDhA",
            "forum": "N2WchST43h",
            "replyto": "N2WchST43h",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission6712/Reviewer_RwpB"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission6712/Reviewer_RwpB"
            ],
            "content": {
                "summary": {
                    "value": "The paper proposes an adversarial training algorithm for 2-layer neural networks with ReLU activation that has sublinear o(mnd) per-iteration time complexity, compared to standard \u03a9(mnd). The result mainly relies on the insight that only o(m) neurons will be activated for each input data per iteration."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "2 fair"
                },
                "strengths": {
                    "value": "1. The paper presents some interesting result on analyzing per-iteration complexity of adversarial training of a special setting of 2-layer neural networks. Theoretical analyses are solid and insightful.\n2. Complexity of adversarial training is less analyzed compared with standard training, the work would be interesting to some researchers."
                },
                "weaknesses": {
                    "value": "1. Just like in many other works on 2 layer neural nets, it is unclear if the insight can generalize to the more common setting of deeper neural nets.\n2. It seems only optimal adversaries are analyzed (e.g., in theorem 4.4), but most cases it is impractical to have an optimal adversary."
                },
                "questions": {
                    "value": "Could authors provide some discussions on and thoughts on if the activation sparsity could generalize to deeper nets?"
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "6: marginally above the acceptance threshold"
                },
                "confidence": {
                    "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 2,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission6712/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698801011546,
            "cdate": 1698801011546,
            "tmdate": 1699636771168,
            "mdate": 1699636771168,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "CLdG3lrf3S",
                "forum": "N2WchST43h",
                "replyto": "thC8xtsDhA",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6712/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6712/Authors"
                ],
                "content": {
                    "comment": {
                        "value": "We deeply appreciate your insightful feedback and are grateful for the time you took to share it.\n\n1. This is a very interesting future direction. We also note that there are new empirical works on multi-layer neural network settings [1, 2] that find a similar phenomenon of sparsity that inspired this work.  We highly appreciate such efforts and would make theoretical analysis of multiple layer neural network setting as our future work.  \n2. We would point out that if the adversarial example construction is not optimal, it does not hurt the acceleration achieved by our algorithm. However, we also admit that if we are not using the optimal adversarial construction, then the error bound in Theorem 4.4 for weights will be worse. Depending on what specific assumptions we make for the non-optimal adversarial examples, e.g. we are using adversarial construction $A$ instead of the optimal one $A^*$, the error bound for $W$ will be correspondingly worse. \n3. As mentioned in point 1, some empirical works observe a similar phenomenon of sparsity in multi-layer neural networks. Hence the intuition might still be avoiding making redundant $0$-update for non-activated neurons. The major difficulty would then be designing new data structures that could efficiently maintain activated neurons during the adversarial training procedure, which we make as a very interesting future direction.\n\n\n[1] Beidi Chen, Tharun Medini, James Farwell, Charlie Tai, Anshumali Shrivastava, et al. Slide: In defense of smart algorithms over hardware acceleration for large-scale deep learning systems. Proceedings of Machine Learning and Systems, 2:291\u2013306, 2020\n\n[2] Beidi Chen, Zichang Liu, Binghui Peng, Zhaozhuo Xu, Jonathan Lingjie Li, Tri Dao, Zhao Song, Anshumali Shrivastava, and Christopher Re. Mongoose: A learnable lsh framework for efficient neural network training. In International Conference on Learning Representations, 2021."
                    }
                },
                "number": 4,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6712/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700440153020,
                "cdate": 1700440153020,
                "tmdate": 1700441125346,
                "mdate": 1700441125346,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "gaHxjw1ok4",
            "forum": "N2WchST43h",
            "replyto": "N2WchST43h",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission6712/Reviewer_Wuuy"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission6712/Reviewer_Wuuy"
            ],
            "content": {
                "summary": {
                    "value": "The authors propose an adversarial training algorithm designed for two-layer ReLU networks. Combining multiple techniques, they manage to prove that their algorithm runs in time sublinear in the size of the network."
                },
                "soundness": {
                    "value": "4 excellent"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "3 good"
                },
                "strengths": {
                    "value": "- The authors propose an interesting algorithm and manage to show that per iteration cost is sublinear in the size of the network for a two-layer ReLU network. The paper is very clearly written with detailed proofs in the appendix.  \n\n- The use of the techniques such as half-space reporting data structures and shifted ReLU in the design of the algorithm are interesting and instructive."
                },
                "weaknesses": {
                    "value": "- The current result seems to be more of a theoretical interest than a practical algorithm. The limitation of two-layer network, well-separation for adversarial loss are both severe limitations in practice. \n\n- There are also some unclear or missing details that need to be addressed in the Questions section below."
                },
                "questions": {
                    "value": "- Is there any assumption on the adversarial example oracle A in Algorithm 1? I don't seem be able to find any reference to its complexity analysis in the main paper. Usually adversarial examples are found by iterative projected gradient descent (on the input x) and their runtime should also be taken into account. \n\n- If we take away the adversarial example generation in Algorithm 1 and just use the input x_i as training example, we should then obtain a sublinear training algorithm for a two-layer ReLU network. I am wondering why the authors are focusing on adversarial training, or if there are any parts of the algorithm that are specific to the problem of adversarial examples. The 3 techniques listed in Section 2 are not specific to adversarial training."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "6: marginally above the acceptance threshold"
                },
                "confidence": {
                    "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 3,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission6712/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698817909782,
            "cdate": 1698817909782,
            "tmdate": 1699636771060,
            "mdate": 1699636771060,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "WS7Vk930xe",
                "forum": "N2WchST43h",
                "replyto": "gaHxjw1ok4",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6712/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6712/Authors"
                ],
                "content": {
                    "comment": {
                        "value": "Thank you for your valuable questions. We would revise the typos in the next version.\n1. We take standard adversarial example construction in our algorithm. So if we let $T$ denote the complexity for the adversarial example oracle, then the improvement our algorithm achieved is $o(nmdT)$ compared to standard algorithm $\\Omega(nmdT)$.\n2. As mentioned above, if we let $T=O(1)$, i.e., use $x_i$ as training example, then our algorithm achieves $o(nmd)$ compared to the well-known standard result $\\Omega(nmd)$."
                    }
                },
                "number": 3,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6712/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700440124540,
                "cdate": 1700440124540,
                "tmdate": 1700440124540,
                "mdate": 1700440124540,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "eQXU9WAf6G",
            "forum": "N2WchST43h",
            "replyto": "N2WchST43h",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission6712/Reviewer_yRgF"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission6712/Reviewer_yRgF"
            ],
            "content": {
                "summary": {
                    "value": "The paper tries to address the computational complexity of adversarial training in neural networks, which is an active research area.\nThe work addresses training efficiency by trading off extra memory for computation and incorporating an additional half-space data structure, efficiently identifying only the active neurons for computation. The key insight is that not all neurons are active for every input data point, enabling the computation of the dot product exclusively with the active neurons. While the method of initially identifying active neurons is not novel, the application of efficient geometric data structures is both new and promising. The research introduces an algorithm designed for this purpose; although it does not include experimental results, it does offer convergence proofs for two-layer networks."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "3 good"
                },
                "strengths": {
                    "value": "The approach is novel where adversarial training that leverages geometric data structures at the expense of extra space. It extends the direction of first identifying the active neurons and then only taking dot product with those neurons. \n\nThe paper is well written and however, without empirical results or illustrative examples, the clarity of the paper's practical implications could be enhanced.  \n\nThe work is significant as it has a potential to further improve the direction of efficient adversarial training of robust neural networks.\n\nI have not conducted an exhaustive review of the convergence proofs; however, upon initial examination, they appear to be correct."
                },
                "weaknesses": {
                    "value": "The study lacks experiments, even on toy datasets, to determine whether its findings are applicable in practical scenarios.\n\nFurthermore, it has not been compared with existing works. Although it is primarily theoretical, clarity on how it measures up against established methods is missing.\n\nThe paper does not discuss how reducing training time might impact the robustness performance of the model. This trade-off between efficiency and robustness is crucial for practical use cases.\n\nLikewise, the trade-off between memory usage and efficiency warrants discussion. While the paper could comment on memory requirements, it may be that for only two-layer networks, the difference is minimal. However, it would still be beneficial to understand this aspect, perhaps by employing very wide neural networks to confirm it in a practical scenario.\n\nIt is also unclear whether the proposed methods can be effectively translated into actual GPU computations. If the approach results in underutilized GPUs, it might still be valuable but may not reduce the overall wall time. Some commentary on this feasibility would be constructive."
                },
                "questions": {
                    "value": "To translate the theoretical advantages into practical scenarios, the paper should present at least some toy experiments.\n\nIt is important to explore how reducing training time affects the model's robustness performance, as the trade-off between efficiency and robustness is crucial for practical use cases.\n\nThe same consideration should be given to the trade-off between memory usage and efficiency. It would be beneficial for the paper to comment on memory requirements. While the impact on only a two-layer network might be minor, understanding this trade-off is essential, and could be tested using neural networks with extremely high widths in practical scenarios.\n\nIn short, a toy experiment featuring a two-layer network that showcases practical, minimal use cases by comparing memory usage, computational efficiency, and robustness performance would be a valuable addition to the work."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "8: accept, good paper"
                },
                "confidence": {
                    "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 4,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission6712/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1699198480791,
            "cdate": 1699198480791,
            "tmdate": 1699636770953,
            "mdate": 1699636770953,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "yiTgmdsCMB",
                "forum": "N2WchST43h",
                "replyto": "eQXU9WAf6G",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6712/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6712/Authors"
                ],
                "content": {
                    "comment": {
                        "value": "Thank you for your valuable feedback. We would revise the typos in the next version. We admit it is very important to take memory usage into consideration in this work. The introduced half-space reporting data structure used in this paper will take additional $O(n \\log n)$ space [1] . To have an intuitive understanding of the level of such additional memory usage, we would point out that the weights of neural networks takes $O(n d)$ space. So when the neural network is over-parameterized, i.e., $d$ is very large, the additional memory usage by our algorithm is not the dominant term in space complexity.\n\n[1] Pankaj K Agarwal, David Eppstein, and Jiri Matousek. Dynamic half-space reporting, geometric optimization, and minimum spanning trees. In Annual Symposium on Foundations of Computer Science, volume 33, pages 80\u201380. IEEE COMPUTER SOCIETY PRESS, 1992"
                    }
                },
                "number": 2,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6712/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700440105401,
                "cdate": 1700440105401,
                "tmdate": 1700440105401,
                "mdate": 1700440105401,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    }
]