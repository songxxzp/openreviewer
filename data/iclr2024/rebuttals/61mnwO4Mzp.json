[
    {
        "title": "Denoising Diffusion Variational Inference"
    },
    {
        "review": {
            "id": "771kl578Nc",
            "forum": "61mnwO4Mzp",
            "replyto": "61mnwO4Mzp",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission7583/Reviewer_3sxG"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission7583/Reviewer_3sxG"
            ],
            "content": {
                "summary": {
                    "value": "This paper proposes denoising variational inference. Specifically, they introduce a  user-specified noising process, which transfers a latent variable $z$ from an intractable posterior to another easy to model variable $y$. Then, the authors propose a lower bound on the marginal likelihood inspired by wake-sleep. The method is then extended to the diffusion-based encoders, which can also be viewed as adding a new form of regularization. The authors also discuss some extension topics including semi-supervised learning and clustering."
                },
                "soundness": {
                    "value": "2 fair"
                },
                "presentation": {
                    "value": "2 fair"
                },
                "contribution": {
                    "value": "2 fair"
                },
                "strengths": {
                    "value": "This work propose a novel variational lower bound on the marginal likelihood. Besides, the analysis and experiments in dimension reduction are interesting and meaningful."
                },
                "weaknesses": {
                    "value": "1. I see the point of adding auxiliary variables to the VAE encoder, but I can't find a strong reason to introduce auxiliary variables in diffusion models. \n2. Both Sec. 3.1 and 3.2 are introducing the main method. But it is hard to tell what I should take away for each section.\n3. The experiments are comparing with classical VAE-based methods. It would be more convincing if more advanced VAE-based methods are considered.\n4. In Fig. 3 of the experiments, using a more complicated prior does not improve the  visual quaility, and even don't see more diversity compared with AAE."
                },
                "questions": {
                    "value": "1. Can you point out the difference between DiffVAE and Variational diffusionn models? \n2. Some other methods like two stage VAE[1] are also learning a more complicated prior (without knowing the true density), then what is the strength of DiffVAE over these methods?\n3. Can you provide rigorous convergence and error analysis for your proposed bound?\n3. What is the time consumption for the experiments? Compared with classical models?\n\n[1] Dai B, Wipf D. Diagnosing and enhancing VAE models[J]. arXiv preprint arXiv:1903.05789, 2019."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "3: reject, not good enough"
                },
                "confidence": {
                    "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                },
                "first_time_reviewer": {
                    "value": "Yes",
                    "readers": [
                        "ICLR.cc/2024/Conference/Program_Chairs",
                        "ICLR.cc/2024/Conference/Submission7583/Senior_Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission7583/Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission7583/Reviewer_3sxG"
                    ]
                }
            },
            "number": 1,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission7583/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698628251550,
            "cdate": 1698628251550,
            "tmdate": 1699636918434,
            "mdate": 1699636918434,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "ApxhIZU5Gp",
                "forum": "61mnwO4Mzp",
                "replyto": "771kl578Nc",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission7583/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission7583/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Response to Reviewer 3sxG (Part 1)"
                    },
                    "comment": {
                        "value": "We want to thank the reviewer for the thoughtful review and constructive feedback. We address each of your comments below:\n\n***\n> **Q1** I can't find a strong reason to introduce auxiliary variables in diffusion models\n\n**A1** The motivation of introducing auxiliary variables is to increase the flexibility of the variational distribution that can thereby improve the variational lower bound. This has been an important research direction for variational inference and many previous works have demonstrated its usefulness [1, 2, 3, 4].\n\nTo clarify, we are not introducing auxiliary variables in the sense of augmenting diffusion models; we introduce them in the approximate posterior as in VAE with auxiliary variables (equivalently, hierarchical VAE (HVAE)), where the relationship between the auxiliary latent $\\mathbf{y}$ and the main latent $\\mathbf{z}$ is defined as diffusion process.\n\nWe add a new table here that compares different baselines, including a new HVAE baseline, with our method\n\n**Comparison of DiffVAE to other relevant methods**\n| Model   | Training Objective | Approximating Family | Sample-based Prior | Auxiliary Variable | Tasks | Simplified Graphical Illustration |\n|---|---|---|---|---|---|---|\n| VAE \t| ELBO           \t| Diagonal Gaussian\t| No             \t| No             \t| Density estimation | $\\mathbf{x}$ -> $\\mathbf{z}$ -> $\\mathbf{x}$ |\n| IAF-VAE | ELBO           \t| Normalizing flow \t| No             \t| Yes            \t| Density estimation/Visualization | $\\mathbf{x}$ -> $\\mathbf{z}_0$ -> $\\mathbf{z}_T$ -> $\\mathbf{x}$ |\n| AAE \t| Adversarial training | Adversarial generator | Yes           \t| No             \t| Visualization | $\\mathbf{x}$ -> $\\mathbf{z}$ -> $\\mathbf{x}$ |\n| HVAE w/o and w/ flow | ELBO | Factorial Normal / Normalizing flow | No \t| Yes           \t| Density estimation/High-quality sample generation | $\\mathbf{x}$ -> $\\mathbf{z}_0$ -> $\\mathbf{z}_T$ -> $\\mathbf{z}_0$ -> $\\mathbf{x}$ |\n| ADGM\t| ELBO           \t| Non-Gaussian     \t| No             \t| Yes            \t| Density estimation | $\\mathbf{x}$ -> $\\mathbf{a}$ -> $\\mathbf{z}$ -> $\\mathbf{x}$ |\n| LDM \t| ELBO           \t| Diagonal Gaussian\t| No             \t| Yes            \t| High-quality sample generation | $\\mathbf{x}$ -> $\\mathbf{z}_0$ -> $\\mathbf{z}_T$ -> $\\mathbf{z}_0$ -> $\\mathbf{x}$ |\n| LSGM\t| ELBO+score matching | Diagonal Gaussian   | No             \t| Yes            \t| High-quality sample generation | $\\mathbf{x}$ -> $\\mathbf{z}_0$ -> $\\mathbf{z}_T$ -> $\\mathbf{z}_0$ -> $\\mathbf{x}$ |\n| DiffVAE | ELBO+sleep term\t| Denoising diffusion | Yes            \t| Yes            \t| Density estimation/Visualization | $\\mathbf{x}$ -> $\\mathbf{z}_T (\\mathbf{y})$ -> $\\mathbf{z}_0 (\\mathbf{z})$ -> $\\mathbf{x}$ |\n\n\n[1] Rezende, Danilo, and Shakir Mohamed. \"Variational inference with normalizing flows.\" International conference on machine learning. PMLR, 2015.\n\n[2] Barber, David, and Felix Agakov. \"The im algorithm: a variational approach to information maximization.\" Advances in neural information processing systems 16.320 (2004): 201.\n\n[3] Maal\u00f8e, Lars, et al. \"Auxiliary deep generative models.\" International conference on machine learning. PMLR, 2016.\n\n[4] S\u00f8nderby, Casper Kaae, et al. \"Ladder variational autoencoders.\" Advances in neural information processing systems 29 (2016).\n\n***\n> **Q2** Both Sec. 3.1 and 3.2 are introducing the main method. But it is hard to tell what I should take away for each section.\n\n**A2** We present two perspectives to understanding our denoising diffusion variational inference in Sections 3.1 and 3.2. We recognize that having section 3.2 (and 3.3) in the main text might affect the readability of the paper and have moved it to the appendix so that it is an optional read. More details on both sections can be found below:\n\nSection 3.1 introduces DiffVAE, which fits a latent variable model with a complex prior by extending the latent space with auxiliary latents through a noising process $r(\\mathbf{y} | \\mathbf{z})$. This process simplifies modeling the posterior of $\\mathbf{y}$. To overcome the weak learning signals from the standard ELBO, we propose an augmented ELBO with an additional regularizer, $\\mathcal{L}_{sleep} (\\phi)$. This involves a diffusion-like training procedure, optimizing the reverse denoising process and leveraging the wake-sleep algorithm for efficient training in latent space.\n\nIn Section 3.2, we draw a parallel between DiffVAE and auxiliary variable VAEs, including hierarchical VAEs with normalizing flows. Here, we use an approximate posterior $q_\\phi (\\mathbf{z} | \\mathbf{x})$ with latent variables $\\mathbf{y}$. This setup equates fitting an augmented model $p_\\theta (\\mathbf{x}, \\mathbf{y}, \\mathbf{z})$ with the original model $p_\\theta (\\mathbf{x}, \\mathbf{z})$ using a double application of the ELBO. This approach seeks a tight bound by aligning approximate posteriors and implicitly minimizes the reverse KL divergence in the denoising variational inference process."
                    }
                },
                "number": 1,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission7583/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700590075985,
                "cdate": 1700590075985,
                "tmdate": 1700683507945,
                "mdate": 1700683507945,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "2lpVYOMdBY",
                "forum": "61mnwO4Mzp",
                "replyto": "771kl578Nc",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission7583/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission7583/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Response to Reviewer 3sxG (Part 2)"
                    },
                    "comment": {
                        "value": "***\n> **Q3** It would be more convincing if more advanced VAE-based methods are considered.\n\n**A3** We add a new HVAE [1, 2] with normalizing flow baseline for unsupervised learning experiments to further highlight the connection between DiffVAE and auxiliary-variable VAE / hierarchical VAE (HVAE). The results on MNIST and CIFAR-10 below show that DiffVAE outperforms the baselines in almost all scenarios:\n\n**Unsupervised learning on MNIST**\n| Method        | Acc (Pinwheel)      | Latent NLL (Pinwheel) | Acc (Swiss Roll)     | Latent NLL (Swiss Roll) | Acc (Square)        | Latent NLL (Square) |\n|---------------|---------------------|-----------------------|----------------------|-------------------------|---------------------|---------------------|\n| VAE           | 0.58 \u00b1 0.01         | 6.18 \u00b1 0.93           | 0.56 \u00b1 0.055         | 82.96 \u00b1 99.30           | 0.35 \u00b1 0.02         | 25.07 \u00b1 62.41       |\n| IAF-VAE       | **0.71 \u00b1 0.00**     | 2.06 \u00b1 0.21           | 0.67 \u00b1 0.02          | 12.13 \u00b1 18.28           | 0.65 \u00b1 0.03         | 1.53 \u00b1 0.82         |\n| AAE           | 0.67 \u00b1 0.02         | 1.94 \u00b1 0.09           | 0.68 \u00b1 0.03          | 3.43 \u00b1 0.14             | 0.57 \u00b1 0.02         | 1.97 \u00b1 0.70         |\n| HVAE w/ flow  | **0.72 \u00b1 0.01**     | 2.18 \u00b1 0.13           | **0.71 \u00b1 0.02**      | 4.17 \u00b1 1.23             | **0.70 \u00b1 0.01**     | **1.25 \u00b1 0.08**     |\n| DiffVAE       | **0.72 \u00b1 0.01**     | **1.57 \u00b1 0.10**       | 0.66 \u00b1 0.01          | **3.19 \u00b1 0.07**         | **0.72 \u00b1 0.03**     | **1.24 \u00b1 0.13**     |\n\n**Unsupervised learning on CIFAR-10**\n| Method        | Acc (Pinwheel)      | Latent NLL (Pinwheel) | Acc (Swiss Roll)     | Latent NLL (Swiss Roll) | Acc (Square)        | Latent NLL (Square) |\n|-----------------|-------------------|-------------------|-------------------|-------------------|-------------------|-------------------|\n| VAE             | 0.16 \u00b1 0.01     | 86.9 \u00b1 99.03    | 0.15 \u00b1 0.01     | 360.41 \u00b1 185.87 | 0.15 \u00b1 0.01     | 63.3 \u00b1 70.64    |\n| IAF-VAE         | 0.19 \u00b1 0.01     | 3.12 \u00b1 1.16     | 0.16 \u00b1 0.01     | 189.39 \u00b1 57.48  | 0.18 \u00b1 0.01     | 0.99 \u00b1 0.11     |\n| AAE             | 0.23 \u00b1 0.00     | 2.30 \u00b1 0.07     | **0.23 \u00b1 0.01** | **2.84 \u00b1 0.08** | 0.20 \u00b1 0.01     | 1.46 \u00b1 0.49     |\n| HVAE w/ flow    | 0.20 \u00b1 0.01     | 2.06 \u00b1 0.07     | 0.20 \u00b1 0.01     | 106.15 \u00b1 15.30 | 0.19 \u00b1 0.01     | 1.05 \u00b1 0.06     |\n| DiffVAE         | **0.23 \u00b1 0.01** | **1.37 \u00b1 0.02** | **0.23 \u00b1 0.01** | **2.80 \u00b1 0.11** | **0.24 \u00b1 0.01** | **0.86 \u00b1 0.05** |\n\n[1] Ranganath, Rajesh, Dustin Tran, and David Blei. \"Hierarchical variational models.\" International conference on machine learning. PMLR, 2016.\n\n[2] Vahdat, Arash, and Jan Kautz. \"NVAE: A deep hierarchical variational autoencoder.\" Advances in neural information processing systems 33 (2020): 19667-19679.\n\n***\n> **Q4** In Fig. 3 of the experiments, using a more complicated prior does not improve the visual quaility, and even doesn't see more diversity compared with AAE.\n\n**A4** We argue that for AAE, the last 8 samples look practically identical, even though they are sampled from different points along the prior. DiffVAE, on the other hand, has digits spread along the square much more evenly. AAE samples also miss the digit 4 and maybe 5 (the sixth sample from the left may be interpreted as the digit 5, but it also looks a lot like 0 and 8. DiffVAE, on the other hand, has a very nice digit 5.)"
                    }
                },
                "number": 2,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission7583/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700590345397,
                "cdate": 1700590345397,
                "tmdate": 1700598804843,
                "mdate": 1700598804843,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "Vb5i3rD2cy",
                "forum": "61mnwO4Mzp",
                "replyto": "771kl578Nc",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission7583/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission7583/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Response to Reviewer 3sxG (Part 3)"
                    },
                    "comment": {
                        "value": "***\n> **Q5** Can you point out the difference between DiffVAE and Variational diffusion models?\n\n**A5** In terms of the task they solve, VDM focuses on density estimation tasks where they achieve new state-of-the-art log-likelihoods using an introduced flexible family of diffusion-based generative models, while DiffVAE is motivated by **representation learning, dimensionality reduction and visualization tasks**, essentially tasks that VAEs are well-suited for, and seeks to improve variational inference via expressive posteriors based on diffusion-like framework.\n\nContent-wise, VDM focuses on improving the theoretical understanding of density modeling using diffusion models by analyzing the variational lower bound (VLB), deriving a remarkably simple expression in terms of the signal-to-noise ratio of the diffusion process.\n\nIn contrast, DiffVAE focuses on enhancing VAE with diffusion-based models, where we augment variational inference in a latent variable model $p_\\theta (\\mathbf{x}, \\mathbf{z})$ with auxiliary latent $\\mathbf{y}$ introduced via a user-specified noising process$r(\\mathbf{y} | \\mathbf{z})$. Note that the diffusion models are used to instantiate the denoising variational inference framework. However, the transformation $r$ can be modeled using other approaches, e.g., discrete noising processes [1], and custom regularizers [2].\n\n[1] Austin, Jacob, et al. \"Structured denoising diffusion models in discrete state-spaces.\" Advances in Neural Information Processing Systems 34 (2021): 17981-17993.\n\n[2] Miao, Ning, et al. \"On incorporating inductive biases into VAEs.\" arXiv preprint arXiv:2106.13746 (2021).\n\n***\n> **Q6** Some other methods like two stage VAE[1] are also learning a more complicated prior (without knowing the true density), then what is the strength of DiffVAE over these methods?\n\n**A6** Unlike DiffVAE, and other baselines in this paper, Two stage VAE does not allow enforcing a prior of the user's choice. Two stage VAE allows a mismatch between the aggregated posterior and the prior by training a second VAE that lets them sample from the aggregated posterior. Thus, it is more focused on learning a generative model with good sample quality than learning a generative model with a user-specified prior that might encode domain knowledge.\n\n***\n> **Q7** Some other methods like two stage VAE[1] are also learning a more complicated prior (without knowing the true density), then what is the strength of DiffVAE over these methods?\n\n**A7** \n\n- Guarantees and Error Analysis as ELBO Variational Inference\n\nSince our DiffVAE lower bound operates within this same conceptual and mathematical framework, it inherits these guarantees of traditional ELBO in variational inference, whose convergence and error analysis are well-understood and extensively studied [1]. This means that the convergence behavior and error analysis of our DiffVAE lower bound can be understood and predicted with the same level of rigor as the ELBO in traditional variational inference.\n\n- Tightness of Lower Bound with Approximate Posterior Matching True Posterior\n\nIn the principle of variational inference, an ELBO becomes tight, meaning it closely approximates the true log-likelihood, when the approximate posterior matches the true posterior of the data. In DiffVAE, we aim to achieve this tightness by using the denoising variational inference framework. As the model training progresses and the approximate posterior improves, the lower bound provided by our DiffVAE model becomes increasingly tight.\n\n[1] Damm, Simon, et al. \"The ELBO of Variational Autoencoders Converges to a Sum of Entropies.\" International Conference on Artificial Intelligence and Statistics. PMLR, 2023."
                    }
                },
                "number": 3,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission7583/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700590594487,
                "cdate": 1700590594487,
                "tmdate": 1700599061280,
                "mdate": 1700599061280,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "tYvkVHgqUs",
                "forum": "61mnwO4Mzp",
                "replyto": "771kl578Nc",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission7583/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission7583/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Response to Reviewer 3sxG (Part 4)"
                    },
                    "comment": {
                        "value": "***\n> **Q8** What is the time consumption for the experiments? Compared with classical models?\n\n**A8** We conduct a computational cost analysis between the baselines and DiffVAE with various timesteps on the genotype clustering/visualization experiments. The table below shows that DiffVAE outperforms baselines at all timestamps and continues to improve after the baselines have plateaued.\n\n**Computational cost trade-off on 1kgenome: NMI vs wall-clock training time**\n\nNMI @ Wall-clock training time (min)\n| Method          | NMI @ 10 min | NMI @ 20 min | NMI @ 30 min | NMI @ 40 min| NMI @ 50 min| NMI @ 60 min|\n|-----------------|----------|----------|----------|----------|----------|----------|\n| VAE             | 0.52     | 0.52     | 0.52     | 0.52     | 0.52     | 0.52     |\n| IAF-VAE         | 0.54     | 0.52     | 0.52     | 0.52     | 0.52     | 0.52     |\n| AAE             | 0.61     | 0.57     | 0.57     | 0.57     | 0.57     | 0.57     |\n| DiffVAE (T=5)   | warm up  | 0.63     | 0.63     | 0.66     | 0.66     | 0.66     |\n| DiffVAE (T=10)  | warm up  | **0.64**     | **0.68**     | **0.70**     | **0.70**     | **0.70**     |\n| DiffVAE (T=20)  | warm up  | 0.50     | 0.51     | 0.56     | 0.64     | 0.68     |\n| DiffVAE (T=50)  | warm up  | 0.52     | 0.54     | 0.51     | 0.59     | 0.59     |"
                    }
                },
                "number": 4,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission7583/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700590681487,
                "cdate": 1700590681487,
                "tmdate": 1700590681487,
                "mdate": 1700590681487,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "RIiHxqJNJj",
            "forum": "61mnwO4Mzp",
            "replyto": "61mnwO4Mzp",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission7583/Reviewer_18s7"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission7583/Reviewer_18s7"
            ],
            "content": {
                "summary": {
                    "value": "The paper proposes a hierarchical variational auto-encoder (VAE) with latents structured in Markov chain that is regularized to follow a diffusion process. To achieve this, authors augment the standard ELBO training objective with a de-noising regularization term, motivated by the \"sleep\" term of the wake-sleep algorithm. Authors evaluate the method on unsupervised learning, semi-supervised learning, and clustering+visualization, measuring the quality of the learned latent space."
                },
                "soundness": {
                    "value": "2 fair"
                },
                "presentation": {
                    "value": "2 fair"
                },
                "contribution": {
                    "value": "2 fair"
                },
                "strengths": {
                    "value": "Originality. The additional regularization term in Eq. (3) is novel (to the best of knowledge), and has a sound motivation: it allows us to prescribe a \"forward\" process for the sequence of latents."
                },
                "weaknesses": {
                    "value": "Originality. While the regularization term in Eq. (3) is novel, the rest of the paper presents a standard hierarchical VAE. In particular, ladder VAEs by S\u00f8nderby et al. (2016) use a similar Markov chain of latents with Gaussian conditional step distributions. Subsequent work, including by Vahdat et al. (2020), further demonstrates the benefits of this approach. While implementation details might differ, the proposed method should be put in the context of this well-established area of research.\n\nSignificance. The method is compared to weak baselines, with the newest method (IAF-VAE) having been published in 2016. Stronger baselines should be used, including some of the hierarchical VAEs mentioned above. Unsupervised and semi-supervised experiments feel contrived: why do we care about these particular toy priors? Are there realistic settings in which we can demonstrate the method's benefits? The semi-supervised and clustering+visualization extensions and experiments feel secondary to the main contribution, and add little to the paper. It is not clear what the expected results in Figure 3 should be.\n\nClarity and Quality. Section 3 is very dense, and could be structured better. The value of Sections 3.2 and 3.3 is limited: their main messages could be summarized in the main text, with details moved to the appendix. The mathematical notation is hard to follow, and at times inconsistent: conditioning variables and parameter subscripts are dropped silently, variable names are mixed up (e.g. $\\bar{H}$ in Eq. (6) is referred to as $H$ in the main text). Figure 1 (the main figure summarizing the method) has an error: $q_\\phi(y|z,x)$ should be $q_\\phi(z|y,x)$. This makes an already dense paper even harder to read.\n\n## Additional references\n\n- S\u00f8nderby, C. K., Raiko, T., Maal\u00f8e, L., S\u00f8nderby, S. K., & Winther, O. (2016). Ladder variational autoencoders. Advances in neural information processing systems, 29.\n- Vahdat, A., & Kautz, J. (2020). NVAE: A deep hierarchical variational autoencoder. Advances in neural information processing systems, 33, 19667-19679."
                },
                "questions": {
                    "value": "The paper mentions that the standard ELBO in Eq. (2) provides too weak of a learning signal. How does this look in practice? Have authors evaluated this approach on the benchmarks in the paper?\n\nIn what sense is the \"latent space sleep term\" in Eq. (7) an approximation of the sleep term in Eq. (3)? Authors mention that this regularization term has less computational overhead, but is an approximation, and hence the overall training objective is not a tight bound. How does this trade-off look in practice? How much computation are we saving, and how big of a sacrifice in terms of results are we seeing?\n\nHow does the computational complexity (or at least wall-clock training/inference time) of the method compare to the baselines?"
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "5: marginally below the acceptance threshold"
                },
                "confidence": {
                    "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
                },
                "code_of_conduct": {
                    "value": "Yes"
                },
                "first_time_reviewer": {
                    "readers": [
                        "ICLR.cc/2024/Conference/Program_Chairs",
                        "ICLR.cc/2024/Conference/Submission7583/Senior_Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission7583/Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission7583/Reviewer_18s7"
                    ]
                }
            },
            "number": 2,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission7583/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698763066064,
            "cdate": 1698763066064,
            "tmdate": 1700652246103,
            "mdate": 1700652246103,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "cOhf0jIDb0",
                "forum": "61mnwO4Mzp",
                "replyto": "RIiHxqJNJj",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission7583/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission7583/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Response to Reviewer 18s7 (Part 1)"
                    },
                    "comment": {
                        "value": "We want to thank the reviewer for the thoughtful review and constructive feedback. We address each of your comments below:\n\n***\n> **Q1** While the regularization term in Eq. (3) is novel, the rest of the paper presents a standard hierarchical VAE. While implementation details might differ, the proposed method should be put in the context of this well-established area of research. The method is compared to weak baselines, with the newest method (IAF-VAE) having been published in 2016. Stronger baselines should be used, including some of the hierarchical VAEs mentioned above.\n\n**A1** We would like to first note that we have established a connection between DiffVAE and auxiliary-variable VAE, a framework equivalent to hierarchical VAE, in section 3.2.\n\nTo further strengthen this connection, we run a HVAE with normalizing flow [1]  baseline for unsupervised learning experiments and include a table comparing the training objectives and approximating family of different baselines with our method below:\n\n**Unsupervised learning on MNIST**\n| Method        | Acc (Pinwheel)      | Latent NLL (Pinwheel) | Acc (Swiss Roll)     | Latent NLL (Swiss Roll) | Acc (Square)        | Latent NLL (Square) |\n|---------------|---------------------|-----------------------|----------------------|-------------------------|---------------------|---------------------|\n| VAE           | 0.58 \u00b1 0.01         | 6.18 \u00b1 0.93           | 0.56 \u00b1 0.055         | 82.96 \u00b1 99.30           | 0.35 \u00b1 0.02         | 25.07 \u00b1 62.41       |\n| IAF-VAE       | **0.71 \u00b1 0.00**     | 2.06 \u00b1 0.21           | 0.67 \u00b1 0.02          | 12.13 \u00b1 18.28           | 0.65 \u00b1 0.03         | 1.53 \u00b1 0.82         |\n| AAE           | 0.67 \u00b1 0.02         | 1.94 \u00b1 0.09           | 0.68 \u00b1 0.03          | 3.43 \u00b1 0.14             | 0.57 \u00b1 0.02         | 1.97 \u00b1 0.70         |\n| HVAE w/ flow  | **0.72 \u00b1 0.01**     | 2.18 \u00b1 0.13           | **0.71 \u00b1 0.02**      | 4.17 \u00b1 1.23             | **0.70 \u00b1 0.01**     | **1.25 \u00b1 0.08**     |\n| DiffVAE       | **0.72 \u00b1 0.01**     | **1.57 \u00b1 0.10**       | 0.66 \u00b1 0.01          | **3.19 \u00b1 0.07**         | **0.72 \u00b1 0.03**     | **1.24 \u00b1 0.13**     |\n\n**Unsupervised learning on CIFAR-10**\n| Method        | Acc (Pinwheel)      | Latent NLL (Pinwheel) | Acc (Swiss Roll)     | Latent NLL (Swiss Roll) | Acc (Square)        | Latent NLL (Square) |\n|-----------------|-------------------|-------------------|-------------------|-------------------|-------------------|-------------------|\n| VAE             | 0.16 \u00b1 0.01     | 86.9 \u00b1 99.03    | 0.15 \u00b1 0.01     | 360.41 \u00b1 185.87 | 0.15 \u00b1 0.01     | 63.3 \u00b1 70.64    |\n| IAF-VAE         | 0.19 \u00b1 0.01     | 3.12 \u00b1 1.16     | 0.16 \u00b1 0.01     | 189.39 \u00b1 57.48  | 0.18 \u00b1 0.01     | 0.99 \u00b1 0.11     |\n| AAE             | 0.23 \u00b1 0.00     | 2.30 \u00b1 0.07     | **0.23 \u00b1 0.01** | **2.84 \u00b1 0.08** | 0.20 \u00b1 0.01     | 1.46 \u00b1 0.49     |\n| HVAE w/ flow    | 0.20 \u00b1 0.01     | 2.06 \u00b1 0.07     | 0.20 \u00b1 0.01     | 106.15 \u00b1 15.30 | 0.19 \u00b1 0.01     | 1.05 \u00b1 0.06     |\n| DiffVAE         | **0.23 \u00b1 0.01** | **1.37 \u00b1 0.02** | **0.23 \u00b1 0.01** | **2.80 \u00b1 0.11** | **0.24 \u00b1 0.01** | **0.86 \u00b1 0.05** |\n\n**Comparison of DiffVAE to other VAE-based methods**\n| Model                          | Training Objective     | Approximating Family             | Sampling-only Prior Compatibility\n|--------------------------------|------------------------|----------------------------------|-------------\n| VAE                            | ELBO                   | Diagonal Gaussian                | No |\n| IAF-VAE                        | ELBO                   | Normalizing flow                 | No |\n| AAE                            | Adversarial training   | Adversarial generator            | Yes |\n| HVAE w/o and w/ flow    | ELBO                   | Factorial Normal / Normalizing flow | No |\n| DiffVAE                        | ELBO + sleep term      | Denoising diffusion              | Yes |\n\nWe note that we ran HVAE w/ flow instead of the newer NVAE [2] because the techniques introduced in NVAE are either orthogonal or inapplicable to our experiments. More details are below:\n\nNVAE made 4 contributions\n\n- Depthwise convolutions in its generative model \u2013 this is orthogonal as all VAE-based methods can use this\n\n- A new residual parameterization of the approximate posteriors \u2013 this is inapplicable as it requires certain forms of prior and do not allow the use of arbitrary prior of user choice\n\n- Spectral regularization \u2013 this is orthogonal as all VAE-based methods can use this\n\n- Practical solutions to reduce the memory burden of VAEs \u2013 this is orthogonal as all VAE-based methods can use this\n\n[1] Ranganath, Rajesh, Dustin Tran, and David Blei. \"Hierarchical variational models.\" International conference on machine learning. PMLR, 2016.\n\n[2] Vahdat, Arash, and Jan Kautz. \"NVAE: A deep hierarchical variational autoencoder.\" Advances in neural information processing systems 33 (2020): 19667-19679."
                    }
                },
                "number": 5,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission7583/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700600000419,
                "cdate": 1700600000419,
                "tmdate": 1700600000419,
                "mdate": 1700600000419,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "XPIwNSGFjr",
                "forum": "61mnwO4Mzp",
                "replyto": "RIiHxqJNJj",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission7583/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission7583/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Response to Reviewer 18s7 (Part 2)"
                    },
                    "comment": {
                        "value": "***\n> **Q2** Unsupervised and semi-supervised experiments feel contrived: why do we care about these particular toy priors? Are there realistic settings in which we can demonstrate the method's benefits? The semi-supervised and clustering+visualization extensions and experiments feel secondary to the main contribution, and add little to the paper.\n\nThe specific instantiation of the method used in this paper is motivated by representation learning, dimensionality reduction, and visualization tasks where expressive priors are used to encode domain knowledge. We conduct experiments on both synthetic and real benchmarks to support this application. Our MNIST/CIFAR-10 (standardly used in VAE evaluation [1]) experiments leverage widely-used priors [2, 3] and serve as synthetic benchmarks to evaluate the expressivity of the diffusion-based posterior. Then, we test diffusion variational inference on a real-world biological benchmark, 1000 genome, where DiffVAE outperforms all baselines. Semi-supervised learning and clustering experiments are performed to demonstrate that DiffVAE can be used in various visualization tasks: sometimes, data is partially labeled, and sometimes, the users only want to enforce \u201csoft\u201d priors, such as mixture of Gaussian, on the visualization.\n\n[1] Vahdat, Arash, and Jan Kautz. \"NVAE: A deep hierarchical variational autoencoder.\" Advances in neural information processing systems 33 (2020): 19667-19679.\n\n[2] Alireza Makhzani, Jonathon Shlens, Navdeep Jaitly, Ian Goodfellow, and Brendan Frey. Adversarial autoencoders. arXiv preprint arXiv:1511.05644, 2015\n\n[3] Matthew J. Johnson, David Duvenaud, Alexander B. Wiltschko, Sandeep Robert Datta, and Ryan P. Adams. Composing graphical models with neural networks for structured representations and fast inference. In Advances in Neural Information Processing Systems (NIPS) 29, 2016. arXiv:1603.06277 [stat.ML].\n\n\n***\n> **Q3** It is not clear what the expected results in Figure 3 should be.\n\n**A3** We argue that for AAE, the last 8 samples look practically identical, even though they are sampled from different points along the prior. DiffVAE, on the other hand, has digits spread along the square much more evenly. AAE samples also miss the digit 4 and maybe 5 (the sixth sample from the left may be interpreted as the digit 5, but it also looks a lot like 0 and 8. DiffVAE, on the other hand, has a very nice digit 5.) \n\n***\n> **Q4** The value of Sections 3.2 and 3.3 is limited. The mathematical notation is hard to follow, and at times inconsistent\n\n**A4** We thank the reviewer for identifying the typos, which we have corrected. We have also moved section 3.2 and 3.3 to the appendix for better readability.\n\n***\n> **Q5** The paper mentions that the standard ELBO in Eq. (2) provides too weak of a learning signal. How does this look in practice? Have authors evaluated this approach on the benchmarks in the paper?\n\n**A5** We show results of VAE with diffusion encoder trained with standard ELBO below:\n\n**Unsupervised learning on MNIST, including the failed results of VAE with Diffusion**\n|    Method              | Latent NLL  (Pinwheel)       | Latent NLL  (Swiss Roll)      | Latent NLL  (Square)      |\n| --------------- | ------------------ | ------------------ | ----------------- |\n| VAE             | 6.18 \u00b1 0.93        | 82.96 \u00b1 99.30      | 25.07 \u00b1 62.41     |\n| IAF-VAE         | 2.06 \u00b1 0.21        | 12.13 \u00b1 18.28      | 1.53 \u00b1 0.82       |\n| AAE             | 1.94 \u00b1 0.09        | 3.43 \u00b1 0.14        | 1.97 \u00b1 0.70       |\n| HVAE w/ flow    | 2.18 \u00b1 0.13        | 4.17 \u00b1 1.23        | **1.25 \u00b1 0.08**   |\n| DiffVAE         | **1.57 \u00b1 0.10**    | **3.19 \u00b1 0.07**    | **1.24 \u00b1 0.13**   |\n| **VAE with Diffusion (standard ELBO)** | 6.09 | 510.53 | 265.25 |\n\nAs you can see, VAE with Diffusion (standard ELBO) totally fails to respect the prior. The intuition is as follows: \n\nThe objective samples from the reverse diffusion process instead of the forward diffusion process like in standard diffusion training (please see Sec. 3.1.1 for the details). Specifically, for the term\n$E_{q_\\psi(\\mathbf{z_{0:T}}|\\mathbf{x})} [D_{KL}(q_\\psi(\\mathbf{z_{t-1}}|\\mathbf{z_t}, \\mathbf{x})||r(\\mathbf{z_{t-1}}|\\mathbf{z_t}, \\mathbf{z_0}))]$ in VAE with Diffusion (standard ELBO) objective,\nwe have to backpropagate through $\\mathbf{z_0}$ and $\\mathbf{z_t}$ all the way to $\\mathbf{z_T}$. This long chain of backpropagation makes the learning signal weak; the same does not happen in standard diffusion training because $z_0$ is the data that does not need to be backpropagated."
                    }
                },
                "number": 6,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission7583/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700600527942,
                "cdate": 1700600527942,
                "tmdate": 1700600700945,
                "mdate": 1700600700945,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "sft1JIe0SL",
                "forum": "61mnwO4Mzp",
                "replyto": "RIiHxqJNJj",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission7583/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission7583/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Response to Reviewer 18s7 (Part 3)"
                    },
                    "comment": {
                        "value": "***\n> **Q6** In what sense is the \"latent space sleep term\" in Eq. (7) an approximation of the sleep term in Eq. (3)?\n\n**A6** The \"latent space sleep term\" in Equation (7) serves as an approximation of the sleep term in Equation (3) primarily because it bypasses the need to sample from $p_\\theta(\\mathbf{x})$, instead focusing solely on sampling the latent variables. This modification leads to a less tight ELBO, as discussed in Sec. 3.1.2. The key benefit of this approach is the increased computational efficiency gained from not having to sample $p_\\theta(\\mathbf{x})$, making the process faster. Overall, the approximation is designed to retain the effectiveness of the original term while making the computational process more feasible.\n\n***\n> **Q7** Authors mention that this regularization term has less computational overhead, but is an approximation, and hence the overall training objective is not a tight bound. How does this trade-off look in practice? How does the computational complexity (or at least wall-clock training/inference time) of the method compare to the baselines?\n\n**A7** We conduct a computational cost analysis between the baselines and DiffVAE with various timesteps on the genotype clustering/visualization experiments. The table below shows that DiffVAE outperforms baselines at all timestamps and continues to improve after the baselines have plateaued.\n\n**Computational cost trade-off on 1kgenome: NMI vs wall-clock training time**\n\nNMI @ Wall-clock training time (min)\n| Method          | NMI @ 10 min | NMI @ 20 min | NMI @ 30 min | NMI @ 40 min| NMI @ 50 min| NMI @ 60 min|\n|-----------------|----------|----------|----------|----------|----------|----------|\n| VAE             | 0.52     | 0.52     | 0.52     | 0.52     | 0.52     | 0.52     |\n| IAF-VAE         | 0.54     | 0.52     | 0.52     | 0.52     | 0.52     | 0.52     |\n| AAE             | 0.61     | 0.57     | 0.57     | 0.57     | 0.57     | 0.57     |\n| DiffVAE (T=5)   | warm up  | 0.63     | 0.63     | 0.66     | 0.66     | 0.66     |\n| DiffVAE (T=10)  | warm up  | **0.64**     | **0.68**     | **0.70**     | **0.70**     | **0.70**     |\n| DiffVAE (T=20)  | warm up  | 0.50     | 0.51     | 0.56     | 0.64     | 0.68     |\n| DiffVAE (T=50)  | warm up  | 0.52     | 0.54     | 0.51     | 0.59     | 0.59     |"
                    }
                },
                "number": 7,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission7583/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700600661054,
                "cdate": 1700600661054,
                "tmdate": 1700600661054,
                "mdate": 1700600661054,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "pyfx4kxKR9",
                "forum": "61mnwO4Mzp",
                "replyto": "RIiHxqJNJj",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission7583/Reviewer_18s7"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission7583/Reviewer_18s7"
                ],
                "content": {
                    "comment": {
                        "value": "I thank the authors for their clarifications and additional results. Some of my points have been addressed, so I increase my score.\n\nAt the same time, the story is still not entirely clear to me, and the results above raise further questions. In particular: \n- We could theoretically use the sleep term with the factorial normal / normalizing flow priors -- could it be responsible for the improved results of DiffVAE, or is it indeed the combination of the sleep term + the diffusion prior? (Your additional results show that it's not the diffusion prior by itself, at least.)\n- The interpretation of the Figure 3 is not entirely convincing to me, partially due to the overall low quality of generations.\n- The answer to Q6 is also not entirely satisfying: I do understand that the approximation is cheaper at a cost of a looser ELBO, but it would be useful to better characterize this trade-off, either theoretically or empirically. \n\nOverall, I think the paper contains a set of intriguing ideas, but could do a better job tying these ideas into a coherent narrative that is well placed in the context of prior work, and digging deeper into core components of the method."
                    }
                },
                "number": 13,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission7583/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700652195857,
                "cdate": 1700652195857,
                "tmdate": 1700652301896,
                "mdate": 1700652301896,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "dQycveNXq8",
            "forum": "61mnwO4Mzp",
            "replyto": "61mnwO4Mzp",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission7583/Reviewer_t61r"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission7583/Reviewer_t61r"
            ],
            "content": {
                "summary": {
                    "value": "This paper studies Denoising Diffusion Variational Inference - using diffusion models, a class of generative models known for high-quality sample generation, to fit a complex posterior through a diffusion process in the latent space. The approach involves augmenting a variational posterior with auxiliary latent variables introduced through a noising process $r$, which transforms a complex latent $z$ to a simple auxiliary latent $y$. The noising process r diffuses z into y through multiple steps, as in a denoising diffusion model. r is set to be a Gaussian diffusion but can be set to another stochastic process. To perform inference in the augmented latent variable model, an approximate posterior $q(y|z)$ is fit along with the forward (denoising) process $q(z|x,y)$. The learning objective is based on the wake-sleep algorithm, and it essentially the ELBO with an additional term which acts as regularization. The authors consider an instantiation of this framework in the context of VAEs, termed DiffVAE, leveraging this flexible encoder $q$. The approach is evaluated empirically in dimensionality reduction and representation learning tasks, outperforming methods based on adversarial training or invertible flow-based posteriors. Specifically. the authors consider a biology task\u2014inferring latent ancestry from human genomes\u2014and demonstrate that DiffVAE outperforms strong baselines on the 1000 Genomes dataset."
                },
                "soundness": {
                    "value": "2 fair"
                },
                "presentation": {
                    "value": "2 fair"
                },
                "contribution": {
                    "value": "2 fair"
                },
                "strengths": {
                    "value": "* Using a denoising diffusion model as an encoder enables modelling of complex posteriors leveraging the expressive power of diffusion models. This can be useful for representation learning tasks where we want latent space to match semantic structure which can require the encoder to express highly structured distributions. \n\n* By relying on a wake-sleep style approach, the method avoids adversarial training and requirements of constrained architectures like flows to enabling flexible modeling. \n\n* The noising process is a key component of the approach. While in the paper a Gaussian diffusion is used, the noising process can also provide a way to impose some structure based on prior knowledge.\n\n* The method shows good empirical performance in semi-supervised tasks with label-conditional priors and genotype clustering tasks."
                },
                "weaknesses": {
                    "value": "* The paper presents the very general framework of using diffusion models to model expressive posteriors for variational inference. However, the specific instantiations studied here - semi-supervised learning and clustering - seem quite a bit limited. My main concern is about the generality of the approach. While in principle the approach is applicable to various LVM problems the experiments only study two specific problems. \n* Moreover, the tasks considered here seem relatively simple, not enough to demonstrate the effect of the increased expressivity. \n* The increased expressivity also comes at a computational cost - sampling from the diffusion model can be quite expensive (for example in the experiments the authors use 20 and 100 steps which means 20 forward passes of a neural network. \n* The method also introduces a critical new hyperparameter - the number of steps for diffusion. The paper does not discuss how this parameter is selected and how sensitive the results are to the choice of this parameter.\n* Reproducibility: The authors do not include code to reproduce their results but most details seem to be included in the paper."
                },
                "questions": {
                    "value": "* What is the effect of the number of steps of the diffusion process on the performance? \n* Where do the authors believe would the increased expressivity would be useful enough to trade-off the computation cost?"
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "5: marginally below the acceptance threshold"
                },
                "confidence": {
                    "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 3,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission7583/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698791727884,
            "cdate": 1698791727884,
            "tmdate": 1699636918195,
            "mdate": 1699636918195,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "L00YV6Zbcq",
                "forum": "61mnwO4Mzp",
                "replyto": "dQycveNXq8",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission7583/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission7583/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Response to Reviewer t61r (Part 1)"
                    },
                    "comment": {
                        "value": "We want to thank the reviewer for the thoughtful review and constructive feedback. We address each of your comments below:\n\n***\n> **Q1** However, the specific instantiations studied here - semi-supervised learning and clustering - seem quite a bit limited. My main concern is about the generality of the approach. Moreover, the tasks considered here seem relatively simple, not enough to demonstrate the effect of the increased expressivity.\n\n**A1** The specific instantiation of the method used in this paper is motivated by representation learning, dimensionality reduction, and visualization tasks where expressive priors are used to encode domain knowledge. We conduct experiments on both synthetic and real benchmarks to support this application. Our MNIST/CIFAR-10 (standardly used in VAE evaluation [1]) experiments leverage widely-used priors [2, 3] and serve as synthetic benchmarks to evaluate the expressivity of the diffusion-based posterior. Then, we test diffusion variational inference on a real-world biological benchmark, 1000 genome, where DiffVAE outperforms all baselines. Semi-supervised learning and clustering experiments are performed to demonstrate that DiffVAE can be used in various visualization tasks: sometimes, data is partially labeled, and sometimes, the users only want to enforce \u201csoft\u201d priors, such as mixture of Gaussian, on the visualization.\n\n[1] Vahdat, Arash, and Jan Kautz. \"NVAE: A deep hierarchical variational autoencoder.\" Advances in neural information processing systems 33 (2020): 19667-19679.\n\n[2] Alireza Makhzani, Jonathon Shlens, Navdeep Jaitly, Ian Goodfellow, and Brendan Frey. Adversarial autoencoders. arXiv preprint arXiv:1511.05644, 2015\n\n[3] Matthew J. Johnson, David Duvenaud, Alexander B. Wiltschko, Sandeep Robert Datta, and Ryan P. Adams. Composing graphical models with neural networks for structured representations and fast inference. In Advances in Neural Information Processing Systems (NIPS) 29, 2016. arXiv:1603.06277 [stat.ML].\n\n***\n> **Q2** The increased expressivity also comes at a computational cost - sampling from the diffusion model can be quite expensive (for example in the experiments the authors use 20 and 100 steps which means 20 forward passes of a neural network. Where do the authors believe the increased expressivity would be useful enough to trade-off the computation cost?\n\n**A2** We would like to point out that we are conducting a diffusion process with low-dimensional latents, which means the computational overhead will not be affected much. E.g., for MNIST, the dimensionality (1xd) of latents is much smaller than the actual data (28x28) size. \n\nTo further support the efficiency of DiffVAE, we conduct a computational cost analysis between the baselines and DiffVAE with various timesteps on the genotype clustering/visualization experiments. The table below shows that DiffVAE outperforms baselines at all timestamps and continues to improve after the baselines have plateaued.\n\n**Computational cost trade-off on 1kgenome: NMI vs wall-clock training time**\n\nNMI @ Wall-clock training time (min)\n| Method          | NMI @ 10 min | NMI @ 20 min | NMI @ 30 min | NMI @ 40 min| NMI @ 50 min| NMI @ 60 min|\n|-----------------|----------|----------|----------|----------|----------|----------|\n| VAE             | 0.52     | 0.52     | 0.52     | 0.52     | 0.52     | 0.52     |\n| IAF-VAE         | 0.54     | 0.52     | 0.52     | 0.52     | 0.52     | 0.52     |\n| AAE             | 0.61     | 0.57     | 0.57     | 0.57     | 0.57     | 0.57     |\n| DiffVAE (T=5)   | warm up  | 0.63     | 0.63     | 0.66     | 0.66     | 0.66     |\n| DiffVAE (T=10)  | warm up  | **0.64**     | **0.68**     | **0.70**     | **0.70**     | **0.70**     |\n| DiffVAE (T=20)  | warm up  | 0.50     | 0.51     | 0.56     | 0.64     | 0.68     |\n| DiffVAE (T=50)  | warm up  | 0.52     | 0.54     | 0.51     | 0.59     | 0.59     |\n\nSince our key application here is dimensionality reduction and visualization, all experiments in our paper run in just a few hours max, not days. We believe that the additional training time is still reasonable such that practitioners are willing to wait for better results."
                    }
                },
                "number": 8,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission7583/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700600830525,
                "cdate": 1700600830525,
                "tmdate": 1700600830525,
                "mdate": 1700600830525,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "ppvnLX5rKQ",
                "forum": "61mnwO4Mzp",
                "replyto": "dQycveNXq8",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission7583/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission7583/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Response to Reviewer t61r (Part 2)"
                    },
                    "comment": {
                        "value": "***\n> **Q3** The method also introduces a critical new hyperparameter - the number of steps for diffusion. The paper does not discuss how this parameter is selected and how sensitive the results are to the choice of this parameter.\n\n**A3** We use 20 timesteps as the default setup of this hyperparameter. And we keep it unchanged across all experiments in our paper. The results show that with this default value, we can match the aggregated posterior and the prior well, which indicates it is, at least, not too sensitive that needs exhaustive tuning.\n\nThe users of the method can also inspect the visualization results and increase it if there is a relatively big mismatch between the aggregated posterior and the prior, as we did for semi-supervised learning experiments. The key here is that the number of steps for diffusion is the type of hyperparameter that is the higher the better, at the expense of longer training time. Thus, it is not as hard to tune as other types of hyperparameters where making them too low or too high can be both bad.\n\nTo support this, we\u2019re copying results from computational cost analysis from part 2 of the replies that shows the performance of DiffVAE at different timesteps here:\n\nNMI @ Wall-clock training time (min)\n| Method          | NMI @ 10 min | NMI @ 20 min | NMI @ 30 min | NMI @ 40 min| NMI @ 50 min| NMI @ 60 min|\n|-----------------|----------|----------|----------|----------|----------|----------|\n| DiffVAE (T=5)   | warm up  | 0.63     | 0.63     | 0.66     | 0.66     | 0.66     |\n| DiffVAE (T=10)  | warm up  | **0.64**     | **0.68**     | **0.70**     | **0.70**     | **0.70**     |\n| DiffVAE (T=20)  | warm up  | 0.50     | 0.51     | 0.56     | 0.64     | 0.68     |\n| DiffVAE (T=50)  | warm up  | 0.52     | 0.54     | 0.51     | 0.59     | 0.59     |\n\nWe note that the model with T=10 outperforms the one with T=5, and the performances of the models with T=20 and T=50 have not yet plateaued at 60 min."
                    }
                },
                "number": 9,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission7583/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700600926174,
                "cdate": 1700600926174,
                "tmdate": 1700600953252,
                "mdate": 1700600953252,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "s5sfC4arsf",
                "forum": "61mnwO4Mzp",
                "replyto": "dQycveNXq8",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission7583/Reviewer_t61r"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission7583/Reviewer_t61r"
                ],
                "content": {
                    "comment": {
                        "value": "Thanks for the response! \n\nA1: I feel I have to push back on that a bit. As you mentioned CIFAR/MNIST are synthetic benchmarks but seem insufficient for a method where added expressiveness is a major pitch. The biological task is indeed interesting but it is hard to understand how well that performance transfers to other domains. \n\nA2: Thanks for the runtime details, it is quite helpful. It does seem like the results are not sensitive to the diffusion steps. However, this potentially points to my previous concerns of the tasks being \"too easy\" to take advantage of the benefits afforded by DiffVAE. \n\nOverall, I agree with Reviewer 18s7 that the paper has an intriguing set of ideas but falls short of demonstrating the effectiveness on appropriate tasks and benchmarks."
                    }
                },
                "number": 14,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission7583/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700676375779,
                "cdate": 1700676375779,
                "tmdate": 1700676384885,
                "mdate": 1700676384885,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "9daM20waHR",
            "forum": "61mnwO4Mzp",
            "replyto": "61mnwO4Mzp",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission7583/Reviewer_Qkoy"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission7583/Reviewer_Qkoy"
            ],
            "content": {
                "summary": {
                    "value": "This paper proposes a novel latent variable inference method, DiffVAE that combines the variational autoencoder and diffusion models. More specifically, DiffVAE enhances the expressive power of the variational posterior by designing a denoising process on augmented latent variables which transforms a complex latent variable into a simple augmented latent variables. Alternative perspective from auxiliary variable models and regularization, and extensions to semi-supervised learning and the clustering are also provided. In experiments, the authors demonstrate the effectiveness of their method on both unsupervised learning, semi-supervised learning genotype clustering tasks. The results indicate that DiffVAE performs better in terms of NLL metric and clustering quality in the latent space."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "2 fair"
                },
                "strengths": {
                    "value": "- The paper proposes a novel method to enhance the expressive power of the variational posterior in VAE by diffusion model.\n- The adaption of wake-sleep algorithm for a more informative training of the encoder is interesting.\n- The paper is written clearly, especially on related background and alternative perspectives."
                },
                "weaknesses": {
                    "value": "The DiffVAE method is natural and interesting. However, the method is closely related to auxiliary variable models/hierarchical variational models (HVM) [1] (albeit some small modifications such as additional regularizations). Also, the design of the training objective needs better justification.\n\n1. The authors propose $\\hat{\\mathcal{L}}$ in equation (7) to replace the original lower bound $\\mathcal{L}$ in order to address the requirement of sampling $x$ from $p_\\theta$.\nThey consider $L_{\\mathrm{sleep}}(x,\\phi)$ as a regularization of the original ELBO.\nI'm concerned that this part of the process may lack sufficient justification since the gradient of $q_\\phi(z|x)$ is biased for the original ELBO.\n2. There aren't much detail about the updating scheme of parameters $\\phi$ and $\\theta$ in the experiments.\n\n[1] Rajesh Ranganath, Dustin Tran, and David Blei. Hierarchical variational models. In International conference on machine learning, pp. 324\u2013333. PMLR, 2016."
                },
                "questions": {
                    "value": "- In section 3.1.1., \"learning signal from this procedure to be too weak to learn a good $q_\\phi(z|y)$\" is not clear enough, can you clarify this point more clearly? This is a crucial point that motivates your approach (otherwise, HVM would be enough)\n- How are the parameters $\\theta$ and $\\phi$ updated? Is $\\theta$ only updated from the reconstruction loss and $\\phi$ only updated from the sleep loss?\n- It seems that the $\\mathcal{L}_{\\mathrm{sleep}}$ term does nothing but pushing the encoder towards the prior. It is, therefore, no wonder that DiffVAE performs better in term of recovering the true prior. It would be better to compare the NLL (instead of latent NLL) for the learned generative model as well.\n- The paper would be strengthened by including HVM with a fixed reversed model as a baseline model (which is equivalent to DiffVAE without $\\mathcal{L}_{\\mathrm{sleep}}$) in the experiments.\n- As a method mentioned in the related work, [1] proposed LSGM, which can also be seen as a VAE with a reversed diffusion prior. Could you please provide a more detailed comparison between this method and DiffVAE, and clarify whether it can also be used for semi-supervised learning?\n\nTypos\n\n- In the third paragraph of the background section, the term $ D_{\\mathrm{KL}}(p_\\theta(z|x)||q_\\phi(z|x)$ should be $ D_{\\mathrm{KL}}(p_\\theta(z|x)||q_\\phi(z|x))$.\n- Omissions that may lead to misunderstandings. For example, the expectation in equation (4) should be $p_\\theta(x,z)$ rather than $p(x,z)$; $D_{KL}(p_\\theta\\|q(z|x))$ should be $D_{KL}(p_\\theta\\|q_\\phi(z|x))$.\n- The second row corresponding to the prior appears to be square rather than Swissroll in figure 2.\n\n[1] Vahdat, Arash, Karsten Kreis, and Jan Kautz. \"Score-based generative modeling in latent space.\" NIPS 2021."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "5: marginally below the acceptance threshold"
                },
                "confidence": {
                    "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 4,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission7583/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698822621926,
            "cdate": 1698822621926,
            "tmdate": 1699636918047,
            "mdate": 1699636918047,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "AzjMCOWttk",
                "forum": "61mnwO4Mzp",
                "replyto": "9daM20waHR",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission7583/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission7583/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Response to Reviewer Qkoy (Part 1)"
                    },
                    "comment": {
                        "value": "We want to thank the reviewer for the thoughtful review and constructive feedback. We address each of your comments below:\n\n***\n> **Q1** However, the method is closely related to auxiliary variable models/hierarchical variational models (HVM) [1] (albeit some small modifications such as additional regularizations). \nAlso, the design of the training objective needs better justification.\nIn section 3.1.1., \"learning signal from this procedure to be too weak to learn a good q(z|y) is not clear enough, can you clarify this point more clearly?\n\n**A1** We would like to include here a table comparing the training objectives and approximating family of different baselines, including a newly added HVAE w/ flow baseline, with our method below:\n\n**Comparison of DiffVAE to other relevant methods**\n| Model   | Training Objective | Approximating Family | Sample-based Prior | Auxiliary Variable | Tasks | Simplified Graphical Illustration |\n|---------|--------------------|----------------------|--------------------|--------------------|-------|-----------------------------------|\n| VAE \t| ELBO           \t| Diagonal Gaussian\t| No             \t| No             \t| Density estimation | $\\mathbf{x}$ -> $\\mathbf{z}$ -> $\\mathbf{x}$ |\n| IAF-VAE | ELBO           \t| Normalizing flow \t| No             \t| Yes            \t| Density estimation/Visualization | $\\mathbf{x}$ -> $\\mathbf{z}_0$ -> $\\mathbf{z}_T$ -> $\\mathbf{x}$ |\n| AAE \t| Adversarial training | Adversarial generator | Yes           \t| No             \t| Visualization | $\\mathbf{x}$ -> $\\mathbf{z}$ -> $\\mathbf{x}$ |\n| HVAE w/o and w/ flow | ELBO | Factorial Normal / Normalizing flow | No \t| Yes           \t| Density estimation/High-quality sample generation | $\\mathbf{x}$ -> $\\mathbf{z}_0$ -> $\\mathbf{z}_T$ -> $\\mathbf{z}_0$ -> $\\mathbf{x}$ |\n| ADGM\t| ELBO           \t| Non-Gaussian     \t| No             \t| Yes            \t| Density estimation | $\\mathbf{x}$ -> $\\mathbf{a}$ -> $\\mathbf{z}$ -> $\\mathbf{x}$ |\n| LDM \t| ELBO           \t| Diagonal Gaussian\t| No             \t| Yes            \t| High-quality sample generation | $\\mathbf{x}$ -> $\\mathbf{z}_0$ -> $\\mathbf{z}_T$ -> $\\mathbf{z}_0$ -> $\\mathbf{x}$ |\n| LSGM\t| ELBO+score matching | Diagonal Gaussian   | No             \t| Yes            \t| High-quality sample generation | $\\mathbf{x}$ -> $\\mathbf{z}_0$ -> $\\mathbf{z}_T$ -> $\\mathbf{z}_0$ -> $\\mathbf{x}$ |\n| DiffVAE | ELBO+sleep term\t| Denoising diffusion | Yes            \t| Yes            \t| Density estimation/Visualization | $\\mathbf{x}$ -> $\\mathbf{z}_T (\\mathbf{y})$ -> $\\mathbf{z}_0 (\\mathbf{z})$ -> $\\mathbf{x}$ |\n\nTo justify the need for our training objective, we show (failed) results of VAE with diffusion encoder trained with standard ELBO below:\n\n**Unsupervised learning on MNIST, including the failed results of VAE with Diffusion**\n|    Method              | Latent NLL  (Pinwheel)       | Latent NLL  (Swiss Roll)      | Latent NLL  (Square)      |\n| --------------- | ------------------ | ------------------ | ----------------- |\n| VAE             | 6.18 \u00b1 0.93        | 82.96 \u00b1 99.30      | 25.07 \u00b1 62.41     |\n| IAF-VAE         | 2.06 \u00b1 0.21        | 12.13 \u00b1 18.28      | 1.53 \u00b1 0.82       |\n| AAE             | 1.94 \u00b1 0.09        | 3.43 \u00b1 0.14        | 1.97 \u00b1 0.70       |\n| HVAE w/ flow    | 2.18 \u00b1 0.13        | 4.17 \u00b1 1.23        | **1.25 \u00b1 0.08**   |\n| DiffVAE         | **1.57 \u00b1 0.10**    | **3.19 \u00b1 0.07**    | **1.24 \u00b1 0.13**   |\n| **VAE with Diffusion (standard ELBO)** | 6.09 | 510.53 | 265.25 |\n\nAs you can see, VAE with Diffusion (standard ELBO) totally fails to respect the prior. The intuition is as follows: \n\nThe objective samples from the reverse diffusion process instead of the forward diffusion process like in standard diffusion training (please see Sec. 3.1.1 for the details). Specifically, for the term\n$E_{q_\\psi(\\mathbf{z_{0:T}}|\\mathbf{x})} [D_{KL}(q_\\psi(\\mathbf{z_{t-1}}|\\mathbf{z_t}, \\mathbf{x})||r(\\mathbf{z_{t-1}}|\\mathbf{z_t}, \\mathbf{z_0}))]$ in VAE with Diffusion (standard ELBO) objective,\nwe have to backpropagate through $\\mathbf{z_0}$ and $\\mathbf{z_t}$ all the way to $\\mathbf{z_T}$. This long chain of backpropagation makes the learning signal weak; the same does not happen in standard diffusion training because $z_0$ is the data that does not need to be backpropagated.\n\n***\n> **Q2** They consider L_sleep as a regularization of the original ELBO. I'm concerned that this part of the process may lack sufficient justification since the gradient of q(z|x) is biased for the original ELBO.\n\n**A2** The concern regarding the bias in the gradient of $q (\\mathbf{z} | \\mathbf{x})$ for the original ELBO is acknowledged. However, in DiffVAE, we've introduced a new lower bound specifically designed for our model. The gradient is unbiased for our objective, which is a valid lower bound; empirically, this new lower bound works better."
                    }
                },
                "number": 10,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission7583/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700602347638,
                "cdate": 1700602347638,
                "tmdate": 1700683272056,
                "mdate": 1700683272056,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "l8lQsCLClt",
                "forum": "61mnwO4Mzp",
                "replyto": "9daM20waHR",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission7583/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission7583/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Response to Reviewer Qkoy (Part 2)"
                    },
                    "comment": {
                        "value": "***\n> **Q3** There aren't much detail about the updating scheme of parameters? How are the parameters updated?\n\n**A3** Here is the pseudocode for the training algorithm\n\n***\nDiffVAE Training Algorithm\n---\nFor each batch of inputs $\\mathbf{X}$\n\nOptimize $\\theta$ and $\\phi$ with respect to $\\mathcal{L_{rec}}(\\mathbf{X}, \\theta, \\phi) + \\beta \\cdot \\mathcal{L_{reg}}(\\mathbf{X}, \\theta, \\phi)$\n\nOptimize $\\phi$ with respect to $\\gamma \\cdot \\mathcal{L_{sleep}}(\\mathbf{X}, \\phi)$\n\nEnd\n***\n\nThe training algorithm alternates between optimizing $\\theta$ and $\\phi$ with respect to $\\mathcal{L_{rec}} + \\beta \\cdot \\mathcal{L_{reg}}$ and optimizing only $\\phi$ with respect to $\\mathcal{L_{sleep}}$\n\n***\n> **Q4** The paper would be strengthened by including HVM with a fixed reversed model as a baseline model (which is equivalent to DiffVAE without L_sleep in the experiments.\n\n**A4** We run a HVAE with normalizing flow [1]  baseline for unsupervised learning experiments, please see results below:\n\n**Unsupervised learning on MNIST**\n| Method        | Acc (Pinwheel)      | Latent NLL (Pinwheel) | Acc (Swiss Roll)     | Latent NLL (Swiss Roll) | Acc (Square)        | Latent NLL (Square) |\n|---------------|---------------------|-----------------------|----------------------|-------------------------|---------------------|---------------------|\n| VAE           | 0.58 \u00b1 0.01         | 6.18 \u00b1 0.93           | 0.56 \u00b1 0.055         | 82.96 \u00b1 99.30           | 0.35 \u00b1 0.02         | 25.07 \u00b1 62.41       |\n| IAF-VAE       | **0.71 \u00b1 0.00**     | 2.06 \u00b1 0.21           | 0.67 \u00b1 0.02          | 12.13 \u00b1 18.28           | 0.65 \u00b1 0.03         | 1.53 \u00b1 0.82         |\n| AAE           | 0.67 \u00b1 0.02         | 1.94 \u00b1 0.09           | 0.68 \u00b1 0.03          | 3.43 \u00b1 0.14             | 0.57 \u00b1 0.02         | 1.97 \u00b1 0.70         |\n| HVAE w/ flow  | **0.72 \u00b1 0.01**     | 2.18 \u00b1 0.13           | **0.71 \u00b1 0.02**      | 4.17 \u00b1 1.23             | **0.70 \u00b1 0.01**     | **1.25 \u00b1 0.08**     |\n| DiffVAE       | **0.72 \u00b1 0.01**     | **1.57 \u00b1 0.10**       | 0.66 \u00b1 0.01          | **3.19 \u00b1 0.07**         | **0.72 \u00b1 0.03**     | **1.24 \u00b1 0.13**     |\n\n**Unsupervised learning on CIFAR-10**\n| Method        | Acc (Pinwheel)      | Latent NLL (Pinwheel) | Acc (Swiss Roll)     | Latent NLL (Swiss Roll) | Acc (Square)        | Latent NLL (Square) |\n|-----------------|-------------------|-------------------|-------------------|-------------------|-------------------|-------------------|\n| VAE             | 0.16 \u00b1 0.01     | 86.9 \u00b1 99.03    | 0.15 \u00b1 0.01     | 360.41 \u00b1 185.87 | 0.15 \u00b1 0.01     | 63.3 \u00b1 70.64    |\n| IAF-VAE         | 0.19 \u00b1 0.01     | 3.12 \u00b1 1.16     | 0.16 \u00b1 0.01     | 189.39 \u00b1 57.48  | 0.18 \u00b1 0.01     | 0.99 \u00b1 0.11     |\n| AAE             | 0.23 \u00b1 0.00     | 2.30 \u00b1 0.07     | **0.23 \u00b1 0.01** | **2.84 \u00b1 0.08** | 0.20 \u00b1 0.01     | 1.46 \u00b1 0.49     |\n| HVAE w/ flow    | 0.20 \u00b1 0.01     | 2.06 \u00b1 0.07     | 0.20 \u00b1 0.01     | 106.15 \u00b1 15.30 | 0.19 \u00b1 0.01     | 1.05 \u00b1 0.06     |\n| DiffVAE         | **0.23 \u00b1 0.01** | **1.37 \u00b1 0.02** | **0.23 \u00b1 0.01** | **2.80 \u00b1 0.11** | **0.24 \u00b1 0.01** | **0.86 \u00b1 0.05** |\n\n[1] Ranganath, Rajesh, Dustin Tran, and David Blei. \"Hierarchical variational models.\" International conference on machine learning. PMLR, 2016.\n\n***\n> **Q5** As a method mentioned in the related work, [1] proposed LSGM, which can also be seen as a VAE with a reversed diffusion prior. Could you please provide a more detailed comparison between this method and DiffVAE, and clarify whether it can also be used for semi-supervised learning?\n\n**A5** We have a discussion of it in our paper. We copy it here for convenience: \u201cThese works focus on sample quality and directly fit $q_\\phi (\\mathbf{z} | \\mathbf{x})$ to a complex distribution; our work instead seeks to achieve high sample quality in latent space, and obtains complex $\\mathbf{z}$ by diffusion from a simple $\\mathbf{y}  \\sim q_\\phi(\\mathbf{y} | \\mathbf{x})$.\u201d\n\nTo provide more details, contrasting our model with Latent Diffusion Models (LDM) and Latent Score-based Generative Models (LSGM), a key difference lies in the nature and role of the latent variables. In LDM and LSGM, the latent variables typically represent downscaled images, which the decoder then upscales to generate the final output. In our model, however, the latent variables have a different interpretation. They are the auxiliary variables of the encoder that make the approximate posterior more expressive.\n\nBoth can be used for semi-supervised learning.\n\n***\n> **Q6** Typos\n\n**A6** We thank the reviewer for identifying the typos, which we have corrected"
                    }
                },
                "number": 11,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission7583/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700610890801,
                "cdate": 1700610890801,
                "tmdate": 1700683288160,
                "mdate": 1700683288160,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "w83m1vCQ7h",
                "forum": "61mnwO4Mzp",
                "replyto": "l8lQsCLClt",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission7583/Reviewer_Qkoy"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission7583/Reviewer_Qkoy"
                ],
                "content": {
                    "comment": {
                        "value": "Thank you for your response. I would like to keep my score."
                    }
                },
                "number": 12,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission7583/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700636299707,
                "cdate": 1700636299707,
                "tmdate": 1700636299707,
                "mdate": 1700636299707,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    }
]