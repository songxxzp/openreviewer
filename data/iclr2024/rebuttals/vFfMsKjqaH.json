[
    {
        "title": "Interpreting Categorical Distributional Reinforcement Learning: An Implicit Risk-Sensitive Regularization Effect"
    },
    {
        "review": {
            "id": "TZBeMWoplh",
            "forum": "vFfMsKjqaH",
            "replyto": "vFfMsKjqaH",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission6360/Reviewer_tqyH"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission6360/Reviewer_tqyH"
            ],
            "content": {
                "summary": {
                    "value": "The paper proposes a novel interpretation of the distributional Bellman operator based on entropy entropy regularization. Specifically, it represents the continuous return distribution by a histogram of fixed support with equal bin size. Then the return distribution can be decomposed into a single-bin histogram (i.e. the bin the expectation of the return distribution falls into) and a term characterizing the impact of the return distribution despite its expectation. The relative weights between the two terms are regulated by a pre-defined hyperparameter. The authors then move on to show that this decomposition of the return distribution allows the distributional Bellman operation (which they call Neural Fitted Z-Iteration) to be reframed as a cross entropy-regularized Neural FQI when the distribution divergence to minimize is chosen as the KL divergence. They've demonstrated convergence of the decomposed distributional Bellman operator when minimizing the KL divergence as a consequence of the equivalence between optimizing histogram function and categorical distribution. Finally they proposed a new actor-critic algorithm incorporating the cross-entropy regularization. Experiments on Atari and Mujoco demonstrated better overall performance and analyzed the interplay between two types of entropy regularization."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "2 fair"
                },
                "contribution": {
                    "value": "2 fair"
                },
                "strengths": {
                    "value": "1. proposed and analyzed a novel angle to distributional RL\n2. thorough experiments"
                },
                "weaknesses": {
                    "value": "1. I'm not so sure how enlighening the findings of the paper are. When you choose the KL divergence to minimize, equivalently you're maximizing cross-entropy. It doesn't come off as much of added value if you've shown the distributional Bellman operator minimizing KL is equivalent to a cross entropy regularized conventional Bellman operator when you approximate (I wouldn't say decompose, as the epsilon term renders your decomposition not exact) the return distribution as an expectation term and a categorical distribution.\n\n2. (minor) insufficient rigourousness in basic concepts, e.g., in Introduction, Q-learning is a type of TD learning not a separate category. Also TD learning is not specific to expectation-based RL, most existing distributional RL including the referenced CDRL is TD learning (i.e. bootstrapping from other timesteps) w.r.t. return distributions. And CDRL doesn't seem an actor-critic to me as the policy is just argmax of expected atom values."
                },
                "questions": {
                    "value": "1. how the epsilon in Eq. 3 is pre-specified? Should it not be dependent on the actual return distribution which cannot be known in advance? Am I correct in the understanding that you are actually not learning the full return distribution, but still its expectation albeit allowing some uncertainty around it?\n\n2. if so, it seems to me you're matching the expaction whilst expanding it according to a pre-defined level of uncertainty retained from the target distribution. In this case, how would you ensure that the so expanded distribution still has the same expectation/the correct expectation?\n\n3. if you are minimizing KL divergence, how would you ensure the return distribution model is and remains as a histogram which is count-based?\n\n4. in Eq. 5, you're regularzing the cross-entropy between consecutive 'return distributions'. How is it connected to maximum-entropy RL which encourages 'policy' entropy or cross-entropy between the policy and a reference policy? There seems no bridge to me to be built between uncertainty in action selection and that in return estimate, the only connection perhaps being both can be approached by augmenting the reward function with the entropy term. In fact, I failed to understand the claim that your regularization is favouring target return distributions with large dispersion. It seems to me only to push the dispersion of the return distribution model to catch up with the dispersion of the target return distribution.\n\n5. (minor) how and why a policy can be learned to reduce the intrinsic uncertainty of the environment, shouldn't it by definition be intrinsic and thus independent from the policy?"
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "details_of_ethics_concerns": {
                    "value": "N/A"
                },
                "rating": {
                    "value": "6: marginally above the acceptance threshold"
                },
                "confidence": {
                    "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                },
                "first_time_reviewer": {
                    "value": "Yes",
                    "readers": [
                        "ICLR.cc/2024/Conference/Program_Chairs",
                        "ICLR.cc/2024/Conference/Submission6360/Senior_Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission6360/Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission6360/Reviewer_tqyH"
                    ]
                }
            },
            "number": 1,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission6360/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1697820065653,
            "cdate": 1697820065653,
            "tmdate": 1699636702032,
            "mdate": 1699636702032,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "FuFYKlVJ5x",
                "forum": "vFfMsKjqaH",
                "replyto": "TZBeMWoplh",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6360/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6360/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Author Response"
                    },
                    "comment": {
                        "value": "Thank you for taking the time to review our paper. We appreciate your positive assessment and insightful feedback, and we would like to address the concerns you raised in your review.\t\n\t\n> how the epsilon in Eq. 3 is pre-specified? Should it not be dependent on the actual return distribution which cannot be known in advance? Am I correct in the understanding that you are actually not learning the full return distribution, but still its expectation albeit allowing some uncertainty around it?\n\t\n**A:** Eq.3 is to show that the return density can be decomposed via a pre-specified $\\epsilon$, which controls the proportion of the expectation and the regularization part. Eq.3 does not imply that we are going to learn only based on the expectation, but to focus on the validity of the density decomposition. For example, in the sensitivity analysis in Figure 2, we are using the regularization term with different $\\varepsilon$ to optimize the neural network in order to verify the impact of it.\n\t\n> if so, it seems to me you're matching the expaction whilst expanding it according to a pre-defined level of uncertainty retained from the target distribution. In this case, how would you ensure that the so expanded distribution still has the same expectation/the correct expectation?\n\t\n**A:** Yes. The expectation can be inherently maintained by simply taking the expectation over both sides in Eq. 3. Since the first part maintains the same/correct expectation with the weight $1-\\epsilon$, the remaining term accordingly has the same expectation with the weight $\\epsilon$.\n\t\n\t\n> if you are minimizing KL divergence, how would you ensure the return distribution model is and remains as a histogram which is count-based?\n\t\n**A:** The validity of the induced distribution is guaranteed in Proposition 1 for a certain range of $\\epsilon$. The counted-based histogram is inherently maintained via the decomposition in Eq. 3.\n\t\n\t\n> in Eq. 5, you're regularzing the cross-entropy between consecutive 'return distributions'. How is it connected to maximum-entropy RL which encourages 'policy' entropy or cross-entropy between the policy and a reference policy? There seems no bridge to me to be built between uncertainty in action selection and that in return estimate, the only connection perhaps being both can be approached by augmenting the reward function with the entropy term. In fact, I failed to understand the claim that your regularization is favouring target return distributions with large dispersion. It seems to me only to push the dispersion of the return distribution model to catch up with the dispersion of the target return distribution.\n\t\n\t\n**A:** Let us look at Eq. 10 to compare with MaxEnt RL in Eq. 7. Since we know $a_i = \\pi(\\cdot | s_i)$, optimizing the regularization term implicitly updates the policy $\\pi$. By contrast, MaxEnt RL explicitly update the policy via maximizing the entropy in Eq. 7\n\t\nIn terms of Eq. 5, the regularization term in the value-based RL includes $q_\\theta$, and optimizing Eq. 5 will directly affect the update of $q_\\theta$. Note that $a_i =\\arg\\max_a \\mathbb{E} [q_\\theta^{s_i, a}]$, which therefore connects the return estimate with the action selection. \n\t\nWe would like to clarify that we did not claim the regularization would certainly favor target return distribution with a large dispersion. **We state that it tends to do that as the original $q_\\theta$ only captures the expectation and it tends to expand the distribution with a larger variance to match the distribution**. However, we agree your statement is safer and more accurate, which is that regularization in general helps to catch up with the dispersion of the target distribution. We have revised them appropriately in the updated paper.\n\t\n> (minor) how and why a policy can be learned to reduce the intrinsic uncertainty of the environment, shouldn't it by definition be intrinsic and thus independent from the policy?\n\t\n\t\n**A:**  The intrinsic uncertainty has been discussed in [1, 2], which is defined as the stochasticity of the environment, including the transition dynamics and stochastic reward function. Since distributional RL makes full use of the distribution information of return, it is deemed to reduce the intrinsic uncertainty of the environment for better performance.\n\t\n\t\nWe thank the reviewer once again for the time and effort in reviewing our work! We are more than happy to answer any other questions you have.\n\t\n[1] Implicit Quantile Networks for Distributional Reinforcement Learning (ICML 2018)\n\t\n[2] Distributional Reinforcement Learning for Efficient Exploration (ICML 2019)"
                    }
                },
                "number": 5,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6360/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700629857961,
                "cdate": 1700629857961,
                "tmdate": 1700629857961,
                "mdate": 1700629857961,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "qESkAT2KRs",
                "forum": "vFfMsKjqaH",
                "replyto": "FuFYKlVJ5x",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6360/Reviewer_tqyH"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6360/Reviewer_tqyH"
                ],
                "content": {
                    "comment": {
                        "value": "Thank you authors for your response.\n\nSo if my understanding based on the paper and your responses is correct, the method does not actually learn the full return distribution but still just the expectation plus a predefined level of dispersion, with varying performance w.r.t. the choice of this level but no way of determining its optimal value in advance. I'm not so sure how valuable this design is.\n\nI understand that regularizing the return distribution affects the policy. What I failed to see is how encouraging the dispersion of the return distribution to match the dispersion of a target distribution is equivalent to encouraging the entropy of the policy as in MaxEnt RL, i.e. how uncertainty in return is translated to uncertainty in action.\n\nLastly so you're capturing the intrinsic uncertainty, as opposed to reducing it, as it's out there objectively.\n\nDue to the above and also the weaknesses in my original review to which the authors didn't seem to object, I'll keep my score."
                    }
                },
                "number": 8,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6360/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700673394681,
                "cdate": 1700673394681,
                "tmdate": 1700673394681,
                "mdate": 1700673394681,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "REs3VaBJ9N",
            "forum": "vFfMsKjqaH",
            "replyto": "vFfMsKjqaH",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission6360/Reviewer_rBfi"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission6360/Reviewer_rBfi"
            ],
            "content": {
                "summary": {
                    "value": "This paper studies why distributional reinforcement learning (RL) can achieve successful empirical results. They mainly investigate the Categorical Distributional RL (CDRL) and indicate its strength comes from risk-sensitive entropy regularization. They showed that this regularization serves as an augmented reward function, pushing the learned distribution toward the target one. Experiments highlight this regularization's importance in distributional RL."
                },
                "soundness": {
                    "value": "2 fair"
                },
                "presentation": {
                    "value": "2 fair"
                },
                "contribution": {
                    "value": "2 fair"
                },
                "strengths": {
                    "value": "This paper studies an important question (why distributional RL is successful), and the way that they consider the distributional RL (or specifically, the categorical RL) is interesting. The theoretical claims are supported by the experiments."
                },
                "weaknesses": {
                    "value": "The paper is a bit hard to follow. Some of the theoretical derivation is not followed by intuitive explanation or proof sketch. For example, eq. (3) and the subsequent remarks confused me regarding what $\\hat\\mu$ and $p_i^\\mu$ are. Does $p_i^\\mu$ mean the coefficient of the corresponding bin? I also don't see what $\\mu^{s,a}$ is two lines below. Moreover, I failed to understand eq. (6) and what Proposition 3 tries to convey, specifically regarding the integral on the right. Additionally, Theorem 2 asserts the convergence of the learned policy, yet it does not specify under what notion it converges, that is, it lacks clarity on the measure under which it converges.\n\nI found most theoretical results rely on the assumption that $\\mathcal{H}(\\mu^{s,a},q_\\theta^{s,a})$ is bounded by a constant for all $s,a$, which I think needs to be justified. I guess $\\mu$ is the resulting histogram density, so the difference here might depend on the range of support and $N$, and thus the upper bound might actually look like the results in [1].\n\nOverall, I think this paper may need some necessary polish to improve clarity before I can make an informed evaluation.\n\n\n\n[1] Rowland, M., Bellemare, M., Dabney, W., Munos, R. and Teh, Y.W., 2018, March. An analysis of categorical distributional reinforcement learning. AISTATS, 2018."
                },
                "questions": {
                    "value": "The formulation of neural FZI is similar to [2]. The latter focuses on maximizing the log-likelihood, which is equivalent to minimizing the KL divergence or cross-entropy. The authors also proposed to specify the $d_p$ in eq.(2) to KL divergence, so the formulation looks almost same. Hence, I am wondering about the potential connection here.\n\n[2] Wu, R., Uehara, M. and Sun, W. Distributional Offline Policy Evaluation with Predictive Error Guarantees. ICML, 2023."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "3: reject, not good enough"
                },
                "confidence": {
                    "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 2,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission6360/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698642457584,
            "cdate": 1698642457584,
            "tmdate": 1699636701823,
            "mdate": 1699636701823,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "KjRf3trTcy",
                "forum": "vFfMsKjqaH",
                "replyto": "REs3VaBJ9N",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6360/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6360/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Author Response"
                    },
                    "comment": {
                        "value": "Thank you for taking the time to review our paper. We appreciate your comments and we have revised the paper accordingly. Here we would like to address the concerns you raised in your review.\n\n> Eq. (3) and the subsequent remarks confused me regarding what $\\widehat{\\mu}$ is? Does mean the coefficient of the corresponding bin? \n\t\n**A:** We apologize for this confusion and we thus have provided the detailed definition of $\\widehat{\\mu}$  in the revised version. $p^\\mu_{i}$  is indeed the coefficient of the corresponding bin with the bin height $p^\\mu_{i}/\\Delta$.\n\t\n\t\n>Moreover, I failed to understand eq. (6) and what Proposition 3 tries to convey, specifically regarding the integral on the right.\n\t\n**A:** Generally speaking, Eq. 6 and Proposition 3 try to convey that **minimizing the term (a) in the decomposed Neural FZI is equivalent to Neural FQI in the limit case**, allowing us to use the regularization term to interpret the benefits of distributional RL over classical RL analyzed later. \n\t\nThe integral part additionally shows the **uniform convergence rate** of distribution difference in terms of $\\Delta$, which turns out to be an order of $\\mathcal{O}(\\Delta)$.\n\t\n> Additionally, Theorem 2 asserts the convergence of the learned policy, yet it does not specify under what notion it converges, that is, it lacks clarity on the measure under which it converges.\n\t\n**A:** **The optimal policy is defined based on the optimal Q function**. In our proof, following SAC paper, we show the algorithm converges to the optimal Q function~(the maximum), and thus the corresponding policy/policies would be optimal. Please refer to  Appendix H.3 for more details.\n\t\n>I found most theoretical results rely on the assumption that the bounded entropy....\n\t\n**A:** The bounded assumption is natural and mild as the convergence of the Bellman operator typically requires **a bounded reward assumption**. Note that our cross-entropy term serves as the augmented rewards, for which it is natural to assume to be bounded to allow the convergence accordingly. \n\t\n>I think this paper may need some necessary polish to improve clarity before I can make an informed evaluation.\n\t\n**A:** Thanks for this suggestion and we have substantially improved the clarity based on all the reviewers' suggestions in the rebuttal phase. We appreciate an informed evaluation of our paper.\n\t\n>The formulation of neural FZI is similar to [2]. The latter focuses on maximizing the log-likelihood, which is equivalent to minimizing the KL divergence or cross-entropy. The authors also proposed to specify the divergence in eq.(2) to KL divergence, so the formulation looks almost the same. Hence, I am wondering about the potential connection here.\n\t\n\t\n**A:** [2] can be viewed as a **distributional version of Fitted Q evaluation in the offline setting**, whose target is to provide the **prediction error guarantee in the off-policy evaluation**. Based on the relationship of MLE they used and KL divergence, [2] can approximately serve as the prediction error guarantee for offline CDRL. However, our target is to interpret the benefits of distribution RL starting from CDRL, which is very different from [2]. \n\t\nWe would also like to clarify that [2] used **TV and Wasserstein distance instead of KL** in their theoretical analysis to derive the prediction error guarantee in an offline setting, which we focus on interpreting the KL-based practical CDRL algorithms in online cases. \n\t\nIn summary, the main contribution and research target between [2] and us are different and based on different divergences, although the algorithm part shares some similarities with CDRL algorithm.\n\t\nWe thank the reviewer once again for the time and effort in reviewing our work! We would greatly appreciate it if the reviewer could check our responses and let us know whether they address the raised concerns. We are more than happy to provide further clarification if you have any additional concerns. Should this rebuttal address your concerns, we would be grateful for a revised score."
                    }
                },
                "number": 4,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6360/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700629466372,
                "cdate": 1700629466372,
                "tmdate": 1700629466372,
                "mdate": 1700629466372,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "SJd7XzfJk1",
            "forum": "vFfMsKjqaH",
            "replyto": "vFfMsKjqaH",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission6360/Reviewer_73VF"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission6360/Reviewer_73VF"
            ],
            "content": {
                "summary": {
                    "value": "In this work, the authors take a closer look at the categorical\ndistributional RL framework and study the properties of the\noptimization problems therein. Inspired by their analysis, the paper\npresents a novel framework (DERPI) for model-free RL similar to MaxEnt\nRL, and an associatedc\nactor-critic algorithm (DERAC) based on this framework. Optimization\nin the DERPI framework is shown to be closely related to categorical\ndistributional RL, thereby establishing a connection between\ncategorical disatributional RL and MaxEnt RL."
                },
                "soundness": {
                    "value": "2 fair"
                },
                "presentation": {
                    "value": "1 poor"
                },
                "contribution": {
                    "value": "3 good"
                },
                "strengths": {
                    "value": "This paper presents some interesting insights into the optimization of\nreturn distributions in categorical distributional RL, and inspired by\nthese insights, proposes a new framework for exploration in RL. The\nnew framework is closely related to the highly successful MaxEnt RL,\nbut it performs reward shaping based on the mismatch between the\npredicted return distribution and its target, which I believe is novel\nand sensible. This framework also explicitly leverages the \"auxiliary\ntasks\" quality of distributional RL for exploration, which is satisfying."
                },
                "weaknesses": {
                    "value": "Many of the mathematical statements and objects are not defined\nprecisely -- this is a recurring issue throughout the text, making it\nextremely difficult to follow. Please see the \"Questions\" section for\nfurther details.\n\nThe histogram parameterization given in equation (3) needs more\nclarification. Some terms are left undefined (e.g. $p_i^\\mu$), making\nit difficult to understand the model and the motivation.\n\nAs discussed more in \"Questions\", the return distribution\ndecomposition is fairly mysterious to me. It seems that the purpose is\nto show that some component of CDRL is sort of 'mimicking' expected\nvalue RL. However, this is already known, since it is known that the\ncategorical projection $\\Pi_{\\mathcal{C}}$ is mean-preserving. Thus,\nI do not undertand the value of Proposition 3: we already know that\nCDRL will learn the mean of the return distribution function.\n\nGenerally, I do not agree that the proposed algorithms are\nrisk-sensitive in any meaningful sense -- they simply have an\nadditional distribution-matching term in the reward signal. The\nrisk-seeking/risk-averse behavior is driven by a mismatch in return\ndistribution estimates and not a specified propensity for risk\n(i.e. there is no way to control or predict how risk-averse the agent\nwill be).\n\nThe connection between DERPI and CDRL is not established clearly at\nall, which is a shame, since I believe this is the most significant\nfinding. Particularly, I belive the content of Appendix I, notably\nequation (37), should be clearly written in the main text and\ndiscussed. As it stands, this part is easy to miss, and I believe it\nis crucial for tying together the claims of the paper.\n\n## Minor issues\nOn page 3 in the \"Return Density Function Decomposition\" paragraph,\nthere is a typo in \"we utilize a histgram function estimator\".\n\nProposition 1 would read better if the $\\iff$ was substituted by the\ntext \"if and only if\"."
                },
                "questions": {
                    "value": "In the \"Bellman Operators vs Distributional Bellman Operators\"\nsection, it says tha random variable definition of the distributional\nBellman operator is less mathematically rigorous than the\nreturn-distribution definition -- what do you mean by this? Both\ndefinitions should be equivalent.\n\nI doubt Theorem 1 is novel, it is essentially a concentration\ninequality on histogram estimates. It is also not clear to me what is\nmeant by $O_P$ here. What is the difference between Theorem 1 and\ne.g. the DKW inequality?\n\nThe object $\\widehat{\\mu}^{s,a}$ is not defined clearly at all.\nParticularly, $p_i^\\mu$ is not defined anywhere.\nIs $\\widehat{\\mu}^{s,a}$ just the difference between the \"true\"\nhistogram of the return distribution function and the histogram with\nall mass (times $1-\\epsilon$) in $\\Delta_E$?\n\nRight after Proposition 1, what does \"this decomposition exactly keeps\nthe vanilla (categorical) distributional RL scenario without shifting\nproblems\" mean? What are shifting problems?\n\nI don't agree that the second term of equation (5) is doing\n\"risk-sensitive entropy regularization\". It is neither risk-seeking\nnor risk-neutral (at least, not intuitively). Moreover, I wouldn't\nclassify this as a regularization term -- it is directly learning the\nparameters of the model -- the only \"regularization\" here is the\nexplicit constraint of modeling categorical distributions. But\nregardless of the parameterization of the return distribution\nfunction, you can decompose the return distributions into a term\nencapsulating the mean and the other encapsulating the rest of the\nstatistics. Is the idea that under the KL loss, the loss for the mean\ncomponent does not interact with the rest of the loss?\n\n\nI don't understand the claim of equation (6). It says that with\nprobability 1, $Z_\\theta^{k+1}=\\mathcal{T}Q_{\\theta^*}(s,a)$ -- how\ncan this be true? Isn't $Z$ supposed to represent the random return?\nIn this case, why should it be deterministic?\n\nThe proof of proposition 3 is sloppy. Firstly, equation (29) is incorrect -- the KL is not\nproportional to the last line, it is missing an additive\n$\\Delta\\log\\Delta$ term I believe (though this does not change the\nminimizer).\nMore importantly, the claim that the limiting optimizer as $\\Delta\\to\n0$ is not proved correctly -- you proved that the limit of the\nminimizer tends to the Dirac, but not that the minimizer of the limit\ntends to the Dirac, as claimed. However, again I am not really\nconcerned about the correctness of the claim here.\nEquation (30) is not justified to me at all -- the target should still\ninclude the $\\mu$ term, which seems to have disappeared. I believe the\nconfusion is coming from misleading notation. To my understanding, the\nclaim of Proposition 3 is that this is the behavior if you optimize\nthe random returns only w.r.t. term (a), but then that is not really\n$Z$. So really, what this proposition is saying is that if the targets are\ndeterministic, they are at the expected return and CDRL will converge\nto the Diracs at the expected return, but we already know this from\ne.g. \"An Analysis of Categorical Distributional Reinforcement\nLearning\" by Rowland et. al."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "5: marginally below the acceptance threshold"
                },
                "confidence": {
                    "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
                },
                "code_of_conduct": {
                    "value": "Yes"
                },
                "first_time_reviewer": {
                    "value": "Yes",
                    "readers": [
                        "ICLR.cc/2024/Conference/Program_Chairs",
                        "ICLR.cc/2024/Conference/Submission6360/Senior_Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission6360/Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission6360/Reviewer_73VF"
                    ]
                }
            },
            "number": 3,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission6360/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698702021605,
            "cdate": 1698702021605,
            "tmdate": 1699636701610,
            "mdate": 1699636701610,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "8kf7pMMPmR",
                "forum": "vFfMsKjqaH",
                "replyto": "SJd7XzfJk1",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6360/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6360/Authors"
                ],
                "content": {
                    "title": {
                        "value": "(1/2) Author Response"
                    },
                    "comment": {
                        "value": "Thank you for taking the time to review our paper. We appreciate your comments and feedback, and we would like to address the concerns you raised in your review.\n\t\n>Q1: In the \"Bellman Operators vs Distributional Bellman Operators\" section, it says tha random variable definition ....\n\t\n**A:** This statement can refer to Chapter 4 of the book [1]. In particular, the random-variable operator may not be rigorous enough as it specifies a return distribution without identifying a mapping from the sample space to the real number, i.e., definite the probability measure.  However, the theory of contraction mappings needs a clear de\ufb01nition of the space on which an operator is de\ufb01ned, i.e., the probability space of the return distribution defined in advance.\n\t\nWe clearly state this difference in case any theory reviewers favor the more rigorous definition. However, we agree with you the difference is minor. \n\t\n>Q2: I doubt Theorem 1 is novel, it is essentially a concentration inequality on histogram estimates....\n\t\n**A:** The big O definition is a commonly used convergence process in probability theory, and here we provide the wiki reference: https://en.wikipedia.org/wiki/Big_O_in_probability_notation.  In particular, it characterizes a stochastic boundedness in the convergence in probability.\n\t\nThe main similarity is both Theorem 1 and DKW are derived by leveraging the commonly used concentration inequality, and thus some parts share a similar form. However, the main difference is that DKW focuses on the (sample-based) empirical distribution, while Theorem 1 provides results about the histogram-based estimator in the context of CDRL.\n\t\n>Q3: The objection $\\widehat{\\mu}^{s, a}$ is not defined clearly ....\n\t\n**A:** Thank you for pointing out this clarity issue and we have fixed it according. It is true that $\\widehat{\\mu}$ is the induced histogram estimator, which is used to characterize the regularization effect / the benefits of distributional RL regardless of the expectation of return distributions.\n\t\n>Q4: Right after Proposition 1, what does \"this decomposition exactly keeps the vanilla (categorical) distributional RL...\n\t\n**A:** We have paraphrased this sentence as ''Under this valid return density decomposition condition, this return density decomposition approach precisely maintains the standard categorical distribution framework in distributional RL''. This statement is made to clarify the potential concerns that this decomposition may change the objective function of CDRL. However, as stated in the new sentence, the original CDRL framework is carefully maintained. \n\t\n>Q5: I don't agree that the second term of equation (5) is doing \"risk-sensitive entropy regularization\"....\n\t\n**A:** We would like to clarify this potential misunderstanding. According to the literature [2], **risk** refers to uncertainty over possible outcomes, and **risk-sensitive policies** are those that depend upon more than the mean of the outcomes. This implies that our risk-sensitive policies, which are indeed risk-neutral, typically refer to the capability to reduce the intrinsic uncertainty of the environment. We know distributional RL provides a framework for risk-sensitive RL, including the risk-seeking or risk-averse policies, and therefore, it can be achieved **by changing the convexity or concavity of the utility function [2] on the return distribution** in the interaction phase of the environment, i.e., the behavior policy side. For example, IQN [2] changes different weights to average the quantiles to select the actions interacting with the environment. This risk-seeking or risk-averse framework can be very naturally incorporated into our algorithm or Neural FZI, by changing the greedy rule $\\pi_Z(s^\\prime_i)= \\arg\\max_{a^\\prime} \\mathbb{E}\\left[Z_{\\theta^*}^{k}(s_i^\\prime, a^\\prime)\\right]$ in Eq. 2 with some specified utility function, $\\pi_Z(s^\\prime_i)= \\arg\\max_{a^\\prime} U(Z_{\\theta^*}^{k}(s_i^\\prime, a^\\prime))$.\n\t\nRegarding the regularization mechanism in Eq. 5, note that $a_i$ is selected by the policy, which is also determined by $q_\\theta$. Thus, minimizing the term (a) and the regularization term will optimize the policy via $q_\\theta$."
                    }
                },
                "number": 2,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6360/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700628740105,
                "cdate": 1700628740105,
                "tmdate": 1700628740105,
                "mdate": 1700628740105,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "R01juzpvQX",
                "forum": "vFfMsKjqaH",
                "replyto": "SJd7XzfJk1",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6360/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6360/Authors"
                ],
                "content": {
                    "title": {
                        "value": "(2/2) Author Response"
                    },
                    "comment": {
                        "value": ">Q6: I don't understand the claim of equation (6). It says that with probability.....\n\t\n**A:** $Z^{k+1}$ is a random variable and the convergence in probability 1 indicates that $Z^{k+1}$ would equal to a constant $\\mathcal{T} Q_{\\theta^*}$. The $\\mathcal{T} Q_{\\theta^*}$ is a constant in each Neural FZI as we use the target network trick, where the target is fixed in each iteration phase of Neural FZI.\n\t\n>Q7: The proof of proposition 3 is sloppy. Firstly, equation (29) is incorrect.....\n\t\n**A:** Thanks for pointing out some inaccurate parts in our proof and we have revised this proof accordingly, also including the limit of the minimizer issue in the Appendix.\n\t\nIt is correct that proposition 3 is about optimizing the term (a) and thus the target distribution does not include the $\\widehat{\\mu}$ term. Regarding the relationship between [3], An Analysis of Categorical Distributional Reinforcement Learning\" by Rowland et. al, note that [3] and other related works showed that most distributional RL algorithms can enjoy the mean preserving properties, but **our focus is to interpret the extra benefits of distributional RL over only this expectation part**. To this end, it is necessary to connect the term (a) with the optimization in terms of the expectation part, thus **allowing us to attribute the benefits to the regularization**. As far as we are concerned, proposition 3 is a crucial step towards interpreting the regularization effect. The results in proposition 3 actually coincide with the mean-preservation properties in distributional RL, which can help to substantiate the technical soundness of our decomposition.\n\t\nWe thank the reviewer once again for the time and effort in reviewing our work! We would greatly appreciate it if the reviewer could check our responses and let us know whether they address the raised concerns. We are more than happy to provide further clarification if you have any additional concerns. Should this rebuttal address your concerns, we would be grateful for a revised score. \n\t\n\t\n[1] Bellmare et al. Distributional Reinforcement Learning (MIT press)\n\t\n[2] Dabney et al. Implicit quantile network for distributional reinforcement learning (ICML 2018)\n\t\n[3] Rowland et. al. An Analysis of Categorical Distributional Reinforcement Learning\" (AISTATS 2018)"
                    }
                },
                "number": 3,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6360/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700628984694,
                "cdate": 1700628984694,
                "tmdate": 1700628984694,
                "mdate": 1700628984694,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "MJTRwrTOeV",
                "forum": "vFfMsKjqaH",
                "replyto": "R01juzpvQX",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6360/Reviewer_73VF"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6360/Reviewer_73VF"
                ],
                "content": {
                    "comment": {
                        "value": "Thanks to the authors for the responses. While this cleared up some of my questions, a few still remain.\n\n> ... risk refers to uncertainty over possible outcomes, and risk-sensitive policies are those that depend upon more than the mean of the outcomes. This implies that our risk-sensitive policies, which are indeed risk-neutral, typically refer to the capability to reduce the intrinsic uncertainty of the environment.\n\nI still think it's very misleading to call your algorithm \"risk-sensitive\". Basically every principled RL algorithm tries to reduce intrinsic uncertainty (this is the exploration problem), but they are generally not considered risk-sensitive. Moreover, it is not clear that this is even the phenomenon that your approach deals with -- the return distribution models aleatoric uncertainty, so the \"risk-sensitive regularization\" should not necessarily have the effect of reducing intrinsic uncertainty.\n\n> We know distributional RL provides a framework for risk-sensitive RL, including the risk-seeking or risk-averse policies, and therefore, it can be achieved by changing the convexity or concavity of the utility function [2] on the return distribution in the interaction phase of the environment, i.e., the behavior policy side.\n\nThis is true, I guess, but it's a fairly weak argument in my opinion. Firstly, this is not what you do in the paper. This form of risk-sensitivity, like you say, can be employed in any distributional RL method, so it is not particular to your algorithm/analysis. Moreover, this is generally not even a principled method of performing risk-sensitive policy optimization: generally, the optimal risk-sensitive policy will not be {stationary, deterministic, Markov}.\n\n> $Z^{k+1}$ is a random variable and the convergence in probability 1 indicates that would equal to a constant $\\mathcal{T}Q_{\\theta^*}$\n\nI still don't understand this at all. I understand what the mathematical statement is saying, which to reiterate what you suggest, is that $Z^{k+1}\\to\\mathcal{T}Q_{\\theta^*}$ in probability. But with stochastic dynamics, there is no reason that the return should be deterministic. My suspicion is that a key assumption is missing in the statement of this proposition, or at the very least, there is some miscommunication about what $Z^{k+1}$ represents here."
                    }
                },
                "number": 7,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6360/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700659875205,
                "cdate": 1700659875205,
                "tmdate": 1700659875205,
                "mdate": 1700659875205,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "ERsEAxWIKV",
            "forum": "vFfMsKjqaH",
            "replyto": "vFfMsKjqaH",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission6360/Reviewer_FbE9"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission6360/Reviewer_FbE9"
            ],
            "content": {
                "summary": {
                    "value": "The paper establishes an equivalent representation of distributional RL (with a histogram representation of random variables) that seem to indicate that it takes the form of a regularized Q-iteration. This might also explain why categorical distributional RL might implicitly encourage exploration."
                },
                "soundness": {
                    "value": "1 poor"
                },
                "presentation": {
                    "value": "1 poor"
                },
                "contribution": {
                    "value": "1 poor"
                },
                "strengths": {
                    "value": "The paper investigates an important question: namely, how to explain the better performance of distributional RL algorithms. It articulates an innovative perspective on the question by decomposing the random variable representation as a mixture of a measure concentrated at the mean and a measure that embodies the spread."
                },
                "weaknesses": {
                    "value": "The paper is highly obscure and filled with ambiguous statements and typos that prevented me from validating most of its claims. It also appear to support its theory using arguments that lack rigour or purely contradictory. I finally disagree with the claim on page 4 that distributional RL produces risk sensitive policies:\n\nExamples of lack of rigour:\n- the use of the concept of \"ideal case\" mentioned at the bottom of page 2 to support the idea that Neural FQI converges to optimal Q-function, which is reused in the proof of proposition 3 to assume that neural FZI's iterate recover the Bellman update. \n- a mismatch of assumption between the statement of proposition 3 and its proof, where the former assumes that the $Y_i$'s are representable while the latter assumes that $E[Y_i]$ is.\n\nExample of contradiction:\nProposition 3 is contradicting itself in equation (6). The left equation claims that the minimizer over $q_\\theta$ converges to the k+1 iterate of the Q function in FQI while on the right claiming that it converges to the actual Q-value function.\n\nTypos & inclarities include:\n- p2: defining the support of \\hat \\eta first as $z_i$ then later by $l_i$\n- Eq 1: $[y_i - Q_\\theta(s_i,a_i)]^2$ instead of $[y_i - Q_\\theta^k(s_i,a_i)]^2$\n- Eq. 2: similar issue but for $Z_\\theta^k(s_i,a_i)$\n- p.3 \"As such, this ... shifting problems\" needs rewritting\n- p.3 \"the the\"\n- p.4 I suspect that in proposition 2 $\\Delta_E^i$ represents the interval that $E[ R(s,a) + \\gamma Z_k^\\pi(s_i',\\pi_Z(s_i') ]$ and that generally there is a confusion between this expression and $E[Z^\\pi(s,a)]$. \n- p.2  why define $R(s,a)$ with capital when it is a deterministic reward? \n- p.3 in an expression like $Y_i = R(s_i,a_i)+\\gamma Z_{\\theta^*}^k(s_i',\\pi_Z(s_i'))$ there needs to be a notation warning that lower cases variables are given.\n- p4 the definition of $\\hat \\mu$ in proposition 2 is inaccurate as it seems to be the induced histogram from the decomposition of $Y_i$\n- p4 \"for $\\forall$ k\" should be \"for all k\""
                },
                "questions": {
                    "value": "I do not have questions as I believe the paper needs a thorough rewriting and is currently unfit for publication."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "3: reject, not good enough"
                },
                "confidence": {
                    "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
                },
                "code_of_conduct": {
                    "value": "Yes"
                },
                "first_time_reviewer": {
                    "value": "Yes",
                    "readers": [
                        "ICLR.cc/2024/Conference/Program_Chairs",
                        "ICLR.cc/2024/Conference/Submission6360/Senior_Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission6360/Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission6360/Reviewer_FbE9"
                    ]
                }
            },
            "number": 4,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission6360/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698812992811,
            "cdate": 1698812992811,
            "tmdate": 1699636701453,
            "mdate": 1699636701453,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "bpOSSvxwbA",
                "forum": "vFfMsKjqaH",
                "replyto": "ERsEAxWIKV",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6360/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6360/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Author Response"
                    },
                    "comment": {
                        "value": "Thank you for taking the time to review our paper. We appreciate your comments and feedback, and we would like to address the concerns you raised in your review.\n\t\n>General Question: The paper is highly obscure and filled with ambiguous statements and typos that prevented me from validating most of its claims. It also appear to support its theory using arguments that lack rigour or purely contradictory. I finally disagree with the claim on page 4 that distributional RL produces risk sensitive policies:\n\t\n**A:** We apologize for the confusion generated by the clarity issue. Thus, we have improved our claim following your suggestions throughout the paper as appropriate, and sincerely hope the current version is easier to follow. We will also be happy to edit the paper further based on any further helpful comments from the reviewers. The specific update corresponds to each clarity issue you raised as follows.\n\t\n>Examples of lack of rigour: the use of the concept of \"ideal case\" mentioned at the bottom of page 2 to support the idea that Neural FQI converges to optimal Q-function. \n\t\n**A:** Thanks for pointing out this issue. We have provided more specific explanations, respectively, instead of using ``the ideal case''. This is a commonly used assumption about the richness of function class in statistical learning theory. In Neural FQI, we explain as $\\\\{Q_\\theta: \\theta \\in  \\Theta\\\\}$ is sufficiently large such that it contains $\\mathcal{T}^{opt} Q_{\\theta^*}^{k}$, while in Neural FZI and proposition 3, we explain as $\\\\{Z_\\theta: \\theta \\in  \\Theta\\\\}$ is sufficiently large such that it contains $\\{Y_i\\}_{i=1}^n$. We also revised it accordingly to the updated version.\n\t\n>Examples of lack of rigour: a mismatch of assumption between the statement of proposition 3 and its proof ... \n\t\n**A:** We would like to clarify that $\\mathbb{E}\\left[Y_i\\right]$ can be representable is a corollary if $\\\\{Y_i\\\\}$ is representable as the $\\mathbb{E}\\left[Y_i\\right]$ is (the limit of ) the  first component of $\\{Y_i\\}$'s pdf via our decomposition.\n\t\n\t\n>Example of contradiction: Proposition 3 is contradicting itself in equation (6). The left equation claims that the minimizer over converges to the k+1 iterate of the Q function in FQI while on the right claiming that it converges to the actual Q-value function.\n\t\n**A:** We apologize for this typo, where the action Q-value function should be replaced with the $k+1$ iterate of the Q function, which is thus consistent with the left equation. We have fixed the typo in the revised paper, where, specially, the correct form of the right equation  is updated as: \n\t\n$$\\int_{-\\infty}^{+\\infty}\\left|F_{q_\\theta}(x)-F_{\\delta_{ \\mathcal{T}^{\\text{opt}} Q^k_{\\theta^*}(s, a)}}(x)\\right| d x =o(\\Delta)$$\n\t\n\t\n>Q: Typos and inclarity include: ...\n\t\n$A:$ Thank you for noting these typos and we have fixed them appropriately. For example, we acknowledge that p.4 $\\Delta_E^i$ represents the interval of $\\mathbb{E}[Y_i]$ instead of the current return distribution and added a notation warning about the low case random variables. We also gave a more accurate definition of $\\widehat{\\mu}$.\n\t\nPlease refer to the updated paper for more details. Please let us know if there are any other typos you had in mind for correction.\n\t\nWe thank the reviewer once again for the time and effort in reviewing our work! As suggested, in the rebuttal period, we have finished the throughout notation revisions to allow an informed evaluation. We would greatly appreciate it if the reviewer could check our responses and are more than happy to provide further clarification if you have any additional technical concerns about our paper."
                    }
                },
                "number": 1,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6360/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700628240646,
                "cdate": 1700628240646,
                "tmdate": 1700628240646,
                "mdate": 1700628240646,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    }
]