[
    {
        "title": "StableSSM: Alleviating the Curse of Memory in State-space Models through Stable Reparameterization"
    },
    {
        "review": {
            "id": "cqWqrrQH4u",
            "forum": "BwG8hwohU4",
            "replyto": "BwG8hwohU4",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission279/Reviewer_4Tez"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission279/Reviewer_4Tez"
            ],
            "content": {
                "summary": {
                    "value": "The paper is about alleviating the \"curse of memeory\" in sequence modeling. Authors treat the training of a state-space model (SSM or linear RNN) as an estimation of regularized linear functional $\\mathbf{H}$, and proves that the normal SSM with stable approximation shows exponential decay and thus cannot estimate functions with non-exponential decay. Then, it is proved that using reparameterization such as softplus can alleviate this problem, and also suggest optimal reparameterization operator for the given task."
                },
                "soundness": {
                    "value": "2 fair"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "3 good"
                },
                "strengths": {
                    "value": "The main theorems about the curse of memory and the necessity of reparameterization is thoroughly supported with assumptions and resulting proofs."
                },
                "weaknesses": {
                    "value": "1. The analysis on the curse of memeory is limited to the simple state space model approximating linear decay. Reparameterization technique may not be applicable for sequential models with more complex structures.\n\n2. It is not clear that why the \"best\" reparameterization should satisfy that the gradient is Lipshitz to the weight."
                },
                "questions": {
                    "value": "1. As the numerical examples mainly show the results on gradient to weight ratio, how can you justify that this quantity is related with better training?\n\n2. Can this analysis be extended to more complex models such as multi-layer RNN or transformer-based RNN?"
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "details_of_ethics_concerns": {
                    "value": "No ethics review needed."
                },
                "rating": {
                    "value": "5: marginally below the acceptance threshold"
                },
                "confidence": {
                    "value": "2: You are willing to defend your assessment, but it is quite likely that you did not understand the central parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 1,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission279/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698770457496,
            "cdate": 1698770457496,
            "tmdate": 1699637377631,
            "mdate": 1699637377631,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "qiyEtGgt3k",
                "forum": "BwG8hwohU4",
                "replyto": "cqWqrrQH4u",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission279/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission279/Authors"
                ],
                "content": {
                    "comment": {
                        "value": "We thank the reviewer for their thoughtful comments and constructive feedback.\n\nWeaknesses:\n1. `The analysis on the curse of memeory is limited to the simple state space model approximating linear decay. Reparameterization technique may not be applicable for sequential models with more complex structures.`\n\n    The reparameterization technique can also be applied to sequential models with more complex structures in the following sense: \n    In multi-layer state-space models, we implement the analysis outlined in Theorem 3.4 on a layer-by-layer basis. \n    When examining the gradient of recurrent weights, denoted as $\\lambda=f(w)$, the same bounds on gradient norm are applicable even for more complex structures. \n        $$G_{f}(w) := \\left | \\frac{\\partial \\textrm{Loss}}{\\partial w} \\right | \\leq C_{\\mathbf{H}, \\widehat{\\mathbf{H}}_m} \\frac{|f'(w)|}{f(w)^2}.$$\n    The coefficient $C$ is a target-dependent and model-dependent coefficient, yet it is **independent of the parameterization scheme $f$**.\n    Therefore our Theorem 3.4 (in Page 6) is also effective for more complex structures. \n    The reparameterization only change the recurrent weights' gradients, the gradients of other weights will not be influenced. \n\n    We include further numerical experiments (see Appendix D, page 22-24) on the image classifications and associative recalls to demonstrate the effectiveness of stable reparameterizations.\n    It can be seen the stable reparameterizations guarantee a good performance while the case without reparameterization fail to achieve convergence.\n    As we maintain the same initializations of the weights, the only difference across these models are the parameterization schemes of the recurrent weights $\\Lambda$. \n\n\n2. `It is not clear that why the \"best\" reparameterization should satisfy that the gradient is Lipshitz to the weight.`\n\n    We propose the \"best\" reparameterization to further improve the optimization stability. \n    The **intuitive** explanation is that a function with \"gradient is Lipschitz to the weight\" is more similar to the quadratic functions.\n    Therefore this property is important for the optimization. \n\n    A theoretical explanation will be given as follow: \n    For non-convex optimizations, the Lipschitz-smooth property is a commonly used assumption to achieve the convergence of the models [1]. \n    Without Lipschitz-smooth property, function $f(x) = \\sqrt{x}$ cannot converge to the optimal solution $x^*=0$ using fixed positive learning rate $\\eta$. \n\n    The criterion \"gradient is Lipschitz to the weight\" is a **necessary condition** for the stability in the following sense (We include the detailed proof in Appendix F, page 25):\n- Consider functions $f(x) = x^4$, the gradient function $g(x)=4x^3$ does not have a global Lipschitz coefficient for all input values $x$. Therefore for any positive fixed learning rate $\\eta$, there exists an initial point $x_0$ such that the convergence cannot be achieved via the gradient descent step. \n    $$x_{k+1} = x_k - \\eta g(x).$$ \n    Usually a smaller learning rate and a fine-tuned learning rate scheduler is necessary for the  convergence at that $x_0$. \n- Consider functions $f(x) = x^2$, the gradient function $g(x) = 2x$ is associated with a Lipschitz constant $L=2$. Then the same gradient descent step converges for any $\\eta \\leq \\frac{1}{L} = \\frac{1}{2}$ and any initial point $x_0$.\n- As can be seen in the above two examples, the criterion **\"gradient is Lipschitz to the weight\" is associated with the convergence under large learning rate**. \n    As the use of larger learning rate is usually associated with faster convergence [2], smaller generalization errors [3], we believe the Lipschitz criterion is a suitable stability criterion for the measure of optimization stability. \n- The gradient-to-weight ratio evaluated in Figure 4(a) is a numerical verification of our Theorem 3.4. \n    The gradients scale of stable reparameterizations are milder therefore less susceptible to the well-known issue of exploding or vanishing gradients [4,5].\n\n\n\nQuestions:\n1. `As the numerical examples mainly show the results on gradient to weight ratio, how can you justify that this quantity is related with better training?`\n\n    Kindly refer to the response provided for point 2 of the weaknesses, particularly the last paragraph, for further clarification on this question.\n\n2. `Can this analysis be extended to more complex models such as multi-layer RNN or transformer-based RNN?`\n\n    As we mentioned in reply to point 1 of the weaknesses, our analysis can be extended in the following sense: \n    When we evaluate the gradients of the recurrent weights in complex multi-layer models, the state-space model layers also satisfy the same gradient bounds from the Theorem 3.4."
                    }
                },
                "number": 5,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission279/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700653830812,
                "cdate": 1700653830812,
                "tmdate": 1700653830812,
                "mdate": 1700653830812,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "vdjPE6U4B0",
                "forum": "BwG8hwohU4",
                "replyto": "cqWqrrQH4u",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission279/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission279/Authors"
                ],
                "content": {
                    "comment": {
                        "value": "References\n\n[1] Allen-Zhu, Zeyuan, Yuanzhi Li, and Zhao Song. \"A convergence theory for deep learning via over-parameterization.\" In International conference on machine learning, pp. 242-252. PMLR, 2019.\n\n[2] Smith, Leslie N., and Nicholay Topin. \"Super-convergence: Very fast training of neural networks using large learning rates.\" In Artificial intelligence and machine learning for multi-domain operations applications, vol. 11006, pp. 369-386. SPIE, 2019.\n\n[3] Li, Yuanzhi, Colin Wei, and Tengyu Ma. \"Towards explaining the regularization effect of initial large learning rate in training neural networks.\" Advances in Neural Information Processing Systems 32 (2019).\n\n[4] Bengio, Yoshua, Patrice Simard, and Paolo Frasconi. \"Learning long-term dependencies with gradient descent is difficult.\" IEEE transactions on neural networks 5, no. 2 (1994): 157-166.\n\n[5] Hochreiter, Sepp. \"The vanishing gradient problem during learning recurrent neural nets and problem solutions.\" International Journal of Uncertainty, Fuzziness and Knowledge-Based Systems 6, no. 02 (1998): 107-116."
                    }
                },
                "number": 6,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission279/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700653847551,
                "cdate": 1700653847551,
                "tmdate": 1700653847551,
                "mdate": 1700653847551,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "HVCC6qoGel",
                "forum": "BwG8hwohU4",
                "replyto": "cqWqrrQH4u",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission279/Reviewer_4Tez"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission279/Reviewer_4Tez"
                ],
                "content": {
                    "comment": {
                        "value": "It seems that the crucial theorem is that the memeory function $\\rho(t)$ can be approximated with recurrent weights $\\Lambda$ when the model is linear RNN. Wouldn't such $\\Lambda$ be unobtainable when the model is not simple linear RNN?"
                    }
                },
                "number": 8,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission279/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700667576502,
                "cdate": 1700667576502,
                "tmdate": 1700667576502,
                "mdate": 1700667576502,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "nxCM5dr3aH",
                "forum": "BwG8hwohU4",
                "replyto": "cqWqrrQH4u",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission279/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission279/Authors"
                ],
                "content": {
                    "comment": {
                        "value": "Thank you for your prompt response. \n\nTheorem 3.3 is established for the approximation of linear functional with linear RNNs.\nWhen the target is nonlinear functional and models are multi-layer state-space models with layer-wise nonlinearities, the same result holds in the following sense: \nLet $\\mathbf{H}$ be the target sequential relationship, $\\widehat{\\mathbf{H}}$ be the theoretical optimal model and $\\widetilde{\\mathbf{H}}$ be the perturbed model, then by the triangular inequality the stable approximation of the target $\\mathbf{H}$ can be achieved if the optimal model $\\widehat{\\mathbf{H}}$ can be stably approximated. \n$$|| \\mathbf{H} - \\widetilde{\\mathbf{H}}|| \\leq || \\mathbf{H} - \\widehat{\\mathbf{H}}|| + || \\widehat{\\mathbf{H}} - \\widetilde{\\mathbf{H}}||.$$\nAs the optimal model comes with a specific representation in $\\Lambda^*$, therefore apply the result from linear RNNs can give us the stable approximation of optimal model $\\widehat{\\mathbf{H}}$ with perturbed models."
                    }
                },
                "number": 9,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission279/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700725914026,
                "cdate": 1700725914026,
                "tmdate": 1700726006774,
                "mdate": 1700726006774,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "dMly8adDY7",
            "forum": "BwG8hwohU4",
            "replyto": "BwG8hwohU4",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission279/Reviewer_fvkX"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission279/Reviewer_fvkX"
            ],
            "content": {
                "summary": {
                    "value": "The work proposed a class of reparameterization techniques that lifts the memory limitations in SSM. The authors provide both theoretical analysis and empirical evaluation on the proposed approach."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "3 good"
                },
                "strengths": {
                    "value": "The paper is well organized with detailed theoretical analysis and empirical evaluation. The overall workflow is pretty easy to follow. \n\nThe authors demonstrate that the model structure of state-space models does not address the curse of memory phenomenon, and proposed the stable reparameterization to tackle the issue, While the reviewer didn't checked every detail, the derivation looks to be concrete."
                },
                "weaknesses": {
                    "value": "The empirical evaluation on the synthetic dataset and language model seems are mostly on training behavior, e.g. decrease on training loss, improvement on stability of the training curve etc. Could the proposed approach concretely improve the testing performance? More evaluation on model performance on testing data is needed.\n\nThe author mentioned in multiple places that the theorems are established for the shallow case. Better to make a clarification on how shallow it is and why the same don't establish for deeper cases.\n\nIn introduction, further illustration and demonstration on the disadvantage of exponential decay in memory is needed, as it is the main problem tackled in the work."
                },
                "questions": {
                    "value": "Could the proposed approach concretely improve the testing performance?"
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "6: marginally above the acceptance threshold"
                },
                "confidence": {
                    "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 2,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission279/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698938161961,
            "cdate": 1698938161961,
            "tmdate": 1699635953263,
            "mdate": 1699635953263,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "NgdlPMGmdX",
                "forum": "BwG8hwohU4",
                "replyto": "dMly8adDY7",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission279/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission279/Authors"
                ],
                "content": {
                    "comment": {
                        "value": "We thank the reviewer for the positive feedback. \n\nWeaknesses:\n1. `The empirical evaluation on the synthetic dataset and language model seems are mostly on training behavior, e.g. decrease on training loss, improvement on stability of the training curve etc. Could the proposed approach concretely improve the testing performance? More evaluation on model performance on testing data is needed.`\n\n    Thank you for pointing out the missing validation/test issue. \n    In this paper, we mainly study the effects of parameterization on the approximation and optimization. \n    We show in Appendix D that with stable reparameterizations, the reparameterized models' performances over language model, associative recall and image classification are in general better than the models' without reparameterization. \n    Despite the \"best\" reparameterization does not always present the optimal numerical performance, we further construct an example to show it is optimal in stability (Appendix D.2, page 24). \n    The additional numerical results are summarized in the tables in reply-to-all. \n\n\n2. `The author mentioned in multiple places that the theorems are established for the shallow case. Better to make a clarification on how shallow it is and why the same don't establish for deeper cases.`\n\n    The Theorem 3.4 is given in the shallow case but the gradient norm bounds hold for the deeper models.\n\n    As the reparameterization of state-space models also change the gradient of state-space models, so the gradient analysis holds for the state-space model layer and the gradient of recurrent weights in more complex structures will also be bounded by a parameterization-dependent term in Equation (12), page 6. \n    Therefore the stable reparameterization will also be effective to remove the curse of memory in more complex structures. \n    We include the discussion in Q1 of reply-to-all.\n\n\n3. `In introduction, further illustration and demonstration on the disadvantage of exponential decay in memory is needed, as it is the main problem tackled in the work.`\n\n    Thank you for pointing out this writing issue. \n\n    The exponential decay in memory means the models' outputs have a short context in the sense that changing the inputs $x_{(-\\infty,T-l]}$ before context length $l$ has little influence on the outputs $y_T$. For some constant $a$ and $b$,\n    $$|y_T - y_T'| \\leq a * e^{-\\beta l} |x_{T-l} - x_{T-l}'|.$$\n    Therefore the models cannot capture long-term relationships [1]. \n    We have revised the introduction to emphasize the importance of learning long-term memory. \n\n\n\nQuestions:\n1. `Could the proposed approach concretely improve the testing performance?`\n\n    We have answered this question in the reply to point 1 of the weaknesses. \n    We show the stable reparameterizations improve the learning of long-term memory targets in both approximation sense (Figure 1, Page 5) and optimization sense (Appendix D, Page 22-24). \n\n\n\n---\nReferences\n\n[1] Zhong Li, Jiequn Han, E. Weinan, and Qianxiao Li. \"On the Curse of Memory in Recurrent Neural Networks: Approximation and Optimization Analysis.\" In International Conference on Learning Representations. 2020."
                    }
                },
                "number": 4,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission279/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700653806411,
                "cdate": 1700653806411,
                "tmdate": 1700653806411,
                "mdate": 1700653806411,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "ZwNfREcsqE",
            "forum": "BwG8hwohU4",
            "replyto": "BwG8hwohU4",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission279/Reviewer_uWCH"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission279/Reviewer_uWCH"
            ],
            "content": {
                "summary": {
                    "value": "This paper analyzes how SSM-based models approximate target sequences. It proposes a simple criterion based on gradient norm scales to improve the implicit parametrization for the eigenvalue of real-valued SSM, first on a synthetic approximation task, then on a gated-convolution model."
                },
                "soundness": {
                    "value": "1 poor"
                },
                "presentation": {
                    "value": "1 poor"
                },
                "contribution": {
                    "value": "2 fair"
                },
                "strengths": {
                    "value": "* Choosing an appropriate implicit parametrization for SSMs is quite important in practice, and this paper provides a criterion to rank them.\n* I found some of the theoretical connections quite interesting e.g., how the authors use Volterra series to express these models."
                },
                "weaknesses": {
                    "value": "* My main concern with this paper is the disconnect between theory and experimental results: the authors train few small-scale Hyena-SSM model on wikitext, and then attempt to explain how the ranking in training loss corresponds to a ranking with the proposed gradient-norm scale. There are no attempts to perform multiple runs, try in different applications, or verify whether this hypothesis holds with different hyperparameters. In fact, Appendix D shows the rankings change completely by tweaking the learning rate."
                },
                "questions": {
                    "value": "* The experiments rely on exploring different options for the implicit parametrization $f(w)$ of the eigenvalues of a real-valued SSM. Have you considered using small hypernetworks, or alternative parametrizations? Why parametrize only the poles of the SSM implicitly, and not also the residues? \n* Have you considered the effect of the entire architecture block, composed of gating and the SSM, on the choice of parametrization? Could that inform a better metric that better correlated with performance in practice?\n* Can you provide some downstream evaluation of the language model, or at the very least validation loss?\n\n\nSome nitpicks:\n* Eq (2) does not correspond to practical instantiation of SSM-based models, which have linear readout ($c^T h_t$), then a pointwise shallow MLP (either with gating or without)."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "3: reject, not good enough"
                },
                "confidence": {
                    "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 3,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission279/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1699051202988,
            "cdate": 1699051202988,
            "tmdate": 1699635953200,
            "mdate": 1699635953200,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "k1LViNRCCO",
                "forum": "BwG8hwohU4",
                "replyto": "ZwNfREcsqE",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission279/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission279/Authors"
                ],
                "content": {
                    "comment": {
                        "value": "We thank the reviewer for their thoughtful comments and constructive feedback.\n\nSummary:\n    \nThe experiment is not established via gated-convolution model. \n    We use a hyena-based state-space model which parameterizes the recurrent weights using S5 layer instead of the Hyena's implicit convolution form. \n\n\n\nWeaknesses:\n1. `My main concern with this paper is the disconnect between theory and experimental results: the authors train few small-scale Hyena-SSM model on wikitext, and then attempt to explain how the ranking in training loss corresponds to a ranking with the proposed gradient-norm scale. `\n\nHere are the connections between theory and experimental results:\n\n1. We study the stability of state-space models from the parameterization viewpoint. \n2. For **approximation** theory, we point out the importance of stable reparameterization in learning long-term memory. \n    We prove that stable reparameterization is **necessary** (Theorem 3.1, Page 5) and **sufficient** (Theorem 3.3, Page 6) for the long-term memory learning. \n    The necessity is proven in the sense that without reparameterization, the state-space models can only stably approximate targets with exponential memory decay. \n    The sufficiency is proven in the sense that with stable reprameterizations, the linear RNN can stably approximate the linear functionals with **any** memory decay. \n    **We identify a family of stable reparameterizations** (Definition 3.2) that can achieve the stable approximation of long-term memory targets: \n    For some continuous function $g: [0, \\infty) \\to [0, \\infty), g(0)=0$,\n    $$\\sup_w \\left[ |f(w)| \\sup_{|\\tilde{w} - w| \\leq \\beta} \\int_0^\\infty \\left | e^{f(\\tilde{w}) t}  - e^{f(w) t} \\right | dt \\right ] \\leq g(\\beta).$$\n    This family includes a large set of stable reparameterizations. \n    In Appendix B.4 Remark B.3 (Page 17), we show the commonly used parameterizations such as the exponential and softplus parameterization are all stable parameterizations. \n3. Building upon the above theoretical results, it's important to note that there exist alternative reparameterization methods, which, though less explored, are equally capable of achieving a stable approximation of long-term memory. \n    This leads us to a pertinent inquiry: What constitutes the **optimization criterion** for selecting the most stable reparameterization approach in practical applications?\n    The Lipschitz smoothness of the gradient is commonly adopted as an assumption for non-convex optimization, therefore we propose the Lipschitz continuity of gradient in Equation 11 (Page 6) as an optimization criterion for good stability. \n    Further details regarding the motivation for this optimization criterion are comprehensively outlined in Appendix F, on page 23.\n    The gradient norm bounds and the Lipschitz continuity criterion allow us to compare different stable reparameterizations and find the **\"best\" in the criterion of Lipschitz continuity**. \n\n    (**Wikitext as verification**)\n    The training of Hyena-S5 model with 120M parameters on Wikitext is used as a verification for the approximation and optimization properties in Theorem 3.4. \n    We show the initial gradient-over-weight scale in Figure 4(a) and corresponding training loss in Figure 4(b).\n\n    (**Numerical verification of \"best\" parameterization**)\n    The experiments on Wikitext only present the performance of stable reparameterizations over unstable reparameterizations. \n    We further verify the optimization stability of \"best\" reparameterization in the following extreme setting. \n    We construct a large scale language model with 3B parameters and train with larger learning rate (lr=0.01).\n    As can be seen in the following table, the only convergent model is the model with \"best\" reparameterization. \n    We emphasize that the **only difference between these models are the parameterization schemes** for recurrent weights. \n    Therefore the best reparameterization is the most **stable** parameterization. \n    (We repeat the experiments with different seeds for three times. The detail of the experiment is given in Appendix D.2, page 24)\n\n| Reparameterizations | Convergent / total experiments |\n|------------|-----|\n| **\"Best\"** | 3/3 |\n| Exp        | 0/3 |\n| Softplus   | 0/3 |\n| Direct     | 0/3 |"
                    }
                },
                "number": 1,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission279/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700653686382,
                "cdate": 1700653686382,
                "tmdate": 1700653686382,
                "mdate": 1700653686382,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "lLRuOhscwL",
                "forum": "BwG8hwohU4",
                "replyto": "ZwNfREcsqE",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission279/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission279/Authors"
                ],
                "content": {
                    "comment": {
                        "value": "`There are no attempts to perform multiple runs, try in different applications, or verify whether this hypothesis holds with different hyperparameters. In fact, Appendix D shows the rankings change completely by tweaking the learning rate.`\n\nThis is a paper on the study of theoretical properties of parameterizations. \nThe results on synthetic task and language models are numerical verification of the Theorems 3.1, 3.3 and 3.4. \n\nWe further provide additional numerical experiments including associative recall (over long sequences with length 130K) and image classification (MNIST / CIFAR10) in reply-to-all. \nIt can be seen the stable reparameterizations are all better than the case without stable reprameterization.\nAlso, the best reparameterization is better than the exponential and softplus parameterization in the MNIST and CIFAR10 tasks. \n\n\n\nQuestions:\n\n1. `The experiments rely on exploring different options for the implicit parametrization  of the eigenvalues of a real-valued SSM. Have you considered using small hypernetworks, or alternative parametrizations? Why parametrize only the poles of the SSM implicitly, and not also the residues?`\n\n    Thank you for the interesting proposal. \n    The approximation and optimization results of our work have close connections with the suggestion in the following sense:\n    - First, the result in Equation 9 gives a sufficient condition for stable approximation. \n        This condition identifies a family of \"feasible hypernetworks\" for learning long-term memory. \n        Therefore the parameterization with the constraint from Equation (9) gives a feasible set for further optimization. \n    - Second, the Lipschitz criterion (Equation 11) is taken as the specific target for optimization stability in this paper. \n        Our \"best\" parameterization is proposed based on the optimization stability criterion - \"Lipschitz continuity criterion\". \n        We solve the ordinary differential equation and achieves a low-freedom parameterization: $f(w) = \\frac{1}{aw^2+b}$ with only two degress of freedom. \n        This is consistent with the optimization over hypernetwork idea that your suggested. \n    - Future promising direction includes using hypernetworks and finding suitable reparameterization with gradient-based optimization. \n        With constraints from Equation 9 and new objectives, we can still optimize the hypernetwork, which is out of scope of current work. \n\n    The reason we only parameterize the poles of the SSM implicitly is based the empirical evidence that the output of the model for large time is mostly sensitive to the value of poles [1,2,3,4]. and the gradient of the state-space model parameters\n    The state-space models accumulated the hidden state with linear system $h_{k+1} = \\Lambda h_k + U x_k$. \n    **When the sequence length $T$ is large, $h_T = \\sum_{i=0}^{T-1} \\Lambda^{T-k} U x_k$, even a minor difference of $\\Lambda$ will result in a significant change of hidden state $h_T$.**\n    \n    The selection of parameters for other layers is equally important, though they are less prone to stability issues.\n\n\n2. `Have you considered the effect of the entire architecture block, composed of gating and the SSM, on the choice of parametrization? Could that inform a better metric that better correlated with performance in practice?`\n\n    The entire architecture block is usually complex with different stack of normalization, residual connection and dropouts. \n\n    Our analysis can be generalized to the multi-layer state-space models of complex architectures: \n    Consider the gradient of the recurrent weights in a complex architecture, we still have the same gradient norm bound as characterized by the Theorem 3.4. \n    In particular, the gradient norm bound only depends on the target function, current model function, and the parameterization-dependent scale $\\frac{|f'(w)|}{f(w)^2}$. \n    The detailed discussion is presented in the Q1 of reply-to-all."
                    }
                },
                "number": 2,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission279/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700653723974,
                "cdate": 1700653723974,
                "tmdate": 1700653723974,
                "mdate": 1700653723974,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "mX98zZPDxG",
                "forum": "BwG8hwohU4",
                "replyto": "ZwNfREcsqE",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission279/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission279/Authors"
                ],
                "content": {
                    "comment": {
                        "value": "3. `Can you provide some downstream evaluation of the language model, or at the very least validation loss?`\n\n    This paper primarily presents a theoretical exploration of parameterization properties.\n    We provide the validation loss and perplexity with the standard error for the wikitext103 language modelling. \n\n    | Reparameterizations | Train ppl | Train loss | Test ppl | Test loss |\n    |-------------|-----------|------------|----------|-----------|\n    | Best        | 17.182    | 2.844      | 20.811   | 3.035     |\n    | Exp(S5)     | 15.721    | 2.755      | 20.218   | 3.007     |\n    | Softplus    |**14.570** | **2.679**  |**20.136**| **3.003** |\n    | Direct      | 18.916    | 2.940      | 28.167   | 3.338     |\n    \n    Due to the small size of wikitext dataset and limitation of computing resources, we do not carry out the downstream evaluation of the language models. \n    This evaluation will be part of future numerical evaluation directions. \n\n\n\n4. `Eq (2) does not correspond to practical instantiation of SSM-based models, which have linear readout ($c^T h_t$), then a pointwise shallow MLP (either with gating or without).`\n\n    The Equation 2 corresponds to the practical instantiation of SSM-based models in the following sense: \n    Any practical instantiation of SSM-based models can be implemented as a stack of Eq (2). \n    The pointwise shallow MLP can be realized with state-space model layer with layer-wise nonlinearity by setting recurrent weights $W$ to be 0. \n    $$h_{k,l+2} = U_1 \\sigma (U_2 h_{k, l} + b_2) + b_1.$$\n    We give a graphical demonstration in Appendix E, page 24. \n    Therefore, the Equation 2 is given in a simplified form without sacrificing the expressiveness of the multi-layer state-space models. \n    The results established from Theorem 4.1, 4.3 and 4.4 also hold for the practical versions. \n\n\n\n---\n\nReferences\n\n[1] https://github.com/HazyResearch/state-spaces/blob/main/example.py. The learning rate of recurrent weights is 0.001 while the learning rate for the rest is 0.01. \n\n[2] https://github.com/HazyResearch/safari/issues/28. Hyena architecture is said to be quite sensitive to a few hyperparameters. \n\n[3] https://wandb.ai/jimmysmith1919/S5_ICL/reports/Hyena-red-and-Hyena-S5-blue-on-WikiText-103--Vmlldzo0MTkwODEx?accessToken=pk0zw5w75uo1s4zkn3kh7koum902t4q2yzbm28xk0olzzgxuskoq0g1iyauixlob. The training of Hyena is highly sensitive to the learning rate. The S5 using the exponential parameterization has a relatively better stability. \n\n[4] https://arxiv.org/abs/2208.04933 A smaller learning rate (the SSM learning rate) is applied to the recurrent weights."
                    }
                },
                "number": 3,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission279/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700653748428,
                "cdate": 1700653748428,
                "tmdate": 1700653748428,
                "mdate": 1700653748428,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    }
]