[
    {
        "title": "Overthinking the Truth: Understanding how Language Models Process False Demonstrations"
    },
    {
        "review": {
            "id": "GTDQOzzQCb",
            "forum": "Tigr1kMDZy",
            "replyto": "Tigr1kMDZy",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission8426/Reviewer_Lx2y"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission8426/Reviewer_Lx2y"
            ],
            "content": {
                "summary": {
                    "value": "This paper studies inner mechanism of LLMs when facing false demonstations."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "3 good"
                },
                "strengths": {
                    "value": "I like this paper. This work provides interesting findings."
                },
                "weaknesses": {
                    "value": "1. Since the authors conduct experiments under in-context learning setting, we may not be sure these findings are from models themself or implicit tuning (in-context learning). Could the authors provide explanations?\n\n2. Can we expand tasks to include generation-based tasks like QA?"
                },
                "questions": {
                    "value": "Please see Weaknesses."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "6: marginally above the acceptance threshold"
                },
                "confidence": {
                    "value": "5: You are absolutely certain about your assessment. You are very familiar with the related work and checked the math/other details carefully."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 1,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission8426/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1697879978243,
            "cdate": 1697879978243,
            "tmdate": 1699637050092,
            "mdate": 1699637050092,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "Hs5f1BxSrw",
                "forum": "Tigr1kMDZy",
                "replyto": "GTDQOzzQCb",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission8426/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission8426/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Response #3"
                    },
                    "comment": {
                        "value": "Thank you for your valuable feedback. We hope to address your concerns and answer your questions.\n\n> \u201cSince the authors conduct experiments under in-context learning setting, we may not be sure these findings are from models themself or implicit tuning (in-context learning). Could the authors provide explanations?\u201d\n\nOur understanding is that you are asking how our results would transfer to settings other than in-context learning. \nWhile most of our experiments are on ICL, we also found evidence of overthinking given misleading prompts in non-ICL settings, for example for prompt injection (Figure 26). Therefore we believe that the phenomena we uncovered generalize beyond ICL.\n\n> \u201cCan we expand tasks to include generation-based tasks like QA?\u201d\n\nIn our paper we focused on text classification tasks, since they allowed us to run more controlled experiments. However, our results can in principle be extended to generation tasks. For example, it would be valuable to apply our methods to study code completion models prompted with bug-ridden code [1], or prompts containing factual inaccuracies [2]. Early decoding at the critical layer could improve performance in these cases as well.\n\n[1] Perry et al. 2022, Do Users Write More Insecure Code with AI Assistants?\n\n[2] Burns et al. 2022, Discovering Latent Knowledge in Language Models Without Supervision"
                    }
                },
                "number": 2,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission8426/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700530713315,
                "cdate": 1700530713315,
                "tmdate": 1700530771021,
                "mdate": 1700530771021,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "wvYkaq3a7U",
            "forum": "Tigr1kMDZy",
            "replyto": "Tigr1kMDZy",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission8426/Reviewer_bUf7"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission8426/Reviewer_bUf7"
            ],
            "content": {
                "summary": {
                    "value": "The paper focuses on understanding how language models process correct versus incorrect inputs in few-shot learning contexts, emphasizing harmful imitation. Two phenomena are identified: overthinking and false induction heads. Overthinking occurs when models, given incorrect demonstrations, tend to have reduced accuracy when predictions are decoded from later layers; stopping the model early, before all layers have processed the input, can increase accuracy. False induction heads are specific components in the model that contribute to overthinking by attending to and replicating incorrect information from previous demonstrations. The study's findings advocate for a deeper examination of intermediate model computations to understand and mitigate harmful behaviors in language models\u200b."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "4 excellent"
                },
                "strengths": {
                    "value": "- The paper explores new concepts like \"overthinking\" (previously introduced) and \"false induction heads\" (novel), offering a fresh lens to study transformers, particularly in handling harmful imitation.\n\n- Solid research execution is evident. Specific model components, like attention heads causing errors, are identified and well analyzed.\n\n- The paper is well-structured and very readable. Concepts are clearly and consistently articulated.\n\n- The methodologies provided comprise a strong set of interpretability methods directed specifically at in-context learning and the role of the examples included.\n  - For instance, interpreting outputs from intermediate layers in such ways may prove useful for understanding what the optimal sets of example to provide to the LLM is, in addition to what is attempted in this paper, which is to understand how bad examples affect overall accuracy.\n\n- The paper studies the important issue of harmful content (which, as outlined above, may extend eventually to non-useful or even non-optimal content within the context). Overall, the findings are practically significant and offer insights for controlling model outputs against harmful examples and wrongful imitation."
                },
                "weaknesses": {
                    "value": "- The paper details the phenomena of overthinking and false induction heads, but it doesn\u2019t fully articulate how these insights could be applied practically to improve model behavior.\n  - For instance, while head ablations are discussed as a method to reduce overthinking, the practical impact of these modifications on model functionality and broader applicability is not thoroughly explored in real-world scenarios\u200b i.e. how does one know when the input examples are likely to be false, and that heads ought to be ablated?\n- The methodology involves decoding from intermediate layers and identifying false induction heads, but the paper could provide a more explicit explanation of these processes i.e. how predictions were extracted and analyzed at each layer, and how the heads contributing to overthinking were identified and analyzed.\n- The paper could better acknowledge that the 'incorrectness' of permuted labels can vary based on the dataset and what each label signifies. Some permuted labels might be clearly wrong, while others could be more ambiguous, and providing specific examples for each dataset could clarify this aspect and help to understand the results.\n  - It's not clear in the example from Figure 1 that demonstrations are \"incorrect\", and that all \"imitation\" is wrongful- there is still an argument that context is important, and in this example (at least in the example where all labels are permuted), could the LLM not understand the label permutation and simply interpret that negative sentiments require a positive classification, and vice versa? \n- The reference and justification around the use of the logit lens near the start of the paper could be strengthened, though the authors do come back to discuss it in more detail towards the end."
                },
                "questions": {
                    "value": "Please see weaknesses."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "8: accept, good paper"
                },
                "confidence": {
                    "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                },
                "first_time_reviewer": {
                    "value": "Yes",
                    "readers": [
                        "ICLR.cc/2024/Conference/Program_Chairs",
                        "ICLR.cc/2024/Conference/Submission8426/Senior_Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission8426/Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission8426/Reviewer_bUf7"
                    ]
                }
            },
            "number": 2,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission8426/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698654093170,
            "cdate": 1698654093170,
            "tmdate": 1699637049967,
            "mdate": 1699637049967,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "pQEWjBQbhL",
                "forum": "Tigr1kMDZy",
                "replyto": "wvYkaq3a7U",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission8426/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission8426/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Response #2"
                    },
                    "comment": {
                        "value": "Thank you for your helpful review.\n\n> \"The paper details the phenomena of overthinking and false induction heads, but it doesn\u2019t fully articulate how these insights could be applied practically to improve model behavior. For instance, while head ablations are discussed as a method to reduce overthinking, the practical impact of these modifications on model functionality and broader applicability is not thoroughly explored in real-world scenarios\u200b i.e. how does one know when the input examples are likely to be false, and that heads ought to be ablated?\"\n\nWhile we were mainly focused on understanding how models process inaccurate prompts, we believe our results suggest some directions for mitigation. One way to identify if input examples are false might be to look for sharp changes in prediction during the model\u2019s processing. Another possibility would be to train a probe on the model activations to determine if the input examples are false. Moreover, in our experiments we found that ablating the heads / decoding early led to large improvements given incorrect demonstrations, with no or much smaller effects given correct demonstrations. Therefore, at least in our ICL setting, early exiting improved performance without needing to determine which input examples are false.\n\n> \u201cThe methodology involves decoding from intermediate layers and identifying false induction heads, but the paper could provide a more explicit explanation of these processes i.e. how predictions were extracted and analyzed at each layer, and how the heads contributing to overthinking were identified and analyzed.\u201d\n\nThank you for this feedback. Here is a more detailed explanation, which we can add to the paper if you find it clear:\n\nTo extract predictions from each layer, we used the logit lens (Nostalgebraist, 2020): we got logits by applying the unembedding matrix to the post layernorm activations after each layer (equation on page 5).\n\nWe chose the 5 heads with the highest context following scores (equation on page 7). We selected the heads on our \u201cUnnatural\u201d synthetic dataset to demonstrate that these heads generalize to more realistic datasets.\n\nPlease let us know if there is anything further we can clarify in this procedure.\n\n> \u201cThe paper could better acknowledge that the 'incorrectness' of permuted labels can vary based on the dataset and what each label signifies. Some permuted labels might be clearly wrong, while others could be more ambiguous, and providing specific examples for each dataset could clarify this aspect and help to understand the results.\u201d\n\nOur understanding of what you mean by ambiguous is that in some datasets, some labels have similar meanings. For example, in DBPedia, the class labels \u201cPlant\u201d and \u201cNature\u201d are similar, so assigning the label \u201cNature\u201d to a plant would not be clearly wrong.  \n\nAssuming this is what you had in mind, this ambiguity generally should not affect our conclusions, since we use a new permutation for each input sequence and so most permutations send \u201cPlant\u201d to a different, unrelated label. Therefore, this effect gets averaged out."
                    }
                },
                "number": 3,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission8426/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700540439027,
                "cdate": 1700540439027,
                "tmdate": 1700540439027,
                "mdate": 1700540439027,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "6fvkGKfrX6",
            "forum": "Tigr1kMDZy",
            "replyto": "Tigr1kMDZy",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission8426/Reviewer_qL6Z"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission8426/Reviewer_qL6Z"
            ],
            "content": {
                "summary": {
                    "value": "The paper investigates how language models can learn to generate harmful outputs from few-shot prompts containing inaccuracies or biases. \n\nThe key findings are:\n\nModels tend to \"overthink\" and decrease in accuracy on incorrect prompts after a certain \"critical layer\", while accuracy keeps improving on correct prompts. This suggests incorrect information mainly affects later processing stages.\nAttention heads in later layers preferentially attend to and reproduce incorrect labels from the prompt demonstrations. Ablating a small number of these \"false induction heads\" significantly reduces the accuracy gap between correct and incorrect prompts."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "3 good"
                },
                "strengths": {
                    "value": "The paper:\n- Provides novel insights into the internals of in-context learning through layerwise decoding and attention analysis. Links model behavior to specific components.\n\n- Extensive experiments across models, datasets and prompt variations. Head ablation results generalize across tasks.\n\n- Connects to related ideas like overthinking and induction heads. Builds understanding of model internals."
                },
                "weaknesses": {
                    "value": "The paper lacks in the following ways:\n- Focuses on a simplified setting of permutations of class labels. \n- Does not cover more subtle inaccuracies or biases.\n- Only studies text classification tasks. Unclear if findings apply to more open-ended generative tasks.\n- No modification of model training process itself to mitigate issues."
                },
                "questions": {
                    "value": "- If the prompt contained factual inaccuracies or harmful content, would you expect to see similar overthinking and false induction effects?\n- Could you train with additional regularization to discourage attention to incorrect prompt content?"
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "8: accept, good paper"
                },
                "confidence": {
                    "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                },
                "first_time_reviewer": {
                    "value": "Yes",
                    "readers": [
                        "ICLR.cc/2024/Conference/Program_Chairs",
                        "ICLR.cc/2024/Conference/Submission8426/Senior_Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission8426/Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission8426/Reviewer_qL6Z"
                    ]
                }
            },
            "number": 3,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission8426/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698735013640,
            "cdate": 1698735013640,
            "tmdate": 1699637049840,
            "mdate": 1699637049840,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "OPOMa7mA3K",
                "forum": "Tigr1kMDZy",
                "replyto": "6fvkGKfrX6",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission8426/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission8426/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Response #1"
                    },
                    "comment": {
                        "value": "Thank you for your helpful review.\n\n> \u201cFocuses on a simplified setting of permutations of class labels.\u201d \n> \u201cIf the prompt contained factual inaccuracies or harmful content, would you expect to see similar overthinking and false induction effects?\u201d\n\nIn addition to demonstrations containing permuted class labels, we also obtained results for demonstrations with random labels as well as prompts in which only half of demonstrations have permuted labels (Figure 4).\n\nFurthermore, we show some preliminary results beyond the in-context learning setting: Figure 26 shows that overthinking can also occur in prompt injection attacks, and that early exiting can mitigate the attack (Figure 26).\n\nTherefore, we also expect overthinking and false induction to occur for other prompts containing factual inaccuracies or harmful content. For example, we may find overthinking in code completion models given bug-ridden prompts.\n\n> \u201cCould you train with additional regularization to discourage attention to incorrect prompt content?\u201d\n\nWe found that ablating heads that attend to incorrect prompt tokens improved performance. This suggests that adding an auxiliary loss specifically penalizing high attention scores to tokens in incorrect demonstrations might help mitigate false context following."
                    }
                },
                "number": 1,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission8426/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700524445199,
                "cdate": 1700524445199,
                "tmdate": 1700524458793,
                "mdate": 1700524458793,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    }
]