[
    {
        "title": "How does representation impact in-context learning: An exploration on a synthetic task"
    },
    {
        "review": {
            "id": "YhSu0MhyjA",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission808/Reviewer_gm8Y"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission808/Reviewer_gm8Y"
            ],
            "forum": "JopVmAPyx6",
            "replyto": "JopVmAPyx6",
            "content": {
                "summary": {
                    "value": "This study investigates how Transformers learn from in-context examples, a process still not fully understood. It explores this phenomenon through representation learning, considering both model weights and in-context samples. The findings show a strong link between the quality of in-context representations and learning performance. A well-developed in-weights component enhances in-context learning, suggesting it should be foundational. Besides, a simple Transformer, using pattern matching and copy-paste for in-context learning, matches complex models assuming perfect in-weights. These insights offer new perspectives for enhancing in-context learning abilities."
                },
                "soundness": {
                    "value": "2 fair"
                },
                "presentation": {
                    "value": "2 fair"
                },
                "contribution": {
                    "value": "2 fair"
                },
                "strengths": {
                    "value": "- The research topic is realistic and important. In-context learning has attracted lots of attention from the research community. It is significant to understand its inherent mechanism for the development of more advanced techniques. \n- The provided perspective that analyzes in-context learning is interesting and may inspire follow-up research."
                },
                "weaknesses": {
                    "value": "- Technical contributions of this paper are limited. \n- The writing should be polished further. For the current form, there is a series of unclear explanations, descriptions, and justifications. \n\nMore details and concerns can be checked in \"Questions\"."
                },
                "questions": {
                    "value": "- This paper claims that it attempts to understand in-context learning from representations. However, throughout this paper, there is no clear definition of the representation in in-context learning. \n- How to understand \"a good in-weight component\" in Section 1.1. Could the paper provide more details? This is hard to understand from the current descriptions. \n- I am confused about the approximation that uses a very simple network to estimate the large language models (LLMs). This is a bit incredible. If the approximation can be so good with respect to performance, why do we still increase the scale of LLMs? Would the approximation bring some disadvantages?\n- Could the paper provide representative examples of the data of NLP not just images (c.f., Figure 2)?\n- In this paper, $i=40$ and $j=0$. I am confused about the determination of such values. \n- At the beginning of this paper, it claims PCA is employed. However, after checking the paper, the technical details and importance of PCA are not clearly stated. \n- Could the paper supplement some intuitive explanations about Definition 2 for better understanding? \n- The limitation of this paper (which is also stated in Section 4) is worrying. Perhaps, due to the issue, the obtained conclusion is not general. \n- This paper looks like it was submitted in a hurry. There are many typos in the current form. For example,   \n(1) It should use upper and lower quotation marks but not all lower quotation marks.   \n(2) On the citation of the Adam optimizer.   \n(3) In-weights comp. but not in-weights comp.  \n(4) There should be a blank space between descent and (von Oswald et al., 2022). Similar, between Transformer and (Vaswani et al., 2017), between this sequence and According, and between semantic\u201d and i.e..   \nPlease check them carefully for better representations. \n\nDue to the above concerns, before rebuttal, I am negative for the current form of this paper. I am glad to hear responses from authors and comments from other reviewers, and increase my score accordingly."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "details_of_ethics_concerns": {
                    "value": "NA."
                },
                "rating": {
                    "value": "3: reject, not good enough"
                },
                "confidence": {
                    "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 1,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission808/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1697414339116,
            "cdate": 1697414339116,
            "tmdate": 1699636008237,
            "mdate": 1699636008237,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "p3LZkf0Zoa",
                "forum": "JopVmAPyx6",
                "replyto": "YhSu0MhyjA",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission808/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission808/Authors"
                ],
                "content": {
                    "comment": {
                        "value": "Thank you for your valuable comments and suggestions and the encouraging words. We appreciate the time and effort you took to review our paper. Please find below our responses to your questions and the changes we have made to address them.\n\nQ1,Q2. Thank you for your pointing out. It is an important question. We rewrite the section 2.2 to solve these problems. In the revision of Section 2.2 , we give a formal definition about in-weights and in-context components, formal definition about what are good in-weights and in-context components and a decomposition of the problem.\n\nQ3, We regret that our writing makes you misunderstand here. We are not asserting that a small network can approximate the Large Language Model (LLM). Our main points are: 1) The in-weights component plays a crucial role in in-context learning. This is evident as, under the perfect in-weights component assumption, even a simple network can exhibit proficient in-context learning. 2) We demonstrate that the neural network we've constructed can approximate the performance of the model trained on experimental data, thereby validating that our construction is meaningful.\nWe revise the paper to reduce the possible of the misunderstanding.\n\nQ4, Yes. We give a experiment on a new NLP dataset to demonstrate that conclusion obtained in synthetic tasks can be extended to NLP task in Appendix C.2.\n\nQ5, The selection is arbitrary. As stated in [1], the choice of i, j within a reasonable range will not affect the results. \n\nQ6, We regret that our writing makes you misunderstand here. Our intention in using PCA was to elucidate why we named them the \"in-weights component\" and \"in-context component\". However, we did not mean to imply that we are specifically using PCA. To avoid this ambiguity, we have revised the paper.\n\nQ7, This definition is to ensure that the representation has a good in-weights component. (the definition of ``good in-weights component\" is given in section 2) and the in-weights component can be easily readout using a linear layer. \n\nQ8, We add the Section C in the Appendix. We give the following effort to try to solve your concern: 1) we analyze the previous discovery in NLP paper related to in-weights and in-context components. 2) we add a new experiment on a NLP dataset and our discoveries are held in this dataset.\n\nQ9, We will revise these typos.\n\n[1] Catherine Olsson, Nelson Elhage, Neel Nanda, Nicholas Joseph, Nova DasSarma, Tom Henighan, Ben Mann, Amanda Askell, Yuntao Bai, Anna Chen, et al. In-context learning and induction heads. arXiv preprint arXiv:2209.11895, 2022."
                    }
                },
                "number": 7,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission808/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700212702397,
                "cdate": 1700212702397,
                "tmdate": 1700328742472,
                "mdate": 1700328742472,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "HqeVXMMug8",
            "forum": "JopVmAPyx6",
            "replyto": "JopVmAPyx6",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission808/Reviewer_MkMt"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission808/Reviewer_MkMt"
            ],
            "content": {
                "summary": {
                    "value": "In this paper, the authors explain in-context learning in Transformers. They break down learning into two components: in-context and in-weight and introduce two probes to investigate these components. The in-context probe measures how well the model predicts the correct factor in a task sequence, while the in-weight probe assesses how well the model learns the overall task. To investigate this empirically, they use a synthetic dataset where an image of a 3D shape is given, and the model predicts one of six factors.  They evaluate the effectiveness of probes by look at its predictions on model trained on four different dataset variations. They find that (1) the in-weight component is effective with a fixed mapping between factor values and labels; (2) The in-context component is effective with randomly shuffled mappings, and in-context learning from random mappings generalizes to fixed mappings; (3) Switching from fixed to random mappings accelerates in-context learning; (4) Training on a mix of fixed and random mappings is more effective than training on each individually. Overall, the authors observe a strong correlation between the in-context component and  in-context learning performance and also that in-weight component influences in-context learning but is not sufficient. Furthermore, they show that a  constructed Transformer model with perfect in-weight component matches the performance of a trained GPT2 model, highlighting the importance of the in-weight component for in-context learning. Lastly, they suggest that two-mechanisms used by the constructed transformer - pattern matching and copy-paste - might be the mechanisms underlying in-context learning in larger models, such as Large Language Models (LLMs)."
                },
                "soundness": {
                    "value": "2 fair"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "3 good"
                },
                "strengths": {
                    "value": "- the paper is addressing a relevant topic and ICLR is an appropriate for the submission\n- the approach of probing in-context and in-weights representation is definitely an interesting and the authors take a look at it from representation learning perspective unlike previous who have looked into from data-distributional perspective (Chan et al. 2022) and casting it as gradient-based learning problem (von Oswald et al. 2022).\n- details of task, the model and the experimental setup is quite clearly laid out. For most results, the hypotheses were mentioned along with the intuition before presenting the results which made following the results quite straight forward.\n- although the organisation of the text is a bit unconventional, the authors managed to successfully get across the main points pretty well. apart from a few minor typos the figures also manage to convey the results quite well."
                },
                "weaknesses": {
                    "value": "- given how the different experiments and probes are set-up, the results look a bit obvious to me.  For example, `D_fix` \u2192 `D_rand` results was quite trivial as during training time the model never saw such tasks. It would be interesting to understand within the same framework under what conditions does in-context learning does not emerge. Are there cases where in-weight learning interferes with in-context learning and vice-versa? For example, what if you overtrain on `D_fix`/ `D_rand` or under/over parameterise the model? what would your prediction be for this case?\n- one of the strengths of the task is that it requires  the model to do both in-context and in-weight learning to do well. Have the authors investigated the phenomenon in purely language setting where this is also a requirement?"
                },
                "questions": {
                    "value": "- what is the loss function? is it `cross-entropy loss`?\n- the proof by construction was a bit convoluted to understand, quite a few notations where missing or unclear. atm, I am unsure if I fully understand it. Perhaps this was because of the lack of space or written a bit at the end but I would be happy to go through it again if expanded with intuitions.\n\n\n**Minor edits**\n\n- Pg 4: Adam optimizer [cite: kingma2014adam]\n- Pg 4: Since the components are hidden in the representation (under exploration framework section)\n- Pg 3: `ei` is the hidden factor of the i-th sequence or i-th element in the sequence?\n- Pg 4: `defailt`\n- Pg 4 : consistency for capitalisation\n- Figure 5: in-context rep score and in-context comp. score\n- no abbreviation specified before using comp. for coponent\n- Figure 5A: typo in the title D_fix\u2192 rand\n- Pg 8: typo `fead forward layer can achiever`"
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "5: marginally below the acceptance threshold"
                },
                "confidence": {
                    "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 2,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission808/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698767418731,
            "cdate": 1698767418731,
            "tmdate": 1699636008159,
            "mdate": 1699636008159,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "3B6rU4mb5p",
                "forum": "JopVmAPyx6",
                "replyto": "HqeVXMMug8",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission808/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission808/Authors"
                ],
                "content": {
                    "comment": {
                        "value": "Thank you for your valuable comments and suggestions. We appreciate your feedback and have made several changes to address your concerns. Please find below our responses to each point you raised.\n\n### Weakness 1 \n\n D_fix can be considered a specific instance of D_rand. Even in the \"D_rand->D_rand\" scenario, the test set includes tasks that the model has not previously encountered. This is because the number of potential mappings between factor values and labels is $n_e(n_e-1)(n_e-2)...(1)$, where n_e represents the total possible factor values of factor e. If n_e equals 10, then the number of potential mappings, $n_e(n_e-1)(n_e-2)...(1)$, is approximately 3.6*10^7. This figure greatly exceeds the number of sequences (10^5) present in the training set.\n\n### Weakness 2\nThanks for your suggestion. We add this in Section C (Appendix). In this section, we summary some prior practice works that evident both in-weights and in-context components are used in practice. And we give an experiment on a new NLP dataset to demonstrate that conclusion obtained in synthetic tasks can be extended to NLP task.\n\n### Question\n\nQ1: yes, it is crossentropy. Thank you for your pointing out. We add the description in the paper.\n\nQ2\uff1a We have entirely rewritten the proof to enhance its readability (Section E in Appendix). To accomplish this, we've taken the following steps: 1) We've added a new paragraph to explain the notation, and 2) we've incorporated more explanations and intuitive reasoning throughout the proof.\n\n### Minor edits\n\nWe fix the issues. We will continue to check potential grammar issues."
                    }
                },
                "number": 6,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission808/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700209569190,
                "cdate": 1700209569190,
                "tmdate": 1700328491133,
                "mdate": 1700328491133,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "3VRRRhEHcA",
                "forum": "JopVmAPyx6",
                "replyto": "3B6rU4mb5p",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission808/Reviewer_MkMt"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission808/Reviewer_MkMt"
                ],
                "content": {
                    "comment": {
                        "value": "Although I did not ask for the text mentioned in Appendix C.1, it was a good addition in terms of providing more context as to why you are doing this. However, please note that there are several typos and grammar errors in this text.\nI thank the authors for validating the probes on an NLP task and showing that at least some of the findings hold.\nI also thank the authors for improving the proof by providing additional details and intuition. However, I feel that this proof, in its current state, is still difficult for me to understand. I do not feel confident enough to approve it yet, but perhaps one of the other reviewers can confirm if it is correct.\nAdditionally, when considering the comments left by the other reviewers, I see that most reviewers share my concern that the finding \u2014 that a good in-weight component is required for in-context learning \u2014 is more or less expected. Whether it holds for larger models that are strong in both aspects still seems to be a matter of debate.\nLastly, I believe that the writing needs further improvement as there are several grammar issues, including in the newly added text, and gaps in several explanations/notations. I agree with one of the reviewers that at least parts of the paper \u2014 if not all \u2014 still seem to be hastily written.\nTherefore, taking all of these points into consideration, I have decided to keep my score as is at 5."
                    }
                },
                "number": 8,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission808/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700585017461,
                "cdate": 1700585017461,
                "tmdate": 1700585017461,
                "mdate": 1700585017461,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "Qid1aDaqtE",
                "forum": "JopVmAPyx6",
                "replyto": "HqeVXMMug8",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission808/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission808/Authors"
                ],
                "content": {
                    "comment": {
                        "value": "**Point 1: please note that there are several typos and grammar errors in this text**: We will fix the grammar errors.\n\n\n**Point 2: I feel that this proof, in its current state, is still difficult for me to understand.**\n Please respect our time for this rebuttal. There exist two elements that influence the comprehensibility of a proof: the complexity of the issue at hand and the quality of the proof's composition. If the former is the case, it cannot serve as a valid reason to dismiss our paper. However, if it's the latter, **please provide us with detailed feedback rather than a mere \"However, I feel that this proof, in its current state, is still difficult for me to understand\"**. This behavior is irresponsible.\n\n**Point 3: I see that most reviewers share my concern that the finding \u2014 that a good in-weight component is required for in-context learning \u2014 is more or less expected. Whether it holds for larger models that are strong in both aspects still seems to be a matter of debate.** The most reviewers concern about the experiments about D_fix->D_rnd and \"in-context component is related to in-context learning\" is within expectation, instead of the conclusion you mentioned that \"that a good in-weight component is required for in-context learning\". You also don't raise the concern in your first review. What's more, \"that a good in-weight component is required for in-context learning \u2014 is more or less expected\" and \"Whether it holds for larger models that are strong in both aspects still seems to be a matter of debate\" are somewhat contradicted with each other. If it is within expectation, then why you questions about  \"Whether it holds for larger models that are strong in both aspects still seems to be a matter of debate\"?"
                    }
                },
                "number": 11,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission808/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700738152302,
                "cdate": 1700738152302,
                "tmdate": 1700738225007,
                "mdate": 1700738225007,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "gIbTf5IXqX",
            "forum": "JopVmAPyx6",
            "replyto": "JopVmAPyx6",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission808/Reviewer_EdZW"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission808/Reviewer_EdZW"
            ],
            "content": {
                "summary": {
                    "value": "This paper investigates the effects of in-weight and in-context components on In-Context Learning (ICL) capacity. The authors conduct a series of experiments demonstrating the significant role of the in-context component in the success of ICL. They also show that a well-trained in-weight component enhances the learning of a high-quality in-context component. Remarkably, the authors establish that, with an optimally pre-trained in-weight component, it is possible to construct additional Transformer layers (three in total) to effectively learn the in-context component. This yields performance on par with certain pre-trained Transformer models."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "3 good"
                },
                "strengths": {
                    "value": "1.  The authors adopt an approach to evaluate the implicit in-context and in-weight components by employing probes. This is a significant departure from direct parameter analysis, which is challenging since in-weight and in-context parameters are tightly integrated. They develop a scoring system for the in-context and in-weight components, a novel and logical idea.\n\n2. The paper is well-structured, and the authors provide numerous relevant experiments followed by comprehensive discussions.\n\n3. The paper not only empirically demonstrates the impact of the in-context and in-weight components on ICL capacity but also provides theoretical evidence proving the existence of construction that can perform in-context learning using three additional Transformer layers, given perfectly pre-trained in-weight component. This claim is further validated through experimental evaluation."
                },
                "weaknesses": {
                    "value": "1. There are areas in the manuscript that require attention, such as citation error in Section 2.2.\n\n2. The data settings $D_\\text{rnd}$ and $D_\\text{fix}$ used in the experiments do not sufficiently capture the separate impacts of in-context and in-weight components.\n\n    - $D_\\text{rnd}$ seems to still take the in-weight component into consideration, given its nature as a statistical classification problem.\n    - $D_\\text{fix}$, on the other hand, seems to be more aligned with in-weight learning. However, it does not fully represent the in-weight component implicit in the original dataset. Given that in-context learning involves numerous classification tasks with shared inputs but varying labels, a more holistic approach considering all these tasks is necessary to capture the complete in-weight component.\n3. The probe methodology requires further clarification. There is a lack of clarity regarding from which layer features are drawn and how the choice of layer affects the results. It is possible that some layers dominantly contain in-context components, while others are richer in in-weight components. Additionally, the rationale behind training each classifier for only one epoch, as opposed to ensuring thorough and adequate training, is not explained."
                },
                "questions": {
                    "value": "1. Could the authors provide more details on the implementation of the probe methods, as mentioned in the Weaknesses section of this review?\n\n2. In Section 2.3, the statement \"we disable the attention layer in the Transformer\" is made. Could the authors detailed on this?"
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "5: marginally below the acceptance threshold"
                },
                "confidence": {
                    "value": "2: You are willing to defend your assessment, but it is quite likely that you did not understand the central parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                },
                "first_time_reviewer": {
                    "value": "Yes",
                    "readers": [
                        "ICLR.cc/2024/Conference/Program_Chairs",
                        "ICLR.cc/2024/Conference/Submission808/Senior_Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission808/Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission808/Reviewer_EdZW"
                    ]
                }
            },
            "number": 3,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission808/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698815999191,
            "cdate": 1698815999191,
            "tmdate": 1699636008084,
            "mdate": 1699636008084,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "0RzESfsVrV",
                "forum": "JopVmAPyx6",
                "replyto": "gIbTf5IXqX",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission808/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission808/Authors"
                ],
                "content": {
                    "comment": {
                        "value": "We appreciate the time and effort you took to review our paper. Please find below our responses to your concerns and the changes we have made to address them.\n\n### Weakness 1\n\nThank for your pointing out. We have fixed it in the paper.  We will continue to check these issues.\n\n### weakness 2\nWe regret that our writing makes you misunderstand here. The role of D_rnd and D_fix setting is not to seperate the impacts of in-context and in-weights component. Instead, we use the probe method to seperate it. In the revision, we rewrite the Section 2 to make it clear. In the revision, we provided a formal definition of the in-weights and in-context component and an analysis of the D_fix and D_rnd settings. We think the revision can solve your concern. (Section 2.2 and the paragraph start with \"analysis\" in section 2.3 are directly related to this).\n\n### Weakness 3\n **Point: There is a lack of clarity regarding from which layer features are drawn and how the choice of layer affects the results. It is possible that some layers dominantly contain in-context components, while others are richer in in-weight components.** We add the experiment in Section F (Appendix). In the experiment, we find that the in-context component concerntrate on the higher layer whether and in-weights component prefer lower layers. We also give the choosen layers.\n\n**Point:  the rationale behind training each classifier for only one epoch, as opposed to ensuring thorough and adequate training, is not explained.** In this paper, we use linear probe, (The probe model contains only one linear layer). One epoch is enough for adequate training. And we find that more complicate probe model doesn't have obvious gain.\n\n### Question\n\nQ1: In this paper, we use linear probe, (The probe model contains only one linear layer). One epoch is enough for adequate training. Training for more epochs doesn't helpful in our problem. And we find that more complicate probe models don't have obvious gain.\n\nQ2: We disable the attention layers by replacing the attention layers in the Transformer with identity maps, whose outputs are equal to their inputs. We add this content in the paper."
                    }
                },
                "number": 5,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission808/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700208513413,
                "cdate": 1700208513413,
                "tmdate": 1700328769273,
                "mdate": 1700328769273,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "Cp4bcWYHth",
            "forum": "JopVmAPyx6",
            "replyto": "JopVmAPyx6",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission808/Reviewer_F4jH"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission808/Reviewer_F4jH"
            ],
            "content": {
                "summary": {
                    "value": "This paper sets out to shed further light on the in-context learning abilities of transformers. The paper studies. The authors consider a synthetic pattern-matching tasks called Shapes3D, in which the transformer is tasked with predicting the value of a certain factor that changes in images of 3D shapes (e.g. shape, color, background, etc.). The task can be learned by in-context examples of images of shapes and the corresponding value of the relevant factor (which is unknown). The authors attempt to distinguish between what is learned through the in-context component and what is learned through the in-weights component by analyzing the predictive power of their respective representations. The authors find that they play complementary roles and correlations are elucidated that reveal what is necessary for strong in-context learning capabilities."
                },
                "soundness": {
                    "value": "2 fair"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "3 good"
                },
                "strengths": {
                    "value": "- The paper studies an important problem. Understanding what is important to achieve in-context learning is quite clearly a very important topic that can have critical downstream applications in understanding and improving the robustness of models such as language models.\n- The paper is presented fairly clearly, but there are some things that I would suggest listed below.\n- The concepts that the paper attempts to elucidate are fairly new to my knowledge, compared to prior work and the methodology of looking at representations potentially analyzes concepts that were previously not analyzed, which I greatly appreciate. This approach to probing could be  a useful technique to study in-context learning (although probing itself is not new).\n- The theory is useful to have a construction that achieves the desired results. However, it is limited to linear attention, but I think this is fine given the precedents."
                },
                "weaknesses": {
                    "value": "Despite these strengths, I have some reservations about the inferences that can be drawn from the study. \n\n- A fundamental (somewhat unstated) assumption is that the in-context comp and in-weights comp are decomposed via this probing analysis and thus we can see the impact of both of them. However, the in-context component is clearly also impacted by concepts learned in the weights. It also already seems obvious that one would need to be able to achieve a high in-context comp score in order to achieve high in-context accuracy. For example, I fail to see what we learn regarding the second major claim \u2018in-weights comp plays a crucial role in learning the in-context comp\u2019. I am confused about (1) why this is surprising (2) if it is surprising, which of the experiments justifies this. I could see 6A potentially supporting this, but there are other factors at play. In 5, one trains from scratch so clearly there is some \u2018warm up\u2019 that is needed to get in-context learning ability.\n- One of the other fundamental pieces of the results is training on D_fix and then evaluating on D_rnd or some variation of this. I am concerned that the conclusions that are drawn from these experiments are not necessarily results of in-context learning properties but are just generally issues related to distribution shift. After all, the transformer is not trained on D_rnd. The trend of the results is the following: when we use D_rnd in training, the results get better when evaluating on D_rnd (Fig 5, 6). Is this somehow unexpected?\n- Given this, perhaps the most surprising result is that the in-weights scores on 5A with D_rnd are poor and 6A does not improve to what is achievable training full on D_rnd, but only the in-context score improves. I\u2019m not sure what to make of this though. For instance, this could be explained by saying that it just may not be important to form a representation that is predictive of the factor values without the context for this particular task since the task can be inferred from the context. Perhaps the authors can shed some light on that."
                },
                "questions": {
                    "value": "In addition to some questions, I also suggest some minor changes that I think would improve the paper.\n\n\n- It would be helpful to more formally define the in-context and in-weights components earlier in the paper. Throughout the intro and early parts, it is clear what th paper wants to do, but it\u2019s difficult to discern what quantifiably one wants to measure since \u2018in-weights components\u2019 and \u2018in-context components\u2019 are sort of nebulous terms until one reaches section 2.3. Honestly, I don\u2019t know the best way of presenting it, but I just want to raise this as a potential issue for future readers in case the authors have alternatives.\n- when you compute the in-context comp score, are you using the very last element of the sequence at L?\n- when producing the probes, are you doing a train and test split and are we looking at the test accuracy. How is this split being done? Are we looking at the test score when we look at the plots?\n- FYI I don\u2019t think E is defined before being used in Section 2.3.\n- Fig 6A should be D_fix->rnd not D_rnd->fix I think.\n- Fig 6A why is it D_rnd^fix => D_fix and not D_rnd^fix => D_rnd? Isn\u2019t it more relevant to understand the in-context score on D_rnd?\n- In, D_rnd^fix, do you use twice the amount of data as D_rnd? That is, does each epoch contain twice the data or are they both halved so the total is the same?\n- I don\u2019t really understand the last paragraph that starts with \u201cComparison with previous work in analyzing the in-context learning mechanism.\u201d\n- It would be helpful to compare 6A directly with 5B since they are plotting the same kind of results. It seems that in both you get good performance starting at roughly the same epochs. This I think supports my question about how much of this is just attributed to distribution shift: once you start training on the same data as you test on, performance improves.\n- Some typos: \u201ccopy-past\u201d \u201cfead forward\u201d \u201cHow transformer solve this problem?\u201d \u201canalysis is to analysis\u201d"
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "5: marginally below the acceptance threshold"
                },
                "confidence": {
                    "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 4,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission808/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1699485407395,
            "cdate": 1699485407395,
            "tmdate": 1699636008011,
            "mdate": 1699636008011,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "ut4NuwscIs",
                "forum": "JopVmAPyx6",
                "replyto": "Cp4bcWYHth",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission808/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission808/Authors"
                ],
                "content": {
                    "comment": {
                        "value": "Thank you for your valuable comments and suggestions.  Please find below our responses to your concerns and the changes we have made to address them.\n\n### Weakness 1.  \n**Point: A fundamental (somewhat unstated) assumption is that the in-context comp and in-weights comp are decomposed via this probing analysis. However, the in-context component is clearly also impacted by concepts learned in the weights.**\nIn the revised version, we provide a formal definition of the problem along with the assumptions in Section 2.2.\n\n**\u201cPoint:It also already seems obvious that one would need to be able to achieve a high in-context comp score in order to achieve high in-context accuracy.**\nI understand the reviewer's logic in associating \"in-context comp\" and \"in-context accuracy\" with in-context learning due to their terminology and their relation to in-context examples. However, two points might have been overlooked. 1) The existence of in-context comp isn't natural; it's a result of our effort to decompose it from the representation. 2) Furthermore, our findings suggest a portion of the representation is directly tied to performance. This connection hasn't been explored in previous work, and this discovery suggests that enhancing representation learning may be a fundamental approach to improve in-context learning.\n\n\n**Point: I fail to see what we learn regarding the second major claim \u2018in-weights comp plays a crucial role in learning the in-context comp\u2019**\n1) Regarding the statement, \"I could see 6A potentially supporting this, but there are other factors at play. In 5, one trains from scratch so clearly there is some \u2018warm up\u2019 that is needed to get in-context learning ability.\" We've supplemented this with a new experiment (Figure 9A in Appendix F), where we train D_fix for a brief period and still observe a significant improvement.\n2) The use of both D_{fix} and D_{rnd} leads to considerably better results compared to utilizing D_{rnd} alone.\n\n### Weakness 2.\n We agree with you that there is a distribution shift. However, we disgree with your logic that ``Distribution shift->drop of performance\".\nThe reason is that\n1) There are no drops of the performance when we swith from D_rnd to D_fix, although there are also \"distribution shift\" exsits.\n2) Using D_{rnd and fix} can improve the results on D_rnd compared with only trained on D_rnd. D_{rnd and fix} also introduce the distribution shift.\nOur logic is that `` Distribution shift -> unaffected in-weights component and affected in-context component -> drop of performance\".\nOur experiment reveal that training on D_fix and then evaluate on D_rnd, only the learning of the in-context component cannot be transfered. And due to this factor, the performance drops.\n\n### Weakness 3. \n**Point: Given this, perhaps the most surprising result is that the in-weights score on 5A with D_rnd are poor and 6A does not improve to what is achievable training full on D_rnd, but only the in-context score improves. I\u2019m not sure what to make of this though.** \n\nHere, we give possible reasons for this obervation:\n\n1) We don't have direct supervision signal for improving in-weights and in-context component. \n\n2) Under D_rnd setting, the model can achieve smaller loss by just improving the in-context component. Therefore, the model don't have motivation to improve the in-weights component and it even sacrifice in-weights component to obtain better in-context component.\n\n### Question\n\nQ1 We rewrite the paper and give the formal definition in Section 2.2\n\nQ2 Yes, we use the last element of the sequence at L\n\nQ3 Yes, we look at the test score. We add a description for the dataset split of probe model in Appendix A.4.\n\nQ4, we rewrite the paper to fix the problem.\n\nQ5, Yes, it is a typo. It is D_rnd->D_fix\n\nQ6, It it a typo. Actually it is D_rnd^fix => D_rnd. Thank you for your pointing out. we have fixed it.\n\nQ7\uff0cWe use same amout of data. We add a description for the dataset split of probe model in Appendix A.4.\n\nQ8, this sentence is related to the proof details of the proposition. I move it to the Appendix for the audiences who have interesting in the proof.\n\nQ9, We give a directly comparison about the some results on Figure 9A (Appendix). Thanks for your advise, we will rethink it and try to find a better way for representation.\n\nQ10, Thank you for your point out. We have fixed it in the paper."
                    }
                },
                "number": 4,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission808/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700208273553,
                "cdate": 1700208273553,
                "tmdate": 1700327762639,
                "mdate": 1700327762639,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    }
]