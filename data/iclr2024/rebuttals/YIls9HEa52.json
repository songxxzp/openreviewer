[
    {
        "title": "Parsing neural dynamics with infinite recurrent switching linear dynamical systems"
    },
    {
        "review": {
            "id": "dZfUrYWlNW",
            "forum": "YIls9HEa52",
            "replyto": "YIls9HEa52",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission7878/Reviewer_k1CY"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission7878/Reviewer_k1CY"
            ],
            "content": {
                "summary": {
                    "value": "This work extends the rSLDS. It embeds the latent modes (discrete states) in Euclidean space with PDE, and endows the former nominal states with geometry. The proposed method was validated on synthetic data and real neural recordings. The results show that the proposed method better captures the change of dynamics on nonstationary DS."
                },
                "soundness": {
                    "value": "4 excellent"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "3 good"
                },
                "strengths": {
                    "value": "This work shows good performance for nonstationary systems.\nThe extension brings up new interpretations on the discrete states."
                },
                "weaknesses": {
                    "value": "rSLDS has the intuition of partitioning the latent space into regions that are governed by different linear DS individually, and the resultant nonlinear DS globally. It's not very suitable to do comparison on a nonstationary system.\nThe goodness of fit numbers do not show irSLDS significantly outperform rSLDS. It seems better state inference does not help much with explaining the data."
                },
                "questions": {
                    "value": "In the extended NASCAR example\n- Why the trajectory is not smooth? The bias is too large?\n- Why not show MSE for extended NASCAR in Tab 1.\n\nIt would be more convincing to see the discrete state inference from continuous recording for real nonstationary system."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "6: marginally above the acceptance threshold"
                },
                "confidence": {
                    "value": "5: You are absolutely certain about your assessment. You are very familiar with the related work and checked the math/other details carefully."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 1,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission7878/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698530328428,
            "cdate": 1698530328428,
            "tmdate": 1699636966735,
            "mdate": 1699636966735,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "XspJiGovtI",
                "forum": "YIls9HEa52",
                "replyto": "dZfUrYWlNW",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission7878/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission7878/Authors"
                ],
                "content": {
                    "comment": {
                        "value": "Thank you for your review!  We hope what follows answers your remaining questions.\n\n**Weaknesses**: We start by first acknowledging the weakness raised. Indeed, the partitioning into different linear DS you mentioned is an important intuition. It is present in our model through the recurrent ($x_n \\to z_{n+1}$) connections, but with the effective partition being time-varying. For rSLDS it is indeed a fixed global nonlinear DS, which induces a weaker prior over non-stationary dynamics. Nonetheless, the resulting system can still support non-stationary dynamics, which we believe makes comparisons on non-stationary systems still justified. A simple extension to the rSLDS that would allow for better modeling of nonstationarity would be to include an additional dependence on time $n$ through external inputs. This way, this partition over the $\\boldsymbol x$ state space would be allowed to also vary with time. If deemed relevant, we would be happy to include this extension analysis as a supplement in the final version!\n\n**Questions**: Addressing your questions: \n- Extended NASCAR: We assume you are referring to the sample continuous states in Figure 2E. The posterior mean trajectories in Figure 2C are smooth, but in Figure 2E we plot the *sampled* continuous state trajectories, that will by definition be noisy. \n- Thank you for pointing this out. We have now updated Table 1 in the main text to incorporate the dynamical MSE, as well as Table 2 in the Appendix. \n\nFinally, could you expand on this sentence?\n> It would be more convincing to see the discrete state inference from continuous recording for real nonstationary system.\n\nThank you again for your feedback. Let us know if we can better answer any remaining questions you may have!"
                    }
                },
                "number": 6,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission7878/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700415906685,
                "cdate": 1700415906685,
                "tmdate": 1700415906685,
                "mdate": 1700415906685,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "T19J2eN6aQ",
                "forum": "YIls9HEa52",
                "replyto": "XspJiGovtI",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission7878/Reviewer_k1CY"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission7878/Reviewer_k1CY"
                ],
                "content": {
                    "title": {
                        "value": "Response to the authors"
                    },
                    "comment": {
                        "value": "Thank you for addressing my concerns.\n\n> It would be more convincing to see the discrete state inference from continuous recording for real nonstationary system.\nIn the electrophysiological recording example, the model was fit to trials if I understand it correctly so that you lost the continuity of state $x$ and $z$ between the trials. So, I wondered whether the method would obtain the same inference especially of the discrete state if you fit it to the continuous recording. Certainly, it doesn't have to be done on this dataset for practical considerations."
                    }
                },
                "number": 7,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission7878/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700500205112,
                "cdate": 1700500205112,
                "tmdate": 1700500205112,
                "mdate": 1700500205112,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "3a3PptYF2z",
                "forum": "YIls9HEa52",
                "replyto": "dZfUrYWlNW",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission7878/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission7878/Authors"
                ],
                "content": {
                    "comment": {
                        "value": "We are glad to read our reply addressed your concerns!\n\nThank you for clarifying. Indeed, there are considerable practical considerations to the full continuous recordings since we'd be dealing with an order of magnitude longer sequences. There are also considerations on the modeling side, as modeling the continuity in x and z *between* trials has to be handled carefully. For instance, in the decision-making data considered here, there are inter-trial breaks (elapsed times) that might make the latent states discontinuous. To tackle this, one approach is to define different dynamical transitions for the latents at those time steps from one trial to another (see e.g. (Roy et al, Neuron, 2021)). Thank you for raising this point, we will include a comment on this aspect in the limitations section of the paper."
                    }
                },
                "number": 11,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission7878/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700605323656,
                "cdate": 1700605323656,
                "tmdate": 1700605752419,
                "mdate": 1700605752419,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "LFkHvyspxs",
            "forum": "YIls9HEa52",
            "replyto": "YIls9HEa52",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission7878/Reviewer_Rx1k"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission7878/Reviewer_Rx1k"
            ],
            "content": {
                "summary": {
                    "value": "This paper builds upon the recurrent switching linear dynamical system (rSLDS) in the context of modeling latent dynamics of neural spike train data. The infinite recurrent SLDS (irSLDS) is proposed to overcome the fixed number of discrete states in the rSLDS, which can limit its capabilities on trial-varying data that may require a varying number of states. Prior methods have proposed using Dirichlet processes to infer the number of states from the data, often using a Chinese Restaurant Process (CRP). But this is limited in the rSLDS case, since the CRP has exchangeability assumptions which the state-dependence of the rSLDS breaks. The proposed method introduces a sufficient statistic to express the cluster allocations of a distance-dependent Chinese Restaurant Process (dist-CRP) which can be used to address the exchangeability issue and determine the discrete state switching probabilities. This sufficient statistic is implemented following a heat-equation combined with finite difference methods, resulting in linear recurrences. The proposed irSLDS is compared with SLDS and rSLDS on a synthetic NASCAR experiment and compared to the rSLDS on Neuropixel data recorded from mice."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "3 good"
                },
                "strengths": {
                    "value": "- For the most part, the paper is clear and presented well\n\n- The method is motivated well. In the scientific community, there is a strong desire for models that are both expressive and interpretable that can be used to gain insights into data, e.g. neural spike trains.  While rSLDS has been popular in this regard, addressing its weakness of having a fixed number of states is of interest to the community\n\n- The idea to characterize the distance-dependent CRP in the context of SLDS with a heat equation appears (to my knowledge) to be novel and is an interesting idea that seems to lead to a relatively straightforward implementation (the basic implementation of the code in the appendix is also appreciated).\n\n- The considered experiments appear to show that the irSLDS can have a performance/interpretability edge in practice and can potentially lead to insights that rSLDS cannot"
                },
                "weaknesses": {
                    "value": "- The paper would benefit from providing a bit more context/intuition behind the Polya-gamma approach in Section 3.1 and its weaknesses. Just reading this section currently does not make it as clear why the approach in section 3.2 is necessary. Section C.1 in the appendix is helpful. Perhaps a bit more details about the Gaussians with time-dependent sizes could be added to the main paper to make this point more clear?\n\n- The experimental results are the biggest weakness of the paper. It is not currently obvious that a practitioner should clearly reach for irSLDS as the preferred method.\n  -  Are there other datasets (synthetic or real) that could be added to make the benefits of irSLDS more clear? \n   - Can the extended NASCAR example be made more extreme (e.g. more states) to make the differences between irSLDS and rSDLS more apparent? It is not clear that the differences in test log-likelihood are that drastic (and there do not appear to be underlying states of rSDLS displayed to compare to)\n   - Why not also show rSLDS continuous states in Figure 2.E? I would expect these to not look good (unlike in Figure 2.D where rSLDS and irSLDS look similar) and think highlighting this would be helpful\n\n- It is claimed in Section 3.3 that irSLDS has a similar time complexity to rSLDS. It would be nice to see some kind of empirical runtime comparison to support this. How does this change when choosing different upper bounds of $K$?\n\n- Related to the 2 previous points above, it seems 2 potentially simple baselines would be an rSLDS with a large number of states or alternatively performing a grid search with rSLDS over different state sizes. On the other hand, given the flexibility of irSLDS, I would think it should be able to achieve better performance than these 2 baselines in one-shot. Instead, it seems the same amount of grid search was done for each method over the number of states. Alternatively, if either of these two baselines still takes less time/cost than running irSLDS (this is where the empirical runtime comparison comes in), then it seems perhaps rSLDS would be preferable for a practitioner in many cases? I think empirical evidence to resolve these doubts, both in terms of the empirical runtime under different scenarios and the time/cost per methods to achieve strong results, would strengthen the paper."
                },
                "questions": {
                    "value": "For major points, see weaknesses above. \n\nAdditional questions/comments:\n\n- In Table 1, can you make it more clear what the true number of states in the system are and what size $K$ is used by the models? I believe the number currently listed is the true number of states in the system, but it is unclear what $K$ was chosen for the models.\n\n- Unless I am missing something, I believe the last paragraph of Section 3.3 has an error regarding the computational complexity of the sequential vs parallel versions of the algorithm. It is stated that the sequential scan requires $\\mathcal{O}(K^3T)$ ops, but shouldn't this be  $\\mathcal{O}(K^2T)$ ops? This is because it requires $T$ sequential matrix-vector multiplications (compared to the cubic cost of matrix-matrix multiplications of the parallel version of the scan). Thus the choice of parallel vs sequential scan would be dependent on the state size and sequence length, since the cubic cost could grow quite large for larger state sizes.\n\n- This paper https://arxiv.org/abs/2111.01256 seems relevant to infinite switching states and could be cited as related work"
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "6: marginally above the acceptance threshold"
                },
                "confidence": {
                    "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                },
                "first_time_reviewer": {
                    "readers": [
                        "ICLR.cc/2024/Conference/Program_Chairs",
                        "ICLR.cc/2024/Conference/Submission7878/Senior_Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission7878/Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission7878/Reviewer_Rx1k"
                    ]
                }
            },
            "number": 2,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission7878/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1699126477690,
            "cdate": 1699126477690,
            "tmdate": 1700589992877,
            "mdate": 1700589992877,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "pgTNJkRWQc",
                "forum": "YIls9HEa52",
                "replyto": "LFkHvyspxs",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission7878/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission7878/Authors"
                ],
                "content": {
                    "comment": {
                        "value": "Thank you for your careful review! We appreciate the time and dedication towards highlighting the strengths and valuable feedback to make the paper better. We hope below to have summarised faithfully the weaknesses and questions you raised. \n\nFirst, addressing the weaknesses point by point: \n- **Polya-gamma**: Thank you for the suggestion on the Polya-gamma augmentation, we will add some of the suggested details on the time-dependent sizes in the main text for the final version.\n- **Extended NASCAR**: The rSLDS states equivalent to Figure 2E-F can now be found in Appendix Figure 5 -- we apologize for their omission in the original submission. Indeed as you predicted, the sampled continuous states do not look as good for the rSLDS, whereas the samples are much more in line with the posterior mean for the irSLDS. Furthermore, we also provide the equivalent to Figure 2F for the rSLDS by plotting the most likely $\\hat z_{1:T}$ trajectory, and we see that the rSLDS model mistakenly maintains only $K=4$ states after the switch to the alternate dynamics (where $K=6$). Together these results reinforce the performance of the irSLDS over the rSLDS in this non-stationary case. We can include these details in the main text for the final version. \n\n- **Empirical considerations**: Finally, thank you for bringing up concerns on the practitioner, empirical, side. First, we hope the provided running times in the updated manuscript (see Appendix D.2.) help give a better sense of the computational cost. They support, for instance, how a grid search over $K$ for the rSLDS would be quite computationally expensive compared to our irSLDS, which has more flexibility with respect to the inferred $K$. Furthermore, recall that we provided empirical evidence (in Section 4.2 on the IBL data) towards the irSLDS model's ability to uncover fluctuations in the number of discrete states $K$ on a trial-by-trial basis. The rSLDS provided a slightly worse fit, and did not uncover those fluctuations as much. This indicates that even if the grid-search over $K$ with the rSLDS *was* computationally efficient and preferred, it would still yield a constant $K$ that might miss those within-dataset fluctuations.\n\nAs for the additional questions/comments: \n- **Computational complexity**: Thank you for pointing this out, this is highlights a good need for clarification! For the parallel scan, we focus on its use for the computation of the full transition matrices $W_{1:T}$. Since these are matrix dynamics, and not vector dynamics, they do require $\\mathcal{O}(K^3 T)$ ops, from $T$ sequential matrix-to-matrix multiplications. We agree that the text was misleading, making it seem that we use it for the computation of the vector sufficient statistics $\\boldsymbol w_n$. This latter computation only really arises if we want to generate samples from the model, in which case it is indeed sequential -- but so are all other models. We provided some clarification in the updated manuscript, and will pay attention to those details for the final version!\n- Thank you for the relevant reference, we've included it in the introduction.\n\nThank you again for your feedback. We look forward to answering any further questions you have!"
                    }
                },
                "number": 5,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission7878/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700415000868,
                "cdate": 1700415000868,
                "tmdate": 1700415045519,
                "mdate": 1700415045519,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "BzYnYLZugS",
                "forum": "YIls9HEa52",
                "replyto": "pgTNJkRWQc",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission7878/Reviewer_Rx1k"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission7878/Reviewer_Rx1k"
                ],
                "content": {
                    "comment": {
                        "value": "Thank you for the response and clarifications. I have increased my score."
                    }
                },
                "number": 10,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission7878/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700590045696,
                "cdate": 1700590045696,
                "tmdate": 1700590045696,
                "mdate": 1700590045696,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "X44yYSQwtb",
            "forum": "YIls9HEa52",
            "replyto": "YIls9HEa52",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission7878/Reviewer_uvcW"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission7878/Reviewer_uvcW"
            ],
            "content": {
                "summary": {
                    "value": "The authors propose a method for fitting dynamical models onto neural data that estimates the latent state of the system/organism.  A commonly used approach in the recent years is to fit a recurrent switching linear model, that approximates the latent dynamics with a finite set of low dimensional linear systems, where the system state is assumed to switch at discrete points between these discrete states. However this formalism requires stationary dynamics across all trials and does not impose any geometry on the discrete latent state space. Here the authors propose an extension to the recurrent switching linear systems, by considering that the evolution between the discreet states follow a Markov process itself (a distance-dependent Chinese restaurant process). To perform inference on the proposed model, they introduce a time-dependent sufficient statistic for the discrete state, the influence function, that is assumed to follow the heat (PDE) equation. The advantage of this statistic is that it is deterministically determined given the latent discrete state and the observations, and therefore does not arise in the posterior inference. Thus the authors can apply existing variational Laplace-EM proposed for these type of models like in Zoltowski et al. (2020). \n\nThey validate their approach on a synthetic dataset devised to imitate o stationary discrete latent state dynamics, and on an neural electrophysiology dataset from IBL with neural recordings from mice performing  a decision-making task.\n\nOverall the paper is very well written and is a sound extetion to the existing literature of switching linear dynamical systems."
                },
                "soundness": {
                    "value": "4 excellent"
                },
                "presentation": {
                    "value": "4 excellent"
                },
                "contribution": {
                    "value": "3 good"
                },
                "strengths": {
                    "value": "- They endow the switching linear dynamical system framework with a latent discrete-state Markov structure that allows the continuous state of the system to guide the discrete state switches.\n- The proposed formalism induces a geometry in the discrete latent state between switches. \n- The paper is very well written providing a very well constructed introduction and build-up to their proposed extention."
                },
                "weaknesses": {
                    "value": "- The resulting computations for this model are considerably more expensive compared to the previous approaches recurrent switching linear system framework, however this might be the tradeoff of dealing with non-stationarity."
                },
                "questions": {
                    "value": "- In Figure 3 F lower,  irSLDS identifies the state 2, although it does predict (as I understand from the absence of orange dots) that the discrete state of the system was never at that state through the trials. Isn\u2019t that strange? Shouldn\u2019t the framework have estimated 7 states in total for this dataset?\n\n- In the NASCAR experiment, can you provide the same plot as in Figure 2F that shows the sequence of the identified states also for the rSLDS?\n\n- What are the limitations for considering Poisson instead of Gaussian observation process for the irSLDS framework?\n\n\nMinor:\n- Conclusion has various typos, i.e. first sentence of conclusion: \u201ca\u201d-> \u201can\u201d, missing \u2019s\u2019-es.\n- I understand that in the caption of Figure 1 you do not want to write out the full abbreviated terms, but you can at least provide a hyperlink to their mention in the main text for the reader to follow."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "8: accept, good paper"
                },
                "confidence": {
                    "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 3,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission7878/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1699163527023,
            "cdate": 1699163527023,
            "tmdate": 1699636966502,
            "mdate": 1699636966502,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "yGKLbqkK0d",
                "forum": "YIls9HEa52",
                "replyto": "X44yYSQwtb",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission7878/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission7878/Authors"
                ],
                "content": {
                    "comment": {
                        "value": "Thank you for your positive review and feedback! We hope what follows answers your remaining questions.  \n\nTo address the weakness raised, handling non-stationarity is indeed often challenging. Fortunately, the discrete-state process is defined by only a few key parameters, which helps in terms of interpretability and can help with hyperparameter optimization during training. Furthermore, our implementation of the scan operation does significantly reduce the computational complexity (see empirical running times added in Appendix D.2) where it can be deployed.\n\nAs for your questions: \n- Indeed we set $K=8$ as an upper bound. For this specific visualization of inferred discrete states, namely the most likely sequence, indeed it does not use state #2. This state is still however well defined for the model, and other analyses (such as for instance smoothing marginal posteriors $p(z_t \\mid \\hat x_{1:T}, y_{1:T})$) might leverage that state. \n- Thank you for pointing that out! We provide the same plot as Figure 2E-F for the rSLDS in Figure 5 in the Appendix. As an overview, we observe that the sampled continuous states do not look as good for the rSLDS, whereas the samples are much more in line with the posterior mean for the irSLDS. As for the equivalent to Figure 2F for the rSLDS, with the most likely $\\hat z_{1:T}$ trajectory, and we see that the rSLDS model mistakenly maintains only $K=4$ states after the switch to the alternate dynamics (where $K=6$). Together these results reinforce the performance of the irSLDS over the rSLDS in this non-stationary case. We can include these details in the main text for the final version. \n- There would be no limitations to considering Poisson instead of Gaussian observation process for the irSLDS framework, with this specific implementation. Indeed, we do not leverage the Gaussian observation process directly, which one could do for instance to do efficient (even exact if given the $z_{1:T}$ sequence) marginalization of the continuous states in SLDS models. Here, all of our implementation is based on the SSM package, so all computation is numerical and readily generalizable to other emission processes. \n\nFinally, thank you for pointing typos/clarifications, we will integrate them in the final version. We look forward to answering any further questions you have!"
                    }
                },
                "number": 4,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission7878/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700414584473,
                "cdate": 1700414584473,
                "tmdate": 1700414584473,
                "mdate": 1700414584473,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "hZoJI4PMu9",
                "forum": "YIls9HEa52",
                "replyto": "yGKLbqkK0d",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission7878/Reviewer_uvcW"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission7878/Reviewer_uvcW"
                ],
                "content": {
                    "comment": {
                        "value": "I have read the responses to my comments, and I would like to thank the authors for the clarifications!"
                    }
                },
                "number": 13,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission7878/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700668858097,
                "cdate": 1700668858097,
                "tmdate": 1700668858097,
                "mdate": 1700668858097,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "InrpCh4oLC",
            "forum": "YIls9HEa52",
            "replyto": "YIls9HEa52",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission7878/Reviewer_u3HM"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission7878/Reviewer_u3HM"
            ],
            "content": {
                "summary": {
                    "value": "The authors proposed a novel infinite recurrent switching linear dynamical system (irSLDS) model, which combines partial differential equations (PDE) theory, semi-parametric formulation, and switching dynamical models. The authors validate and demonstrate the capabilities of their model on simulated data, and compare their model with existing popular methods. Finally, they use the model to explore mouse electrophysiological data during decision-making and uncover strong non-stationary processes underlying both within-trial and trial-averaged neural activity."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "3 good"
                },
                "strengths": {
                    "value": "The authors introduced an influence function of the states in switching linear dynamical systems, which controls the switches between discrete states by adding time-dependent parameters to constrain the duration of a state, and a space smoothness prior to the influence function."
                },
                "weaknesses": {
                    "value": "How is the smoothness prior determined? In the paper, the authors state \u201cEach time a discrete state j is chosen, \u201cnearby\u201d states also become more probable at the next time step\u201d, it may be better to show the comparison with no smoothness or other smoothness formulations. \n\nThe prior based on dist-CRP is sensitive to time, what if there is a state with a long duration in the real dynamics? Or what if the dynamics are influenced by time a lot, such as in a Lorenz attractor?\n\nHow was the upper bound of K in irSLDS determined? Since the method is called infinite rSLDS, can the K be very large?\n\nClarity:\nIn 4.2 paragraph3, \u201cwe fit a spline to this curve a ...\u201d seems to have a typo."
                },
                "questions": {
                    "value": "See 'Weaknesses'."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "8: accept, good paper"
                },
                "confidence": {
                    "value": "2: You are willing to defend your assessment, but it is quite likely that you did not understand the central parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                },
                "first_time_reviewer": {
                    "readers": [
                        "ICLR.cc/2024/Conference/Program_Chairs",
                        "ICLR.cc/2024/Conference/Submission7878/Senior_Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission7878/Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission7878/Reviewer_u3HM"
                    ]
                }
            },
            "number": 4,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission7878/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1699308582912,
            "cdate": 1699308582912,
            "tmdate": 1700515364275,
            "mdate": 1700515364275,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "z6ySVrUrdC",
                "forum": "YIls9HEa52",
                "replyto": "InrpCh4oLC",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission7878/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission7878/Authors"
                ],
                "content": {
                    "comment": {
                        "value": "We thank you for the review! Specifically, we appreciate bringing to light the influence of hyper-parameters. Addressing the weaknesses point by point: \n\n- **Smoothness**: Indeed influence from ``nearby'' states is mediated by the diffusion parameter $\\gamma$, or in the FDM implementation, $\\beta \\propto \\gamma$. For the results reported in the submission we fixed $\\beta = 1.0$ (for all tasks) determined from a quick hyper-parameter search. We agree an exploration of smoothness, per task, would be insightful -- we propose to include the log-likelihood search as well as example generated trajectories in the final version. \n\n- **Time duration and dependence**: Similarly to the smoothness described above, discrete-state duration can be mediated by the $\\kappa$ hyperparameter. We used $\\kappa = 0.4$, determined from a quick hyper-parameter search. As with the smoothness, we could include in the final version details on this hyper-parameter search. Regarding the question raised on time dependence: this is where our accent on the inclusion of input-driven transitions, either from external inputs $\\boldsymbol u_n$ or continuous internal states $\\boldsymbol x_n$ (recurrence), can shine through. Indeed one could include the time $n$ as an external input, for instance by defining the sufficient statistic dynamics as\n\\begin{equation}\n    \\boldsymbol w_{n+1} = U \\boldsymbol w_{n} + \\kappa\\mathbf{1}_{i} + R \\boldsymbol x_n + r + g(n,i)\n\\end{equation}\nfor $g(n,i)$ some parametrized function (e.g. affine $Q^{(i)} n + q$). Concretely for the Lorentz system mentioned, this modeling could leverage the continuous latent $\\boldsymbol x_n$ to dictate one discrete state per side of the attractor, or use the time dependence to do so.\n\n- **Number of states**: For the synthetic experiments, $K$ was set to the true known value ($K=4$ NASCAR, $K=6$ extended NASCAR). For the IBL task, we used $K=8$ and provided in Appendix section D results on the log-likelihood search over different values of $K$. To address your final question, we will provide in the final version an analysis for scaling $K$, showing for instance how the different models fare in ($K$) over-parametrized regimes. \n\nThank you again for your feedback. We look forward to answering any further questions you have!"
                    }
                },
                "number": 3,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission7878/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700414287795,
                "cdate": 1700414287795,
                "tmdate": 1700415928360,
                "mdate": 1700415928360,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "3KYZqLD9t2",
                "forum": "YIls9HEa52",
                "replyto": "z6ySVrUrdC",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission7878/Reviewer_u3HM"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission7878/Reviewer_u3HM"
                ],
                "content": {
                    "comment": {
                        "value": "Thank you to the authors. I am raising my score to 7 in light of their responses."
                    }
                },
                "number": 8,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission7878/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700515338312,
                "cdate": 1700515338312,
                "tmdate": 1700515338312,
                "mdate": 1700515338312,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "ZWmLuo564Y",
            "forum": "YIls9HEa52",
            "replyto": "YIls9HEa52",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission7878/Reviewer_ots3"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission7878/Reviewer_ots3"
            ],
            "content": {
                "summary": {
                    "value": "This work presents an addition to recurrent switching state-space models by using PDEs to develop an input-driven prior that induces state geometry over the HMM while still retaining its recurrent capability. The proposed infinite recurrent switching linear dynamical system (irSLDS) allows for more expressible and flexible state cardinality over a fixed number of discrete states while yielding fewer parameters compared to previous HMM models but greater performance on two time-varying datasets: NASCAR and the \u201cBrainwide map\u201d dataset from the International Brain Laboratory. This is achieved by differentiating the influence functions of each state using the heat equation as a spatial smoothness prior. The forward difference of the time derivative and central difference approximation to the second order spatial partial derivative are utilized to retrieve an infinite prior for the dynamics of the influence functions and sampled to compose the overall discrete state process."
                },
                "soundness": {
                    "value": "2 fair"
                },
                "presentation": {
                    "value": "2 fair"
                },
                "contribution": {
                    "value": "3 good"
                },
                "strengths": {
                    "value": "The paper's originality derives from improvements it makes in the class of AR-HMM and SLDS models by removing exchangeability without removing input recurrence. This enables greater efficiency with expressibility. Overall, this work nicely integrates the heat-equation generalization and recurrent switching state space models. They present overall improvements on two different experiments with greater efficiency of parameters. Visuals are strong, particularly ones pertaining to the flow fields and the switching states of the rSLDS and irSLDS."
                },
                "weaknesses": {
                    "value": "Most of the comparisons are done between rSLDS and irSLDS, yet the results are not convincing and substantially novel in the experiments conducted. If the authors are adamant about just comparing these two models, then it would be nice to see comparisons at greater scales instead of just testing 4-8 states for NASCAR and the IBL experiments. The results at just these scales do not appear novel.\nFurthermore, both experiments show that the irSLDS models uncovered switching at task-relevant states, yet it isn't clear why adding the heat equation prior itself is the best choice in discovering this switching. The authors discuss their reasons for using the heat equations but don't explain further into infinite priors that possibly could have achieved the same if not more.\nThe efficient of the parallel scan is not clear. Other works that utilize scans to efficiently compute the transition probabilities such as S4D (Gu et al., 2022), DSS (Gupta et al., 2022), S5 (Smith et al., 2023) are done on diagonalized transition matrices. The connection to the parallelization of the linear dynamics in Equation 8 is unclear since the transition matrix in this work is not diagonalized, so this work does not reap the same computational benefits that they claim, and their algorithm cannot scale effectively since it incurs cubic cost."
                },
                "questions": {
                    "value": "Smith et al. is cited in reference to the use of a scan operation to compute transition probabilities. However, S5 assumes a diagonal state matrix to efficiently compute the linear recurrence which takes a different form than the time-varying transition matrices in this work. How can this scan method scale efficiently?\nWhy does the heat equation prior directly enable discovery of greater fluctuations/switching in the data? Can you attribute the performance gains to this specific infinite prior?\nWhy not compare to other linear state space models and generalize outside of rSLDS and irSLDS that can allow for input-dependent transitions and recurrent relations without the explicit use of the influence functions as a geometric prior?"
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "5: marginally below the acceptance threshold"
                },
                "confidence": {
                    "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                },
                "first_time_reviewer": {
                    "value": "Yes",
                    "readers": [
                        "ICLR.cc/2024/Conference/Program_Chairs",
                        "ICLR.cc/2024/Conference/Submission7878/Senior_Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission7878/Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission7878/Reviewer_ots3"
                    ]
                }
            },
            "number": 5,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission7878/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1699324468551,
            "cdate": 1699324468551,
            "tmdate": 1699636966293,
            "mdate": 1699636966293,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "aYM6jFj0Nt",
                "forum": "YIls9HEa52",
                "replyto": "ZWmLuo564Y",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission7878/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission7878/Authors"
                ],
                "content": {
                    "comment": {
                        "value": "Thank you for your thorough review, we appreciate the time and dedication towards making the paper better. We hope to have summarised faithfully the weaknesses and questions you raised, and we address them point-by-point below: \n\n- **Comparison with other models**: We agree that our analysis is limited to the switching linear dynamical system and its direct extensions. Our primary goal was to convey how a carefully designed prior (in our case the heat equation that captures the dist-CRP and induces a state geometry) with select hyperparameters can maintain similar performance/efficiency, while increasing interpretability. In line with this goal, we focus on only one model family, with and without this prior. We appreciate the feedback on reinforcing the analysis and will provide scalability results in the final version with a more thorough analysis beyond the 4-8 states!\n\n- **Heat equation prior**: We agree that there are alternative prior formulations, and we do not make claims that this is necessarily the *best* prior to uncover switching. These possible alternate priors are not discussed thoroughly in the current manuscript, and we will make sure to include a discussion element on that regard. Nonetheless, our claim is that this prior encapsulates important properties, and as such offers a good prior for model fitting and data-driven analysis. With regards to your question \"Why does the heat equation prior directly enable discovery of greater fluctuations/switching in the data?\": as mentioned in the text, we attribute this capability to the fact that the heat equation prior encapsulates the dist CRP (point #2, end of section 3.2), yielding a model with greater capacity to calibrate the number of states used from the data.\n\n- **Parallel scan**: Thank you for raising questions on this topic, we realize that there is a need for clarification! First, just so there is no doubt, we use the parallel scan operation for the computation of the transition matrices $W_n$, *not* for the computation of the dynamics of $\\vec x_n$. Hence our dynamics matrix of study is the FDM matrix $U$, not the time-varying linear matrices for the continuous state dynamics. Now, indeed, the previous work mentioned using the scan operation has focused on dynamics with diagonal matrices, whereas our dynamics matrix is not (here, tri-diagonal). Still, the parallel scan operation can be deployed for any recurrent system with affine dynamics. The diagonalization mentioned is crucial for efficient computation as $K$ scales, but this is not our focus. Our main focus is in making the computation more efficient as $T$ scales, and the parallel scan allows that, by bringing the sequential $T$ to $(T/L + \\log L)$ ops. In our updated manuscript, we make explicit the dynamics of $W_n$ in Appendix C.3 for reference, and provide empirical running times in Appendix D.2 to showcase the increased efficiency from the scan.\n\nThank you again for your feedback. We look forward to answering any further questions you have!"
                    }
                },
                "number": 2,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission7878/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700414006890,
                "cdate": 1700414006890,
                "tmdate": 1700414006890,
                "mdate": 1700414006890,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    }
]