[
    {
        "title": "Iteratively Refined Behavior Regularization for Offline Reinforcement Learning"
    },
    {
        "review": {
            "id": "JEzNcvZeYe",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission7699/Reviewer_ByMR"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission7699/Reviewer_ByMR"
            ],
            "forum": "50vyPuz0iv",
            "replyto": "50vyPuz0iv",
            "content": {
                "summary": {
                    "value": "This paper aims to address the suboptimality that arises from the behavior regularization w.r.t the suboptimal datasets in policy-constraint-based offline RL methods. Specifically, this paper casts policy constraints on an iteratively evolved reference policy $\\bar{\\pi}$ rather than the suboptimal behavior policy $\\pi_D$. Theoretical analysis proves that this iteratively evolved policy constraint can not only avoid OOD queries but also achieves in-sample optimality when the initial reference policy $\\bar{\\pi}$ is initialized to $\\pi_D$ under the full-data-coverage assumption that the optimzied policy $\\pi$ should always stay in the support of the reference policy $\\bar{\\pi}$. However, for practical implementation, this paper also applies constraints on the suboptimal behavior policy to stablize training, where the constraint strength between $\\pi_D$ and $\\bar{\\pi}$ are balanced by an newly introduced hyper-parameter. This paper also provides extensive experimental results to demonstrate the effectiveness of the proposed method."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "4 excellent"
                },
                "contribution": {
                    "value": "2 fair"
                },
                "strengths": {
                    "value": "1. This paper is well organized and well written, presenting good motivations in Figure 1 and theoretical analysis in Theorem 1 to show the significance of the proposed method.\n2. The proposed method is simple and easy to implement.\n3. The experimental results are sufficient."
                },
                "weaknesses": {
                    "value": "## Major weakness\nThe performance improvement seems to primarily stem from comprehensive parameter tuning, rather than the proposed  iterative refinement of policy constraints. CPI can be viewed as adding an additional iteratively refined policy constraint to TD3+BC, while introducing a new hyperparameter $\\lambda$ to adjust the constraint strengths. In my view, this is doing some kind of conservatism relaxation and introduces an additional hyperparameter, providing a more precise adjustment of conservatism strengths than solely tuning the $\\tau$. Consequently, this leads to performance gains compared to the base method, TD3+BC.\n\nSee from Table 3 and Table 4 that hyper-parameters are thoroughly tuned for each individual task. Moreover, Table 5 shows that TD3+BC (dynamic $\\alpha$) is on par with CPI and CPI-RE. This indicates that TD3+BC might also achieve in-sample optimality and meanwhile prevents OOD issues with a carefully sweeped conservatism strength $\\alpha$.\n\nI would consider raise my score if the major weakness is well resolved.\n\n## Minor weakness\nThe idea about utilizing an iteratively refined policy constraint is already introduced by a recent offline2online RL paper[1], which is stated as a future research in Conclusion.\n\n[1] PROTO: Iterative Policy Regularized Offline-to-Online Reinforcement Learning. 2023.\n\n## Typo\n1. In proposition 1, the (34) would be better (5)."
                },
                "questions": {
                    "value": "1. I'm wondering how do CPI and CPI-RE perform using one group of hyperparameters for each types of tasks including Gym-Mujoco, Antmaze and Adroit, respectively, just like previous works such as IQL and TD3+BC does.\n2. In Equation (10), I'm questioning the term $\\tau(1-\\lambda)\\lambda$. Could there possibly be an error? Should it be $\\tau(1-\\lambda)$ instead?\n\nPlease refer to the weakness for details."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "details_of_ethics_concerns": {
                    "value": "N/A"
                },
                "rating": {
                    "value": "6: marginally above the acceptance threshold"
                },
                "confidence": {
                    "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                },
                "first_time_reviewer": {
                    "value": "Yes",
                    "readers": [
                        "ICLR.cc/2024/Conference/Program_Chairs",
                        "ICLR.cc/2024/Conference/Submission7699/Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission7699/Reviewer_ByMR",
                        "ICLR.cc/2024/Conference/Submission7699/Senior_Area_Chairs"
                    ]
                }
            },
            "number": 1,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission7699/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1697373154442,
            "cdate": 1697373154442,
            "tmdate": 1700189551738,
            "mdate": 1700189551738,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "rmMYY8eYkK",
                "forum": "50vyPuz0iv",
                "replyto": "JEzNcvZeYe",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission7699/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission7699/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Response to Reviewer ByMR"
                    },
                    "comment": {
                        "value": "## Q: The performance improvement seems to primarily stem from comprehensive parameter tuning, rather than the proposed iterative refinement of policy constraints.\n\nA: In Section 5.1, we conduct an evaluation of CPI within two GridWorld environments. We consider two baseline algorithms: InAC, a method that guarantees to find the in-sample softmax, and a method that employs policy iteration with behavior regularization (BR), which could be viewed as an extension of TD3+BC  for the discrete action setting.  Both CPI and InAC converge to the oracle across various $\\tau$ and environments settings. In contrast, BR underperforms when a larger $\\tau$ is applied on 7*7-GridWorld and FourRoom-random. This evaluation ensures no parameter tuning while still demonstrates the effectiveness of CPI. , which proves the  performance improvement primarily stem from the  proposed iterative refinement of policy constraints. \n\nWhile when function approximation is applied, tuning parameters becomes a common issue of almost all SOTA offline RL algorithms. For example,  XQL[1], an in-sample optimization method, is relies on tuning the hyper-parameters according to Figure 7, 10 and 11 in the appendix of the original paper. In practice, we believe it's unlikely that a method could dominate all tasks without tuning parameters. \n\n\n\n## Q: TD3+BC might also achieve in-sample optimality and meanwhile prevents OOD issues with a carefully swept conservatism strength $\\alpha$.\n\nA: The critical hyper-parameter in TD3+BC is $\\alpha$ value, which controls the weight of RL learning and behavior cloning process. The $\\alpha$ is set 2.5 by default in the original paper in Mujoco tasks, and we indeed find that the value of 2.5 works well only in Mujoco tasks. Thus, as you suggested, we conduct a hyperparameter search in the ranges {0.0001, 0.05, 0.25, 2.5, 25, 36, 50, 100} for Antmaze and Adroit datasets, and report the results in our results tables.  It can be found that changing $\\alpha$ can indeed improve the performance of TD3+BC. However, the performance of CPI is still significantly better on Antmaze and Adroit, which proves the effectiveness of the mechanism for iterative refinement of policy for behavior regularization in CPI. \n\n\n\n|                        | TD3BC (default) | TD3BC (with swept best hyperparameter ) | CPI               | CPI-RE            |\n| ---------------------- | --------------- | --------------------------------------- | ----------------- | ----------------- |\n| antmaze-umaze          | 78.6            | 78.6 \uff08$\\alpha=2.5$\uff09                   | **98.8$\\pm$1.1**  | **99.2$\\pm$0.5**  |\n| antmaze-umaze-diverse  | 71.4            | 71.4 \uff08$\\alpha=2.5$\uff09                   | **88.6$\\pm$5.7**  | **92.6$\\pm$10.0** |\n| antmaze-medium-play    | 3.0             | 35.7$\\pm$11.0 \uff08$\\alpha=36$\uff09           | **82.4$\\pm$5.8**  | **84.8$\\pm$5.0**  |\n| antmaze-medium-diverse | 10.6            | 17.5$\\pm$0.43\uff08$\\alpha=25$\uff09            | **80.4$\\pm$8.9**  | **80.6$\\pm$11.3** |\n| antmaze-large-play     | 0.0             | 0.0$\\pm$0.0 \uff08$\\alpha=50$\uff09             | **20.6$\\pm$16.3** | **33.6$\\pm$8.1**  |\n| antmaze-large-diverse  | 0.2             | 0.2 \uff08$\\alpha=2.5$\uff09                    | **45.2$\\pm$6.9**  | **48.0$\\pm$6.2**  |\n| pen-cloned             | 5.13            | 64.2 $\\pm$17.3\uff08$\\alpha=0.0001$\uff09                | **71.8$\\pm$35.2** | **70.7$\\pm$15.8** |\n\n\n## Q: how do CPI and CPI-RE perform using one group of hyperparameters for each types of tasks\n\nA: We are still working on the experiments. We will post the results when the experiments finish. \n\n\n\n## Q: term $\\tau(1-\\lambda)$\n\nA: Thanks for pointing this out. We have modify this in the revised paper. \n\n\n\n## Q: In proposition 1, the (34) would be better (5).\n\nA:  This is due to a replicated label used in the same equation within method and appendix. We have revised them. \n\n## Citations\n\n [1] Garg, Divyansh, et al. \"Extreme Q-Learning: MaxEnt RL without Entropy.\" *The Eleventh International Conference on Learning Representations*. 2022."
                    }
                },
                "number": 4,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission7699/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1699929988859,
                "cdate": 1699929988859,
                "tmdate": 1699930506206,
                "mdate": 1699930506206,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "aLkHDVZw61",
                "forum": "50vyPuz0iv",
                "replyto": "JEzNcvZeYe",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission7699/Reviewer_ByMR"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission7699/Reviewer_ByMR"
                ],
                "content": {
                    "title": {
                        "value": "Additional concerns"
                    },
                    "comment": {
                        "value": "Dear authors,\nI appreciate the authors for their detailed responses. Some of my concerns are addressed. However, I still have further concerns.\n\n1. Regarding this response,\n>In practice, we believe it's unlikely that a method could dominate all tasks without tuning parameters.\n\nAs the authors proposed a relatively simple method, I believe this kind of simple method should be robust enough for different tasks using the same hyperparameters. Otherwise, the simplicity of the proposed method goes nowhere as we still require a lot of hyper-parameter tuning to obtain a good result. For example, TD3+BC/CQL/IQL/POR/EDAC in the paper all used as little as possible hyper-parameter tuning to ensure good results.  Therefore, based on the fact that CPI and CPI-RE thoroughly tuned the hyper-parameters, other baselines should also be well-tuned to ensure a fair comparison.\n\n2. Why does Table 1 bold CPI and CPI-RE for some tasks that are inferior to IQL, such as some antmaze tasks?"
                    }
                },
                "number": 5,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission7699/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700144336536,
                "cdate": 1700144336536,
                "tmdate": 1700144414608,
                "mdate": 1700144414608,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "ix1YUkP8Jd",
                "forum": "50vyPuz0iv",
                "replyto": "JEzNcvZeYe",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission7699/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission7699/Authors"
                ],
                "content": {
                    "comment": {
                        "value": "Thanks for your reply! \n### Q: The performance of CPI and CPI-RE with as little as possible hyper-parameter tuning?\nA: We provide the well-tuned TD3BC in the previous response, and the results show that CPI is still significantly better than the well-tuned TD3BC on Antmaze and Adroit. In addition, we agree that a simple method could reach realtively satisfying performance with as little as possible hyper-parameter (hp) tuning. Therefore, as you suggested, we used as few hyperparameters as possible on the same domain and conducted experiments. For MuJoCO datasets, we set $\\tau$ to 0.05 or 1.0, $\n\\lambda$ to 0.7. For Antmaze, we  set $\\tau$ to 0.1 and $\\lambda$ to 0.5. For Antmaze, we  set $\\tau$ to 200.0 and $\\lambda$ to 0.7. The detailed results (average across five seeds) and setting are provided in the following table:\n| Dataset                   | $\\tau$ | $\\lambda$ | TD3+BC | CQL    | IQL    | CPI with minimal hp tuning        | CPI results in paper |\n| ------------------------- | ------ | -------- | ------ | ------ | ------ | ------------- | -------------------- |\n| halfcheetah-random        | 0.05   | 0.7      | 11.0   | 31.3   | 13.7   | 29.7$\\pm$1.1  | 29.7$\\pm$1.1         |\n| halfcheetah-medium        | 0.05   | 0.7      | 48.3   | 46.9   | 47.4   | 64.4$\\pm$1.3  | 64.4$\\pm$1.3         |\n| halfcheetah-medium-replay | 0.05   | 0.7      | 44.6   | 45.3   | 44.2   | 54.6$\\pm$1.3  | 54.6$\\pm$1.3         |\n| halfcheetah-medium-expert | 1.0    | 0.7      | 90.7   | 95.0   | 86.7   | 89.7$\\pm$1.5  | 94.7$\\pm$1.1         |\n| halfcheetah-expert        | 1.0    | 0.7      | 96.7   | 97.3   | 94.9   | 98.1$\\pm$0.6  | 96.5$\\pm$0.2         |\n| hopper-random             | 0.05   | 0.7      | 8.5    | 5.3    | 8.4    | 29.5$\\pm$3.8  | 29.5$\\pm$3.7         |\n| hopper-medium             | 1.0    | 0.7      | 59.3   | 61.9   | 66.3   | 61.4$\\pm$1.9  | 98.5$\\pm$3.0         |\n| hopper-medium-replay      | 0.05   | 0.7      | 60.9   | 86.3   | 94.7   | 99.3$\\pm$6.8  | 101.7$\\pm$1.6        |\n| hopper-medium-expert      | 1.0    | 0.7      | 98.0   | 96.9   | 91.5   | 106.4$\\pm$4.3 | 106.4$\\pm$4.3        |\n| hopper-expert             | 1.0    | 0.7      | 107.8  | 106.5  | 108.8  | 112.2$\\pm$0.5 | 112.2$\\pm$0.5        |\n| walker2d-random           | 1.0    | 0.7      | 1.6    | 5.4    | 5.9    | 3.9$\\pm$2.2   | 5.9$\\pm$1.7          |\n| walker2d-medium           | 1.0    | 0.7      | 83.7   | 79.5   | 78.3   | 85.8$\\pm$0.8  | 85.8$\\pm$0.8         |\n| walker2d-medium-replay    | 1.0    | 0.7      | 81.8   | 76.8   | 73.9   | 89.1$\\pm$3.0  | 91.8$\\pm$2.9         |\n| walker2d-medium-expert    | 1.0    | 0.7      | 110.1  | 109.1  | 109.6  | 110.9$\\pm$0.4 | 110.9$\\pm$0.4        |\n| walker2d-expert           | 1.0    | 0.7      | 110.2  | 109.3  | 109.7  | 110.6$\\pm$0.1 | 110.6$\\pm$0.1        |\n| mujoco-total              | -      | -        | 1013.2 | 1052.8 | 1034.0 | 1145.6        | 1193.2               |\n| antmaze-umaze             | 0.1    | 0.5      | 78.6   | 74.0   | 87.5   | 96.6$\\pm$3.2  | 98.8$\\pm$1.1         |\n| antmaze-umaze-diverse     | 0.1    | 0.5      | 71.4   | 84.0   | 62.2   | 88.6$\\pm$5.7  | 88.6$\\pm$5.7         |\n| antmaze-medium-play       | 0.1    | 0.5      | 3.0    | 61.1   | 71.2   | 82.4$\\pm$5.8  | 82.4$\\pm$5.8         |\n| antmaze-medium-diverse    | 0.1    | 0.5      | 10.6   | 53.7   | 70.0   | 78.8$\\pm$8.9  | 80.4$\\pm$8.9         |\n| antmaze-large-play        | 0.1    | 0.5      | 0.0    | 15.8   | 39.6   | 3.3$\\pm$5.7   | 20.6$\\pm$16.3        |\n| antmaze-large-diverse     | 0.1    | 0.5      | 0.2    | 14.9   | 47.5   | 23.0$\\pm$4.3  | 45.2$\\pm$6.9         |\n| antmaze-total             | -      | -        | 163.8  | 303.6  | 378.0  | 372.7         | 416.0                |\n| pen-human                 | 200.0  | 0.7      | -1.9   | 35.2   | 71.5   | 80.1$\\pm$16.9 | 80.1$\\pm$16.9        |\n| pen-cloned                | 200.0  | 0.7      | 9.6    | 27.2   | 37.3   | 69.7$\\pm$17.0 | 71.8$\\pm$35.2        |\n| adroit-total              | -      | -        | 7.7    | 62.4   | 108.8  | 149.8         | 151.9                |\n\nThe results show that comapred with IQL, CQL and TD3BC. the overall performance of CPI with as little as possible hyper-parameter tuning is still significantlly better.\n\n### Q: Why does Table 1 bold CPI and CPI-RE for some tasks that are inferior to IQL, such as some antmaze tasks?\nA: We are sorry we didn't claim the meaning of the bold. Our intention is to highlight the top results in the tabular. We have modified this part in the paper to make readers understand more clearly. Thanks for your advice!"
                    }
                },
                "number": 7,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission7699/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700186941026,
                "cdate": 1700186941026,
                "tmdate": 1700189884730,
                "mdate": 1700189884730,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "YYs5SONCEm",
                "forum": "50vyPuz0iv",
                "replyto": "ix1YUkP8Jd",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission7699/Reviewer_ByMR"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission7699/Reviewer_ByMR"
                ],
                "content": {
                    "title": {
                        "value": "Thanks for the quick response"
                    },
                    "comment": {
                        "value": "Dear authors,\n\nI appreciate your quick responses, which address my major concern regarding the hyper-parameter tuning. Thus, I'm happy to increase my score to a 6. \n\nSome minor typo: does the $\\alpha$ in your responses refer to the $\\lambda$ in your paper?"
                    }
                },
                "number": 9,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission7699/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700189527105,
                "cdate": 1700189527105,
                "tmdate": 1700189527105,
                "mdate": 1700189527105,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "rgJf45mlna",
            "forum": "50vyPuz0iv",
            "replyto": "50vyPuz0iv",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission7699/Reviewer_cTmM"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission7699/Reviewer_cTmM"
            ],
            "content": {
                "summary": {
                    "value": "This paper presents an innovative approach to refining behavior-regularized offline RL algorithms, introducing the concept of Iterative Self Policy Improvement (ISPI) that progressively optimizes within the behavior policy's support. The authors also propose a practical implementation trick for ISPI, demonstrating its effectiveness against strong baselines across various tasks."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "2 fair"
                },
                "strengths": {
                    "value": "1. Introduces a novel and promising concept of refining behavior policy to address suboptimal behavior.\n2. Section 3 adeptly explains the iterative solution and establishes a clear connection with online learning.\n3. Comprehensive and robust experimental section, with comparisons against the latest SOTA methods, clearly highlighting the improvements over the TD3+BC backbone algorithm."
                },
                "weaknesses": {
                    "value": "1. There's a noticeable discrepancy between the theoretical framework and the practical implementation. The theory is grounded on in-sample learning assumption, yet the Competitive Policy Improvement (CPI) paradigm isn't in line with this. The implementation appears to violate the in-sample property suggested by the theory.\n2. This paper lacks a clear link to in-sample learning despite a strong motivation, potentially leading to reader confusion, especially due to the mismatch between theory and practice. A restructuring of the manuscript to improve clarity and coherence is recommended.\n\nminors: \nThere are two hyperparameters in ISPI, which may be hard to tune in practice."
                },
                "questions": {
                    "value": "n/a"
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "3: reject, not good enough"
                },
                "confidence": {
                    "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 2,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission7699/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698439898718,
            "cdate": 1698439898718,
            "tmdate": 1699636937610,
            "mdate": 1699636937610,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "iajN8hp7O7",
                "forum": "50vyPuz0iv",
                "replyto": "rgJf45mlna",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission7699/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission7699/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Response to Reviewer cTmM"
                    },
                    "comment": {
                        "value": "## Q: There's a noticeable discrepancy between the theoretical framework and the practical implementation. \n\nA: The theoretical analysis considers the **tabular setting** with finite state and action space.  In this setting, CPI converges to the optimal policy that are well-covered by the dataset, commonly referred to as the in-sample optimal policy. However in practice, implementations often rely on a limited number of gradient descent steps for optimizing when function approximation is applied. To address this issue, we introduce another behavior regularization to ensure the stability of the implementation. \n\nThe mismatch between theory and practice is only due to function approximation and using gradient descent as optimization tools. Such an issue cannot be avoided and also exists in previous algorithms. For example, to learn the in-sample max, IQL requires solving expectile regression [1] (similarly, XQL [2] requires solving gumble regression), but practical implementation of IQL also depends on a few steps of gradient descent. The in-sample softmax policy iteration introduced in InAC  also uses samples from the current policy in the policy evaluation step [3].\n\n\n\n## Q:  There are two hyperparameters in ISPI, which may be hard to tune in practice.\n\nA: We provide the settings of regularization parameter $\\tau$ and weighting factor $\\lambda$ used in our main experiments in Table 4 of the appendix. The parameters  $\\lambda$ are settled by sweeping in [0.1, 0.3, 0.5, 0.7, 0.9] and choosing the best performing one. For ease of tunning, we also provide an empirical suggestion in Section 5.3.4 for the potential algorithm practitioners. \n\n\n## Citations\n[1] Kostrikov, Ilya, et al. \"Offline Reinforcement Learning with Implicit Q-Learning.\" *The Tenth International Conference on Learning Representations*. 2021.\n\n[2] Garg, Divyansh, et al. \"Extreme Q-Learning: MaxEnt RL without Entropy.\" *The Eleventh International Conference on Learning Representations*. 2022.\n\n[3] Xiao, Chenjun, et al. \"The In-Sample Softmax for Offline Reinforcement Learning.\" *The Eleventh International Conference on Learning Representations*. 2022."
                    }
                },
                "number": 3,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission7699/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1699929919734,
                "cdate": 1699929919734,
                "tmdate": 1699929919734,
                "mdate": 1699929919734,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "ZITb7JZ48Y",
                "forum": "50vyPuz0iv",
                "replyto": "iajN8hp7O7",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission7699/Reviewer_cTmM"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission7699/Reviewer_cTmM"
                ],
                "content": {
                    "title": {
                        "value": "Official Response to In-sample Learning from Reviewer cTmM"
                    },
                    "comment": {
                        "value": "Thanks for the reply, but I would like to keep my current rating because the in-sample optimality equation holds only when those actions are from the dataset  (IQL, POR, SQL (EQL), X-QL, IAC, InAC). Apperatenly, CPI does sample actions from $\\pi_{w'}$."
                    }
                },
                "number": 6,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission7699/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700179387128,
                "cdate": 1700179387128,
                "tmdate": 1700179387128,
                "mdate": 1700179387128,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "wzzgQDcOSD",
                "forum": "50vyPuz0iv",
                "replyto": "rgJf45mlna",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission7699/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission7699/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Response to Reviewer cTmM"
                    },
                    "comment": {
                        "value": "Thanks for your reply. It seems that the reviewer judge our contibution only based on terminology: \"In-sample algorithms only uses samples from the data. CPI doesn't do this. Therefore in-sample optimality cannot hold for CPI. \"\n\nIn Section 3.1, we prove that (Theorem 1) in the tabular case, CPI converges to the in-sample optimal solution, defined by Eq.6. That means, CPI enjoys the same theoretical guarantees as BRAC, IQL and InAC in the tabular setting case. If the reviewer believes that this is not true, we kindly ask the reviewer to point out which step of our derivation is wrong."
                    }
                },
                "number": 8,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission7699/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700187395889,
                "cdate": 1700187395889,
                "tmdate": 1700187817794,
                "mdate": 1700187817794,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "D6qFKqeRsh",
                "forum": "50vyPuz0iv",
                "replyto": "59vYkbeKXc",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission7699/Reviewer_cTmM"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission7699/Reviewer_cTmM"
                ],
                "content": {
                    "title": {
                        "value": "Official Comments from Reviewer cTmM"
                    },
                    "comment": {
                        "value": "Thank the authors for the prompt response! \n\n1. First, the in-sample optimality equation does not hold in CPI in the practical algorithm, and thus all following proof/lemma/proposition based on the in-sample optimality equation do not hold. I understand that Theorem 1 holds in the tabular case, but this theory-practice gap is significant. I strongly suggest the authors re-organize its proof under the in-support optimization framework rather than in-sample optimization. \n2. Experiments: I do not have questions related to experiments and I have also synchronized with the discussion with Reviewer ByMR.\n\nminors: \nwrong citation: BCQ does not have the in-sample optimality equation."
                    }
                },
                "number": 13,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission7699/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700701124182,
                "cdate": 1700701124182,
                "tmdate": 1700701124182,
                "mdate": 1700701124182,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "5RvwFnd80c",
            "forum": "50vyPuz0iv",
            "replyto": "50vyPuz0iv",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission7699/Reviewer_JFNQ"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission7699/Reviewer_JFNQ"
            ],
            "content": {
                "summary": {
                    "value": "The paper introduces an approach to improve behavior regularization through conservative policy iteration. This is achieved by incorporating an additional KL regularization term between the current policy and a static target policy network into the pre-existing TD3+BC objective function. The authors offer a theoretical analysis for the tabular case. They evaluate their proposed algorithm, CPI, as well as an ensemble policy variant, CPI-RE, using toy discrete datasets and the offline RL benchmark D4RL datasets."
                },
                "soundness": {
                    "value": "2 fair"
                },
                "presentation": {
                    "value": "2 fair"
                },
                "contribution": {
                    "value": "2 fair"
                },
                "strengths": {
                    "value": "The experiments conducted are comprehensive and of high quality."
                },
                "weaknesses": {
                    "value": "1. The paper's clarity and organization could benefit from a thorough revision. Currently, the flow is disjointed, with readers needing to frequently navigate back and forth, e.g., Proposition 1 references an equation found in the appendix. Additionally, the algorithm box lacks clarity, which is elaborated upon in the questions section.\n\n2. The paper's originality and novelty appear limited. The newly introduced component merely utilizes a target policy network for KL regularization\u2014a technique already employed in algorithms like TRPO and PPO. My interpretation suggests that the paper's primary contribution is a trick that demonstrates how integrating a conservative policy update can enhance offline RL.\n\n3. The scope of testing is narrow. Evaluating only on TD3+BC doesn't provide enough evidence to support the universal benefits of adding conservative policy learning. The authors claim that implementing their method requires minimal modifications to existing algorithms. If so, it would be beneficial to test it on other frameworks like IQL, CQL, and Diffusion-QL."
                },
                "questions": {
                    "value": "1. In Figure 1, does the dashed line represent a BC trained solely on the curated dataset?\n\n2. You mentioned, \"We provide the pseudocode for both CPI and CPI-RE here.\" I assume this \"here\" refers to the algorithm box?\n\n3. The algorithm box seems ambiguous in its description:\n  * Right after Equation (9), the reference policy is identified as the target policy. However, in the algorithm for CPI-RE, the reference policy is described as the optimal policy between $\\omega_1$ and $\\omega_2$.\n  * Can you clarify what is meant by the \"cross-update scheme\"?\n\n4. The paper notes that $\\pi_\\omega$ is initialized as $\\pi_\\omega = \\pi_D$. Could you specify where this initialization is reflected in the algorithm box?"
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "3: reject, not good enough"
                },
                "confidence": {
                    "value": "5: You are absolutely certain about your assessment. You are very familiar with the related work and checked the math/other details carefully."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 3,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission7699/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698701933755,
            "cdate": 1698701933755,
            "tmdate": 1699636937494,
            "mdate": 1699636937494,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "SM2GEaMJP7",
                "forum": "50vyPuz0iv",
                "replyto": "5RvwFnd80c",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission7699/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission7699/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Response to Reviewer JFNQ"
                    },
                    "comment": {
                        "value": "## Q: Proposition 1 references an equation found in the appendix\n\nA: This is due to a replicated label used in the same equation within method and appendix. We have revised them. \n\n\n\n## Q:  the algorithm box lacks clarity\n\nA: We provide the pseudocode for both CPI and CPI-RE in Algorithm 1. For line 9, it's true that the reference policy is the optimal policy between $w_{1}$ and $w_{2}$. As in CPI-RE,  two policies are trained. For example, when $w_{1}$ is updated, we compare the Q-value of actions from $w_{1}$ and  $w_{2}$. If the action of $w_{1}$ has higher Q-value, we will choose $w_{1}$ as the current reference policy. In this situation, only the behavior cloning term plays a role, which avoids the better policy $w_{1}$ being dragged down by the inferior policy $w_{2}$. Else, $w_{2}$ will be chose as the current reference policy.  \n\nWe try to express the sequential updating of $w_{1}$ and $w_{2}$ (i.e., update $w_{1}$ first, then update $w_{2}$) using the word cross-updating, we have modified this to avoid misunderstanding. Thanks for your advice.\n\n\n\n## Q: the paper's primary contribution is a trick \n\nA: While we appreciate the reviewer's comparison with TRPO and PPO, our approach offers a unique contribution. We don't merely employ a target policy network for KL regularization but derive it from the conservative policy updates in the tabular offline RL context. In other words,  the iterative refinement of policy constraints is the core idea of our work and adding the behavior cloning term is to help the implementation when function approximation is applied. This is not just a 'trick' but a significant enhancement to offline RL both in the theoretical aspects under the tabular settings. In the practical evaluation, we also outperform existing SOTA offline RL baselines.\n\n\n\n## Q: Evaluating only on TD3+BC doesn't provide enough evidence to support the universal benefits of adding conservative policy learning. \n\nA: We add conservative policy learning on IQL and test the variant on the following datasets. For each dataset, the weight of conservative policy learning is set to 1. For other parameters, we follow the original settings in IQL. Below are the final average normalized scores across three seeds trained after1M gradient steps.\n\n|                           | IQL   | IQL with conservative policy learning |\n| ------------------------- | ----- | ------------------------------------- |\n| halfcheetah-medium        | 47.4  | 48.3 $\\pm$ 0.3                        |\n| halfcheetah-medium-replay | 44.2  | 44.5 $\\pm$ 0.5                        |\n| halfcheetah-medium-expert | 86.7  | **94.6 $\\pm$ 0.1**                    |\n| hopper-medium             | 66.3  | 58.6 $\\pm$ 6.6                        |\n| hopper-medium-replay      | 94.7  | **100.6 $\\pm$ 0.4**                   |\n| hopper-medium-expert      | 91.5  | **112.3 $\\pm$ 0.4**                   |\n| walker2d-medium           | 78.3  | 76.4 $\\pm$ 3.4                        |\n| walker2d-medium-replay    | 73.9  | **84.3 $\\pm$ 3.1**                    |\n| walker2d-medium-expert    | 109.6 | **111.2 $\\pm$ 0.9**                   |\n\nNote that while it's efficient to add conservative policy learning on IQL, it may depart from the original intention of our algorithm design. This is because in CPI and CPI-RE, the behavior cloning term is used to assist the iterative refinement of policy constraints to ensure the the learning policy staying in the dataset distribution.  While in the implementation in IQL with conservative policy learning, the iterative refinement of policy constraints becomes an auxiliary loss.\n\n\n\n## Q: In Figure 1, does the dashed line represent a BC trained solely on the curated dataset?\n\nA: The dashed lines indicate the performance of BC policies trained on filtered sub-datasets consisting of top 5%, median 5%, and bottom 5% trajectories.\n\n \n\n## Q: The paper notes that $\\pi_{w}$ is initialized as $\\pi_{D}$. Could you specify where this initialization is reflected in the algorithm box?\n\nA:   In the tabular setting, Proposition 1 establishes that the exact solution of Eq.9 remains within the data support when the actor is initialized as $\\pi_\\omega=\\pi_{\\mathcal{D}}$. However,  practical implementations often rely on a limited number of gradient descent steps for optimizing Eq.9. This leads to policy optimization errors which are further exacerbated iteratively. To overcome this issue, we find it is useful to also add the original behavior regularization. In summary, adding this term is used to help the policy remains within the data support, thus there is no further need to initialize  $\\pi_\\omega=\\pi_{\\mathcal{D}}$ in the practical algorithm.  In our experiments, we also didn't find clear differences of initializing or not initializing  $\\pi_\\omega=\\pi_{\\mathcal{D}}$.  Thus in the practical algorithm box, there is no need to perform the  initialization."
                    }
                },
                "number": 2,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission7699/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1699929868098,
                "cdate": 1699929868098,
                "tmdate": 1699929868098,
                "mdate": 1699929868098,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    }
]