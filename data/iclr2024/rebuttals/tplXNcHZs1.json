[
    {
        "title": "Diffusion Posterior Sampling for Linear Inverse Problem Solving: A Filtering Perspective"
    },
    {
        "review": {
            "id": "lCXVGHsIZH",
            "forum": "tplXNcHZs1",
            "replyto": "tplXNcHZs1",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission547/Reviewer_cbzu"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission547/Reviewer_cbzu"
            ],
            "content": {
                "summary": {
                    "value": "This paper provides a link between Bayesian posterior sampling and Bayesian filtering in diffusion models for linear inverse problems. In general, exact posterior sampling is intractable. To overcome this difficulty, this paper introduces a diffusion process to the measurement vector and incorporates the information of the measurement by Bayesian filtering methods in the backward process.  In the ideal case, the exactness of the proposed method is theoretically guaranteed, which is realized by the sequential Monte Carlo method using infinitely many particles. Numerical experiments show that the performance of the method is as good as those of the SOTA methods."
                },
                "soundness": {
                    "value": "4 excellent"
                },
                "presentation": {
                    "value": "4 excellent"
                },
                "contribution": {
                    "value": "4 excellent"
                },
                "strengths": {
                    "value": "This article provides an important perspective that has been missing until now for the linear inverse problem using diffusion models. The proposed method is reasonable in the Bayesian framework, and achieves as good performance as the current SOTA methods."
                },
                "weaknesses": {
                    "value": "Extendability to nonlinear measurement cases is not clear. FPS-SMC, which uses multiple particles, requires considerably heavy computational cost."
                },
                "questions": {
                    "value": "It is possible to extend the proposed method for nonlinear measurement cases?"
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "10: strong accept, should be highlighted at the conference"
                },
                "confidence": {
                    "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
                },
                "code_of_conduct": {
                    "value": "Yes"
                },
                "first_time_reviewer": {
                    "value": "Yes",
                    "readers": [
                        "ICLR.cc/2024/Conference/Program_Chairs",
                        "ICLR.cc/2024/Conference/Submission547/Senior_Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission547/Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission547/Reviewer_cbzu"
                    ]
                }
            },
            "number": 1,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission547/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698455661531,
            "cdate": 1698455661531,
            "tmdate": 1699635982066,
            "mdate": 1699635982066,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "TCt6s7HIjy",
                "forum": "tplXNcHZs1",
                "replyto": "lCXVGHsIZH",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission547/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission547/Authors"
                ],
                "content": {
                    "comment": {
                        "value": "We really appreciate your positive feedback. Please find our response to your questions in 'general questions proposed by reviewers'."
                    }
                },
                "number": 5,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission547/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700708809042,
                "cdate": 1700708809042,
                "tmdate": 1700708809042,
                "mdate": 1700708809042,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "4qbWupP65C",
            "forum": "tplXNcHZs1",
            "replyto": "tplXNcHZs1",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission547/Reviewer_pD39"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission547/Reviewer_pD39"
            ],
            "content": {
                "summary": {
                    "value": "This paper proposed a filtering perspective on the linear inverse problem with diffusion models, which yields a novel FPS algorithm. Moreover, this paper gave a theoretical proof that that the FPS algorithm correctly samples from the Bayesian posterior\ndistribution as the number of particles approaches infinity."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "3 good"
                },
                "strengths": {
                    "value": "1. A novel filtering perspective on solving linear inverse problems using diffusion models, which is interesting and inspiring.\n2. A theoretical proof is given that the FPS algorithm can correctly sample from the Bayesian posterior\ndistribution as the number of particles approaches infinity."
                },
                "weaknesses": {
                    "value": "1. Compared to previous methods like DPS (in fact, currently, DPS is no longer the SOTA), the improvement seems marginal in some cases, and even worse in some cases like inpainting. From my understanding, inpainting is among the most challenging tasks for linear image restoration tasks and the inferiority of FPS might suggest some underlying unaddressed problem for this proposed method.\n\n2. There is a lack of complexity or running time analysis. How fast is FPS compared with other methods? How does the time increase with a different number of particles M?"
                },
                "questions": {
                    "value": "1. How did you add noise with standard deviation \\sigma= 0.05? Did you account for the scaling of [-1, 1] so that the actual standard deviation added is 2 * \\sigma=  0.05*2 = 1, as did in DDRM? The code is not provided so that I cannot check this point."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "5: marginally below the acceptance threshold"
                },
                "confidence": {
                    "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 2,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission547/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698809474115,
            "cdate": 1698809474115,
            "tmdate": 1699635982007,
            "mdate": 1699635982007,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "1lpeGiTmgC",
                "forum": "tplXNcHZs1",
                "replyto": "4qbWupP65C",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission547/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission547/Authors"
                ],
                "content": {
                    "comment": {
                        "value": "Thank you for taking the time to review our work. Please find our response to your questions on running time analysis and the code release in 'general questions proposed by reviewers'. We address the other questions below.\n\nQ1: Compared to previous methods like DPS (in fact, currently, DPS is no longer the SOTA), the improvement seems marginal in some cases, and even worse in some cases like inpainting. From my understanding, inpainting is among the most challenging tasks for linear image restoration tasks and the inferiority of FPS might suggest some underlying unaddressed problem for this proposed method.\n\nA: We agree with the reviewer that the improvement is marginal in some cases, but would like to argue that the improvement is significant for most tasks we consider. Note that even for the inpainting task, our methods perform better on FFHQ (random inpainting) in PSNR, which is the classical metric in inverse problem solving. We believe the value of our approach is not just empirical performance, but also its strong theoretical guarantee, which is the first of its kind.\n\nQ2: How did you add noise with standard deviation $\\sigma= 0.05$? Did you account for the scaling of $[-1, 1]$ so that the actual standard deviation added is $2 * \\sigma= 0.05*2 = 0.1$, as did in DDRM? \n\nA: Yes, we follow DDRM to process our images and add noise. We will release our code upon publication."
                    }
                },
                "number": 7,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission547/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700709058138,
                "cdate": 1700709058138,
                "tmdate": 1700709058138,
                "mdate": 1700709058138,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "EYjtwh3asq",
            "forum": "tplXNcHZs1",
            "replyto": "tplXNcHZs1",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission547/Reviewer_x48M"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission547/Reviewer_x48M"
            ],
            "content": {
                "summary": {
                    "value": "This work introduces an efficient, asymptotically accurate diffusion sampling algorithm for linear inverse problems, linking Bayesian posterior sampling to Bayesian filtering in diffusion models, using sequential Monte Carlo methods for filtering, requiring no model re-training, and outperforming or matching existing methods in tasks like image inpainting, super-resolution, and motion deblur."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "3 good"
                },
                "strengths": {
                    "value": "Solving inverse problems is a fundamental problem in machine learning and other fields. Diffusion models have a good potential to solve those problems, and it is a good attempts to provide a solution based on the filtering perspective."
                },
                "weaknesses": {
                    "value": "The literature review for diffusion-based inverse problems are quite limited. It would be very important to compare with previous work to demonstrate the advantage and necessity of the new algorithm.\n\nThe scale of empirical experiments are relatively small."
                },
                "questions": {
                    "value": "Is there a running time or NFE evaluation for the algorithm? \n\nAlthough the algorithm is designed to solve linear inverse problems, does it work on non-linear ones, which may happen in real practice? For DPS, they have shown the possibilities to solve nonlinear problems."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "6: marginally above the acceptance threshold"
                },
                "confidence": {
                    "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 3,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission547/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698822259490,
            "cdate": 1698822259490,
            "tmdate": 1699635981924,
            "mdate": 1699635981924,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "2FccgcqrZe",
                "forum": "tplXNcHZs1",
                "replyto": "EYjtwh3asq",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission547/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission547/Authors"
                ],
                "content": {
                    "comment": {
                        "value": "Thank you for taking the time to review our work. Please find our response to your questions in 'general questions proposed by reviewers'. In addition, we address the following question.\n\nQ1: The scale of our empirical experiments is relatively small. \n\nA: We have limited access to a single A100 GPU which strongly restricts the scale of our experiments. That said, we have carried out experiments to solve five different linear inverse problems for both FFHQ and ImageNet, which matches the setup in many existing papers on the same topic."
                    }
                },
                "number": 6,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission547/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700708939160,
                "cdate": 1700708939160,
                "tmdate": 1700708939160,
                "mdate": 1700708939160,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "riOqUBGekQ",
            "forum": "tplXNcHZs1",
            "replyto": "tplXNcHZs1",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission547/Reviewer_b9JP"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission547/Reviewer_b9JP"
            ],
            "content": {
                "summary": {
                    "value": "This paper presents an SMC algorithm for sampling from the posterior of an inverse problem where the prior distribution distribution is a diffusion model, which is a natural way of sampling from the posterior of the diffusion model, due to the sequential structure of the sampling procedure. The resulting procedure does not require any additional training and, as claimed by the authors, samples from the posterior in the limit of infinite particles."
                },
                "soundness": {
                    "value": "1 poor"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "2 fair"
                },
                "strengths": {
                    "value": "- The proposed method provides impressive results on inpainting tasks. Interestingly, other methods for inpainting with a diffusion prior often suffer from inconsistencies at the the borders of the patch. This is not the case of this method."
                },
                "weaknesses": {
                    "value": "- I believe that method proposed in the paper is technically flawed. In the section 3 of the main paper, the authors give the state space model that they consider where notably, the use the same noise at step $k$ for both the observation and the state. They then proceed to claim that it holds that $p(x_0 | y_0) = \\int p(x_0 | y_{0:N}) p(y_{1:N} | y_0) \\mathrm{d}y_{1:N}$ and thus, to sample from $p(x_0 | y_0)$ it is enough to sample $p(y_{1:N} | y_0)$ and then sample from $p(x_0 | y_{0:n})$ using an SMC algorithm. However, this is not correct since $p(x_0 | y_{0:N}) = p(x_0 | y_0)$ for the state model that they consider. To show that this is the case, consider the case $N=1$. Then, the joint distribution of the SSM they consider is the following, since they share the noise: \n$$\np(y_{0:1}, x_{0:1}) = p(y_0 | x_0) p(x_0) \\int p(\\mathrm{d} z) \\delta_{a_1 x_0 + b_1 z} (x_1)   \\delta_{a_1 y_0 + b_1 A z} (y_1)\n$$\nand thus, \n$$\np(x_0 | y_{0:1}) = \\frac{\\int p(y_{0:1}, x_{0:1}) \\mathrm{d} x_{1}}{\\int p(y_{0:1}, x_{0:1}) \\mathrm{d} x_{1} \\mathrm{d} x_0} = \\frac{p(y_0 |\u00a0x_0) p(x_0) p(y_1 | y_0)}{\\int p(y_0 |\u00a0x_0) p(x_0) p(y_1 | y_0) \\mathrm{d} x_0} = p(x_0 | y_0)\n$$\nBesides this fact, the methodology developed in the rest of the paper does not in fact sample from the correct posterior asymptotically. To see why this is the case, note that the state space model on which the authors apply SMC is the following: \n$$ \np_\\theta(x_{0:N}, y_{0:N}) = p_N(y_N | x_N) p_N(x_N) \\prod_{s = 0}^{N-1} p_\\theta(x_s | x_{s+1}) p(y_s | x_s) \n$$ \nIt is straightforward to see that the p_\\theta(x_0\u00a0| y_0) resulting from this model is **not** the target posterior $p^*(x_0 | y_0) \\propto p(y_0 | x_0) p_\\theta(x_0)$.  \n\n- The idea of using the same noise for the forward process and the observations is not new and is used in [1], which the authors cite but they fail to mention that they use the same idea. The authors also fail to mention author work on SMC applied to diffusion posterior sampling [2]. In fact in this paper the authors use a specific decomposition of the posterior, similar to what is claimed in the text box at the end of the section 3 of this paper. In contrast, their decomposition is theoretically justified but holds under stringent assumptions on the backward process, further confirming that what is claimed in this paper is not true. \n\n- Finally, this paper is not the first one to develop a consistent diffusion posterior sampling algorithm, see [3] and [4] which develop **principled** SMC algorithms for asympotitcally exact posterior sampling. This is not a criticism, as these papers have been released 3/4 months ago and I understand that the authors may not have had knowledge of them. \n\n\n[1] Song, Yang, et al. \"Solving inverse problems in medical imaging with score-based generative models.\" arXiv preprint arXiv:2111.08005 (2021).\n\n[2] Trippe, Brian L., et al. \"Diffusion probabilistic modeling of protein backbones in 3d for the motif-scaffolding problem.\" arXiv preprint arXiv:2206.04119 (2022).\n\n[3]\u00a0Wu, Luhuan, et al. \"Practical and asymptotically exact conditional sampling in diffusion models.\" arXiv preprint arXiv:2306.17775 (2023).\n\n[4] Cardoso, Gabriel, et al. \"Monte Carlo guided Diffusion for Bayesian linear inverse problems.\" arXiv preprint arXiv:2308.07983 (2023)."
                },
                "questions": {
                    "value": "i have no further questions"
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "3: reject, not good enough"
                },
                "confidence": {
                    "value": "5: You are absolutely certain about your assessment. You are very familiar with the related work and checked the math/other details carefully."
                },
                "code_of_conduct": {
                    "value": "Yes"
                },
                "first_time_reviewer": {
                    "value": "Yes",
                    "readers": [
                        "ICLR.cc/2024/Conference/Program_Chairs",
                        "ICLR.cc/2024/Conference/Submission547/Senior_Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission547/Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission547/Reviewer_b9JP"
                    ]
                }
            },
            "number": 4,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission547/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1699127643139,
            "cdate": 1699127643139,
            "tmdate": 1699635981852,
            "mdate": 1699635981852,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "2udxQKEMNT",
                "forum": "tplXNcHZs1",
                "replyto": "riOqUBGekQ",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission547/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission547/Authors"
                ],
                "content": {
                    "comment": {
                        "value": "Thank you so much for your thoughtful feedback. For literature review, please find our response in `general questions proposed by reviewers'. For the other question, we answer it below.\n\nQ1: The method proposed in this paper is technically flawed. \n\nA: There are in fact two state space models (SSM) in our method. The first SSM is given by the forward perturbation process where $\\{x_k\\}$ and $\\{y_k\\}$ share the same noise in each time step, so that $q(y_k \\mid x_k) = \\mathcal N(0, c_k^2 \\sigma^2  I)$ holds for each $k$. In this forward graphical model, the following equation as pointed out by the reviewer is correct:\n\n$$q(x_0\\mid y_{0:N}) = q(x_0 \\mid y_0).$$\n\nIn fact, this equation is correct even without 'noise sharing', because $x_0$ and $(y_k),k\\geq 1$ are conditionally independent given $y_0$. We leverage this forward SSM to generate the $(y_k), 0\\leq k\\leq n$ sequence, after which we ignore the generated $(x_k),0\\leq k\\leq N$ and start the backward Bayesian filtering process based on $(y_k),0\\leq k\\leq N$. This assumes the forward and backward SSMs define the same joint distribution, which is valid when the diffusion model is optimal and no discretization errors exist.\n\nThe second SSM is derived from the backward diffusion process. As the reviewer correctly noticed, it takes the form below:\n\n$$p_\\theta(x_{0:N}, y_{0:N}) = p_N(x_N)p_N(y_N\\mid x_N)\\cdot \\prod_{k=0}^{N-1} p_\\theta(x_k \\mid x_{k+1}) p(y_k\\mid x_k)$$\n\nwhere $p_{\\theta}(x_k \\mid x_{k+1})$ can be obtained by running the SDE solver for one step. By using Bayesian filtering and Sequential Monte Carlo (SMC), we sample particles $x_k \\sim p_\\theta(x_k \\mid y_{k:N})$ for $k=N,N-1,\\ldots, 0$. Proposition 4.1 in our paper shows that, when we have perfect score estimator and accurate backward SDE solvers (without discretization error), these two SSMs will be equivalent. When particle size $M\\rightarrow\\infty$, we sample from the correct posterior distribution $p_\\theta(x_0\\mid y_{0:N}) \\rightarrow q(x_0 \\mid y_{0:N})$. Here, we denote $q$ as the distribution of the forward process and $p_\\theta$ as the distribution of the backward process (SSM), just like the notations in our revision. Note the assumptions we required here are very similar to [3], which means that the contradiction proposed by the reviewer is not true.\n\n[3] Brian L Trippe, Jason Yim, Doug Tischer, David Baker, Tamara Broderick, Regina Barzilay, and Tommi Jaakkola. Diffusion probabilistic modeling of protein backbones in 3d for the motif-scaffolding problem. arXiv preprint arXiv:2206.04119, 2022."
                    }
                },
                "number": 8,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission547/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700709906987,
                "cdate": 1700709906987,
                "tmdate": 1700709906987,
                "mdate": 1700709906987,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "2gicBgQ9w1",
                "forum": "tplXNcHZs1",
                "replyto": "2udxQKEMNT",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission547/Reviewer_b9JP"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission547/Reviewer_b9JP"
                ],
                "content": {
                    "comment": {
                        "value": "Thank your for your response. When I posted my initial review there was no mention of this assumption in the main paper. I believe that this assumption, which is far from true in practice,  is not needed to construct a consistent sampling procedure, as is done in [3] and [4]. I maintain my score."
                    }
                },
                "number": 9,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission547/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700731334175,
                "cdate": 1700731334175,
                "tmdate": 1700731334175,
                "mdate": 1700731334175,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    }
]