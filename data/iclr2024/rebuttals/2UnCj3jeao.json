[
    {
        "title": "Unbalancedness in Neural Monge Maps Improves Unpaired Domain Translation"
    },
    {
        "review": {
            "id": "cz449P3cBZ",
            "forum": "2UnCj3jeao",
            "replyto": "2UnCj3jeao",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission7863/Reviewer_1iBx"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission7863/Reviewer_1iBx"
            ],
            "content": {
                "summary": {
                    "value": "This paper proposes a general framework for incorporating unbalancedness into any Monge map estimator. This paper shows that the unbalanced Monge map corresponds to the Monge map (from OT) between the reweighted source and target distributions. The proposed framework is to introduce existing Monge map estimator into these reweighted distributions. These reweighted distributions are estimated through the minibatch UOT estimator."
                },
                "soundness": {
                    "value": "2 fair"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "2 fair"
                },
                "strengths": {
                    "value": "-\tThis work is overall well-written.\n-\tThis paper proposes a general framework for extending existing OT Monge maps estimators into unbalanced cases.\n-\tThis paper shows that the introduction of unbalancedness improves the performance of existing OT Monge map estimators in unpaired domain translation tasks."
                },
                "weaknesses": {
                    "value": "-\t**W1.** The main Prop 3.1-1, which provides the justification for the proposed general framework, was proved in [1] (The proof is different).\n-\t**W2.** The performance is only compared with the OT-counterpart and not with other UOT Monge maps estimators."
                },
                "questions": {
                    "value": "-\t**Q1.** What is the definition of $\\tau$ in Prop 3.1? Is it the same $\\tau$ in Appendix B?\n-\t**Q2.** What is the reason for better performance of UOT compared to OT? This paper suggest that this improvement is primarily attributed to the discrepancy in the number of samples for each corresponding cluster, e.g. $8 \\leftrightarrow B$ in Fig 1. If the number of samples were similar, would the performance of UOT be comparable to OT?\n-\t**Q3.** The proposed framework is to optimize the OT Monge map on the estimated reweighted distribution. How does the performance of the proposed framework change according to the minibatch UOT coupling estimates, such as minibatch size and $\\epsilon$ of entropic regularization, in terms of quantitative results?\n- **Typo**  $\\phi^{\\*} (x) d \\mu (x) \\rightarrow \\phi^{\\*}(y) d \\nu (y)$ in Eq (2)\n\n**Reference**\n\n[1] Choi, Jaemoo, Jaewoong Choi, and Myungjoo Kang. \"Generative Modeling through the Semi-dual Formulation of Unbalanced Optimal Transport.\" arXiv preprint arXiv:2305.14777 (2023)."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "6: marginally above the acceptance threshold"
                },
                "confidence": {
                    "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                },
                "first_time_reviewer": {
                    "value": "Yes",
                    "readers": [
                        "ICLR.cc/2024/Conference/Program_Chairs",
                        "ICLR.cc/2024/Conference/Submission7863/Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission7863/Reviewer_1iBx",
                        "ICLR.cc/2024/Conference/Submission7863/Senior_Area_Chairs"
                    ]
                }
            },
            "number": 1,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission7863/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698234261210,
            "cdate": 1698234261210,
            "tmdate": 1700374269609,
            "mdate": 1700374269609,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "i1VYfW4mYR",
                "forum": "2UnCj3jeao",
                "replyto": "cz449P3cBZ",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission7863/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission7863/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Response to Review 1/2"
                    },
                    "comment": {
                        "value": "> ***The main Prop 3.1-1, which provides the justification for the proposed general framework, was proved in [1] (The proof is different).***\n\n\u27a4 Thanks for pointing out the similarities to the concurrent work [Choi+'2023]. However, while we agree that these results appear to be related we respectfully disagree that Point 1 of our Prop 3.1 was proved in [Choi+'2023]. To highlight that point, we analyze their theory. Since [Choi+'2023, Theorem 3.4] presents a bound on the dual sub-optimality gap, hence dealing with aspects not covered in our paper, it seems that the reviewer mentions [Choi+'2023, Theorem 3.3]. For this reason, we focus on the latter Theorem. In the following, we want to lay out the differences between our and their results.\n\n- [**Choi+'2023]'s theory is developed under stronger assumptions** than ours, which are given in the first paragraph of [Choi+'2023, Appendix A].  On the one hand, they assume the cost to be the squared Euclidean distance $c(\\mathbf{x}, \\mathbf{y}) = \\tfrac{\\tau}{2}\\|\\mathbf{x} - \\mathbf{y}\\|_2^2$ $(\\tau > 0)$, while our results hold for any costs $c(\\mathbf{x}, \\mathbf{y}) = h(\\mathbf{x} - \\mathbf{y})$ with $h$ strictly convex. We hence recover the squared Euclidean distance with $h = \\tfrac{\\tau}{2} \\|\\cdot\\|_2^2$. On the other hand, they assume that $\\mu, \\nu \\in \\mathcal{M}_1^+(\\Omega)$ are probability measures of same total mass 1, while our results hold for any positive measures $\\mu, \\nu \\in \\mathcal{M}^+(\\Omega)$ of arbitrary total mass, that might be different. \n\n- **We then clarify the correspondence between our and theirs notations.** They denote $(v^{\\star, c}, v^{\\star})$ the optimal potentials solving the Unbalanced Kantorovich Dual Problem (UDKP), whereas we denote them by $(f^\\star, g^\\star)$. Furthermore, they denote $\\Psi$ the entropy function associated to the divergence used to measure the deviation from the marginals, whereas we denote it $\\phi$. Finally, in the same way as us, they note $\\tilde{\\mu} = \\bar{\\phi}(-f^\\star)\\cdot\\mu$ and $\\tilde{\\nu} = \\bar{\\phi}(-g^\\star)\\cdot\\mu$.\n\n- **We now highlight that point 1 of Prop 3.1 is not shown in [Choi+'2023].** Indeed, [Choi+'2023, Theorem 3.3] proves that if we let $T^\\star$ be the Monge map between $\\tilde{\\mu}$ and $\\tilde{\\nu}$, which exists because of the assumptions on the costs and the fact that $\\tilde{\\mu} \\ll \\mu \\ll \\mathcal{L}_d $, then one has:\n\n$$\n\\forall \\mathbf{x} \\in \\mathcal{X}, \\textrm{  } T(\\mathbf{x}) \\in \\arg \\inf_{\\mathbf{y} \\in \\mathcal{Y}} c(\\mathbf{x}, \\mathbf{y}) - g^\\star(\\mathbf{y}) \n$$\n\nHowever, they do not show that $\\pi_\\mathrm{UOT}$, the unbalanced UOT plan  between $\\mu$ and $\\nu$, is supported on the graph of that map, i.e.  $\\pi_\\mathrm{UOT} = (\\mathrm{Id}, T^\\star)\\sharp\\tilde{\\mu}$ . Therefore, their statement do not show that $p_1 \\sharp \\pi_\\mathrm{UOT} = \\tilde{\\mu}$ and $p_2 \\sharp \\pi_\\mathrm{UOT} = \\tilde{\\nu}$, i.e. that $\\pi_\\mathrm{UOT}$  has marginals $\\tilde{\\mu}$ and $\\tilde{\\nu}$, which is the result stated in Point 1 of our Prop. 3.1. Moreover, in their proof, we don't understand how they obtain that $\\tilde{\\mu}$ and $\\tilde{\\nu}$ have the same total mass, which must be justified before considering the Monge map $T^\\star$ between $\\tilde{\\mu}$ and $\\tilde{\\nu}$. In our proof, we obtain it by showing that $\\tilde{\\mu}$ and $\\tilde{\\nu}$ are the marginals of $\\pi_\\mathrm{UOT}$, so the equality of masses follows from Fubini's Theorem.\n\n- **Proposition 3.1 (Point 1 and 2) is in fact a more general version of their [Choi+'2023, Theorem 3.3].** Indeed, for all costs $c(\\mathbf{x}, \\mathbf{y}) = h(\\mathbf{x} - \\mathbf{y})$, we show that\n\n$$\n\\forall \\mathbf{x} \\in \\mathcal{X}, \\textrm{  } T^\\star(\\mathbf{x}) = \\mathrm{Id} - \\nabla h^\\star \\circ \\nabla f^\\star(\\mathbf{x})\n$$\n\nand that $\\pi_\\mathrm{UOT}$ is unique, and characterized by $\\pi_\\mathrm{UOT} = (\\mathrm{Id}, T^\\star)\\sharp\\tilde{\\mu}$. This result then allow us to extend their result for $c(\\mathbf{x}, \\mathbf{y}) = \\tfrac{\\tau}{2} \\|\\mathbf{x} - \\mathbf{y}\\|_2^2$. As we mentioned in Remark. 3.2, in this case:\n\n$$\nT^\\star(x) = \\mathbf{x} - \\nabla f^\\star(\\mathbf{x}) = \\nabla \\varphi^\\star(\\mathbf{x})\n$$\n\nwhere $\\varphi^\\star : \\mathbf{x} \\mapsto \\|\\mathbf{x}\\|_2^2 - f^\\star(\\mathbf{x})$ is convex and unique. We then obtain an unbalanced generalization of [Brenier'1987]'s Theorem, stating that as in the balanced OT case, when the source measure is a density, the unbalanced OT plan is unique supported on the graph of a convex function.\n\nWe would be happy to answer any questions that might arise and clarify if some arguments were not clear."
                    }
                },
                "number": 4,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission7863/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700160763397,
                "cdate": 1700160763397,
                "tmdate": 1700221941742,
                "mdate": 1700221941742,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "PL1JuicfL0",
                "forum": "2UnCj3jeao",
                "replyto": "N0kgJRGrzK",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission7863/Reviewer_1iBx"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission7863/Reviewer_1iBx"
                ],
                "content": {
                    "comment": {
                        "value": "Thank you for the response. The clarification of theoretical contribution and the additional experimental results (Appendix C.4 and Table 5) have been helpful in addressing my concerns, (although CIFAR-10 generation results are not that impressive). Hence, I raised my rating to 6."
                    }
                },
                "number": 8,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission7863/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700374247470,
                "cdate": 1700374247470,
                "tmdate": 1700374247470,
                "mdate": 1700374247470,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "1VzTFFqyWn",
            "forum": "2UnCj3jeao",
            "replyto": "2UnCj3jeao",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission7863/Reviewer_Rczx"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission7863/Reviewer_Rczx"
            ],
            "content": {
                "summary": {
                    "value": "This paper studies the methodological aspect of optimal transport (OT) under the practical application scenarios for domain translation, e.g., the mass proportion is imbalanced for different domains. The main pursuit is to approximately estimate the dual OT distance via the neural networks with significant capacity and provide an explicit retrieval form for the OT plan/map. To overcome the limitation in marginal distribution conservation, this paper introduces unbalanced OT to obtain a relaxed plan and then recovers the balanced OT from a reweighting view. Theoretical results are provided to connect the re-weighted OT and UOT and ensure the feasibility of recovering the Monge map from neural UOT. Experiments are conducted from several perspectives, which validates the effectiveness of the proposed method."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "3 good"
                },
                "strengths": {
                    "value": "+ This paper is well-written and easy to follow; necessary justifications and discussions are provided around the technical parts.\n+ The proposed method is well-motivated and reasonable; the main difficulty stated in introduction is properly addressed with the proposed method and theoretical analysis.\n+ Diverse experiments are conducted to validate the proposed method from different perspectives and tasks, where the results are generally convincible."
                },
                "weaknesses": {
                    "value": "- Some related concepts and fields are omitted, which should also be discussed appropriately.\n- The limitations of the proposed method should be discussed.\n- The experiments can be enhanced by considering more practical and challenging problems."
                },
                "questions": {
                    "value": "1. As far as I understand this paper, the basic goal is to address the potential mismatch induced by the imbalanced weights of different domains; more precisely, the imbalance means the mass proportion of the ideal transport pairs is different. Such a scenario is also analogous to the label shift problem, which is usually considered in OT methodology. To address this problem, there are two natural and common solutions: relaxation (i.e., UOT) or reweighting (i.e., adjusting the marginal distribution) [r1, r2]. Since this work adopts relaxation as a solution (while also noting that the idea of reweighting is also implicitly shown in Sec. 3.1), I think more justification and discussion on the related fields are highly expected.\n\n2. Based on the reweighting solution mentioned above, can the imbalanced mass problem be addressed by detecting the degree of shifting mass (i.e., estimating the weights in Sec. 3.1) and solving the reweighting (balanced) OT? If it is feasible, what will be the advantages and weaknesses of the proposed methods?\n\n3. As the basic problem is similar to label shift, the experiments on related problems are highly appreciated. For example, the generalized label shift scenario [r1] and partial domain adaptation [r2] (which can be taken as an extreme scenario for label shift), where the comparison methods for corresponding tasks should also be carefully considered.\n\n4. Minor points:\n\n4.1) Page 3, typo in the reweighting formulation of $\\tilde{\\nu}$ in Sec. 3.1.\n\n4.2) Point 2 in Prop. 3.1, the definition of $\\mathcal{L}_d$ is not provided.\n\n[r1] Rakotomamonjy, Alain, et al. \"Optimal transport for conditional domain matching and label shift.\" Machine Learning (2022): 1-20.\n\n[r2] Gu, Xiang, et al. \"Adversarial reweighting for partial domain adaptation.\" Advances in Neural Information Processing Systems 34 (2021): 14860-14872."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "6: marginally above the acceptance threshold"
                },
                "confidence": {
                    "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 2,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission7863/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698296182089,
            "cdate": 1698296182089,
            "tmdate": 1699636964008,
            "mdate": 1699636964008,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "z5n0Ob4Ndx",
                "forum": "2UnCj3jeao",
                "replyto": "1VzTFFqyWn",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission7863/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission7863/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Response to Review 1/2"
                    },
                    "comment": {
                        "value": "> ***Some related concepts and fields are omitted, which should also be discussed appropriately.***\n\n\u27a4 As far as we understand, this comment is mainly about the field of domain **adaptation**. We first give definitions domain of  **adaptation** and **translation**, which the remaining response builds upon, and would like to ask the reviewer for confirmation:\n- Domain **adaptation** is concerned with learning domain-invariant representations or transformations to train robust **classification** models that can generalize across domains.\n- Domain **translation**, on the other hand, concentrates on training a **generative** map to translate the source domain data into the style and distribution of the target domain, e.g. inspired by reducing the total cost incurred by this translation. The goal of domain translation is to learn the mapping between domains rather than performing a prediction task.\n\nHow to leverage UOT in the domain **adaptation** task is thoroughly discussed in [Fartras+'2021], which we also refer to as an application of UOT in Section 1 (\"The practical significance of unbalancedness in discrete OT has been demonstrated in various applications, e.g. in video registration (Lee et al., 2020), computer vision (Plaen et al., 2023), or domain adaptation (Fatras et al., 2021)\"). However, our work is concerned with learning Monge maps for domain **translation**, and hence our framework is not directly applicable to domain **adaptation**. For domain **translation**, we believe we cover all important concepts and related fields.\n\n> ***The limitations of the proposed method should be discussed.***\n\n\u27a4 As mentioned in the general comment, we now discuss these in Appendix B.3 .\n\n> ***The experiments can be enhanced by considering more practical and challenging problems.***\n\n\u27a4 As mentioned in the general comment, we have added another real-world application in a different perturbation task on the single-cell data measured in [Srivatsan 2020] as well as a benchmark on CIFAR-10 image generation. What more challenging datasets would you be interested in seeing?\n\n> ***As far as I understand this paper, the basic goal is to address the potential mismatch induced by the imbalanced weights of different domains; more precisely, the imbalance means the mass proportion of the ideal transport pairs is different. Such a scenario is also analogous to the label shift problem, which is usually considered in OT methodology. To address this problem, there are two natural and common solutions: relaxation (i.e., UOT) or reweighting (i.e., adjusting the marginal distribution) [r1, r2]. Since this work adopts relaxation as a solution (while also noting that the idea of reweighting is also implicitly shown in Sec. 3.1), I think more justification and discussion on the related fields are highly expected.***\n\n\u27a4 In the following, we reply to the question in three parts. For the first part of the question regarding imbalanced weights of different domains (in the following referred to as label imbalance), we assume we have access to labeled data. We agree that unbalancedness helps to mitigate class imbalances, as demonstrated in multiple examples, e.g. in the EMNIST experiments. Yet, we would like to highlight that unbalancedness acts on batches, and hence there does not have to be a label imbalance on the full dataset for unbalancedness to have a positive effect, as within one batch, the label distribution might not reflect the label distribution of the full dataset. Moreover, we would like to highlight that unbalancedness is not only able to adapt label imbalances but also automatically discard outliers. \n\nFor the second part of the question, we fully agree that rescaling the marginal distribution is an option to address class imbalance. Yet, this assumes access to labels. In many real-world scenarios, data is not labeled, or the quality of the labels is insufficient. An example of the latter is cell-type labeling in single-cell genomics, which clusters cells into disjoint classes. In fact, cells are known to evolve continuously between clusters. With respect to image labels, the labels considered in the CelebA experiments (e.g. glasses vs. no glasses) might be clear. In contrast, labels for hair color might be less obvious, and hence reweighting the distribution accordingly is difficult."
                    }
                },
                "number": 5,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission7863/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700160785338,
                "cdate": 1700160785338,
                "tmdate": 1700174598414,
                "mdate": 1700174598414,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "dyzlGM41Fz",
                "forum": "2UnCj3jeao",
                "replyto": "1VzTFFqyWn",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission7863/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission7863/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Response to Review 2/2"
                    },
                    "comment": {
                        "value": "> ***Based on the reweighting solution mentioned above, can the imbalanced mass problem be addressed by detecting the degree of shifting mass (i.e., estimating the weights in Sec. 3.1) and solving the reweighting (balanced) OT? If it is feasible, what will be the advantages and weaknesses of the proposed methods?***\n\n\u27a4 As discussed in more detail above, there are three limitations to this approach: First, there might not be sufficient information to rescale the marginals (e.g. due to poor or non-existent labels). Second, unbalancedness also compensates for imbalances within one batch, which is also likely to happen in class balance on the full dataset. Third, outliers cannot be automatically discarded in this way. An advantage would be the independence of the unbalancedness parameters, which, as discussed, is not necessarily straightforward.\n\n> ***As the basic problem is similar to label shift, the experiments on related problems are highly appreciated. For example, the generalized label shift scenario [r1] and partial domain adaptation [r2] (which can be taken as an extreme scenario for label shift), where the comparison methods for corresponding tasks should also be carefully considered.***\n\n\u27a4 As mentioned above, (unbalanced) neural Monge maps in general cannot be applied to the domain adaptation task straight-forwardly.\n\n> ***Point 2 in Prop. 3.1, the definition of $\\mathcal{L}_d$ is not provided.***\n\n\u27a4 We define $\\mu \\ll \\mathcal{L}_d$ at the start of Section 2 as $\\mu$ absolutely continuous w.r.t. the Lebesgue measure.\n\n***\n[Srivatsan+'2020] Srivatsan, Sanjay R., et al. \"Massively multiplex chemical transcriptomics at single-cell resolution.\" Science 367.6473 (2020): 45-51.\n\n[Fartras+'2021] Kilian Fatras, Thibault S\\'ejourn\\'e, Nicolas Courty, and R\\'emi Flamary. \"Unbalanced minibatch optimal\ntransport; applications to domain adaptation\" (2021)."
                    }
                },
                "number": 6,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission7863/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700160993938,
                "cdate": 1700160993938,
                "tmdate": 1700174625968,
                "mdate": 1700174625968,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "Mpf4bGClPY",
                "forum": "2UnCj3jeao",
                "replyto": "dyzlGM41Fz",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission7863/Reviewer_Rczx"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission7863/Reviewer_Rczx"
                ],
                "content": {
                    "title": {
                        "value": "Thank you for your responses."
                    },
                    "comment": {
                        "value": "I appreciate the authors for their detailed responses to the concerns. After checking the rebuttal and revised manuscript, the major concerns are addressed. Overall, this paper is well-written and easy to follow, where motivation and insights are also clearly presented. Therefore, I keep my positive score for acceptance."
                    }
                },
                "number": 9,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission7863/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700573181305,
                "cdate": 1700573181305,
                "tmdate": 1700573181305,
                "mdate": 1700573181305,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "mqkcakyZ5y",
            "forum": "2UnCj3jeao",
            "replyto": "2UnCj3jeao",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission7863/Reviewer_qjsW"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission7863/Reviewer_qjsW"
            ],
            "content": {
                "summary": {
                    "value": "The paper explores the role of introducing unbalancedness into neural Monge maps within the framework of optimal transport (OT). The authors investigate whether this unbalancedness can enhance the performance of unpaired domain translation tasks. Through a mix of theoretical analysis and empirical validation, the paper shows that incorporating unbalancedness leads to significant improvements in terms of cost-efficiency and generalization across domains.\n\nContributions:\n\nA modified OT framework that accommodates unbalancedness.\nNew neural estimators designed for unbalanced Monge maps.\nEmpirical evidence demonstrating the advantages of the modified approach in real-world applications like single-cell biology and computer vision.\nThe paper thus offers a novel approach to improving unpaired domain translation by tweaking the conventional OT framework and validating its effectiveness"
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "3 good"
                },
                "strengths": {
                    "value": "- Novelty: The paper introduces the novel concept of \"unbalancedness\" into neural Monge maps, which is a fresh angle in the well-studied field of optimal transport.\n- Theoretical and Empirical Validation: The work combines both theoretical reasoning and empirical results, strengthening the validity of its claims.\n- Practical Impact: The paper demonstrates the utility of its approach in real-world applications, such as single-cell biology and computer vision, indicating its relevance beyond theoretical considerations.\n- Methodological Rigor: The research methodology appears to be sound, involving both the development of a new framework and neural estimators, as well as their validation on synthetic and real-world data.\n- Broad Applicability: The issue of unpaired domain translation is relevant in multiple fields, and the paper's contributions could be generalized to other domains, increasing its impact."
                },
                "weaknesses": {
                    "value": "- Lack of External Benchmarks: Without a comparison to existing methods or frameworks, it's difficult to assess how much of an improvement the proposed approach offers.\n- Complexity: Introducing unbalancedness into neural Monge maps could add computational or conceptual complexity, which may not be fully addressed in the paper.\n- Dependency on Empirical Validation: While the paper does include empirical validation, its contributions could be further strengthened with more diverse datasets or a broader set of real-world applications."
                },
                "questions": {
                    "value": "What are the limitations of introducing unbalancedness into Monge maps, and are there scenarios where this approach may not be beneficial?\n\nHow does the proposed unbalanced neural Monge map approach compare with existing methods in terms of efficiency and accuracy?"
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "6: marginally above the acceptance threshold"
                },
                "confidence": {
                    "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                },
                "first_time_reviewer": {
                    "value": "Yes",
                    "readers": [
                        "ICLR.cc/2024/Conference/Program_Chairs",
                        "ICLR.cc/2024/Conference/Submission7863/Senior_Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission7863/Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission7863/Reviewer_qjsW"
                    ]
                }
            },
            "number": 3,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission7863/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698770445761,
            "cdate": 1698770445761,
            "tmdate": 1699636963897,
            "mdate": 1699636963897,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "fhsumlSaTx",
                "forum": "2UnCj3jeao",
                "replyto": "mqkcakyZ5y",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission7863/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission7863/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Response to Review"
                    },
                    "comment": {
                        "value": "> ***Lack of External Benchmarks: Without a comparison to existing methods or frameworks, it's difficult to assess how much of an improvement the proposed approach offers.***\n\n\u27a4 We compare to competing methods for single-cell trajectory inference (Appendix C.5) and image translation (Table 3, Appendix C.1). For the perturbation modeling task on 4i data, the Monge Gap is the current state-of-the-art to the best of our knowledge. Hence, we continue this line of research by comparing the balanced Monge Gap to our proposed unbalanced version as stated in Section 5.2. (\"Since Uscidda & Cuturi (2023) show that OT-MG outperforms OT-ICNN in this task, we continue this line of research by applying unbalanced OT-MG (UOT-MG) to predict cellular responses to 35 drugs from data profiled with 4i technology (Gut et al., 2018).\")\n\nWe agree with the reviewer that competing unbalancedness estimators were not considered. We hope to overcome this limitation with the newly added benchmark for the sciPlex dataset.\n\n> ***Complexity: Introducing unbalancedness into neural Monge maps could add computational or conceptual complexity, which may not be fully addressed in the paper.***\n\n\u27a4 We agree with the reviewer and as mentioned in the general comment have now added a discussion of the computational complexity introduced by our framework in Appendix B.3. We discuss precisely the cost of incorporating unbalancedness in each Monge map estimator.\n\n> ***Dependency on Empirical Validation: While the paper does include empirical validation, its contributions could be further strengthened with more diverse datasets or a broader set of real-world applications.***\n\n\u27a4 As mentioned in the general comment, we have added another real-world application in a different perturbation task on single-cell data measured in [Srivatsan+'2020] as well as a benchmark on CIFAR-10 image generation. What other datasets or tasks would you be interested in seeing?\n\n> ***What are the limitations of introducing unbalancedness into Monge maps, and are there scenarios where this approach may not be beneficial?***\n\n\u27a4 Thanks for this question. As mentioned in the general comment, we've added a section on the limitations of our framework.\n\n> ***How does the proposed unbalanced neural Monge map approach compare with existing methods in terms of efficiency and accuracy?***\n\n\u27a4 In the following, we assume that the question addresses the comparison of efficiency and accuracy to other unbalancedness estimators. The comparison of UOT-ICNN with [L\u00fcbeck+'2022] is discussed in length in section 4. In particular, we state \"Third, our approach is computationally more efficient [than the approach by Luebeck et al.], as our method requires the\ncomputation of at most one discrete unbalanced OT plan, while the algorithm proposed in [L\u00fcbeck+'2022] includes the computation of two discrete unbalanced OT plans.\" A comparison of UOT-ICNN with other approaches that model unbalancedness (e.g. [Yang+'2019] and [Choi+'2023]) with respect to efficiency is not possible due to the different modeling assumptions. Similarly, comparisons with respect to the efficiency (complexity) of UOT-MG and UOT-FM are not possible. Regarding accuracy, as mentioned in the general comment we've now added a new benchmark comparing UOT-ICNN to related unbalancedness estimators.\n\n***\n[Yang+'2019] Karren D. Yang and Caroline Uhler. \"Scalable unbalanced optimal transport using generative adversarial networks\", (2019).\n\n[Srivatsan+'2020] Srivatsan, Sanjay R., et al. \"Massively multiplex chemical transcriptomics at single-cell resolution.\" Science 367.6473 (2020): 45-51.\n\n[L\u00fcbeck+'2022] Frederike L\\\"ubeck, Charlotte Bunne, Gabriele Gut, Jacobo Sarabia del Castillo, Lucas Pelkmans, and\nDavid Alvarez-Melis. \"Neural unbalanced optimal transport via cycle-consistent semi-couplings\", arXiv preprint arXiv:2209.15621 (2022)."
                    }
                },
                "number": 3,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission7863/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700160374889,
                "cdate": 1700160374889,
                "tmdate": 1700174557317,
                "mdate": 1700174557317,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "2y5BxV3gNg",
            "forum": "2UnCj3jeao",
            "replyto": "2UnCj3jeao",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission7863/Reviewer_LDyN"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission7863/Reviewer_LDyN"
            ],
            "content": {
                "summary": {
                    "value": "The paper introduces unbalancedness into any balanced Monge map estimator based on optimal transport (OT). Moreover, it demonstrates, both theoretically and experimentally, that this can enhance the performance of unpaired domain translation tasks."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "3 good"
                },
                "strengths": {
                    "value": "1. This paper is well writing and is well organized, and proposed method is well-motivated and effective.\n2. This work innovatively integrates unbalanced optimal transport into the existing Monge map estimator, achieving competitive results in various domain translation generative tasks.\n3. Sufficient theoretical and experimental evidence is provided in the main paper and appendix."
                },
                "weaknesses": {
                    "value": "1. In the single-cell trajectory inference and image translation experiments in Sections 5.1 and 5.3 (Table 1, 2, and 4), the article compared the performance of OT and unbalanced OT. Were there comparisons with other state-of-the-art methods?\n2. The experiments in Table 3 on the CelebA dataset show that the proposed method performs suboptimally FID score in comparison to UVCGAN [1], which was introduced in 2022. Further explanation is required to address this disparity.\n3. OT-FM [2] has conducted numerous experiments in image generation tasks and outperforms many GAN-based and diffusion-based methods. Have you considered experimenting with UOT-FM on the same tasks for further validation of the method's effectiveness?\n\n[1] Lipman Y, Chen R T Q, Ben-Hamu H, et al. Flow matching for generative modeling.\n[2] Torbunov D, Huang Y, Yu H, et al. Uvcgan: Unet vision transformer cycle-consistent gan for unpaired image-to-image translation."
                },
                "questions": {
                    "value": "Please see the above weakness part."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "6: marginally above the acceptance threshold"
                },
                "confidence": {
                    "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 4,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission7863/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698982996224,
            "cdate": 1698982996224,
            "tmdate": 1699636963786,
            "mdate": 1699636963786,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "6p3d8Keshl",
                "forum": "2UnCj3jeao",
                "replyto": "2y5BxV3gNg",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission7863/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission7863/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Response to Review"
                    },
                    "comment": {
                        "value": "> ***In the single-cell trajectory inference and image translation experiments in Sections 5.1 and 5.3 (Table 1, 2, and 4), the article compared the performance of OT and unbalanced OT. Were there comparisons with other state-of-the-art methods?***\n\n\u27a4 Yes, for single-cell trajectory we compare to competing methods in Appendix C.5 as mentioned at the end of Section 5.1 . For EMNIST, we chose not to compare to any competing methods, as this is meant as an illustrative example to show the difference between FM, OT-FM, and UOT-FM. For CelebA, we compare to competing methods in Table 3 (latent space) and Appendix C.1 (pixel-space). For Table 4, we chose to evaluate the learned transport cost only for the FM-based methods as the difference between them is the main result we want to emphasize.\n\n> ***The experiments in Table 3 on the CelebA dataset show that the proposed method performs suboptimally FID score in comparison to UVCGAN [1], which was introduced in 2022. Further explanation is required to address this disparity.***\n\n\u27a4 We argue that UOT-FM should be viewed as a **principled method** for unpaired image translation and compared to other such methods like CycleGAN [Zhu+'2017] or [Korotin+'2022], which UOT-FM significantly outperforms in all tasks as detailed in Table 3 and Appendix C.1 .\n\nAs mentioned in Appendix E.3 UVCGAN [Torbunov+'2022] is a **highly optimized** version of CycleGAN that uses an *improved architecture* (UNet + Vision Transformer at the bottleneck layer) and **self-supervised pre-training**. Due to computational reasons, we pre-compute all latent embeddings with the Stable Diffusion encoder and thus are also not benefitting from random cropping during training, which UVCGAN leverages as stated in Appendix F.2.1 . We believe a similar kind of optimization could also be done for UOT-FM to significantly improve its performance.\n\n> ***OT-FM [2] has conducted numerous experiments in image generation tasks and outperforms many GAN-based and diffusion-based methods. Have you considered experimenting with UOT-FM on the same tasks for further validation of the method's effectiveness?***\n\n\u27a4 Originally, we chose not to benchmark on generative modeling tasks as the main focus of the paper is **domain translation**. However as mentioned in the general comment, we have now added an experiment on CIFAR-10 image generation.\n\n***\n\n[Zhu+'2017] Jun-Yan Zhu, Taesung Park, Phillip Isola, and Alexei A Efros. \"Unpaired image-to-image translation\nusing cycle-consistent adversarial networks\". In IEEE International Conference on Computer Vision 2017 (ICCV), 2017.\n\n[Korotin+'2022] Alexander Korotin, Daniil Selikhanovych, and Evgeny Burnaev. \"Neural optimal transport\". 2022. URL https://arxiv.org/abs/2201.12220.\n\n[Torbunov+'2022] Dmitrii Torbunov, Yi Huang, Haiwang Yu, Jin Huang, Shinjae Yoo, Meifeng Lin, Brett Viren, and Yihui Ren. \"Uvcgan: Unet vision transformer cycle-consistent gan for unpaired image-to-image translation\", 2022."
                    }
                },
                "number": 2,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission7863/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700159948592,
                "cdate": 1700159948592,
                "tmdate": 1700174412391,
                "mdate": 1700174412391,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    }
]