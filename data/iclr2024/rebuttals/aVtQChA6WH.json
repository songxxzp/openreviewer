[
    {
        "title": "Distributional off-policy evaluation with Bellman residual minimization"
    },
    {
        "review": {
            "id": "QjraPubjJT",
            "forum": "aVtQChA6WH",
            "replyto": "aVtQChA6WH",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission2888/Reviewer_bA5m"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission2888/Reviewer_bA5m"
            ],
            "content": {
                "summary": {
                    "value": "This paper introduces novel target objectives for distributional RL along with a comprehensive error bound analysis."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "3 good"
                },
                "strengths": {
                    "value": "* The underlying theory seems solid and well-founded, say the derived convergence rates from Theorems 2 and 3 appear reasonable. \n\n* Theorem 3 also handles non-realizable settings which are not seen from previous works."
                },
                "weaknesses": {
                    "value": "* Theorem 3 dosen't degenerate to Theorem 2 under similar settings, which opens the possibiliy of whether a better proof/result exists."
                },
                "questions": {
                    "value": "None"
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "8: accept, good paper"
                },
                "confidence": {
                    "value": "2: You are willing to defend your assessment, but it is quite likely that you did not understand the central parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 1,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission2888/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698299165493,
            "cdate": 1698299165493,
            "tmdate": 1699636232323,
            "mdate": 1699636232323,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "4DMZAAhIfW",
                "forum": "aVtQChA6WH",
                "replyto": "QjraPubjJT",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission2888/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission2888/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Response to bA5m"
                    },
                    "comment": {
                        "value": "We appreciate your positive feedback and the constructive comment.\n\n### **(Weakness 1)** Non-degeneracy of Theorem 3 (of previous manuscript) towards Theorem 2.\n\nWe agree with your comment that the nondegeneracy of Theorem 3 (of previous manuscript) to Theorem 1 under realizability requires additional study.  We would like to provide additional insights/explanations and summarize the reasons why we were not able to achieve that in our current proof.\n\nThe statement of Theorem 3 changed in the new manuscript. Instead of comparing Theorems 2 and 3, it is now fair to compare Theorem 2 and the finite-sample error bound suggested in B.4.3 (or simplified version in Equation (186)) with fixed level of $m=1$.\n\nTo begin with, in non-realizable cases, the converging target is no longer the true distribution. Instead, we compromise our goal into the ``best approximation\" $\\Upsilon_{\\tilde{\\theta}}$, with $\\tilde{\\theta}$ defined in Equation (21). That being said, we are unable to make use of Theorem 1 anymore, which only required us to derive the convergence rate of estimated Bellman residual (our objective function). Therefore, unlike realizable scenario, it requires one additional procedure, which is obtaining convergence of the minimizing parameter. This leads us to take into account the function $\\psi(\\cdot)$ in B.4.3, which further slows down the rate by $1/q$.\n\nIn addition, the sampling contains two procedures, collecting the data $(s_i,a_i,r_i,s_i')$ ($1\\leq i \\leq N$) and resampling multi-step trajectories, as defined before Equation (22). Since we are re-using the samples for multiple times, this no longer guarantees the independence of the data that we use. Then we cannot make use of common tricks for showing sample mean converging to the population mean (e.g. Hoeffding's inequality), since they require independence of samples. Therefore, we resort to another trick (Lemma 3 of Appendix B.2.1) that resembles triangular inequality, but slows down the rate by $1/2$. \n\nDue to the aforementioned reasons, the rate in non-realizable scenario is slower than realizable scenario by $1/(2q)$, that is $\\sqrt{\\log N/N}$ verses $\\sqrt[(4q)]{\\log N/N}$."
                    }
                },
                "number": 10,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission2888/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700325307181,
                "cdate": 1700325307181,
                "tmdate": 1700326580295,
                "mdate": 1700326580295,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "PVnHBLO300",
            "forum": "aVtQChA6WH",
            "replyto": "aVtQChA6WH",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission2888/Reviewer_TZPn"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission2888/Reviewer_TZPn"
            ],
            "content": {
                "summary": {
                    "value": "This work proposes a new method of distributional OPE, EBRM, which is derived from a discrepancy metric of distribution-valued functions based on the energy distance.\n\nThe discrepancy metric has two nice properties. First, it allows us to bound the distributional OPE error in terms of the distributional Bellman residual. Second, it is straightforwardly estimated from the offline sample when the state-action space is finite (i.e., in the tabular setting).\n\nIn the tabular setting, the authors also constructed algorithms to estimate the minimizer of the proposed discrepancy metric for realizable and unrealizable cases, respectively.\n\nFinally, some experimental results are provided."
                },
                "soundness": {
                    "value": "2 fair"
                },
                "presentation": {
                    "value": "2 fair"
                },
                "contribution": {
                    "value": "1 poor"
                },
                "strengths": {
                    "value": "- Addressing interesting problem of OPE (not just in the distributional one): Discrepancy between the estimation error and the estimation objective, where the latter is typically defined with the Bellman residual."
                },
                "weaknesses": {
                    "value": "-  The key inequality (7) involves a large constant $C_{sup}=p_{max}/p_{min}$, which makes it uninteresting. If we are allowed to use a constant of $O(1/p_{min})$, then the max-extended discrepancy $\\eta_\\infty$ is trivially bounded with the expectation-extended discrepancy $\\bar{\\eta}$.\n- Limited experiments. Specifically, the environment is somewhat small and artificial.\n- Some of the notation are broken: For example,\n  - What does $b_\u03bc (s, a) \u2265 p_{min}$ mean in continuous state space? If it is the density of $b_\u03bc$ with respect to some base measure, what is the base measure?\n  - The definition of the kernel (33) does not seem to give $k(x + c, y + c) = k(x, y)$."
                },
                "questions": {
                    "value": "- What is the limitation of the proposed method?\n- In the experiment, why don't you thoroughly feature and discuss the results of more standard and fair metrics (like the Wasserstein-based one in the appendix)?\n- Are the weakness points I raised correct?"
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "3: reject, not good enough"
                },
                "confidence": {
                    "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 2,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission2888/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698592996608,
            "cdate": 1698592996608,
            "tmdate": 1699636232211,
            "mdate": 1699636232211,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "dwqk1RjpTt",
                "forum": "aVtQChA6WH",
                "replyto": "PVnHBLO300",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission2888/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission2888/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Response to TZPn - Part1"
                    },
                    "comment": {
                        "value": "Thank you for your helpful comments.\n\n### **(Weakness 1)** The inequality (7) is not interesting.\n\nIn tabular settings, the two distances $\\bar{\\eta}$ and $\\eta_\\infty$ are equivalent:\n$\\bar{\\eta}(\\Upsilon_1, \\Upsilon_2)\\le \\eta_\\infty (\\Upsilon_1, \\Upsilon_2) \\le p_{\\min}^{-1}\\bar{\\eta}(\\Upsilon_1,\\Upsilon_2)$\nfor any $\\Upsilon_1,\\Upsilon_2$. Due to (5) of our paper, the equivalence would lead to $\\bar{\\eta}(\\Upsilon,\\Upsilon_\\pi) \\le p_{\\min}^{-1} (1-\\gamma^{\\beta_0})^{-1}\\bar{\\eta}(\\Upsilon, \\mathcal{T}^\\pi \\Upsilon)$.\nSo the reviewer's insight holds for tabular settings.\nHowever, Theorem 1 can be applied to general state-action space, which includes continuous state-action space. In the general settings, the two distances are not necessarily equivalent. We also had a related discussion at the end of Section 2.2.\nLet us assume that state-action space is a subset of $\\mathbb{R}^q$ with the data-generating probability being absolutely continuous with respect to the Lebesgue measure, thereby yielding the density $b_\\mu(s,a)$.\nIn general, we cannot bound $\\eta_\\infty$ by $\\bar{\\eta}$ up to any multiplicative constant. So Theorem 1 would not be implied by the corresponding results of supremum-extended distance. Overall, Theorem 1 is indeed a non-trivial result.\n\n\nAs we discussed in Section 1, there is a theory-practice gap regarding distances $\\eta_\\infty$ and $\\bar{\\eta}$.\nEvery method mentioned in the first paragraph of Section 1 of our paper is not free from this ``distance mismatch\" (Tables 1 and 3). They utilize expectation-extended distance in the objective functions of their algorithms; however, the theoretical properties that motivate their constructions are based on supremum-extended distance $\\eta_\\infty$.\nIn its full generality, Theorem 1 provides a foundation for expectation-based distance for settings with general state-action spaces.\nFinally, we remark that our estimator (Sections 3 and 4) is based on tabular settings (and so would not be able to fully exploit the power of Theorem 1.)\nIt is mainly because we aim to provide a more comprehensive study that involves nonstandard setups (e.g., non-realizability, multi-step extensions).\nEven with tabular settings, corresponding analyses are complicated and related theoretical results of these setups in distributional reinforcement learning are rare. To our knowledge, our work is the first that provides theoretically guarantee for non-realizable settings in distributional reinforcement learning. Extension to non-tabular settings with the full exploitation of Theorem 1 is left as a future work.\n\n\n### **(Weakness 2)** Limited experiments.\n\nWe admit that extensive numerical comparison is not our major focus, given the more theoretical flavor of this work.\nIn our numerical experiments, our main focus lies in demonstrating that expectation-extended inaccuracy level converges to zero, and providing some reasonable comparisons with close competitors like FLE [2]. The environment was designed based on Figure 1 of the following paper that devised another distributional reinforcement learning method called RDPS [1]. We have also looked into the combination-lock environment used by [2], however it was designed for finite-horizon problems and so it is not appropriate. We will add more experiments. Specifically, we are considering a 2D example.\n\n\n### **(Weakness 3)** Broken notations\n\nAbout $b_\\mu$: We are sorry for the confusion. If we are assuming a continuous state-action space, then the base measure will be Lebesgue measure, and $b_\\mu$ (in Assumption 1) becomes the density of a continuous random vector.\nIn the manuscript, the notation $b_\\mu$ is used to indicate both the probability measure and its density (slight notational abuse). Now, we made this clear below Equation (6).\n\n\nAbout the kernel $k$: We have corrected the issue behind Equation (33) of Appendix A.3 in the original manuscript. The whole point of A.3 was to show that energy distance satisfies the properties of A.2.1. Instead of using the properties of the associated kernel, we directly showed that energy distance satisfies Property 1 of Appendix A.2.1. Thank you for pointing this out."
                    }
                },
                "number": 7,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission2888/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700325155307,
                "cdate": 1700325155307,
                "tmdate": 1700498131529,
                "mdate": 1700498131529,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "OhxIwN4rpY",
                "forum": "aVtQChA6WH",
                "replyto": "PVnHBLO300",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission2888/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission2888/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Response to TZPn - Part2"
                    },
                    "comment": {
                        "value": "### **(Question 1)** Limitations of EBRM\n\nThere remain a few limitations in our method.\nA major limitation is that our estimator is developed under the tabular setting.\nGiven our discussion of Theorem 1 above, it is interesting to look into more general state-action spaces.\n\nBesides, we focus on parametric family of the conditional distributions, i.e., $\\Theta$ is a subset in a finite-dimensional space.\nExtension to nonparametric modeling of the conditional distributions is also interesting, and potentially lessens the chance of non-realizability due to more flexible modeling.\n\nAnother limitation is that we do not provide a complementary method for control problems (finding optimal policy), as some other distributional RL works (which address evaluation and control problems in the same paper).\n\n\n### **(Question 2)** Not using more standard metric\n\nEnergy distance is a well-known metric that is being widely used and thoroughly studied [8]. In addition, it satisfies good properties, including that it is generally easier to compute than Wasserstein metric, and that it can be regarded as multi-dimensional extension of Cramer distance [3]. It is also a special case of maximum mean discrepancy [4] associated with a specific kernel $k(\\mathbf{x},\\mathbf{y})=||\\mathbf{x}||+||\\mathbf{y}||-||\\mathbf{x-y}||$. Given that [5] and [6] directly used maximum mean discrepancy, and [7] also tried to make an interpolation between Wasserstein metric and maximum mean discrepancy, the use of energy distance seems to be one reasonable choice of metric among the literature of distributional reinforcement learning.\n\n\nAs you also pointed out, we also calculated the inaccuracy levels with other metrics, including expectation-extended Wasserstein-1 metric in Tables 9 and 12 of Appendix D.4. In view of your comment, we will revise the paper to provide the corresponding discussion. In addition, we will add a new metric which is used in [2] (FLE, a method that we compared) in Corollary 4.14 of their paper. (This is also suggested by Reviewer 3TV7.) That is, treating the conditional return distributions as mixture components {$\\Upsilon_\\pi(s,a):(s,a)\\in\\mathcal{S}\\times\\mathcal{A}$} and mixture weights {$b_\\mu(s,a): (s,a)\\in\\mathcal{S}\\times\\mathcal{A}$}, we formed the mixture distribution that can be regarded as the marginal return distribution $\\Upsilon_\\pi^{marginal}$. Then we measured Wasserstein-1 metric value between the estimated and true  (marginal) distributions, as shown in the following tables. Similar to Tables 8--9, 11--12 of Appendix D.4, EBRM outperformed its competitors in all except for the non-realizable scenario with $\\gamma=0.50$, where the performances between EBRM and FLE are very close.\n\n\n- Realizable: $\\sigma_0^2=20$\n\n| Sample size | $500$ | $1000$ | $2000$ | $5000$ | $10000$ | $20000$ |\n|-------------|-------|--------|--------|--------|---------|---------|\n| **EBRM**    | **2.052** | **1.406** | **2.052** | **0.843** | **0.629** | **0.508** |\n|             | (1.524) | (1.005) | (0.778) | (0.556) | (0.350) | (0.255) |\n| **FLE**     | 22.835 | 15.694 | 12.328 | 8.013 | 5.596 | 4.591 |\n|             | (12.810) | (9.272) | (7.859) | (5.113) | (3.786) | (2.945) |\n| **QRTD**    | 97.856 | 56.694 | 47.738 | 45.764 | 49.851 | 49.877 |\n|             | (13.235) | (14.905) | (25.251) | (25.656) | (27.463) | (25.945) |\n\n\n- Realizable: $\\sigma_0^2=5000$\n\n| Sample size | $2000$ | $5000$ | $10000$ | $20000$ | $50000$ | $100000$ |\n|-------------|--------|--------|---------|---------|----------|-----------|\n| **EBRM**    | **18.021** | **11.613** | **7.528** | **5.441** | **3.607** | **3.062** |\n|             | (12.227) | (8.077) | (5.306) | (4.184) | (2.487) | (1.981) |\n| **FLE**     | 94.556 | 71.430 | 46.740 | 44.915 | 31.774 | 23.378 |\n|             | (62.630) | (51.205) | (36.986) | (31.905) | (23.190) | (18.076) |\n| **QRTD**    | 247.308 | 198.257 | 191.908 | 195.787 | 194.908 | 202.076 |\n|             | (16.843) | (29.911) | (48.057) | (73.533) | (91.526) | (86.031) |\n\n\n\n- Non-realizable: $\\gamma=0.50$\n\n| Sample size | $2000$ | $3000$ | $5000$ | $10000$ |\n|-------------|--------|--------|--------|---------|\n| **EBRM**    | 14.098 | 14.088 | 14.087 | **13.218** |\n|             | (0.227) | (0.167) | (0.142) | (0.093) |\n| **FLE**     | **13.954** | **13.977** | **13.968** | 13.970 |\n|             | (0.359) | (0.292) | (0.234) | (0.184) |\n\n- Non-realizable: $\\gamma=0.99$\n\n| Sample size | $2000$ | $3000$ | $5000$ | $10000$ |\n|-------------|--------|--------|--------|---------|\n| **EBRM**    | **106.850** | **84.839** | **73.338** | **66.560** |\n|             | (39.076) | (29.761) | (17.974) | (5.392) |\n| **FLE**     | 258.141 | 279.687 | 349.984 | 432.014 |\n|             | (19.073) | (21.771) | (20.467) | (21.903) |"
                    }
                },
                "number": 8,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission2888/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700325203499,
                "cdate": 1700325203499,
                "tmdate": 1700627767884,
                "mdate": 1700627767884,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "mxFkOnN7wY",
                "forum": "aVtQChA6WH",
                "replyto": "PVnHBLO300",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission2888/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission2888/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Response to TZPn - Part3"
                    },
                    "comment": {
                        "value": "### **(Question 3)** Are the weakness points raised correct?\n\nFirst, we appreciate that you raised these points, which have helped us improve our paper. \n\n(Weakness 1): We believe this is due to misunderstanding---our apology for confusing notation mentioned in (Weakness 3) which might have hindered your prior understanding. We hope that our response have addressed your concern.\n\n(Weakness 2): We admit that extensive numerical comparison is not our major focus of this work. But we will add more experiments.\n\n(Weakness 3): Thank you very much for pointing out these notational issues, which we have fixed.\n\n\n\n### **References**\n\n[1] Morimura, Tetsuro, et al. \"Nonparametric return distribution approximation for reinforcement learning.\" Proceedings of the 27th International Conference on Machine Learning (ICML-10). 2010. \n\n[2] Runzhe Wu, Masatoshi Uehara, Wen Sun: Distributional Offline Policy Evaluation with Predictive Error Guarantees. ICML 2023: 37685-37712 \n\n[3] Marc G Bellemare, Ivo Danihelka, Will Dabney, Shakir Mohamed, Balaji Lakshminarayanan,\nStephan Hoyer, and Remi Munos. The cramer distance as a solution to biased wasserstein gradients. arXiv preprint arXiv:1705.10743, 2017b. \n\n[4] Arthur Gretton, Karsten M Borgwardt, Malte J Rasch, Bernhard Scholkopf, and Alexander Smola. A kernel two-sample test. The Journal of Machine Learning Research, 13(1):723\u2013773, 2012. \n\n[5] Thanh Nguyen-Tang, Sunil Gupta, and Svetha Venkatesh. Distributional reinforcement learning via moment matching. In Proceedings of the AAAI Conference on Artificial Intelligence, volume 35, pp. 9144\u20139152, 2021. \n\n[6] Pushi Zhang, Xiaoyu Chen, Li Zhao, Wei Xiong, Tao Qin, and Tie-Yan Liu. Distributional reinforcement learning for multi-dimensional reward functions. Advances in Neural Information\nProcessing Systems, 34:1519\u20131529, 2021 \n\n[7] Ke Sun, Yingnan Zhao, Yi Liu, Wulong Liu, Bei Jiang, and Linglong Kong. Distributional reinforcement learning via sinkhorn iterations. arXiv preprint arXiv:2202.00769, 2022. \n\n[8] Gabor J Szekely and Maria L Rizzo. Energy statistics: A class of statistics based on distances. Journal of statistical planning and inference, 143(8):1249\u20131272, 2013."
                    }
                },
                "number": 9,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission2888/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700325246151,
                "cdate": 1700325246151,
                "tmdate": 1700627789110,
                "mdate": 1700627789110,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "kUlLNdp4KO",
            "forum": "aVtQChA6WH",
            "replyto": "aVtQChA6WH",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission2888/Reviewer_nT6h"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission2888/Reviewer_nT6h"
            ],
            "content": {
                "summary": {
                    "value": "This paper considered a fundamental problem of the distributional reinforcement learning, termed as the distributional off-policy evaluation. The authors proposed a new algorithm based on the Bellman residual minimization, and characterized the finite-sample statistical error bound under realizable and unrealizable settings. Empirical results on synthetic environments also demonstrate the effectiveness of the proposed setting."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "1 poor"
                },
                "contribution": {
                    "value": "2 fair"
                },
                "strengths": {
                    "value": "* A comprehensive analysis of distributional off-policy evaluation.\n* Technically sound in general."
                },
                "weaknesses": {
                    "value": "* I'm not fully convinced that the proposed distance measure has some meaning in practice. For me it is much more like a distance measure induced by the theoretical need, instead of motivated from some practical consideration. I can provide an example on this unnatural feeling: for OPE on expected return, we care more about $\\|E_{(s, a) \\sim \\rho} Q(s, a) - E_{(s, a) \\sim \\rho} \\hat{Q}(s, a) \\|$ instead of $E_{(s, a) \\sim \\rho} \\| Q(s, a) -  \\hat{Q}(s, a) \\|$, and the latter one also suffers from a slow convergence rate.\n* For the unrealizable setting part I feel there are also many designs that are purely for the proof without so many insights, e.g. $G$ function in (18).\n* I believe that there will not be significance rate difference for the realizable and unrealizable settings, and the difference may also come from the algorithm aside from the reason mentioned by the author (e.g. no need for additional operations in the realizable setting). Such reason should be make more clear in the paper."
                },
                "questions": {
                    "value": "* Can the authors revise the paper to highlight some intuitions behind such algorithm design?\n* Can the authors dive into the rate mismatch between the realizable setting and the unrealizable setting?\n\nI haven't had time to go through the proof line by line (as there are about 50 pages to read) but most of proof steps align with the standard techniques and I believe there will not be severe issues. I will raise some questions if some steps of the proof is unclear or potentially wrong."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "6: marginally above the acceptance threshold"
                },
                "confidence": {
                    "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 3,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission2888/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698650230644,
            "cdate": 1698650230644,
            "tmdate": 1699636232117,
            "mdate": 1699636232117,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "4niCuTXTP4",
                "forum": "aVtQChA6WH",
                "replyto": "kUlLNdp4KO",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission2888/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission2888/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Response to nT6h - Part1"
                    },
                    "comment": {
                        "value": "Thank you for your constructive comments.\n\n### **(Weakness 1)** Not fully convinced if the chosen distributional distance is practically meaningful.\n\nThe analog of $Q$-function and value (expectation of $Q(S,A)$ over $S,A$) in distributional RL are the conditional return distributions {$\\Upsilon_\\pi(s,a):(s,a)\\in\\mathcal{S}\\times\\mathcal{A}$} and the marginal return distribution $\\Upsilon_\\pi^{marginal}$, i.e., the mixture distribution with mixture components {$\\Upsilon_\\pi(s,a): (s,a)\\in\\mathcal{S}\\times\\mathcal{A}$} and mixture weights {$b_\\mu(s,a): (s,a)\\in\\mathcal{S}\\times\\mathcal{A}$}.For simplicity, we choose the reference distribution as $b_\\mu$ for our discussion.\nBased on our understanding, we believe that the reviewer concerns why we are interested in the convergence/accuracy of conditional return distributions, instead of the marginal return distribution.\n\nOne of the major reasons is that, like $Q$-function, the conditional return distributions can be useful for handling a control problem (finding the optimal policy), as shown in the following works ([1] and $\\rm [2]$). In these papers, they estimated the conditional return distributions $\\Upsilon_\\pi(s,a)$, and then developed it into a risk-sensitive policy learning strategy that can deal with the control problem. This is one step further from Q-learning of conventional reinforcement learning, in that we can take into account the risk that is not represented in the expectation value.\n\nSecond, given the conditional return distributions {$\\Upsilon_\\pi(s,a):(s,a)\\in\\mathcal{S}\\times\\mathcal{A}$}, we can easily estimate the marginal return distribution $\\Upsilon_\\pi^{marginal}$. This can be theoretically supported by our theorems (Theorems 2 and 3), since Lemma 3 of Nguyen [3] implies $\\mathcal{E}(\\Upsilon_{\\hat{\\theta}}^{marginal}, \\Upsilon_\\pi^{marginal})\\leq \\bar{\\mathcal{E}}(\\Upsilon_{\\hat{\\theta}}, \\Upsilon_\\pi)$ and $\\mathcal{E}(\\Upsilon_{\\hat{\\theta}}^{marginal}, \\Upsilon_{\\tilde{\\theta}}^{marginal})\\leq \\bar{\\mathcal{E}}(\\Upsilon_{\\hat{\\theta}}, \\Upsilon_{\\tilde{\\theta}})$.\nIn the literature of distributional reinforcement learning, we are not aware of any results indicating that directly proving the convergence of marginal distribution $\\Upsilon_\\pi^{marginal}$ leads to a faster convergence rate.\nIndeed, the reviewer's comment has led to an interesting research direction.\n\n\n### **(Weakness 2)** Non-realizability section does not provide much intuition.\n\nThe insight for both realizable (Section 3) and non-realizable scenarios (Section 4) are elaborated in detail in the response for (Question 1) below. Here, we will only discuss the role of $G(\\theta;\\pi)$, along with the intuitive meaning of Equation (18) of the original manuscript. From its definition $G(\\theta;\\pi):=4\\tilde{\\eta}(\\theta, \\pi)=4\\tilde{\\eta}(\\Upsilon_\\theta, \\Upsilon_\\pi)$, this term represents the disparity from the true distribution. However, it can be simplified by replacing it with a constant $C:=4\\cdot (\\tilde{\\eta}(\\tilde{\\theta},\\pi) + L\\cdot {\\rm diam}(\\Theta, ||\\cdot||)) >0$, as in the updated manuscript. This demonstrates how challenging the given problem is, by combining the size of the model ${\\rm diam}(\\Theta, ||\\cdot||)$ and the extent of non-realizability $\\tilde{\\eta}(\\tilde{\\theta},\\pi):=\\tilde{\\eta}(\\Upsilon_{\\tilde{\\theta}}, \\Upsilon_\\pi)$ that becomes zero in the realizable case. The implication of Equation (18) is that we can shrink this obstacle (that represents non-realizability) to zero by taking multi-step approach, with large enough step level $m$. This eventually allows our estimator to be close to the ``best approximation\" $\\tilde{\\theta}:=\\arg\\min_{\\theta}\\bar{\\mathcal{E}}(\\Upsilon_\\theta , \\Upsilon_\\pi)$. Please refer to the response to (Question 1) for more details.\n\n\n\n### **(Weakness 3)** Not convinced by the rate difference.\n\nPlease see our response to (Question 2) below."
                    }
                },
                "number": 5,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission2888/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700324989366,
                "cdate": 1700324989366,
                "tmdate": 1700627652227,
                "mdate": 1700627652227,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "0nqng6LL5i",
                "forum": "aVtQChA6WH",
                "replyto": "kUlLNdp4KO",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission2888/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission2888/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Response to nT6h - Part2"
                    },
                    "comment": {
                        "value": "### **(Question 1)** Highlight the intuition behind algorithm.\n\nFirst, under the realizable scenario (Section 3), the insight behind the construction of our estimator for the realizable scenario is directly based on Theorem 1, where we show that the inaccuracy $\\bar{\\mathcal{E}}(\\Upsilon, \\Upsilon_\\pi)$ is bounded by Bellman residual $\\bar{\\mathcal{E}}(\\Upsilon, \\mathcal{T}^\\pi \\Upsilon)$ up to a multiplicative constant. This justifies our practice of minimizing the estimated Bellman residual $\\hat{\\theta}=\\arg\\min_{\\theta}\\hat{\\bar{\\mathcal{E}}}(\\Upsilon_\\theta , \\hat{\\mathcal{T}}^\\pi \\Upsilon_\\theta)$.\n\nSecond, for the non-realizable scenario (Section 4), Bellman residual $\\bar{\\mathcal{E}}(\\Upsilon_\\theta, \\mathcal{T}^\\pi \\Upsilon_\\theta)$ can never become zero with any $\\theta\\in\\Theta$, due to model misspecification. This may lead to a loose bound when the minimum value of Bellman residual $\\min_{\\theta}\\bar{\\mathcal{E}}(\\Upsilon_\\theta, \\mathcal{T}^\\pi \\Upsilon_\\theta)$ is very large. Therefore, we suggested an alternative of applying multi-step as follows.\n\nTemporarily ignoring mathematical rigor, the most important insight is that we can approximate $(\\mathcal{T}^\\pi)^m\\Upsilon\\approx \\Upsilon_\\pi$ with sufficiently large step level $m\\in\\mathbb{N}$. Thanks to the properties of energy distance (Appendix A.3), we can obtain uniform convergence of $m$-step Bellman residual towards inaccuracy function, that is $\\sup_{\\theta}|\\bar{\\mathcal{E}}(\\Upsilon_\\theta , (\\mathcal{T}^\\pi)^m \\Upsilon_\\theta) - \\bar{\\mathcal{E}}(\\Upsilon_\\theta , \\Upsilon_\\pi)|\\leq \\gamma^m\\cdot C \\rightarrow 0$ as $m\\rightarrow \\infty$, where $C>0$ is the constant that quantifies non-realizability as illustrated in (Weakness 2). \n\n\nThis eventually allows us to obtain an estimator that converges to the best approximation, that is $\\hat{\\theta}_m^{(B)}\\rightarrow^P \\tilde{\\theta}$, where $\\tilde{\\theta}\\in\\Theta$ is the minimizer of the inaccuracy function (defined in Weakness 2). However, larger step levels $m\\in\\mathbb{N}$ come with a price that resembles bias-variance trade-off, as specified in Equation (186) of Appendix B.4.4. This is why we suggested a rule of choosing the optimal level of $m$ in Appendix D.3.1.  \n\nWe will later revise the paper to highlight the related insights.\n\n\n### **(Question 2)** Dive into the rate difference.\n\nThe statement of Theorem 3 has been changed in the new manuscript. Instead of comparing Theorems 2 and 3, we should compare Theorem 2 and the finite-sample error bound suggested in B.4.3 (or simplified version in Equation (186)) with fixed level of $m=1$. \n\nTo our understanding, the reviewer is suspecting the difference between algorithms of single-step and multi-step EBRM to be part of the reasons for rate difference (the third weakness listed in this response). Indeed, this partially explains the reason, since we form multi-step trajectories by resampling from the collected data $(s_i,a_i,r_i,s_i')$ ($1\\leq i \\leq N$), as mentioned before Equation (22). This practice of re-using the samples no longer guarantees the independence of the data that we use. Then we cannot make use of common tricks for showing sample mean converging to the population mean (e.g. Hoeffding's inequality), since they require independence of samples. Therefore, we resort to another trick (Lemma 3 of Appendix B.2.1) that resembles triangular inequality, but slows down the rate by $1/2$.  \n\nSecond, in non-realizable cases, the converging target is no longer the true distribution. Instead, we compromise our goal into the ``best approximation\" $\\Upsilon_{\\tilde{\\theta}}$, with $\\tilde{\\theta}$ defined in Equation (21). That being said, Theorem 1, which only required us to derive the convergence rate of estimated Bellman residual (our objective function), is not enough now. Therefore, unlike realizable scenario, it requires one additional procedure, which is obtaining convergence of the minimizing parameter. This leads us to take into account the function $\\psi(\\cdot)$ in B.4.3, which further slows down the rate by $1/q$.\n\nDue to the aforementioned reasons, the rate in non-realizable scenario is slower than realizable scenario by $1/(2q)$, that is $\\sqrt{\\log N/N}$ verses $\\sqrt[(4q)]{\\log N/N}$.\n\nWe will add related discussion to the paper.\n\n\n### **References**\n\n[1] Morimura, Tetsuro, et al. \"Nonparametric return distribution approximation for reinforcement learning.\" Proceedings of the 27th International Conference on Machine Learning (ICML-10). 2010. \n\n[2] Morimura, Tetsuro, et al. \"Parametric return density estimation for reinforcement learning.\" arXiv preprint arXiv:1203.3497 (2012). \n\n[3] Thanh Nguyen-Tang, Sunil Gupta, and Svetha Venkatesh. Distributional reinforcement learning via moment matching. In Proceedings of the AAAI Conference on Artificial Intelligence, volume 35,\npp. 9144\u20139152, 2021."
                    }
                },
                "number": 6,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission2888/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700325077356,
                "cdate": 1700325077356,
                "tmdate": 1700627679797,
                "mdate": 1700627679797,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "UmDraUgFtD",
                "forum": "aVtQChA6WH",
                "replyto": "UwiUfgdIjn",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission2888/Reviewer_nT6h"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission2888/Reviewer_nT6h"
                ],
                "content": {
                    "title": {
                        "value": "Thanks for your response."
                    },
                    "comment": {
                        "value": "Thanks for your response. It mostly solves my concern and I will vote for acceptance. However, I tend to keep the current score, as I feel the current result is not that satisfactory and I believe more work can be done on this direction."
                    }
                },
                "number": 21,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission2888/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700726812314,
                "cdate": 1700726812314,
                "tmdate": 1700726812314,
                "mdate": 1700726812314,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "qnND7cFBIb",
            "forum": "aVtQChA6WH",
            "replyto": "aVtQChA6WH",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission2888/Reviewer_3TV7"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission2888/Reviewer_3TV7"
            ],
            "content": {
                "summary": {
                    "value": "The paper addresses a critical aspect of RL by delving into the realm of distributional off-policy evaluation. Specifically, authors introduce a method called Energy Bellman Residual Minimizer (EBRM) to estimate the return distribution, which extends the framework of Bellman residual minimization to distributional RL. This work also establishes finite-sample error bounds for the proposed framework and introduces a multi-step extension for non-realizable settings. Simulations are performed for performance validation and comparison to existing methods."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "3 good"
                },
                "strengths": {
                    "value": "This paper consider the problem of off-policy evaluation in Distributional RL, which concerns estimating the (conditional) return distribution of a target policy based on offline data. Existing reinforcement learning methods predominantly focus on the expectation of return distribution, while distributional RL methods, which extend this focus to the entire return distribution, have shown promising results. However, in off-policy evaluation within DRL, these methods lack theoretical development, error bounds, and convergence rate analysis. The paper addresses this gap by proposing the EBRM method, accompanied by its finite-sample error bounds, providing a theoretical basis for using expectation-extended distance in measuring distributional Bellman residuals. In particular, authors establish the application of expectation-extended distance for Bellman residual minimization in DRLs. A multi-step extension of the proposed method in non-realizable settings is also discussed, with corresponding finite-sample error bounds. The paper significantly contributes to the theoretical understanding of distributional off-policy evaluation in DRL."
                },
                "weaknesses": {
                    "value": "The theoretical guarantees of the proposed methods rely on a set of assumptions, some of which appear to be strong, especially for the proof of Theorem 2 and Theorem 3. Authors should comment on how such assumptions can be satisfied when being applied and provide examples for further illustration. In particular, it is of interest to highlight the essential assumptions that are central to the statistical error bounds, and comment on the performance when relaxing some of the assumptions. Due to such assumptions, it is questionable whether the proposed method (EBRM) has wider applicability compared to the existing methods."
                },
                "questions": {
                    "value": "1. Compared to FLE (Wu et al., 2023), how the proposed method excels in policy learning? In particular, as demonstrated in the empirical evaluations, EBRM does outperforms FLE in terms of statistical accuracy. Does the main reason lie in the fact that FLE focuses on learning the marginal distribution while the proposed method estimates the conditional return distribution?\n\n2. This paper focuses on discounted infinite-horizon tabular RL. Is the current result in Bellman residual minimization generalizable to average-reward MDPs or linear MDPs, and how does it compare to \"A Maximum-Entropy Approach to Off-Policy Evaluation in Average-Reward MDPs\"?"
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "6: marginally above the acceptance threshold"
                },
                "confidence": {
                    "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                },
                "first_time_reviewer": {
                    "readers": [
                        "ICLR.cc/2024/Conference/Program_Chairs",
                        "ICLR.cc/2024/Conference/Submission2888/Senior_Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission2888/Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission2888/Reviewer_3TV7"
                    ]
                }
            },
            "number": 4,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission2888/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698906983866,
            "cdate": 1698906983866,
            "tmdate": 1699640042526,
            "mdate": 1699640042526,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "876XgF0cCl",
                "forum": "aVtQChA6WH",
                "replyto": "qnND7cFBIb",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission2888/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission2888/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Response to 3TV7 - Part1"
                    },
                    "comment": {
                        "value": "Thank you for your constructive comments.\n\n### **(Weakness 1)** Assumptions are strong. Provide examples and give comments on the consequences of relaxing those.\n\nIn the following, we provide the corresponding discussion of individual assumptions. We have also put some additional explanation below Assumption 8 in the updated manuscript.\n\nFirst, we discuss the crucial assumptions.\n\n\n- **Assumption 1**: This corresponds to coverage assumption that is essential for every OPE method, (e.g. FLE [1], Section 5.5 of [2]). It includes all examples where density can be lower-bounded by a positive number $\\inf_{s,a}b_\\mu(s,a)>0$. \n- **Assumptions 5 \\& 8**: Based on these, we can quantify model complexity and non-realizability with $\\tilde{\\eta}$, as well as bound the estimation error. As mentioned in the manuscript, $\\tilde{\\eta}=\\mathbb{W}_{1,\\infty}$ (supremum-extended Wasserstein-1 metric) is an example that satisfies these requirements. \n- **Assumption 7**: Lipschitz continuity allows us to control the model complexity via the metric entropy of $\\Theta$ with respect to the Euclidean norm (see Remark 2). Combined with compactness, it also prevents ill-posed cases where the estimated objective function $\\hat{F}_m^{(B)}(\\cdot)$ does not have a minimizer (in $\\Theta$). Our simulation examples in Appendix D.4 all satisfy this condition when we let $\\tilde{\\eta}$ to be supremum-extended Wasserstein-1 metric.\n\nThe following assumption is the strength of our paper, since it is already weak (realizable scenario) or has been even further relaxed (non-realizable scenario).\n\n- **Assumption 2**: Realizability is already weaker than completeness which is widely assumed in the other papers (e.g. [1], [3], [4]). Even those who relaxed completeness (e.g. $\\rm [5]$) are still assuming realizability, but we took an even further step by relaxing it in Theorem 3 (non-realizable scenario). \n\n\nThe remaining assumptions are relatively less crucial. They are assumed in order to make the proof simpler, and they can be relaxed.\n\n- **Assumption 3**: Subgaussian distribution (e.g. Gaussian, bounded distributions) is widely assumed to apply standard concentration inequalities. We can assume slower-decaying tail probability, however this further complicates the analyses. \n- **Assumption 4**: iid assumption can be relaxed into trajectory-based observations $(s_t,a_t,r_t,s_{t+1})$ ($1\\leq t \\leq N$). In this case, we would need additional assumptions (e.g. exponential $\\beta$-mixing in Definition 1 of $\\rm [6]$) to ensure an appropriate decaying rate of the dependence. \n- **Assumption 6**: The role of polynomial degree $q\\geq1$ is to quantify the convergence rate (Theorem 3), and we can still obtain consistency without it. Here is one example. Assume the same setting in Section 5, only differing in reward distribution $R(s,a)\\sim N(0,1)$ for all $s,a$ and the model $\\Upsilon_\\theta(s,a)=\\phi(0,\\theta/(1-\\gamma^2))$ with $\\theta\\in\\Theta=[0,2]$, where $\\phi(\\mu,\\sigma^2)$ indicates gaussian probability with parameters $\\mu$, $\\sigma^2$. Then we have a unique minimizer $\\tilde{\\theta}=1$ and $F(\\theta)\\geq F(\\tilde{\\theta})+c_1\\cdot |\\theta - 1|^2$ holds for some $c_1>0$, leading to $q=2$."
                    }
                },
                "number": 2,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission2888/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700324746190,
                "cdate": 1700324746190,
                "tmdate": 1700627527543,
                "mdate": 1700627527543,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "NXplavkjTe",
                "forum": "aVtQChA6WH",
                "replyto": "qnND7cFBIb",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission2888/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission2888/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Response to 3TV7 - Part2"
                    },
                    "comment": {
                        "value": "### **(Question 1)** Why does EBRM outperform FLE? Is it due to the difference in focus (marginal distribution versus conditional return distribution)?\n\nBoth FLE [1] and EBRM (our method) are for off-policy evaluation. We believe the reviewer's question is regarding the performance of the two methods in terms of policy evaluation instead of policy learning (that is, finding the optimal policy). \n\nFirst, we provide some explanations why the proposed EBRM achieved better performance than its competitors. The first explanation is that none of the simulated examples satisfy completeness, which FLE requires as its assumption. On the contrary, EBRM can be applied when completeness is violated, including realizable and non-realizable scenarios.\nSuch effect becomes more apparent in our most difficult non-realizability setup (non-realizable example of D.2.3 with $\\gamma=0.99$ demonstrated in bottom plots of Figure 3).\nThe performance of FLE even deteriorates with larger sample size, and this pattern is consistently observed with other measures of inaccuracy (Tables 11, 12, and 13 of Appendix D.4.2). Another plausible reason is that FLE is not utilizing the closed-form probability measure in each update. Whenever they update their estimation at $t$-th iteration, they sample finitely many samples from the previous estimate $\\Upsilon_{\\theta_{t-1}}(s,a)$, which is prone to approximation error.\n\nSecond, it is true that [1] measured inaccuracy of FLE estimation by comparing the marginal return distribution $\\Upsilon^{marginal}$, which is the mixture distribution with mixture components {$\\Upsilon_\\pi(s,a): (s,a)\\in\\mathcal{S}\\times\\mathcal{A}$} and mixture weights {$b_\\mu(s,a): (s,a)\\in\\mathcal{S}\\times\\mathcal{A}$}. Therefore, we hereby evaluate the inaccuracy according to their method (Corollary 4.14 of [1]), by comparing the marginal distributions $\\Upsilon_{\\hat{\\theta}}^{marginal}$ and $\\Upsilon_\\pi^{marginal}$ via Wasserstein-1 metric $\\mathbb{W}_1$. The results, as shown in the following two tables, are based on the same simulations shown in Tables 8--13 of Appendix D.4, but evaluated based on marginal distribution. As in previous results (Tables 8--9, 11--12), EBRM outperformed its competitors in all except for the non-realizable scenario with $\\gamma=0.50$, where the performances between EBRM and FLE are very close. \n\n- Realizable: $\\sigma_0^2=20$\n\n| Sample size | $500$ | $1000$ | $2000$ | $5000$ | $10000$ | $20000$ |\n|-------------|-------|--------|--------|--------|---------|---------|\n| **EBRM**    | **2.052** | **1.406** | **2.052** | **0.843** | **0.629** | **0.508** |\n|             | (1.524) | (1.005) | (0.778) | (0.556) | (0.350) | (0.255) |\n| **FLE**     | 22.835 | 15.694 | 12.328 | 8.013 | 5.596 | 4.591 |\n|             | (12.810) | (9.272) | (7.859) | (5.113) | (3.786) | (2.945) |\n| **QRTD**    | 97.856 | 56.694 | 47.738 | 45.764 | 49.851 | 49.877 |\n|             | (13.235) | (14.905) | (25.251) | (25.656) | (27.463) | (25.945) |\n\n- Realizable: $\\sigma_0^2=5000$\n\n| Sample size | $2000$ | $5000$ | $10000$ | $20000$ | $50000$ | $100000$ |\n|-------------|--------|--------|---------|---------|----------|-----------|\n| **EBRM**    | **18.021** | **11.613** | **7.528** | **5.441** | **3.607** | **3.062** |\n|             | (12.227) | (8.077) | (5.306) | (4.184) | (2.487) | (1.981) |\n| **FLE**     | 94.556 | 71.430 | 46.740 | 44.915 | 31.774 | 23.378 |\n|             | (62.630) | (51.205) | (36.986) | (31.905) | (23.190) | (18.076) |\n| **QRTD**    | 247.308 | 198.257 | 191.908 | 195.787 | 194.908 | 202.076 |\n|             | (16.843) | (29.911) | (48.057) | (73.533) | (91.526) | (86.031) |\n\n\n\n- Non-realizable: $\\gamma=0.50$\n\n| Sample size | $2000$ | $3000$ | $5000$ | $10000$ |\n|-------------|--------|--------|--------|---------|\n| **EBRM**    | 14.098 | 14.088 | 14.087 | **13.218** |\n|             | (0.227) | (0.167) | (0.142) | (0.093) |\n| **FLE**     | **13.954** | **13.977** | **13.968** | 13.970 |\n|             | (0.359) | (0.292) | (0.234) | (0.184) |\n\n- Non-realizable: $\\gamma=0.99$\n\n| Sample size | $2000$ | $3000$ | $5000$ | $10000$ |\n|-------------|--------|--------|--------|---------|\n| **EBRM**    | **106.850** | **84.839** | **73.338** | **66.560** |\n|             | (39.076) | (29.761) | (17.974) | (5.392) |\n| **FLE**     | 258.141 | 279.687 | 349.984 | 432.014 |\n|             | (19.073) | (21.771) | (20.467) | (21.903) |"
                    }
                },
                "number": 3,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission2888/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700324834994,
                "cdate": 1700324834994,
                "tmdate": 1700627564535,
                "mdate": 1700627564535,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "ceMmXra1gj",
                "forum": "aVtQChA6WH",
                "replyto": "qnND7cFBIb",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission2888/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission2888/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Response to 3TV7 - Part3"
                    },
                    "comment": {
                        "value": "### **(Question 2)** How does it compare with the paper about Linear MDP or average-reward MDP?\n\n\nFirst, in the suggested paper [7], they are interested in estimating the average reward throughout infinite time progress $J_\\pi = \\lim_{T\\rightarrow \\infty} \\mathbb{E}( \\frac{1}{T} \\sum_{t=1}^{T} r(s_t,a_t) )$. This is different from EBRM (our method) which is interested in estimating the distribution of return (cumulative discounted summation of consecutive rewards) in Equation (1) of our text. Due to the difference between the target quantities (expectation vs. distribution; limiting average vs. discounted sum), it is not clear how to compare these two methods. \n\nNext, linear MDP may be useful in expanding our method into continuous state-action space by expressing the transition probability and reward distribution as linear combinations of multiple features $\\phi(\\cdot,\\cdot):\\mathcal{S\\times A}\\rightarrow \\mathbb{R}^n$. To elaborate, it may allow us to construct an unbiased estimate of energy distance for continuous state-action space, where a single $s,a$ cannot be observed twice or more (almost surely). In such cases, our current estimation in Equation (10) leads to a biased estimate of the third term of expansion of $\\mathcal{E}(\\Upsilon_\\theta(s,a), \\mathcal{T}^\\pi \\Upsilon_\\theta(s,a))$ shown in Equation (9), which is $\\mathbb{E}|| R_\\alpha + \\gamma\\cdot Z_\\alpha(S_\\alpha',A_\\alpha';\\theta) -  R_\\beta - \\gamma\\cdot Z_\\beta(S_\\beta',A_\\beta';\\theta)  ||$. Here, we have $(R_\\alpha,S_\\alpha'), (R_\\beta,S_\\beta')\\sim p(\\cdots|s,a)$ and $A_\\alpha'\\sim\\pi(\\cdot|S_\\alpha')$, $A_\\beta'\\sim\\pi(\\cdot|S_\\beta')$, where $\\alpha,\\beta$ are for indicating independent copies. According to our current way of estimation (10), our estimate becomes $\\mathbb{E}|| \\gamma\\cdot Z_\\alpha(s',A_1';\\theta) - \\gamma\\cdot Z_\\beta(s',A_2';\\theta) ||$ with $A_1',A_2'\\sim\\pi(\\cdot|s')$ being independent. This is because the terms $\\hat{R}_{i}=r$ ($i=\\alpha,\\beta$) have the same value, and are thereby cancelled out when there is only a single observation $(s,a,r,s')$. This bias might be prevented if we can estimate the distribution of terms $\\hat{R}_i\\sim\\hat{p}(\\cdots|s,a)$ ($i=\\alpha,\\beta$) (for $s,a$ that was observed only once) by expressing them with features. In addition, leveraging the structure of the linear MDP may improve the efficiency of our method. It will be interesting to see what the structure of return distribution induced by the linear MDP is, which requires further investigation. We will add some discussion on this reference in the paper.\n\n\n### **References**\n\n[1] Runzhe Wu, Masatoshi Uehara, Wen Sun: Distributional Offline Policy Evaluation with Predictive Error Guarantees. ICML 2023: 37685-37712 \n\n[2] Sutton, R. S., \\& Barto, A. G. (2018). Reinforcement learning: An introduction (2nd ed.). The MIT Press. \n\n[3] Duan, Yaqi, Zeyu Jia, and Mengdi Wang. \"Minimax-optimal off-policy evaluation with linear function approximation.\" International Conference on Machine Learning. PMLR, 2020. \n\n[4] Agarwal, Alekh, et al. \"Reinforcement learning: Theory and algorithms.\" CS Dept., UW Seattle, Seattle, WA, USA, Tech. Rep 32 (2019). \n\n[5] Zanette, Andrea. \"When is realizability sufficient for off-policy reinforcement learning?.\" International Conference on Machine Learning. PMLR, 2023. \n\n[6] Antos, Andr\u00e1s, Csaba Szepesv\u00e1ri, and R\u00e9mi Munos. \"Learning near-optimal policies with Bellman-residual minimization based fitted policy iteration and a single sample path.\" Machine Learning 71 (2008): 89-129.\n\n[7] Nevena Lazic, Dong Yin, Mehrdad Farajtabar, Nir Levine, Dilan Gorur, Chris Harris, and Dale\nSchuurmans. A maximum-entropy approach to off-policy evaluation in average-reward mdps.\nAdvances in Neural Information Processing Systems, 33:12461\u201312471, 2020."
                    }
                },
                "number": 4,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission2888/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700324898762,
                "cdate": 1700324898762,
                "tmdate": 1700627594247,
                "mdate": 1700627594247,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "Ov7qOPCCvw",
                "forum": "aVtQChA6WH",
                "replyto": "0dxTyVpwLU",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission2888/Reviewer_3TV7"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission2888/Reviewer_3TV7"
                ],
                "content": {
                    "comment": {
                        "value": "Thanks for your detailed reply and the further information to provide a better understanding. After reading your reply and other reviewers' opinions, I agree that this is a technically sound paper while sharing concerns regarding the practical applicability. Indeed, it provides a solid understanding of off-policy evaluation. As such, I decided to keep my original assessment and lean toward acceptance."
                    }
                },
                "number": 20,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission2888/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700726336172,
                "cdate": 1700726336172,
                "tmdate": 1700726336172,
                "mdate": 1700726336172,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    }
]