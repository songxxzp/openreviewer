[
    {
        "title": "On Accelerating Diffusion-based Molecular Conformation Generation in SE(3)-invariant Space"
    },
    {
        "review": {
            "id": "4XeTxugtd2",
            "forum": "Wn82BUF7jH",
            "replyto": "Wn82BUF7jH",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission521/Reviewer_gijA"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission521/Reviewer_gijA"
            ],
            "content": {
                "summary": {
                    "value": "This paper proposes an acceleration method for diffusion-based molecular conformation generation models. The proposed method involves modifying the score-based model in coordinate space and applying multiplier to the discretization of the SDE. The first modification is motivated by an analysis of the relationship between scores in coordinate and distance spaces, while the second addresses score approximation errors. The proposed sampling technique is applied to two SE(3)-equivariant diffusion models, GeoDiff (Xu et al., 2022) and SDDiff (Zhou et al., 2023), and is compared to the annealed Langevin dynamics sampler. While the proposed sampler shows empirical advantages, the paper falls short in terms of justifying the modifications adequately, and the mathematical details are both lacking in rigor and difficult to follow. Without further elaboration on these details and their underlying motivation, the paper has yet to provide compelling evidence to demonstrate a substantial contribution."
                },
                "soundness": {
                    "value": "2 fair"
                },
                "presentation": {
                    "value": "2 fair"
                },
                "contribution": {
                    "value": "3 good"
                },
                "strengths": {
                    "value": "Benchmarks on two conformer datasets (GEOM-Drugs and GEOM-QM9) demonstrate that the proposed method generates conformers of comparable quality and coverage to the reference method, but with a reduced computational time, requiring 50x\u2013100x fewer time steps."
                },
                "weaknesses": {
                    "value": "The argument presented in this paper relies on the assumption that the set of the valid distance matrices can be endowed with a manifold structure, as stated in Section 3.3: \u201cThe manifold of valid distance matrices is a proper sub-manifold of R_+^(n\u00d7n).\u201d Subsequently, the pushforward map d\u03c6 is employed to map the score functions from distance space to coordinate space. However, the construction of a manifold structure for distance matrices is not trivial, considering that not all \u201cdistance matrices\u201d are valid; they must satisfy conditions such as the triangle inequality. The authors should provide relevant references or mathematical construction to support the claims made in the paper.\n\tThe differential geometry arguments in the paper lack clarity. For example, the use of d\u03c6 in this paper is more of a \u201cproposal\u201d than a well-defined mathematical construct. Additionally, while d \u0303\u2208M and \u2207_d \u0303   log\u2061\u3016p_\u03c3 (d \u0303\u2502d)\u2208T_d \u0303  M\u3017, it is repeatedly \u201cassumed\u201d in the paper that d \u0303+\u2207_d \u0303   log\u2061\u3016p_\u03c3 (d \u0303\u2502d)\u2208T_d \u0303  M\u3017, even though the addition between elements of a manifold and its tangent space is not clearly defined.\n\tThe rationale behind the factor of 1/2(n-1) in eq 9 and the unnumbered equation on page 14 is not clear. Since this factor is directly related to the construction of the first modification (eqs 5 and 11), it should be thoroughly explained and justified. It would be better to clarify whether this factor is based on the \u201crescaling\u201d approximation illustrated in Figure 6.\n\tThe implications of the error bound analysis in Theorem 1 are not clear. At least, the analysis does not support the claim that the proposed solution in eq 9 is \u201coptimal\u201d, as a naive choice of C \u0302=C \u0303 (the original coordinates) would yield a tighter upper bound of f(d \u0302 )=\u03b4^2<(2n^2+n-1)/(2(n-1)^2 ) \u03b4^2 if n>1.\n\tIn Section 4.2, the authors assume that the prediction error of the score-based model is a random error leading to an incomplete time step. However, the model error incurred during the score matching training procedure is more likely to be systematic rather than random, i.e., the model error would depend on the input distances and time steps. Since the following analysis in Section 5.1 assumes a random noise scheme, the authors would need to discuss how the results generalize to the trained score-based models with systematic errors.\n\tWhile the method generates conformers of comparable quality to the 5000-step LD sampler, it would be beneficial to demonstrate that the quality is superior to the LD sampler with equivalent time steps. It would be helpful to compare the results with the LD sampler with a similar (~100) or somewhat larger (500 or 1000?) number of time steps in Table 1."
                },
                "questions": {
                    "value": "In Section 2, FrameDiff (Yim et al., 2023) performs diffusion on frame translations and frame orientations (rotations) rather than torsion angles as mentioned in the paper.\n\tOn the top of page 5, symbols \u03b1_ij and e_ij are introduced without explanation. Also, it would be nice to provide a brief explanation or reference to the generalized multidimensional scaling.\n\tIn the sentence just before eq 11, the meaning of the phrase \u201cthe pairwise distance matrix is sparse\u201d is not clear. It might be better to reformulate the optimization problem in eq 8 by replacing the summation over all i < j pairs with connected (i, j) pairs.\n\tIn Appendix G, the MAT-R metric should be corrected as follows:\n\nMAT=1/|S_r |  \u2211_(C\u2208S_r)\u2592min\u252c(C^'\u2208S_g )\u2061RMSD(C,C^' )"
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "5: marginally below the acceptance threshold"
                },
                "confidence": {
                    "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 1,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission521/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698786130854,
            "cdate": 1698786130854,
            "tmdate": 1699635979306,
            "mdate": 1699635979306,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "aV8Kl233lL",
                "forum": "Wn82BUF7jH",
                "replyto": "4XeTxugtd2",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission521/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission521/Authors"
                ],
                "content": {
                    "comment": {
                        "value": "**Weakness**\n1. **About manifold construct**. In this paper, we do not need to explicitly construct the manifold of the adjacent matrix and the SE(3)-invariant coordinates manifold. If one is interested in such a construction, one can easily construct the manifold of the adjacent matrix manifold by considering the spectral theorem. More specifically, for any feasible $D$, there corresponds to a Gram matrix $M \\in \\mathbb{R}^{n \\times n}$ by $M_{ij} = \\frac{1}{2} (D_{1j} + D_{i1} - D_{ij})$ and vice versa $D_{ij} = M_{ii} + M_{jj} - 2 M_{ij}$ and the matrix $M$ has a specific structure\n\\begin{equation}\n    M=\\left(\\begin{array}{ll}\n    0 & \\mathbf{0}^{\\top} \\\\\n    \\mathbf{0} & L\n    \\end{array}\\right)\n\\end{equation}\nwith $L \\in \\mathbb{R}^{(n-1) \\times (n-1)}$ being symmetric and positive semi-definite and $\\operatorname{rank}(L)=3$. Then, we define the mapping from $L$ to $D$ by $h$. One can define the manifold of the adjacent matrix to be $M = \\{h(XX^T) \\mid X \\in \\mathbb{R}^{(n-1) \\times 3}\\}$. To construt a SE(3)-invariant coordinate manifold, we pick any $\\mathcal{C} \\in \\mathbb{R}^{n \\times 3}$, then define $N_{\\mathcal{C}} = \\{ \\hat{\\mathcal{C}} = [\\hat{\\mathbf{x}}_1, \\ldots, \\hat{\\mathbf{x}}_n] \\mid \\hat{\\mathbf{x}}_i = \\mathbf{x}_i + \\sum_{j=1}^n \\alpha_{ij} \\frac{\\mathbf{x}_i - \\mathbf{x}_j}{\\| \\mathbf{x}_i - \\mathbf{x}_j \\|}, \\alpha_{ij} = \\alpha_{ji}, \\alpha_{ii} = 0, \\alpha_{ij} \\in \\mathbb{R} \\}$. In this paper, we do not need to explicitly define the above two manifolds, hence, we do not consider such constructions.\n\n2. **About manifold assumption.** We assume that the tangent space of the adjacent matrix manifold is $\\mathbb{R}^{n \\times n}$. Such an assumption is certainly wrong. However, since we did not apply any constraints on the model's output. When our model predicts the tangent vector of the tangent space of the distance manifold, the output may not necessarily lay in the tangent space. This pushes us to consider the tangent space as the $\\mathbb{R}^{n \\times n}$. The above argument for why we assume the tangent space is $\\mathbb{R}^{n \\times n}$ can also be found in Appendix D.1.\n\n3. **About factor** $\\frac{1}{2(n-1)}$. This factor is composed of two parts. One is $2$, which comes from the bipartition of the distance change, as illustrated in Fig. 6 by $-\\frac{\\delta}{2} \\boldsymbol{\\lambda}_{uv}$ and $\\frac{\\delta}{2} \\boldsymbol{\\lambda}_{uv}$. The other is $n-1$, which is the node degree in a fully connected graph. \n\n4. **About error bound analysis.** The error-bound analysis aims to show that when the node number increases, the approximation error is still bounded. However, using GeoDiff's modeling of the conformation score, the error bound explodes when $n$ becomes sufficiently large. For the naive choice of the original coordinates, we can show that by experimental results on the toy dataset, the proposed approximation has a smaller average error compared with using the original coordinates.\n\n5. **About prediction error.** Since we have no enough information about the structure of the prediction error, we can only apply a common assumption that the prediction error follows a Gaussian distribution.\n\n6. **About abalation study.** This is a fantastic point. We reduced the $\\sigma$ sequence from 5000 to 100 equally spaced points utilizing linear interpolation, the initial and final values from the original set are included. We meticulously select the optimal step size $h$, for each model, consistently converging around a value around 1e-4.\n\n|         |         |  Recall |        |         |        | Precision |        |          |         |\n|---------|:-------:|:-------:|:------:|:-------:|:------:|:---------:|:------:|:--------:|:-------:|\n| Dataset |  Method | COV(%)\u2191 |        | MAT(\u00c5)\u2193 |        |  COV(%)\u2191  |        |  MAT(\u00c5)\u2193 |         |\n|         |         |   Mean  | Median |   Mean  | Median |    Mean   | Median |   Mean   |  Median |\n| Drugs   | GeoDiff |  42.35  |  33.30 |  1.3326 | 1.3339 |   21.62   | 13.17  | 204.4705 |  1.9867 |\n|         |  SDDiff |   1.24  |  00.00 |  6.6569 | 6.9824 |   00.44   |  00.00 | 291.7993 | 97.1702 |\n| QM9     | GeoDiff | 10.48   | 5.48   | 0.6390  | 0.6432 | 2.21      | 1.40   | 116.6899 | 90.4334 |\n|         | SDDiff  | 25.54   | 19.47  | 0.6018  | 0.6009 | 5.04      | 3.67   | 9.8198   | 3.6648  |"
                    }
                },
                "number": 7,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission521/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700411835291,
                "cdate": 1700411835291,
                "tmdate": 1700411835291,
                "mdate": 1700411835291,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "g9LUepz9ft",
                "forum": "Wn82BUF7jH",
                "replyto": "4XeTxugtd2",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission521/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission521/Authors"
                ],
                "content": {
                    "comment": {
                        "value": "**Questions**\n> 1. On  FrameDiff (Yim et al., 2023) in Section 2 and MAT-R  in Appendix G.\n\nThanks for your pointing out it. We have revised it.\n\n> 2. On the top of page 5 , symbols \u03b1_ij and e_ij are introduced without explanation. Also, it would be nice to provide a brief explanation or reference to the generalized multidimensional scaling.\n\nThese notations are commonly used in linear algebra.  $e_{ij}$ is a square matrix such that its entry in the i-th row and j-th column equals 1 and the other entries equal to 0. $\\alpha_{ij}$ denotes the magnitude of change in edge that connects node $i$ and node $j$. The derivation for the Eq 8-9 can be found in the Appendix D.2. \nGeneralized multidimensional scaling extends metric multidimensional scaling by accommodating a non-Euclidean target space. GMDS facilitates the discovery of the most accurate embedding of one surface into another when dissimilarities represent distances on a surface and the target space is an alternative surface.\n\n> 3. In the sentence just before eq 11 , the meaning of the phrase \"the pairwise distance matrix is sparse\" is not clear.\n\nThis means that in practice, we usually consider a partially connected graph, hence, we only consider a proportion of entries in the full adjacent matrix. \n\n> 4. It might be better to reformulate the optimization problem in eq 8 by replacing the summation over all $i<j$ pairs with connected $(i, j)$ pairs. \n\nThanks for your suggestions, we will consider modifying this."
                    }
                },
                "number": 8,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission521/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700411842650,
                "cdate": 1700411842650,
                "tmdate": 1700411853111,
                "mdate": 1700411853111,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "F9IsDNEAEC",
            "forum": "Wn82BUF7jH",
            "replyto": "Wn82BUF7jH",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission521/Reviewer_bG3y"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission521/Reviewer_bG3y"
            ],
            "content": {
                "summary": {
                    "value": "In this paper, two modifications to the existing sampling methods of the diffusion model are proposed to improve the sampling rate for generating molecular conformations in SE(3) invariant spaces."
                },
                "soundness": {
                    "value": "2 fair"
                },
                "presentation": {
                    "value": "2 fair"
                },
                "contribution": {
                    "value": "1 poor"
                },
                "strengths": {
                    "value": "- This paper is well-organized.\n- The paper focuses on accelerating the sampling process of the diffusion model for conformation generation, which is an interesting topic."
                },
                "weaknesses": {
                    "value": "1. The paper is not well-motivated. The proposed sampling method is specifically designed for the task of molecular conformation generation in SE(3)-invariant space.  However, the SOTA method of conformation generation like Torsional Diffusion which operates on the hypertorus achieves much better performance than GeoDIFF which operates on Euclidean space. Moreover, the sampling process of Torsional Diffusion only needs 20 steps. Therefore, focusing on accelerating the sampling process of GeoDIFF/SDDiff seems meaningless.\n2. The contribution of the introduced two minor modifications is limited. The operations just introduced two coefficients into existing sampling methods[1] to compensate for the poor performance on the conformation generation task by using [1] directly. From the experiments, the proposed methods don't get surprising results.\n3. The paper is over-clams. The paper doesn\u2019t provide the theoretical results about the statement \u201cWe analyze current modeling methods in SE(3) (Shi et al., 2021; Xu et al., 2022; Zhou et al., 2023) and theoretically pose crucial mistakes shared in these methods, which inevitably bring about the failure of acceleration\u201d and don\u2019t give the reasons why the modification solve the theoretical problems. If the proposed modifications can solve the problems, at least it can be directly used to improve the existing sampling methods applied in (Shi et al., 2021; Xu et al., 2022; Zhou et al., 2023).\n4. The paper is not well-written. The paper hasn\u2019t explained clearly why the introduced two modifications can accelerate the sampling process significantly. For modification one, the introduced $degree_i$ can make the sparse conformation into a fully connected conformation. Why connected conformation can outperform sparse one? \n5. The proposed sampling method mainly improves the recall but gains worse performance in precision. Therefore, this method, which is only used for conformation generation, is not very practical.\n6. The experimental results of baseline GeoDiff are significantly lower than the results reported in the GeoDiff paper.\n\n[1] DPM-Solver: A Fast ODE Solver for Diffusion Probabilistic Model Sampling in Around 10 Steps"
                },
                "questions": {
                    "value": "See section weakness."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "3: reject, not good enough"
                },
                "confidence": {
                    "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
                },
                "code_of_conduct": {
                    "value": "Yes"
                },
                "first_time_reviewer": {
                    "value": "Yes",
                    "readers": [
                        "ICLR.cc/2024/Conference/Program_Chairs",
                        "ICLR.cc/2024/Conference/Submission521/Senior_Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission521/Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission521/Reviewer_bG3y"
                    ]
                }
            },
            "number": 2,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission521/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698817230002,
            "cdate": 1698817230002,
            "tmdate": 1699635979179,
            "mdate": 1699635979179,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "iqkoNvD8gv",
                "forum": "Wn82BUF7jH",
                "replyto": "F9IsDNEAEC",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission521/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission521/Authors"
                ],
                "content": {
                    "comment": {
                        "value": "> 1. The paper is not well-motivated. The proposed sampling method is specifically designed for the task of molecular conformation generation in SE(3)-invariant space. However, the SOTA method of conformation generation like Torsional Diffusion which operates on the hypertorus achieves much better performance than GeoDIFF which operates on Euclidean space. Moreover, the sampling process of Torsional Diffusion only needs 20 steps. Therefore, focusing on accelerating the sampling process of GeoDIFF/SDDiff seems meaningless.\n\nWe do not agree with that accelerating the sampling process of GeoDIFF/SDDiff seems meaningless. Different from Torsional Diffusion, GeoDIFF and SDDiff are purely data-driven without any prior knowledge and preprocess(like RDkit in Torsinal Diffusion) and their distance-based modeling is effortless, indicating that they are not limited in the conformation generation tasks. As for our acceleration method, from the derivation of our method is also applicable to any coordinates generation tasks that take SE(3)-invariance into consideration. For example, our method is also applicable to sparse cloud point generation tasks. However, torsional diffusion is inapplicable in this case since it cannot first generate a local structure. In a nutshell, although focusing on molecular conformation generation, our contribution in deed lies in that we rethink the modeling occurring in the general SE(3)-based methods and propose a scheme for accelerating general diffusion-based generation in SE(3)-invariant space, and we plan to generalize it in future works.\n\n> 2. The contribution of the introduced two minor modifications is limited. The operations just introduced two coefficients into existing sampling methods[1] to compensate for the poor performance on the conformation generation task by using [1] directly. From the experiments, the proposed methods don't get surprising results.\n\nDirectly using the DPM solver is inapplicable rather than just poor performance, we have demonstrated in Sec 4 around Eq.4 \"...cannot produce substantial conformations. \". We found that the results are chaos. Ignoring any one of our proposed two modifications would lead to zero performance w.r.t COV and nan w.r.t. MAT.\nOur proposed modifications are minor but non-trivial. Such a modeling issue has existed since ConfGF (2021) and remains unsolved. The mathematical proofs behind such two simple modifications are intricate, and our experiments strongly proved that our method gains a roughly 50-150x speedup on comparable performance.\n    \n> 3. The paper is over-clams. The paper doesn\u2019t provide the theoretical results about the statement \u201cWe analyze current modeling methods in SE(3) (Shi et al., 2021; Xu et al., 2022; Zhou et al., 2023) and theoretically pose crucial mistakes shared in these methods, which inevitably bring about the failure of acceleration\u201d and don\u2019t give the reasons why the modification solve the theoretical problems. If the proposed modifications can solve the problems, at least it can be directly used to improve the existing sampling methods applied in (Shi et al., 2021; Xu et al., 2022; Zhou et al., 2023).\n\nThe current modeling of the transformation from distance score to conformation score is heuristic. In Sec 4.1 we proposed revised modeling via differential geometry and proposed modification 1. Then we consider remedying the approximation error of the conformation score by an additional scaling factor in Sec 4.2.\n\nWe do not understand what the reviewer means by ``at least it can be directly used to improve the existing sampling methods applied in (Shi et al., 2021; Xu et al., 2022; Zhou et al., 2023)''. We have directly used our method to accelerate the existing sampling methods applied in GeoDiff and SDDiff (Xu et al., 2022; Zhou et al., 2023) by two slight modifications, and the results are shown in experiments. In the experimental section, we showed that our method indeed improves the existing sampling methods since originally, using the traditional method to accelerate these models would all lead to 0 performance. \n    \n> 4. The paper is not well-written. The paper hasn\u2019t explained clearly why the introduced two modifications can accelerate the sampling process significantly. For modification one, the introduced $degree$ can make the sparse conformation into a fully connected conformation. Why connected conformation can outperform sparse one?\n\nSec 4.1 and Sec 4.2 have introduced the theory behind our modifications. The first modification is not designed to transform the sparse conformation into a fully connected conformation. Instead, we argued that the previous computation of the conformation score is wrong, i.e., the conformation score cannot be directly computed by the chain rule. We proposed that when computing the conformation score, one of the sum operators should be replaced by a mean operator."
                    }
                },
                "number": 5,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission521/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700410488813,
                "cdate": 1700410488813,
                "tmdate": 1700410488813,
                "mdate": 1700410488813,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "wbo7ID5R2M",
            "forum": "Wn82BUF7jH",
            "replyto": "Wn82BUF7jH",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission521/Reviewer_vTuX"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission521/Reviewer_vTuX"
            ],
            "content": {
                "summary": {
                    "value": "This work proposes novel strategies to improve diffusion-based molecular conformation generation models to achieve more accurate probabilistic modeling and faster generation. The proposed strategies include use average operation in coordinate score calculation, and multiplying a hyperparameter \"scale\" in generation. The proposed methods improves GeoDiff and SDDiff in some metrics of molecular conformation generation tasks."
                },
                "soundness": {
                    "value": "2 fair"
                },
                "presentation": {
                    "value": "1 poor"
                },
                "contribution": {
                    "value": "2 fair"
                },
                "strengths": {
                    "value": "Originality: The proposed strategies in this paper is novel.  \nQuality: Experiments on benchmark datasets show the porposed strategies can improve recall rates of GeoDiff and SDDiff in molecular conformation generation.  \nClarity: No.  \nSignificance: The proposed strategies can be useful and enlightening for developping score-based diffusion models for molecular conformation generation."
                },
                "weaknesses": {
                    "value": "Major:  \n(1) Section 4.1 is not well-organized or logically smooth. It is hard to understand the overall process to obtain Equation (9) due to lack of clarification of many mathematical notations and motivations. Authors are encouraged to rewrite this section and give more clarification and explanation to the following questions:\n- What are the meanings of TM, TN, $\\pi_M, \\pi_N$ in Figure 1?\n- Why $f=\\pi_N\\circ d\\phi = \\phi \\circ \\pi_M$? What are the processes described by $\\pi_N\\circ d\\phi$ and $\\phi \\circ \\pi_M$?\n- Why $\\pi_M$ is chosen to be an identical mapping, $\\pi_N$ is chosen to be a GMD?\n- What does $e_{ij}$ mean in the formula of $\\hat{d}$, and how the formula of $\\pi_{M,\\tilde{d}}(\\hat{d})_{ij}$ and subsequently Equation (8) is derived?\n- In Appendix D.2 (proof of theorem 1), what is $\\lambda_{uv}$? Why does the second $\\le$ (from line 30b-30c to line 30d-30g) hold?\n\n(2) In Section  4.2, authors are recommended to clarify what is $\\tilde{C}_{t+\\lambda(s-t)}$? \n\nAlso, it would be better to discuss how much error will be introduced by the approximation $k_{s_\\theta}(d_s, s, t) \\approx k_{s_\\theta}(p_{data})$?  \n(3) It will make the experimental results stronger if authors do ablation study to verify that every single strategy can improve the performance. Also, authors are recommended to make an in-depth discussion about why the proposed method achieves poor performance in precision metric.\n\nMinor:  \nTypos: In abstract, \"develop more precise approximate\" --> \"develop more precise approximation\"  \nIn Section 2 first paragraph, \"so that the lengths of atom bounds\" --> \"such as the lengths of atom bonds\""
                },
                "questions": {
                    "value": "The proposed strategies are mainly used for diffusion models that calculate coordinate scores from distance scores. However, current state-of-the-art molecular conformation generation method, Torsional Diffusion [1], focusing on generating torsion angles. Can GeoDiff or SDDiff compete with Torsional Diffusion in generation speed when the proposed strategies are used? Can the proposed strategies or similar strategies be also applied to Torsional Diffusion?\n\n[1] Torsional Diffusion for Molecular Conformer Generation. NeurIPS 2022."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "3: reject, not good enough"
                },
                "confidence": {
                    "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 3,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission521/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1699147974287,
            "cdate": 1699147974287,
            "tmdate": 1699635979096,
            "mdate": 1699635979096,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "UNsLrqEWWf",
                "forum": "Wn82BUF7jH",
                "replyto": "wbo7ID5R2M",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission521/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission521/Authors"
                ],
                "content": {
                    "comment": {
                        "value": "We thank reviewer vTuX for giving feedback timely. Reviewer vTuX mainly has concerns about notation definitions, while we have explicitly defined them in the Appendix. But possibly due to our writing, one may find these notations confusing. We will re-organize our formula in the final version so that notations become more straightforward. We present our response as follows.\n\n> 1. What are the meanings of $\\mathrm{TM}, \\mathrm{TN}, \\pi_M, \\pi_N$ in Figure 1?\n\n$TM$ and $TN$ are tangent space of the manifold of $M$ and $N$, respectively. $\\pi_M$ and $\\pi_N$ are the projection function that receives a vector in the tangent space and project it into the manifold space. A detailed introduction of the differential geometry definitions and notations can be found in Appendix C.\n\n> 2. Why $f=\\pi_N \\circ d \\phi=\\phi \\circ \\pi_M$? What processes are described by $\\pi_N \\circ d \\phi$ and $\\phi \\circ \\pi_M$?\n\n$f$ is defined to be the mapping from $TM$ to $N$. There are two ways to transform from $TM$ to $N$. One is by $TM \\rightarrow TN \\rightarrow N$ and the other one is by $TM \\rightarrow M \\rightarrow N$. The former transformation is defined by the composition $\\pi_N \\circ d \\phi$ and the latter one is defined by $\\phi \\circ \\pi_M$. Hence, $f=\\pi_N \\circ d \\phi=\\phi \\circ \\pi_M$. Such a $f$ function is only defined to compute $d \\phi$ when the rest three functions are known. Such a method is commonly used in linear algebra such as when determining the properties of the quotient space.\n\n> 3. Why $\\pi_M$ is chosen to be an identical mapping, $\\pi_N$ is chosen to be a GMD?\n\n$C_t$ should always stay in the manifold $N$. Mathematically speaking, our reversed ODE should be replaced with a projected dynamical system in the form of $\\frac{\\mathrm{d} C_t}{\\mathrm{d} t}=\\Pi_N(C_t, -\\frac{1}{2} \\frac{\\mathrm{d} \\sigma_t^2}{\\mathrm{d} t} \\nabla_{C_t} \\log q_{0 t}\\left(C_t \\right))$, where $\\Pi_N(x, v)=\\lim_{\\delta \\rightarrow 0^{+}} \\frac{\\pi_N(x+\\delta v)-x}{\\delta}$. Comparing with the exact update form $\\frac{\\partial C_t}{\\partial t}=-\\frac{1}{2} \\frac{\\mathrm{d} \\sigma_t^2}{\\mathrm{~d} t} \\nabla_{C_t} \\log q_{0 t}\\left(C_t \\mid C_0\\right)$, we can take $\\pi_N$ to be the identical mapping.\n        \n$\\pi_N$ is the projection from the tangent space to the manifold. By the definition of the projection, we must project a matrix to a feasible adjacent matrix while minimizing the distance under a certain metric, which is essentially the same as the problem of the GMD.\n\n> 4. What does $e_{i j}$ mean in the formula of $\\hat{d}$, and how the formula of $\\pi_{M, \\tilde{d}}(\\hat{d})_{i j}$ and subsequently Equation (8) is derived?\n\n$e_{ij}$ is a square matrix such that its entry in the i-th row and j-th column equals 1 and the other entries equal to 0. The derivation for the Eq 8-9 can be found in the Appendix D.2. \n\n> 5. In Appendix D.2 (proof of theorem 1), what is $\\lambda_{u v}$ ? Why does the second $\\leq$ (from line $30 \\mathrm{~b}-30 \\mathrm{c}$ to line $30 d - 30 g$ ) hold?\n\n$\\boldsymbol{\\lambda}_{u v}=\\frac{\\tilde{\\mathbf{x}}_u-\\tilde{\\mathbf{x}}_v}{\\left\\|\\tilde{\\mathbf{x}}_u-\\tilde{\\mathbf{x}}_v\\right\\|}$, which can be found in the Appendix D.1. The second $\\leq$ should be $=$. We apologize for this typo and have corrected this in the manuscript.\n\n> 6. In Section 4.2, authors are recommended to clarify what is $\\tilde{C}_{t+\\lambda(s-t)}$ ?\n\nAfter one update, we are expecting that the sample follows the distribution w.r.t $p_t$. However, since there is some inevitable error in the denoising process, we consider such noise acts like applying a forward diffusion process on $C_t$ so that the sample follows the distribution for some $p_{t+\\lambda (s-t)}$, i.e., a time in the interval of $(t, s)$. \n\n> 7. Also, it would be better to discuss how much error will be introduced by the approximation $k_{s_\\theta}\\left(d_s, s, t\\right) \\approx k_{s_\\theta}\\left(p_{\\text {data }}\\right)$ ?\n\nThis is a good question. Unfortunately, we do not know how to do this so far and we leave it as a future work.\n\n> 8. It will make the experimental results stronger if authors do ablation study to verify that every single strategy can improve the performance.\n\nThanks for your suggestion, but it is not proper to conduct an ablation study. The main contribution of our work is to propose two **necessary** modifications for acceleration, which means that the absence of either one disables acceleration. Modification 1 (change ''add'' to ''mean'' on the transformation from distances to coordinates in Eq. 5) is a revision of the modeling to enable acceleration. In our experiment, the results are all from the models under Modification 1. Modification 2 (adds a multiplier ''scale'', $k_\\mathbf{s}$ to the sampling process) is necessary for fast sampling. We found that without $k_{\\mathbf{s}_{\\boldsymbol{\\theta}}}$, the fast sampling, i.e. sampling via DPM-Solver's proposed iteration in Eq. 4 will fail, and we conduct sampling via Langevin Dynamics (LD)."
                    }
                },
                "number": 3,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission521/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700394169079,
                "cdate": 1700394169079,
                "tmdate": 1700401918290,
                "mdate": 1700401918290,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "hyHlwiFyyW",
                "forum": "Wn82BUF7jH",
                "replyto": "wbo7ID5R2M",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission521/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission521/Authors"
                ],
                "content": {
                    "comment": {
                        "value": "> 9. Also, authors are recommended to make an in-depth discussion about why the proposed method achieves poor performance in precision metric.\n\nWe have put the analysis on Precision metrics on Sec.5.4. ''This is due to the deteriorating output of the network.'' We observe that part of the output occasionally starts exploding from a certain sampling iteration, which leads to some unstructured conformers corresponding to one molecule. The recall metrics are not affected much because they only consider the coverage status of ground truth, while precision metrics calculate all generated conformers. This phenomenon is observed for both LD sampling and our fast sampling method, especially when the step size or scale $k_{\\mathbf{s}_{\\boldsymbol{\\theta}}}$ is higher. More low-quality conformers are generated while sampling via the acceleration method, it is reasonable because fast sampling requires a larger step in each iteration, thus the precision metrics are worse. We think a stronger network or special design can solve the deteriorating output, but this is beyond the scope of this study. We'd like to conduct more stronger networks in further work.\n \n> 10. The proposed strategies are mainly used for diffusion models that calculate coordinate scores from distance scores. However, current state-of-the-art molecular conformation generation method, Torsional Diffusion [1], focusing on generating torsion angles. Can GeoDiff or SDDiff compete with Torsional Diffusion in generation speed when the proposed strategies are used? Can the proposed strategies or similar strategies be also applied to Torsional Diffusion?\n\nCurrent SOTA Torsional diffusion uses the RDkit to first generate the local structures and then apply the diffusion process on the torsional angles. Since they use the RDkit to generate the local structures, the main difficulties: considering the SE(3)-invariance is avoided. However, our method is a purely data-driven method, which cannot easily avoid the SE(3)-invariance. Hence, the computational speed is relatively slower than Torisonal diffusion's. Since the modeling manifold of the torsional diffusion is the torsion angle, which is greatly different from the distance manifold, hence, our method is inapplicable. However, for those generation tasks like cloud point generation, which takes SE(3)-invariance into consideration, our method applies to accelerate the reversed diffusion process.\n\n> 11. About typos.\n\nThank you for bringing those typos to our attention. We are committed to making corrections."
                    }
                },
                "number": 4,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission521/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700394390681,
                "cdate": 1700394390681,
                "tmdate": 1700401708791,
                "mdate": 1700401708791,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "7zcYiZbEKV",
                "forum": "Wn82BUF7jH",
                "replyto": "hyHlwiFyyW",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission521/Reviewer_vTuX"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission521/Reviewer_vTuX"
                ],
                "content": {
                    "title": {
                        "value": "Follow-up Response"
                    },
                    "comment": {
                        "value": "I appreciate authors' work in addressing my questions and concerns.\n\n- As agreed by authors, the math notation and organization of methodology part, particularly Section 4.1, is not good and unfriendly to readers who are not familiar with differentiable geometry. Hence, I strongly encourage authors to rewrite this part and make them organize well. I do not think leaving the definitions of some notations to Appendix is a good idea. I encourage authors to upload the revised version of the paper if it is ready.\n- By asking for an in-depth discussion about why the proposed method achieves poor performance in precision metric, I am actually asking reasons why \"part of the output occasionally starts exploding from a certain sampling iteration\". Particularly, this phenomenon happens for both the proposed method and LD, but it seems to happen more frequently for the proposed method, as the precision metric is lower than LD baseline. It leads to some concerns that the the proposed method accelerates the generation speed with a cost of significantly decreasing the model robustness and the quality of generated conformations. I hope authors can give an in-depth discussion to it, and some theoretic analysis about model robustness (the frequency of output exploding) if possible."
                    }
                },
                "number": 9,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission521/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700434156468,
                "cdate": 1700434156468,
                "tmdate": 1700434156468,
                "mdate": 1700434156468,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    }
]