[
    {
        "title": "Knowledge Distillation for Closed-Source Language Models"
    },
    {
        "review": {
            "id": "BOXfqOmOjU",
            "forum": "oj4KUNoKnf",
            "replyto": "oj4KUNoKnf",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission2382/Reviewer_4c71"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission2382/Reviewer_4c71"
            ],
            "content": {
                "summary": {
                    "value": "The paper develops a  Bayesian estimation-based knowledge distillation method to alleviate the limitation of traditional knowledge distillation methods."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "3 good"
                },
                "strengths": {
                    "value": "1. The developed Bayesian estimation-based knowledge distillation method is technical sounds and can contribute to improve the performance of knowledge distillation\n2. The organize and writing of this paper is good"
                },
                "weaknesses": {
                    "value": "1. The main shortcoming is the motivation of technical details is not clear to me, which will also confuse the readers."
                },
                "questions": {
                    "value": "Thanks for your awesome work. The authors propose a Bayesian estimation-based knowledge distillation method to alleviate the limitation of traditional knowledge distillation methods. And I really appreciate this work because the uncertainty plays an important role in language generation and  Bayesian based distribution estimation can be naturely used to solve this problem\n\nI have captured the main idea of this paper, but get lost in the motivation of technical details\n\n1. For prior estimation, I understand it as the authors wanna to obtain the probs of hard lable provided by close-form LLMs. The main question is how the authors to collect the corpus $C$, and will you use the given sequence (w_t, ..., I) as the prompt?\n\n2. For posterior estimation, what is the motivation of this part. I do understand why you update prior here. Moreover, why you process iteratively sampling on open-source LLMs to obtain the posterior distribution of given token? Further, for  open-source LLMs, the probs accross the whole vocabulary can be directly obtained and do need to be calculated like the estimation in Eq.2 and Eq.3\n\n3. Why you use KL as loss function, will it be different from cross entroy loss in normal LLMs training?"
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "6: marginally above the acceptance threshold"
                },
                "confidence": {
                    "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 1,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission2382/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698758268357,
            "cdate": 1698758268357,
            "tmdate": 1699636173323,
            "mdate": 1699636173323,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "F5cGSoVLVZ",
                "forum": "oj4KUNoKnf",
                "replyto": "BOXfqOmOjU",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission2382/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission2382/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Official Comment by Authors"
                    },
                    "comment": {
                        "value": "We sincerely appreciate the time and effort you put into reviewing our paper. And we are grateful that you find our work to be technically sound.\n\n> Q1: How the authors to collect the corpus $\\mathcal{C}$, and will you use the given sequence $(w_t,\\dots,I)$ as the prompt?\n\nA1: The corpus $\\mathcal{C}$ is pre-collected by other works, so we do not collect it ourselves. The corpus $\\mathcal{C}$ mainly utilized in this paper is the OpenOrca (Mukherjee et al., 2023) dataset, which itself consists of 1 million samples generated by GPT-4. Specifically, OpenOrca was created by prompting GPT-4 with diverse inputs and collecting the corresponding output sequences. We will incorporate this clarification in the updated version of the paper.\n\n> Q2: For posterior estimation, what is the motivation of this part? I do understand why you update prior here. Why you process iteratively sampling on open-source LLMs to obtain the posterior distribution of given token?\n\nA2: To perform knowledge distillation in traditional approaches, we propose to estimate the output distributions of closed-source LLMs within a Bayesian estimation framework, which includes both prior and posterior estimation. For a specific text input, prior estimation leverages the corpus generated by closed-source language models to derive a coarse-grained approximation for the distribution of the output. Meanwhile, posterior estimation relies on another open-source LLM as a proxy to fine-tune the results of prior estimation. This proxy model serves as a bridge between the teacher (closed-source) and the student (open-source) models, as illustrated in Figure 1. Therefore, the proxy model is selected to be a larger language model than the student model and is initially aligned with the closed-source teacher model using the aforementioned corpus. Finally, we perform knowledge distillation using the estimated output distributions of the closed-source teacher LLM. We will include the above clarification in the updated version of the paper.\n\n> Q3: Further, for open-source LLMs, the probs can be directly obtained and do not need to be calculated like the estimation in Eq.2 and Eq. 3.\n\nA3: We would like emphasize the motivation behind this paper as follows. This paper focuses on enhancing the capabilities of smaller models through knowledge distillation from closed-source language models. However, due to the incapability to directly access the weights, hidden states, and output distributions of these closed-source models, we propose to estimate the output distributions of closed-source language models within a Bayesian estimation framework. By leveraging the estimated output distribution of closed-source language models, traditional knowledge distillation can be executed.\nTherefore, the underlying assumption and premise of this paper is that we are unable to access the prediction distributions of closed-source LLMs.\n\n> Q4: Why you use KL as loss function, will it be different from cross-entropy loss?\n\nA4: In certain cases, the KL loss will differ from the cross-entropy loss. Specifically, when the provided labels are in one-hot form, the KL loss essentially becomes the cross-entropy loss. Whereas, when the labels are represented as a normal distribution rather than in one-hot form, the two loss functions are different and the KL loss is typically employed.\n\nWe appreciate the time and effort invested by the reviewer. We hope the above discussions adequately address your concerns."
                    }
                },
                "number": 1,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission2382/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700616653748,
                "cdate": 1700616653748,
                "tmdate": 1700632699957,
                "mdate": 1700632699957,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "wguR29zvLH",
            "forum": "oj4KUNoKnf",
            "replyto": "oj4KUNoKnf",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission2382/Reviewer_gDYz"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission2382/Reviewer_gDYz"
            ],
            "content": {
                "summary": {
                    "value": "This paper studies knowledge distillation from blackbox large language models to improve zero-shot performance of a student LM. It proposes to estimate the inaccessible output distribution of an LLM and use estimated distributions as the supervision signal for a student LM. It estimates the distribution of a corpus generated by the teacher model. Then it derives a posterior distribution by continued sampling from a proxy of the teacher model. The method appears more effective finetuning the student on teacher-generated corpora and instruction finetuning."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "2 fair"
                },
                "contribution": {
                    "value": "2 fair"
                },
                "strengths": {
                    "value": "- The method aims to improve general-purpose language models and perform zero-shot evaluation on multiple tasks. This is valuable and general.\n- The distillation method based on distribution estimation appears effective. Experiments and analyses are reported on several recent datasets.\n- Ablation study about method components, sampling rounds, and corpus size is provided."
                },
                "weaknesses": {
                    "value": "- It'd be helpful to include a table that summarizes the training data for each model at each training stage.\n- While the results are appealing, there exist key questions to be addressed about why and how the method works. Please refer to Questions."
                },
                "questions": {
                    "value": "1. Is the student trained only on the teacher generated text, or also some ground truth corpora?\n2. Is both the cross-entropy loss and the **prior distribution** loss necessary? If we remove $gamma$, then the prior distribution is the same as the teacher-generated corpus distribution. Training on the entire corpus via cross-entropy appears the same as fitting the prior distribution.\n3. The $gamma$ term can smooth the distribution. Is the prior estimation step novel or basically the same as label smoothing?\n4. Assume the teacher distributions are available in the **posterior estimation** step, and there is no need to learn a proxy model. Will sampling from this teacher to get a posterior distribution help? You could run an experiment where the teacher is open-sourced. Will the posterior distribution be the same as the teacher-generated corpus distribution?\n5. Does the improvement from adding the posterior distribution actually due to the ensemble of the teacher and the proxy model?\n6. How important is the choice of the proxy model? Can you compare multiple options, present how well they fit the teacher model, their performance on held-out data compared to the teacher model, and how they affect the student performance?"
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "5: marginally below the acceptance threshold"
                },
                "confidence": {
                    "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 2,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission2382/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698831813096,
            "cdate": 1698831813096,
            "tmdate": 1699636173186,
            "mdate": 1699636173186,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "DrU7C1Zr7q",
                "forum": "oj4KUNoKnf",
                "replyto": "wguR29zvLH",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission2382/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission2382/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Official Comment by Authors (Part 1)"
                    },
                    "comment": {
                        "value": "We are grateful for the valuable suggestions and questions raised by the reviewer. We hope that the following responses can effectively address your concerns.\n\n> Q1: It\u2019d be helpful to include a table that summarizes the training data for each model at each training stage.\n\nA1: We appreciate your suggestion. In the revised version of our paper, we will include the table below, summarizing the training data used for each model at each stage. Specifically, OpenOrca denotes the OpenOrca corpus (Mukherjee et al., 2023), while Alpaca represents the Alpaca corpus (Taori et al., 2023). Thank you for bringing attention to this important aspect.\n\n| Models | Prior Estimation Stage | Posterior Estimation Stage | Training Stage |\n| ---- | :----: | :----: | :----: |\n| LLaMA-7B (IFT) (Table 2) | - | - | OpenOrca |\n| LLaMA-7B (IFT) (Table 2) | OpenOrca | OpenOrca | OpenOrca |\n| OpenOrca-Preview1-13B (Table 2) | - | - | OpenOrca |\n| LLaMA-13B (IFT) (Table 2) | - | - | OpenOrca |\n| LLaMA-13B (ours) (Table 2) | OpenOrca  | OpenOrca  | OpenOrca |\n| LLaMA-33B (Proxy Model) (Table 2) | - | - | OpenOrca |\n| Alpaca-7B (Table 3) | - | - | Alpaca|\n| LLaMA-7B (ours) (Table 3) | Alpaca| Alpaca| Alpaca |\n| Alpaca-13B (Table 3) | - | - | Alpaca|\n| LLaMA-7B (ours) (Table 3) | Alpaca| Alpaca| Alpaca |\n| LLaMA-33B (Proxy Model) (Table 3) | - | - | Alpaca|\n\n> Q2: Is the student trained only on the teacher generated text, or also some ground truth corpora?\n\nA2: In our experiment, all the student models and the proxy model are exclusively trained on the text generated by the closed-source teacher model. If a ground truth corpus is available, the loss between the ground truth labels and the student's predictions can be incorporated into the total loss. We will clarify this in the revised paper.\n\n> Q3: Is both the cross-entropy loss and the prior distribution loss necessary? If we remove $\\gamma$, then the prior distribution is the same as the teacher-generated corpus distribution. Training on the entire corpus via cross-entropy appears the same as fitting the prior distribution.\n\nA3: We would like to clarify that the prior distribution is distinct from the teacher-generated corpus distribution. The former is an initially estimated distribution of the closed-source LLM's output, while the latter refers to the output sequence in the form of hard labels.\n\n> Q4: Is the prior estimation step novel or basically the same as label smoothing?\n\nA4: To perform knowledge distillation in traditional approaches, we propose to estimate the output distributions of closed-source LLMs within a Bayesian estimation framework, which includes both prior and posterior estimation. For a specific text input, prior estimation leverages the corpus generated by closed-source language models to derive an initial approximation for the distribution of the output. Therefore, we can note that prior estimation draws inspiration from traditional n-gram language modeling, with label smoothing serving as just a component addressing the challenges associated with zero probabilities, particularly as n becomes large, within this comprehensive framework. Therefore, it is crucial to recognize that prior estimation differs from label smoothing in both their forms and purposes. We will clarify this in the updated paper.\n\n> Q5: Assume the teacher distributions are available in the posterior estimation step. Will sampling from this teacher to get a posterior distribution help? Will the posterior distribution be the same as the teacher-generated corpus distribution?\n\nA5: We address this question from three perspectives. \n- Firstly, in theory, we can prompt the closed-source teacher model to sample the next token. However, due to the high cost of API calls, in practice, we resort to the use of proxy model instead. \n- Secondly, given that the primary motivation of this paper is to estimate the output distributions of closed-source LLMs (teacher) within a Bayesian estimation framework, the need for conducting posterior estimation would be obviated if the teacher distributions are readily available. \n- Thirdly, posterior estimation relies on the proxy model to refine the results of prior estimation. This proxy model functions as a crucial link between the teacher (closed-source) and the student (open-source) models. If the teacher distributions were indeed available, it would undoubtedly be preferable to sample from this distribution rather than relying on the proxy model's distribution."
                    }
                },
                "number": 2,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission2382/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700617888008,
                "cdate": 1700617888008,
                "tmdate": 1700634299655,
                "mdate": 1700634299655,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "5Cnll5B0E0",
                "forum": "oj4KUNoKnf",
                "replyto": "wguR29zvLH",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission2382/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission2382/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Official Comment by Authors (Part 2)"
                    },
                    "comment": {
                        "value": "> Q6: Does the improvement from adding the posterior distribution actually due to the ensemble of the teacher and the proxy model?\n\nA6: The observed improvement could be attributed to some ensemble effect, yet there are fundamental distinctions. \n- Firstly, ensemble methods necessitate the execution of multiple models during inference, whereas knowledge distillation only requires the application of the student model. \n- Secondly, although the student model learns from both the closed-source teacher model and the proxy model, akin to multi-teacher knowledge distillation, the primary purpose of the proxy model is to act as a bridge between the closed-source teacher and the open-source student. This underscores the significance of a pre-alignment between the proxy and the teacher models.\n\n> Q7: The choice of the proxy model. Compare multiple options, present how well they fit the teacher model, and their performance on held-out data, and how they affect the student performance.\n\nA7: Thank you for your valuable suggestion. We believe that opting for a larger and more capable proxy model is advantageous, as it enhances the model's ability to capture the capabilities of the closed-source LLM. Taking into consideration this factor, along with the constraints posed by computational resources and time limitations, we have selected LLaMA-33B as the proxy model for our experiments. In response to the raised question, we have also explored alternative options.\n\nThe table below presents the performance of both the closed-source teacher (GPT-4) and the proxy models (LLaMA-33B and LLaMA-13B):\n\n| Models | BBH | AGIEval | MMLU | GSM8K |\n| ---- | :----: | :----: | :----: | :----: |\n| GPT-4 (teacher) | 67.4 | 56.4 | 86.4 | 92.0 |\n| LLaMA-33B (proxy) | **51.7** | **33.5** | **55.7** | **42.2** |\n| LLaMA-13B (proxy) | 42.8 | 26.7 | 45.3 | 20.9 |\n\nFurthermore, we employed LLaMA-7B as the student model and compared its performance with different proxy models (LLaMA-33B and LLaMA-13B) in the table below:\n\n| Models | Proxy Models | BBH | AGIEval | MMLU | GSM8K |\n| ---- | ---- | :----: | :----: | :----: | :----: |\n| LLaMA-7B (student) | LLaMA-33B (proxy) | **38.52** | **26.92** | **41.18** | **14.97** |\n| LLaMA-7B (student) | LLaMA-13B (proxy) | 37.41 | 25.67 | 39.56 | 13.83 |\n\nThe results validate the earlier assumption. We will incorporate these new experiments into the updated version of the paper."
                    }
                },
                "number": 3,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission2382/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700618593087,
                "cdate": 1700618593087,
                "tmdate": 1700634564949,
                "mdate": 1700634564949,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "M9lh8Q2N0X",
            "forum": "oj4KUNoKnf",
            "replyto": "oj4KUNoKnf",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission2382/Reviewer_Ryd9"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission2382/Reviewer_Ryd9"
            ],
            "content": {
                "summary": {
                    "value": "The paper proposes a knowledge distillation method for closed-source large language models, such as distilling GPT to other public LLMs."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "2 fair"
                },
                "strengths": {
                    "value": "- The paper is easy to read and follow."
                },
                "weaknesses": {
                    "value": "- The motivation is not significant enough. If we would like to compress our large models, we usually can directly access the prediction distribution. It's unsure whether distilling other closed-source models is a reasonable research topic, which often violates the usage policies of closed-source LLMs.\n\n- The performance gain seems marginal compared with baselines.\n\n- Only 7B/13B pre-trained models are tuned in the experiments.\n\n- The cost is not discussed in the paper."
                },
                "questions": {
                    "value": "- The motivation is not significant enough. If we would like to compress our large models, we usually can directly access the prediction distribution. It's unsure whether distilling other closed-source models is a reasonable research topic, which often violates the usage policies of closed-source LLMs. More explanations about motivation can be discussed.\n\n- The performance gain seems marginal compared with baselines. The significance of the method can be better described.\n\n- Only 7B/13B pre-trained models are tuned in the experiments. Larger-size models can be added in the experiments.\n\n- Only pre-trained models are tuned in the experiments. Can we use the method to train the models from scratch?\n\n- The cost can be discussed in the paper."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "5: marginally below the acceptance threshold"
                },
                "confidence": {
                    "value": "5: You are absolutely certain about your assessment. You are very familiar with the related work and checked the math/other details carefully."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 3,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission2382/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698891563995,
            "cdate": 1698891563995,
            "tmdate": 1699636173079,
            "mdate": 1699636173079,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "IcdrLDlcBo",
                "forum": "oj4KUNoKnf",
                "replyto": "M9lh8Q2N0X",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission2382/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission2382/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Official Comment by Authors"
                    },
                    "comment": {
                        "value": "We are grateful that the reviewer find our paper to be a good read. And we appreciate the time and effort the reviewer put into reviewing our paper. We hope that the following responses can address your concerns.\n\n> Q1: The motivation is not significant enough. It\u2019s unsure whether distilling other closed-source models is a reasonable research topic, which often violates the usage policies of closed-source LLMs.\n\nA1: We would like to emphasize that the motivation behind this paper is both clear and significant. In recent months, there has been a trend focused on transferring the capabilities of closed-source LLMs like GPT-4 and GPT-3.5 into open-source models. Notable studies, including Alpaca (Taori et al., 2023), Vicuna (Chiang et al., 2023), WizardLM (Xu et al., 2023), and OpenOrca (Mukherjee et al., 2023), have dedicated efforts toward this objective, primarily through fine-tuning on samples generated by closed-source LLMs. However, these approaches only enable open-source language models to minic the input-output behavior of closed-source LLMs without acquiring their intrinsic knowledge related to logits, weights, activations, and other relevant aspects. In contrast, we propose to estimate the output distributions of closed-source LLMs within a Bayesian estimation framework and perform traditional knowledge distillation.\n\n> Q2: The performance gain seems marginal compared with baselines.\n\nA2: Indeed, within the domain of knowledge distillation, previous works like TinyBert (Jiao et al., 2020), PKD (Sun et al., 2019), BERT-of-Theseus (Xu et al., 2020), and MGSKD (Liu et al., 2022) have typically shown an average performance gain of approximately 1-2 points. In contrast, our main results, as depicted in Table 2, indicate a more significant average performance gain of about 2-3 points over the baseline models. This discrepancy is noteworthy, underscoring a non-marginal improvement in the field of knowledge distillation.\n\n> Q3: The cost is not discussed.\n\nA3:  Thanks for the suggestion. We conducted all our model training on NVIDIA V100 GPUs equipped with 32GB memory. The table below presents the GPU and time costs per epoch for various models trained on the OpenOrca dataset. This detailed information will be included in the revised version of our paper.\n\n| Models | #GPUs | Hours/Epoch |\n| ---- | :----: | :----: |\n| LLaMA-7B | 4 | 17.0 |\n| LLaMA-13B | 8 | 15.5 |\n| LLaMA-33B | 8 | 40.0 |\n\n> Q4: Only 7B/13B are tuned. Larger-size models can be added.\n\nA4: We would like to clarify this question as follows. The primary goal of knowledge distillation is to transfer knowledge from large teacher models to smaller student models. Additionally, the choice of the proxy model as LLaMA-33B is made to serve as a bridge between the closed-source teacher model and the student model, thereby limiting our options in terms of the size of the student model. Consequently, we opted for the 7B and 13B LLaMA as our student models.\n\n> Q5: Can we use the method to train the models from scratch?\n\nA5: In theory, it is feasible to train the student model from scratch using the proposed method, akin to other knowledge distillation approaches. However, practical considerations arise since pre-training corpora often differ in size and domains from knowledge distillation datasets, and these disparities may introduce challenges. Consequently, knowledge distillation commonly relies on a pre-trained student model.\n\nWe once again thanks the valuable suggestions and questions raised by the reviewer."
                    }
                },
                "number": 4,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission2382/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700619285279,
                "cdate": 1700619285279,
                "tmdate": 1700635163253,
                "mdate": 1700635163253,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "blNb5iViOR",
            "forum": "oj4KUNoKnf",
            "replyto": "oj4KUNoKnf",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission2382/Reviewer_QK8L"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission2382/Reviewer_QK8L"
            ],
            "content": {
                "summary": {
                    "value": "When we apply knowledge distillation to a closed-source language model, we cannot access probability for each token in the vocabulary. This paper proposes ways to estimate these probabilities. Specifically, \"prior\" probability can be estimated via fitting an n-gram on the generated corpus (by the closed-source language model). Then the authors further propose to estimate \"posterior\" probability by sampling a proxy open-source language model. The distillation loss is a combination of KL divergences between the token probabilities of student model, and 1) one-hot target; 2) \"prior\"; 3) \"posterior\". Experiments suggest adding 2 and 3 is beneficial."
                },
                "soundness": {
                    "value": "2 fair"
                },
                "presentation": {
                    "value": "2 fair"
                },
                "contribution": {
                    "value": "3 good"
                },
                "strengths": {
                    "value": "Overall, the method seems novel. The probabilities of tokens generated from teacher model is crucial for knowledge distillation. The paper proposes some interesting techniques to estimate it when the teacher model is a blackbox."
                },
                "weaknesses": {
                    "value": "A major concern is clarity. Section 3.2.1 and 3.2.2 are not clearly written. In Eq (4), what is the exact form of $f_{W_t}(\\cdot)$. Morever, after reading section 3.2.2, it is not clear to me how exactly the \"posterior\" is updated, especially when the form of $f_{W_t}(\\cdot)$ is not given. \nSee more weakness in questions below."
                },
                "questions": {
                    "value": "1. The author uses n-gram on teacher generated corpus to estimate the \"prior\". How robust is the result w.r.t. the order $n$? How big is the generated corpus? Are there many $w_t$ such that #$(w_t, w_{t-1}^\\prime, \\dots, w_{t-n}^\\prime)=0$?  Is it necessary to apply smoothing? Also, according to Eq. (2) and (3), $\\sum_{w_t}p_{w_t}\\neq 1$, which seems unusual.\n\n2. Estimating the \"posterior\" relies on a proxy model. A relevant stream of work is using teacher assistant models. See for example, https://arxiv.org/pdf/1902.03393.pdf . The authors should at least discuss the connection."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "6: marginally above the acceptance threshold"
                },
                "confidence": {
                    "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 4,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission2382/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1699567488305,
            "cdate": 1699567488305,
            "tmdate": 1699636172921,
            "mdate": 1699636172921,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "FJXZVer2iV",
                "forum": "oj4KUNoKnf",
                "replyto": "blNb5iViOR",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission2382/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission2382/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Official Comment by Authors"
                    },
                    "comment": {
                        "value": "We sincerely thank you for the time and effort you have put into reviewing our paper. We appreciate your insightful feedback and are pleased that you find our work to be novel.\n\n> Q1: It is not clear to me how exactly the \u201cposterior\u201d is updated, especially when the form of $f_{W_t}$ is not given.\n\nA1: The general idea of posterior estimation is to utilize the output distributions of the proxy model for calibrating the coarse-grained prior distribution. The process of posterior updating is to update according to the conditional probability formula, such as calculating the likelihood and prior, etc. It will be easier to understand with a discrete case example. To explain the process more clearly, we have reorganized this section and will incorporate the updates in the revised version of the paper.\n\n> Q2: How robust is the results w.r.t. the order n?\n\nA2: Intuitively, the order of n should be selected within a limited range. To confirm this, we conduct experiments distilling on the prior distribution with LLaMA-7B under different order of n, as shown in the table below:\n\n| Models | Order of n | BBH | AGIEval | MMLU | GSM8K |\n| ---- | :----: | :----: | :----: | :----: | :----: |\n| GPT-4 (teacher) | - | 67.4 | 56.4 | 86.4 | 92.0 |\n| LLaMA-7B (IFT) | - | 36.8 | 24.14 | 38.81 | 12.65 |\n| LLaMA-7B (ours) | 3 | **37.3** | 25.53 | **40.1** | **13.1** |\n| LLaMA-7B (ours) | 5 | **37.3** | **25.7** | **40.1** | **13.1** |\n| LLaMA-7B (ours) | 8 | **37.3** | 24.48 | 39.6 | 13.0 |\n| LLaMA-7B (ours) | 100 | 36.2 | 24.3 | 38.79 | 12.7 |\n\nThe results indicate that n should not be too large. Empirically, we set n=5 in this study. We will also conduct experiments on the posterior distribution distillation and will incorporate the results when updating the paper.\n\n> Q3: How big is the generated corpus?\n\nA3: The generated corpus utilized in this paper comprises 200,000 samples randomly selected from the original OpenOrca (Mukherjee et al., 2023) dataset, which itself contains 1 million samples generated by GPT-4. We will incorporate this clarification in the updated version of the paper.\n\n> Q4: Are there many $w_t$ such that $\\\\#(w_t,w_{t-1}', ..., w_{t-n}')=0$?\n\nA4: Indeed, that is a valid concern with the n-gram method, particularly when n becomes large. To address this, the order of n is set to 5 to mitigate such cases. Additionally, it's important to note that the prior distribution serves as a coarse-grained estimate, acknowledging scenarios where $\\\\#(w_t,w_{t-1}',\\dots,w_{t-n}')=0$, obviating the need of label smoothing. For a more fine-grained estimate, posterior estimation is employed.\n\n> Q5: According to Eq. 2 and 3, $\\sum_{w_t}{p_{w_t}}\\neq 1$.\n\nA5: Thanks for your concern. We would like to demonstrate that $\\sum_{w_t\\in \\mathbb{V}}p_{w_t}=1$. We first ensure $\\sum_{w_t\\in \\mathbb{V}}\\\\#(w_t, w_{t-1}', \\dots, w_{t-n}')=\\\\#(w_{t-1}', \\dots, w_{t-n}')$. Then, according to Eq. 2 and Eq. 3, we have:\n\n\\begin{equation}\n\\sum_{w_t\\in \\mathbb{V}}p_{w_t} = \\frac{\\sum_{w_t\\in \\mathbb{V}, w_t\\neq w_t'}{\\\\#(w_t, w_{t-1}', \\dots, w_{t-n}')}}{\\gamma\\\\#(w_{t-1}', \\dots, w_{t-n}')} + \\frac{\\\\#(w_t', w_{t-1}', \\dots, w_{t-n}')}{\\gamma\\\\#(w_{t-1}', \\dots, w_{t-n}')} + \\frac{\\gamma-1}{\\gamma} \n          = \\frac{\\sum_{w_t\\in \\mathbb{V}}{\\\\#(w_t, w_{t-1}', \\dots, w_{t-n}')}}{\\gamma\\\\#(w_{t-1}', \\dots, w_{t-n}')} + \\frac{\\gamma-1}{\\gamma}\n         = \\frac{1}{\\gamma} + \\frac{\\gamma-1}{\\gamma} = 1\n\\end{equation}\n\n> Q6: A relevant stream of work is using teacher assistant models. The authors should at least discuss the connection.\n\nA6: Indeed, the proxy model serves a role akin to teacher assistant models (Mirzadeh et al., 2019). Our work shares similarities with theirs in two aspects: (1) both address the challenge of knowledge distillation, and (2) both introduce an intermediate network. However, there are notable distinctions. \n- Firstly, teacher assistant models aim to bridge the gap in model sizes between the teacher and the student, whereas the proxy model in this work seeks to facilitate the distillation of closed-source language models. Hence, pre-alignment between the proxy and the teacher models is deemed necessary. \n- Secondly, the proxy model operates by calibrating the prior distribution obtained from a generated corpus by closed-source language models.\n\nWe are grateful for the valuable suggestions and questions raised by the reviewer. We hope the above points adequately address each of your concerns."
                    }
                },
                "number": 5,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission2382/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700622572273,
                "cdate": 1700622572273,
                "tmdate": 1700636337552,
                "mdate": 1700636337552,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    }
]