[
    {
        "title": "Multimarginal Generative Modeling with Stochastic Interpolants"
    },
    {
        "review": {
            "id": "xDGvP805e9",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission9021/Reviewer_yfUs"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission9021/Reviewer_yfUs"
            ],
            "forum": "FHqAzWl2wE",
            "replyto": "FHqAzWl2wE",
            "content": {
                "summary": {
                    "value": "Multimarginal problems are typically studied in the context of optimal transport, by contrast, the authors studied the multimarginal problem using stochastic interpolant with a high-dimensional \u03b1 in a simplex. The multimarginal framework allows us to (K, 2) marginal transport problems using only K marginal vector fields. Interesting experiments on all-to-all image translation are studied."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "2 fair"
                },
                "strengths": {
                    "value": "1. by lifting alpha to high-dimensional vector, the work enables to solve (K,2) marginal transport problems using only K marginal vector fields.\n\n2. the overall presentation is clear and the empirical experiments are comprehensive."
                },
                "weaknesses": {
                    "value": "Optimizing the vector field on simplex alpha may require delicate parameterizions. It would be better if it is more connected optimal transport.\n\nThe theories look like a na\\\"ive extension from the work of \"Stochastic Interpolants: A Unifying Framework for Flows and Diffusions\". The authors can kindly point out some innovations if I may miss some key points.\n\nSection 2.2 may need some proper rewriting to be more clear."
                },
                "questions": {
                    "value": "Table.1, what does the smoothing mean in \"two-marginal with smoothing\" ?\n\n\nMinor:\n\ntypo? \"color from a sample from a sample from one marginal\""
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "5: marginally below the acceptance threshold"
                },
                "confidence": {
                    "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 1,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission9021/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1697211238982,
            "cdate": 1697211238982,
            "tmdate": 1699637136811,
            "mdate": 1699637136811,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "NXV2rL58AV",
                "forum": "FHqAzWl2wE",
                "replyto": "xDGvP805e9",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission9021/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission9021/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Reply to reviewer yfUs"
                    },
                    "comment": {
                        "value": "We thank reviewer yfUs for their feedback. We are glad that the reviewer found our presentation clear and our experiments comprehensive.  The reviewer, however, had concerns about the intrerpretability, utility, and novelty that we now address.\n\n***Optimization on the simplex:*** The approach has precisely the advantage that it allows us to *solve the OT problem in a simulation free way on the simplex.* This is because we precompute (via quadratic regression) the conditional expectations $g_k(\\alpha,x) = \\mathbb{E}[x_k| x(\\alpha)]$ where $x(\\alpha) = \\sum_{k=1}^K \\alpha_k x_k$ and $x_k\\sim\\rho_k$. Having access to these conditional expectations allows us to calculate the transport cost along any transportation path parameterized by $\\alpha(t)$ without having to perform any retraining and without having to solve an ODE: it is completely simulation-free in that respect. In turn, this allows us to optimize the path-parameterization $\\alpha(t)$ to reduce the transportation cost. Of course, this only achieves OT within a specific parametric class  of velocities (i.e. those that transport samples on the simplex toward the PDF of any $x(\\alpha) =  \\sum_{k=1}^K \\alpha_k x_k$), but it is still a nontrivial advance. \n\n***Na\u00efve extension:*** While the results follow quite naturally from the stochastic interpolant framework, they also constitute a nontrivial generalization of it. In particular, by showing that interpolation can be done in a multi-way fashion, we break from the standard perspective (used e.g. in score based diffusion models) in which the bridging betwen two distributions is itself defined via a time-dependent process (for example, a forward SDE that needs then to be reversed in time for generation). The original stochastic interpolant framework already showed that we can decouple the bridging of the densities from the generation process used afterwards; the multimarginal framework that we propose goes a step further in this direction by showing that the bridging itself does not need to use a  scalar time variable but rather can be made muti-way using a vector of $\\alpha=(\\alpha_1,\\ldots,\\alpha_K)$.\n\n***Questions and typos***: Thanks for pointing out a few unclear phrases. In the text, we will clarify that \"2-marginal with smoothing\" refers to the case of having an interpolant $x(\\alpha) = \\alpha_0 x_0 + \\alpha_1 x_1 + \\alpha_2 z$ where $z$ is a Gaussian random variable that is independent of $(x_0, x_1)$. That is, there are three marginals, a density $\\rho_0$, a density $\\rho_1$, and a Gaussian density $\\rho_2 = \\rho_z$. For a parametric path in which $\\alpha_2(t) > 0$ when $t \\neq 0,1$, this corresponds to the Gaussian \"smoothed\" interpolant from [1]. On the simplex, it resembles the simplicial coordinate moving toward the top vertex of a triangle (which corresponds to $\\rho_z$ in the illustration given in the table)."
                    }
                },
                "number": 11,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission9021/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700608015125,
                "cdate": 1700608015125,
                "tmdate": 1700608015125,
                "mdate": 1700608015125,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "YcEvppEiop",
            "forum": "FHqAzWl2wE",
            "replyto": "FHqAzWl2wE",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission9021/Reviewer_2Wkn"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission9021/Reviewer_2Wkn"
            ],
            "content": {
                "summary": {
                    "value": "The paper introduces a vector-field-based generative model (incorporating ODE/SDE mechanisms) capable of generating samples from multiple marginal distributions. The methodology pivots around a generalized form of stochastic interpolant, specifically a barycentric stochastic interpolant. The stochastic process, in this context, is formulated as a weighted mix of samples from distinct marginal distributions. These weights, restricted to the simplex, allow the model to generate a weighted combination, defined as $x(\\alpha)=\\sum_{k=0}^K x_k \\alpha_k$, where $\\alpha=\\left(\\alpha_0, \\ldots, \\alpha_K\\right) \\in \\Delta^K$. The corresponding probability flows are derived for this multi-weight interpolant path. To identify the optimal path with the lowest transport cost, the model is trained to minimize the Wasserstein-2 metric, considering the path's velocities. Consequently, this learned model allows transitions between various marginal distributions following the optimized path. However, the semantic interpretation of these paths, especially between distributions like images from multiple modes, remains ambiguous. In the experiments,"
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "3 good"
                },
                "strengths": {
                    "value": "- *Innovative Generative Model*: The paper's proposition of a vector-field-based generative model that utilizes a generalized form of stochastic interpolant to generate from multiple marginals is unique and intriguing.\n- *Optimal Path Identification*: By minimizing the Wasserstein-2 metric, the methodology seeks the most efficient path for transitions, with theoretical groundings.\n- *Barycentric Stochastic Interpolant*: The use of a barycentric stochastic interpolant offers a nuanced approach, ensuring the weights adhere to a simplex and providing a structured method to learn to interpolate samples from different distributions."
                },
                "weaknesses": {
                    "value": "- *Ambiguous Interpretation*: The paper does not provide a clear semantic understanding of the paths between distributions, making it difficult to ascertain the practical implications or the broader relevance of the methodology. Also, what does multi-marginal optimal transport path mean for image generation? Does it lead to better quality? In this paper, it is not answered.\n- *Unknown Utility*: There's a lack of clarity on the potential use-cases for this generative model. For instance, if it's geared towards style transfer, it's essential to determine which style gets preserved and how it compares with existing baselines in that domain.\n- *Novelty*: The novelty of doing stochastic interpolant for multiple marginal distributions is limited given that it is done for the two marginal case. The theoretical result seems to be an extension from the two marginal case to the multi-marginal case as well.\n- *Minor*: missing caption for Figure 2 (right)."
                },
                "questions": {
                    "value": "- Can the authors provide some more justification on why learning such an optimal transport path is useful? If learning the path in between distributions is to facilitate objectives like style transfer, then it should be compared with baselines on that task and show the utility of having this model. Right now, I am struggling to understand what is the use case especially for images when there is not a well-defined joint distribution between the multiple marginals.\n- It is unclear to me what is the implication of the Monge type coupling theoretical result. Is this shown to be relevant to the experimental results? If not I would recommend it to be put in appendix. It is also worth explaining more about the what this result implies and when we would like to have this property."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "5: marginally below the acceptance threshold"
                },
                "confidence": {
                    "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 2,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission9021/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698803328602,
            "cdate": 1698803328602,
            "tmdate": 1699637136669,
            "mdate": 1699637136669,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "NOOn7iAa95",
                "forum": "FHqAzWl2wE",
                "replyto": "YcEvppEiop",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission9021/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission9021/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Reply tom reviewer 2Wkn"
                    },
                    "comment": {
                        "value": "We thank reviewer 2Wkn for their feedback. We are glad that the reviewer found our multi-marginal stochastic interpolant framework unique and intriguing, and noted its connection with multi-marginal OT. The reviewer, however, had concerns about the interpretability, utility, and novelty, of the approach, which we now address.\n\n***Interpretability:*** The approach rests on the calculation of the conditional expectations $g_k(\\alpha,x) = \\mathbb{E}[x_k| x(\\alpha)=x]$ where $x(\\alpha) = \\sum_{k=1}^K \\alpha_k x_k$ and $x_k\\sim\\rho_k$. These functions have a direct intepretation: they give the Bayes-optimal estimator of the sample $x_k$ given the information contained in the observation $x(\\alpha)$. The multimarginal stochastic interpolant framework turns this static picture into a dynamical one by showing that we can generate samples from $\\rho(\\alpha)$, the PDF of $x(\\alpha)$, at any value of $\\alpha$, and transport them along any time-parameterized path $\\alpha(t)$ using either an ODE or an SDE with tunable diffusion coefficient. In terms of style transfer, it shows, for example, how a sample from a given distribution (say of cats) can be continuously transformed into a sample from another distribution (say of flowers) in a way that is influenced by additional distributions (via a path through the interior of the simplex), thereby incorporating their \"style\" along the way. We give some examples of such style-transfering paths in the paper, though we agree that more research is needed to reveal the full potential of the approach. We stress that this notion of style transfer is inherently different than any two-way correspondence, as the learned transport is affected by all the marginals.\n\n***Utility:*** The approach offers possibilities that cannot be achieved by current generative models that proceed between only two marginals. Because the method gives access to the vector fields $g_k(\\alpha,x)$ for all values of $\\alpha$, we can *a-posteriori* change the interpolation path by varying the functional form of $\\alpha(t)$ and thereby produce many different generative models (all unbiased) without having to perform any retraining. In turn, this allows us to use these models for multiple tasks, or to optimize them according to several suitable criteria (OT being just one possible choice), as already discused in the first point about interpretability above. \n\n***Novelty:*** While the results follow quite naturally from the stochastic interpolant framework, they also constitute a nontrivial generalization of it. In particular, by showing that interpolation can be done in a multi-way fashion, we break from the standard perspective (used e.g. in score based diffusion models) in which the bridging between two distributions is itself defined via a time-dependent process (for example a forward SDE that need then to be reversed in time for generation). The original stochastic interpolant framework already showed that we can decouple the bridging of the densities from the generation process used afterwards; the multimarginal framework that we propose goes a step further in this direction by showing that the bridging itself does not need to use a scalar time variable but rather can be made multi-way using a vector of $\\alpha=(\\alpha_1,\\ldots,\\alpha_K)$.\n\n**Question:**\n\n- While we agree that the meaning of a joint distribution between images of different type is somewhat unclear, this is a concept that is being explored in the two-marginal case and is at the core of any method that tries to compute the optimal transport path between these two distributions. This is useful, for instance, in terms of function evaluations along the transporting path since it makes this path straighter. Our approach allows for an algorithm that finds a better path which does not require simulating the transport, via equation (16), which is not available in the original interpolant presentation. Note also that this can be achieved *without any retraining* which is a desirable feature, and also applies in the standard two-marginal case.\n\n- We agree that the discussion about Monge coupling is somewhat tangential to our main point and will move it to an Appendix, as suggested by the reviewer. As a replacement, to improve the clarity, we are adding pseudocode for the main algorithms presented.\n\nThanks again for your valuable insights."
                    }
                },
                "number": 10,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission9021/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700607968699,
                "cdate": 1700607968699,
                "tmdate": 1700607968699,
                "mdate": 1700607968699,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "J22ELomul6",
            "forum": "FHqAzWl2wE",
            "replyto": "FHqAzWl2wE",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission9021/Reviewer_PidH"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission9021/Reviewer_PidH"
            ],
            "content": {
                "summary": {
                    "value": "In this work, the authors propose an extension of stochastic interpolants for multimarginal generative modeling, which involves learning a joint probability distribution that captures multiple marginal probability densities. The proposed framework is able to capture multi-way correspondences."
                },
                "soundness": {
                    "value": "4 excellent"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "4 excellent"
                },
                "strengths": {
                    "value": "The work proposes a theoretically sound and practical approach based on stochastic interpolants for the multimarginal setting. The overall proposed scheme is mathematically sound and computationally more feasible than existing schemes. Extensive experiments are performed to illustrate the idea and different scenarios of the proposed method."
                },
                "weaknesses": {
                    "value": "The overall algorithm of the proposed method might not be very clear or easy to follow, especially for mathematically less mature audience. I suggest the authors add the pseudocode of the main algorithm to improve clarity."
                },
                "questions": {
                    "value": "Referring to the weaknesses part, how do you solve (16)? \n\nOther remarks:\n- Incomplete caption for Figure 2 (Right). \n- Page 9 first paragraph: \u201cfrom a sample from a sample\u201d\n- References: Song et al. (2021b, c) are repeated."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "8: accept, good paper"
                },
                "confidence": {
                    "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 3,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission9021/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1699347756819,
            "cdate": 1699347756819,
            "tmdate": 1699637136535,
            "mdate": 1699637136535,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "N9iThWHuz9",
                "forum": "FHqAzWl2wE",
                "replyto": "J22ELomul6",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission9021/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission9021/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Reply to reviewer PidH"
                    },
                    "comment": {
                        "value": "We thank reviewer PiDH for their feedback. We are glad that the reviewer found the work mathematically sound and more feasible than existing methods, and that they were happy with the experimentation.\n\nThe reviewer asked us to clarify the algorithm, which we can happily do by:\n\n***Providing pseudocode*** and making a clear distinction between the steps that are specific to: *(i) learning the vector fields* that make possible the multimarginal framework, and *(ii) using them as a generative model* to sample from some initial condition (such as one of the marginals) on the simplex and transport to some final condition (such as one of the other marginals, or, say, to the barycenter).\n\n***Clarifying how we solve equation (16)***, which is the path minimization loss. This optimization is done separately from learning the vector fields $g_k(\\alpha,x) = \\mathbb{E} [x_k | x(\\alpha)=x]$ with $x(\\alpha) = \\sum_{k=1}^K \\alpha_k x_k$. Once we have learned the $g_k$,  we can *a-posteriori* change the interpolation path by varying the functional form of $\\alpha(t)$. For example, if we want to transport from marginal $\\rho_i$ to marginal $\\rho_j$, we can take any  $\\alpha(t)$ with initial condition $\\alpha_k(0) = \\delta_{k,i}$ and a final condition $\\alpha_k(1) = \\delta_{k,j}$. Any parameterization of $\\alpha(t)$ that meets these boundary conditions is sufficient. In the Appendix we present one such parameterization via an expansion of Fourier coefficients, which has the advantage that it has very few parameters; alternatively we could also use a neural network to represent $\\hat \\alpha(t)$. *With a parameterization $\\hat \\alpha(t)$ and the learned $g_k$ in hand, we can evaluate equation (16) in a simulation free manner just by sampling the interpolant* $x(\\alpha) \\sim \\rho(\\alpha, x)$ *and performing gradient descent on the parameters of $\\hat \\alpha(t)$*. This optimization is extremely cheap and typically costs a minute fraction of the cost of learning the vector fields. We will make this clear with the addition of a pseudocode algorithm in the revision."
                    }
                },
                "number": 9,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission9021/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700607882727,
                "cdate": 1700607882727,
                "tmdate": 1700607882727,
                "mdate": 1700607882727,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    }
]