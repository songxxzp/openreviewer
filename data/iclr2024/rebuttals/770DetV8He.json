[
    {
        "title": "RetroBridge: Modeling Retrosynthesis with Markov Bridges"
    },
    {
        "review": {
            "id": "bbS9BxlDhu",
            "forum": "770DetV8He",
            "replyto": "770DetV8He",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission1830/Reviewer_g93h"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission1830/Reviewer_g93h"
            ],
            "content": {
                "summary": {
                    "value": "This paper addresses single-step retrosynthesis.\nThe single-step retrosynthesis is formalized as the mapping problem from product molecule graphs to reactant molecule graphs.\nThe authors propose the Markov Bridge Model, which learns the dependency between two discrete variables, and the model is applied to the graph mapping problem.\nThe proposed method outperforms state-of-the-art template-free methods on the USPTO-50K benchmark."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "4 excellent"
                },
                "strengths": {
                    "value": "* The Markov Bridge Model is a novel and interesting approach for discrete variables and can be applied to other fields.\n* The evaluation results using top-k round-trip coverage and accuracy support the potential of the proposed method.\n* The future work described in Section 5 clearly describes the limitations of this work."
                },
                "weaknesses": {
                    "value": "* The reason for selecting graph-based representation needs to be explained.  It is not clear to me why molecules are represented as a graph instead of the 3D coordinates of atoms since 3D coordinates are frequently used in the unconditional generation of molecules  (Hoogeboom et al., 2022)."
                },
                "questions": {
                    "value": "No question."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "details_of_ethics_concerns": {
                    "value": "No concern."
                },
                "rating": {
                    "value": "8: accept, good paper"
                },
                "confidence": {
                    "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 1,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission1830/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698623524731,
            "cdate": 1698623524731,
            "tmdate": 1699636112595,
            "mdate": 1699636112595,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "vh9bKUEhss",
                "forum": "770DetV8He",
                "replyto": "bbS9BxlDhu",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission1830/Authors"
                ],
                "readers": [
                    "everyone",
                    "ICLR.cc/2024/Conference/Submission1830/Senior_Area_Chairs",
                    "ICLR.cc/2024/Conference/Program_Chairs",
                    "ICLR.cc/2024/Conference/Submission1830/Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission1830/Reviewers/Submitted",
                    "ICLR.cc/2024/Conference/Submission1830/Reviewers",
                    "ICLR.cc/2024/Conference/Submission1830/Authors"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission1830/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Response to the reviewer g93h"
                    },
                    "comment": {
                        "value": "Thank you for the very positive review. We are glad you liked our discussion section and see potential use cases of Markov bridges in other fields. \n\nTo answer your concern about the graph representation, we would like to say that, in most cases, there are different arrangements of 3D coordinates for a given bond connectivity of a molecule (which is described very well by a graph) - in fact, these are distributed according to their energy. However, how should we pick the most relevant 3D coordinates for the starting molecule(s), as an input to our model? Specific conformers usually depend on external factors (e.g. if the ligand is in a bound or unbound state) and while some reactions are highly context dependent (e.g. enzymatic reactions), this context is usually unknown a priori. At the same time, predicting and testing multiple conformations would be prohibitively expensive. Using the molecular graph instead of 3D information abstracts away the problem but still captures the most important features/behaviour of the molecules from a chemistry perspective. For this reason, almost no other work in ML for retrosynthesis uses 3D coordinates as input.\n\nNevertheless, we agree that 3D representations of molecules can be extremely useful for some tasks in computational chemistry, especially if a unique (low energy) structure is available."
                    }
                },
                "number": 7,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission1830/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700142331071,
                "cdate": 1700142331071,
                "tmdate": 1700142331071,
                "mdate": 1700142331071,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "0jgajohNkH",
                "forum": "770DetV8He",
                "replyto": "vh9bKUEhss",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission1830/Reviewer_g93h"
                ],
                "readers": [
                    "everyone",
                    "ICLR.cc/2024/Conference/Submission1830/Senior_Area_Chairs",
                    "ICLR.cc/2024/Conference/Program_Chairs",
                    "ICLR.cc/2024/Conference/Submission1830/Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission1830/Reviewers/Submitted",
                    "ICLR.cc/2024/Conference/Submission1830/Reviewers",
                    "ICLR.cc/2024/Conference/Submission1830/Authors"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission1830/Reviewer_g93h"
                ],
                "content": {
                    "title": {
                        "value": "Thanks"
                    },
                    "comment": {
                        "value": "I appreciate the response from the authors. The answers to my questions were satisfying.\n\nI have also read the opinions of the other reviewers, and I believe this paper should be accepted."
                    }
                },
                "number": 12,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission1830/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700719658251,
                "cdate": 1700719658251,
                "tmdate": 1700719658251,
                "mdate": 1700719658251,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "thelhCkcZL",
            "forum": "770DetV8He",
            "replyto": "770DetV8He",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission1830/Reviewer_CFGE"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission1830/Reviewer_CFGE"
            ],
            "content": {
                "summary": {
                    "value": "The paper presents a retrosynthesis model where the reactant is diffused to product, inducing a Markov Bridge. The method is simple and gets state-of-the-art performance."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "4 excellent"
                },
                "contribution": {
                    "value": "2 fair"
                },
                "strengths": {
                    "value": "- The presentation of the paper is clean, and the paper is easy to read and understand.\n- The method is principled and simple, and seems to work well. The idea of flowing product to reactant is very sensible."
                },
                "weaknesses": {
                    "value": "- The method is incremental: the diffusion is directly from Austin, and I think the loss function is also only a variant of diffusion losses. The network is directly from literature. There is no chemical inductive biases that I can identify.\n- The performance is opened up somewhat, but not sufficiently. I like the ablations that show the context and VLB help, but these are generally known from diffusion literature already. It would have been good to try to expose why the performance is better than MEGAN. For instance, how much of the results are from network tuning or training tricks?\n- There are many missing competing methods, such as RetroFormer and Graph2Smiles."
                },
                "questions": {
                    "value": "- The paper misses quite a lot of related works. Retroformer, Graph2Smiles, GTA, Tied transformer all seem to be missing. The paper needs to cite methods from 2022 and 2023, and include USPTO benchmark comparisons.\n- If you pin the outcome to y in eq 2, why does fig1 show that we start from x, and diverge into a bunch of y\u2019s? Shouldn\u2019t fig1 show starting from single x, fanning out, and reducing all mask down to single y?\n- What does t ~ U(0,\u2026,T-1) mean in eq 7? Seems very odd\u2026 Why doesn\u2019t it go to the end T? Why do we have multiple values?\n- What happens to the last timestep in eq 7? This seems to be a Dirac, which probably poses problems. Currently it seems that the final prediction is never evaluated, and we only predict until z_{T-1} instead of matching the final z_T to y. How do you evaluate the final prediction z_T?\n- What is p(z|x,y)?\n- What is p(z_t+1 |\u00a0z_0, z_T)? Where does this go? Why do we talk about this? Does this have something do with p(zt | z0, y)?"
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "6: marginally above the acceptance threshold"
                },
                "confidence": {
                    "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                },
                "first_time_reviewer": {
                    "readers": [
                        "ICLR.cc/2024/Conference/Program_Chairs",
                        "ICLR.cc/2024/Conference/Submission1830/Senior_Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission1830/Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission1830/Reviewer_CFGE"
                    ]
                }
            },
            "number": 2,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission1830/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698676226736,
            "cdate": 1698676226736,
            "tmdate": 1700476645238,
            "mdate": 1700476645238,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "0sZahG4hNT",
                "forum": "770DetV8He",
                "replyto": "thelhCkcZL",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission1830/Authors"
                ],
                "readers": [
                    "everyone",
                    "ICLR.cc/2024/Conference/Submission1830/Reviewers",
                    "ICLR.cc/2024/Conference/Submission1830/Reviewers/Submitted",
                    "ICLR.cc/2024/Conference/Submission1830/Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission1830/Senior_Area_Chairs",
                    "ICLR.cc/2024/Conference/Program_Chairs",
                    "ICLR.cc/2024/Conference/Submission1830/Authors"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission1830/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Response to the reviewer CFGE"
                    },
                    "comment": {
                        "value": "Thank you for highlighting the strong performance of our method and for the thorough review of our work. We believe the additional baseline methods you proposed are a valuable contribution to the quality of our paper. Below, we address all your comments and questions in detail.\n\nWe hope you find our arguments convincing, but should you still have doubts that prevent you from raising your score, we will be happy to engage in a discussion during the discussion stage. We will also try our best to incorporate any additional suggestions you might have for further improving our manuscript. We are looking forward to hearing from you.\n\n> W1: The method is incremental: the diffusion is directly from Austin, and I think the loss function is also only a variant of diffusion losses. The network is directly from literature. There is no chemical inductive biases that I can identify.\n\nWe respect the opinion of the reviewer on this very subjective matter, but we would like to highlight our contributions that, in our opinion, make our work clearly novel (beyond incremental improvements) and differentiate it from previous generative modeling frameworks. None of the existing approaches, including diffusion models (DM), conditional flow matching (CFM) and diffusion Schr\u00f6dinger bridge (DSB) models, address the problem of mapping between two intractable, discrete distributions. DMs do not allow for an intractable prior. CFMs do not operate on discrete data and do not optimise p(y|x); DSBs either do not operate on coupled samples or do not work with discrete data. Therefore, to the best of our knowledge the proposed Markov Bridge Model (MBM) is the first method that fulfills all these requirements. We kindly ask the reviewer to provide specific pointers to other works if there is reason to believe our evaluation of the prior art is incomplete.\n\nApart from this general remark, we address each of your specific concerns below:\n* We took the discrete data formalism from Austin et al., as other papers did too [1, 2], but we want to stress that **MBM is not a diffusion model.** The major differences are that neither a tractable prior nor a forward noising process are required.\n* The loss function is a variational lower bound on the data log-likelihood which is common practice in the generative modelling community. Here, we derive the specific form of this lower bound for the proposed Markov bridge model and show empirical advantages over a previously used simplified cross-entropy loss.\n* The network is a variable component of our framework that can depend on the task and data structure (e.g. if you apply MBMs to text, you can plug in an LSTM as a backbone model instead). As developing a new type of GNN is not the focus of this work, we took the same architecture as in DiGress which was shown to perform well on molecule-related tasks. We would add that it even makes our comparison with DiGress more fair and highlights our contribution on the methodological side w.r.t. the new MBM framework.\n* Finally, we did not use major chemical inductive biases because our work is motivated by the statistics of the retrosynthesis data rather than chemical intuition. The main inductive bias we investigate in this paper is the one-to-many mapping between products and reactants that is naturally captured by our proposed framework. The benefits of this idea become apparent in the round-trip evaluation where RetroBridge shows significant empirical gains compared to baselines."
                    }
                },
                "number": 4,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission1830/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700141162485,
                "cdate": 1700141162485,
                "tmdate": 1700141162485,
                "mdate": 1700141162485,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "RMV8LKf8iq",
                "forum": "770DetV8He",
                "replyto": "thelhCkcZL",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission1830/Authors"
                ],
                "readers": [
                    "everyone",
                    "ICLR.cc/2024/Conference/Submission1830/Reviewers",
                    "ICLR.cc/2024/Conference/Submission1830/Reviewers/Submitted",
                    "ICLR.cc/2024/Conference/Submission1830/Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission1830/Senior_Area_Chairs",
                    "ICLR.cc/2024/Conference/Program_Chairs",
                    "ICLR.cc/2024/Conference/Submission1830/Authors"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission1830/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Response to the reviewer CFGE [part 2]"
                    },
                    "comment": {
                        "value": "> W2: The performance is opened up somewhat, but not sufficiently. I like the ablations that show the context and VLB help, but these are generally known from diffusion literature already. It would have been good to try to expose why the performance is better than MEGAN. For instance, how much of the results are from network tuning or training tricks?\n\nWe are happy to hear that you find value in our ablation studies. We believe that this kind of analysis should be independently conducted for each specific use case. For example, previous work on graph generation with diffusion models [1] found a simple cross-entropy loss to perform well, while we observed improved performance using the more principled VLB.\n\nWhile we did not derive our method from MEGAN and cannot trace what exactly improves the performance, we argue that sampling proportional to p(reactants|product) is important to find a diverse set of valid reactants to provide more good options to a multi-step pipeline (as eventually supported by our top-k and round-trip results for k>1). Our framework is designed to approximate this probability while MEGAN optimizes the likelihood of a specific sequence of edits, imposing a more or less arbitrary order, even though different sequences can lead to the same outcome. We therefore expected our formalism to be better suited to the task, which might explain the superior performance.\n\nWe selected training and network hyperparameters among a small set of options (CE and VLB loss functions, context/no-context) and selected the best model based on its performance on the validation set before the final test set evaluation. We do not expect unusually large gains from network tuning alone. Besides, it is reasonable to believe that a similar amount of hyperparameter tuning has been performed for other retrosynthesis models.\n\n> W3: There are many missing competing methods, such as RetroFormer and Graph2Smiles.\n>\n> Q1: The paper misses quite a lot of related works. Retroformer, Graph2Smiles, GTA, Tied transformer all seem to be missing. The paper needs to cite methods from 2022 and 2023, and include USPTO benchmark comparisons.\n\nWe thank the reviewer for these comments. We added comparison with all three methods in our tables. Besides, we added even more methods in a (new) Table 4, where we provide more information on the technical aspects of the methods and evaluation methodology.\n\n> Q2: If you pin the outcome to y in eq 2, why does fig1 show that we start from x, and diverge into a bunch of y\u2019s? Shouldn\u2019t fig1 show starting from single x, fanning out, and reducing all mask down to single y?\n\nEquation 2 provides a required property of a Markov bridge. Figure 1 represents three different Markov bridges that start at the same point $\\boldsymbol{x}$ and end at three different points $\\boldsymbol{y}_1$, $\\boldsymbol{y}_2$ and $\\boldsymbol{y}_3$. Thus, for each of these bridges there is a specific requirement that it should end at a specific point. For example, for the first (orange) bridge the requirement from eq. 2 will be written as $p(\\boldsymbol{z}_T=\\boldsymbol{y}_1 | \\boldsymbol{z}\\_{T-1}, \\boldsymbol{y}_1) =  1$.\n\n> Q3: What does t ~ U(0,\u2026,T-1) mean in eq 7? Seems very odd\u2026 Why doesn\u2019t it go to the end T? Why do we have multiple values?\n\n$t\\sim U(0,\\dots,T-1)$ means that the time step is sampled from the uniform distribution over a discrete set of $T$ values $0, 1, 2, \\dots, T-1$. As shown in Appendix A.1, we replace the sum over all steps with the expectation over $U(0,\\dots,T-1)$ as it is an unbiased estimator that is crucial for efficient simulation-free learning. In particular, we move from sum to expectation in transition (29) $\\to$ (30) (Appendix A.1). It does not go to the end, $T$, because for a given $t$ we compute the KL divergence between distributions of $\\boldsymbol{z}_{t+1}$. It means that for $t=T-1$ we will compute the KL divergence for distributions of $\\boldsymbol{z}_T$."
                    }
                },
                "number": 5,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission1830/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700141458910,
                "cdate": 1700141458910,
                "tmdate": 1700142096173,
                "mdate": 1700142096173,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "g0vQfT8nz5",
                "forum": "770DetV8He",
                "replyto": "0sZahG4hNT",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission1830/Reviewer_CFGE"
                ],
                "readers": [
                    "everyone",
                    "ICLR.cc/2024/Conference/Submission1830/Reviewers",
                    "ICLR.cc/2024/Conference/Submission1830/Reviewers/Submitted",
                    "ICLR.cc/2024/Conference/Submission1830/Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission1830/Senior_Area_Chairs",
                    "ICLR.cc/2024/Conference/Program_Chairs",
                    "ICLR.cc/2024/Conference/Submission1830/Authors"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission1830/Reviewer_CFGE"
                ],
                "content": {
                    "title": {
                        "value": "resp"
                    },
                    "comment": {
                        "value": "Thanks for the responses, these did clarify many issues. I\u2019m happy to see more comparisons and the empirical results have become even more impressive. I agree that there is novelty here. Yet, I think the method is more in the incremental end of the spectrum, and the results are more or less a black-box with limited insights into why it works so well or what has it learnt. \n\nNevertheless, I\u2019m raising my score to 6, and would be happy to see this paper accepted."
                    }
                },
                "number": 10,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission1830/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700476627975,
                "cdate": 1700476627975,
                "tmdate": 1700476627975,
                "mdate": 1700476627975,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "VIvkStb5d5",
            "forum": "770DetV8He",
            "replyto": "770DetV8He",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission1830/Reviewer_4mon"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission1830/Reviewer_4mon"
            ],
            "content": {
                "summary": {
                    "value": "The authors introduce a novel approach to retrosynthesis planning by modeling it as a distribution learning problem in a discrete state space. The core of this approach is the Markov Bridge Model, which is a generative framework designed to approximate the relationship between two discrete distributions that are intractable. By optimizing a variational lower bound, similar to that in diffusion models, the method learns a Markov process that transitions between the product and reactant distributions. Empirical results suggest that the proposed method surpasses existing ones, achieving state-of-the-art results on standard benchmarks."
                },
                "soundness": {
                    "value": "4 excellent"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "3 good"
                },
                "strengths": {
                    "value": "- The paper offers a novel perspective on retrosynthesis planning, framing it as a distribution learning problem on a discrete distribution instead of a discriminative learning problem. The introduction of the Markov Bridge Model in this context and its comparison with the diffusion model is novel and interesting.\n- The presentation of the methodology is clearly written and easy to follow.\n- The derivation of the variational objective, which involves maximizing a lower bound of log-likelihood, is theoretically sound.\n- The empirical result is competitive against existing one-step retrosynthesis models.\n- The proposed method is general and can potentially be extended to other application domains involving the learning of transitions between discrete distributions."
                },
                "weaknesses": {
                    "value": "- The paper does not discuss the time required during training and inference stage of the proposed method, including the time step T, the number of samples needed to converge on the top-k prediction, etc.\n- From the atom/bond level parametrization in Section 3.2, it seems that the required T could be quite large. An ablation study to report the top-k performance vs. different Ts could be very useful."
                },
                "questions": {
                    "value": "- How much more time is needed during the training and inference phase compared with the baselines?\n- What's the choice of T in the experiments, and how many samples are needed to obtain the results?"
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "8: accept, good paper"
                },
                "confidence": {
                    "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 3,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission1830/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698804296090,
            "cdate": 1698804296090,
            "tmdate": 1699636112431,
            "mdate": 1699636112431,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "fsSHthL7W6",
                "forum": "770DetV8He",
                "replyto": "VIvkStb5d5",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission1830/Authors"
                ],
                "readers": [
                    "everyone",
                    "ICLR.cc/2024/Conference/Submission1830/Reviewers",
                    "ICLR.cc/2024/Conference/Submission1830/Reviewers/Submitted",
                    "ICLR.cc/2024/Conference/Submission1830/Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission1830/Senior_Area_Chairs",
                    "ICLR.cc/2024/Conference/Program_Chairs",
                    "ICLR.cc/2024/Conference/Submission1830/Authors"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission1830/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Response to the reviewer 4mon"
                    },
                    "comment": {
                        "value": "We thank the reviewer for the generally positive review and useful suggestions, which we have incorporated into the updated manuscript. We are happy to hear that the reviewer shares our vision that Markov Bridge Models might find applications in other domains as well.\n\n> W1: The paper does not discuss the time required during training and inference stage of the proposed method, including the time step T, the number of samples needed to converge on the top-k prediction, etc.\n\nWe elaborate on this issue in our responses to Questions 1 and 2 below.\n\n> W2: From the atom/bond level parametrization in Section 3.2, it seems that the required T could be quite large. An ablation study to report the top-k performance vs. different Ts could be very useful.\n\nWe thank the reviewer for this useful remark and provide an ablation study in Appendix A.3.5. As shown in the new Figure 5A, the performance of our model does not significantly change with up to x2 speed improvement (i.e. when sampling with T=250 instead of T=500). The performance starts degrading notably only after a 5-fold reduction of the number of time steps.\n\n> Q1: How much more time is needed during the training and inference phase compared with the baselines?\n\nDespite the huge success and the wide applicability of diffusion models and similar score-based generative methods, a known bottleneck of such algorithms is sampling. We also cannot avoid iterative sampling and hence the inference procedure requires hundreds of forward passes. Our model reported in Table 1 takes 1.3 seconds to sample reactants. For comparison, it takes 0.0064 and 0.0065 seconds for MEGAN and GLN respectively. We however note that 1 second for sampling a set of reactants for a given product is a completely feasible time for applications of models like ours. In particular, this speed does not prevent the use of our method as a component of a multistep retrosynthesis planning pipeline.\n\nRegarding training times, we trained our model 72 hours on a single Tesla V100-PCIE-32GB GPU and selected the best model based on top-5 exact match accuracy on the validation set (see Section A.3.4). We did not use early stopping or perform ablations with earlier checkpoints since training is only a one-time cost and depends on many unrelated hyperparameters, e.g. the number of validation steps, which impedes comparisons with other methods.\n\n> Q2: What's the choice of T in the experiments, and how many samples are needed to obtain the results?\n\nWe sample with T=500 for all our experiments, and generate 100 samples per input product. We additionally perform an ablation study on the number of samples (see Appendix A.3.5). As shown in the new Figure 5B, RetroBridge is very robust to the reduction of the number of samples."
                    }
                },
                "number": 3,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission1830/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700140982646,
                "cdate": 1700140982646,
                "tmdate": 1700140982646,
                "mdate": 1700140982646,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "2YBFO4GNOy",
                "forum": "770DetV8He",
                "replyto": "fsSHthL7W6",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission1830/Reviewer_4mon"
                ],
                "readers": [
                    "everyone",
                    "ICLR.cc/2024/Conference/Submission1830/Reviewers",
                    "ICLR.cc/2024/Conference/Submission1830/Reviewers/Submitted",
                    "ICLR.cc/2024/Conference/Submission1830/Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission1830/Senior_Area_Chairs",
                    "ICLR.cc/2024/Conference/Program_Chairs",
                    "ICLR.cc/2024/Conference/Submission1830/Authors"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission1830/Reviewer_4mon"
                ],
                "content": {
                    "comment": {
                        "value": "Thanks for the reply! Would be helpful to include the answers to Q1 in the paper as well."
                    }
                },
                "number": 9,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission1830/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700435666402,
                "cdate": 1700435666402,
                "tmdate": 1700435666402,
                "mdate": 1700435666402,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "aFJhFu2Z18",
            "forum": "770DetV8He",
            "replyto": "770DetV8He",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission1830/Reviewer_vNHE"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission1830/Reviewer_vNHE"
            ],
            "content": {
                "summary": {
                    "value": "This paper proposes a novel single-step retrosynthesis method called RetroBridge, utilizing the Markov Bridge Model. RetroBridge formulates the reactants and products in single-step retrosynthesis as two discrete distributions and learns the dependencies between them. By performing conditional sampling, the generated reactions demonstrate high accuracy."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "2 fair"
                },
                "contribution": {
                    "value": "3 good"
                },
                "strengths": {
                    "value": "1. To the best of my knowledge, this paper is the first to introduce the concept of the single-step retrosynthesis problem by framing it as a distribution fitting task, akin to a diffusion model.\n2. The proposed model achieves the SOTA Top k accuracy (k > 3) on USPTO-50K.\n3. The comparison with diffusion model makes a perfect sense."
                },
                "weaknesses": {
                    "value": "1. The top 1 accuracy achieved on the USPTO-50K dataset is relatively low, and a similar trend is observed in the forward prediction task. It would be helpful if the authors could provide an explanation for these results.\n2. Some baseline methods are missing, which may perform much better than RetroBridge, like DualTF, RSMILES, PMSR, etc.\n3. In comparison to other TF methods, RetroBridge requires atom-to-atom mappings, which could potentially pose limitations on its feasibility. This constraint could become a hindrance when applying RetroBridge to larger datasets such as USPTO-Full."
                },
                "questions": {
                    "value": "This paper provides a fresh perspective on AI for retrosynthesis; however, it could benefit from further elaboration on the chemical aspects involved. Some previous works, like GraphRetro and MEGAN somehow, mimic the process of chemical reactions. So, how Markov bridge formulates chemical reactions? I would consider raising my rating if the authors addressed my concerns."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "5: marginally below the acceptance threshold"
                },
                "confidence": {
                    "value": "5: You are absolutely certain about your assessment. You are very familiar with the related work and checked the math/other details carefully."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 4,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission1830/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698906566333,
            "cdate": 1698906566333,
            "tmdate": 1699636112355,
            "mdate": 1699636112355,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "ESfd3TaWr2",
                "forum": "770DetV8He",
                "replyto": "aFJhFu2Z18",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission1830/Authors"
                ],
                "readers": [
                    "everyone",
                    "ICLR.cc/2024/Conference/Submission1830/Reviewers",
                    "ICLR.cc/2024/Conference/Submission1830/Reviewers/Submitted",
                    "ICLR.cc/2024/Conference/Submission1830/Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission1830/Senior_Area_Chairs",
                    "ICLR.cc/2024/Conference/Program_Chairs",
                    "ICLR.cc/2024/Conference/Submission1830/Authors"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission1830/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Response to the reviewer vNHE"
                    },
                    "comment": {
                        "value": "We thank the reviewer for recognizing the strengths of our work but also evaluating it with a critical eye. We are particularly grateful for the list of additional baselines that have been missing in our initial submission. We added all the suggestions to our manuscript and addressed further concerns and questions below. We believe to have improved the quality of our paper and hope to have provided satisfactory answers to each of your questions. If there is anything else we can do for you to consider raising your score, please let us know. We are looking forward to hearing from you.\n\n> W1: The top 1 accuracy achieved on the USPTO-50K dataset is relatively low, and a similar trend is observed in the forward prediction task. It would be helpful if the authors could provide an explanation for these results.\n\nSince one product can be obtained through different reaction pathways and different starting sets of reactants, top-1 accuracy reports nothing but the ability of the model to guess what exact reaction for a given product was patented and therefore included in the dataset. We stress that **top-3 and top-5 are much more important metrics as they reflect the probabilistic aspect of the problem.** Besides, as it was discussed in [1], the typically expected or desired breadth of the multi-step retrosynthesis planning tree is 5 which makes top-5 accuracy the preferred metric. We additionally emphasize that, as shown in Table 3, **our model was optimized for top-5 accuracy.** We added these additional remarks in Section 4.3.\n\n[1] Maziarz, Krzysztof, et al. \"Re-evaluating Retrosynthesis Algorithms with Syntheseus.\" arXiv preprint arXiv:2310.19796 (2023).\n\n> W2: Some baseline methods are missing, which may perform much better than RetroBridge, like DualTF, RSMILES, PMSR, etc.\n\nWe thank the reviewer for these suggestions. We significantly extended Tables 1 and 2 and, in particular, added DualTF to Table 1. We would like to mention, however, that DualTF is an ensemble of 3 models, one of which is a ranking model in the forward direction, which all the other baseline models do not use. We would also like to note that the comparison with PMSR and RSMILES is not fair. While all the methods in Table 1 (including ours) are trained on the same subset of USPTO-50k, PMSR is additionally pre-trained on 3.7M reactions from Pistachio. Likewise, RSMILES is pre-trained on USPTO-FULL and their test set is x20 augmented. We therefore add these methods only for a full picture in the extended Table 4 in the Appendix, where we provide more information on the technical aspects of the methods.\n\n> W3: In comparison to other TF methods, RetroBridge requires atom-to-atom mappings, which could potentially pose limitations on its feasibility. This constraint could become a hindrance when applying RetroBridge to larger datasets such as USPTO-Full.\n\nWhile RetroBridge uses atom mapping for training, this is not conceptually required. It is true that a training set with all correctly mapped molecules significantly simplifies the training process. However, although we did not perform such experiments, we speculate that the probabilistic nature of our model allows for minor inconsistencies in the atom mapping. With the modern high-performant tools for atom mapping such as RXNMapper [1], we believe that the level of possible mapping inconsistencies is negligible for the performance of RetroBridge. Also, there have been to the best of our knowledge no studies so far in the literature which empirically demonstrate that errors in the atom mapping lead to significant practical performance loss for any kind of retrosynthesis model.\n\n[1] Schwaller P. et al. \u201cExtraction of organic chemistry grammar from unsupervised learning of chemical reactions\u201d"
                    }
                },
                "number": 1,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission1830/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700140803015,
                "cdate": 1700140803015,
                "tmdate": 1700142052270,
                "mdate": 1700142052270,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    }
]