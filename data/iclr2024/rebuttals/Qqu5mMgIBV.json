[
    {
        "title": "Castor: Causal Temporal Regime Structure Learning"
    },
    {
        "review": {
            "id": "oO2mrrxClL",
            "forum": "Qqu5mMgIBV",
            "replyto": "Qqu5mMgIBV",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission6010/Reviewer_Xsp2"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission6010/Reviewer_Xsp2"
            ],
            "content": {
                "summary": {
                    "value": "This paper tackles the following problem: given time series data that is mixed from multiple regimes, where the regime partition is unknown, the data in each single regime is generated by stationary additive noise temporal causal process, and the causal graphs in different regimes are different, the task is to recover the regime partition, and to learn the temporal causal graphs of each single regime.\n\nThis paper utilizes an EM method to maximize the data likelihood. Different from the original EM methods like (Zheng et al. 2018), this paper 1) introduces and learns an additional variable to model regime participation, and 2) allows nonlinear relationships by using neural networks like that in (Brouillard et al. 2020, Liu & Kuang 2023). The performance is validated on simulated and real-world datasets."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "2 fair"
                },
                "contribution": {
                    "value": "1 poor"
                },
                "strengths": {
                    "value": "1. The technical derivations by using EM optimization to show the structure identifiability looks correct, though I didn't check the detailed proofs. The introduction of the regime participation variable is interesting.\n\n2. The proposed method can handle instantaneous relations.\n\n3. In experiments, the proposed method outperforms VARLiNGAM on each single regimes."
                },
                "weaknesses": {
                    "value": "1. **The significance of the problem setting is unclear:**\n   - It seems unnatural to assume that the time series data is from several mixed unknown regimes while within each regime the temporal causal relations are stationary. Could the authors give some motivative or real-world examples of this kind of datasets?\n   - Usually it's more natural to think of nonstationarity in time series data as changing constantly but gradually, i.e., in the context of this paper, the regime partition is as fine as each single time stamp, while the causal relations (densities, edges weights) change smoothly across different time stamps.\n   - Specifically, in this paper, by \"time partition\" (Definition 2), did the authors assume that each partition is a continent time series block? If yes, it should be stated clearly, instead of a vague \"time partition\"; if no, why, and any motivations? Also, did the authors assume/constrain any \"similarities\" between the causal graphs of different regimes?\n\n2. **Even under this setting, the problem can already be well solved by existing methods:**\n   - This paper mentions CD-NOD (Huang et al. 2020) but claims that \"CD-NOD cannot infer individual causal graphs and necessitates prior knowledge about the number of regimes.\" But based upon my understanding on CD-NOD, this statement is generally incorrect, and the regime partition is actually readily obtainable from CD-NOD's abstract output.\n   - By using the time stamp IDs as the surrogate variable, CD-NOD's phases I and II can output the abstract causal graph where the parents of each variable is identified as the union of all its parents in graphs from different regimes. Then, note that there is a phase III, kernel non-stationary visualization (Fig 12), which generally estimates the variability of the conditional distribution $p(Xi | union.parents(Xi))$ over the time index surrogate. The different regime partition is then readily available, i.e., the locations/times where changes happen are detected. Finally, with regimes recovered, any methods like PCMCI can be used in each stationary regime to obtain the graphs of each.\n   - So what's the benefit of using the authors' proposed method than just using CD-NOD as above? Or please correct me if I am wrong regarding my understanding on CD-NOD or the problem.\n\n3. **The parametric assumption is quite limited:**\n   - The authors categorize the proposed CASTOR as score-based methods. Just for the convention, I would suggest to specify it as optimization-based methods (e.g., NOTEARS), to be distinguished from those real score-based methods, like GES.\n   - Just like many existing optimization-based methods, this paper assume that the exogenous noise in the additive noise model follows a standard Gaussian distribution (namely, the uni/equal-variance assumption). This, however, is generally untestable and highly impractical in real-world scenarios. When the equal-variance assumption is violated, these optimization-based methods can perform relatively bad.\n   - In this paper, is there any way to relax the uni/equal-variance assumption?\n\n4. **The experimental comparisons are incomplete:**\n   - The authors only provide experimental comparisons with stationary temporal causal discovery methods PWGC, VARLiNGAM, and DYNOTEARS. Moreover, the VARLiNGAM method is also misspecified for the non-Gaussian distributions.\n   - More comprehensive comparisons are needed with at least some non-stationary temporal causal discovery methods, as well as the CD-NOD one discussed above.\n\n5. **The presentation somewhat lacks clarity.**\n   - What is the mixing coefficients $\\pi_{t,u}(\\alpha)$ in Eq.5? What is such $\\alpha$? The readers are not expecting a choice of parameters (like the mentioned Same \u0301 et al. (2011)), but more from a definition perspective with physical meanings. E.g., in Eq.5, the mixing coefficients should be defined as something related to the regimes partition. Further parameter approximations are then introduced.\n   - Why did the authors choose to spell out $Pa(<t)$ and $Pa(t)$ separately in expressions like Eq.2?\n   - Question: does the proposed method output specific DAGs or equivalent classes? Since with instantaneous relations, usually the exact DAG is unidentifiable non-parametrically. Which is the critical factor that helps the exact identification in this method?"
                },
                "questions": {
                    "value": "See the Weaknesses part."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "5: marginally below the acceptance threshold"
                },
                "confidence": {
                    "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
                },
                "code_of_conduct": {
                    "value": "Yes"
                },
                "first_time_reviewer": {
                    "readers": [
                        "ICLR.cc/2024/Conference/Program_Chairs",
                        "ICLR.cc/2024/Conference/Submission6010/Senior_Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission6010/Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission6010/Reviewer_Xsp2"
                    ]
                }
            },
            "number": 1,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission6010/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698370051617,
            "cdate": 1698370051617,
            "tmdate": 1700808565155,
            "mdate": 1700808565155,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "f7ejfPA59W",
                "forum": "Qqu5mMgIBV",
                "replyto": "oO2mrrxClL",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6010/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6010/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Response to Reviewer Xsp2"
                    },
                    "comment": {
                        "value": "We extend our gratitude to Reviewer Xsp2 for the very insightful comments. We are pleased to note the appreciation for the introduction of regime learning and the acknowledgment of our approach in handling both instantaneous and time-lagged relations.\n\n**The significance of the problem setting is unclear:**\n- We are committed to providing further motivation for the problem at hand. In our introduction, we highlighted the relevance of our framework to EEG recordings in epilepsy, where distinct regimes (non-seizure, pre-ictal, seizure) form Multivariate Time Series (MTS) sequences. Additionally, Saeed et al.'s work, on causal structure discovery from mixtures of Directed Acyclic Graphs (DAGs) presented at ICML 2020, shows the importance of this setting in learning gene regulatory networks from diverse subtypes in neurological diseases. We believe that there are several other settings where our framework is particularly relevant and attractive, and we will revise the text to clarify these points. \n- Then, we clarify that each partition in our framework corresponds to a MTS block, representing a distinct regime. Visual aids in the form of figures have been added to the appendix to elucidate our setting.\n\n**Even under this setting, the problem can already be well solved by existing methods:**\n\nOur statement *\"CD-NOD cannot infer individual causal graphs and necessitates prior knowledge about the number of regimes.\"*\n- We sincerely appreciate the insightful remark. Our statement aims to clarify that CD-NOD provides a summary graph for all regimes, which is a more constrained output compared to the comprehensive representation offered by our framework, CASTOR (Full temporal causal graph per regime). As the reviewer correctly noted, CD-NOD can infer change points but lacks the ability to express if regimes are repeated in the Multivariate Time Series due to the absence of temporal causal graphs for each regime. In contrast, CASTOR does not only learn and present the temporal causal graph for each regime but also leverages this information to achieve more accurate causal graphs by grouping together time series blocks from the same causal graph. This approach precisely determines the total number of distinct regimes.\n- We argue that learning a full temporal causal graph per regime is more powerful than acquiring a single summary graph. The full temporal causal graph does not only contain the information necessary to reconstruct the summary causal graph but also offers a more accurate evaluation metric. For instance, consider two simple settings with two variables: In setting 1, we have 1->2 in a time-lagged manner and 2->1 instantaneously, resulting in the summary causal graph 1<->2. Now, in setting 2, we have 2->1 in a time-lagged manner and 1->2 instantaneously, resulting in the summary causal graph 1<->2. However, evaluating based on the full temporal causal graph in each setting provides a nuanced and accurate assessment of the differences between them.\n- *what's the benefit of using the authors' proposed method than just using CD-NOD as above?* Thank you for your valuable feedback. We initially considered a fair and challenging comparison with methods learning full temporal causal graphs through manual regime splitting. We want to clarify that we had presented comparisons to RPCMCI which is a model for MTS with different regimes. However, in response to your suggestion, we conducted further experiments, comparing with CD-NOD and using phases 1 and 2 from the official Python package causal-learn, providing regime indexes to CD-NOD. The results of these extended comparisons are detailed below.\n|    | method | K=2     | K=3      | K=4      |\n|----|--------|---------|----------|----------|\n| 10 | CD-NOD  | 20.2    | 11.4     | 38.8     |\n|    | CASTOR | **100** | **100**  | **97.9** |\n| 20 | CD-NOD  | 25.2    | 23.7     | 12.7     |\n|    | CASTOR | **100** | **97.2** | **93.4** |\n| 40 | CD-NOD  | 0       | 11.3     | 5.57     |\n|    | CASTOR | **100** | **99.8** | **99.2** |\n\n**The parametric assumption is quite limited:**\n- We want to thank you for this remark, part of our future work will be to extend to more complicated settings with more complicated noises.\n\n**The experimental comparisons are incomplete:**\n- We have incorporated additional experimental results, conducting comparisons with CD-NOD and Rhino (CASTOR surpasses both models in various settings, achieving over 93% compared to 23% for CD-NOD and 39% for Rhino.). Please refer to the appendix for detailed outcomes ([Comparison with Rhino](https://openreview.net/forum?id=Qqu5mMgIBV&noteId=pdUoJO5frL)). Furthermore, we have included running times for all the models for comprehensive insights.\n\n**The presentation somewhat lacks clarity:**\n- We acknowledge the importance of clarity and have taken steps to address this concern. New figures have been added to the paper, available in the updated appendix, aiming to enhance the reader's understanding."
                    }
                },
                "number": 7,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6010/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700049293941,
                "cdate": 1700049293941,
                "tmdate": 1700049293941,
                "mdate": 1700049293941,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "mCckkISWep",
                "forum": "Qqu5mMgIBV",
                "replyto": "oO2mrrxClL",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6010/Reviewer_Xsp2"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6010/Reviewer_Xsp2"
                ],
                "content": {
                    "title": {
                        "value": "Thank the authors for your response."
                    },
                    "comment": {
                        "value": "Thank the authors for your response. And especially thank you for running additional experiments in short time.\n\nHowever, my two biggest concerns are still not very well addressed. Specifically,\n\n\n1. **The significance of the problem setting is unclear:**\n\n> Motivative or real-world examples of such dataset, i.e., time series from several regimes where the relations inside each regime is stationary?\n\nThe authors mention EEG recordings in epilepsy (Tang et al. 2021; Rahmani et al. 2023) and DAG mixtures in gene data (Saeed et al. 2020) to show the importance of this setting. However, for the former, could the authors please refer to the specific paragraphs in the two cited papers that explicitly model the EEG data as this setting? For the latter, if I understand correctly, they care about mixture of different DAGs in a same dataset without temporal partition, which is quite different from the setting of this paper.\n\n> Usually it's more natural to think of nonstationarity in time series data as changing constantly but gradually.\n>\n> By \"time partition\" (Definition 2), did the authors assume that each partition is a continent time series block? Also, did the authors assume/constrain any \"similarities\" between the causal graphs of different regimes?\n\nIt seems that the authors didn't answer these questions. The authors did add some \"visual aids in the form of figures\" to the appendix, but here are some nit questions: in e.g., Fig 2, in each regime there are two adjacency matrices - one for instantaneous relations and one for time-lagged ones. How are time-lagged ones plotted in one matrix? Are the lags the same? Which colors of light and dark blues denote 1 or 0? Also, the y-axis 0.0, 7.5,... are misleading. Please make them integers.\n\n\n2. **Even under this setting, the problem can already be well solved by existing methods (e.g., CD-NOD):**\n\n> By using the time stamp IDs as the surrogate variable, CD-NOD's phases I and II can output the abstract causal graph. Then, using kernel non-stationary visualization of phase III, the different regime partition is readily available.\n\nAs mentioned earlier, it seems that what this paper does (identify different regimes, and then identify causal graph within each regime) can already be achieved by CD-NOD. So I am wondering what is the benefit of this paper.\n\nThe authors mention \"CD-NOD can infer change points but lacks the ability to express if regimes are repeated\" -- I don't quite get it. What do authors mean by \"repeated regimes\"? I searched \"repeat\" in your paper but didn't find anything related. It seems that once each regime is identified, whether regimes are repeated will also be trivially available?\n\nThe authors argue that \"learning a full temporal causal graph per regime is more powerful than acquiring a single summary graph\" -- that is unrelated. As mentioned above, the single summary graph is just a start point. CD-NOD can further identify the regimes partition and then temporal causal graphs within each regime can be estimated using many existing methods separately as well.\n\nMoreover, some of my other concerns still exists, e.g.,\n\n3. **The parametric assumption is quite limited:** the authors have to assume the equal-variance of exogenous noise components, only with which the DAG identifiability under instantaneous relations is possible. However, this assumption is generally untestable. I don't put it as a major concern for this specific paper only because this assumption is widely used now by optimization based methods.\n\nIn summary, my major concerns are not well addressed. So I keep my score of rejection."
                    }
                },
                "number": 10,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6010/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700610505211,
                "cdate": 1700610505211,
                "tmdate": 1700610536805,
                "mdate": 1700610536805,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "6F0DxTjPD1",
            "forum": "Qqu5mMgIBV",
            "replyto": "Qqu5mMgIBV",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission6010/Reviewer_VxPv"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission6010/Reviewer_VxPv"
            ],
            "content": {
                "summary": {
                    "value": "This paper proposes a framework named CASTOR, which is able to learn causal relationships from heterogeneous time series data composed of various regimes without prior knowledge of regimes."
                },
                "soundness": {
                    "value": "1 poor"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "2 fair"
                },
                "strengths": {
                    "value": "- This method is designed to learn causal relationships from heterogeneous time series data.\n- This work proposes a regime detection method."
                },
                "weaknesses": {
                    "value": "- Theorem 1 states that each regime is identifiable, and thus the causal structure is also identifiable by giving the correct regime. However, the claim that the regime is identifiable is skeptical. For example, consider a simple normal mixture distribution with two components N(0,1) and N(0,2) (a degenerate case with two regimes), and this theorem seems to suggest that each sample can be identified whether from N(0,1) or N(0,2) which is clearly not true.\n- Can you verify the identification of regimes with some extensive simulation study, especially for those that have distribution overlap in different regimes? For example, to show how is the accuracy in identifying the border (changed point) between two regimes.\n- Moreover, is the number of regimes identifiable? How to choose the number of regimes.\n- The task of identifying the regimes should also be related to the field of change point detection in time series which have not been comprehensively reviewed and compared with them."
                },
                "questions": {
                    "value": "See the weaknesses above."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "3: reject, not good enough"
                },
                "confidence": {
                    "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 2,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission6010/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698757856419,
            "cdate": 1698757856419,
            "tmdate": 1699636644597,
            "mdate": 1699636644597,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "Z8ostEor7z",
                "forum": "Qqu5mMgIBV",
                "replyto": "6F0DxTjPD1",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6010/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6010/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Response to Reviewer VxPv"
                    },
                    "comment": {
                        "value": "We express our sincere gratitude to Reviewer VxPv for the dedicated effort and valuable comments on our manuscript. We are pleased that the reviewer acknowledges the quality of our paper's presentation and recognizes its strengths, particularly in regime learning and causal discovery from heterogeneous data.\n\nBy addressing the concern raised by the reviewer regarding the correctness of our theorem, we appreciate the opportunity to provide clarification. The example presented by the reviewer, featuring two components with the same mean but different variance, neglects a critical aspect: all our noises originate from $\\mathcal{N}(0,1)$. Consequently, variations in the mean of different components of the mixture occur when changing the graphs. This nuanced point ensures that if the means are the same, the underlying graphs are also identical, indicating the same regime. We are hopeful that this clarification will alleviate any doubts about the validity of our theorem.\n\nConcerning the inquiry about the choice the number of regimes, our paper explicitly addresses this problem in the learning algorithm. The detailed process is explained in the third section, involving the decomposition of the time series into equivalent windows. Subsequently, we iteratively update these windows by merging some, and canceling others. To enhance clarity, visual explanations, and figures detailing the learning process and CASTOR framework have been included in the appendix."
                    }
                },
                "number": 6,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6010/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700047597488,
                "cdate": 1700047597488,
                "tmdate": 1700047597488,
                "mdate": 1700047597488,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "3GI6rctizM",
                "forum": "Qqu5mMgIBV",
                "replyto": "Z8ostEor7z",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6010/Reviewer_VxPv"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6010/Reviewer_VxPv"
                ],
                "content": {
                    "comment": {
                        "value": "Thanks for the response. However, my concerns still exist.\n\nRegarding \"variations in the mean of different components of the mixture occur when changing the graphs\"\n\nFirst, there is no guarantee that the mean of different components must change when changing the graphs, and it is possible that each regime has the same mean.\n\nSecond, even if the mean has changed, it is still unclear how to discern the sample from two normal distributions since there is always an overlap between two Gaussian distributions.\n\nGiven the issues above, I keep my score of rejection."
                    }
                },
                "number": 11,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6010/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700638165648,
                "cdate": 1700638165648,
                "tmdate": 1700638165648,
                "mdate": 1700638165648,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "69xU3pkUZK",
            "forum": "Qqu5mMgIBV",
            "replyto": "Qqu5mMgIBV",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission6010/Reviewer_4Xkb"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission6010/Reviewer_4Xkb"
            ],
            "content": {
                "summary": {
                    "value": "The paper presents CASTOR, a new framework for uncovering causal relationships in heterogeneous time series data. Unlike existing methods, CASTOR can identify different regimes within the data and learn the associated temporal causal graphs. This is achieved by leveraging the EM algorithm. The method is validated through synthetic experiments and real-world benchmarks."
                },
                "soundness": {
                    "value": "2 fair"
                },
                "presentation": {
                    "value": "1 poor"
                },
                "contribution": {
                    "value": "2 fair"
                },
                "strengths": {
                    "value": "1. The paper considers an important problem.\n\n2. The framework is general to handle both linear and non-linear relationships."
                },
                "weaknesses": {
                    "value": "1. The proposed method lacks novelty by comparing it with the NOTEARS method and the related extensions. See references below. For example, why not consider the nonparametric version of NOTEARS in the DYNOTEARS framework? Can you explain why combining EM is the most efficient way to solve the problem?\n\n - Zheng, Xun, et al. \"Dags with no tears: Continuous optimization for structure learning.\" Advances in neural information processing systems 31 (2018).\n\n - Zheng, Xun, et al. \"Learning sparse nonparametric dags.\" International Conference on Artificial Intelligence and Statistics. PMLR, 2020.\n\n - Pamfil, Roxana, et al. \"Dynotears: Structure learning from time-series data.\" International Conference on Artificial Intelligence and Statistics. PMLR, 2020.\n\n2. In addition, why consider or focus on the score-based method? One can not call the learned DAG a causal graph based on such type of method due to the absence of scale invariance.\n\n3. I am very confused by the term \"heterogeneous time series\" in this paper. I cannot find any rigorous definition related to it. The \"heterogeneous\" in causal inference usually connects to heterogeneity among different individuals described by some variables say confounders. Anyway, without a clear statement, please do not claim such a contribution.\n\n4. An analysis of computational complexity is needed or at least running time should be provided. \n\n5. Many benchmark methods are missing for temporal causal graph learning. Please consider including at least methods mentioned in your related works.\n\n6. Last but not least! The presentation needs substantial improvement. For example, one can find numerous flaws in Section 1. Please carefully check the citation formation and please do CAPITALIZE the first word in the sentence."
                },
                "questions": {
                    "value": "Please consider addressing my comments in weaknesses."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "3: reject, not good enough"
                },
                "confidence": {
                    "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 3,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission6010/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698820164705,
            "cdate": 1698820164705,
            "tmdate": 1699636644481,
            "mdate": 1699636644481,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "NVJJG5OZID",
                "forum": "Qqu5mMgIBV",
                "replyto": "69xU3pkUZK",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6010/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6010/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Response to Reviewer 4Xkb"
                    },
                    "comment": {
                        "value": "We extend our gratitude to the diligent efforts of the reviewer and value the insightful comments. We are grateful for Reviewer (4Xkb)'s recognition of the importance of our problem and the generality of our framework in addressing both linear and non-linear relations.\nThe references cited by the author have been duly acknowledged in our paper, and they indeed represent special cases within our framework. We have added a discussion that permits to further clarify the novelty of the proposed framework. \n\nNotably, the reviewer references DYNOTEARS and its extension to the non-linear setting using the extended version of NOTEARS. We outline that our method encompasses these as special instances. In Equation 3 on page 3 of our paper, we present SEM of our settings. If $K=1$, corresponding to a time series with only one regime, it essentially becomes an extension of DYNOTEARS to non-linear settings. However, it is crucial to highlight that our framework operates in a setting where time series comprise multiple consecutive regimes, with each regime could be seen as MTS with a different causal graph (We employed the EM algorithm to iteratively alternate between regime learning and graph learning). CASTOR learns together the number of regimes, their respective indexes (indicating when each regime starts and ends), and the associated causal graph - none of the methods in the literature is able to address this joint learning problem, to the best of our knowledge.\n\nThank you for the clarification. In our framework, heterogeneous time series refers to the fact that the time series data has multiple regimes. Based on our understanding, the term \"heterogeneous data\" or \"heterogeneous time series\" is used to denote data from different causal models in causal discovery literature (we provided some references). Your insight is valuable, and we have therefore refrained from using this terminology in the updated version of our manuscript to enhance clarity.\n- Saeed, Basil, et al. \"Causal Structure Discovery from Distributions Arising from Mixtures of DAGs.\"  International Conference on Machine Learning. PMLR, 2020.\n- Huang, Biwei et al. \"Causal Discovery from Heterogeneous/Nonstationary Data.\" The Journal of Machine Learning Research, 21\n\nTo address concerns regarding runtime efficiency, we have incorporated comprehensive running time experiments in the appendix. Additionally, new models have been introduced, and all pertinent results are presented in the supplementary materials.\n\n**Setting: 10 nodes and different number of regimes (2,3,4)**\n\nVARLINGAM and CD-NOD (employing Fisher\u2019s Z conditional independence test for faster runs; note that KCI CD-NOD takes over 2000 seconds for 2 regimes, with F1 scores in a similar range) exhibit remarkable speed compared to other methods (less than 4 seconds). However, in terms of scores, both models encounter challenges in effectively learning causal graphs. Notably, CASTOR (around 200 seconds for 4 regimes) runs faster than Rhino (around 2000 seconds for 4 regimes), even though CASTOR learns both temporal causal graphs and regime indexes. \n\nA fair comparison arises when comparing RPCMCI and CASTOR, as both models learn regime indexes and temporal causal graphs. It's essential to mention that RPCMCI necessitates specifying the number of regimes and the maximum number of transitions, producing only time-lagged relations. CASTOR (200 seconds for 4 regimes) converges more rapidly than RPCMCI (more than 2300 seconds for 4 regimes). This difference in convergence time becomes more pronounced as the settings become more complex."
                    }
                },
                "number": 5,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6010/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700047283349,
                "cdate": 1700047283349,
                "tmdate": 1700047435390,
                "mdate": 1700047435390,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "Gm7Uec8qIu",
            "forum": "Qqu5mMgIBV",
            "replyto": "Qqu5mMgIBV",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission6010/Reviewer_eyWr"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission6010/Reviewer_eyWr"
            ],
            "content": {
                "summary": {
                    "value": "The paper presents a framework, called CASTOR, for causal discovery in heterogeneous time-series data across multiple regimes, each characterized by distinct causal graphs and functional relationships. The authors propose a combination of the EM algorithm with temporal structural equation models (SEMs) to simultaneously infer regime, causal graphs, and functional parameters. Theoretically, they demonstrate that by optimizing the proposed objective function, it is possible to recover the true regime and causal graphs, given certain assumptions hold. Empirically, the approach is validated through two synthetic experiments and application to two real-world datasets, showcasing the effectiveness of the proposed method."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "2 fair"
                },
                "contribution": {
                    "value": "2 fair"
                },
                "strengths": {
                    "value": "This paper proposed a methodology that fuses the EM algorithm with SEMs to deduce regimes, causal graphs, and functional relationships from observational time-series data. There are precedents in the literature, such as Rhino, which employs an EM-like algorithm for inferring graph distributions and this paper's formulation bears a resemblance to both Rhino and DYNOTEARS. The introduction of multiple regimes in this context, however, does provide a new dimension to the existing frameworks. Although the degree of originality may not be profound, it is nonetheless a meaningful contribution to the domain. On the significance front, the paper targets a problem of practical relevance, potentially offering valuable insights and tools to the community engaged in causal discovery within time-series analysis. I have briefly checked the proof, which seems to be ok but there are some typos in the appendix."
                },
                "weaknesses": {
                    "value": "The primary weakness of the paper is in its presentation, particularly regarding the explication of the key contribution: the introduction of multiple regimes. More textual emphasis and clarity on the parametrization of the time-series model to account for these multiple regimes would be advantageous. For instance, the ordering of time partitions denoted by $u_1$ and $u_2$ remains unclear \u2013 should the time in $u_1$ consistently precede that in $u_2$? Moreover, the role and interpretation of $\\gamma_{t,u}$ are ambiguous. If $\\gamma_{t,u}$ serves as an indicator for time $t$'s association with partition $u$, its continuous nature as presented in Equation 11 raises questions about how to understand the defined likelihood $\\log p(X_{0:T})$ defined above Equation 8. A presentation from the perspective of variational inference might provide a more systematic and clearer framework, which could naturally elucidate derivations such as that of Equation 11.\n\nConcerning empirical evaluations, the paper's baselines, namely VARLiNGaM and DYNOTEARS, do not represent the stronger baselines. Including stronger method, such as Rhino, could significantly enhance the demonstration of CASTOR's efficacy in regime inference. Matching or exceeding strong baselines would underscore CASTOR's advantages; alternatively, any performance gap would still furnish useful insights into the framework's relative standing and potential areas for enhancement."
                },
                "questions": {
                    "value": "1. I wonder how should I interpret the generation mechanism for the time across the regime boundaries? For example, if we have two partitions: ${0,1,2,3}$ and ${4,5,6,7}$ with lag $1$ and $3$ respectively. Then, how should I interpret the data generation at $t=4$? What is the corresponding graph and lag I should use? \n\n2. Do we assume the time in each partition always be smaller than the time in the later partitions?\n\n3. How do you obtain eq.11? Is this the analytic solution from the E-step? \n\n4. In appendix, Eq.22, what is $p^{(l)}$?\n\n5. In appendix, is the $\\pi$ introduced in Theorem 2 that same as the $\\pi$ in the main text? If not, please use a different notation. \n\n6. Missing equation number below Eq.22."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "5: marginally below the acceptance threshold"
                },
                "confidence": {
                    "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 4,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission6010/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1699378441140,
            "cdate": 1699378441140,
            "tmdate": 1699636644380,
            "mdate": 1699636644380,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "pdUoJO5frL",
                "forum": "Qqu5mMgIBV",
                "replyto": "Gm7Uec8qIu",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6010/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6010/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Response to reviewer eyWr"
                    },
                    "comment": {
                        "value": "We sincerely appreciate the time and effort invested by the reviewer in evaluating our manuscript, and we are grateful for the insightful comments. We concur with the reviewer's observation that the introduction of multiple regimes adds a novel dimension to existing causal discovery frameworks.\n\n- Regarding the identified weakness in the paper's presentation, we acknowledge the importance of clarity and have taken steps to address this concern. New figures have been added to the paper, available in the updated appendix, aiming to enhance the reader's understanding. Additionally, we are refining the overall presentation and rectifying any typographical errors in the appendix.\n\n- In response to the specific query about $\\gamma_{t,u}$, we want to clarify that we learn it, as detailed in Equation 11( E-step). Furthermore, in each iteration, the regime with maximum probability is assigned a value of 1, while others are set to 0.\n\n- In response to your observation concerning lag and regimes, our work operates under the assumption that the duration of the regimes is greater than the number of lags.\n\n- $p^{(\\ell)}$ is the optimal distribution of the regime $\\ell$.\n\nTo address the comparison with the Rhino framework, we conducted rigorous evaluations. This involved training Rhino on 50 time series, each with a length of 200, for every regime. The regime indexes were provided to Rhino, and the entire process was carried out following the guidelines outlined in the authors' GitHub repository. We adhered to their README description to ensure accuracy and consistency in our approach.\n|     |        |      | $K=2$ |         | $K=3$ |          | $K=4$ |          |\n|-----|--------|------|-------|---------|-------|----------|-------|----------|\n| $d$ | method | type | SHD   | F1      | SHD   | F1       | SHD   | F1       |\n| 10  | Rhino  | I    | 36    | 36.4    | 48    | 37.8     | 64    | 39.1     |\n|     |        | L    | 38    | 36.9    | 60    | 33.6     | 85    | 34.7     |\n|     | Castor | I    | **0** | **100** | **1** | **97.3** | **1** | **99.3** |\n|     |        | L    | **0** | **100** | **0** | **100**  | **2** | **98.4** |"
                    }
                },
                "number": 4,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6010/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700043643328,
                "cdate": 1700043643328,
                "tmdate": 1700043643328,
                "mdate": 1700043643328,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "kFBDIvfCH3",
                "forum": "Qqu5mMgIBV",
                "replyto": "pdUoJO5frL",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6010/Reviewer_eyWr"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6010/Reviewer_eyWr"
                ],
                "content": {
                    "comment": {
                        "value": "Thanks for the authors' response.\n\nI am a bit surprised that Rhino performs even worse the simple VARLiNGaM in this low-dimensional non-linear settings. Because from Figure 1, it seems that DYNOTEARS performs similarly to CASTOR, where in Rhino paper, Rhino seems to outperform DYNOTEARS with large margin. Perhaps, a more thorough comparison on all settings, e.g. nonlinear, Web, Netsim, is needed to confirm the real advantages of CASTOR. \n\nTherefore, I will keep my original evaluation."
                    }
                },
                "number": 12,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6010/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700668442357,
                "cdate": 1700668442357,
                "tmdate": 1700668442357,
                "mdate": 1700668442357,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    }
]