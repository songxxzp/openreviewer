[
    {
        "title": "Molecule Relaxation by Reverse Diffusion with Time Step Prediction"
    },
    {
        "review": {
            "id": "CFMAhgCsJT",
            "forum": "rwmWd2rjP1",
            "replyto": "rwmWd2rjP1",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission7978/Reviewer_2WpS"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission7978/Reviewer_2WpS"
            ],
            "content": {
                "summary": {
                    "value": "This paper focuses on the molecule relaxation task and proposes a method entitled MoreRed, where unstable molecules are seen as noisy samples to be denoised by a diffusion model equipped with a time step predictor to handle arbitrarily noisy inputs."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "2 fair"
                },
                "strengths": {
                    "value": "1. I appreciate the presentation of the paper; it is well-organized.\n2. The research problem is highly relevant to the ICLR community.\n3. The method is well-motivated.\n4. The experimental results are significant."
                },
                "weaknesses": {
                    "value": "1. I believe that the idea of using diffusion in this paper is quite straightforward and not very innovative, so I find this aspect lacking in novelty.\n2. The proposed \"Diffusion Time Step Prediction\" seems to have a loose connection with the main task of molecule relaxation studied in the paper. The authors also mentioned that it appears to be a generic technique that could be applied in other domains like image generation.\n\nIf this paper solely relies on diffusion to address the molecule relaxation task, I think it lacks significant innovation. Furthermore, the \"time step prediction\" aspect doesn't seem closely related to the main task."
                },
                "questions": {
                    "value": "The paper uses PaiNN as the backbone and compares it with force field (FF) methods also based on PaiNN. I would like to see the authors try using other different backbones to evaluate the robustness of their proposed method concerning the choice of backbone."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "6: marginally above the acceptance threshold"
                },
                "confidence": {
                    "value": "5: You are absolutely certain about your assessment. You are very familiar with the related work and checked the math/other details carefully."
                },
                "code_of_conduct": {
                    "value": "Yes"
                },
                "first_time_reviewer": {
                    "readers": [
                        "ICLR.cc/2024/Conference/Program_Chairs",
                        "ICLR.cc/2024/Conference/Submission7978/Senior_Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission7978/Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission7978/Reviewer_2WpS"
                    ]
                }
            },
            "number": 1,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission7978/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1697546977129,
            "cdate": 1697546977129,
            "tmdate": 1700707672158,
            "mdate": 1700707672158,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "Hk0PgQ3n3o",
                "forum": "rwmWd2rjP1",
                "replyto": "CFMAhgCsJT",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission7978/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission7978/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Answer 1/2 to Reviewer 2WpS"
                    },
                    "comment": {
                        "value": "Dear Reviewer 2WpS,\n\nthank you for taking your valuable time and providing us with questions and feedback. In the following, we provide answers to your concerns and questions.\n\n> **Weaknesses:**\n> \n> 1. I believe that the idea of using diffusion in this paper is quite straightforward and not very innovative, so I find this aspect lacking in novelty.\n> 2. The proposed \"Diffusion Time Step Prediction\" seems to have a loose connection with the main task of molecule relaxation studied in the paper. The authors also mentioned that it appears to be a generic technique that could be applied in other domains like image generation.\n> \n> If this paper solely relies on diffusion to address the molecule relaxation task, I think it lacks significant innovation. Furthermore, the \"time step prediction\" aspect doesn't seem closely related to the main task.\n\nWe respectfully disagree with the reviewer regarding a lack of novelty in our approach. The prediction of the diffusion time step is a novel contribution and applying diffusion as denoising to perform relaxation was not done before. Furthermore, the diffusion time predictor  is not \u201cloosely connected\u201d to the relaxation but a prerequisite for applying the diffusion model framework to relaxation: It enables the reverse-diffusion from arbitrarily noisy inputs, e.g. molecules that are close to their stable conformation. This is because diffusion models use the time step $t$ as an input, and therefore we must determine  from which $t$ the reverse diffusion should start for a given unstable molecule. We have added Fig. 2a to show how the predicted timestep relates to the RMSD of the unstable molecules (i.e. their distance to the ground-truth stable structure). One can see that the time step prediction enables the model to start relaxation at different noise levels, depending on the configuration of the unstable structure. \n\nAdditionally, our analysis show that adaptive scheduling based on the diffusion time prediction is beneficial as it allows the model to flexibly adjust the process (i.e. jump back and forth in time) which leads to significantly improved performance of the two flexible models (MoreRed-JT and MoreRed-AS) over the model where only the starting point is predicted (MoreRed-ITP). We added a figure to show some example trajectories of predicted time steps over relaxation that visualize this flexibility (see Fig. 2b and Section 4.1). This is also where the applicability of the time step prediction to other diffusion-based frameworks comes from: We show that having a flexible reverse diffusion process might not only be beneficial when starting from non-Gaussian input such as unstable molecules but also for data generation from scratch, e.g. when sampling molecules or images from Gaussian noise (see Tables 1 and 2).\n\nTherefore, the time step predictor is both an integral part of MoreRed and a promising contribution to other fields. We argue that our approach is an innovative method for relaxation of molecules. In our evaluation on the QM7-X dataset, we demonstrate  its usefulness in a thorough study where we show that it is a viable alternative to ML force field models that does not require the expensive training data with unstable structures with force labels, but still learns to map onto the data manifold of stable molecules."
                    }
                },
                "number": 15,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission7978/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700695516492,
                "cdate": 1700695516492,
                "tmdate": 1700695516492,
                "mdate": 1700695516492,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "dR5IpX8mkU",
                "forum": "rwmWd2rjP1",
                "replyto": "ash9RsiHe8",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission7978/Reviewer_2WpS"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission7978/Reviewer_2WpS"
                ],
                "content": {
                    "title": {
                        "value": "Thanks the authors' reply"
                    },
                    "comment": {
                        "value": "Thank you for your response, authors.\n\nRegarding the supplementary experiments to further validate the generality of using alternative backbones, I appreciate your effort in conducting these experiments within the limited time. However, I would have liked to see more diverse backbone choices. Since today is the last day of discussion, I understand that it might not be feasible to include additional experiments. For now, I consider this issue to be resolved.\n\nHowever, I still have some concerns about the contribution of \"Diffusion Time Step Prediction\" that the authors proposed. In the paper, the authors mentioned the following viewpoint:\n> To perform reverse diffusion starting from unstable molecules at arbitrary noise levels (i.e. not sampled from the noise distribution $p_T\\left(\\mathbf{x}\\_T\\right)$ ), it is necessary to set the initial diffusion time step appropriately. More specifically, we need to know from which diffused distribution $p_t$, the input molecule $\\tilde{\\mathbf{x}}$ was drawn. It is necessary to estimate an appropriate diffusion time step $\\hat{t}$ such that $p_{\\hat{t}}(\\tilde{\\mathbf{x}})$ is sufficiently high. Therefore, we propose a time step predictor in the next subsection.\n\nI acknowledge this viewpoint, as it is true that the input molecule structures provided to the model may not necessarily be sampled from $p_{T}$. However, for image generation, this issue does not exist since we sample noise from $p_{T}$ and progressively denoise it. Therefore, I find the motivation for its use in image generation less convincing.\n\nIn summary, I appreciate the authors' efforts and responses (although it is a bit late, and there is limited time left for discussion). Despite some lingering questions, I am willing to revise my score. I will temporarily increase my score to 6."
                    }
                },
                "number": 17,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission7978/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700707656198,
                "cdate": 1700707656198,
                "tmdate": 1700707656198,
                "mdate": 1700707656198,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "SN8r6ZDYFp",
                "forum": "rwmWd2rjP1",
                "replyto": "61KTJTNskL",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission7978/Reviewer_2WpS"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission7978/Reviewer_2WpS"
                ],
                "content": {
                    "title": {
                        "value": "Thanks for your further clarification"
                    },
                    "comment": {
                        "value": "Thank you for the further explanation, authors. \n\nYour response has effectively addressed my concerns, and I would be willing to raise my score to 8 if there is experimental support. However, time constraints are evidently not allowing for that. Additionally, I look forward to seeing whether your 'Diffusion Time Step Prediction' can be extended to discrete diffusion.\n\nThank you again for your response, and I look forward to an improved version of your paper in the future!"
                    }
                },
                "number": 21,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission7978/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700741622932,
                "cdate": 1700741622932,
                "tmdate": 1700741622932,
                "mdate": 1700741622932,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "YehofcD7KJ",
            "forum": "rwmWd2rjP1",
            "replyto": "rwmWd2rjP1",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission7978/Reviewer_jJY4"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission7978/Reviewer_jJY4"
            ],
            "content": {
                "summary": {
                    "value": "The authors propose a diffusion model to find stable molecular structures. When using it, instead of starting with a normal distribution, it becomes a reverse diffusion process from any unstable structure to a stable structure. Therefore, the critical technical contribution is to use a network that determines the corresponding diffusion time step for the input unstable structure.\nIn the experiments on QM7-X, the proposed method outperforms L-BFGS using a force field in thems of relaxed structure reproduction.\nIn addition, they show that diffusion time step prediction is empirically effective for molecule and image generation."
                },
                "soundness": {
                    "value": "2 fair"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "1 poor"
                },
                "strengths": {
                    "value": "* The proposed method can learn only from stable structures, so the required training data is much smaller than ML force fields. I think this advantage is significant when the training data is collected by a more accurate but heavy QM method, such as CCSD(T).\n* The diffusion time step prediction is a novel trick for reverse diffusion from non-gaussian input. \n* The readers can see the feasibility of the diffusion time step prediction via the experimental results in Figure 2 (Right)."
                },
                "weaknesses": {
                    "value": "* The application of the proposed method needs to be described so that the impact of this method is not clear.   I would like to see how the proposed molecule relaxation can be used in chemistry or biology.\n* The proposed method is 10 times slower than the structure optimization using a force field model.\n* It needs to be explained why the RMSD ratio, the RMSD after relaxation divided by the RMSD of the unstable initial structure, is used for the comparison. I am worried that the proposed method can be only accurate for initial structures near their relaxed structures. \n* No explanation why the diffusion time step prediction is also helpful for unconditional generation from normal distribution prior."
                },
                "questions": {
                    "value": "* What is the application of molecule relaxation without energy/force prediction? I guess you have some assumptions about applying the proposed method, but it is not described in the main text.\n* How long does it take to find the relaxed structure from an initial structure? Is 0.05s * 1000 (MoreRed-AS) vs 0.03s * 118 (FF model) correct?\n* Could you provide RMSD instead of RMSD ratio for Figure 3a?\n* Is it possible to output the energy or force of stable structures? It extends the applications of this method, such as crystal structure predictions. If the energy prediction head is added to the proposed method, Matbench Discovery[1] can be a good platform for evaluating the proposed method.\n\n[1] https://matbench-discovery.materialsproject.org/ , https://arxiv.org/abs/2308.14920"
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "details_of_ethics_concerns": {
                    "value": "No concern."
                },
                "rating": {
                    "value": "5: marginally below the acceptance threshold"
                },
                "confidence": {
                    "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 2,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission7978/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698371295668,
            "cdate": 1698371295668,
            "tmdate": 1699636982019,
            "mdate": 1699636982019,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "2SdL69AnQ7",
                "forum": "rwmWd2rjP1",
                "replyto": "YehofcD7KJ",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission7978/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission7978/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Answer 1/3 to Reviewer jJY4"
                    },
                    "comment": {
                        "value": "Dear reviewer jJY4,\n\nthank you for committing your valuable time to provide us with helpful, constructive feedback. In the following, we have addressed your concerns in a point-by-point answer.\n\n> **Weaknesses:**\n>\n> - The application of the proposed method needs to be described so that the impact of this method is not clear. I would like to see how the proposed molecule relaxation can be used in chemistry or biology.\n\nThank you for pointing this out. We updated the Introduction to reflect the possible impact of our framework more clearly. Our main target application is to find stable molecule structures by relaxing unstable structures proposed by cheap methods, e.g., with empirical MMFF, and our MoreRed can complement the well-established force field (FF) models in the domain where unstable structures with force labels for training FF models are not available or hard to obtain, e.g. when using very accurate but costly QM methods or when working with large structures. This could, for example, have a huge impact on crystal structure search, where large databases like MaterialsProject [2] exist, but only provide stable structures with labels. In such cases, all FF approaches cannot be used due to the lack of unstable structures. In our studies, we thoroughly evaluate our method on the QM7-X dataset as it allows us to train both MoreRed and an ML force field for a proper comparison. Our main contribution is that we propose a novel approach to perform structure optimization based on learning a pseudo potential energy surface using solely stable structures. While achieving promising results in systems in the scale of QM7-X opens a new promising path, extending diffusion models to handle periodic boundary conditions or very large molecules still is an open challenge in itself, and thus remains a task for future work [3].  \n\n> - The proposed method is 10 times slower than the structure optimization using a force field model.\n\nThis is partially true. We reported an average inference time per step for a batch of 128 structures of 0.03 s for the force field and 0.05 s for the MoreRed variants and a median (not mean because the distribution of the number of steps is highly skewed) number of relaxation steps until convergence of 118 for the FF model, 53, 219, and 1000 for MoreRed-ITP, MoreRed-JT, and MoreRed-AS, respectively. Hence, it is true that using the best performing variant MoreRed-AS takes longer in the median. However, the simplest variant that only predicts the starting $t$ (MoreRed-ITP) requires less steps than the ML force field in median while still outperforming it with regard to the RMSD ratio (see Figure 3a), and the MoreRed-JT variant, which outperforms the force field model and requires only two times more steps in median. On top of that, we find that all MoreRed variants can easily be parallelized during sampling and run the whole denoising on the GPU, while parallelization of the force field with the L-BFGS optimizer can be non-trivial. The parallelized optimization of 20k structures in our experiments took about 3 hours for MoreRed-AS on NVIDIA A100 while the sequential optimization with the force field model took about 49 hours utilizing the same hardware requirements and using L-BFGS from the ASE library, according to the log files. Because of the added overhead of loading from and to the GPU and converting to and from ASE classes after each relaxation iteration using L-BFGS in ASE, the running time increases further. We will give a more detailed theoretical calculation on the computation time for structure optimization in the questions section below as asked."
                    }
                },
                "number": 12,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission7978/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700695386283,
                "cdate": 1700695386283,
                "tmdate": 1700695386283,
                "mdate": 1700695386283,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "FtPXh6jDVv",
                "forum": "rwmWd2rjP1",
                "replyto": "6fAJKtsx4P",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission7978/Reviewer_jJY4"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission7978/Reviewer_jJY4"
                ],
                "content": {
                    "comment": {
                        "value": "Thank you for the very detailed response and additional experimental results.\n\n> To this end, one can for example use QM methods applied only to the stable molecules, which is much cheaper than those applied throughout the whole relaxation process. \n\nI agree that the proxy of QM methods in structure optimization can be an application of the proposed method.  \nI recommend citing references in which a structure optimization using the MLFF is employed before QM methods.\n\nNow, I would like to know how the reported RMSDs affect the subsequent analysis using QM methods.  For a simple example, I would like to know the DFT energy reproducibility of relaxed structures obtained by the proposed method and the MLFF."
                    }
                },
                "number": 18,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission7978/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700727622907,
                "cdate": 1700727622907,
                "tmdate": 1700727622907,
                "mdate": 1700727622907,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "D829L4kQfb",
            "forum": "rwmWd2rjP1",
            "replyto": "rwmWd2rjP1",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission7978/Reviewer_vPT3"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission7978/Reviewer_vPT3"
            ],
            "content": {
                "summary": {
                    "value": "This paper proposes to formulate molecular relaxation as a statistical learning task, defining a diffusion process that goes from unstable molecules to stable ones. This is in contrast to most state-of-the-art techniques that try to imitate the physical forces that drive this process in nature."
                },
                "soundness": {
                    "value": "2 fair"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "2 fair"
                },
                "strengths": {
                    "value": "- Using a diffusion process for molecular relaxation is novel and creative.\n- The problem is described in a very easy-to-understand and intuitive manner and the connection to diffusion modeling is well made.\n- The authors have written a great background on diffusion modeling."
                },
                "weaknesses": {
                    "value": "- The parameterization of the noise process is simple Gaussian blurring. It is not clear if this is a realistic assumption. It might be the case that this method wrongly describes molecules as stable when they are unstable, just because it is unable to identify the presence of Gaussian blurring.\n- In the second paragraph of page 8, the authors mention that adding their synthetic noise on stable molecules causes force field methods to not be able to optimize the molecules to their stable starting point, whereas their diffusion model is able to perform this. However, this is not a valid benchmark, since the force field methods are supposed to predict forces on physically plausible molecules whereas the diffusion process that the authors have designed makes no guarantees about the plausibility of the molecules. This experiment can be reframed to show a weakness of the proposed method, in which unphysical starting points still become \"stable\", which should not be the case.\n- Similar to the criticism above, I don't believe that the time step prediction performance as reported in section 4.1 is relevant as independent Gaussian noise on the atoms is somewhat easier to predict than stable vs unstable molecules. Since QM7-X contains unstable structures as well, a better approach would be to see the correlation between the time step predictions of the network versus the ground truth RMSDs.\n- The test runs should be done with a few different random seeds so that we see how much of a discrepancy exists between runs for this method, as it is statistical in nature."
                },
                "questions": {
                    "value": "- How does the time step prediction compare to non-fixed variance approaches such as [1] and [2]? It seems very similar to the approach taken there, why not mention how your work is different?\n- Dataset scaling is frequently mentioned as a benefit to this method, although it seems that with larger datasets, the probability that some of the modes of the mixture of Gaussians you use as your prior distribution would get mixed. That is, once you add some noise to some training structure $y_i = x_i + \\epsilon$, then you might have the issue that for some $j \\neq i$, $||y_i - x_i|| > ||y_i - x_j||$. Is this a problem? \n- For table 1, there are many methods that generate molecules on QM9, why not report some of those results as well?\n\nCitations\n\n[1] Alex Nichol and Prafulla Dhariwal. Improved denoising diffusion probabilistic models. arXiv:2102.09672, 2021.\n\n[2] Prafulla Dhariwal and Alex Nichol. Diffusion Models Beat GANs on Image Synthesis. arXiv:2105.05233, 2021."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "3: reject, not good enough"
                },
                "confidence": {
                    "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                },
                "first_time_reviewer": {
                    "value": "Yes",
                    "readers": [
                        "ICLR.cc/2024/Conference/Program_Chairs",
                        "ICLR.cc/2024/Conference/Submission7978/Senior_Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission7978/Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission7978/Reviewer_vPT3"
                    ]
                }
            },
            "number": 3,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission7978/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698686346649,
            "cdate": 1698686346649,
            "tmdate": 1699636981900,
            "mdate": 1699636981900,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "N6wW5mpZTq",
                "forum": "rwmWd2rjP1",
                "replyto": "D829L4kQfb",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission7978/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission7978/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Answer 1/3 to Reviewer vPT3"
                    },
                    "comment": {
                        "value": "Dear reviewer vPT3,\n\nthank you for taking your valuable time and providing us with valuable feedback. In the following, we have addressed your concerns and questions point-by-point. If you feel that we have addressed your concerns appropriately, we would be happy about an increased rating.\n\n> **Weaknesses:**\n>\n> - The parameterization of the noise process is simple Gaussian blurring. It is not clear if this is a realistic assumption. It might be the case that this method wrongly describes molecules as stable when they are unstable, just because it is unable to identify the presence of Gaussian blurring.\n\nAlthough the diffusion model  is trained with Gaussian blurred samples, it does not learn the Gaussian noise, but the derivative of the log probability or score function  (see Eq.(1)).   Therefore, it does not converge to an unstable point where no training points exist in the neighborhood, even if it does not contain Gaussian noise. However, it is indeed sensible to worry that our diffusion time predictor could learn to detect Gaussian noise (e.g., independent randomness or Gaussianity), instead of detecting the distance to the data manifold.  Following your suggestion in another point, we added the new Fig. 2a in the revision, which denies this worry.  Namely, the predicted diffusion time of the unstable molecules in QM7-X, which is NOT Gaussian blurred, has high correlation to the distance (RMSD) to their stable molecules, and the network never predicts time step 0 for any unstable molecules in QM7-X.  This implies that the diffusion time predictor does not rely on measuring Gaussian noise but measuring the distance to the data manifold by identifying specific correlations that occur in the stable structures in the training data. Our experiments in Fig. 3a also supports this, i.e. when we relax the unstable QM7-X structures, which were not Gaussian blurred,  MoreRed relaxes them as successfully as the ML force fields do. Furthermore, 94.5% of the molecules obtained in our unconditional data generation experiments with the time step prediction are physically valid, i.e. not just any structures without Gaussian noise (see Table 1). We appreciate the reviewer\u2019s insightful suggestion, which cleared this suspicion that general readers would have. Although training models with the force labels is a more physically grounded approach than using Gaussian blur, obtaining a sufficient amount of training force labels is computationally expensive.  Our main finding in this paper is that training a diffusion model, along with the diffusion time predictor, on Gaussian blurred, unlabeled stable structures can be a much cheaper alternative, requiring 100 times less data, but still capturing a physically meaningful data manifold of stable structures."
                    }
                },
                "number": 9,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission7978/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700695267763,
                "cdate": 1700695267763,
                "tmdate": 1700695267763,
                "mdate": 1700695267763,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "28289FpLdp",
            "forum": "rwmWd2rjP1",
            "replyto": "rwmWd2rjP1",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission7978/Reviewer_PyaS"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission7978/Reviewer_PyaS"
            ],
            "content": {
                "summary": {
                    "value": "In this work, the authors studied a crucial problem in molecular modeling, molecule relaxation, via the methodology of generative modeling. Instead of learning a force field model to conduct simulation for molecule relaxation, the authors proposed MoreRed, which directly models the Boltzmann distribution of equilibrium molecular structures and also learns a diffusion step predictor for relaxation. Experiments are conducted to demonstrate the performance of MoreRed on molecular relaxation tasks."
                },
                "soundness": {
                    "value": "2 fair"
                },
                "presentation": {
                    "value": "2 fair"
                },
                "contribution": {
                    "value": "2 fair"
                },
                "strengths": {
                    "value": "1. The molecule relaxation task is of great interest to chemistry, biology and other scientific communities.\n2. The proposed approach seems to be novel compared to previous approaches."
                },
                "weaknesses": {
                    "value": "- **Regarding the evaluation settings**: As stated in Section 4.2, the authors use the QM7-X dataset to evaluate the molecule relaxation performance. The unstable molecules in this dataset were generated by sampling from the Boltzmann distribution of the stable molecules. The confidence of such data generation procedure is in doubt: (1) In real-world applications, given a molecule, we usually use either random conformation sampling or cheap conformation optimization (e.g., empirical MMFF) to obtain initial molecular structures. The authors should further clarify whether these generated unstable molecules in QM7-X match the real-world settings. (2) Beyond the small organic molecules, molecular relaxation is widely used to investigate the equilibrium state of molecular systems like the adsorbate-catalyst complex or protein-ligand complex. There exist large-scale benchmarks that are more related to real-world settings like Open Catalyst Project (IS2RE and IS2RS tasks). It would be more convincing to verify the proposed methods on these challenging tasks.\n- **Regarding the generality of the proposed methods**: As a general framework, the proposed MoreRed can use different equivariant backbone models. Given the rich literature of equivariant networks, it would be more convincing to verify the generality of MoreRed with different architectures.\n- **Regarding the compared baselines**: For molecule relaxation tasks, the authors only compare the proposed three variants of MoreRed with corresponding NN-based Force Field models on the RMSD metric. For the machine learning based molecule relaxation approaches, there indeed exists strong baselines like [1], and there also exists generative models capable of transforming one data distribution to another data distribution that also lie in the settings of the molecule relaxation tasks [2]. It would enhance the quality of this paper if the authors could provide further discussions and comparisons to these approaches.\n- **Regarding the quality of unconditional generation**: I do not quite grasp how the diffusion time step predictor improve the unconditional generation quality. Moreover, the experiments also lack strong and advanced baselines [3,4,5].\n\n[1] Lu, Shuqi, et al. \"Highly Accurate Quantum Chemical Property Prediction with Uni-Mol+.\" arXiv preprint arXiv:2303.16982 (2023).\n\n[2] Su, X., Song, J., Meng, C., & Ermon, S. (2022). Dual diffusion implicit bridges for image-to-image translation. arXiv preprint arXiv:2203.08382.\n\n[3] Xu, M., Yu, L., Song, Y., Shi, C., Ermon, S., & Tang, J. (2022). Geodiff: A geometric diffusion model for molecular conformation generation. arXiv preprint arXiv:2203.02923.\n\n[4] Jing, Bowen, et al. \"Torsional diffusion for molecular conformer generation.\" Advances in Neural Information Processing Systems 35 (2022): 24240-24253.\n\n[5] Xu, M., Powers, A. S., Dror, R. O., Ermon, S., & Leskovec, J. (2023, July). Geometric latent diffusion models for 3d molecule generation. In International Conference on Machine Learning (pp. 38592-38610). PMLR."
                },
                "questions": {
                    "value": "Please see the comments in the Weaknesses section."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "5: marginally below the acceptance threshold"
                },
                "confidence": {
                    "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 4,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission7978/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698731915744,
            "cdate": 1698731915744,
            "tmdate": 1699636981788,
            "mdate": 1699636981788,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "opFZF2ZSTu",
                "forum": "rwmWd2rjP1",
                "replyto": "28289FpLdp",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission7978/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission7978/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Answer 1/3 to Reviewer PyaS"
                    },
                    "comment": {
                        "value": "Dear reviewer PyaS,\n\nthank you for taking your precious time and providing us with valuable feedback. In the following, we have addressed your concerns and questions point-by-point. If you feel that we have addressed your concerns appropriately, we would be happy about an increased rating.\n\n> **Weaknesses:**\n> \n> - **Regarding the evaluation settings:** As stated in Section 4.2, the authors use the QM7-X dataset to evaluate the molecule relaxation performance. The unstable molecules in this dataset were generated by sampling from the Boltzmann distribution of the stable molecules. The confidence of such data generation procedure is in doubt: (1) In real-world applications, given a molecule, we usually use either random conformation sampling or cheap conformation optimization (e.g., empirical MMFF) to obtain initial molecular structures. The authors should further clarify whether these generated unstable molecules in QM7-X match the real-world settings. (2) Beyond the small organic molecules, molecular relaxation is widely used to investigate the equilibrium state of molecular systems like the adsorbate-catalyst complex or protein-ligand complex. There exist large-scale benchmarks that are more related to real-world settings like Open Catalyst Project (IS2RE and IS2RS tasks). It would be more convincing to verify the proposed methods on these challenging tasks.\n\nWe agree that the distribution of the initial unstable molecules in the real-world setting does not follow the Boltzmann distribution, and in this sense, QM7-X is maybe not the optimal data set for evaluation.  However, due to the high computational cost of generating datasets for chemical structures, only a limited number of these datasets is available to use. For a fair comparison of our method to machine learning force fields on the task of structure optimization, we require a dataset that provides a large number of stable/equilibrium structures with various compositions, as well as corresponding unstable/non-equilibrium variants of these with labels for energy and forces. Although the QM7-X dataset has some disadvantages, it is to the best of our knowledge the only molecule dataset fulfilling these requirements. For this reason it is often used to test the performance of machine learning force field models [6-8], which were proposed for the same real-world applications. Besides, it is common practice to utilize datasets in the scale of QM7-X like QM9, QM7 and MD17 to validate novel machine learning force fields [7-14]. \n\nThe stable structures of QM7-X are generated in exactly the same way you described. First,  a set of sufficiently different initial 3D structures were obtained using the MMFF94 force field for each SMILE string to cover many conformations. Then, all structures were subsequently optimized with accurate DFT simulations. The unstable structures were generated by displacing each molecular structure along a linear combination of normal mode coordinates computed at the DFTB3+MBD level within the harmonic approximation. Based on the equipartition theorem from classical statistical mechanics, the normal modes for the displacements were chosen in such a way that the energy difference between the unstable and stable structures follow a Boltzmann distribution. In their paper, the authors of the QM7-X dataset argue theoretically and provide analysis showing that the resulting structures are physically relevant  and cover the potential energy surface.\n\nThe distribution of the unstable structures in QM7-X is indeed different from the real-world distribution, where the candidates are obtained with cheap optimization methods. However, both give physically feasible unstable structures that cover the potential energy surface with non-Gaussian noise, and therefore we expect that the results are still indicative for the realistic scenario. In the revision, we added a discussion on the choice and shortcomings of QM7-X (see Appendix A.4.1).\n\nWhile large scale benchmarks like the Open Catalyst Project would provide a challenging task to test structure optimization methods, it is a special use case of molecular relaxation, which requires the model to handle structures with periodic boundary conditions, and therefore is out of the scope of our contribution. Extending diffusion models and generative models for atomistic systems to handle periodic boundary conditions is an interesting open challenge in itself [17] and we leave it as future work."
                    }
                },
                "number": 6,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission7978/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700694909087,
                "cdate": 1700694909087,
                "tmdate": 1700694909087,
                "mdate": 1700694909087,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    }
]