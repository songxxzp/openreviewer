[
    {
        "title": "Non-Asymptotic Analysis for Single-Loop (Natural) Actor-Critic with Compatible Function Approximation"
    },
    {
        "review": {
            "id": "NNMAChChY9",
            "forum": "E3jq8f8t3d",
            "replyto": "E3jq8f8t3d",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission3988/Reviewer_2Umy"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission3988/Reviewer_2Umy"
            ],
            "content": {
                "summary": {
                    "value": "The paper provides an improved analysis of the actor-critic algorithm. It introduces compatible function approximation to compute the value function, which eliminates the critic approximation error, while keeping the state-of-the-art rate in the sample complexity."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "3 good"
                },
                "strengths": {
                    "value": "The paper is easy to follow. The main idea is clearly stated and makes sense. The paper delivers interesting results, which justify the novelty of the work."
                },
                "weaknesses": {
                    "value": "1. Since the compatible function approximation (5) is not a straightforward fact, it's better to restate this conclusion in the form of a proposition. It could also be helpful if a quick proof can be attached in the appendix. \n\n2. A high-level roadmap of the proof is appreciated. It could make it easier to follow the proof as it's already notation heavy."
                },
                "questions": {
                    "value": "I didn't read the proof in detail. But intuitively, in the previous works, the source of $\\varepsilon_{\\textrm{critic}}$ is the previous proof needs to bound a term like $\\Vert\\nabla_\\omega J(\\pi_\\omega) - \\mathbb{E}[Q_\\theta^{\\pi_\\omega}\\nabla_\\omega\\log\\pi_\\omega(a\\vert s)]\\Vert^2$, which is the difference between the true gradient and the estimated gradient using the value function class. However, due to the authors' setting, this term automatically becomes 0. In this case, why can't one reuse the previous proofs, just replacing this term by 0? Does the introduction of compatible function approximation leads to new difficulties that need additional theoretical novelty to overcome them?"
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "8: accept, good paper"
                },
                "confidence": {
                    "value": "2: You are willing to defend your assessment, but it is quite likely that you did not understand the central parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 1,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission3988/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698292246100,
            "cdate": 1698292246100,
            "tmdate": 1699636360875,
            "mdate": 1699636360875,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "i3jjclE36t",
                "forum": "E3jq8f8t3d",
                "replyto": "NNMAChChY9",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission3988/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission3988/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Part 1"
                    },
                    "comment": {
                        "value": "**Weaknesses 1: Restate compatible function approximation conclusion in eq. (5) in the form of a proposition and provide the proof.**\n\nThanks for the suggestion. We have added the proof of eq. (5) in the revision. For convenience, we also include the proposition and the proof here.\n\n\nProposition 1: With compatible function approximation, the policy gradient $\\nabla J(\\pi_\\omega)$ can be rewritten as:\n$$\n \\nabla J(\\pi_\\omega) =\\mathbb E_{D_{\\pi_\\omega}}[ \\nabla \\log \\pi_\\omega(a|s)Q^{\\pi_\\omega}(s,a)]=\n \\mathbb E_{D_{\\pi_\\omega}}[\\phi_\\omega(s,a)(\\phi^\\top_\\omega(s,a)\\bar\\theta_\\omega^*)].$$\n The natural policy gradient can be written as:\n$$\\widetilde{\\nabla} J(\\pi_\\omega)=\\bar \\theta^*_\\omega.$$\n\n**Proof:** \nBy eq. (4), $\\bar \\theta^*_\\omega$ is the minimizer of  eq. (4) and therefore it should satisfy that \n$$\n\\mathbb E_{D_{\\pi_\\omega}}[(Q^{\\pi_\\omega}(s,a)-\\phi^\\top_\\omega(s,a)\\bar \\theta_\\omega^*)\\phi_\\omega(s,a) ]=0.\n$$\nThis further implies that\n$$\\mathbb E_{D_{\\pi_\\omega}}[Q^{\\pi_\\omega}(s,a)\\phi_\\omega(s,a) ]=\\mathbb E_{D_{\\pi_\\omega}}[\\phi_\\omega(s,a)\\phi^\\top_\\omega(s,a)\\bar \\theta_\\omega^*].\n$$\nNow we consider the policy gradient $\\nabla J(\\pi_\\omega)$, and it  can be shown that\n$$\n\\nabla J(\\pi_\\omega) =\\mathbb E_{D_{\\pi_\\omega}}[ \\nabla \\log \\pi_\\omega(a|s)Q^{\\pi_\\omega}(s,a)]=\n \\mathbb E_{D_{\\pi_\\omega}}[\\phi_\\omega(s,a)\n (\\phi^\\top_\\omega(s,a)\\bar\\theta_\\omega^*)].\n $$\n\nFurthermore, for the natural policy gradient, we have that $$\\widetilde{\\nabla} J(\\pi_\\omega)= F_{\\omega}^{-1} \\mathbb E_{D_{\\pi_\\omega}}[\\phi_\\omega(s,a)\\phi_\\omega(s,a)^\\top{\\bar\\theta}^*_\\omega]=F_\\omega^{-1} \\mathbb E_{D_{\\pi_\\omega}}[\\phi_\\omega(s,a)\\phi_\\omega(s,a)^\\top   ]\\bar \\theta^*_\\omega=\\bar \\theta^*_\\omega. \n$$"
                    }
                },
                "number": 4,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission3988/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700286849599,
                "cdate": 1700286849599,
                "tmdate": 1700310351261,
                "mdate": 1700310351261,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "Bb6zil0BSi",
                "forum": "E3jq8f8t3d",
                "replyto": "NNMAChChY9",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission3988/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission3988/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Part 2"
                    },
                    "comment": {
                        "value": "**Weaknesses 2: high-level roadmap of the proof.**\nHere we provide a proof sketch for the NAC algorithm to highlight major challenges and our technical novelties. The analysis of NAC contains of most major technical novelty in the AC analysis.\n\n\n**Proof Sketch:**\nFor simplicity of presentation, we set $\\alpha_t=\\alpha,\\beta_t=\\beta,\\gamma_t=\\gamma$, $\\hat t=\\lceil \\frac{3\\log T}{\\bar \\lambda_{\\min}\\alpha}\\rceil$ and \n$\\widetilde T=\\hat t\\lceil \\frac{T}{\\hat t \\log T} \\rceil$.\n We denote by $\\pi^*$ the global optimal policy and $M_t=\\mathbb E[||\\theta_{t}-\\theta^*_{t}||^2_2]+ \\mathbb E[(\\eta_t-J(\\omega_t))^2]$ the sum of the tracking error and the estimation error of the average reward. Denote by $D(\\omega_t)=KL(\\pi^*|\\pi_t)$ the KL divergence between policy $\\pi^*$ and $\\pi_t$.\n\n\n**Step 1 (Error decomposition):**\nAccording to the smoothness property of $D(\\omega)$ with respect to $\\omega$, we bound the performance gap between the current policy and the optimal policy (optimality gap) as follows:\n\\begin{align}\n    \\frac{1}{\\widetilde T}\\sum_{j=t}^{t+\\widetilde T-1}\\mathbb E[J(\\pi^*)-J(\\omega_j)] \n     \\leq \\frac{D(\\omega_{t+\\widetilde T})-D(\\omega_t)}{\\widetilde T \\beta }+ \\mathcal{O}\\left(\\sqrt{\\frac{1}{\\widetilde T}\\sum_{j=t}^{t+\\widetilde T-1} M_j}\\right)+\\mathcal{O}(C_\\infty \\sqrt{\\varepsilon_{\\text{actor}}}+ \\beta+m\\rho^k).\n\\end{align}\n\n\n\n\n**Step 2 (Estimation error in the average reward):** In this step, we analyze estimation error in the average reward:\n $\\eta_t-J(\\omega_t)$. We provide a tight characterization of this error:\n\\begin{align}\n    \\mathbb E[(\\eta_{t+1}-J(\\omega_{t+1}))^2] \\leq (1-\\gamma)\\mathbb E[(\\eta_{t}-J(\\omega_{t}))^2] + \\mathcal{O}(\\beta \\mathbb E[||\\nabla J(\\omega_t)||_2^2])\n    + \\mathcal{O}( m\\rho^k\\gamma +k^2 \\gamma^2 +k^2 \\beta^2).\n\\end{align}\nOne of our key novelties lies in that we bound this estimation error using the gradient norm $\\mathbb E[||\\nabla J(\\omega_t)||_2^2]$. The above bound itself is tighter than the existing one in (Wu et al., 2020).\n\n\n\n\n**Step 3 (Tracking error)**: \nIn this step, we bound the tracking error in the critic: $||\\theta_t-\\theta_t^*||_2^2$. \n\nBy the TD error step in Algorithm 1, we decompose the term $||\\theta_{t+1}-\\theta_{t+1}^*||^2_2$ as follows:\n\n$    ||\\theta_{t+1}-\\theta_{t+1}^*||^2_2 \\leq || \\theta_t-\\theta_{t}^* ||^2_2+ \\alpha^2 ||\\delta_t z_t||^2_2+|| \\theta_{t}^*-\\theta_{t+1}^*||_2^2 \n$\n\n$+ 2 \\alpha\\langle\\theta_t-\\theta_{t}^*, \\delta_t z_t \\rangle  + 2\\alpha \\langle \\delta_t z_t, \\theta_{t}^* - \\theta_{t+1}^* \\rangle+ 2 \\langle\\theta_t-\\theta_{t}^*, \\theta_{t}^*-\\theta_{t+1}^* \\rangle.$\n\nAnother key challenge lies in  how to bound the term \n$\\mathbb E[\\langle \\theta_t-\\theta_t^*, \\delta_t z_t\\rangle ] $.  We develop a novel technique of auxiliary Markov chain to decompose this error into two parts: 1) error due to time-varying feature function and 2) error due to time-varying policy. Specifically, consider the first Markov chain generated from the algorithm:\n$$s_0,a_0 \\overset{\\pi_0\\times P}{\\to} s_1,a_1\\to...\\to s_t,a_t \\overset{\\pi_t\\times P}{\\to}s_{t+1},a_{t+1},$$ where at each time $j$, the action is chosen according to $\\pi_j$ and the transition kernel is $P$. Here $z_t=\\sum_{j=t-k}^t \\phi_j(s_j,a_j)$ is the eligibility trace used in the algorithm. It can be seen that in $z_t$, the feature $\\phi_j$ changes with $j$, and the distribution of $s_j,a_j$ depends on the time-varying policy $\\pi_j$. We then design an auxiliary eligibility trace $\\hat z_t=\\sum_{j=t-k}^t \\phi_t(s_j,a_j)$, where the feature is fixed to be $\\phi_t$, and only the the distribution of $s_j,a_j$ depends on the time-varying policy $\\pi_j$. To further handle the time-varying distribution of  $s_j,a_j$, we design an auxiliary Markov chain (denoted by $A1$) as follows:\n$$A1: ( s_0,\\widetilde  a_0 )\\sim \\pi_t\\overset{\\pi_t\\times P}{\\to} \\widetilde s_1,\\widetilde a_1\\overset{\\pi_t\\times P}{\\to}...\\overset{\\pi_t\\times P}{\\to}\\widetilde  s_t,\\widetilde a_t \\overset{\\pi_t\\times P}{\\to}\\widetilde s_{t+1},\\widetilde a_{t+1},$$ where the action at each time $j$ is always chosen according to a fixed policy $\\pi_t$. Based on this auxiliary Markov chain, we introduce another auxiliary eligibility trace $\\widetilde  z_t=\\sum_{j=t-k}^t \\phi_t(\\widetilde s_j,\\widetilde a_j)$, where it uses a fixed feature $\\phi_t$, and samples from this auxiliary Markov chain. Lastly, we design a second auxiliary Markov chain (denoted by $A2$):\n$$A2: (\\bar s_0,\\bar  a_0)\\sim D_t \\overset{\\pi_t\\times P}{\\to} \\bar s_1,\\bar a_1\\overset{\\pi_t\\times P}{\\to}...\\overset{\\pi_t\\times P}{\\to}\\bar  s_t,\\bar a_t \\overset{\\pi_t\\times P}{\\to}\\bar s_{t+1},\\bar a_{t+1}$$\nwhere the only difference between A2 and A1 lies in the initial state distribution. Then we define the last auxiliary eligibility trace as $\\bar  z_t=\\sum_{j=t-k}^t \\phi_t(\\bar s_j,\\bar a_j)$."
                    }
                },
                "number": 10,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission3988/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700298082356,
                "cdate": 1700298082356,
                "tmdate": 1700310372267,
                "mdate": 1700310372267,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "uDzquASyUd",
                "forum": "E3jq8f8t3d",
                "replyto": "NNMAChChY9",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission3988/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission3988/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Part 3"
                    },
                    "comment": {
                        "value": "**Q1:  Why can't one reuse the previous proofs, just replacing the policy gradient bias term by 0?**\n\nIn previous AC works, e.g., (Wu et al.,2020) (Xu et al., 2020), the error in the critic is bounded by $$\\varepsilon_{\\text{approx.}}=\\sqrt{\\mathbb E[(Q_{\\pi_\\omega}(s,a)-\\phi^\\top(s,a) \\theta^*_\\omega)^2]},$$ where the $\\theta_\\omega^*$ is the limiting point of the critic under the policy $\\pi_\\omega$. Their analysis bound the bias in the gradient using the gap between the true $Q$ function and the critic output, $\\varepsilon_{\\text{approx.}}$, and this gap is typically non-zero. Their analysis are based on the implicit assumption that $\\varepsilon_{\\text{approx.}}$ will be small, and thus the critic returns an accurate estimation of the true $Q$ function. \n\nWe would like to highlight that using compatible function approximation, we do not need $\\varepsilon_{\\text{approx.}}$ to be small. This term $\\varepsilon_{\\text{approx.}}$ could be non-zero, however, by eq. (3), the policy gradient will still be unbiased. \nIn other words, we do not need to get the exact $Q$ from the critic, as long as the critic solves eq. (2), the gradient will be unbiased using compatible function approximation.  Therefore, the analysis is different, and cannot be obtained by simply letting $\\varepsilon_{\\text{approx.}}=0$.\n\nYue Frank Wu, Weitong Zhang, Pan Xu, and Quanquan Gu. \"A finite-time analysis of two time-scale actor-critic methods.\" Advances in Neural Information Processing Systems, 33:17617\u201317628, 2020\n\nXu, Tengyu, Zhe Wang, and Yingbin Liang. \"Non-asymptotic convergence analysis of two time-scale (natural) actor-critic algorithms.\" arXiv preprint arXiv:2005.03557 (2020).\n\n**Q2:  What are the new difficulties due to compatible function approximation?**\n\nAs we discussed in the proof sketch (provided above), the key challenge lies in the time-varying feature function due to the changing policy. Our key novelty lies in the design of auxiliary Markov chains and auxiliary eligibility trace as in Step 3 in the proof sketch."
                    }
                },
                "number": 16,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission3988/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700409115415,
                "cdate": 1700409115415,
                "tmdate": 1700411035352,
                "mdate": 1700411035352,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "uzEEl72Fzw",
            "forum": "E3jq8f8t3d",
            "replyto": "E3jq8f8t3d",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission3988/Reviewer_XG7r"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission3988/Reviewer_XG7r"
            ],
            "content": {
                "summary": {
                    "value": "The authors develop tightest non-asymptotic convergence bounds for both Actor-critic (AC) and natural AC (NAC) algorithms with compatible function approximation. The major technical novelty lies in analyzing the stochastic bias due to policy-dependent and time-varying compatible function approximation in the critic, and handling the non-ergodicity of the MDP due to the single Markovian sample trajectory. This is a nice theoretical contribution for the area of reinforcement learning."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "3 good"
                },
                "strengths": {
                    "value": "The authors develop tightest non-asymptotic convergence bounds for both Actor-critic (AC) and natural AC (NAC) algorithms with compatible function approximation. The major technical novelty lies in analyzing the stochastic bias due to policy-dependent and time-varying compatible function approximation in the critic, and handling the non-ergodicity of the MDP due to the single Markovian sample trajectory. This is a nice theoretical contribution for the area of reinforcement learning."
                },
                "weaknesses": {
                    "value": "There is no discussion on the weakness or limitation of theoretical results, even in the conclusion part."
                },
                "questions": {
                    "value": "What are the limitations of the analysis presented in this paper? How to verify the assumptions made in practice?"
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "details_of_ethics_concerns": {
                    "value": "N/A"
                },
                "rating": {
                    "value": "8: accept, good paper"
                },
                "confidence": {
                    "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
                },
                "code_of_conduct": {
                    "value": "Yes"
                },
                "first_time_reviewer": {
                    "value": "Yes",
                    "readers": [
                        "ICLR.cc/2024/Conference/Program_Chairs",
                        "ICLR.cc/2024/Conference/Submission3988/Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission3988/Reviewer_XG7r",
                        "ICLR.cc/2024/Conference/Submission3988/Senior_Area_Chairs"
                    ]
                }
            },
            "number": 2,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission3988/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698781912045,
            "cdate": 1698781912045,
            "tmdate": 1700655156061,
            "mdate": 1700655156061,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "7b4QJAi17B",
                "forum": "E3jq8f8t3d",
                "replyto": "uzEEl72Fzw",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission3988/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission3988/Authors"
                ],
                "content": {
                    "comment": {
                        "value": "**Weaknesses and Questions:  limitations of the analysis presented in this paper and how to verify the assumptions made in practice**\n\n\nI. As a theoretical analysis work, possible limitation of our work lies in whether the assumptions are reasonable and can be verified.\n\nAssumption 1 of uniform ergodicity  is a widely used assumption in RL analysis. A Markov chain is uniformly ergodic if it is irreducible (i.e., possibly get to any state from any state) and aperiodic (Levin \\& Peres 2017). Now consider an environment for which there exists a policy that can map any state to any  state with nonzero probability (i.e., irreducibility holds) and gets back to the same state aperiodically. Such environments are commonly encountered in practice. Then for any $\\omega$, as long as the policy  explores (i.e., with non-zero probability to take any action at any state), the induced Markov chain remains to be irreducible and aperiodic, and is hence ergodic. Therefore, such an assumption is realistic, and is guaranteed for aforementioned environments. We also agree that if Assumption 1 does not hold, new techniques will be needed to understand the non-asymptotic error bounds of many RL algorithms.\n\nAssumption 2 can be satisfied if we use some popular policy parameterization, such as softmax,  neural network with analytic activation functions e.g., logistic, tanh, and softplus.  These results can be found in (Du et al., 2019; Miyato et al. 2018; Neyshabur, 2017).\n\nAssumption 3 can be satisfied if we carefully design the policy parameterization so that it is sufficiently explorative, e.g., softmax and $\\epsilon$-greedy policy. \n\nII. Another possible limitation in the algorithm and analysis is the use of the projection (Line 9 in Algorithm 1). We conjecture that this projection may not be necessarily needed to guarantee convergence and to derive the non-asymptotic bounds (see e.g., Srikant \\& Ying 2019). However, this projection helps to simplify the proof, and without which the proof will be rather cumbersome. \n\nDavid A. Levin and Yuval Peres. Markov chains and mixing times. Vol. 107. American Mathematical Soc., 2017.\n\nSimon Du, Jason Lee, Haochuan Li, Liwei Wang, and Xiyu Zhai. \"Gradient descent finds global minima of deep neural networks.\" International conference on machine learning. PMLR, 2019.\n\nTakeru Miyato, Toshiki Kataoka, Masanori Koyama, and Yuichi Yoshida. \"Spectral Normalization for Generative Adversarial Networks.\" International Conference on Learning Representations. 2018.\n\nNeyshabur, Behnam. \"Implicit regularization in deep learning.\" arXiv preprint arXiv:1709.01953 (2017).\n\nSrikant, Rayadurgam, and Lei Ying. \"Finite-time error bounds for linear stochastic approximation andtd learning.\" Conference on Learning Theory. PMLR, 2019."
                    }
                },
                "number": 2,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission3988/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700235546972,
                "cdate": 1700235546972,
                "tmdate": 1700411862855,
                "mdate": 1700411862855,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "Bojj1309qy",
                "forum": "E3jq8f8t3d",
                "replyto": "7b4QJAi17B",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission3988/Reviewer_XG7r"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission3988/Reviewer_XG7r"
                ],
                "content": {
                    "comment": {
                        "value": "Thanks authors for pointing out the potential limiations and the ways to verify key assumptions. I would like to raise the socre to 8!"
                    }
                },
                "number": 18,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission3988/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700655273614,
                "cdate": 1700655273614,
                "tmdate": 1700655273614,
                "mdate": 1700655273614,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "ny7bSVKKnl",
            "forum": "E3jq8f8t3d",
            "replyto": "E3jq8f8t3d",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission3988/Reviewer_VajU"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission3988/Reviewer_VajU"
            ],
            "content": {
                "summary": {
                    "value": "This paper provides tight analyses for non-asymptotic convergence bounds of actor-critic and natural actor-critic algorithms on single-trajectory single-loop online RL problems."
                },
                "soundness": {
                    "value": "4 excellent"
                },
                "presentation": {
                    "value": "1 poor"
                },
                "contribution": {
                    "value": "3 good"
                },
                "strengths": {
                    "value": "I think this work really pushes the RL community research efforts further by answering:\n\n> can we give tight analyses for non-asymptotic convergence bounds of actor-critic and natural actor-critic algorithms on single-trajectory single-loop online RL problems?\n\nThe main contribution of improvement of results is worthy for publication."
                },
                "weaknesses": {
                    "value": "Firstly, I only took a closer look at AC sample complexity analyses (Lemma 7, 8, 10, and Proposition 6) and everything seemed alright. \n\nI have only a few weakness for this work as follows:\n\n- The main paper writing needs to be improved. Yes, the soundness of this paper is excellent. But right from Section 1.2, it's just about \"getting sota results compared to other works\". The main analyses idea in this work compared to others which helps improve the bounds are missing. To be honest, I am only familiar with high level analyses of (Chen et al 2022) and few generic two-timescale algorithms, which shares the AC analyses in this work. But I am totally missing the improvement bounds provided here! Just providing one line (below quote) as the core idea for the whole 50 pages analyses paper, does not provide any useful information.\n> In this paper, we design a novel approach to explicitly bound this error. The central idea is to construct an auxiliary eligibility trace with fixed feature to approximate the eligibility trace with time-varying feature (in the critic, we use k-step TD with compatible function approximation).\n\nSo please write more discussions and details for the main results and proof ideas. I understand this is presentation is limited by page restriction, but it can be done through a thorough writing process. For example, AC results can be pushed to appendix looking at the generality of NAC, or the other way around.\n\n- This paper considers average MDP formulation. Most of the comparisons in Table 1 and 2 are in the discounted setting. Please mention these important differences and make fair comparisons by arguing the connection between the two settings. I am not sure if this distinction is what is helping to reach current bounds. Thus my point above is super critical for the quality.\n\nI am open to discussions with the authors and reviewers to make sure the work quality matches the score, which I believe so at this point, but a potential reach to 8 definitely exists. All the best for future decisions!"
                },
                "questions": {
                    "value": "-na-"
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "6: marginally above the acceptance threshold"
                },
                "confidence": {
                    "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 3,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission3988/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698816856411,
            "cdate": 1698816856411,
            "tmdate": 1699636360703,
            "mdate": 1699636360703,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "YiAy76O2LY",
                "forum": "E3jq8f8t3d",
                "replyto": "ny7bSVKKnl",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission3988/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission3988/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Part 1"
                    },
                    "comment": {
                        "value": "**Weaknesses1:  Details of this paper's novelty.**\nHere we provide a proof sketch for the NAC algorithm to highlight major challenges and our technical novelties. The analysis of NAC contains of most major technical novelty in the AC analysis.\n\n\n**Proof Sketch:**\nFor simplicity of presentation, we set $\\alpha_t=\\alpha,\\beta_t=\\beta,\\gamma_t=\\gamma$, $\\hat t=\\lceil \\frac{3\\log T}{\\bar \\lambda_{\\min}\\alpha}\\rceil$ and \n$\\widetilde T=\\hat t\\lceil \\frac{T}{\\hat t \\log T} \\rceil$.\n We denote by $\\pi^*$ the global optimal policy and $M_t=\\mathbb E[||\\theta_{t}-\\theta^*_{t}||^2_2]+ \\mathbb E[(\\eta_t-J(\\omega_t))^2]$ the sum of the tracking error and the estimation error of the average reward. Denote by $D(\\omega_t)=KL(\\pi^*|\\pi_t)$ the KL divergence between policy $\\pi^*$ and $\\pi_t$.\n\n\n**Step 1 (Error decomposition):**\nAccording to the smoothness property of $D(\\omega)$ with respect to $\\omega$, we bound the performance gap between the current policy and the optimal policy (optimality gap) as follows:\n\\begin{align}\n    \\frac{1}{\\widetilde T}\\sum_{j=t}^{t+\\widetilde T-1}\\mathbb E[J(\\pi^*)-J(\\omega_j)] \n     \\leq \\frac{D(\\omega_{t+\\widetilde T})-D(\\omega_t)}{\\widetilde T \\beta }+ \\mathcal{O}\\left(\\sqrt{\\frac{1}{\\widetilde T}\\sum_{j=t}^{t+\\widetilde T-1} M_j}\\right)+\\mathcal{O}(C_\\infty \\sqrt{\\varepsilon_{\\text{actor}}}+ \\beta+m\\rho^k).\n\\end{align}\n\n\n\n\n**Step 2 (Estimation error in the average reward):** In this step, we analyze estimation error in the average reward:\n $\\eta_t-J(\\omega_t)$. We provide a tight characterization of this error:\n\\begin{align}\n    \\mathbb E[(\\eta_{t+1}-J(\\omega_{t+1}))^2] \\leq (1-\\gamma)\\mathbb E[(\\eta_{t}-J(\\omega_{t}))^2] + \\mathcal{O}(\\beta \\mathbb E[||\\nabla J(\\omega_t)||_2^2])\n    + \\mathcal{O}( m\\rho^k\\gamma +k^2 \\gamma^2 +k^2 \\beta^2).\n\\end{align}\nOne of our key novelties lies in that we bound this estimation error using the gradient norm $\\mathbb E[||\\nabla J(\\omega_t)||_2^2]$. The above bound itself is tighter than the existing one in (Wu et al., 2020).\n\n\n\n\n**Step 3 (Tracking error)**: \nIn this step, we bound the tracking error in the critic: $||\\theta_t-\\theta_t^*||_2^2$. \n\nBy the TD error step in Algorithm 1, we decompose the term $||\\theta_{t+1}-\\theta_{t+1}^*||^2_2$ as follows:\n\n$    ||\\theta_{t+1}-\\theta_{t+1}^*||^2_2 \\leq || \\theta_t-\\theta_{t}^* ||^2_2+ \\alpha^2 ||\\delta_t z_t||^2_2+|| \\theta_{t}^*-\\theta_{t+1}^*||_2^2 \n$\n\n$+ 2 \\alpha\\langle\\theta_t-\\theta_{t}^*, \\delta_t z_t \\rangle  + 2\\alpha \\langle \\delta_t z_t, \\theta_{t}^* - \\theta_{t+1}^* \\rangle+ 2 \\langle\\theta_t-\\theta_{t}^*, \\theta_{t}^*-\\theta_{t+1}^* \\rangle.$\n\nAnother key challenge lies in  how to bound the term \n$\\mathbb E[\\langle \\theta_t-\\theta_t^*, \\delta_t z_t\\rangle ] $.  We develop a novel technique of auxiliary Markov chain to decompose this error into two parts: 1) error due to time-varying feature function and 2) error due to time-varying policy. Specifically, consider the first Markov chain generated from the algorithm:\n$$s_0,a_0 \\overset{\\pi_0\\times P}{\\to} s_1,a_1\\to...\\to s_t,a_t \\overset{\\pi_t\\times P}{\\to}s_{t+1},a_{t+1},$$ where at each time $j$, the action is chosen according to $\\pi_j$ and the transition kernel is $P$. Here $z_t=\\sum_{j=t-k}^t \\phi_j(s_j,a_j)$ is the eligibility trace used in the algorithm. It can be seen that in $z_t$, the feature $\\phi_j$ changes with $j$, and the distribution of $s_j,a_j$ depends on the time-varying policy $\\pi_j$. We then design an auxiliary eligibility trace $\\hat z_t=\\sum_{j=t-k}^t \\phi_t(s_j,a_j)$, where the feature is fixed to be $\\phi_t$, and only the the distribution of $s_j,a_j$ depends on the time-varying policy $\\pi_j$. To further handle the time-varying distribution of  $s_j,a_j$, we design an auxiliary Markov chain (denoted by $A1$) as follows:\n$$A1: ( s_0,\\widetilde  a_0 )\\sim \\pi_t\\overset{\\pi_t\\times P}{\\to} \\widetilde s_1,\\widetilde a_1\\overset{\\pi_t\\times P}{\\to}...\\overset{\\pi_t\\times P}{\\to}\\widetilde  s_t,\\widetilde a_t \\overset{\\pi_t\\times P}{\\to}\\widetilde s_{t+1},\\widetilde a_{t+1},$$ where the action at each time $j$ is always chosen according to a fixed policy $\\pi_t$. Based on this auxiliary Markov chain, we introduce another auxiliary eligibility trace $\\widetilde  z_t=\\sum_{j=t-k}^t \\phi_t(\\widetilde s_j,\\widetilde a_j)$, where it uses a fixed feature $\\phi_t$, and samples from this auxiliary Markov chain. Lastly, we design a second auxiliary Markov chain (denoted by $A2$):\n$$A2: (\\bar s_0,\\bar  a_0)\\sim D_t \\overset{\\pi_t\\times P}{\\to} \\bar s_1,\\bar a_1\\overset{\\pi_t\\times P}{\\to}...\\overset{\\pi_t\\times P}{\\to}\\bar  s_t,\\bar a_t \\overset{\\pi_t\\times P}{\\to}\\bar s_{t+1},\\bar a_{t+1}$$\nwhere the only difference between A2 and A1 lies in the initial state distribution. Then we define the last auxiliary eligibility trace as $\\bar  z_t=\\sum_{j=t-k}^t \\phi_t(\\bar s_j,\\bar a_j)$."
                    }
                },
                "number": 7,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission3988/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700297451556,
                "cdate": 1700297451556,
                "tmdate": 1700310428146,
                "mdate": 1700310428146,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "yLcqkLVp6e",
                "forum": "E3jq8f8t3d",
                "replyto": "ny7bSVKKnl",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission3988/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission3988/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Part 2"
                    },
                    "comment": {
                        "value": "**Weaknesses 2: Fair comparisons with discounted MDPs, and whether our approach can be generalized to the discounted setting**\n\nWe agree with the reviewer that the average reward setting and the discounted setting are different. In general, the  average MDP setting is more challenging to analyze than the discounted MDP setting due to the lack of the discount factor and thus the contraction property. It is possible to extend our methodology to the discounted MDP setting. For example, in the critic, we could use TD($\\lambda$) with a large enough $\\lambda$ to solve eq.(4). Our approach of designing auxiliary Markov chain and auxiliary eligibility trace could also be generalized to the discounted setting. It is also of interest to investigate in details the non-asymptotic error bound for the discounted MDP setting."
                    }
                },
                "number": 9,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission3988/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700297955535,
                "cdate": 1700297955535,
                "tmdate": 1700310442301,
                "mdate": 1700310442301,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "5yMsn6AT3e",
                "forum": "E3jq8f8t3d",
                "replyto": "yLcqkLVp6e",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission3988/Reviewer_VajU"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission3988/Reviewer_VajU"
                ],
                "content": {
                    "title": {
                        "value": "Ack"
                    },
                    "comment": {
                        "value": "Thank you for the detailed response. I do think the authors have improved the manuscript compared to the pre-rebuttal stage and also seem to have addressed the major concerns of all reviewers. I will update my score to 8 after authors-reviewers discussions since I only verified the newly posed auxiliary MC arguments briefly."
                    }
                },
                "number": 17,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission3988/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700548352591,
                "cdate": 1700548352591,
                "tmdate": 1700548352591,
                "mdate": 1700548352591,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "4FqVvdjcjk",
            "forum": "E3jq8f8t3d",
            "replyto": "E3jq8f8t3d",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission3988/Reviewer_CZ8K"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission3988/Reviewer_CZ8K"
            ],
            "content": {
                "summary": {
                    "value": "This paper presents a non-asymptotic analysis for single-loop Actor-Critic (AC) and Natural Actor-Critic (NAC) algorithms with compatible function approximation. The authors provide tight convergence bounds for both AC and NAC algorithms, eliminating the non-diminishing constant term $\\varepsilon_{critic}$ from the error bounds while maintaining the best known sample complexities. The paper focuses on the challenging single-loop setting with a single Markovian sample trajectory and analyzes the stochastic bias due to policy-dependent and time-varying compatible function approximation in the critic."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "3 good"
                },
                "strengths": {
                    "value": "The paper is well-structured and presents a clear analysis of the convergence properties of AC and NAC algorithms with compatible function approximation. The authors develop the tightest non-asymptotic convergence bounds for both AC and NAC algorithms with compatible function approximation. For the AC algorithm, they achieve the best sample complexity of $O(\\varepsilon^{-2})$ with a reduced error from $\\varepsilon + \\varepsilon_{critic}$ to $\\varepsilon$. For the NAC algorithm, they achieve the best known sample complexity of $O(\\varepsilon^{-3})$ with a reduced error of $\\varepsilon+\\sqrt{\\varepsilon_{actor}}$."
                },
                "weaknesses": {
                    "value": "1. It is unclear how the result in the paper compared with other non-asymptotic analyses with compatible function approximation. Also, it would be nice to demonstrate the technical challenges in combining (natural) actor-critic with compatible function approximation in a more detailed way. \n\n2. $\\varepsilon_{critic}$ can be small when using a neural function approximator, so it is unclear how important it is to eliminate such an error in real-world scenarios. While this is a theoretical work, it would be nice to include some experiments demonstrating the importance of eliminating $\\varepsilon_{critic}$."
                },
                "questions": {
                    "value": "See the weakness section above."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "6: marginally above the acceptance threshold"
                },
                "confidence": {
                    "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                },
                "first_time_reviewer": {
                    "value": "Yes",
                    "readers": [
                        "ICLR.cc/2024/Conference/Program_Chairs",
                        "ICLR.cc/2024/Conference/Submission3988/Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission3988/Reviewer_CZ8K",
                        "ICLR.cc/2024/Conference/Submission3988/Senior_Area_Chairs"
                    ]
                }
            },
            "number": 4,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission3988/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698834184599,
            "cdate": 1698834184599,
            "tmdate": 1700723228816,
            "mdate": 1700723228816,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "oTnGUoF9CY",
                "forum": "E3jq8f8t3d",
                "replyto": "4FqVvdjcjk",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission3988/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission3988/Authors"
                ],
                "content": {
                    "title": {
                        "value": "part 1"
                    },
                    "comment": {
                        "value": "**Q 1.a: how the result in the paper compared with other non-asymptotic analyses with compatible function approximation.** \n\nThe asymptotic convergence of actor-critic using compatible function approximation was derived in (Konda \\& Tsitsiklis 2003), and later \n(Peters \\& Schaal 2008) combined the idea of compatible function approximation with NAC, but did not provide any non-asymptotic convergence proof. Recently, non-asymptotic analysis of compatible function approximation for NAC was developed in (Agarwal et al. 2021) (Cayci et al. 2022) and (Wang et al. 2019). However, in these recent studies, they only employ the advantage that using compatible function approximation eliminates the need to estimate the Fisher information matrix and its inverse (as shown in eq. (8)). However, their critic design fails to obtain a solution to eq. (4), and therefore, their non-asymptotic error bounds still include the critic approximation error $\\varepsilon_{\\text{critic}}$. Our critic  employs the $k$-step TD algorithm so that the critic converges to a solution to eq. (4). In this way, we could achieve a zero critic approximation error. Moreover, these studies are not for the single-loop setting, whereas in our paper, we focus on the single loop setting, which is more challenging to analyze.\n\n\nKonda, Vijay R., and John N. Tsitsiklis. \"Onactor-critic algorithms.\" SIAM journal on Control and Optimization 42.4 (2003): 1143-1166.\n\nPeters, Jan, and Stefan Schaal. \"Natural actor-critic.\" Neurocomputing 71.7-9 (2008): 1180-1190.\n\nAlekh Agarwal,Sham M Kakade, Jason D Lee, and Gaurav Mahajan. \"On the theory of policy gradient methods: Optimality, approximation, and distribution shift.\" The Journal of Machine Learning Research 22.1 (2021): 4431-4506.\n\nCayci, Semih, Niao He, and R. Srikant. \"Finite-time analysis of entropy-regularized neural natural actor-critic algorithm.\" arXiv preprint arXiv:2206.00833 (2022).\n\nLingxiao Wang, Qi Cai, Zhuoran Yang, and Zhaoran Wang. \"Neural Policy Gradient Methods: Global Optimality and Rates of Convergence.\" International Conference on Learning Representations. 2019.\n\nQi Cai, Zhuoran Yang, Jason D Lee, and Zhaoran Wang. \"Neural Temporal Difference and Q Learning Provably Converge to Global Optima.\" Mathematics of Operations Research (2023)."
                    }
                },
                "number": 12,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission3988/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700298899006,
                "cdate": 1700298899006,
                "tmdate": 1700415311362,
                "mdate": 1700415311362,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "K06ZFOh43z",
                "forum": "E3jq8f8t3d",
                "replyto": "4FqVvdjcjk",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission3988/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission3988/Authors"
                ],
                "content": {
                    "title": {
                        "value": "part 2"
                    },
                    "comment": {
                        "value": "**Q 1.b Technical challenges.**\nHere we provide a proof sketch for the NAC algorithm to highlight major challenges and our technical novelties. The analysis of NAC contains of most major technical novelty in the AC analysis.\n\n\n**Proof Sketch:**\nFor simplicity of presentation, we set $\\alpha_t=\\alpha,\\beta_t=\\beta,\\gamma_t=\\gamma$, $\\hat t=\\lceil \\frac{3\\log T}{\\bar \\lambda_{\\min}\\alpha}\\rceil$ and \n$\\widetilde T=\\hat t\\lceil \\frac{T}{\\hat t \\log T} \\rceil$.\n We denote by $\\pi^*$ the global optimal policy and $M_t=\\mathbb E[||\\theta_{t}-\\theta^*_{t}||^2_2]+ \\mathbb E[(\\eta_t-J(\\omega_t))^2]$ the sum of the tracking error and the estimation error of the average reward. Denote by $D(\\omega_t)=KL(\\pi^*|\\pi_t)$ the KL divergence between policy $\\pi^*$ and $\\pi_t$.\n\n\n**Step 1 (Error decomposition):**\nAccording to the smoothness property of $D(\\omega)$ with respect to $\\omega$, we bound the performance gap between the current policy and the optimal policy (optimality gap) as follows:\n\\begin{align}\n    \\frac{1}{\\widetilde T}\\sum_{j=t}^{t+\\widetilde T-1}\\mathbb E[J(\\pi^*)-J(\\omega_j)] \n     \\leq \\frac{D(\\omega_{t+\\widetilde T})-D(\\omega_t)}{\\widetilde T \\beta }+ \\mathcal{O}\\left(\\sqrt{\\frac{1}{\\widetilde T}\\sum_{j=t}^{t+\\widetilde T-1} M_j}\\right)+\\mathcal{O}(C_\\infty \\sqrt{\\varepsilon_{\\text{actor}}}+ \\beta+m\\rho^k).\n\\end{align}\n\n\n\n\n**Step 2 (Estimation error in the average reward):** In this step, we analyze estimation error in the average reward:\n $\\eta_t-J(\\omega_t)$. We provide a tight characterization of this error:\n\\begin{align}\n    \\mathbb E[(\\eta_{t+1}-J(\\omega_{t+1}))^2] \\leq (1-\\gamma)\\mathbb E[(\\eta_{t}-J(\\omega_{t}))^2] + \\mathcal{O}(\\beta \\mathbb E[||\\nabla J(\\omega_t)||_2^2])\n    + \\mathcal{O}( m\\rho^k\\gamma +k^2 \\gamma^2 +k^2 \\beta^2).\n\\end{align}\nOne of our key novelties lies in that we bound this estimation error using the gradient norm $\\mathbb E[||\\nabla J(\\omega_t)||_2^2]$. The above bound itself is tighter than the existing one in (Wu et al., 2020).\n\n\n\n\n**Step 3 (Tracking error)**: \nIn this step, we bound the tracking error in the critic: $||\\theta_t-\\theta_t^*||_2^2$. \n\nBy the TD error step in Algorithm 1, we decompose the term $||\\theta_{t+1}-\\theta_{t+1}^*||^2_2$ as follows:\n\n$    ||\\theta_{t+1}-\\theta_{t+1}^*||^2_2 \\leq || \\theta_t-\\theta_{t}^* ||^2_2+ \\alpha^2 ||\\delta_t z_t||^2_2+|| \\theta_{t}^*-\\theta_{t+1}^*||_2^2 \n$\n\n$+ 2 \\alpha\\langle\\theta_t-\\theta_{t}^*, \\delta_t z_t \\rangle  + 2\\alpha \\langle \\delta_t z_t, \\theta_{t}^* - \\theta_{t+1}^* \\rangle+ 2 \\langle\\theta_t-\\theta_{t}^*, \\theta_{t}^*-\\theta_{t+1}^* \\rangle.$\n\nAnother key challenge lies in  how to bound the term \n$\\mathbb E[\\langle \\theta_t-\\theta_t^*, \\delta_t z_t\\rangle ] $.  We develop a novel technique of auxiliary Markov chain to decompose this error into two parts: 1) error due to time-varying feature function and 2) error due to time-varying policy. Specifically, consider the first Markov chain generated from the algorithm:\n$$s_0,a_0 \\overset{\\pi_0\\times P}{\\to} s_1,a_1\\to...\\to s_t,a_t \\overset{\\pi_t\\times P}{\\to}s_{t+1},a_{t+1},$$ where at each time $j$, the action is chosen according to $\\pi_j$ and the transition kernel is $P$. Here $z_t=\\sum_{j=t-k}^t \\phi_j(s_j,a_j)$ is the eligibility trace used in the algorithm. It can be seen that in $z_t$, the feature $\\phi_j$ changes with $j$, and the distribution of $s_j,a_j$ depends on the time-varying policy $\\pi_j$. We then design an auxiliary eligibility trace $\\hat z_t=\\sum_{j=t-k}^t \\phi_t(s_j,a_j)$, where the feature is fixed to be $\\phi_t$, and only the the distribution of $s_j,a_j$ depends on the time-varying policy $\\pi_j$. To further handle the time-varying distribution of  $s_j,a_j$, we design an auxiliary Markov chain (denoted by $A1$) as follows:\n$$A1: ( s_0,\\widetilde  a_0 )\\sim \\pi_t\\overset{\\pi_t\\times P}{\\to} \\widetilde s_1,\\widetilde a_1\\overset{\\pi_t\\times P}{\\to}...\\overset{\\pi_t\\times P}{\\to}\\widetilde  s_t,\\widetilde a_t \\overset{\\pi_t\\times P}{\\to}\\widetilde s_{t+1},\\widetilde a_{t+1},$$ where the action at each time $j$ is always chosen according to a fixed policy $\\pi_t$. Based on this auxiliary Markov chain, we introduce another auxiliary eligibility trace $\\widetilde  z_t=\\sum_{j=t-k}^t \\phi_t(\\widetilde s_j,\\widetilde a_j)$, where it uses a fixed feature $\\phi_t$, and samples from this auxiliary Markov chain. Lastly, we design a second auxiliary Markov chain (denoted by $A2$):\n$$A2: (\\bar s_0,\\bar  a_0)\\sim D_t \\overset{\\pi_t\\times P}{\\to} \\bar s_1,\\bar a_1\\overset{\\pi_t\\times P}{\\to}...\\overset{\\pi_t\\times P}{\\to}\\bar  s_t,\\bar a_t \\overset{\\pi_t\\times P}{\\to}\\bar s_{t+1},\\bar a_{t+1}$$\nwhere the only difference between A2 and A1 lies in the initial state distribution. Then we define the last auxiliary eligibility trace as $\\bar  z_t=\\sum_{j=t-k}^t \\phi_t(\\bar s_j,\\bar a_j)$."
                    }
                },
                "number": 13,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission3988/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700298953655,
                "cdate": 1700298953655,
                "tmdate": 1700299733755,
                "mdate": 1700299733755,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "QPYM4eIGfY",
                "forum": "E3jq8f8t3d",
                "replyto": "4FqVvdjcjk",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission3988/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission3988/Authors"
                ],
                "content": {
                    "title": {
                        "value": "part 3"
                    },
                    "comment": {
                        "value": "**Q 2: Importance of eliminating $\\varepsilon_{\\text{critic}}$ when it can be small in neural function approximation.**\n\nOne may argue that using a rich (non-linear) function approximation in the critic, e.g., neural network, may also have a small function approximation error in the critic. However, as shown in the literature, e.g., (Cai et.al.,2023), TD with non-linear function approximation may require a strong condition to guarantee convergence. In contrast, using compatible function approximation in the critic has a guaranteed convergence. Moreover, as discussed in eq. (8), there is no need to estimate the inverse Fisher information matrix if we use compatible function approximation in NAC. This could significantly reduce the complexity of implementing the algorithm.\n\nWe are currently working on the suggested simulations, and will add them to the final version.\n\nCai, Q., Yang, Z., Lee, J. D.,  Wang, Z. (2023). Neural Temporal Difference and Q Learning Provably Converge to Global Optima. Mathematics of Operations Research."
                    }
                },
                "number": 15,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission3988/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700299235325,
                "cdate": 1700299235325,
                "tmdate": 1700408603034,
                "mdate": 1700408603034,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "qKpjGXAiwy",
                "forum": "E3jq8f8t3d",
                "replyto": "QPYM4eIGfY",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission3988/Reviewer_CZ8K"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission3988/Reviewer_CZ8K"
                ],
                "content": {
                    "comment": {
                        "value": "Thanks for the detailed response. I have increased my confidence to 3."
                    }
                },
                "number": 19,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission3988/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700723208879,
                "cdate": 1700723208879,
                "tmdate": 1700723208879,
                "mdate": 1700723208879,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "IHEdVlvOcc",
            "forum": "E3jq8f8t3d",
            "replyto": "E3jq8f8t3d",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission3988/Reviewer_mPQr"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission3988/Reviewer_mPQr"
            ],
            "content": {
                "summary": {
                    "value": "This paper provides the tightest non-asymptotic convergence bounds for both the AC and natural AC (NAC) algorithms. Specifically, existing studies show that AC converges to an $\\epsilon+\\epsilon_{critic}$ neighborhood of stationary points with the best known sample complexity of $O(\\epsilon^{-2})$, and NAC converges to an $\\epsilon+\\epsilon_{critic}+\\sqrt{\\epsilon_{actor}}}$ neighborhood of the global optimum with the best known sample complexity of $O(\\epsilon^{-3})$, where $\\epsilon$-critic is the approximation error of the critic and \u03b5actor is the approximation error induced by the insufficient expressive power of the parameterized policy class. This paper analyzes the convergence of both AC and NAC algorithms with compatible function approximation. The major technical novelty lies in analyzing the stochastic bias due to policy-dependent and time-varying compatible function approximation in the critic, and handling the non-ergodicity of the MDP due to the single Markovian sample trajectory."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "3 good"
                },
                "strengths": {
                    "value": "This paper focuses on the challenging single-loop setting with a single Markovian sample trajectory. To develop the tightest bound, this paper develops a novel approach that bounds the tracking error as a function of the policy gradient norm (for AC) and the optimality gap (for NAC). Their analysis for NAC does not need the smoothness assumption on the parameterized policy, which is typically required in existing NAC and AC analyses."
                },
                "weaknesses": {
                    "value": "1. I don't understand the second equal sign of equation (5), why it holds true? Do you need to assume $Q^{\\pi_w}=\\phi^\\top_w\\bar{\\theta}^*_w$? Also, given equation (5), it is unclear why \"This implies that as long as we can solve the finite dimensional problem Equation (4), linear function approximation with the compatible feature and parameter does not induce any function approximation error.\" could you elaborate on that?\n\n2. why $\\phi^\\top\\phi$ is a matrix in eqn(8)? in this case $\\phi^\\top \\theta$ is also a matrix instead of a scalar?\n\n3. For NAC analysis, you need an additional Assumption 3. Could you explain why this is needed for NAC but not for AC? Also, how is this related to the single concentrability coefficient defined for offline RL (def1 of [1], assumption3 in [2])?\n\n[1] Bridging offline reinforcement learning and imitation learning: A tale of pessimism, NeurIPS21,\n[2] Towards Instance-Optimal Offline Reinforcement Learning with Pessimism, NeurIPS21.\n\n4. You mentioned \"Our major technical novelty lies in analyzing the stochastic bias due to policy-dependent and time-varying compatible function approximation in the critic, and handling the non-ergodicity of the MDP due to the single Markovian sample trajectory.\" Where can I find the detail of this novelty in the paper?"
                },
                "questions": {
                    "value": "Please answer the questions above."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "6: marginally above the acceptance threshold"
                },
                "confidence": {
                    "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 5,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission3988/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698863399907,
            "cdate": 1698863399907,
            "tmdate": 1699636360566,
            "mdate": 1699636360566,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "uEjRjW6AIR",
                "forum": "E3jq8f8t3d",
                "replyto": "IHEdVlvOcc",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission3988/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission3988/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Part 1"
                    },
                    "comment": {
                        "value": "**Q1: Clarification on eq. (5) and the statement of no critic function approximation error.**\n\nThanks for the suggestion. We have added the proof of eq. (5) in the revision. For convenience, we also include the proposition and the proof here.\n\n\n**Proposition 1**: With compatible function approximation, the policy gradient $\\nabla J(\\pi_\\omega)$ can be rewritten as:\n$$\n \\nabla J(\\pi_\\omega) =\\mathbb E_{D_{\\pi_\\omega}}[ \\nabla \\log \\pi_\\omega(a|s)Q^{\\pi_\\omega}(s,a)]=\n \\mathbb E_{D_{\\pi_\\omega}}[\\phi_\\omega(s,a)(\\phi^\\top_\\omega(s,a)\\bar\\theta_\\omega^*)].$$\n The natural policy gradient can be written as:\n$$\\widetilde{\\nabla} J(\\pi_\\omega)=\\bar \\theta^*_\\omega.$$\n\n**Proof:** \nBy eq. (4), $\\bar \\theta^*_\\omega$ is the minimizer of  eq. (4) and therefore it should satisfy that \n$$\n\\mathbb E_{D_{\\pi_\\omega}}[(Q^{\\pi_\\omega}(s,a)-\\phi^\\top_\\omega(s,a)\\bar \\theta_\\omega^*)\\phi_\\omega(s,a) ]=0.\n$$\nThis further implies that\n$$\\mathbb E_{D_{\\pi_\\omega}}[Q^{\\pi_\\omega}(s,a)\\phi_\\omega(s,a) ]=\\mathbb E_{D_{\\pi_\\omega}}[\\phi_\\omega(s,a)\\phi^\\top_\\omega(s,a)\\bar \\theta_\\omega^*].\n$$\nNow we consider the policy gradient $\\nabla J(\\pi_\\omega)$, and it  can be shown that\n$$\n\\nabla J(\\pi_\\omega) =\\mathbb E_{D_{\\pi_\\omega}}[ \\nabla \\log \\pi_\\omega(a|s)Q^{\\pi_\\omega}(s,a)]=\n \\mathbb E_{D_{\\pi_\\omega}}[\\phi_\\omega(s,a)\n (\\phi^\\top_\\omega(s,a)\\bar\\theta_\\omega^*)].\n $$\n\nFurthermore, for the natural policy gradient, we have that $$\\widetilde{\\nabla} J(\\pi_\\omega)= F_{\\omega}^{-1} \\mathbb E_{D_{\\pi_\\omega}}[\\phi_\\omega(s,a)\\phi_\\omega(s,a)^\\top{\\bar\\theta}^*_\\omega]=F_\\omega^{-1} \\mathbb E_{D_{\\pi_\\omega}}[\\phi_\\omega(s,a)\\phi_\\omega(s,a)^\\top   ]\\bar \\theta^*_\\omega=\\bar \\theta^*_\\omega. \n$$\n\n\n**Q2: Why is $\\phi^\\top\\phi$ a matrix in eq. (8)? In this case $\\phi^\\top\\theta$  is also a matrix instead of a scalar?**\n\nWe would like to thank the reviewer for this comment. This is actually a typo. In eq. (8), it should be $\\phi\\phi^\\top$. We have fixed this error.\n\n\n**Q3.1: Why is Assumption 3 only needed for NAC analysis?**\n\nThis is because for the AC algorithm, we establish the convergence to stationary point, i.e., the gradient of $J(\\omega_t)$ converges to $0$, and for the NAC algorithm, we establish the convergence to the optimal policy, i.e., $J(\\omega_t)$ converges to $J(\\pi^*)$. For AC, as the critic performs on-policy learning,  it is able to learn the value function of the current policy $\\pi_{\\omega_t}$, and thus the gradient  $\\nabla J(\\omega_t)$. However, for NAC, in order to measure the difference between the current policy and the optimal policy, we need the current policy to be sufficiently explorative so that samples from the current policy $\\pi_{\\omega_t}$ can be used to infer the optimal policy. This is guaranteed by Assumption 3. \n\n**Q3.2: How is Assumption 3 related to the single concentrability coefficient in offline RL?**\n\nDefinition 1 in [1] and Assumption 2.3 in [2] define the range of policies that a given offline dataset could learn since offline reinforcement learning does not allow exploration. Assumption 3  guarantees that the policy is explorative so that the optimal policy could be learned. They are quite related. But here we could design the way that the policy is parameterized to guarantee Assumption 3, whereas in offline RL, the behavior policy cannot be changed.\n\n[1] Rashidinejad P, Zhu B, Ma C, et al. Bridging offline reinforcement learning and imitation learning: A tale of pessimism[J]. Advances in Neural Information Processing Systems, 2021, 34: 11702-11716.\n\n [2] Yin M, Wang Y X. Towards instance-optimal offline reinforcement learning with pessimism[J]. Advances in neural information processing systems, 2021, 34: 4065-4078."
                    }
                },
                "number": 3,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission3988/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700286364358,
                "cdate": 1700286364358,
                "tmdate": 1700415445840,
                "mdate": 1700415445840,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "gJDt4JcGjC",
                "forum": "E3jq8f8t3d",
                "replyto": "IHEdVlvOcc",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission3988/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission3988/Authors"
                ],
                "content": {
                    "title": {
                        "value": "part 2"
                    },
                    "comment": {
                        "value": "**Q4:  Details of this paper's novelty.**\nHere we provide a proof sketch for the NAC algorithm to highlight major challenges and our technical novelties. The analysis of NAC contains of most major technical novelty in the AC analysis.\n\n\n**Proof Sketch:**\nFor simplicity of presentation, we set $\\alpha_t=\\alpha,\\beta_t=\\beta,\\gamma_t=\\gamma$, $\\hat t=\\lceil \\frac{3\\log T}{\\bar \\lambda_{\\min}\\alpha}\\rceil$ and \n$\\widetilde T=\\hat t\\lceil \\frac{T}{\\hat t \\log T} \\rceil$.\n We denote by $\\pi^*$ the global optimal policy and $M_t=\\mathbb E[||\\theta_{t}-\\theta^*_{t}||^2_2]+ \\mathbb E[(\\eta_t-J(\\omega_t))^2]$ the sum of the tracking error and the estimation error of the average reward. Denote by $D(\\omega_t)=KL(\\pi^*|\\pi_t)$ the KL divergence between policy $\\pi^*$ and $\\pi_t$.\n\n\n**Step 1 (Error decomposition):**\nAccording to the smoothness property of $D(\\omega)$ with respect to $\\omega$, we bound the performance gap between the current policy and the optimal policy (optimality gap) as follows:\n\\begin{align}\n    \\frac{1}{\\widetilde T}\\sum_{j=t}^{t+\\widetilde T-1}\\mathbb E[J(\\pi^*)-J(\\omega_j)] \n     \\leq \\frac{D(\\omega_{t+\\widetilde T})-D(\\omega_t)}{\\widetilde T \\beta }+ \\mathcal{O}\\left(\\sqrt{\\frac{1}{\\widetilde T}\\sum_{j=t}^{t+\\widetilde T-1} M_j}\\right)+\\mathcal{O}(C_\\infty \\sqrt{\\varepsilon_{\\text{actor}}}+ \\beta+m\\rho^k).\n\\end{align}\n\n\n\n\n**Step 2 (Estimation error in the average reward):** In this step, we analyze estimation error in the average reward:\n $\\eta_t-J(\\omega_t)$. We provide a tight characterization of this error:\n\\begin{align}\n    \\mathbb E[(\\eta_{t+1}-J(\\omega_{t+1}))^2] \\leq (1-\\gamma)\\mathbb E[(\\eta_{t}-J(\\omega_{t}))^2] + \\mathcal{O}(\\beta \\mathbb E[||\\nabla J(\\omega_t)||_2^2])\n    + \\mathcal{O}( m\\rho^k\\gamma +k^2 \\gamma^2 +k^2 \\beta^2).\n\\end{align}\nOne of our key novelties lies in that we bound this estimation error using the gradient norm $\\mathbb E[||\\nabla J(\\omega_t)||_2^2]$. The above bound itself is tighter than the existing one in (Wu et al., 2020).\n\n\n\n\n**Step 3 (Tracking error)**: \nIn this step, we bound the tracking error in the critic: $||\\theta_t-\\theta_t^*||_2^2$. \n\nBy the TD error step in Algorithm 1, we decompose the term $||\\theta_{t+1}-\\theta_{t+1}^*||^2_2$ as follows:\n\n$    ||\\theta_{t+1}-\\theta_{t+1}^*||^2_2 \\leq || \\theta_t-\\theta_{t}^* ||^2_2+ \\alpha^2 ||\\delta_t z_t||^2_2+|| \\theta_{t}^*-\\theta_{t+1}^*||_2^2 \n$\n\n$+ 2 \\alpha\\langle\\theta_t-\\theta_{t}^*, \\delta_t z_t \\rangle  + 2\\alpha \\langle \\delta_t z_t, \\theta_{t}^* - \\theta_{t+1}^* \\rangle+ 2 \\langle\\theta_t-\\theta_{t}^*, \\theta_{t}^*-\\theta_{t+1}^* \\rangle.$\n\nAnother key challenge lies in  how to bound the term \n$\\mathbb E[\\langle \\theta_t-\\theta_t^*, \\delta_t z_t\\rangle ] $.  We develop a novel technique of auxiliary Markov chain to decompose this error into two parts: 1) error due to time-varying feature function and 2) error due to time-varying policy. Specifically, consider the first Markov chain generated from the algorithm:\n$$s_0,a_0 \\overset{\\pi_0\\times P}{\\to} s_1,a_1\\to...\\to s_t,a_t \\overset{\\pi_t\\times P}{\\to}s_{t+1},a_{t+1},$$ where at each time $j$, the action is chosen according to $\\pi_j$ and the transition kernel is $P$. Here $z_t=\\sum_{j=t-k}^t \\phi_j(s_j,a_j)$ is the eligibility trace used in the algorithm. It can be seen that in $z_t$, the feature $\\phi_j$ changes with $j$, and the distribution of $s_j,a_j$ depends on the time-varying policy $\\pi_j$. We then design an auxiliary eligibility trace $\\hat z_t=\\sum_{j=t-k}^t \\phi_t(s_j,a_j)$, where the feature is fixed to be $\\phi_t$, and only the the distribution of $s_j,a_j$ depends on the time-varying policy $\\pi_j$. To further handle the time-varying distribution of  $s_j,a_j$, we design an auxiliary Markov chain (denoted by $A1$) as follows:\n$$A1: ( s_0,\\widetilde  a_0 )\\sim \\pi_t\\overset{\\pi_t\\times P}{\\to} \\widetilde s_1,\\widetilde a_1\\overset{\\pi_t\\times P}{\\to}...\\overset{\\pi_t\\times P}{\\to}\\widetilde  s_t,\\widetilde a_t \\overset{\\pi_t\\times P}{\\to}\\widetilde s_{t+1},\\widetilde a_{t+1},$$ where the action at each time $j$ is always chosen according to a fixed policy $\\pi_t$. Based on this auxiliary Markov chain, we introduce another auxiliary eligibility trace $\\widetilde  z_t=\\sum_{j=t-k}^t \\phi_t(\\widetilde s_j,\\widetilde a_j)$, where it uses a fixed feature $\\phi_t$, and samples from this auxiliary Markov chain. Lastly, we design a second auxiliary Markov chain (denoted by $A2$):\n$$A2: (\\bar s_0,\\bar  a_0)\\sim D_t \\overset{\\pi_t\\times P}{\\to} \\bar s_1,\\bar a_1\\overset{\\pi_t\\times P}{\\to}...\\overset{\\pi_t\\times P}{\\to}\\bar  s_t,\\bar a_t \\overset{\\pi_t\\times P}{\\to}\\bar s_{t+1},\\bar a_{t+1}$$\nwhere the only difference between A2 and A1 lies in the initial state distribution. Then we define the last auxiliary eligibility trace as $\\bar  z_t=\\sum_{j=t-k}^t \\phi_t(\\bar s_j,\\bar a_j)$."
                    }
                },
                "number": 5,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission3988/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700296610511,
                "cdate": 1700296610511,
                "tmdate": 1700299703332,
                "mdate": 1700299703332,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "7UYKAXKNto",
            "forum": "E3jq8f8t3d",
            "replyto": "E3jq8f8t3d",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission3988/Reviewer_k8iS"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission3988/Reviewer_k8iS"
            ],
            "content": {
                "summary": {
                    "value": "This paper conducts a convergence analysis of actor-critic and natural actor-critic algorithms with compatible function approximation, under the single-loop setting that uses onse sample trajectory. The paper presents the tightest convergence bound in both cases."
                },
                "soundness": {
                    "value": "4 excellent"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "3 good"
                },
                "strengths": {
                    "value": "- The paper presents the tightest non-asymptotic bound for the covergenace of AC and NAC algorithms, compared to existing work. The results show that compatible function approximation \n- To obtain the tightes bound, paper presents novel technical contributions to analyze the single-trajectory setting and avoid decoupling of the actor and critic updates. The setting considered in this paper is closer to practice."
                },
                "weaknesses": {
                    "value": "- The main contributions of the paper are limited to novel techniques in the analysis of well-known algorthms and theoretical evidence on why compatible function approximation might be advantageous. I am uncertain about potential impact of this work either on practice or theory."
                },
                "questions": {
                    "value": "Could you please clarify whether/how the techniques or results presented in this paper could be useful in practice, for instance, through the development of new algorithmic ideas, or in theory, such as analysis techniques being potentially useful to analyze other algorithms?"
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "6: marginally above the acceptance threshold"
                },
                "confidence": {
                    "value": "2: You are willing to defend your assessment, but it is quite likely that you did not understand the central parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 6,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission3988/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698909240594,
            "cdate": 1698909240594,
            "tmdate": 1699636360495,
            "mdate": 1699636360495,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "vf2LnF7Aas",
                "forum": "E3jq8f8t3d",
                "replyto": "7UYKAXKNto",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission3988/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission3988/Authors"
                ],
                "content": {
                    "comment": {
                        "value": "**Q1: Practical and theoretical impact: how can the algorithmic idea and theoretical analysis be useful to develop and analyze other algorithms.**\n\nThe algorithmic idea of compatible function approximation can be applied to a wide range of AC and NAC type algorithms e.g., in the multi-task, multi-agent and game settings,  to get rid of the function approximation error in the critic. One may argue that using a rich (non-linear) function approximation in the critic, e.g., neural network, may also have a small function approximation error in the critic. However, as shown in the literature, e.g., (Cai et.al.,2023), TD with non-linear function approximation may require a strong condition to guarantee convergence. In contrast, using compatible function approximation in the critic has a guaranteed convergence. Moreover, as discussed in eq. (8), there is no need to estimate the inverse Fisher information matrix if we use compatible function approximation in NAC. This could significantly reduce the complexity in extensions to e.g., the multi-agent and distributed setting, where the estimate of the Fisher information matrix may be challenging. \n\nOur theoretical analysis can also be generalized to understand the convergence and sample complexity of various extensions of AC and NAC type algorithms e.g., in the multi-task, multi-agent, distributed and game settings. Our approach of analyzing the stochastic bias due to policy-dependent and time-varying compatible function approximation in the critic, and handling the non-ergodicity of the MDP due to the single Markovian sample trajectory can be used to obtain a tight bound of those generalizations of AC and NAC algorithms.\n\n\nCai, Q., Yang, Z., Lee, J. D.,  Wang, Z. (2023). Neural Temporal Difference and Q Learning Provably Converge to Global Optima. Mathematics of Operations Research."
                    }
                },
                "number": 1,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission3988/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700229668484,
                "cdate": 1700229668484,
                "tmdate": 1700229668484,
                "mdate": 1700229668484,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    }
]