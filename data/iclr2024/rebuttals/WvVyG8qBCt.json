[
    {
        "title": "DPFormer: Learning Differentially Private Transformer on Long-Tailed Data"
    },
    {
        "review": {
            "id": "RUhf04VbXK",
            "forum": "WvVyG8qBCt",
            "replyto": "WvVyG8qBCt",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission4309/Reviewer_eHtL"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission4309/Reviewer_eHtL"
            ],
            "content": {
                "summary": {
                    "value": "The paper introduces two main new modifications to differentially private training of transformers. They refer to it as DPFormer. The authors argue that two problems with differentially private training of transformers is i) the additional computational overhead of training with per-sample gradient (initially addressed by Li et. al. 2022 with Ghost clipping) and ii) a phenomenon the authors refer to as attention distraction. To resolve this, the authors propose Phantom clipping which also allows weight sharing (as opposed to Ghost Clipping)  and re-attention. Experiments on two datasets show improvement over some standard baseline algorithms like vanilla transformer, GRU, LSTM."
                },
                "soundness": {
                    "value": "2 fair"
                },
                "presentation": {
                    "value": "2 fair"
                },
                "contribution": {
                    "value": "3 good"
                },
                "strengths": {
                    "value": "* __[S1]__ I appreciate the message that pre-training might not be possible for all tasks and it is important to develop algorithms that can work in settings without pre-training. This message has also been highlighted in [A,B].\n\n* __[S2]__ It is important to show that modern DP algorithms can be run computationally efficiently, something which is often missed in works that show state-of-the-art accuracy at a huge computational cost. This problem is particularly pronounced for DP model-training where large batch sizes have somehow been used very commonly. To that effect, I appreciate the focus towards decreasing compitational cost.\n\n\n\n\n\n\n\n\n\n\n\n\n[A]  \"Considerations for differentially private learning with large-scale public pre-training.\" TPDP 2023.   \n[B]  \"PILLAR: How to make semi-private learning more effective\" TPDP 2023"
                },
                "weaknesses": {
                    "value": "* __[W1]__ If data is long-tailed, the hand-wavy definition of this means that some parts of the data are over-represented and some parts are under-represented. As such, if the objective is to get high average accuracy (or its variant for recommendation problem), then ignoring the low frequency elements shouldn't be a problem. This paper seems to be looking at average metrics but it mentions long-tailed data in the title. \n\n* __[W2]__ The paper proposes a phenomenon called `attention distraction'. The suggestion is that tokens with high variance will be unfairly selected by the attention mechanism. But it is not very clear to me what this means formally. In addition, the theory seems to assume that every token's attention value is an independent gaussian, which is also unrealistic as all tokens are dependent on each other due to previous layers and I don't see why adding gaussian noise to gradients results in gaussian distribution for token activations. The whole section 4 assumes these two things but there isn't any empirical or theoretical justification for this.\n\n* __[W3]__ The experimental comparison is not thorough at all. Please see question 3 below for a more detailed explanation of why I think that is the case.\n\n\n\nMinor Comments\n1. What do the metrics used here actually mean ? Maybe I missed it but I don't see a definition of ndcg@10 and HiT@10. \n2. Figure 1 is not very understandable as there are terms like $a_s$ and $e_s$ which is not clarified.\n3. In general, the text is very heavy which can be distracting to readers. I would recommend (personally) to have shorter sentences to the point.\n4. Eq 1 isn't clear what G is.\n5."
                },
                "questions": {
                    "value": "1. Regarding long-tailed data [W1] cam the authors explain\n    * motivation for why that is the central part of the story and where the long-tailed data comes into play.\n    * any evidence that the proposed method specifically helps for long-tailed methods.\nPerhaps the authors can draw some relation from [1] ?\n\n2. Regarding [W2], can the authors provide evidence that ``attention distraction'' \n    * truly happens without re-attention mechanism in transformer. I understand Figure 9 is supposed to show this but I don't exactly understand what the two axis here is. I am also not comfortable drawing summary statistics about this as a wider phenomenon that what is shown in the five plots. To me it appears that this is just learning a biased classifier (i.e. not learning the true signal) that puts all its signal on one token (if I understand it correctly).\n    * follows the same mathematical equations that Section 4 predicts it should.\n    * Re-attention actually solves it ?\n\n3. Both the datasets and baseline algorithms are fairly restrictive. Is there any reason apart from not having pre-trained models specialised for recommendation engines, why the experiments are limited to recommendation settings. \n    * The methods should also provide benefits for NLP tasks (with and without pre-training). \n    * Also, is there a comparison with Li et. al. or any other method for training transformers or recurrent models ? Such comparisons would be needed.\n    * Can the authors also try using a general pre-trained transformer for this recommendation tasks ?\n\n[1] \"Does learning require memorization? a short tale about a long tail.\" Proceedings of the 52nd Annual ACM SIGACT Symposium on Theory of Computing. 2020.    \n[2] \"How unfair is private learning?.\" In Uncertainty in Artificial Intelligence, pp. 1738-1748. PMLR, 2022."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "6: marginally above the acceptance threshold"
                },
                "confidence": {
                    "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 1,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission4309/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698675265549,
            "cdate": 1698675265549,
            "tmdate": 1699636399451,
            "mdate": 1699636399451,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "7GhGPaJxAh",
                "forum": "WvVyG8qBCt",
                "replyto": "RUhf04VbXK",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission4309/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission4309/Authors"
                ],
                "content": {
                    "comment": {
                        "value": "> Regarding long-tailed data [W1].\n\n**Reply:** Thanks for pointing out this perspective. We would like to make it clear that we made no attempt to deal with the fairness issue. Our motivation is long-tailedness in private learning will obstruct the training process (i.e., the attention distraction) and lead to (average) performance drop (i.e., low accuracy on both over-represented and under-represented data). Therefore, our goal in the task of 'improving private learning on long-tailed data' is to mitigate this additional issue and the ideal result is to recover the case of 'non-private (vanilla) learning on long-tailed data' (i.e., potentially low accuracy on under-represented data, but with a high average performance). We make no attempt to improve the model performance on under-represented data. Such goal can be achieved by combining existing method with our method.\n\n\n>  [W2] In addition, the theory seems to assume that every token's attention value is an independent gaussian, which is also unrealistic as all tokens are dependent on each other due to previous layers and I don't see why adding gaussian noise to gradients results in gaussian distribution for token activations. The whole section 4 assumes these two things but there isn't any empirical or theoretical justification for this.\n\n**Reply:** Thanks for pointing out. We would like to stress that these assumptions are commonly used and well-understood in the literature of variational inference and more broadly, bayesian deep learning. We directly adopt this methodolody from that area. The unfortunate fact is, (at this stage of history) we can only assume them being independent Gaussian and approximate it via moment matching. The development of more advanced techniques to help track the evolution of distribution through neural layers is beyond the scope of this work. In addition, we add a more detailed version of analysis of the attention distraction in Appendix A.3 in the revised paper.\n\n> why the experiments are limited to recommendation settings.\n\n**Reply:** We believe that Recommendation task is the most prevailing sequential task in the real-world that features the property of long-tailedness and lack of pre-trained model. Therefore, we target recommendation settings in the work.\n\n> Is there a comparison with Li et. al?\n\n**Reply:** We compare the efficiency of our phantom clipping with ghost clipping in Li et.al in Figure 3. For the accuracy aspect, the baseline transformer can be viewed as an instantiation of Li et.al since Li et.al did not propose algorithmically different methods.\n\n> Can the authors also try using a general pre-trained transformer for this recommendation tasks?\n\n**Reply:** To our knowledge, how to use a general pre-trained transformer for recommendation task is still a largely open problem. One cannot naively adopt a pre-trained transformer model because the input space is different (in recommendation task, token $i$ is associatedd with the item with ID $i$ while in NLP token $i$ is associated with some (sub)word defined by the tokenizer)."
                    }
                },
                "number": 4,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission4309/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700492953780,
                "cdate": 1700492953780,
                "tmdate": 1700493178187,
                "mdate": 1700493178187,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "SEJP9nhfYp",
                "forum": "WvVyG8qBCt",
                "replyto": "7GhGPaJxAh",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission4309/Reviewer_eHtL"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission4309/Reviewer_eHtL"
                ],
                "content": {
                    "comment": {
                        "value": "I thank the authors for their reply.\n\nMy initial concerns (W1, W2, and W3) still remain though now I understand the authors' position on this, which is\n\nW1: the authors look at the setting of long-tailed data as opposed to improving the performance on the long tail. However, it is not yet clear to me what the the specific impact of the long tail is. I appreciate for the attempt to clarify but I think there is more work needed to clarify this.\n\nW2: Regarding the assumption, the authors admit that the assumption is strong and it is difficult to improve upon it. I understand the position and maintain that the assumption is too strong in my opinion for this particular setting. It may be more relevant in probabilistic modelling tasks.\n\nW3: The experimental baseline is still very narrow. The authors argue that it is not clear how to extend it but then I think this is something the paper should work towards: showing how widely applicable the method is as oposed to mentioning that this may not be widely applicable.\n\nI maintain my rating of borderline accept."
                    }
                },
                "number": 5,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission4309/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700653599415,
                "cdate": 1700653599415,
                "tmdate": 1700653599415,
                "mdate": 1700653599415,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "FvdjQ2ozna",
            "forum": "WvVyG8qBCt",
            "replyto": "WvVyG8qBCt",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission4309/Reviewer_v4h1"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission4309/Reviewer_v4h1"
            ],
            "content": {
                "summary": {
                    "value": "This paper studies the differential privacy in transformers. They identify two key challenges as heavy computation due to per-sample gradient clipping, and unintentional attention distraction within the attention mechanism. They propose DP- Former, equipped with Phantom Clipping and Re-Attention Mechanism, to address these challenges. The theoretical analysis shows that DPFormer can reduce computational costs during gradient clipping and effectively mitigate attention distraction. Empirical results on two real-world recommendation datasets with varying degrees of long-tailedness, showing its significant improvement in terms of efficiency and effectiveness."
                },
                "soundness": {
                    "value": "2 fair"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "3 good"
                },
                "strengths": {
                    "value": "This paper give DPformer to address the challenges of heavy computations and attention distraction.\nOriginality: The proposed methods addressed the two difficulties, it\u2019s novel and has good performance. Phantom Clipping inherit the basic idea of Ghost Clipping, obtain the per-sample gradient norm without the need for instantiating the per-sample gradient. p\nQuality: This methods performs well in experiments. But I doubt that whether the re-attention method after DP process can leak privacy?\nClarity: The logic structure of this paper is clear \nSignificance: These two problems are very important problems for differential privacy in Transforms, so this kind of work is necessary"
                },
                "weaknesses": {
                    "value": "The correctness of this method. \nThis paper uses Phantom clipping and Re-attention mechanism to overcome the difficulties of heave computation and attention distraction. The most important thing is to make the whole mechanism be differentially private and have high utility. However, they authors didn't analyze the privacy of this mechanism, especially after the re-attention. It seems this process will leak privacy."
                },
                "questions": {
                    "value": "What is the privacy guarantee for this method?\nWhat do NDCG@10 and HIT@10 mean?"
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "5: marginally below the acceptance threshold"
                },
                "confidence": {
                    "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 2,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission4309/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698735323114,
            "cdate": 1698735323114,
            "tmdate": 1699636399369,
            "mdate": 1699636399369,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "w3Zb9Suhms",
                "forum": "WvVyG8qBCt",
                "replyto": "FvdjQ2ozna",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission4309/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission4309/Authors"
                ],
                "content": {
                    "comment": {
                        "value": "> What is the privacy guarantee for this method?\n\n**Reply:** Thanks for pointing out. We have explicitly made the privacy statement in the revised version (Claim A.5). In particular, the privacy guarantee is inherited from that of DP-SGD. Details follow.\n\nPhantom clipping is an efficient implementation of gradient clipping, having the same functionality as vanilla per-sample clipping (i.e., the same input-output behavior). Therefore, we can think of it as the vanilla gradient clipping when we analyze the privacy.\n\nFor Re-Attention mechanism, observe that the whole computation process only depends on the single data sample (i.e., we do not create dependency among samples between a mini-batch, thus violating DP like Batch Normalization). Another way to understand this is we can do whatever we like in the forward pass as long as the computation associated with one input sample does not rely on other input samples of the mini-batch. (A caveat is discussed in Remark A.2 of Appendix.A.4) Therefore, the private analysis reduces to DP-SGD: By clipping the gradient we can successfully bound the per-sample sensitivity (and add the calibrated noise to guarantee DP).\n\n\n> What do NDCG@10 and HIT@10 mean?\n\n**Reply:** Thanks for pointing out. They are metrics commonly used in recommendation systems to measure the prediction accuracy. They can be simply understood as Top-10 accruacy and weighted Top-10 accuracy as in the classification task. We have included the definitions in Appendix A.9.4 in the revised paper."
                    }
                },
                "number": 3,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission4309/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700492648170,
                "cdate": 1700492648170,
                "tmdate": 1700492648170,
                "mdate": 1700492648170,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "xMhWmJR0jT",
                "forum": "WvVyG8qBCt",
                "replyto": "w3Zb9Suhms",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission4309/Reviewer_v4h1"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission4309/Reviewer_v4h1"
                ],
                "content": {
                    "title": {
                        "value": "Thanks for the response"
                    },
                    "comment": {
                        "value": "Authors response resolved my doubts about the privacy. I keep my score because it's hard for me to follow and check the technological and mathematical principles. I agree that this paper works on an important research question and gets good results in their experiments, but limited to recommendation dataset.\n\u200b"
                    }
                },
                "number": 6,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission4309/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700742411532,
                "cdate": 1700742411532,
                "tmdate": 1700742411532,
                "mdate": 1700742411532,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "n80FagV8bV",
            "forum": "WvVyG8qBCt",
            "replyto": "WvVyG8qBCt",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission4309/Reviewer_SzC2"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission4309/Reviewer_SzC2"
            ],
            "content": {
                "summary": {
                    "value": "This paper introduces two treatments for training transformer models with DP-SGD on long-tailed data. The first is phantom clipping which extends ghost clipping by handling parameter sharing between input and output layer (a common practice). Phantom clipping effectively enabled more efficient DP training of transformer models in practice. The second is a re-attention mechanism which rescale the attention scores in the transformer models by their error variances due to DP noise. The methods are evaluated on two benchmark recommendation datasets and showed better performance compared to the DP-SGD baseline."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "3 good"
                },
                "strengths": {
                    "value": "- This paper is well-motivated as transformer models are used in many ML applications and being able to train it with strong privacy guarantees is important for these models to scale further.\n- The methods are driven with the empirical observations of the shortcomings of DP-SGD on transformer models. Parameter sharing of embedding parameters is such a common thing to do but was not considered in prior work on speeding up DP-SGD. Also DP is known for generalizing worse on the tail and the re-attention mechanism is a simple yet effective workaround."
                },
                "weaknesses": {
                    "value": "- The experiments, as the authors acknowledged, were conducted on the smaller scale models. Also only recommendation tasks were considered. It is unknown whether these methods will be effective on larger image or text models.\n- Some baselines for training with DP are missing where these methods also improve the performance of models for long-tailed data: [1] proposed a way to add DP noise adaptively according to the geometry of the loss space, which can effectively enable smaller noise on long-tailed data. [2] similarly uses auxiliary information such as the frequency of the vocabulary to apply DP noise. \n- Describing section 4 as an algorithm would be easier to read.\n\nReferences\n\n[1] Asi, Hilal, et al. \"Private adaptive gradient methods for convex optimization.\" International Conference on Machine Learning. PMLR, 2021.\n\n[2] Li, Tian, et al. \"Private adaptive optimization with side information.\" International Conference on Machine Learning. PMLR, 2022."
                },
                "questions": {
                    "value": "- Is Figure 3 based on Ghost Clipping or Book-Keeping [1]? BK is supposed to be more efficient than Ghost Clipping.\n- In Equation 7, are the subscripts on the right-hand side supposed to be $X^{(l-1)}$? \n\nReferences\n\n[1] Bu, Zhiqi, et al. \"Differentially private optimization on large model at small cost.\" International Conference on Machine Learning. PMLR, 2023."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "6: marginally above the acceptance threshold"
                },
                "confidence": {
                    "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 3,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission4309/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698772584168,
            "cdate": 1698772584168,
            "tmdate": 1699636399280,
            "mdate": 1699636399280,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "qqyyrZmSmM",
                "forum": "WvVyG8qBCt",
                "replyto": "n80FagV8bV",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission4309/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission4309/Authors"
                ],
                "content": {
                    "comment": {
                        "value": "> Is Figure 3 based on Ghost Clipping or Book-Keeping [1]? BK is supposed to be more efficient than Ghost Clipping.\n\n**Reply:** Yes, exactly. We use implementation in BK for the baseline.\n\n> In Equation 7, are the subscripts on the right-hand side supposed to be $X^{(l-1)}$.\n\n**Reply:** Yes. Sorry for the confusion.\n\n> Some baselines for training with DP are missing where these methods also improve the performance of models for long-tailed data\n\n**Reply:** Thanks for pointing these great works. We discuss them in the related work in Appendix A.1 in  the revised paper. From our understanding, these works are operating on the optimizer level, while our method does not assume any specific optimizer and uses the underlying optimizer in a black-box manner. Therefore our method is orthogonal to them and can be potentially combined together.\n\n> Describing section 4 as an algorithm would be easier to read.\n\n**Reply:** Thanks for your suggestion. We add an algorithm description in the Appendix A.7."
                    }
                },
                "number": 2,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission4309/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700492594730,
                "cdate": 1700492594730,
                "tmdate": 1700493069432,
                "mdate": 1700493069432,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "Bd0E7CPmpV",
            "forum": "WvVyG8qBCt",
            "replyto": "WvVyG8qBCt",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission4309/Reviewer_FhGH"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission4309/Reviewer_FhGH"
            ],
            "content": {
                "summary": {
                    "value": "This paper identifies two key challenges in learning differentially private Transformers, i.e.,\nheavy computation overhead due to per-sample gradient clipping and attention distraction due to\nlong-tailed data distributions. The authors then proposed DPFormer, equipped with Phantom Clipping and\nRe-Attention Mechanism, to address these challenges. Empirical results are also provided to justify the new design."
                },
                "soundness": {
                    "value": "2 fair"
                },
                "presentation": {
                    "value": "2 fair"
                },
                "contribution": {
                    "value": "2 fair"
                },
                "strengths": {
                    "value": "The paper aims at solving issues and improving the performance of DP transformers. Personally, I think this problem is very important and a key step towards enabling large model training under differential privacy. Given the popularity of large language models and transformers, this problem should be interesting to both DP community and LLM community."
                },
                "weaknesses": {
                    "value": "Although the problem at which the paper aims is very important, the paper does not provide a satisfactory answer and leave many questions unanswered. Most importantly, this paper needs to greatly improve its clarity: there are many places with vague languages or unstrict math, making it very hard for the reader to follow or evaluate the paper's quality. Personally speaking, there is still a long way to go before the paper can be accepted.\n\nHere are some specific suggestions/confusion:\n\nPhantom clipping: \n1. All the notations in Claim 3.1 are used without being carefully defined. I do not find it enough to just define them by Figure 1 or simple languages in Claim 3.1. Could we have some strict math like section 2.2 in https://arxiv.org/pdf/2205.10683.pdf?\n2. I am not convinced why the phantom clipping has such great advantages over ghost clipping. Observing Claim 3.1, it has exactly the same idea (calculating the norm and avoiding gradient instantiation) with ghost clipping. Specifically, I do not understand why the BM^2 complexity is inherent to the ghost clipping under a careful implementation. With that in mind, I am concerned the paper may over-claim the advantages.\n3. Looking at the results from other papers  (e.g., https://arxiv.org/pdf/2205.10683.pdf) applying ghost clipping to transformers, the ghost clipping has shown a much better memory effIciency. I do not quite understand the gap between Figure 3 and those results.\n\nRe-attention\nGenerally speaking, the idea of re-attention is interesting. However, there are many vague places in both motivation and estimation, making me hard to feel convinced. Specifically,\n1. The math in the motivation is not very strict. Please make some revise. Furthermore, there are many other sources of randomness in model training except for DP noise. Please specify them in the conditional distribution.\n2. In section 4.1, the paper mentions that the attention distraction mainly happens when different parameters have different variance. However, in DP-SGD, the noise with the same std is added to each parameter. Could the authors explain about this?\n3. Section 4.2.2 is very hard to follow. For me, it just reads like a mixture of several techniques without a clear explanation. I have several confusions. For example, is the assumption realistic assuming i.i.d. Gaussian for each dimension in parameter? Furthermore, I do not quite follow how to estimate the mean and std of the start point.\n\nExperiments\n1. Since the paper is targeting large models, it is better to have some setting for fine-tuning instead of training from scratch. Also, revealing some results when eps = infty will also be helpful."
                },
                "questions": {
                    "value": "Please refer to weakness."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "3: reject, not good enough"
                },
                "confidence": {
                    "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                },
                "first_time_reviewer": {
                    "readers": [
                        "ICLR.cc/2024/Conference/Program_Chairs",
                        "ICLR.cc/2024/Conference/Submission4309/Senior_Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission4309/Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission4309/Reviewer_FhGH"
                    ]
                }
            },
            "number": 4,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission4309/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698974070480,
            "cdate": 1698974070480,
            "tmdate": 1699894582607,
            "mdate": 1699894582607,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "coRaPSGjHf",
                "forum": "WvVyG8qBCt",
                "replyto": "Bd0E7CPmpV",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission4309/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission4309/Authors"
                ],
                "content": {
                    "comment": {
                        "value": "> The math is not very strict. Please make some revise.\n\n**Reply:** Thanks for your suggestion. In the revised paper, we give the detailed version of phantam clipping in Appendix A.2 and motivation behind re-attention in Appendix A.3. \n\n> I am not convinced why the phantom clipping has such great advantages over ghost clipping. I do not understand why the BM^2 complexity is inherent to the ghost clipping under a careful implementation.\n\n**Reply:** $BM^2$ complexity is provided in the ghost clipping paper. Our contribution is to support parameter sharing along with a 'careful implementation'.\n\n> The ghost clipping has shown a much better memory effIciency. I do not quite understand the gap between Figure 3 and those results.\n\n**Reply:** Our results are not contradictory to existing results. Previous results are obtained when using a large model while we use a relatively small model.\nNote that the advantage of ghost clipping vanishes as model size becomes smaller.\n\n> The attention distraction mainly happens when different parameters have different variance. However, in DP-SGD, the noise with the same std is added to each parameter.\n\n**Reply:** A key observation is, for embedding-based models, not all embedding parameters are equal. As a thought experiment, let the embedding layer be parameterized by $E$ (of shape $m \\times d$). Suppose we add a dummy embedding $e_{m+1}$ into $E$ to obtain $E'$ (of shape $(m + 1) \\times d$) and start DP training, but no data is associated to that dummy token m+1. During each iteration t, we add Gassian noise $n_t$ to the whole $E'$. After $T$ iterations, it is obvious that e_m+1 will become very large (i.e., $e_{m+1} = n_1 + n_2 + ....+ n_T$, distributed as Gaussian with large variance $T \\sigma$). Our definition of effetive error (section 4.2.1) is intended to capture this.\n\n\n> Is the assumption realistic assuming i.i.d. Gaussian for each dimension in parameter?\n\n**Reply:** Note that Gaussian for each dimension in model parameter is not an assumption. It is induced by the DP Gaussian noise (fixing all other randomness). We presume the reviewer's concern is regarding 'use an approximating distribution $q$ to approximate the  distribution $p$, where $q$ follows a indepent Gaussian distribution'. This is a commonly used and well understood assumption in the literature of variational inference and more broadly, Beyesian deep learning, since $p$ is computationally intractable. We can only approximate it using a Gaussian via moment matching. The development of more advanced techniques to help track the evolution of distribution through neural layers is beyond the scope of this work.\n\n\n> I do not quite follow how to estimate the mean and std of the start point?\n\n**Reply:** For example, if the training sequence is [1, 2, 3], then the starting point is $[E_1, E_2, E_3]$ (where $E_i$ is the embedding of token i). The std is estimated by error instantiation (see section 4.2.1). The mean is estimated by itself, $E_i$ (note that access to this noisy parameter can be\ninterpreted as a single sampling opportunity from its underlying Gaussian distribution, which can then be viewed as a one-time Markov Chain sampling. Therefore, the noisy parameter can serve as an estimate of its mean).\n\n> Since the paper is targeting large models, it is better to have some setting for fine-tuning instead of training from scratch. Also, revealing some results when eps = 0 will also be helpful.\n\n**Reply:** We actually target small model in this paper, which is justified by considering the computing resource of end users (preferable for privacy protection through local inference.) Note that for recommendation tasks, how to use a general pre-trained transformer for recommendation task is still a largely open problem. One cannot naively adopt a pre-trained transformer model because the input domain is different (in recommendation task, token $i$ is associatedd with the item with ID $i$ while in NLP token $i$ is associated with some (sub)word defined by the tokenizer). Results when eps = 0 is nearly 0 for both metrics."
                    }
                },
                "number": 1,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission4309/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700492348660,
                "cdate": 1700492348660,
                "tmdate": 1700492348660,
                "mdate": 1700492348660,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    }
]