[
    {
        "title": "Stochastic Extragradient with Flip-Flop Shuffling & Anchoring: Provable Improvements"
    },
    {
        "review": {
            "id": "aDxMifnuNX",
            "forum": "oLTgo1dcIl",
            "replyto": "oLTgo1dcIl",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission5049/Reviewer_ojxo"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission5049/Reviewer_ojxo"
            ],
            "content": {
                "summary": {
                    "value": "The paper proposes to combine stochastic extragradient with flip-flop shuffling and anchoring for solving convex-concave finite-sum minimax problems. Under the assumption that the objective is smooth and Hessian is Lipschitz, the derived algorithm is claimed to have better performance in both theory and some preliminary numerical experiments on a test function, compared to vanilla stochastic gradient descent ascent and extragradient, measured by the gradient norm."
                },
                "soundness": {
                    "value": "2 fair"
                },
                "presentation": {
                    "value": "2 fair"
                },
                "contribution": {
                    "value": "2 fair"
                },
                "strengths": {
                    "value": "The paper studies shuffling-based stochastic extragradient for convex-concave minimax problems. This setting is new and not examined before to the best of my knowledge. The paper has a unified analysis for different sample schemes (Theorem 6.1 & 6.2). The numerical experiments align with the theory."
                },
                "weaknesses": {
                    "value": "1. The paper does not explain why they use the gradient norm as the convergence measure and fails to mention a line of research studying that. In convex-concave minimax problems, the standard convergence measure is the duality gap $\\max_y f(\\bar x,y) - \\min_x f(x,\\bar y)$ or minty solution $F(x)^\\top (\\bar x - x)$ in the sense of variational inequality. This is natural since the optimal point of interest is the Nash equilibrium or the saddle point. There does exist a line of research studying monotone inclusion or gradient norm convergence in the same setting, e.g., Halpern iteration [arXiv:2002.08872, arXiv:2203.09436] or anchoring [arXiv:1905.10899, arXiv:2102.07922, arXiv:2106.02326], but the paper does not compare with them. Specifically, the algorithm in [arXiv:2203.09436] achieves $E\\Vert F z_k\\Vert^2 \\leq 1/k^2$ (see Theorem 4.1) with less assumptions (no Hessian Lipschitzness). The idea of combining extragradient with anchoring is also not new [arXiv:2102.07922].\n\n2. The paper keeps mentioning that GDA and stochastic extragradient do not converge for convex-concave minimax problems and claims that one important contribution is to fix the non-convergence problem. However, for convex-concave minimax problems, it is easy to show that the average iterate of (stochastic) GDA converges with the rate $1/k^{1/2}$ measured by the duality gap, without additional smoothness or Hessian Lipschitzness assumptions (even though the last-iterate does diverge). I am also confused by the statement that previous works (Mishchenko, 2020b & Diakonikolas, 2021) on stochastic extragradient only guarantee convergence to a neighborhood. To my best understanding, these works are able to show $E\\Vert F(x)\\Vert\\leq\\epsilon$ (Theorem 4.4 of Diakonikolas, 2021) or $E[F(x)^\\top (\\bar x - x)]\\leq\\epsilon$ (Theorem 3 of Mishchenko, 2020b). This paper can be misleading and overclaiming.\n\n3. The paper seems to claim that the bounded domain assumption is strong and thus studies the unconstrained setting. However, according to the well-known von Neumann's minimax theorem, when the objective is convex-concave, the convex and compact domain assumption is necessary to ensure the existence of the Nash equilibrium. When the domain is $R^d$, Assumption 2 is questionable, and it's not clear what solution the algorithm finds when $\\Vert Fz\\Vert\\to 0$.\n\n4. The assumption that Hessian is Lipschitz seems to be too strong and unusual for the considered setting. The algorithm studied in the paper is neither high-order nor has a last-iterate convergence guarantee (Theorem 5.4).\n\n5. The convergence of SEG-RR and SEG-FF is strictly worse than SGDA-RR in the strongly monotone setting. Could the authors explain why?\n\n6. Proposition 5.2 says the reason why anchoring is also required to match (13). Then what changes after anchoring is introduced? How does each term in (13) match? Its LHS is of order $\\eta_1\\eta_2/n^2$ while the RHS is of order $\\eta^2$. Does this mean $\\eta_1 = \\eta n$ also holds? Isn't $\\eta_2=2\\eta_1$ still true? Moreover, $z_0-\\eta n F(z_0 - \\eta n F(z_0))$ in Proposition 5.3 is just one step of EG from $z_0$. Does it suggest that $N$ steps of SEG-FFA are equivalent to one step of EG, up to a small error, where $N$ can be multiple of $n$? Is this specifically for $N=2n$?\n\n7. The paper should also include SGDA-US/RR with anchoring and SEG-US/RR with anchoring, at least in experiments, to show that both ingredients of the algorithms are necessary. What if anchoring is the key step that makes everything converge? I do not fully believe that FF is something that should be done in practice, given that its computation is twice as much as the standard method in every epoch.\n\n8. (Minor) Could the author comment on the dependence on the condition number when the operator is strongly monotone and compare it with existing works? It could be more clear if the author explicitly listed all the necessary assumptions required for each theorem. Are Assumptions 1(1'), 2, 3, and 4 necessary for every theorem? The paper should also clearly state that the benefit of shuffling-based methods over uniform sampling only holds when $K>1$, i.e., the multi-pass case."
                },
                "questions": {
                    "value": "See Weaknesses."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "3: reject, not good enough"
                },
                "confidence": {
                    "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 1,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission5049/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698682618909,
            "cdate": 1698682618909,
            "tmdate": 1699636494648,
            "mdate": 1699636494648,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "SyExWlsJ2x",
                "forum": "oLTgo1dcIl",
                "replyto": "aDxMifnuNX",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission5049/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission5049/Authors"
                ],
                "content": {
                    "comment": {
                        "value": "We appreciate the reviewer for the constructive feedback and thoughtful comments\n\n1. **Gradient norm as an optimality measure, and Nash equilibria (W1, W3):**\n\n    We would like to first point out that for (unconstrained) convex-concave problems, a point $(\\boldsymbol{x}^\u2217, \\boldsymbol{y}^\u2217)$ is a first-order stationary point if and only if it is a global Nash equilibrium, since $f(\\boldsymbol{x}, \\boldsymbol{y}^*) \\geq f(\\boldsymbol{x}^*, \\boldsymbol{y}^*) + \\langle \\nabla_{\\boldsymbol{x}} f(\\boldsymbol{x}^*, \\boldsymbol{y}^*), \\boldsymbol{x} - \\boldsymbol{x}^* \\rangle$ and $f(\\boldsymbol{x}^*, \\boldsymbol{y}) \\leq f(\\boldsymbol{x}^*, \\boldsymbol{y}^*) + \\langle \\nabla_{\\boldsymbol{y}} f(\\boldsymbol{x}^*, \\boldsymbol{y}^*), \\boldsymbol{y} - \\boldsymbol{y}^* \\rangle$. \n\n    While we agree that the squared gradient norm is not an adequate measure of convergence for *constrained* problems (as also pointed out in Section 1.1 of (Gorbunov et al., 2022b)), taking the squared gradient norm as an optimality measure is not unnatural in *unconstrained* problems. We would also like to note that Gorbunov et al. (2022b) study the convergence of EG in the unconstrained case, using the squared gradient norm as the optimality measure.\n\n    We would like to also note that the convex and compact domain assumption in von Neumann\u2019s minimax theorem is a *sufficient* condition for the existence of a Nash equilibrium, but not a *necessary* condition. For example, consider a simple bilinear problem with $f (x, y) = xy$. This has a unique first-order stationary point $(0, 0)$, which is a global Nash equilibrium. For this reason, we believe that Assumption 2 is natural, as it is analogous to assuming the existence of a minimum in convex minimization.\n\n2. **Existing results on anchoring (W1):**\n\n    We appreciate the reviewer for bringing up the existing results that adopt similar ideas of anchoring, which was not explained well. First of all, we have clarified in footnote 1 that our anchoring and the Halpern-based anchoring are different in their formulations. In addition, their motivations differ as the former (ours) is for the *second-order matching* that makes SEG converge in the convex-concave cases, while the latter is for acceleration in rate. Therefore, we would like to claim that our anchoring approach is new, in the sense that we adopt the idea for making SEG converge in the first place. The  (Cai et al., 2022) [arXiv:2203.09436] paper you kindly mentioned introduces the Halpern-based anchoring to SEG for acceleration, but it requires increasing the batch size after each epoch, on top of the requirement that the variance is uniformly bounded over the domain, which are quite restrictive compared to our setting. This is now stated in Section 2.\n\n3. **Stochastic GDA (W2):**\n\n    We are not sure which paper the reviewer is referring to, and we would appreciate it if the reviewer could give us a pointer; nevertheless, we suspect that the mentioned convergence guarantee might not apply to our unconstrained convex-concave setting. This is because, in the *unconstrained* $\\min_x \\max_y f (x, y) = xy$ case, the duality gap $\\max_y f (\\bar{x}, y) \u2212 \\min_x f (x, \\bar{y})$ is always $\\infty$ unless $(\\bar{x}, \\bar{y}) = (0, 0)$. Hence, duality gap results should require the assumption of bounded domain. Nevertheless, we would be happy to learn about the reference that discusses the ergodic convergence of the stochastic GDA."
                    },
                    "title": {
                        "value": "Official Comment by Authors (1/3)"
                    }
                },
                "number": 6,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission5049/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700684363761,
                "cdate": 1700684363761,
                "tmdate": 1700685490028,
                "mdate": 1700685490028,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "5BzPOSe4XG",
                "forum": "oLTgo1dcIl",
                "replyto": "aDxMifnuNX",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission5049/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission5049/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Official Comment by Authors (2/3)"
                    },
                    "comment": {
                        "value": "4. **Statement regarding convergence to neighborhood of an optimum (W2)**\n\n    The reviewer is correct that both (Theorem 4.4, Diakonikolas et al., 2021) and (Theorem 3, Mishchenko et al., 2020b) show that they can find an $\\epsilon$-stationary point. However, what we originally meant by \u201cconvergence to neighborhood\u201d was that the analyses do not imply that the methods will reach an optimum as $k \\to \\infty$, in the sense that the optimality measure goes all the way to zero as $k \\to \\infty$. (Here $k$ denotes the number of iterations.) In particular, by taking a close look at the proof of (Theorem 4.4, Diakonikolas et al., 2021), one can see that we need to choose the number of samples per iteration that is greater than $\\mathcal{O}(1/\\epsilon)$ to guarantee finding an $\\epsilon$-stationary point, and to guarantee reaching an optimum one needs $n \\to \\infty$ in the proof. In addition, (Theorem 3, Mishchenko et al., 2020b) presents a rate bound for a constant step size $\\mathcal{O}(1/\\sqrt{t})$ for a fixed budget of $t$ iterations, hence cannot handle the $t \\to \\infty$ case. Nevertheless, we learned that this is subtle and may confuse the readers. So, we decided to emphasize more on our other advantages over existing literature (especially those brought up by the reviewers) in unconstrained cases, and do not argue on the aspect of the convergence to neighborhood.\n\n    We also would like to note that, as now explicitly stated in our Section 2, Diakonikolas et al. (2021) assume the variance to be uniformly bounded over the domain, which is more restrictive than our setting. In addition, Mishchenko et al. (2020b) require the domain to be bounded (as they take the supremum over the entire domain in the final bound) and the stochastic component to be monotone almost surely.\n\n5. **Lipschitz Hessian assumption (W4):**\n\n    For our comments for the Lipschitz Hessian assumption, we kindly ask the reviewer to refer to the general comments. We would also like to point out that our results in the strongly monotone setting are guarantees on the last iterate.\n\n6. **Convergence rates of SEG-RR and SEG-FF (W5):**\n\n    It is indeed true that our convergence rates $\\mathcal{O} ( \\frac{1}{n K^{2-3\\epsilon}} )$ for SEG-RR and SEG-FF are slightly slower than the known $\\tilde{\\mathcal{O}} ( \\frac{1}{nK^2} )$ of SGDA-RR. We believe that it is an artifact of our attempt on establishing a unified analysis (Theorem 6.2), and it is not a serious limitation since $\\epsilon$ is a number that we can choose arbitrarily small. Also, our main focus is to show the effectiveness of SEG-FFA, which attains a strictly improved rate over SGDA and other SEG variants on both strongly-monotone and monotone problems, with provable gaps (recall Theorems 4.2 and 5.6 in particular).\n\n7. **On the questions regarding Section 5 (W6):**\n\n    Proposition 5.3 states that after introducing the anchoring step with $\\theta =1$, choosing $\\beta = \\eta$ and $\\alpha = \\eta/2$ makes the LHS and RHS terms in (13) (which is now (15) in the revised manuscript) to match with \"$\\eta_1 = \\eta_2 = n\\eta$\". This is not easy to verify because, in case of filp-flop sampling ($N = 2n$), the sum $\\sum_{0 \\leq i < j \\leq N-1} D\\boldsymbol{T}_j (\\boldsymbol{z}_0) \\boldsymbol{T}_i (\\boldsymbol{z}_0)$ on the RHS contains both of the sums in the LHS of (13). So, we would like to refer the reviewer to Lemma C.4 for more exact calculations.\n\n    Here, the reviewer is correct on observing that the overall update made in the FFA epoch (consisting of $2n$ steps and the anchoring) is equivalent to a single step of EG plus some small noise. This is in fact the key idea in many existing analysis of shuffling-based methods: aggregate the stochastic updates over an epoch and write them as a single deterministic update plus small noise. For SEG-FFA we have $N = 2n$ because one epoch contains $2n$ updates, but we chose this general notation $N$ because other methods may have different values of $N$; for example, we have $N = n$ for SEG-RR. We have further clarified this in our revised Section 5.\n\n8. **Anchoring but without FF (W7):** \n\n    According to our analyses demonstrated in Section 5, adding anchoring on US/RR will not show a decisive improvement, because anchoring by itself cannot achieve second-order matching. Nevertheless, we performed an ablation study testing the effect of anchoring applied to SEG-US and SEG-RR; please see Appendix H. We have not considered applying anchoring to SGDA-US and SGDA-RR, since it is obvious that they diverge for a simple bilinear finite-sum problem when $f_1(x, y) = f_2(x, y) = \\dots = f_n(x, y) = xy$.\n\n    As for the computational burden caused by flip-flop shuffling, one can simply reduce the number of epochs by half. So, in our experiments, we make comparisons between RR and FF schemes with respect to the number of passes through the components."
                    }
                },
                "number": 7,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission5049/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700685480559,
                "cdate": 1700685480559,
                "tmdate": 1700685480559,
                "mdate": 1700685480559,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "ETEaT0VfVK",
                "forum": "oLTgo1dcIl",
                "replyto": "aDxMifnuNX",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission5049/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission5049/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Official Comment by Authors (3/3)"
                    },
                    "comment": {
                        "value": "9. **Three minor comments (W8):**\n\n    We agree that it is best to include the dependency on the condition number, but for the rebuttal period we had to focus on addressing other major issues. We will make this clear in our next revision.\n\n    In the initial submission, some theorems did not explicitly include the assumptions used. As correctly guessed by the reviewer, Assumptions 1\u20134 are used in most of the theorems. We have modified the statements accordingly.\n\n    We added \"when $K$ is large enough\" below Theorem 4.1."
                    }
                },
                "number": 8,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission5049/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700685569753,
                "cdate": 1700685569753,
                "tmdate": 1700685569753,
                "mdate": 1700685569753,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "l4FOAiWTyc",
            "forum": "oLTgo1dcIl",
            "replyto": "oLTgo1dcIl",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission5049/Reviewer_ZXRs"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission5049/Reviewer_ZXRs"
            ],
            "content": {
                "summary": {
                    "value": "It is known that the random reshuffling can often improve stochastic gradient descent methods. The paper considers the case of stochastic extragradient method (SEG) for minimax optimization and proposes SEG with flip-flop anchoring as the random reshuffling counterpart. The methods are designed based on a second-order matching arguments. The paper proves that the method converges under general assumptions and has superior convergence rate than SEG."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "3 good"
                },
                "strengths": {
                    "value": "I think the paper is good and has some novelties. The flip-flop shuffling is only analyzed in the basic quadratic case in the previous literature. So the analysis in this paper will be very useful for future extentions. The idea of using anchoring to improve the convergence is also quite impressive. I did not check all the prove details, but the results seem fairly reasonable for me."
                },
                "weaknesses": {
                    "value": "See questions."
                },
                "questions": {
                    "value": "The experiments section should be expanded or put into the appendix. Details of the experiments should be provided. The last sentence \"suggest that the convergence rate derived in this paper may have room for improvement\" is confusing. Can the authors elaborate on this?\n\nMy second question is that can the analysis of flip-flop shuffling be applied to other settings? As far as I know, this is the first time it is analyzed beyond quadratic setting, so I am interested if the analysis can be applied to usual convex optimization cases."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "8: accept, good paper"
                },
                "confidence": {
                    "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 2,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission5049/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698849037967,
            "cdate": 1698849037967,
            "tmdate": 1699636494565,
            "mdate": 1699636494565,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "K9dV0aoWEA",
                "forum": "oLTgo1dcIl",
                "replyto": "l4FOAiWTyc",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission5049/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission5049/Authors"
                ],
                "content": {
                    "comment": {
                        "value": "We appreciate the reviewer for the positive feedback and thoughtful comments.\n\n1. **On the experiments (Q1):**\n    \n    As suggested, we expanded the experiment section with details, and moved it to Appendix H.\n\n2. **Clarification on the last sentence in Section 7 (Q1):** \n\n    We entirely rewrote the experiment section to accommodate the reviewer\u2019s suggestions, and the last sentence in Section 7 is now removed. Anyway, by the last sentence in Section 7, we were pointing to the observation that even though the step size chosen according to our analysis successfully converges, the algorithm also converges with much larger choices of step size. This behavior suggests that maybe the convergence of SEG-FFA can be shown for a larger step size and hence with a faster rate; this is what we meant by \"room for improvement\".\n\n3. **Flip-flop shuffling to other problems (Q2):**\n\n    Since a minimization problem can be viewed a special case of a minimax problem whose objective function is constant with respect to the maximization variable, at the very least, our results should be directly applicable to convex minimization problems. Still, our arguments and proofs are tailored to minimax problems, so investigating whether one can improve upon our results for minimization problems would be an interesting future work."
                    }
                },
                "number": 5,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission5049/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700683345777,
                "cdate": 1700683345777,
                "tmdate": 1700683345777,
                "mdate": 1700683345777,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "TibhThc3sh",
            "forum": "oLTgo1dcIl",
            "replyto": "oLTgo1dcIl",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission5049/Reviewer_emGH"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission5049/Reviewer_emGH"
            ],
            "content": {
                "summary": {
                    "value": "The paper focuses on shuffling-based SEG for solving finite-sum min-max optimization problems. In particular, it studies the convergence of the method in a strongly monotone and monotone regime. The proposed analysis reveals that both random reshuffling and the flip-flop shuffling alone cannot fix the non-convergence issue of classical SEG in Convex-Cocave problems. By using anchoring on top of the algorithms, the authors develop the SEG with the flip-flop anchoring (SEG-FFA) method, which successfully converges in Convex-Concave problems."
                },
                "soundness": {
                    "value": "2 fair"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "2 fair"
                },
                "strengths": {
                    "value": "The paper is well-written, and the main contributions are clear. To the best of my knowledge, this is one of the first papers that provides an analysis of random reshuffling variants for solving min-max problems. Existing variants of the random reshuffling method, as correctly pointed out by the authors, focus on the Gradient descent ascent method. Having an analysis of a shuffling-based SEG is a great next step in this literature."
                },
                "weaknesses": {
                    "value": "However, I believe this work has some misleading statements, and the presentation of specific parts is unclear. \n\nLet me provide some details below:\n\n1) There are a few inconsistencies in the paper.  In my opinion, some parts and claims are not totally clear based on prior works. \nFor example, the authors claim that there is an example that SEG-US and SEG-RR diverge. However, the example that they select is a simple bilinear problem for which we know now that the SEG-US converges to the solution with a proper selection of step-sizes (see Hsieh et al 2020).  In particular, the authors claim that SEG-US diverges in expectation for any positive step-size selection. This comes in contradiction with existing known theoretical results. Why is that the case? Can the authors provide a detailed comparison with prior work?\n\n2) In several parts of the paper, the authors claim that EG is a good approximation of PP. This was already disproved in Gorbunov et al. 2022b, where the authors emphasize a significant difference between EG and the Proximal Point method.\n\n3) The section 5 had the potential to be very informative. In the first paragraph of this section, the authors mentioned that the section is where the underlying cause for non-convergence of SEG-RR is investigated, and the motivation of sing anchoring is explained . However, the section is not clear, and several important parts are missing. The presentation of the \"SECOND-ORDER MATCHING\" part is not robust, which makes the understanding and importance of the results in section 5 unclear. For example, there is no proper definition of what second-order means in EG update rules, and the results are not positioned in the literature. \n\n4)  #### On theoretical statements: \nThe authors wrote the following in their work: \"$O(\\eta^3)$ for the approximation error turns out to be the key to the exact convergence to an optimum under the monotone setting\". This sentence, unfortunately, was not adequately explained in detail in the main paper. Why this statement is necessary?\n\n5)  #### On theory: \nStatement of the theorems do not include all necessary assumption. I imagine that Assumptions 3 and 4 need to hold for every theorem, but this is not precisely stated. \n\n6)  #### Important comment on Assumptions: \nThe authors claim that Assumptions 3 and 4 are reasonable. They pointed out that the work of Golowich et al., 2020 uses Assumption 3(ii) to argue that this is a reasonable assumption. However, assumption 3(ii) is never used in any other paper on analysis for SEG (a first-order method). For example (Gorbunov et al., 2022b) remove assumption 3(ii) and still have nice convergence guarantees for SEG-US. In addition, Assumption 4 is also not reasonable to have. Of course, assumption 4 is more relaxed than bounded variance, but as explained in Gorbunov et al., 2022a this is not a necessary condition to show convergence. SEG-US does not require any bound on the stochastic gradient to guarantee convergence  (see Gorbunov et al., 2022a ),\n\n7) #### On Experiments: \nI believe algorithms in the experiments are compared with wrong step-size selection, which led to unfair comparison. That is, even if in Appendix A, all pseudocodes use $\\alpha_t$ and $\\beta_t$ to denote the extrapolation and update steps, respectively.\n in the experiments, $\\eta_k=\\alpha_k=\\beta_k$ is used for all methods. However, for the bilinear example, it is known that using the same step-size leads to no convergence of SEG-US. See (Hsieh, et al., 2020)\n\n8) Finally, the paper needs further experiments for completeness. For example, what is the practical benefit of the proposed method compared to other RR algorithms for solving strongly monotone problems?\n\n----\nHaving shared the above concerns in statements and presentations, analyzing SEG with random reshuffling is exciting and relevant for the ML community. I will happily increase my score if answers are given to my above criticism. That is, can the authors relax the existing assumptions and heavily improve the presentation of this work?"
                },
                "questions": {
                    "value": "See the Weaknesses section."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "details_of_ethics_concerns": {
                    "value": "n/a"
                },
                "rating": {
                    "value": "3: reject, not good enough"
                },
                "confidence": {
                    "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 3,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission5049/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698994399535,
            "cdate": 1698994399535,
            "tmdate": 1699636494482,
            "mdate": 1699636494482,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "iBASfXgW6h",
                "forum": "oLTgo1dcIl",
                "replyto": "TibhThc3sh",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission5049/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission5049/Authors"
                ],
                "content": {
                    "comment": {
                        "value": "We appreciate the reviewer for acknowledging the importance of studying the shuffling-based SEG and for providing the comprehensive feedback.\n\n1. **Comparing with (Hsieh et al., 2020) (W1):**\n\n    You are correct that the initial version was confusing, and we have now revised the paper (in footnote 2) so that it is clear that we focus on a *same-sample* version of the SEG (i.e., use the same component function for both extrapolation and update steps), which we believe is a more efficient and natural implementation of EG in without-replacement sampling scenarios. Hsieh et al. (2020) consider different independent samples for the two steps within one update of the SEG, so there is no contradiction between (Hsieh et al., 2020) and our results.\n\n    A noteworthy remark regarding the comparison of our algorithm against (Hsieh et al., 2020) is that the existing paper shows convergence to an optimum for a convex-concave problem but does not have an explicit rate; in contrast, we prove convergence with a rate.\n\n2. **On whether EG is a good approximation of PP (W2):**\n\n    The claim by Gorbunov et al. (2022b) on the \u201csignificant\u201d difference between EG and PP is based on the observation that PP update, as an operator, is always nonexpansive, while EG update may be expansive. In contrast, we look at the two algorithms from a different angle; our motivation was that a method that differs from EG by at most $\\mathcal{O}(\\eta^3)$ would lead to convergence in convex-concave settings, where $\\eta$ is the step size. This was based on the observation, in (Mokhtari et al., 2020), that the update equations of the convergent methods\u2014namely EG and PP (and even OGDA)\u2014differ from each other by at most $\\mathcal{O}(\\eta^3)$ per epoch. Importantly, the updates of divergent methods such as GDA and various SEGs without FFA differ from the convergent methods by at least $\\mathcal{O}(\\eta^2)$, leading to our conjecture that the $\\mathcal{O}(\\eta^2)$ error is the main cause of nonconvergence. We believe this concern arose because of our unclear writing of Section 5, and we put efforts on improving the presentation of that section.\n\n3. **On the presentation of Section 5 and second-order matching (W3-4):**\n\n    By *second-order matching* we mean choosing proper step sizes, sampling scheme, and anchoring scheme so that our without-replacement SEG can *deterministically* match the update equation of a convergent algorithm (EG or PP) up to the $\\mathcal{O}(\\eta^2)$ terms (*i.e.*, *second-order* terms in the Taylor expansion). We added the term \u201cTaylor expansion\u201d and improved corresponding sentences in the revision to make the definition of second-order matching clear.\n\n    We have also improved Section 5 to make our argument \u201c$\\mathcal{O}(\\eta^3)$  for the approximation error turns out to be the key to the exact convergence to an optimum under the monotone setting\u201d clearer. We provide a brief summary of Section 5 below for your understanding.\n\n    We show in Section 5.1 that the second-order matching is not achievable for both SEG-RR and SEG-FF. SEG-RR suffers a difference of at least $\\mathcal{O}(\\eta^2)$ from the convergent methods. For SEG-FF, as we show in Proposition 5.2, the best we can do is to choose specific step sizes and get an $\\mathcal{O}(\\eta_1^3)$ approximation of an instance of EG+ with $\\eta_2 = 2\\eta_1$. However, unfortunately, EG+ with $\\eta_2 = 2\\eta_1$ fails to converge already on bilinear problems. On the contrary, as we show in Proposition 5.3, SEG-FFA can approximate the standard EG with an error of $\\mathcal{O}(\\eta^3)$. In Section 5.2, we show that this second-order matching property of SEG-FFA indeed enables us to establish improved convergence rates.\n\n4. **On the Assumptions for Theorems (W5):**\n\n    In the initial submission, statements of some theorems did not explicitly include the assumptions used. As correctly guessed by the reviewer, Assumptions 3 and 4 are used in most of the convergence proofs. We have modified the statements accordingly."
                    },
                    "title": {
                        "value": "Official Comment by Authors (1/2)"
                    }
                },
                "number": 3,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission5049/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700682290815,
                "cdate": 1700682290815,
                "tmdate": 1700682323594,
                "mdate": 1700682323594,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "LeHdCrOleN",
                "forum": "oLTgo1dcIl",
                "replyto": "TibhThc3sh",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission5049/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission5049/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Official Comment by Authors (2/2)"
                    },
                    "comment": {
                        "value": "5. **Reasonableness of the assumptions 3 and 4 (W6):**\n\n    For our comments for Assumption 3, we invite the reviewer to check the general comment.\n\n    In regard of Assumption 4, the analyses of Gorbunov et al. (2022a) does not require any bound on the variance, but they do require the stochastic gradients to be sufficiently regulated in the following sense: assuming for each $i$ that the operator *$\\boldsymbol{F}_i$* is $\\mu_i$-strongly monotone (allowing $\\mu_i < 0)$, it should hold that $\\sum_{i=1}^{n} \\mu_i ({\\boldsymbol{1}_{{\\mu_i \\geq 0}}} + 4 \\cdot \\boldsymbol{1}_{ \\mu_i  \\textless 0 }) > 0$ where $\\boldsymbol{1}$ denotes the indicator function (see eq. (9) in their paper). Thus, this is close to assuming strong monotonicity of the majority of component functions $\\boldsymbol{F}_i$, and we believe that this already should provide sufficient level of \u201ccontraction\u201d to show convergence without bounded variance assumptions. In stark contrast, we do *not* make any (strong) monotonicity assumptions on $\\boldsymbol{F}_i$; our monotonicity assumptions only apply to their mean $\\boldsymbol{F}$. Thus, we believe that our paper and (Gorbunov et al., 2022a) are not directly comparable because of different regularity conditions on the stochastic gradients. We now briefly mention this in footnote 3.\n\n6. **On the experiments (W7-8):**\n\n    We hope now that your concern on our choice of same step size $\\alpha_k = \\beta_k$ in the experiment has been somewhat alleviated, considering that we focus on the same-sample case. Nevertheless, we learned that a numerical comparison with a convergent independent-sample SEG in (Hsieh et al., 2020) is necessary, so we added an experiment in which we discovered that SEG-FFA outperforms the method in (Hsieh et al., 2020). We also conducted an experiment on strongly monotone problems in which SEG-FFA again outpaced all other baseline methods."
                    }
                },
                "number": 4,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission5049/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700683160816,
                "cdate": 1700683160816,
                "tmdate": 1700683160816,
                "mdate": 1700683160816,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    }
]