[
    {
        "title": "Conformal Language Modeling"
    },
    {
        "review": {
            "id": "hT8ZxGE4Vw",
            "forum": "pzUhfQ74c5",
            "replyto": "pzUhfQ74c5",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission3911/Reviewer_1uqq"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission3911/Reviewer_1uqq"
            ],
            "content": {
                "summary": {
                    "value": "This paper proposes an extension of the learn-then-test framework which could help generating responses from language models with risk control. It proposes a sampling pipeline which involves adding generations to a prediction set until the set-level confidence score is above a threshold. The whole pipeline involves using LTT to search for viable configs of three hyperparameters (for the quality of single generation, the rejection/diversity of single generation, and the quality of the prediction set). The experiments were carried out on three medical and benchmark datasets, suggesting that this pipeline generally is able to find feasible hyperparams."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "3 good"
                },
                "strengths": {
                    "value": "This is a first (yet quite solid) step forward in conformal prediction in NLG. It proposes a general framework to sample responses from language models with some given criteria (admission function), and allows independent research to improve the various scoring functions (quality estimate, diversity rejection criteria, etc.) in the pipeline. Breaking down the full generation into different components is also a nice way to address the question of UQ for longer texts."
                },
                "weaknesses": {
                    "value": "The main weakness is the use of ROUGE-L as a proxy of the quality of the generation. This only captures the the lexical similarity between the generation and the reference, which undermines the experiments quite a bit, in the following sense:\n1. the LTT framework might return null hyperparameters, which might happen more often should the admissible function by the human be stricter than ROUGE\n2. ROUGE was also used in the pipeline (detecting duplicate) so it's kind of \"being its own judge\"\n\nAnother potential improvement is to include a stronger baseline than first-K - for example, the duplicated responses (maybe even basing on rouge) should at least be deleted?"
                },
                "questions": {
                    "value": "1. How are the thresholds 0.4 and 0.35 for ROUGE-L determined? What does \"These thresholds are picked through manual validation\" mean exactly?"
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "8: accept, good paper"
                },
                "confidence": {
                    "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
                },
                "code_of_conduct": {
                    "value": "Yes"
                },
                "first_time_reviewer": {
                    "value": "Yes",
                    "readers": [
                        "ICLR.cc/2024/Conference/Program_Chairs",
                        "ICLR.cc/2024/Conference/Submission3911/Senior_Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission3911/Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission3911/Reviewer_1uqq"
                    ]
                }
            },
            "number": 1,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission3911/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698353738611,
            "cdate": 1698353738611,
            "tmdate": 1699636351206,
            "mdate": 1699636351206,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "li257WzJVE",
                "forum": "pzUhfQ74c5",
                "replyto": "hT8ZxGE4Vw",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission3911/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission3911/Authors"
                ],
                "content": {
                    "comment": {
                        "value": "We thank the reviewer for their careful review and thoughtful comments. We provide answers to specific questions and remarks (quoted) below.\n\n> The LTT framework might return null hyper-parameters, which might happen more often should the admissible function by the human be stricter than ROUGE\n\nThis is true, however, the opposite is also true when the human evaluation is less strict than ROUGE at a high threshold (since by the same argument, the fact that ROUGE is sensitive to exact wording agreement between the generation and the reference can also lead to it being conservative).\n\n> ROUGE was also used in the pipeline (detecting duplicate) so it's kind of \"being its own judge\"\n\nYes, ROUGE is also used in the pipeline, but this **does not affect the validity of the calibration process** (calibration is still computed based on similarity to the labeled answers only). In fact, we argue that having a similarity function that is directly connected to the final evaluation via transitive-like properties is a good thing. That is, if \"$=$\" is defined to be our similarity operator,  $A$ and $B$ are two generations where $A = B$, and $C$ is the target generation, we can choose to reject either $A$ or $B$ without incurring any increased risk. Of course, ROUGE-L and other proxies don't necessarily satisfy this, which is why we must calibrate thresholds simultaneously. \n\n> What does \"These thresholds are picked through manual validation\" mean exactly?\n\nThe ROUGE-L thresholds for the admission functions were selected by the authors by manually inspecting a sample of random examples (~O(100)), evaluating ROUGE-L, and selecting the minimum value of ROUGE-L such that all samples with ROUGE-L greater than this threshold were acceptable. \"Acceptable\" in this context means that the generations were faithful and complete with respect to the perceived ground truth (which is inferred from the input and the collection of annotations available). \n\nOf course, this inevitably includes some error, as described in the paper. Though outside the scope of this paper, uncertainty in these labels can also be incorporated though methods like those explored in Angelopoulos et. al., 2023 and Stutz et. al., 2023. What makes a generation \"acceptable\" can also be better codified\u2014for example, by following methods like Nenkova and Passonneau, 2004.\n\nIn general, as described in our limitations and assumptions section, figuring out what makes a generation \"acceptable\" requires some careful thought and domain expertise. Still, fortunately our framework is general\u2014and we can still bound the risk for any instantiation of $A(y)$. The design we used in this paper is illustrative, in addition to being reasonably effective in of itself.\n\n> Another potential improvement is to include a stronger baseline than first-K - for example, the duplicated responses (maybe even basing on rouge) should at least be deleted?\n\nThanks for the suggestion\u2014we added a variant with rejection. Please refer to our [general response](https://openreview.net/forum?id=pzUhfQ74c5&noteId=FNXkWfpKC5). \n\n[1]  Prediction-Powered Inference. Anastasios N. Angelopoulos, Stephen Bates, Clara Fannjiang, Michael I. Jordan, Tijana Zrnic. 2023.\n\n[2] Conformal prediction under ambiguous ground truth. David Stutz, Abhijit Guha Roy, Tatiana Matejovicova, Patricia Strachan, Ali Taylan Cemgil, Arnaud Doucet. 2023.\n\n[3] Evaluating content selection in summarization: The pyramid method. Ani Nenkova, Rebecca J Passonneau. 2004."
                    }
                },
                "number": 7,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission3911/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700539209165,
                "cdate": 1700539209165,
                "tmdate": 1700539209165,
                "mdate": 1700539209165,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "cDbsS3x76n",
            "forum": "pzUhfQ74c5",
            "replyto": "pzUhfQ74c5",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission3911/Reviewer_7gqi"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission3911/Reviewer_7gqi"
            ],
            "content": {
                "summary": {
                    "value": "This paper studies inference of responses generated by large language models (LLMs), \nleveraging ideas of conformal prediction. The specific aim is to construct a set of \nresponses for a given prompt $x$, such that at least one response in the set is \n``acceptable'' (compared with an expert response that we do not get to observe).\n\nThe main technical component is from [1], where the Learn then test (LTT) method is \ntailored for this specific setting. The authors evaluate the proposed method on the task \nof radiology report generation, news summarization, and open-domain question answering.\n\n[1] Angelopoulos, Anastasios N., et al. \"Learn then test: Calibrating predictive algorithms to achieve risk control.\" arXiv preprint arXiv:2110.01052 (2021)."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "4 excellent"
                },
                "contribution": {
                    "value": "3 good"
                },
                "strengths": {
                    "value": "1. The paper is very written: it contains sufficient details and is easy to follow. \n2. This work provides an interesting application of the LTT framework. From my understanding, the major \ncontribution includes formulating the task as a risk-controlling problem, specifying the tuning parameters, \nand identifying the optimization problem that fits practical goals. \n3. The paper also provides abundant numerical evidence supporting the validity and efficiency of the proposed method."
                },
                "weaknesses": {
                    "value": "I do not see obvious weaknesses of this work, but a few questions regarding some details (they are in the question section)."
                },
                "questions": {
                    "value": "1. I wonder how the computational time (or relative excess samples) changes with regard to the choice of $k_\\max$?\n2. In the proposed method, $k_\\max$ is fixed. As pointed out by Remark 4.3, the choice of $k_\\max$ does not affect \nthe coverage guarantee, but could result in uninformative results. I wonder if it could be possible to treat $k_\\max$ as a tuning \nparameter as well, e.g., $\\lambda_4 = k_\\max$, and we can then optimize over all ``valid'' k_\\max.\n3. For the individual component pruning, I also wonder if the $\\gamma$ can be tuned jointly with the $\\lambda$'s to avoid the \nunion bound?"
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "8: accept, good paper"
                },
                "confidence": {
                    "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 2,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission3911/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698759448504,
            "cdate": 1698759448504,
            "tmdate": 1699636351084,
            "mdate": 1699636351084,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "9W69YgvrhF",
                "forum": "pzUhfQ74c5",
                "replyto": "cDbsS3x76n",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission3911/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission3911/Authors"
                ],
                "content": {
                    "comment": {
                        "value": "We thank the reviewer for their careful review and thoughtful comments. We provide answers to specific questions and remarks (quoted) below.\n\n> I wonder how the computational time (or relative excess samples) changes with regard to the choice of $k_\\mathrm{max}$?\n\nIncreasing $k_\\mathrm{max}$ will decrease the minimum achievable risk, but also increase the computational time (in the worst case). However, even with a high $k_\\mathrm{max}$, one can still select a $\\hat{\\lambda}$ that has similar performance to a different $\\lambda$ derived using a lower $k_\\mathrm{max}$ (e.g., by placing a higher weight on fewer excess samples in Eq. 7). \n\nOne practical advantage of setting $k_\\mathrm{max}$ to a lower value is that calibration can be faster. For example, in our implementation we first sample $n \\times k_\\mathrm{max}$ samples in parallel for the calibration set, and then calibrate $\\lambda$ offline. \n\n> I wonder if it could be possible to treat $k_\\mathrm{max}$ as a tuning parameter as well\n\nGreat suggestion! While it may still be beneficial to explicitly specify a finite upper bound (e.g., select $k_\\mathrm{max} \\in \\mathbb{N} : k_\\mathrm{max} \\leq K$ for a finite upper bound $K$), it is certainly possible to also tune $k_\\mathrm{max}$. In fact, the RAPS method of [1] does something very similar to this idea (where k is a hyper-parameter for improving set quality, which in this case we would also tune during calibration instead of pre-specifying). It would be interesting to explore this in future work.\n\n[1] Uncertainty Sets for Image Classifiers using Conformal Prediction. Anastasios N. Angelopoulos, Stephen Bates, Jitendra Malik, Michael I. Jordan. 2020.\n\n> I also wonder if the $\\gamma$ can be tuned jointly with the $\\lambda$'s to avoid the union bound?\n\nYes, this is also another good suggestion! In general, we can use LTT (and more specifically Pareto Testing by Laufer et. al.) to control multiple risks simultaneously. In this case, those risks would be the coverage risk and the false positive risk. $\\gamma$ and $\\lambda$ can then simply be combined into one configuration, as suggested. That said, as also mentioned in our response to reviewer Sb79, decoupling set construction from component selection makes experimentation and deployment easier (for example, we don't need to redo calibration of components when picking a different $\\epsilon$). We found this to be a major practical benefit."
                    }
                },
                "number": 6,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission3911/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700538988674,
                "cdate": 1700538988674,
                "tmdate": 1700538988674,
                "mdate": 1700538988674,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "SkqVztrsrn",
            "forum": "pzUhfQ74c5",
            "replyto": "pzUhfQ74c5",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission3911/Reviewer_zQVz"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission3911/Reviewer_zQVz"
            ],
            "content": {
                "summary": {
                    "value": "This paper proposes a different kind of sampling for LMs. The idea is to extend ideas from Conformal Prediction to produce solution sets that contain diverse outputs. Generation follows a three step process involving sampling, accepting (if the answer is sufficiently high probability), and then possibly resampling if there aren't enough diverse answers in the set yet.\n\nEvaluation is done on a few tasks and LMs -- chest Xrays with a GPT2 small LM + ViT, news summarization on CNN/dailymail with T5-XL, and Open-domain QA on triviaQA sampled from LLaMA-13B. To the best of this reviewer's understanding the evaluation is done assuming access to the ground truth set of references, and so early stopping is done if the prediction set contains the answer already."
                },
                "soundness": {
                    "value": "2 fair"
                },
                "presentation": {
                    "value": "2 fair"
                },
                "contribution": {
                    "value": "2 fair"
                },
                "strengths": {
                    "value": "To this reviewer, the application of conformal prediction to LMs could be interesting. Sampling in a way that preserves diversity and quality; and that returns a variety of different generations at the sequence level, could be a solid contribution. There's a lot of math here (mostly beyond the understanding of this reviewer, who is not an expert on conformal prediction in particular) but that could be helpful to people working in this space, for how to extend these ideas to LMs where the solution space is vast."
                },
                "weaknesses": {
                    "value": "To this reviewer, it's a bit unclear what the benefit of this approach is (ie what problem it's solving). There's a worked example but it's a bit hard to follow as I'm neither an expert in conformal prediction nor cardiology. I guess my confusion comes down to this part:\n\n\"Like conformal prediction, our method offers a rigorous coverage guarantee by constructing prediction sets that, in our case, provably contain at least one acceptable response with high probability. Unlike conformal prediction, however, we do not enumerate the entire output space (which is impossible). Instead, we derive a calibrated stopping rule for sampling different outputs from the LM that get added to a growing output set of candidates, until we are confident that the output set is sufficient\"\n\nThis seems reasonable to this reviewer, but it also seems like from the experiments, the stopping rule involves having access to the test set answers, which seems not realistic. It's not quite clear what the objective is (minimize loss, minimize excess numbers of samples).\n\nI think this paper would also benefit from some stronger yet simpler baselines that don't follow conformal prediction. E.g. sampling N times and checking whether any of the samples is in the ground truth.\n\nI think this paper would benefit from comparison with other types of ways of controlling diversity, e.g. Stochastic Beam Search https://arxiv.org/abs/1903.06059 or NeuroLogic sampling https://aclanthology.org/2022.naacl-main.57/ . A worry I have with this approach (that I asked in the 'questions' field) is that the procedure in Sec 4 might never terminate because the LM might keep returning the same kind of answer over an over again (or at least a sufficiently strong LM might); maybe lexically constrained decoding would fix this.\n\nFinally there's the evergreen concern that this approach might become less important at scale; comparing e.g. GPT2small vs GPT2-XL could help here."
                },
                "questions": {
                    "value": "for the 3-step procedure described in section 4, is it possible this will never terminate? To this reviewer, it seems a little bit sketchy to use ROUGE or BLEU to score diversity."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "3: reject, not good enough"
                },
                "confidence": {
                    "value": "2: You are willing to defend your assessment, but it is quite likely that you did not understand the central parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 3,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission3911/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698800875282,
            "cdate": 1698800875282,
            "tmdate": 1699636350995,
            "mdate": 1699636350995,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "NsO4ex80ll",
                "forum": "pzUhfQ74c5",
                "replyto": "SkqVztrsrn",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission3911/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission3911/Authors"
                ],
                "content": {
                    "comment": {
                        "value": "We thank the reviewer for their careful review and thoughtful comments. \n\nWe want to first clarify one key misconception in this review: **we do not use test set answers as part of our stopping rule.**\n\nThe stopping rule is only _calibrated_ using labeled examples, so that it provably generalizes to achieve risk control over future samples with high probability (again, without access to test labels). At test time we only use test labels to evaluate how well our predictions perform. Indeed, the \"oracle\" with 100% coverage reduces to sampling N times with knowledge of the ground truth set, and picking the first answer that is part of it. Of course this is not realistic, and only serves as a point of comparison (i.e., we measure how many \"excess\" samples our methods take as compared to this oracle).\n\nWe now provide answers to specific questions and remarks (quoted) below.\n\n> It's not quite clear what the objective is (minimize loss, minimize excess numbers of samples).\n\n$\\hat{\\lambda}$ must provide valid risk control for $C_\\lambda$ (so $\\hat{\\lambda} \\in \\Lambda_{\\mathrm{valid}}$), but should also be a configuration that is useful empirically. Per our validity constraint, the upper bound of our loss is fixed. We are then left with a multi-objective problem where we want to simultaneously minimize set size (number of responses), and the wasted computational effort it takes to generate the set (excess number of samples). We reduced this to a single weighted objective (Eq. 7), with empirically chosen weights. As also indicated to reviewer Sb79, any choice of $\\lambda \\in \\Lambda_\\mathrm{valid}$ can also be used without sacrificing our risk control guarantees.\n\n> For the 3-step procedure described in section 4, is it possible this will never terminate?\n\nThis is a good question. Simply put, for finite $k_{\\mathrm{max}}$, this algorithm will obviously always terminate in finite samples. If $k_{\\mathrm{max}}$ is not finite (no sampling upper bound is specified), then with additional assumptions on the underlying LLM and stopping rule (e.g., that the LLM places non-zero probability mass on at least one acceptable answer, which is true for most softmax-based models), we may also show that the algorithm almost surely terminates. However, setting $k_{\\mathrm{max}} < \\infty$ is more straightforward, and practical.\n\n> Finally there's the evergreen concern that this approach might become less important at scale.\n\nWe agree with the reviewer that risks on an absolute level will tend to become smaller at larger model scales.  That said, performance will always be a combination of the base model being used, the hardness of the task at hand, and the desired controlled risk level. This is why it is an important feature that our algorithm is general in nature, and can apply to any model that follows the specified API (i.e., supports sampling). This supports  independent research in improving the underlying LM, in addition to the scoring functions used, while keeping the pipeline the same. In fact, it is great if the underlying LM is better: this will increase the range of achievable risks, and will decrease both the average size of the prediction set, and the number of samples required to generate to derive it."
                    }
                },
                "number": 5,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission3911/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700538604668,
                "cdate": 1700538604668,
                "tmdate": 1700538604668,
                "mdate": 1700538604668,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "Hn2Xawo4d6",
                "forum": "pzUhfQ74c5",
                "replyto": "SkqVztrsrn",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission3911/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission3911/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Discussion"
                    },
                    "comment": {
                        "value": "As the discussion deadline is approaching, we would like to know if we have addressed your comments, or if there is anything else we can help to clarify. Thank you again for taking the time to review our work."
                    }
                },
                "number": 8,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission3911/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700691336510,
                "cdate": 1700691336510,
                "tmdate": 1700691336510,
                "mdate": 1700691336510,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "ULbOAyfma7",
                "forum": "pzUhfQ74c5",
                "replyto": "Hn2Xawo4d6",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission3911/Reviewer_zQVz"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission3911/Reviewer_zQVz"
                ],
                "content": {
                    "title": {
                        "value": "thanks! keeping my score"
                    },
                    "comment": {
                        "value": "thanks for the detailed response! I'd like to keep my score - I feel like to this reviewer, it's still not quite clear what problem this is solving or how much the approach proposed would outperform simpler baselines."
                    }
                },
                "number": 10,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission3911/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700722980120,
                "cdate": 1700722980120,
                "tmdate": 1700722980120,
                "mdate": 1700722980120,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "taapsELmKl",
            "forum": "pzUhfQ74c5",
            "replyto": "pzUhfQ74c5",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission3911/Reviewer_Sb79"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission3911/Reviewer_Sb79"
            ],
            "content": {
                "summary": {
                    "value": "This paper extends the conformal prediction framework to language models (LMs). The aim is to construct prediction sets of LM responses such that at least one is \"acceptable\" with a desired probability.\n\nThis goal is achieved by sampling responses repeatedly from the LM and adding them to the prediction set until a stopping rule occurs: either (i) an upper bound $k_{\\max}$ on the number of samples drawn from the LM, or (ii) a lower bound $\\lambda_{3}$ on the prediction set confidence score, quantifying how good it is. Additionally, samples are removed from the prediction set (to reduce noise) based on a rejection rule: either (i) a lower bound $\\lambda_{2}$ on the individual response's quality, or (ii) an upper bound $\\lambda_{1}$ on the response's similarity with others in the set. $\\lambda = (\\lambda_{1}, \\lambda_{2}, \\lambda_{3})$ is a configuration that is picked via the Learn Then Test [Angelopoulos et al. 2021a] framework; $k_{\\max}$ is fixed by the user. Note that not all desired errors are achievable. The paper also proposes an extension to identify individual components of the responses (for instance, sentences from paragraphs) that are each independently \"acceptable\" with desired probability.\n\nThe paper goes on to provide empirical results to corroborate its methodology. Experiments on open-domain question-answering, text summarization, and radiology report generation empirically verify the proposed algorithm and its statistical guarantees."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "2 fair"
                },
                "contribution": {
                    "value": "3 good"
                },
                "strengths": {
                    "value": "1. This paper tackles an important research area of providing statistical guarantees on the output of language models.\n2. These statistical guarantees are provided by leveraging the conformal prediction framework and extending it to language models, which is a generative task.\n3. The proposed algorithm is easy to interpret: sample responses from the language model as long as the rejection and the stopping rules are not triggered.\n4. The theoretical results are corroborated experimentally on 3 tasks."
                },
                "weaknesses": {
                    "value": "[Details in the Questions section]\n\n1. The proposed algorithm is easy to interpret. However, the paper does not explain all design choices.\n2. The experimental results support Theorem 4.2. However, Proposition 4.4 is not experimentally validated.\n3. Theorem 4.2 guarantees at least one \"acceptable\" language model response in the prediction set but does not say much about the individual responses. While the paper considers components of the responses, the response as a whole is not."
                },
                "questions": {
                    "value": "1. Design choices:\n    1. Why is $\\hat{\\lambda}$ defined as in Eq. 7? Similarly, why is it desirable for $C^{\\text{inner}}_{\\gamma}$ to be large ($\\hat{\\gamma}$ in Eq. 10)? Explicitly explaining these would help the reader. Are there alternative definitions that might be advantageous?\n    2. What is the reason for using a different definition of $C^{\\text{inner}}_{\\gamma}$ during calibration?\n    3. The Pareto Testing procedure is used in the proposed algorithm for efficiency. However, the appendix only provides a high-level overview. Can the authors include more details and explain how this procedure helps efficiency?\n\n2. Experiments:\n    1. The achievable risk range for MIMIC-CXR is very high. How can one reduce this for the practicality of the proposed method?\n    2. How is the AUC for the set loss plots greater than 0.5? The diagonal should have an AUC of 0.5, and since all the curves are under this, their respective AUCs should be lower than 0.5.\n    3. The First-$k$ scoring function does not utilize rejection. As a result, the likelihood-based approaches have better prediction efficiency. Did the authors try First-$k$ with the rejection scheme for a more apples-to-apples comparison?\n    4. What about the set loss in the individual component case? Experimental results on that would corroborate the theoretical result in Proposition 4.4.\n    5. What is $k_{\\max}$ set to for the experiments?\n    6. The data splits to obtain the train, calibration, and test sets aren't well explained in the paper (appendix included). For example, the authors use a dev set for the conformal prediction experiments, but in what way? Can the data splits be explained more succinctly for the datasets used?\n\n3. \"While Eq. 1 stipulates the existence of at least one \"acceptable\" generation in $C_{\\lambda} (X_{\\text{test}})$, it does not tell us much about individual responses, $y \\in C_{\\lambda} (X_{\\text{test}})$\" (Section 1). Is there any remedy for this? This paper discusses individual components (for example, sentences) but not the whole LM responses.\n\nClarifications:\n\n1. It would be helpful for the reader to highlight why admission functions $A_{i}$ are used rather than labels $Y_{i}$ in Section 1 (where the setup is explained).\n2. Shouldn't the function $A^{c}$ be a mapping $\\mathcal{Y} \\mapsto \\\\{0, 1\\\\}$ instead of $2^{\\mathcal{Y}} \\mapsto \\\\{0, 1\\\\}$ (Section 4.4) as it acts on individual components?\n3. $\\mathcal{Y}$ and $\\mathcal{V}^{*}$ are used interchangeably. Making it consistent would help the reader.\n4. It would be helpful for the reader to add more descriptive captions for the tables in Appendix H. For example, the authors can highlight what the findings are not just in the text but in the table captions as well.\n5. Should Eq. 20 be replaced with Eq. 7?\n6. Missing definitions:\n    1. $\\mathcal{Y}$ is not defined in Section 1 but is used right before Eq. 1.\n    2. $L_{\\text{test}} (\\lambda)$ is not defined but is used right before Eq. 3.\n    3. $F_{X} (u), F_{Y} (y)$ are not defined in Appendix D.1.\n7. Missing superscripts:\n    1. The superscript $c$ in $A^{c}_{\\text{test}}$ is missing in the text before and after Eq. 9.\n    2. The superscript $c$ in $\\bar{L}^{c} (\\gamma)$ is missing in the text after Eq. 22."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "6: marginally above the acceptance threshold"
                },
                "confidence": {
                    "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 4,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission3911/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1699626802841,
            "cdate": 1699626802841,
            "tmdate": 1699636350932,
            "mdate": 1699636350932,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "RrSyomEoUM",
                "forum": "pzUhfQ74c5",
                "replyto": "taapsELmKl",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission3911/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission3911/Authors"
                ],
                "content": {
                    "comment": {
                        "value": "We thank the reviewer for their careful review and thoughtful comments. We provide answers to specific questions and remarks (quoted) below.\n\n> The paper does not explain all design choices.\n\nThank you for highlighting where our design choices were not well explained. We have improved the clarity of our paper with respect to these questions (as detailed below). \n\n> Proposition 4.4 is not experimentally validated.\n\nWe initially left this out for sake of space; we have now added a plot demonstrating empirical validity---see Figure G.1. \n\n> Theorem 4.2 guarantees at least one \"acceptable\" language model response in the prediction set but does not say much about the individual responses.\n\nThis is consistent with the style of guarantees that standard conformal inference / confidence intervals give. It is also good to keep in mind that relative rankings/confidence scores of responses in the prediction set (e.g., by using our \"\\mathcal{Q}\" individual response quality function) can still be computed, though we just don't have formal _guarantees_ on their individual correctness (again, the statements in Theorem 4.2 only apply to the set as a whole). Notably (and different from standard conformal prediction due to the structure of the problem we are dealing with), our component-level prediction does provide _guarantees_ about sub-predictions relevant to individual responses, that hold simultaneously across all responses in the set.\n\n> Why is $\\hat{\\lambda}$ defined as in Eq. 7? Similarly, why is it desirable for $C_{\\gamma}^{\\mathrm{inner}}$ to be large?\n\n$\\hat{\\lambda}$ is selected to provide valid risk control for $C_\\lambda$ (so $\\hat{\\lambda} \\in \\Lambda_{\\mathrm{valid}}$), while also being the configuration that is most useful empirically. That means, we want $C_\\lambda$ to be precise (contain as few items as is necessary), and we want $C_\\lambda$ to be quick to evaluate (not require sampling many responses before the stopping criterion is met). The combined objective we specify for $\\hat{\\lambda}$ therefore reflects a tradeoff between these two qualities. **We have clarified this in the paper.**\n\nMeanwhile, $C_\\gamma^{\\mathrm{inner}}$ identifies the set of subcomponents that our model is very confident in, while controlling for false positives. Ideally, this would contain _all_ correct subcomponents (i.e., we have 100% recall of correct subcomponents). Simply making $C_\\gamma^{\\mathrm{inner}}$ as large as possible, while subject to our constraint, helps achieve maximum recall. **We have also clarified this in the paper.**\n\n> What is the reason for using a different definition of $C_\\gamma^{\\mathrm{inner}}$ during calibration?\n\nThis decouples set construction from component selection, and makes experimentation/deployment easier (i.e., we don't need to redo component calibration for every different $epsilon$). In practice, we can do either one. **We have clarified this in the paper.**\n\n> The Pareto Testing procedure is used in the proposed algorithm for efficiency. However, the appendix only provides a high-level overview.\n\nWe have added a detailed description of Pareto testing to Appendix E.\n\n> The achievable risk range for MIMIC-CXR is very high. How can one reduce this for the practicality of the proposed method?\n\nThis can be reduced by either increasing $k_{\\mathrm{max}}$ (which allows for more sampling effort), or by improving the underlying language model. Our calibration method applies to any base model or $k_{\\mathrm{max}}$.\n\n> How is the AUC for the set loss plots greater than 0.5? \n \nThanks for raising this question; we realize that we did not fully explain how we compute the AUC in the paper. Specifically, we compute a _normalized_ AUC as $\\frac{1}{b - a}\\int_{a}^{b} f(x) dx$, where the limits $a$ and $b$ are set to the minimum achievable epsilon and to the trivial epsilon (the risk of the top-1 prediction), respectively. This normalized AUC can be greater than 0.5. **We have clarified this, and have included the values for the diagonal in the plots.**\n\n> The First-$k$ scoring function does not utilize rejection.\n\nThanks for the suggestion\u2014we added a variant with rejection. Please refer to our [general response](https://openreview.net/forum?id=pzUhfQ74c5&noteId=FNXkWfpKC5).\n\n> What is $k_{\\mathrm{max}}$ set to in the experiments?\n\nIt is set to 20 (Appendix C). We have moved this to the main text.\n\n> The data splits to obtain the train, calibration, and test sets aren't well explained in the paper. \n\nWe have clarified these details in Appendix F.4.\n\nAdditional:\n\n- We have switched to using $\\mathcal{Y}$ throughout the paper now for simplicity. We still discuss the structure of $\\mathcal{Y}$ in Section 4.1.\n- Thank you for catching the typo for $A^c$! We have corrected it.\n- We have added more descriptive captions to the tables in Appendix H. \n- Thank you for catching the typo in Eq. 20! We have updated it to be consistent with Eq. 7.\n- We have fixed the missing definitions and subscripts."
                    }
                },
                "number": 4,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission3911/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700538512737,
                "cdate": 1700538512737,
                "tmdate": 1700538512737,
                "mdate": 1700538512737,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    }
]