[
    {
        "title": "Grokking as the transition from lazy to rich training dynamics"
    },
    {
        "review": {
            "id": "MPCUdavqUy",
            "forum": "vt5mnLVIVo",
            "replyto": "vt5mnLVIVo",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission6180/Reviewer_8XT2"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission6180/Reviewer_8XT2"
            ],
            "content": {
                "summary": {
                    "value": "The paper studies the grokking phenomenon and argues that the drop in test loss (after the drop in train loss) coincides with the network transitioning from the lazy to the rich regime. Grokking would then happen when the NTK at initialization is ill-aligned with the task, leading to a large test error in the lazy regime, however after the transition to the rich regime, the `right' features are learned.\n\nThey study a simple model of shallow nets that can fit linear and quadratic function, with a hyper-parameter that allows one to tune how much stronger the alignement of the initial NTK with the linear modes than quadratic ones. For a quadratic true function, one can ensure a bad alignement between the NTK and task, thus leading to grokking.\n\nFinally this theory is tested on more practical examples (MNIST with a MLP and arithmetic with a transformer architecture)."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "4 excellent"
                },
                "contribution": {
                    "value": "3 good"
                },
                "strengths": {
                    "value": "There has been a lot of work studying grokking in different settings, but we are still lacking a complete understanding of under which condition it appears (model, training method, task). I think that the lazy/rich transition is the right idea to understand grokking.\n\nUnder this interpretation, we expect grokking to appear in tasks that are adapted to the rich regime but not the lazy regime. Furthermore, we need models that exhibit both rich and lazy regimes, and finally we need a training method where the model switches from lazy to rich regime in the middle of training.\n\nThe authors identify a simple theoretical model that exhibits grokking, and its simplicity allow for some theoretical results. The numerical experiments suggest that their interpretation applies to more realistic setups."
                },
                "weaknesses": {
                    "value": "The theoretical and experimental evidence given in the paper is not particularly strong: in spite of the simplicity of the model considered, the theoretical results are very limited (just a decomposition of the loss into three terms with relevant interpretations); conversely most empricial results are done on this simple model, with just three experiments done on more complex data."
                },
                "questions": {
                    "value": "You argue in a few different places that grokking when the NTK is ill-aligned to the task, but it feels to me that another condition is that the task needs to be well adapted to the rich regime (which I understand is much harder to characterize). There are tasks where neither the lazy nor the rich regime generalize, in which case one expects no grokking.\n\nIn section 6.1 you select a true function that is explicitely ill-aligned with the initial NTK to induce a grokking phenomenon, but the grokking phenomenon disappears when using too small eigenvalues. You argue that this is because there is not enough data, did you test this hypothesis? Could it also be the case because the eigenfunctions corresponding to small eigenvalues are hard to learn regardless of the regime (as I propose above)?"
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "8: accept, good paper"
                },
                "confidence": {
                    "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 1,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission6180/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1697563188648,
            "cdate": 1697563188648,
            "tmdate": 1699636671852,
            "mdate": 1699636671852,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "PY2ebugFiE",
                "forum": "vt5mnLVIVo",
                "replyto": "MPCUdavqUy",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6180/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6180/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Response"
                    },
                    "comment": {
                        "value": "We thank their reviewer for their comments and suggestions to improve the theoretical components of the paper. Below we discuss their questions and weaknesses and describe what we did to improve it.\n\n**Limited Theoretical Component to the Work**\n\nAsking for more theory was common amongst the reviewers, so, as outlined in the global response, we have included theory we had not included in the initial submission. Specifically, we derive limiting dynamics for quantities that determine the train and test losses when two layer networks are trained on high dimensional data. We show that the derived theory is accurate in Figures 4 and 13 and use it to derive approximate test loss and train loss gaps as functions of training time. Because these results are now so much stronger than the loss decomposition, we moved that to the Appendix. \n\n**Can Grokking Happen if Rich Regime Can't Generalize?**\n\nYou are right that since grokking is roughly \"delayed generalization,\" the network must be able to generalize in the first place from this sized training set. You make a good point here that some tasks may not even be soluble by a given network architecture in the rich regime no matter how much data you give it, because, for instance, the network architecture may not be expressive enough or have a high enough model capacity. To be clear, you are right that we assume the network is capable of generalizing on the task to begin with to be able to see grokking. \n\n**NTK Alignment and Data Quantity**\n\nThis is an excellent question; we have added a new Section 17 to the Appendix to test this explicitly. We show that indeed even for task labels set to small eigenvectors, large amounts of data suffices to learn them and generalize. However, if you let the task become a *function of the dataset size* by defining the labels to be the smallest eigenvector of the empirical kernel matrix (in eigenvalue), then the task gets commensurately harder as you increase dataset size, and so even feature learning cannot allow this architecture to learn the task. This corresponds to going down the columns of our new Figure 21 and seeing that if we set $j = P$ then no amount of data will allow this architecture to generalize perfectly, giving no grokking."
                    }
                },
                "number": 9,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6180/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700106120472,
                "cdate": 1700106120472,
                "tmdate": 1700106120472,
                "mdate": 1700106120472,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "Lmf3YK1LWi",
            "forum": "vt5mnLVIVo",
            "replyto": "vt5mnLVIVo",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission6180/Reviewer_sTxd"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission6180/Reviewer_sTxd"
            ],
            "content": {
                "summary": {
                    "value": "This work hypothesizes that grokking may happen as a transition from lazy to feature learning regime. It also shows that grokking is not inherently associated with an increasing norm and the use of weight decay -- which advances our understanding."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "3 good"
                },
                "strengths": {
                    "value": "I think the paper is clean and the point being made is sufficiently important. Also, I find the experiments sufficiently convincing. \n\nCrucially, it advances our understanding of the grokking phenomenon. The shortness of the review only reflects the fact that I do not much much criticism for this work."
                },
                "weaknesses": {
                    "value": "Nothing major."
                },
                "questions": {
                    "value": "One point I think worth being clarified is the role of weight decay. I think we have a pretty good understanding of how weight decay changes the kernel. Essentially, weight decay almost always changes the NTK at the speed of $\\kappa$, which is the strength of weight decay. The time scale for the effect of weight decay to take place is nothing but $1/\\kappa$. Therefore, if $1/\\kappa$ is far larger than the time scale of lazy training, one has a separation of time scale, where lazy training happens first, and feature learning induced by weight decay happens later. I think the authors should make more discussion on this point as it constructively adds to the paper."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "8: accept, good paper"
                },
                "confidence": {
                    "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 2,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission6180/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698036193674,
            "cdate": 1698036193674,
            "tmdate": 1699636671728,
            "mdate": 1699636671728,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "kfz5ONa0Hw",
                "forum": "vt5mnLVIVo",
                "replyto": "Lmf3YK1LWi",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6180/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6180/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Response"
                    },
                    "comment": {
                        "value": "We thank the reviewer for their supportive comments and careful reading. Below we attempt to address their question about weight decay.\n\n**Role of Weight Decay**\n\nYou are absolutely right. As you point out, papers like (Lewkowycz et al, 2020) show that the NTK evolves linearly as a function of weight decay. In response to your review, we have reworked Section 14 of the Appendix to explicitly discuss the role of weight decay, finding that past observations (such as those by Nanda et al, 2023, and Liu et al, 2022b) that empirically find weight decay has an approximately linear relationship with time to generalize (grok), our theory of grokking as a transition from lazy to rich dynamics predicts this exactly because, as you point out, the NTK evolves at $O(\\kappa)$, so that the network is forced to leave the lazy (static NTK) regime at $t \\sim O(\\kappa)$ as well, which is what has been observed in past papers like Liu et al 2022b, but without explanation. Section 14 also illustrates how the laziness parameter $\\alpha$ can supplant and replace weight decay in this way: making a network richer by decreasing $\\alpha$ can serve the same effect as forcing NTK evolution (feature learning) by increasing weight decay, $\\kappa$, and we showcase an example of that trade-off in Figure 14."
                    }
                },
                "number": 8,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6180/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700105879199,
                "cdate": 1700105879199,
                "tmdate": 1700105925865,
                "mdate": 1700105925865,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "xvaYFfbVZJ",
            "forum": "vt5mnLVIVo",
            "replyto": "vt5mnLVIVo",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission6180/Reviewer_y5Qp"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission6180/Reviewer_y5Qp"
            ],
            "content": {
                "summary": {
                    "value": "The paper proposes that the \"grokking\" phenomenon\u2014where a neural network's test loss decreases significantly after the training loss\u2014is due to a shift from initial \"lazy\" training to subsequent \"rich\" feature learning. Through a polynomial regression study with a two-layer network, the authors show that grokking occurs when the network moves from fitting data with its initial features to learning new features for better generalization. They suggest that the rate of feature learning and the initial feature alignment are key to this delayed generalization, a concept potentially applicable to more complex neural networks."
                },
                "soundness": {
                    "value": "2 fair"
                },
                "presentation": {
                    "value": "2 fair"
                },
                "contribution": {
                    "value": "2 fair"
                },
                "strengths": {
                    "value": "This paper studies the grokking phenomenon in deep learning, which is a recent hot topic and very relevant to ICLR. This paper proposes that grokking can be triggered by the transition from kernel regime to feature learning regime. Though this is already known even before the grokking paper by Power et al, 2022, e.g., the example of quadratically overparametrized linear model in Section 6 of Li et al., 2021, the novelty here is that this paper focuses on vanilla GD. In contrast, the transition between kernel and feature learning regime, Li et al., 2021, is triggered by sharpness minimization implicit bias of label noise SGD, which makes the analysis significantly easier.  This paper also performed some new experiments on various tasks to support this theoretical intuition.\n\n*Reference:*\n\nLi, Zhiyuan, Tianhao Wang, and Sanjeev Arora. \"What Happens after SGD Reaches Zero Loss?--A Mathematical Framework.\" arXiv preprint arXiv:2110.06914 (2021)."
                },
                "weaknesses": {
                    "value": "1. The definition of grokking seems to be very different than that in literatue. In Power et al., 2022, **Groking** refers to the phenomena that \"long after severely overfitting, validation accuracy sometimes suddenly begins to increase from chance level toward perfect generalization\". While this paper describes grokking in their introduction as \"train loss of a neural network decreases much earlier than its test loss\". \n\n\tIt is ok to me that this paper only focuses on the regression setting and talks about MSE loss. But the original grokking phenomenon is much more \"suprising\" and rare in the sense that it requires the test loss/error to get higher than random guess only after reaching almost zero training loss/error. Moreover, the original definition of grokking requires almost perfect generalization in the end of training.\n\n2. The theoretical explanation presented in this paper only works for the new definition of grokking, but not the original definition of grokking in Power et al., 21. For the most experiments in this paper where the authors claim grokking happens, two criterions of original definition of grokking are not met: 1. when test loss starts to decrease before training loss gets small; 2. the eventual test loss is still high. Figure 5(b) is an example.\n\n3. There is no end-to-end theorem about grokking. Given the modified definition of grokking, explanation using transition from kernel regime to feature learning regime seems quite straight forward. It should be very standard to show that there exists a period of time where training loss can decrease but test loss has a lower bound due to live in the kernel regime. Still this paper lacks such precise and rigorous statement.\n\n4. I find it difficult to understand the math derivation for the toy model in section 11. In the paragraph above section 11.2, the authors write that kernel method can learn $|x|^2$ at D sample sizes and the full target function at $D^2$ sample sizes. How is this gap in sample complexity related to the sepration of timescale in a single run?\n\n5. The first paragraph of Introduction does not sound correct. For example, the authors write that \"Typically, one assumes that a model\u2019s performance on its training set will be a reliable indicator of its generalization capabilities on unseen data\". This is in general not true, especially in deep learning where models are often overparametrized. And it is exactly because training loss and test loss can have a large gap in practice, people are studying generalization in machine learning. Also it is not clear to me that why using models which groks in training will cause any safety issue. I would like the authors to elaborate on this or at least provide an example. Intuitively, grokking as a training behavior has nothing to do with the performance of the model when used for inference.\n\n6. As mentioned in the strengths, the explanation of grokking using transition from kernel to feature learning regime (Li et al., 2021) is known even before the original grokking paper (Power et al., 2022). Though this paper is novel in the sense that it focuses on vanilla GD, which is more natural than Li et al., 2021, the theoretical result in this paper is also not as clean as that in Li et al., 2021.\n\n*Reference:*\n\nLi, Zhiyuan, Tianhao Wang, and Sanjeev Arora. \"What Happens after SGD Reaches Zero Loss?--A Mathematical Framework.\" arXiv preprint arXiv:2110.06914 (2021)."
                },
                "questions": {
                    "value": "See weakness"
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "3: reject, not good enough"
                },
                "confidence": {
                    "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 3,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission6180/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1699160761996,
            "cdate": 1699160761996,
            "tmdate": 1699636671625,
            "mdate": 1699636671625,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "BpA72UVng5",
                "forum": "vt5mnLVIVo",
                "replyto": "xvaYFfbVZJ",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6180/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6180/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Response Part 1"
                    },
                    "comment": {
                        "value": "We thank the reviewer very much for their detailed review. Before we address the questions posed in the weaknesses section, we wanted to address some comments in the \"Strengths\" to make sure we are on the same page about the grokking literature and how this paper situates itself therein. \n\n\n*Strengths:\n...This paper proposes that grokking can be triggered by the transition from kernel regime to feature learning regime. Though this is already known even before the grokking paper by Power et al, 2022, e.g., the example of quadratically overparametrized linear model in Section 6 of Li et al., 2021, the novelty here is that this paper focuses on vanilla GD. In contrast, the transition between kernel and feature learning regime, Li et al., 2021, is triggered by sharpness minimization implicit bias of label noise SGD...*\n\nFirst, you are correct that the main proposition here is that grokking can be seen as the transition from a kernel to feature learning regime. And to be clear, we are not claiming to be the first to show a network can transition from a lazy to rich training regime. Our novel contribution is to use this transition as a possible explanation of the grokking phenomenon, which to our knowledge has not been done before.\n\n   \n1. First, we thank you for bringing the paper by Li et al (2021) to our attention; we have cited it as it is relevant. However, it is a paper about the implicit biases of SGD around local minima, and how SGD can trigger a transition from lazy to rich training dynamics. However, SGD is *neither necessary nor sufficient to see grokking*, so no complete theory of grokking can be one entirely about SGD dynamics.\n2. None of the existing papers on grokking mention the notion of NTK or lazy and rich training paradigms (including [(Liu et al, 2022a), (Nanda et al, 2023), (Liu et al, 2022b), (Davies et al, 2023), (Thilak et al, 2022)]). It is true that many papers remark something along the lines of \"feature learning is somehow important\" and \"there is something resembling a phase transition happening\" but the key contribution of this paper is *precisely in formalizing that claim in a way that allows us to demonstrably control and manipulate grokking in a way nobody has been able to do before.* \n3. Many of the current popular theories of grokking claim that it is fundamentally due to weight decay [(Nanda et al, 2023), (Varma et al, 2023)] or weight norm [(Liu et al, 2022b)] or adaptive optimizers [(Thilak et al, 2022)], or any number of other things *that are directly inconsistent with the fact that grokking arises when a network moves out of the NTK regime* (as we discuss more in Section 2 and Section 10 of our paper). We think our paper can help illustrate how mechanically lazy/rich training regimes can alter the grokking curve."
                    }
                },
                "number": 5,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6180/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700105582687,
                "cdate": 1700105582687,
                "tmdate": 1700105582687,
                "mdate": 1700105582687,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "M0RS0bNZnA",
                "forum": "vt5mnLVIVo",
                "replyto": "xvaYFfbVZJ",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6180/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6180/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Response Part 2"
                    },
                    "comment": {
                        "value": "**Difference Between Accuracy and Loss Curves**\n\nThe difference between accuracy and loss curves is important to clarify, so thank you for asking this. \n\nFirst, we added a two-page Section 17 to the Appendix explicitly addressing the questions here, including four new experiments to support our claim that loss is the right primitive to study. But we begin by first addressing your main concern that accuracy based curves in (Power et al, 2022) are more surprising than the loss curves we study in this paper because of the two criteria you give: *(Power et al, 2022) give the loss curves corresponding to their striking accuracy curves (Fig 1) in the appendix of their paper, as Figure 4. They look like the loss curves we study in our paper here*! The loss in our main toy model of study (Fig 1, Fig 3, Fig 11, Fig 12) looks exactly the same, and even in other experiments we do with more complicated data (Fig 6b, for instance), our curves also look like that. As far as your citation of Fig (5b) is concerned, we created a new Appendix Section 17 to show how curves that reach nonzero (but low) end-time loss give rise to accuracy curves that exhibit striking grokking. Note also that (Gromov, 2023) finds grokking in a modular arithmetic task with curves that look very much like (5b) as well. \n\nIn the new Appendix Section 17, we reproduce grokking on a modular arithmetic task (the task in Power et al, 2022) and show the striking accuracy curves we associate with grokking in Figure 20 and note the following facts\n* The test loss is decreasing before train loss is zero \n* The test loss saturates to a nonzero value at late time while the test accuracy reaches $100\\%$. \n\nThis shows that the types of loss curves we document in our experiments are actually *the same kind of loss curves* as those in original grokking experiments. \n\nWe thus disagree with the claim that the original accuracy-based result from Power et al. is stronger (more surprising) than the corresponding loss curves that we treat here, and in fact they are equivalent. As we expect, our conclusions about grokking in loss naturally carry over to grokking in accuracy (but not vice versa). This is why when we intervene on classification-first tasks like modular arithmetic (Fig 2, Fig 6b) and MNIST image classification (Fig 6a), we see our interventions control grokking *exactly as we predicted*. If our definition (reasoning about loss) was a weaker one, we would not see this in classification tasks, where accuracy is plotted. \n\nWe end by noting that we are not the first to make this observation. Indeed, the fact that loss, not accuracy, is the interesting thing to study was quickly realized after the initial paper discovering grokking was published! It is noted when (Davies et al, 2023) study loss in their Figure 5b, when (Liu et al, 2022b) characterize the *loss* landscapes of various tasks that exhibit grokking, when (Nanda et al, 2023) plots excluded and restricted loss as progress measures in and remarks that accuracy can be gamed, and strikingly in the recent (Schaeffer et al, 2023) that shows how accuracy and other metrics that are not optimized by the network can be very misleading to plot and easily gamed. Thus our choice to do so in this paper is consistent with past literature on grokking. We refer you to Appendix Section 17 created specifically to clarify this perceptive question you raise. \n\n \n**End-to-End Theory of Grokking**\n\nWhile the original paper did not attempt to provide an end-to-end theoretical description of the grokking dynamics, we now include a dynamical mean field theory (see the new Section 5.3 and Appendix 13) for networks trained on high dimensional data. In particular, we can write down simple expressions for the gap between test and train losses as functions of time (see equation 10) which states the test train loss gap at large $\\gamma$\n\n$$\\mathcal L_{test} - \\mathcal L_{train} \\sim \\frac{2\\alpha}{N \\gamma} \\sum_{ij=1}^N \\int_0^t ds R^w_{ij}(t,s) C_{ij}^g(t,s) + \\mathcal{O}(\\gamma^{-2})$$\nwhere $R^w$ and $C^g$ are certain functions which can be computed from our theory. The test and train loss dynamics at large width in the lazy regime should emerge as a special case of this more general theory. \n\n**First Paragraph of Introduction Sounds Slightly Wrong**\n\nYou make good points. We have clarified what we meant and rephrased the introductory paragraph. We now elaborate on the points we makes to set up the background motivation for the paper, notably with gentler language than before."
                    }
                },
                "number": 6,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6180/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700105738201,
                "cdate": 1700105738201,
                "tmdate": 1700330124870,
                "mdate": 1700330124870,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "1sUX4PpVm2",
                "forum": "vt5mnLVIVo",
                "replyto": "W8T0n5ZL6s",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6180/Reviewer_y5Qp"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6180/Reviewer_y5Qp"
                ],
                "content": {
                    "comment": {
                        "value": "Thank you for your response! I appreciate the comparison to Li et al. Since the authors have revised the paper substantially, it would be helpful if the authors could mark the major edits in a different color.\n\nI am not very familiar with DMFT and haven't had time to read the added theoretical analysis carefully. I will need to discuss this with other reviewers to better assess the contribution of the new theoretical results.  Here is a quick question I have on the new theoretical result, to me any theory showing grokking needs to prove there exists two timesteps $t_1< t_2$, where \n\n1. the training loss/error is almost 0 at time $t_1$ while the test loss/error is high (larger than some constant) at time $t_1$;\n2. both train and test loss/error is almost 0 at time $t_2$.\n\nHowever, I cannot find such statements in the DMFT section. Can the authors elaborate on this?"
                    }
                },
                "number": 15,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6180/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700686354405,
                "cdate": 1700686354405,
                "tmdate": 1700686354405,
                "mdate": 1700686354405,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "IUdtoIr4Dv",
            "forum": "vt5mnLVIVo",
            "replyto": "vt5mnLVIVo",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission6180/Reviewer_Hhk6"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission6180/Reviewer_Hhk6"
            ],
            "content": {
                "summary": {
                    "value": "In this submission, the authors proposed a simple regression model that exhibits the grokking phenomenon, that is, good generalization is achieved long after the decay of training error. The studied model is a polynomial regression problem, where the teacher model is a quadratic single-index model, and the student model is a neural network with degree-2 activation function. It is predicted that under suitable training set size and initialization scale, grokking occurs in the intermediate phase between the NTK regime and the feature learning regime."
                },
                "soundness": {
                    "value": "2 fair"
                },
                "presentation": {
                    "value": "2 fair"
                },
                "contribution": {
                    "value": "2 fair"
                },
                "strengths": {
                    "value": "The proposed toy model is interesting and relevant to the ICLR community. Most existing works on grokking considered modular arithmetic tasks, or measured the classification error rather than the surrogate loss used in training. In contrast, the authors studied the regression setting where grokking is manifested in the $L_2$ error, and the training procedure does not involve $\\ell_2$ regularization. Also, the connection between grokking and the transition from lazy to rich regime is to my knowledge novel, and it opens up new directions for theory research to rigorously characterize such phenomenon."
                },
                "weaknesses": {
                    "value": "I have the following concerns. \n\n1. Given the idealized setting (Gaussian data with identity covariance, single-index target), it is rather underwhelming that the authors did not provide any quantitative characterization of the training dynamics to prove the existence of grokking. Instead, the proposed explanation is only verified empirically, which limits the contribution. Can the authors comment on the technical challenges in analyzing the gradient flow trajectory for this quadratic model? \n\n2. Connection to prior results needs to be further elaborated. \n\n* (Nichani et al. 2022) also studied the transition from the NTK to the feature learning regime, and established improved sample complexity for learning low-degree + sparse high-degree polynomials. For the current model, does the sparsity of the higher-order term (that is, whether the quadratic component of the target function span more than one direction) play a role in the presence of grokking?   \n(Nichani et al. 2022) *Identifying good directions to escape the NTK regime and efficiently learn low-degree plus sparse polynomials.* \n\n* The target function is a single-index model with information exponent 2 (Ben Arous et al. 2021). It is known that for such target function, gradient descent on the population loss will start from an approximate saddle due to the random initialization. Is this observation related to the test loss plateau in grokking? And do we expect similar findings when the information exponent is larger than 2?   \n(Ben Arous et al. 2021) *Online stochastic gradient descent on non-convex losses from high-dimensional inference.* \n\n* The quantity describing the difficulty of target function $y^\\top K^{-1} y$ has been extensively studied in the kernel literature. See (Arora et al. 2019) for the analysis of NTK.  \n(Arora et al. 2019) *Fine-grained analysis of optimization and generalization for overparameterized two-Layer neural networks.* \n\n* (minor) The cited references on the quadratic sample complexity lower bound for kernel estimators such as (Ghorbani et al. 2019) do not rigorously cover the case of Gaussian data."
                },
                "questions": {
                    "value": "See Weaknesses above."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "5: marginally below the acceptance threshold"
                },
                "confidence": {
                    "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 4,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission6180/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1699352916619,
            "cdate": 1699352916619,
            "tmdate": 1699636671518,
            "mdate": 1699636671518,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "Ke6ZAUneHt",
                "forum": "vt5mnLVIVo",
                "replyto": "IUdtoIr4Dv",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6180/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6180/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Response Part 1"
                    },
                    "comment": {
                        "value": "We thank the reviewer for their indepth reading and their useful suggestions. We took their suggestion to provide a more predictive theoretical description seriously and added a whole section dedicated to this. We also investigated multi-index and higher degree hermite polynomial target funtions.\n\nBelow we respond to each of the weaknesses.\n\nWeaknesses:\n\n1. *Given the idealized setting (Gaussian data with identity covariance, single-index target), it is rather underwhelming that the authors did not provide any quantitative characterization of the training dynamics to prove the existence of grokking. Instead, the proposed explanation is only verified empirically, which limits the contribution. Can the authors comment on the technical challenges in analyzing the gradient flow trajectory for this quadratic model?*\n\nWe had begun deriving the dynamics of the test risk such a model, but did not include it in the initial submission because solving the resulting equations numerically was challenging. However, the reviewer's questions about theory have prompted us to complete and include this theoretical work that can potentially shed light on where grokking comes from in terms of data and richness. We believe this substantially strengthens the submission. \n\nIn particular, we now derive a dynamical mean field theory (DMFT) description of the dynamics in the proportional regime where $P = \\gamma D$ with $P ,D \\to \\infty$ (with some subtleties about initial conditions for the alignment of weights to target direction). See Section 5.3, Appendix 13 and Figure 4. \n\nThis results in a version of the classic Saad-Solla [1] equations  for two-layer network dynamics, but with data repetition which induces correlations in weight updates and preactivations across time (allowing for the possibility of overfitting/grokking). \n\n\nThe key mathematical challenges that arise from having a separate train/test distribution when fitting a nonlinear function in this high dimensional limit are\n1. Non-markovian dynamics for the weights and preactivations (see equations 7-8), which give compouned errors between the online ($\\gamma = \\infty$ dynamics) and offline ($\\gamma$ finite) solutions. (For example, see the matrix $R^h$ in Figure 13d which is no longer diagonal!)\n2. Non-Gaussian preactivation statistics (see equation 6).\n\nHowever, we can still recover interesting dependences on $\\alpha$, $\\gamma$, and $\\epsilon$ (see Figure 4). For example, reducing $\\alpha$ and increasing $\\gamma$ reduces the gap between train and test loss dynamics. \n\n\\begin{equation}\n\\mathcal L_{test}(t) - \\mathcal L_{train}(t) \\sim \\frac{2 \\alpha}{\\gamma N} \\sum_{ij=1}^N \\int_0^t ds R^w_{ij}(t,s) C^g_{ij}(t,s) + \\mathcal{O}(\\gamma^{-2})\n\\end{equation}\n\n\nwhere $C^g$ is the gradient correlation function and $R^w$ is the response function for the weight dynamics. All of these functions implicitly depend on $\\gamma, \\epsilon,\\alpha$. The DMFT allows us to recover from a theoretical framework, the phenomena we observed empirically in our polynomial experiments.\n\n[1] https://journals.aps.org/pre/abstract/10.1103/PhysRevE.52.4225\n\n2. *(Nichani et al. 2022) also studied the transition from the NTK to the feature learning regime, and established improved sample complexity for learning low-degree + sparse high-degree polynomials. For the current model, does the sparsity of the higher-order term (that is, whether the quadratic component of the target function span more than one direction) play a role in the presence of grokking?*\n\nThere does not seem to be a major change in the grokking dynamics when we fit multi-index functions compared to single-index functions. We've added a new set of experiments in Section 15.1 of the Appendix verifing that the grokking we present holds out-of-the-box on multi-index models where the quadratic component spans multiple directions, illustrating that sparsity is not necessary for our results to hold. \n\nWe thank you for bringing (Nichani et al, 2022) to our attention. It is a very pertinent example of a transition from lazy to rich dynamics and what kinds of feature learning corrections improve generalization when transitioning away from the NTK. We added a citation to this work."
                    }
                },
                "number": 3,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6180/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700105107011,
                "cdate": 1700105107011,
                "tmdate": 1700105207118,
                "mdate": 1700105207118,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "N5QbsVRPR9",
                "forum": "vt5mnLVIVo",
                "replyto": "IUdtoIr4Dv",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6180/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6180/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Response Part 2"
                    },
                    "comment": {
                        "value": "3. *The target function is a single-index model with information exponent 2 (Ben Arous et al. 2021). It is known that for such target function, gradient descent on the population loss will start from an approximate saddle due to the random initialization. Is this observation related to the test loss plateau in grokking? And do we expect similar findings when the information exponent is larger than 2?*\n\nIndeed, we believe these phenomena are related. In Appendix Figure 10, we exactly tested the effect of \"warm start\" initial conditions where the weights are partially aligned to the target direction. All things equal, the models with poor alignment (close to saddle point of dynamics) exhibit more dramatic grokking behavior. Conversely, weight initializations with some component of the solution weights to begin with (far from saddle point) have train and test curves that track each other more strongly over the course of training, not exhibiting grokking to the same degree.\n\nYou also make a good point about the fact that the setting with information exponent $k=2$ is perhaps an easier task (in the sense of escaping the saddle point at initialization) than the case where $k \\ge 3$, as (Ben Arous et al, 2021) outline in Theorem 1.3 and 1.4. Thus, it is natural to ask whether the grokking that arises does so because of any properties related to the quadratic target. We can test this by seeing if grokking arises for $k \\ge 3$ higher degree Hermite polynomials. We find that indeed it does, out-of-the-box, so we can be confident that the findings do not rely on special properties of the quadratic target (information exponent $k=2$). We have new experiments illustrating this in Section 15.2 of the Appendix. \n\n4. *The quantity describing the difficulty of target function $y^T K^{-1} y$ has been extensively studied in the kernel literature. See (Arora et al. 2019) for the analysis of NTK. (Arora et al)*\n\nWe have updated the paper to emphasize that this is not a novel metric we are proposing, but rather is a natural, well-studied, object which reflects the RKHS norm of the targets on the train distribution, and turns out to be useful in the examination of grokking. We now cite Arora et al and other appropriate papers when introducing this difficulty metric. \n\n5. *(minor) The cited references on the quadratic sample complexity lower bound for kernel estimators such as (Ghorbani et al. 2019) do not rigorously cover the case of Gaussian data.*\n\nThis is a good point, we have updated the paper to qualify these references when we point to them. \n\nThank you for the detailed comments! We believe the additional theory (DMFT for dynamics) and experiments (new Appendix Sections 15-18) substantially improved the paper as now the emergence of a test-train gap is theoretically justified in addition to empirically controlled by the parameters we introduce. We hope that the reviewer will consider raising their score based on the new theoretical contributions, and additional Appendix sections."
                    }
                },
                "number": 4,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6180/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700105137264,
                "cdate": 1700105137264,
                "tmdate": 1700330254669,
                "mdate": 1700330254669,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    }
]