[
    {
        "title": "Probabilistically Rewired Message-Passing Neural Networks"
    },
    {
        "review": {
            "id": "4OHQhVn4ys",
            "forum": "Tj6Wcx7gVk",
            "replyto": "Tj6Wcx7gVk",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission5131/Reviewer_j89x"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission5131/Reviewer_j89x"
            ],
            "content": {
                "summary": {
                    "value": "The work proposes a probabilistic rewiring technique that relies on differentiable k-subset sampling. The main motivation is that while current rewiring techniques rely on \"arbitrary\" heuristics (improving spectral gap, connecting nodes in the 2-hop), it would be ideal to *learn* such a rewiring. Further, the work proposes a way to study the expressive power -- in terms of WL -- for such a process. The work is evaluated on synthetic and real-world benchmarks."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "3 good"
                },
                "strengths": {
                    "value": "The work is well-written and overall I found it interesting. I agree that learning a rewiring is intuitively something that should be preferred over arbitrary heuristics. I also appreciated that the work discusses techniques such as the Differentiable Graph Module, which in principle may seem similar."
                },
                "weaknesses": {
                    "value": "(W1) I believe experimentally there could be a larger breadth of rewiring benchmarks, for instance comparing against \"deterministic\" rewiring techniques such as FOSR [1] and SDRF [2] would be valuable. Furthermore, adding a \"random rewiring\" GNN, i.e. DropGNN, would also be useful for the real-world tasks. \n\n(W2) The claim that the rewiring technique reduces over-squashing could be strengthened. At the moment this seems to be solely motivated by the empirical results in Figure 2 and Figure 4.\n\n[1] FoSR: First-order spectral rewiring for addressing oversquashing in GNNs. Kedar Karhadkar, Pradeep Kr. Banerjee, Guido Mont\u00fafar. ICLR 2023\n\n[2] Jake Topping, Francesco Di Giovanni, Benjamin Paul Chamberlain, Xiaowen Dong, and Michael M Bronstein. Understanding over-squashing and bottlenecks on graphs via curvature. ICLR 2022"
                },
                "questions": {
                    "value": "(Q1) From Figure 1 and the paper overall, it seems like the rewiring technique is only removing edges and not adding any new edges not present in the original graph. Is this the case? \n\n(Q2) Regarding (W1), would it be possible to show results for existing deterministic rewiring techniques?\n\n(Q3) Regarding (W2) and especially (Q1), it is not clear to me how the technique can reduce over-squashing if it is only able to remove edges. It would be important to clarify (Q1), and provide some theoretical evidence that it is indeed able to alleviate over-squashing. In general by removing edges, one is reducing the total effective resistance over the graph."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "8: accept, good paper"
                },
                "confidence": {
                    "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
                },
                "code_of_conduct": {
                    "value": "Yes"
                },
                "first_time_reviewer": {
                    "value": "Yes",
                    "readers": [
                        "ICLR.cc/2024/Conference/Program_Chairs",
                        "ICLR.cc/2024/Conference/Submission5131/Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission5131/Reviewer_j89x",
                        "ICLR.cc/2024/Conference/Submission5131/Senior_Area_Chairs"
                    ]
                }
            },
            "number": 1,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission5131/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698596072957,
            "cdate": 1698596072957,
            "tmdate": 1700489015410,
            "mdate": 1700489015410,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "CUBE5lC5sL",
                "forum": "Tj6Wcx7gVk",
                "replyto": "4OHQhVn4ys",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission5131/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission5131/Authors"
                ],
                "content": {
                    "comment": {
                        "value": "We thank the reviewer for their helpful comments and observations. We will respond to their raised issues in the following:\n\n__W1__: More comparisons with deterministic rewiring methods.  \n__RW1__: Thank you for your suggestion. In our original manuscript, comparisons with deterministic rewiring methods such as DIGL and SDRF on heterophilic datasets were presented in Supplementary Table 11, with Drew on the QM9 dataset in Supplementary Table 10, and with DIGL and Drew on the Peptides datasets in Supplementary Table 12. Following the reviewer's recommendation, we have now included additional comparisons with FoSR and DropGNN on the TUDataset datasets in Table 4 and have expanded our analysis to cover all variants of SDRF and DIGL on the Heterophilic datasets in Supplementary Table 12.\n\n__W2__: Over-squashing claim could be strengthened.   \n__RW2__: We thank the reviewer for their suggestion.  Our empirical analysis of the widely-used Trees-NeighborsMatch dataset [1,2,3,4] demonstrates how PR-MPNNs alleviate over-squashing. As illustrated in Figure 4, PR-MPNNs outperform standard MPNNs and match Graph Transformers' performance, which is believed to not suffer from over-squashing issues [2].\n\nWe appreciate the suggestion and agree that further exploring the over-squashing phenomena with PR-MPNNs could be insightful. However, our experience indicates that traditional analyses using topological properties, as in references [3, 5], are not entirely adequate for black-box rewiring methods like ours. Despite logging various topological features such as edge curvatures and spectral gaps, no significant patterns emerged in the rewired graphs.\n\nTo illustrate why we believe that topological and spectral properties may be limited when employing learnable rewiring methods, we give an intuition via the following example:\n\n[image1.png](https://postimg.cc/fkBDgqgX)\n\nSuppose that, to solve some task, nodes A and B from the initial graph a) need to pass messages, but there\u2019s an information bottleneck between C and D. Increasing curvature in the rewiring process (as in example b) might improve information flow. However, a trivial solution, that could be obtained with PR-MPNNs, is to connect nodes A and B, bypassing the bottleneck directly. Moreover, if we delete the edge connecting nodes C and D, we obtain a graph that has the same curvature as the initial graph, as exemplified in example c).\n\nThis simplified example may not fully capture the complexity encountered in real-world scenarios. However, we want to point out that PR-MPNNs are indeed able to find perfect solutions in this kind of toy scenarios, as illustrated in Figure 3, where the PR-MPNN is recovering the trivial solution to the task for the Trees-LeafCount synthetic dataset.\n\n[1]: Alon, Uri, and Eran Yahav. \"On the bottleneck of graph neural networks and its practical implications.\" arXiv preprint arXiv:2006.05205 (2020).  \n[2]: M\u00fcller, Luis, et al. \"Attending to graph transformers.\" arXiv preprint arXiv:2302.04181 (2023).  \n[3]: Karhadkar, Kedar, Pradeep Kr Banerjee, and Guido Mont\u00fafar. \"FoSR: First-order spectral rewiring for addressing oversquashing in GNNs.\" arXiv preprint arXiv:2210.11790 (2022).  \n[4]: Banerjee, Pradeep Kr, et al. \"Oversquashing in GNNs through the lens of information contraction and graph expansion.\" 2022 58th Annual Allerton Conference on Communication, Control, and Computing (Allerton). IEEE, 2022.  \n[5]: Topping, Jake, et al. \"Understanding over-squashing and bottlenecks on graphs via curvature.\" arXiv preprint arXiv:2111.14522 (2021).\n\n__Q1__: Are new edges being added when rewiring?  \n__RQ1__: Thank you for highlighting this aspect. In our paper, while we focus on edge removal in Figure 5 concerning theoretical discussion in relation to randomized methods like DropEdge and DropGNN, in practical applications, we perform both edge addition and deletion. Detailed statistics on the number of edges added and removed are provided in Supplementary Table 8. To enhance clarity, we have revised our manuscript to explicitly state that we are both adding and removing edges.\n\n__Q2__: More comparisons with deterministic rewiring methods.  \n__RQ2__: Please see our response to Weakness 1.\n\n__Q3__: Evidence that we reduce over-squashing.  \n__RQ3__: As noted in our response to Question 1, our method involves both edge addition and deletion. For a detailed discussion on why spectral and topological analysis may not adequately address over-squashing in the context of learnable rewiring, please refer to our response to Weakness 2. We posit this is also the case for methods that treat graphs as fully-connected, such as Graph Transformers."
                    }
                },
                "number": 5,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission5131/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700144720072,
                "cdate": 1700144720072,
                "tmdate": 1700147776438,
                "mdate": 1700147776438,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "oavo1ud0GG",
                "forum": "Tj6Wcx7gVk",
                "replyto": "4OHQhVn4ys",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission5131/Reviewer_j89x"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission5131/Reviewer_j89x"
                ],
                "content": {
                    "comment": {
                        "value": "I would like to thank the authors for the reply. I think this is a nice piece of work and recommend acceptance to the conference."
                    }
                },
                "number": 9,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission5131/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700235018222,
                "cdate": 1700235018222,
                "tmdate": 1700235032371,
                "mdate": 1700235032371,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "St7zJPPKpz",
                "forum": "Tj6Wcx7gVk",
                "replyto": "4OHQhVn4ys",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission5131/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission5131/Authors"
                ],
                "content": {
                    "comment": {
                        "value": "We appreciate your kind reply. We would kindly ask you to adjust your score if we have addressed the concerns. Please also let us know what we can further improve."
                    }
                },
                "number": 10,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission5131/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700236919371,
                "cdate": 1700236919371,
                "tmdate": 1700302538334,
                "mdate": 1700302538334,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "cO5SNTYTX2",
                "forum": "Tj6Wcx7gVk",
                "replyto": "St7zJPPKpz",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission5131/Reviewer_j89x"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission5131/Reviewer_j89x"
                ],
                "content": {
                    "comment": {
                        "value": "After further careful thought, I agree that the authors have been thorough in the rebuttal and more generally in their work. I have increased the score accordingly."
                    }
                },
                "number": 12,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission5131/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700489005832,
                "cdate": 1700489005832,
                "tmdate": 1700489005832,
                "mdate": 1700489005832,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "fmuZWo0zuB",
            "forum": "Tj6Wcx7gVk",
            "replyto": "Tj6Wcx7gVk",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission5131/Reviewer_8vRc"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission5131/Reviewer_8vRc"
            ],
            "content": {
                "summary": {
                    "value": "The paper proposes a probabilistic rewired message-passing network (PR-MPNN) to address the under-reaching and over-squashing problems of existing graph neural network (GNN) models. Specifically, PR-MPNN first uses a GNN to learn the priors over edges, and then it samples multiple adjacency matrices from the edge prior distributions using SIMPLE, a gradient estimator for k-subset sampling. The sampled adjacency matrices are combined with the original adjacency matrix to obtain the rewired graph, which is used in the downstream tasks. The paper also provides theoretical analysis to identify conditions under which the proposed method can outperform randomized approaches."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "2 fair"
                },
                "contribution": {
                    "value": "3 good"
                },
                "strengths": {
                    "value": "1. The proposed PR-MPNN model is simple yet effective. \n2. The paper provides theoretical analyses to prove that the proposed model is more effective in probabilistically separating graphs than randomized approaches such as dropping nodes and edges uniformly under certain conditions. \n3. Experimental results on both node classification and graph classification tasks indicate that PR-MPNN can achieve better or competitive performance compared with baselines."
                },
                "weaknesses": {
                    "value": "1. The motivation for using $k$-subset constraint when sampling the adjacency matrix is not very clear. What are the advantages of using such constraints? \n\n2. The difference between the proposed PR-MPNN and previous works is not explicitly discussed in the related work section. \n\n3. The theoretical results indicate that PR-MPNN  is more effective in probabilistically separating graphs than randomized approaches under certain conditions. But how does this help PR-MPNN address the over-squashing problem?\n\n4. In the introduction section, the paper states that PR-MPNNs make MPNNs less vulnerable to potential noise and missing information. However, there are no empirical or theoretical results to validate such statements. \n\n5. PR-MPNN use SIMPLE to sample adjacency matrices. It seems to be an important component of the proposed model and the paper should provide an introduction to the SIMPLE method to make the paper self-contained. \n\n6. I also have some concerns regarding the experiments: \n\n(1) In the \u201cBaseline and model configurations\u201d paragraph, the paper states that there are two ways to leverage the sampled adjacency matrices when using multiple priors. However, it is unclear which method is used in their experiments. \n\n(2) When answering Q2, why compare PR-MPNN with different baselines on different datasets? For example, the paper compares PR-MPNN with OSAN, GIN+POSENC, DropGNN on EXP, CSL and 4-CYCLES datasets respectively. Also, the statement \u201cConcerning Q2, on the 4-CYCLES dataset, our probabilistic rewiring method consistently outperforms DropGNN\u201d is inaccurate since PR-MPNN only achieve comparable performance with DropGNN in some cases. \n\n(3) The results in Table 1 are quite confusing. What evaluation metric is used in these results? Why is it that on some datasets, such as OGBG-MOLHIV, a higher metric indicates better performance, while on others, such as ZINC and ALCHEMY,  a lower value is preferable?\n\n(4) There are no ablation studies to validate the effectiveness of each component of the proposed model. \n\n7. In the conclusion section, the paper states that PR-MPNN \u201cis competitive or superior to conventional  MPNN models and graph transformer architectures regarding predictive performance and computational efficiency\u201d. However, there is no comparison between PR-MPNN and baselines regarding the computational efficiency in the main text."
                },
                "questions": {
                    "value": "Please see the questions in the Weaknesses section."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "6: marginally above the acceptance threshold"
                },
                "confidence": {
                    "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
                },
                "code_of_conduct": {
                    "value": "Yes"
                },
                "first_time_reviewer": {
                    "value": "Yes",
                    "readers": [
                        "ICLR.cc/2024/Conference/Program_Chairs",
                        "ICLR.cc/2024/Conference/Submission5131/Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission5131/Reviewer_8vRc",
                        "ICLR.cc/2024/Conference/Submission5131/Senior_Area_Chairs"
                    ]
                }
            },
            "number": 2,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission5131/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698836076451,
            "cdate": 1698836076451,
            "tmdate": 1700733200360,
            "mdate": 1700733200360,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "V9l4lJoLrS",
                "forum": "Tj6Wcx7gVk",
                "replyto": "fmuZWo0zuB",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission5131/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission5131/Authors"
                ],
                "content": {
                    "comment": {
                        "value": "We thank the reviewer for their thorough feedback. In the following, we address the raised issues one by one.\n\n__W1__: The motivation for k-subset sampling is not clear.  \n__RW1__: The choice of sampling $k$-subsets with $k>1$ is required for introducing complex dependencies between the edge random variables. On the other hand, even more complex constraints on these random variables would render the computation of marginals, as needed for the gradient estimation algorithm SIMPLE, intractable. Moreover, the $k$-subset sampling also enables fine-grained control of the sampled graphs\u2019 sparsity. In the final paper, we will add a detailed discussion. \n\n__W2__: The difference with prior work is not discussed.  \n__RW2__: We appreciate the reviewer's remark and have made improvements to the related work section, clarifying our method's difference from existing heuristic and probabilistic rewiring techniques. Our manuscript's \"Related Work\" section extensively contrasts PR-MPNNs with heuristic-based methods such as DIGL, SDRF [1], SP-MPNN [2], and Drew [3]. We emphasize the novelty of our learning-based rewiring approach and its robust theoretical link with WL expressivity. Additionally, and as noted by Reviewer j89x, we want to point to the extended section in the Appendix, which addressed the relation to Graph Structure Learning (GSL) methods, which bear conceptual similarities to our work but typically employ $k$-NN algorithms for sparsification or model edges with independent Bernoulli variables. Moreover, the GSL methods mainly focus on node classification tasks, while we\u2019re more interested in graph-level data. Nevertheless, our theoretical PR-MPNN framework extends to various GSL methods, offering broader applicability.\n\n[1]: Topping, Jake, et al. \"Understanding over-squashing and bottlenecks on graphs via curvature.\" arXiv preprint arXiv:2111.14522 (2021).  \n[2]: Abboud, Ralph, Radoslav Dimitrov, and Ismail Ilkan Ceylan. \"Shortest path networks for graph property prediction.\" Learning on Graphs Conference. PMLR, 2022.  \n[3]: Gutteridge, Benjamin, et al. \"Drew: Dynamically rewired message passing with delay.\" International Conference on Machine Learning. PMLR, 2023.\n\n__W3__: How does PR-MPNN help alleviate over-squashing?  \n__RW3__: Our empirical analysis on the widely-used Trees-NeighborsMatch dataset [1,2,3,4] demonstrates how PR-MPNNs alleviate over-squashing. As illustrated in Figure 4, PR-MPNNs outperform standard MPNNs and match Graph Transformers' performance, which is believed to suffer less from over-squashing issues [2]. Using these benchmark datasets is the de facto community standard for assessing the over-squashing behavior of MPNNs. \n\n[1]: Alon, Uri, and Eran Yahav. \"On the bottleneck of graph neural networks and its practical implications.\" arXiv preprint arXiv:2006.05205 (2020).  \n[2]: M\u00fcller, Luis, et al. \"Attending to graph transformers.\" arXiv preprint arXiv:2302.04181 (2023).  \n[3]: Karhadkar, Kedar, Pradeep Kr Banerjee, and Guido Mont\u00fafar. \"FoSR: First-order spectral rewiring for addressing oversquashing in GNNs.\" arXiv preprint arXiv:2210.11790 (2022).  \n[4]: Banerjee, Pradeep Kr, et al. \"Oversquashing in GNNs through the lens of information contraction and graph expansion.\" 2022 58th Annual Allerton Conference on Communication, Control, and Computing (Allerton). IEEE, 2022."
                    }
                },
                "number": 6,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission5131/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700145148149,
                "cdate": 1700145148149,
                "tmdate": 1700146257701,
                "mdate": 1700146257701,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "DSWcPu8L5p",
                "forum": "Tj6Wcx7gVk",
                "replyto": "fmuZWo0zuB",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission5131/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission5131/Authors"
                ],
                "content": {
                    "comment": {
                        "value": "__W4__: No experiments to validate claims about robustness.  \n__RW4__: We thank the reviewer for this observation. A beneficial side-effect of training PR-MPNNs is the enhanced robustness of the downstream model to graph structure perturbations. This is because PR-MPNNs generate multiple adjacency matrices for the same graph during training, akin to augmenting training data by randomly dropping or adding edges, but with a parametrized \"drop/add\" distribution rather than a uniform one.\n\nMotivated by the reviewer\u2019s feedback, we conducted a dedicated experiment on the PROTEINS dataset. After training our models on clean data, we compared the models\u2019 test accuracy on the clean and corrupted graphs. Corrupted graphs were generated by either deleting or adding a certain percentage of their edges. We report the change in the average test accuracy over 5 runs, comparing the base model with variants of PR-MPNN in the following table:\n\n| Corruption\\\\Model | GINE (acc 77.9) | PR-MPNN-RM25 (acc 80.1) | PR-MPNN-RM50 (acc 78.8) |\n| ----------------- | --------------- | ----------------------- | ------------------------ |\n| RM 10%            | \\-7.68%         | +0.04%                  | __+0.34%__                   |\n| RM 30%            | \\-11.87%        | \\-2.56%                 | __\\-0.56%__                  |\n| RM 50%            | \\-9.18%         | \\-3.50%                 | __\\-0.21%__               |\n| ADD 10%           | \\-5.93%         | +0.28%                  | __+0.80%__                   |\n| ADD 30%           | \\-11.14%        | \\-1.27%                 | __+0.28%__                   |\n| ADD 50%           | \\-21.75%        | \\-1.99%                 | __\\-0.43%__                  |\n\nPR-MPNNs consistently obtain the best results for both removing k=25 and k=50 edges. The three models achieve test accuracies on the unperturbed dataset as follows: GINE 77.9%, PR-MPNN-RM25 80.1%, and PR-MPNN-RM50 78.8%.  \nWe included these initial results in the revised manuscript; see Table 13 in the appendix. \n\n__W5__: SIMPLE does not have a detailed explanation.  \n__RW5__: We thank the reviewer for their remark. We have added an explanation of SIMPLE to the appendix of the updated submission.\n\n__W6__: Concerns about experiments.  \n__(1)__ Confusion about how we leverage the adjacency matrices.  \n__R__: We thank the reviewer for the remark. To clarify, we always use a downstream ensemble to obtain the results when using multiple rewired adjacency matrices. We have updated our manuscript with a clarification.\n\n__(2)__ a) Different baselines for different datasets.  \n__R__: We selected different baselines for each dataset based primarily on the availability of the authors\u2019 code and published results. Our evaluation of the PR-MPNN method covers 20 datasets, detailed in Table 5 of the Appendix. Due to time and resource limitations, it wasn't feasible to comprehensively evaluate all baselines across these datasets. We relied on publicly available results for comparisons where the direct evaluation was impractical. However, we conducted additional experiments for some baselines on datasets that were not initially reported (e.g., SAT on OGBG-Molhiv, GIN, and GIN+PE in Tables 1, 3, 10, and 11). Furthermore, we have introduced two new baselines on the TUDataset and have run new experiments with FoSR (PTC_MR, NCI1, NCI109) and DropGNN (NCI1, NCI109).  \n__(2)__ b) Comparable performance with DropGNN on 4-Cycles.  \n__R__: We appreciate the reviewer pointing this out. We intended to compare PR-MPNNs with DropGNN on 4-Cycles to emphasize the significance of utilizing multiple priors in sampling. This key aspect is detailed in the caption of Figure 2, where we illustrate the impact of our sampling approach. We have updated the text in the revised manuscript to reflect this. \n\n__(3)__ Table 1 is confusing.  \n__R__: We appreciate the reviewer's feedback on Table 1. The evaluation metric for the ZINC and Alchemy datasets is the Mean Absolute Error (MAE), with a lower score indicating better performance. For the OGBG-Molhiv dataset, the metric is ROCAUC, where a higher score denotes superior performance. In our initial submission, we used symbols $\\uparrow$ and $\\downarrow$ to signify this. In our revised version, we explicitly state the evaluation metric for each dataset in Supplementary Table 5 to improve clarity. \n\n__(4)__ There are no ablation studies.  \n__R__: We have conducted ablation studies focusing on the performance impact of different gradient estimators, specifically Gumbel, I-MLE, and SIMPLE, as detailed in Table 1. Additionally, our comparison with DropGNN, presented in Figure 2, demonstrates the benefits of utilizing multiple priors and samples. Furthermore, we have revised the computation efficiency in Table 9 in the Appendix, where we compare the runtime of various PR-MPNN models when using different gradient estimators and the total number of edges sampled. These sections collectively serve as our approach's ablation analysis."
                    }
                },
                "number": 7,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission5131/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700145623840,
                "cdate": 1700145623840,
                "tmdate": 1700146271467,
                "mdate": 1700146271467,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "exweVuNwhJ",
                "forum": "Tj6Wcx7gVk",
                "replyto": "fmuZWo0zuB",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission5131/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission5131/Authors"
                ],
                "content": {
                    "comment": {
                        "value": "__W7__: No computational efficiency in the main text.  \n__RW7__: We compute the computational complexity of PR-MPNNs in Section 3, noting that we obtain a better worst-case complexity than full self-attention-based graph transformers in the downstream module during test time, i.e., $\\mathcal{O}(n^2)$ for a graph transformer versus $\\mathcal{O}(L)$ for PR-MPNNs, where $n$ is the number of nodes in the graph, and $L$ is the number of edges in the rewired graph. Moreover, we also indicate that we can further reduce the complexity during training by restricting the edge candidates set, therefore achieving a lower overall complexity than a graph transformer. In the following table, we compare our runtime with a simple GINE model and the SAT Graph Transformer. PR-MPNN is approximately 5 times slower than a GINE model with a similar parameter count, while SAT is approximately 30 times slower than the GINE, and 6 times slower than the PR-MPNN models. \n\n| Model           | #Params | Total sampled edges | Train time/ep (s) | Val time/ep (s) |\n|-----------------|---------|---------------------|-------------------|-----------------|\n| GINE            | 502k    | -                   | 3.19 \u00b1 0.03       | 0.20 \u00b1 0.01     |\n| K-ST SAT (GINE) | 506k    | -                   | 86.54 \u00b1 0.13      | 4.78 \u00b1 0.01     |\n| K-SG SAT (GINE) | 481k    | -                   | 97.94 \u00b1 0.31      | 5.57 \u00b1 0.01     |\n| K-ST SAT (PNA)  | 534k    | -                   | 90.34 \u00b1 0.29      | 4.85 \u00b1 0.01     |\n| K-SG SAT (PNA)  | 509k    | -                   | 118.75 \u00b1 0.50     | 5.84 \u00b1 0.04     |\n| PR-MPNN (Gmb)   | 582k    | 20                  | 15.20 \u00b1 0.08      | 1.01 \u00b1 0.01     |\n| PR-MPNN (Gmb)   | 582k    | 100                 | 18.18 \u00b1 0.08      | 1.08 \u00b1 0.01     |\n| PR-MPNN (IMLE)  | 582k    | 20                  | 15.01 \u00b1 0.22      | 1.08 \u00b1 0.06     |\n| PR-MPNN (IMLE)  | 582k    | 100                 | 15.13 \u00b1 0.17      | 1.13 \u00b1 0.06     |\n| PR-MPNN (Sim)   | 582k    | 20                  | 15.98 \u00b1 0.13      | 1.07 \u00b1 0.01     |\n| PR-MPNN (Sim)   | 582k    | 100                 | 17.23 \u00b1 0.15      | 1.15 \u00b1 0.01     |\n\nFurthermore, we have also revised Table 9 in the Appendix."
                    }
                },
                "number": 8,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission5131/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700145641965,
                "cdate": 1700145641965,
                "tmdate": 1700147386867,
                "mdate": 1700147386867,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "BmHO9uV1Qw",
                "forum": "Tj6Wcx7gVk",
                "replyto": "exweVuNwhJ",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission5131/Reviewer_8vRc"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission5131/Reviewer_8vRc"
                ],
                "content": {
                    "comment": {
                        "value": "I would like to thank the authors for their responses. I think the responses have addressed most of my concerns. Therefore, I have raised the score."
                    }
                },
                "number": 13,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission5131/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700733176370,
                "cdate": 1700733176370,
                "tmdate": 1700733176370,
                "mdate": 1700733176370,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "27TVZ7Zit8",
            "forum": "Tj6Wcx7gVk",
            "replyto": "Tj6Wcx7gVk",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission5131/Reviewer_MyQT"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission5131/Reviewer_MyQT"
            ],
            "content": {
                "summary": {
                    "value": "The paper has proposed a probabilistic rewiring methanism for GNN. Its improvement in expressive power has been verified with theory and experiments."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "3 good"
                },
                "strengths": {
                    "value": "1. The method has been verified with both theory and experiments."
                },
                "weaknesses": {
                    "value": "1. The computation overhead is also needed.\n2. How does the expressiveness guarantee translate to practical performances?"
                },
                "questions": {
                    "value": "I wonder what is the performance gain over the overhead the method produces."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "details_of_ethics_concerns": {
                    "value": "No concern"
                },
                "rating": {
                    "value": "6: marginally above the acceptance threshold"
                },
                "confidence": {
                    "value": "2: You are willing to defend your assessment, but it is quite likely that you did not understand the central parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 3,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission5131/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1699040769727,
            "cdate": 1699040769727,
            "tmdate": 1699636505679,
            "mdate": 1699636505679,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "OQLMawPyrG",
                "forum": "Tj6Wcx7gVk",
                "replyto": "27TVZ7Zit8",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission5131/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission5131/Authors"
                ],
                "content": {
                    "comment": {
                        "value": "We thank the reviewer for their helpful comments and the positive evaluation of our work.\n\n__W1__: The computation overhead is also needed. \n__RW1__: We compute the computational complexity of PR-MPNNs in Section 3, noting that we obtain a better worst-case complexity than full self-attention-based graph transformers in the downstream module during test time, i.e., $\\mathcal{O}(n^2)$ for a graph transformer versus $\\mathcal{O}(L)$ for PR-MPNNs, where $n$ is the number of nodes in the graph, and $L$ is the number of edges in the rewired graph. Moreover, we also indicate that we can further reduce the complexity during training by restricting the edge candidates set, therefore achieving a lower overall complexity than a graph transformer. In the following table, we compare our runtime with a simple GINE model and the SAT Graph Transformer. PR-MPNN is approximately 5 times slower than a GINE model with a similar parameter count, while SAT is approximately 30 times slower than the GINE, and 6 times slower than the PR-MPNN models. \n\n| Model           | #Params | Total sampled edges | Train time/ep (s) | Val time/ep (s) |\n|-----------------|---------|---------------------|-------------------|-----------------|\n| GINE            | 502k    | -                   | 3.19 \u00b1 0.03       | 0.20 \u00b1 0.01     |\n| K-ST SAT (GINE) | 506k    | -                   | 86.54 \u00b1 0.13      | 4.78 \u00b1 0.01     |\n| K-SG SAT (GINE) | 481k    | -                   | 97.94 \u00b1 0.31      | 5.57 \u00b1 0.01     |\n| K-ST SAT (PNA)  | 534k    | -                   | 90.34 \u00b1 0.29      | 4.85 \u00b1 0.01     |\n| K-SG SAT (PNA)  | 509k    | -                   | 118.75 \u00b1 0.50     | 5.84 \u00b1 0.04     |\n| PR-MPNN (Gmb)   | 582k    | 20                  | 15.20 \u00b1 0.08      | 1.01 \u00b1 0.01     |\n| PR-MPNN (Gmb)   | 582k    | 100                 | 18.18 \u00b1 0.08      | 1.08 \u00b1 0.01     |\n| PR-MPNN (IMLE)  | 582k    | 20                  | 15.01 \u00b1 0.22      | 1.08 \u00b1 0.06     |\n| PR-MPNN (IMLE)  | 582k    | 100                 | 15.13 \u00b1 0.17      | 1.13 \u00b1 0.06     |\n| PR-MPNN (Sim)   | 582k    | 20                  | 15.98 \u00b1 0.13      | 1.07 \u00b1 0.01     |\n| PR-MPNN (Sim)   | 582k    | 100                 | 17.23 \u00b1 0.15      | 1.15 \u00b1 0.01     |\n\nFurthermore, we have also revised Table 9 in the Appendix.\n\n__W2__: How does the expressiveness translate to practical performance?  \n__RW2__: Our empirical results validate the expressivity claims using the EXP and CSL datasets. These datasets are designed so GNNs limited to 1-WL expressivity will not perform well. As detailed in Tables 2 and 3, our rewiring technique achieves perfect performance on EXP and nearly perfect on CSL, significantly outperforming the base GIN model's random performance, clearly indicating that our expressivity guarantees translate into practice. \n\nIn addition, as shown in Table 1, our SIMPLE-based rewiring method consistently surpasses the base model regarding predictive performance on real-world datasets. Further, Table 10 highlights a substantial improvement, up to 14.13x, over the base GIN model on QM9, demonstrating significant real-world performance gains."
                    }
                },
                "number": 4,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission5131/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700143436851,
                "cdate": 1700143436851,
                "tmdate": 1700147822138,
                "mdate": 1700147822138,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    }
]