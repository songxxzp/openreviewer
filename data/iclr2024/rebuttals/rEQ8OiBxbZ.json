[
    {
        "title": "3D Molecular Pretraining via Localized Geometric Generation"
    },
    {
        "review": {
            "id": "ugAdT84dP2",
            "forum": "rEQ8OiBxbZ",
            "replyto": "rEQ8OiBxbZ",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission9430/Reviewer_wqqh"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission9430/Reviewer_wqqh"
            ],
            "content": {
                "summary": {
                    "value": "This paper introduces a 3D molecular self-supervised learning approach that leverages the geometric information of molecular local structures, in the way of orientation prediction and arrangement generation. The atom-bond inconsistency issue has been identified and tackled through a joint modeling of the graph as a set of nodes and edges. The method has been benchmarked on MoleculeNet and OGBLSC-PCQM4Mv2 datasets to verify the efficacy of proposed designs."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "2 fair"
                },
                "strengths": {
                    "value": "1. The paper is well-motivated through the concept of molecular local structure and the introduced approach yields good novelty.\n\n2. The presentation is mostly clear and the method is easy to follow."
                },
                "weaknesses": {
                    "value": "1. The experimental results seem to be insufficient to support the empirical superiority of the proposed approach. In particular, the method could be further improved either through a more careful design of the backbone or enhancements of the training objective to make the results stronger.\n\n2. If the results are difficult to improve, the authors may also be suggested to try other benchmarks or setups, e.g., QM9, MD17, where a better utilization of the 3D structural information would bring more benefits. In the current shape the quality of the experimental evaluations may not meet the bar of ICLR."
                },
                "questions": {
                    "value": "Q1. I am curious whether the proposed SSL objective can be combined with other backbones or even other pretraining objectives. If so, it would be interesting to see how the method can benefit different backbones which may be an evidence of the extensibility of the approach.\n\nQ2. How does the method perform on datasets like QM9?\n\nQ3. For the ablation study, it would also be interesting to see how the proposed 3D TokenGT helps to boost the performance since one of the claim in the paper is that the atom-bond inconsistency problem is tackled by modeling graph as a set of nodes and edges."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "3: reject, not good enough"
                },
                "confidence": {
                    "value": "5: You are absolutely certain about your assessment. You are very familiar with the related work and checked the math/other details carefully."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 1,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission9430/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698609239724,
            "cdate": 1698609239724,
            "tmdate": 1699637187967,
            "mdate": 1699637187967,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": []
    },
    {
        "review": {
            "id": "s1KaX4GPTJ",
            "forum": "rEQ8OiBxbZ",
            "replyto": "rEQ8OiBxbZ",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission9430/Reviewer_SwR4"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission9430/Reviewer_SwR4"
            ],
            "content": {
                "summary": {
                    "value": "This paper describes a pretraining process on the 3D structure of small molecules. The method splits a molecule into tetrahedrons of a few atoms each and learns to reconstruct them in 3D using knowledge of the graph structure of the input molecule. The authors apply the model on downstream property prediction tasks and compare to public benchmarks."
                },
                "soundness": {
                    "value": "2 fair"
                },
                "presentation": {
                    "value": "2 fair"
                },
                "contribution": {
                    "value": "2 fair"
                },
                "strengths": {
                    "value": "The main method in the paper is interesting conceptually and somewhat original as it combines a graph token representation with a decomposition of a small molecule into smaller 3D structural units. The downstream application on MoleculeNet is significant, and the application on the open graph benchmark is useful for context, although the particular table 2 is misleading. The introduction is reasonably clear, however, other parts of the paper have problems with the language or formalism."
                },
                "weaknesses": {
                    "value": "The paper can use a lot of rewriting in the methods and experimental results sections.\n\n\nTable 1 does not correctly highlight the best and second best results (see column for BACE when 2 of the 2D models perform better than LEGO).  Table 2 is missing the vast majority of best performing models from the opengraph benchmark large scale challenge.  Interestingly, the comparison in table 2 misses the top two entries which are models included in Table 1; if I count correctly the LEGO model would rank 9th in the validation metric with a substantial gap compared to unimol published in last year's ICLR.  It would be useful if the authors submitted their model to the benchmark to see the performance on the test set.\n\nThe text has a lot of rushed / unclear sentences.  The first sentence on page 8 (\"All this baselines involves...\") does not make sense as written.  Small errors and lack of clarity starts earlier in page 5 (undefined d_p), page 6 (\"way to increase the and generalizability\"), page 7 (\"... is enough to valid our method\", \"...graph representation an pass it...\", \"...an important properties...\", \"...proved to be close related...\"), probably more."
                },
                "questions": {
                    "value": "Although the current method is not directly inspired by this work, I believe that the RL reconstruction of molecular geometries from 3D fragments in Flam-Shepherd et al (https://arxiv.org/abs/2202.00658) relates closely to the core inspiration of this method and might warrant discussion in the intro. (In contrast, some of the discussion of the atom-bond inconsistency problem is potentially possible to skip as it doesn't add meaningful insights.) Did the authors think of extending their tetrahedral segmentation approach to use a similar fragment-based approach instead?\n\nCan the authors comment on the disparity of the approach of their validation scores on moleculeNet vs those on the large-scale challenge?  \n\nThe ablation study is not helpful: the perturbation of the model is too limited, and table 3 suggests strongly that the parameters are actually not optimal.  The random perturbation pretraining of table 4 is not described in a clear enough fashion."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "3: reject, not good enough"
                },
                "confidence": {
                    "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 2,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission9430/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698679615112,
            "cdate": 1698679615112,
            "tmdate": 1699637187845,
            "mdate": 1699637187845,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "U8wOFyH9fV",
                "forum": "rEQ8OiBxbZ",
                "replyto": "s1KaX4GPTJ",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission9430/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission9430/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Response to Reviewer SwR4"
                    },
                    "comment": {
                        "value": "Thank you for the thorough review and positive feedback - your suggestions will lead to a stronger analysis. To address your concern, we provide the following point-to-point responses.\n\n>   **Q1**:...... I believe that the RL reconstruction of molecular geometries from 3D fragments in Flam-Shepherd et al (https://arxiv.org/abs/2202.00658) relates closely to the core inspiration of this method and might warrant discussion in the intro....\n\n**Response**: We appreciate you highlighting the promising fragment-based reconstruction approach by Flam-Shepherd et al. As you suggested, we will cite this relevant work in the introduction and discuss extensions of our tetrahedron segmentation to incorporate larger functional fragments as building blocks. This could enable more complex biologically meaningful reconstruction objectives in our future work.\n\n>   **Q2**: Can the authors comment on the disparity of the approach of their validation scores on moleculeNet vs those on the large-scale challenge?\n\n**Response:** For PCQM4M-v2, we would like to argue that existing top approaches incorporate sophisticated graph encoding priors, while we apply a pure transformer. Nevertheless, the benefits of our pretraining approach can be demonstrated by the performance increase over the non-pretrained TokenGT model.  The primary contribution of this work is to give a glimpse at how proper selection of semantic units impacts 3D molecular pretraining, and we believe a further introduction of graph inductive bias will further improve our result in table2.\n\n>   **Q3:** The ablation study is not helpful: the perturbation of the model is too limited, and table 3 suggests strongly that the parameters are actually not optimal. The random perturbation pretraining of table 4 is not described in a clear enough fashion.\n\n**Response:** Thank you for the feedback requesting more extensive ablation experiments and analysis, and we have revised the abaltion study section in our paper. In table 3, we show that excessive noise in 3D structure denoising can lead to training divergence and detrimental impacts and validate the setting of our perturbation strategy. In table 4, we validate the benefits of structural pretraining by comparing against a naive random atom-level denoising baseline with equivalent 36% masking."
                    }
                },
                "number": 7,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission9430/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700739700860,
                "cdate": 1700739700860,
                "tmdate": 1700739700860,
                "mdate": 1700739700860,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "RYtskkwbeG",
            "forum": "rEQ8OiBxbZ",
            "replyto": "rEQ8OiBxbZ",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission9430/Reviewer_2SQj"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission9430/Reviewer_2SQj"
            ],
            "content": {
                "summary": {
                    "value": "This paper proposes a self-supervised pre-training strategy for 3D molecular structures, based on partitioning molecular structure into tetrahedra that can then be masked and reconstructed."
                },
                "soundness": {
                    "value": "2 fair"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "2 fair"
                },
                "strengths": {
                    "value": "The empirical performance is OK for some of the fine tuning tasks, although still not consistently solid."
                },
                "weaknesses": {
                    "value": "The geometrical justification of tetrahedra as simplest polyhedron might make sense, but in chemistry it makes a lot less sense. The authors literally show benzene in Figure 1b, which has 120-degree bonding pattern (so called planar-trigonal in chemistry) that is NOT a tetrahedron at all, and has very different local symmetries. \nThe ablation studies are unconvicing. Why not evaluate the role of the actual innovations introduced ? Tetrahedra vs. point-wise generation. Evaluate the role of edge information ? \nWhat happens for atoms with more than 4 bonds (sulfur, phosphorous, etc) ?"
                },
                "questions": {
                    "value": "\"We attributethistothedifferent3Dstructuresmoleculesexhibitinliposomecompounds.\" What does this mean ? What are these structures different ? \nAll the biochemistry prediction tasks are actually properties of the graph, not the 3D structure, What 3D structure is being used ?"
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "3: reject, not good enough"
                },
                "confidence": {
                    "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 3,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission9430/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698805618728,
            "cdate": 1698805618728,
            "tmdate": 1699637187720,
            "mdate": 1699637187720,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "jvBPjao2Ef",
                "forum": "rEQ8OiBxbZ",
                "replyto": "RYtskkwbeG",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission9430/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission9430/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Response to Reviewer 2SQj"
                    },
                    "comment": {
                        "value": "We really appreciate the helpful comments and critiques that allow us to improve LEGO. Regarding your concern, here is our response.\n\n>   **Q1:** The geometrical justification of tetrahedra as simplest polyhedron might make sense, but in chemistry it makes a lot less sense. The authors literally **show benzene in Figure 1b, which has 120-degree bonding pattern (so called planar-trigonal in chemistry)** that is NOT a tetrahedron at all, and has very different local symmetries\n>\n>   ......\n>\n>   What happens for atoms with more than 4 bonds (sulfur, phosphorous, etc) ?\n\n**Response**: Thank you for highlighting this important point. We have expanded the motivation section (page 4) to better address cases where local molecular structures deviate from standard tetrahedral geometry. While tetrahedra serve as an informative reference decomposition target due to their simplicity, our segmentation strategy adapts accordingly when this arrangement does not naturally arise.\n\nFor instance, center atoms with fewer than four one-hop neighbors, as commonly observed in functional groups (e.g. ketenes, amines, ethers in Fig. 1b), are handled by treating the local unit as a degraded tetrahedra. Meanwhile, atoms forming more than four bonds, like sulfur and phosphorous, we incorporate all its one-hop neighbors into the unit. For cyclic structures such as benzene, non-adjacent ring atoms are selected, effectively partitioning the system into triangular fragments. In summary, while tetrahedral local structures provide a useful illustration, our method maintains flexibility to accommodate chemical environments where alternative local symmetries dominate.\n\n>   **Q2**: \"We attribute this to the different 3D structures molecules exhibit in liposome compounds.\" What does this mean ? What are these structures different ? \n\n**Response**:  Thank you for raising this question. To clarify, when referring to the \"different 3D structures exhibited by molecules in liposome compounds\", we intended to highlight potential differences between conformations in a lipid environment versus the conformations in a water environment, or the equilibrated 3D conformations used during pre-training. As you pointed out, our original phrasing was unclear on this distinction.\n\nWe hypothesize that the weaker performance on the Lipo task may arise because the stable conformations adopted by molecules in a lipid-like environment can differ substantially from common isolated conformations. As our pre-training exclusively saw the latter, transferring representations to predict lipid-specific properties poses an additional challenge.\n\n>   **Q3:** All the biochemistry prediction tasks are actually properties of the graph, not the 3D structure, What 3D structure is being used ?\n\nResponse: We would like to point out that we adopt only 2D graph inputs for the biochemistry prediction tasks to **conform with** established dataset conventions and existing baseline approaches on MoleculeNet, including GraphMVP, 3DInfomax, and other 3D pre-trained models - all of which use 2D inputs. As such, while not directly evaluating 3D structure modeling, these tasks probe valuable model capabilities: 1.Encoding functional semantics related to downstream biological effects into 2D topology representations. 2.Assessing transferability of features learned from 3D pre-training when adapted to 2D inputs.\n\nConversely, we intentionally select 3D-sensitive quantum property prediction as an additional testbed for explicit 3D molecular structure modeling, using true 3D conformations as inputs. This directly examines the model's proficiency at encoding geometric details within continuous predictions - complementing the more functional evaluation on biochemical properties.\n\n####"
                    }
                },
                "number": 6,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission9430/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700739671997,
                "cdate": 1700739671997,
                "tmdate": 1700739671997,
                "mdate": 1700739671997,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "AP19rMVi04",
            "forum": "rEQ8OiBxbZ",
            "replyto": "rEQ8OiBxbZ",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission9430/Reviewer_VdE4"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission9430/Reviewer_VdE4"
            ],
            "content": {
                "summary": {
                    "value": "The paper presents a novel pre-training approach for 3D molecular datasets, building upon TokenGT. By augmenting TokenGT with 3D attributes, the proposed method harnesses 3D molecular data to enhance its generalization capabilities across various tasks."
                },
                "soundness": {
                    "value": "2 fair"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "2 fair"
                },
                "strengths": {
                    "value": "1. Segmenting 3D structures into distinct local components is an insightful approach.\n\n2. The reconstruction method for these local structures is intriguing and presents a unique strategy.\n\n3. There is a marked novelty in the concept of pre-training 3D molecules through local structures, despite the base model being a straightforward extension of TokenGT enhanced with 3D coordinates."
                },
                "weaknesses": {
                    "value": "1. The base model's simple strategy of appending 3D features to token embeddings may compromise the essential equivariance of 3D molecules.\n\n2. The description of the training objective section lacks clarity. I have outlined specific inquiries in the subsequent Questions.\n\n3. Given that the model is training on the reconstruction of molecular conformations, it would be beneficial to disclose the reconstruction accuracy on the pretraining dataset to demonstrate the model's learning efficacy.\n\n4. The experimental comparisons should encompass additional 3D molecular datasets such as QM9 and GEOM-drug, considering the model's pretraining on 3D structures. Nonetheless, the paper confines its reporting to the OGBLSC-PCQM4Mv2 dataset and the observed performance significantly lags behind SOTA methods. The explanation provided for this underperformance does not sufficiently account for these results.\n\n5. The layout of the paper requires revision. The Algorithm should be positioned before page 10 or on a separate page designated as an appendix, rather than following the references on page 12."
                },
                "questions": {
                    "value": "1. What exactly constitutes the input for TokenGT-3D? Is it the original molecules, or do you utilize each local structure segmentation after masking and perturbation? Or is it the masked and perturbed local structure segmentations of a single molecule, or something else entirely?\n\n2. Given the proposed method centers on pre-trained representation learning, what form do the learned representation embeddings take for downstream tasks?\n\n3. Could you elaborate on how the local structures are reconstructed? What serves as the input for this process: a single embedding from the TokenGT-3D output, or a collection of embeddings from local structure segmentations within a single molecule?"
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "3: reject, not good enough"
                },
                "confidence": {
                    "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 4,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission9430/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698914595039,
            "cdate": 1698914595039,
            "tmdate": 1699637187620,
            "mdate": 1699637187620,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "6vQ13314WL",
                "forum": "rEQ8OiBxbZ",
                "replyto": "AP19rMVi04",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission9430/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission9430/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Response to Reviewer VdE4"
                    },
                    "comment": {
                        "value": "We sincerely thank you for the valuable remarks that help us better examine our work. To address your concern, we present the following responses.\n\n>   **Q1**: **What exactly constitutes the input for TokenGT-3D?** Is it the original molecules, or do you utilize each local structure segmentation after masking and perturbation? Or is it the masked and perturbed local structure segmentations of a single molecule, or something else entirely?\n\n**Response:** During pretraining, TokenGT-3D still take node and edge tokens, i.e. the original molecules as the input, as is shown in Figure 3 on page 4. The attribute mask and coordinate noise at perturbation stage are implemented token-wise during perturbation. Afterwards, the model takes both clean and perturbed tokens of the original molecule as the input; the segmentation on molecular conformations does not function as a 3D tokenizer. \n\n>   **Q2**: Given the proposed method centers on pre-trained representation learning, **what form do the learned representation embeddings take for downstream tasks**?\n\n**Response**:  A $[\\texttt{CLS}]$ token is concatnated after the augmented node and edge embedding before the forward process of the Transformer encoder and serve as the graph representation for downstream tasks. This BERT-style method follows the implementation in the original TokenGT.\n\n>   **Q3**: Could you elaborate on **how the local structures are reconstructed**? What serves as the input for this process: a single embedding from the TokenGT-3D output, or a collection of embeddings from local structure segmentations within a single molecule?\n\n**Response**: Thanks for your feedback. To better illustrate the local structure reconstruction procedure, we have revised the paper to reposition Algorithm 1 within the methodology section. As is previously stated in Q1, the model takes both clean and perturbed tokens as input, producing an embedding $\\mathbf{Emb}$ in shape $[n+m,dim]$. During pretraining, we utilize three separate mask indicators -- $M_\\text{center}, M_\\text{edge},M_\\text{leaf}$ -- for center atoms, edges and leaf atoms within the whole molecule. For reconstruction, the central atom embeddings, $\\mathbf{Emb}[M_\\text{center}]$, are fed into a specialized head to predict global orientation. Likewise, edge embeddings $\\mathbf{Emb}[M_\\text{edge}]$ and leaf node embeddings $\\mathbf{Emb}[M_\\text{leaf}]$are input into dedicated modules for reconstructing edge lengths and angles, respectively."
                    }
                },
                "number": 5,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission9430/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700739628195,
                "cdate": 1700739628195,
                "tmdate": 1700739628195,
                "mdate": 1700739628195,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    }
]