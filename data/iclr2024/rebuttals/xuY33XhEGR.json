[
    {
        "title": "ClimODE: Climate Forecasting With Physics-informed Neural ODEs"
    },
    {
        "review": {
            "id": "O5MM810kb5",
            "forum": "xuY33XhEGR",
            "replyto": "xuY33XhEGR",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission7174/Reviewer_MKLC"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission7174/Reviewer_MKLC"
            ],
            "content": {
                "summary": {
                    "value": "ClimODE aims to improve climate prediction by integrating physical principles into a neural ordinary differential equation (ODE) framework. Unlike traditional black-box models, ClimODE incorporates the concept of advection from statistical mechanics, ensuring that the model considers the spatial movement of weather quantities over time. The model employs neural ODEs to model the weather evolution with value-conserving dynamics. The architecture includes components for local convolutions and global attention, allowing it to capture both local and global weather influences. ClimODE also addresses uncertainty in predictions and source variations through a probabilistic emission model. This feature allows the model to quantify prediction uncertainties and adapt to various source variations. ClimODE is reported to outperform existing data-driven methods in global and regional forecasting."
                },
                "soundness": {
                    "value": "4 excellent"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "3 good"
                },
                "strengths": {
                    "value": "1. Physics-Informed Modeling: ClimODE incorporates physical principles, ensuring that the model aligns with our first-principle understanding of the meteorological dynamics. ClimODE follows the partial differential continuity equation and solves a latent equation in such a form, and this makes both the physical insights and model training easier to understand and follow. Because of the use of Neural ODE, the prediction would be continuous in spacetime. I like the cute and nice idea.\n\n2. Model Design: The use of both local convolutions and global attention allows the model to capture a wide range of influences on weather patterns, enhancing its predictive capabilities with both locality inductive bias and long-term interaction capability. The model\u2019s ability to quantify uncertainty and/or model source variation is an additional advantage, making its forecasts more reliable and comprehensive (like a latent force). The spatio-temporal embedding also gives the model extra power to reflect the geographical differences with spatial-temporal variation, which makes a lot of sense.\n\n3. Performance and Efficiency: ClimODE achieves superior performance over some existing deep learning weather forecasting models, with an order of magnitude smaller parameterization, making it computationally efficient. \n\n4. Presentation: Very clear description of initial condition modeling, PDE to ODE modeling, Advection and Flow Velocity modeling, etc."
                },
                "weaknesses": {
                    "value": "1. Limited Performance and Comparison: The proposed model, although surpasses vanilla Neural ODE and ClimaX, still cannot compete with IFS (ECMWF NWP), let alone bigger models such as FourCastNet and Pangu-Weather that have already reported better results than NWP. There lacks enough comparison to other models in general, such as Adaptive Fourier Neural Operator (practiced by FourcastNet), previous weather forecasting methods like [1, 2], even models for similar tasks such as spatio-temporal traffic forecasting or video forecasting, etc. Comparison to Neural ODE is more of an ablation study and ClimaX is a weak baseline marginally better than ResNet. Comparing only with ClimaX is definitely not convincing enough. \n\n2. Limited Physical Complexity: The partial differential continuity equation is indeed a fundamental concept in fluid dynamics as it describes how quantities such as mass, moisture, or energy are transported and conserved in the atmosphere over time and space. What makes it less predictive in the real world is that this equation comes with assumptions such as the homogeneity and isotropy of the fluid. In cases where these assumptions are violated, the equation might not hold perfectly. I am not certain whether relying too much on this physical equation would be optimal for modeling the complex dynamics of weather, especially in finer-granular resolution with more weather factors and potentially larger noises. \n\n3. Limited Physical Understanding: In all, the partial differential continuity equation is a general-form conservation equation rather than any specific equations explaining each weather factor. Other than that, because neural ODE is essentially still a black-box model due to using neural network, it remains hard to know, for example, the relationships and the interactions between different weather variables. \n\n[1] Yan Han, Lihua Mi, Lian Shen, CS Cai, Yuchen Liu, Kai Li, and Guoji Xu. A short-term wind speed prediction method utilizing novel hybrid deep learning algorithms to correct numerical weather forecasting. Applied Energy, 312:118777, 2022.\n[2] Xiaoying Yang, Shuai Yang, Mou Leong Tan, Hengyang Pan, Hongliang Zhang, Guoqing Wang, Ruimin He, and Zimeng Wang. Correcting the bias of daily satellite precipitation estimates in tropical regions using deep neural network. Journal of Hydrology, 608:127656, 2022."
                },
                "questions": {
                    "value": "If the several ideas behind ClimODE is effective as suggested by the ablation study, I would really be interested to see its performance in a large model compared to Pangu or FourcastNet, for example. Those benchmarks are exceptional since they excel NWP results in many cases and have been tested/used even for recent disaster predictions. It is just like the LLM that, if it becomes powerful enough, everyone will be amazed and will use it. If the ultimate goal of this paper is to propose a strong SOTA model against existing models, it is strongly recommended to compare with those large models and consider adapting to this line in the future research. \n\nSince the paper mentions efficiency, I wonder how does the model perform with more parameters. Would the performance increase? Or, it is more like a nice small model to save us from excessive computational burden?\n\nAre there any reasons why ClimODE performs worse than ClimaX in t2m? \n\nHow does the model perform with long-term prediction, say, for 7 days or 14 days? The authors mention the emission source model as a strong inductive bias that prevents long-horizon forecast collapses and it seems to work based on the ablation study, so I wonder that."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "8: accept, good paper"
                },
                "confidence": {
                    "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
                },
                "code_of_conduct": {
                    "value": "Yes"
                },
                "first_time_reviewer": {
                    "readers": [
                        "ICLR.cc/2024/Conference/Program_Chairs",
                        "ICLR.cc/2024/Conference/Submission7174/Senior_Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission7174/Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission7174/Reviewer_MKLC"
                    ]
                }
            },
            "number": 1,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission7174/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1697525992468,
            "cdate": 1697525992468,
            "tmdate": 1700155629899,
            "mdate": 1700155629899,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "ksJO8cPNB9",
                "forum": "xuY33XhEGR",
                "replyto": "O5MM810kb5",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission7174/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission7174/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Response"
                    },
                    "comment": {
                        "value": "Thank you very much for many excellent suggestions! We have acted on all of these, and additionally, address all your questions and comments below.\n\n> Limited Performance and Comparison: The proposed model, although surpasses vanilla Neural ODE and ClimaX, still cannot compete with IFS (ECMWF NWP), let alone bigger models such as FourCastNet and Pangu-Weather that have already reported better results than NWP. There lacks enough comparison to other models in general, such as Adaptive Fourier Neural Operator (practiced by FourcastNet), previous weather forecasting methods like [1, 2], even models for similar tasks such as spatio-temporal traffic forecasting or video forecasting, etc. Comparison to Neural ODE is more of an ablation study and ClimaX is a weak baseline marginally better than ResNet. Comparing only with ClimaX is definitely not convincing enough.\n\n**Comparison with FourCastNet.** Thank you for the suggestion. We could not compare to PanguWeather (no public code, model files do not support our data resolution) or GraphCast (public repository seemed incomplete). However, we include an additional experiment compared to FourCastNet. To have comparable results, we re-trained the FourCastNet on our dataset and used their recommended training regime and hyperparameters. \n\nOur results reinforce the efficacy of ClimODE. We note that our method is more accurate in terms of RMSE (in fact, quite significantly especially for the geopolitical variable z) and largely competitive in terms of ACC. We will include these results in the paper.\n\n|          |                   | RMSE        |                        | ACC         |          |\n|----------|-------------------|-------------|------------------------|-------------|----------|\n| Variable | Lead Time (hours) | FourCastNet | ClimODE                | FourCastNet | ClimODE  |\n| z        | 6                 | 149.4       | **102.9**   $\\pm$ 9.3 | 0.73        | 0.99     |\n|          | 12                | 217.8       | **134.8**   $\\pm$ 12.3     | 0.58        | 0.99     |\n|          | 18                | 275.0       | **162.7**   $\\pm$ 14.4     | 0.58        | 0.98     |\n|          | 24                | 333.0       | **193.4**   $\\pm$ 16.3     | 0.58        | 0.98     |\n| t        | 6                | 1.18        | **1.16**   $\\pm$ 0.06      | 0.99        | 0.97     |\n|          | 12               | 1.47        | **1.32**   $\\pm$ 0.13      | 0.99        | 0.96     |\n|          | 18               | 1.65        | **1.47**   $\\pm$ 0.16      | 0.99        | 0.96     |\n|          | 24               | 1.83        | **1.55**   $\\pm$ 0.18      | 0.99        | 0.95     |\n| t2m        | 6                | 1.28        | **1.21**   $\\pm$ 0.09      | 0.99        | 0.97     |\n|          | 12               | 1.48        | **1.45**   $\\pm$ 0.10      | 0.99        | 0.96     |\n|          | 18               | 1.61        | **1.43**   $\\pm$ 0.09      | 0.99        | 0.96     |\n|          | 24               | 1.68        | **1.40**   $\\pm$ 0.09      | 0.99        | 0.96     |\n| u10        | 6                | 1.47        | **1.41**   $\\pm$ 0.07      | 0.93        | 0.91     |\n|          | 12               | 1.89        | **1.81**   $\\pm$ 0.09      | 0.91        | 0.89     |\n|          | 18               | 2.05        | **1.97**   $\\pm$ 0.11      | 0.89        | 0.88     |\n|          | 24               | 2.33        | **2.01**   $\\pm$ 0.10      | 0.89        | 0.87     |\n| v10        | 6                | 1.54        | **1.53**   $\\pm$ 0.08      | 0.95        | 0.92     |\n|          | 12               | 1.81        | 1.81   $\\pm$ 0.12      | 0.91        | 0.89     |\n|          | 18               | 2.11        | **1.96**   $\\pm$ 0.16      | 0.88        | 0.88     |\n|          | 24               | 2.39        | **2.04**   $\\pm$ 0.10      | 0.85        | 0.86     |"
                    }
                },
                "number": 7,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission7174/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700124617432,
                "cdate": 1700124617432,
                "tmdate": 1700124617432,
                "mdate": 1700124617432,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "RjQa1slbO5",
                "forum": "xuY33XhEGR",
                "replyto": "O5MM810kb5",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission7174/Reviewer_MKLC"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission7174/Reviewer_MKLC"
                ],
                "content": {
                    "title": {
                        "value": "Official Reply"
                    },
                    "comment": {
                        "value": "Thanks for the update. Yes, I totally agree upon the motivation to incorporate physical mechanism. The comparison with FourcastNet seems very promising. Based on that, I would love to raise my score. It seems that when predicting steps increase, the performance drops to a level closer to ClimaX, so the long-term prediction could be less effective."
                    }
                },
                "number": 10,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission7174/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700155558930,
                "cdate": 1700155558930,
                "tmdate": 1700155611748,
                "mdate": 1700155611748,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "i9e6vF7N6b",
            "forum": "xuY33XhEGR",
            "replyto": "xuY33XhEGR",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission7174/Reviewer_THXC"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission7174/Reviewer_THXC"
            ],
            "content": {
                "summary": {
                    "value": "The authors present ClimODE, a new method for weather forecasting that provides uncertainty esimates, benchmarked on ERA5 data from WeatherBench. This method is based on first principles from physics, namely the *continuity equation* which mathematically formulates that in a system, quantities are conserved (modulo any sources/sinks). Neural ODEs are used to model the continuity PDE and the flow velocity is parametrized using a neural net that has two components: A CNN that models local interactions and an attention mechanism that model long-range interactions. Furthermore, an emission model is added on top that serves to estimate first and second order moments of the true underlying solution (bias and uncertainty). \n\nClimODE greatly outperforms the baseline NODE which doesn't take into account the physical principles of advection nor does it correct its solution by the proposed emisison models, moreover, ClimODE also outperform ClimaX, one of the recent state-of-the-art weather forecasting models on the regridded 5.625 \u00b0 ERA5 data.\n\nFinally, strong ablation study results are shown that indicate the important role of taking into account the underlying physical principles as well as the emission model."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "4 excellent"
                },
                "contribution": {
                    "value": "4 excellent"
                },
                "strengths": {
                    "value": "- Proposed method that is based on first principles from physics and provides interpretability of the solution: i.e. explicit transport, compression and flow velocity terms.\n- Provides efficient uncertainty estimation by learning the bias and the standard deviation, unlike previous methods that have to rely on ensembling which is computationally intensive.\n- Simple model, but still manages to outperform ClimaX which would make this method not only a strong baseline for future work but also a method to quickly iterate on and improve.\n- Strong ablation studies demonstrating the design choices made by ClimODE over NODE as well as the effect of the emission model."
                },
                "weaknesses": {
                    "value": "- \"Closed system assumption implies value-preserving manifold\" is unclear and needs more justification. While the conclusion that: $$\\mathbb{E}_x[u_k(\\mathbf{x},t)]=\\text{const.}$$\n\nsounds intuitive, it's not justified rigourously. The expectation is taken with respect to which density? I would expect the quantity to be preserved would be $\\int_{\\Omega} u_k(\\mathbf{x},t)dV$, since that's the total quantity over the whole \"volume\" you're considering which should be preserved (e.g. when $u_k=\\rho$, the integral over the volume becomes the mass). In any case, since this is a Machine Learning submission, it would be better if this part is thoroughly justified. \n\n- Benchmark only up to 36 hours while state-of-the-art methods reported results for up to 10 days ahead. The paper would be better if it reported results for at least five or seven days ahead.\n- Authors mention that other deep learning methods lacked open-source code, while that's true for PanguWeather (who only provide a pseudo-code \"implementation\"), it's not for the others:\n    - FourCastNet: https://github.com/NVlabs/FourCastNet\n    - GraphCast: https://github.com/google-deepmind/graphcast\n\n Given that GraphCast seem to outperform ClimaX, it would have been good to compare against it as well and also FourCastNet since it's one of the first papers to perform weather forecasting on such a scale.\n- Authors claim that the vaue-preserving manifold (that emanates from the closed system assumption), presents a strong inductive bias for long-term forecasts, yet, using Euler scheme to solve the ODE is known to be unstable and it'll especially not conserve the quantity we want preserved, so that inductive bias is no longer enforced. It would be better to include that limitation in the paper and acknowledge that while it is a strong inductive bias, it's hard to enforce in practice. This is further seen from Table 2 which shows that the error does increase dramatically with lead time and that suggests that ClimODE is better at inferring the true physics but not in mitigating the error propagation in long-term forecasts.\n- While Figure 6 shows qualitatively the soundness of the predicted bias and variance, there's no quantitative approach that evaluates the quality of the bias and variance output by the model. A metric like CRPS (Continuous Ranked Probability Score) can showcase that."
                },
                "questions": {
                    "value": "- Table 1 says that NowCastNet doesn't provide uncertainty estimation, but it's a generative model which can provide such estimates and in general approximate the true underlying distribution.\n- In section 3.2, it's unclear why $\\mathbf{\\dot{v}}_k(\\mathbf{x}, t) = \\ddot{u}_k(x,t)$, especially when $\\ddot{u}_k(x,t)$ is not a vector.\n- In section 3.6, how is $\\tilde{\\dot{u}}(t_0)$ numerically apprixmated from past states?\n- Why not use different time-resolutions for solving the ODE and assessing their effect? Same goes for the ODE-solver. Given that you state that Runge-Kutta can be used with a low computational cost, it would add more quality to the paper overall if you include it as well.\n- How long does it take to train?\n- Lacks training details for ClimaX as well as the training runtimes and number of GPUs used for ClimaX."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "8: accept, good paper"
                },
                "confidence": {
                    "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
                },
                "code_of_conduct": {
                    "value": "Yes"
                },
                "first_time_reviewer": {
                    "value": "Yes",
                    "readers": [
                        "ICLR.cc/2024/Conference/Program_Chairs",
                        "ICLR.cc/2024/Conference/Submission7174/Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission7174/Reviewer_THXC",
                        "ICLR.cc/2024/Conference/Submission7174/Senior_Area_Chairs"
                    ]
                }
            },
            "number": 2,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission7174/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698159442413,
            "cdate": 1698159442413,
            "tmdate": 1700231137726,
            "mdate": 1700231137726,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "joJEBCNUZ5",
                "forum": "xuY33XhEGR",
                "replyto": "i9e6vF7N6b",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission7174/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission7174/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Response"
                    },
                    "comment": {
                        "value": "Thanks so much for your thoughtful comments and excellent suggestions! We've acted on all of them, and also address all your concerns, as we describe below.\n\n> \"Closed system assumption implies value-preserving manifold\" is unclear and needs more justification. While the conclusion sounds intuitive, it's not justified rigorously. The expectation is taken with respect to which density? I would expect the quantity to be preserved would be $\\int_{\\Omega} u_{k}(x,t)dV$, since that's the total quantity over the whole \"volume\" you're considering which should be preserved (e.g. when the integral over the volume becomes the mass). In any case, since this is a Machine Learning submission, it would be better if this part is thoroughly justified.\n\nThanks for pointing this out. Indeed, our expectation notation is imprecise, and we should have written a spatial integral $\\int u_k(\\mathbf{x},t) d\\mathbf{x}$ as you suggest. We will fix this in the paper. We also analysed our model, and found out that the total spatial value is practically constant over time over the ODE forward solver (it shows a flat line over time). We will include this plot in the appendix.\n\nPlot: https://postimg.cc/w709xD9n\n\n> Benchmark only up to 36 hours while state-of-the-art methods reported results for up to 10 days ahead. The paper would be better if it reported results for at least five or seven days ahead.\n\n**Benchmarking with longer lead times.** Many thanks for the suggestion. Based on your feedback, we conducted additional experiments. We show below in the table the RMSE and ACC results for 6-day lead time, and also include 3-day prediction as a reference. We  also include ClimaX predictions for comparison. These results show that temperature and potential (t,t2m,z) are relatively stable over longer forecasts, while the wind direction (u10,v10) becomes unreliable over longer times. We note that while ClimaX is also remarkably stable over long predictions, it has lower performance compared to ClimODE. We will include this table in the appendix.\n\n\n|          |                   | RMSE        |                        | ACC         |          |\n|----------|-------------------|-------------|------------------------|-------------|----------|\n| Variable | Lead Time (hours)   | ClimaX | ClimODE | ClimaX | ClimODE |\n| z  | 72| 687.0  | 478.7   $\\pm$ 48.3    | 0.73 | 0.88   |\n|    | 144| 801.9  | 783.6   $\\pm$ 37.3   | 0.58  | 0.61   |\n| t  | 72| 3.17 | 2.58   $\\pm$ 0.16    | 0.76 | 0.85   |\n|    | 144| 3.97  | 3.62   $\\pm$ 0.21   | 0.69  | 0.77   |\n| t2m  | 72| 2.87 | 2.75   $\\pm$ 0.49    | 0.83 | 0.85   |\n|    | 144| 3.38  | 3.30   $\\pm$ 0.23   | 0.83  | 0.79   |\n| u10 | 72| 3.70 | 3.19   $\\pm$ 0.18    | 0.45 | 0.66   |\n|    | 144| 4.24  | 4.02   $\\pm$ 0.12   | 0.30  | 0.35   |\n| u10 | 72| 3.80 | 3.80   $\\pm$ 0.22    | 0.39 | 0.63   |\n|    | 144| 4.42  | 4.42   $\\pm$ 0.10   | 0.25  | 0.32   |\n\n\n> Authors claim that the value-preserving manifold (that emanates from the closed system assumption), presents a strong inductive bias for long-term forecasts, yet, using Euler scheme to solve the ODE is known to be unstable and it'll especially not conserve the quantity we want preserved, so that inductive bias is no longer enforced. It would be better to include that limitation in the paper and acknowledge that while it is a strong inductive bias, it's hard to enforce in practice. This is further seen from Table 2 which shows that the error does increase dramatically with lead time and that suggests that ClimODE is better at inferring the true physics but not in mitigating the error propagation in long-term forecasts.\n\nThanks for pointing this out. To empirically study this, we analysed how our current model retains the mass-conservation assumption and computed the integrals $I_{k,t} = \\int u_k(\\mathbf{x},t)d\\mathbf{x}$ over time and quantities. We found out that the value is constant over time up to order of $10^{-12}$. Plot link: https://postimg.cc/w709xD9n\n\nThus it seems that our choice of second-order ODE with Euler with 1 hour increment is a good compromise in terms of accuracy and efficiency, but we agree that higher precision solvers should be preferred. We hypothesise that Euler is sufficient since our dynamics are relatively smooth (eg. Fig 6): the dynamics $\\dot{u}_k$ largely models the spatiotemporal trends in climate, while we offload the day-night fluctuations to the instantaneous emission model."
                    }
                },
                "number": 4,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission7174/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700123809138,
                "cdate": 1700123809138,
                "tmdate": 1700123809138,
                "mdate": 1700123809138,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "ZXKBEqSCvN",
                "forum": "xuY33XhEGR",
                "replyto": "W6wgJja2ZR",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission7174/Reviewer_THXC"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission7174/Reviewer_THXC"
                ],
                "content": {
                    "comment": {
                        "value": "I thank the authors for their response and for the additional experiments. Most of my main points have been addressed, although, I would have still liked to see the CRPS for at least NowCastNet even though they require multiple forward passes to get uncertainty estimations.\n\nOverall, I find, with these additional experiments and clarifications that the quality of the paper will be greatly improved and thus I am updating my score to reflect that."
                    }
                },
                "number": 11,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission7174/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700231115368,
                "cdate": 1700231115368,
                "tmdate": 1700231115368,
                "mdate": 1700231115368,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "ansHBkgdok",
            "forum": "xuY33XhEGR",
            "replyto": "xuY33XhEGR",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission7174/Reviewer_K2uQ"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission7174/Reviewer_K2uQ"
            ],
            "content": {
                "summary": {
                    "value": "This paper proposes ClimODE, a novel climate modeling approach that leverages physics-based constraints. It represents climate dynamics as a continuous-time advection process governed by partial differential equations (PDEs). The PDEs are discretized into ODEs using the method of lines, with the velocity field modeled by a neural network integrating convolutions and attention. Gaussian emission models estimate the prediction uncertainties and source variations. Empirically, ClimODE outperforms existing data-driven methods in global and regional forecasting tasks, highlighting the efficacy of continuous-time physical constraints."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "4 excellent"
                },
                "contribution": {
                    "value": "3 good"
                },
                "strengths": {
                    "value": "1. **Physical Prior as the Foundation:** \n   The paper ingeniously grounds its methodology in the continuity equation, a well-established physical prior. This not only lends an elegant formulation but also ensures an interpretable and efficient model. The fair integration of this physical prior into the deep model showcases an exemplary fusion of the first principles with modern DL techniques.\n\n2. **Gaussian Emission Model:** \n   The adoption of the Gaussian as an emission model is both impressive and reasonable. It aptly addresses uncertainties and unknown sources in climate forecasting, offering a reasonable approach to handling the inherent unpredictability of the domain.\n\n3. **Experimentation and Insight:** \n   The experimental setup and investigation presented in the work are both rigorous and enlightening. The thoroughness of the research provides valuable insights and sets an easy-to-access benchmark for future endeavors in the field.\n\nAlso, the presentation is clear and easy to follow."
                },
                "weaknesses": {
                    "value": "1. For the model of FLOW VELOCITY (section 3.2), as we already know $\\dot{\\mathbf{v}}_k(\\mathrm{x}, t) = \\ddot{u}_k(\\mathrm{x}, t)$,   why we still need to parameterize it? Is it because the computation of $\\ddot{u}_k(\\mathrm{x}, t)$ is too costly? There are also many methods that could approximate $\\ddot{u}_k(\\mathrm{x}, t)$ based on $\\dot{u}_k(\\mathrm{x}, t)$. More discussion or claims are encouraged. \n\n2. The model treats the advection PDE as independent for each task or quantity. However, in the intricate tapestry of climate dynamics, various quantities are interdependent. For instance, wind patterns can influence temperature fluctuations.  The paper doesn't clearly illustrate how the proposed method addresses these inherent inter-correlations."
                },
                "questions": {
                    "value": "See weakness"
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "8: accept, good paper"
                },
                "confidence": {
                    "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 3,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission7174/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698769383414,
            "cdate": 1698769383414,
            "tmdate": 1699636850704,
            "mdate": 1699636850704,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "vznMJq4ems",
                "forum": "xuY33XhEGR",
                "replyto": "ansHBkgdok",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission7174/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission7174/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Response"
                    },
                    "comment": {
                        "value": "Many thanks for your constructive review. We address your concerns and incorporate your suggestions below. \n\n> For the model of FLOW VELOCITY (section 3.2), as we already know $\\dot{ \\mathbf{v}}_{k}(x,t)$ $=$ $\\ddot{u}_k (x,t)$\nwhy we still need to parameterize it? Is it because the computation of $\\ddot{u}_k (x,t)$ is too costly? There are also many methods that could be approximated. More discussion or claims are encouraged.\n\n**Need to parameterize the flow velocity.** Thank you for raising an excellent point. In an advection system the climate quantities $u(\\mathbf{x},t)$ are transported (moved and redistributed) around by a flow velocity $\\mathbf{v}(x,t)$, which is a vector field that points where the climate `mass' is moving. Given a known starting state $u$, the system evolution is fully determined by the velocity $\\mathbf{v}$ by solving eq (2) forward in time.\n\nThe velocity field function is generally unknown, and we thus learn it from data by parameterising the the velocity function as a neural network $\\mathbf{v}(\\mathbf{x},t | \\theta)$. We also note that the remark that $\\dot{\\mathbf{v}}_k = \\ddot{u}_k$ was a typo, and in general we cannot solve for $\\mathbf{v}$ by, e.g., interpolating the value $u$.  \n\nApologies for any confusion: we have fixed this typo and our model equations remain unaffected.\n\n> The model treats the advection PDE as independent for each task or quantity. However, in the intricate tapestry of climate dynamics, various quantities are interdependent. For instance, wind patterns can influence temperature fluctuations. The paper doesn't clearly illustrate how the proposed method addresses these inherent inter-correlations.\n\n**Explicating how ClimODE accounts for variable correlations.** This is another great point that we elucidate here. We present our equations for a single quantity $k$ at a time (for instance, equation (2)) because the convenient vector calculus notation $\\dot{u}_k - \\nabla \\cdot (u_k \\mathbf{v}_k)$ applies only to scalar $u$, and a `batch' version $\\dot{\\mathbf{u}}$ does not admit elegant notation. Nevertheless, our model is still able to consider the entire state vector $\\mathbf{u} = (u_1, \\ldots, u_K)$ at the same time, and all $K=5$ climate quantities are affected by each other. This can be seen in equation (4), where the velocity change $\\dot{\\mathbf{v}}_k = f( \\mathbf{u}, \\ldots)$ of quantity $k$ depends on all state variables, and thus subsequently $\\dot{u}_k$ also depends on all state variables. Thus, for instance, wind can affect temperature and vice versa.\n\nTo demonstrate the emerging couplings of quantities (ie. wind, temperature, pressure potential), we plot below the emission model  $\\mathbf{u}^{\\mathrm{pred}}(\\mathbf{x},t) \\in \\mathbb{R}^5$ pairwise densities averaged over space $\\mathbf{x}$ and time $t$. These effectively capture the correlations between quantities in the simulated weather states. For example, these densities reveal that temperatures (t,t2m) and potential (z) are highly correlated and bimodal; the horizontal and vertical wind directions are independent (u10,v10); and there is little dependency between the two groups. We will include these plots in the appendix.\n\nPlot: https://postimg.cc/0McVK5r5\n\nAgain, thank you so much for your extremely constructive feedback. We hope we have sufficiently addressed your concerns, and would appreciate your stronger support for this paper."
                    }
                },
                "number": 3,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission7174/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700123505572,
                "cdate": 1700123505572,
                "tmdate": 1700123505572,
                "mdate": 1700123505572,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "aqaf6R1VQ5",
                "forum": "xuY33XhEGR",
                "replyto": "vznMJq4ems",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission7174/Reviewer_K2uQ"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission7174/Reviewer_K2uQ"
                ],
                "content": {
                    "comment": {
                        "value": "Thanks for the authors' retailed response. It resolved my concerns and I still strongly support this great work."
                    }
                },
                "number": 12,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission7174/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700442319664,
                "cdate": 1700442319664,
                "tmdate": 1700442319664,
                "mdate": 1700442319664,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "SVh6838jQy",
            "forum": "xuY33XhEGR",
            "replyto": "xuY33XhEGR",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission7174/Reviewer_F1k5"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission7174/Reviewer_F1k5"
            ],
            "content": {
                "summary": {
                    "value": "This paper introduces ClimODE, a neural ODE combining a convolutional local mechanism and a global attention mechanism to predict one timestep of weather evolution. It uses ERA5 data from WeatherBench 1 and compares it to ClimaX model and against a standard Neural ODE."
                },
                "soundness": {
                    "value": "4 excellent"
                },
                "presentation": {
                    "value": "4 excellent"
                },
                "contribution": {
                    "value": "3 good"
                },
                "strengths": {
                    "value": "Originality\n- First NeuralODE work applied to this problem\n- Extending Neural ODEs to be more effective for the specific climate problem\n\nQuality\n- High-quality writing, figures\n- Using relevant, real-world data for evaluation\n\nClarity\n- Written well and understandable\n- Detailed explanations\n\nSignificance\n- Satisfies the need for ML climate models to be value-conserving and have a probabilistic forecast\n- Contributes towards faster climate and weather modeling, potentially using less computational resources"
                },
                "weaknesses": {
                    "value": "- A couple of Figures (e.g Figure 5) would benefit from a longer caption/description\n- Not comparing against state-of-the-art methods, such as GraphCast\n- It should be compared against pre-trained ClimaX or other methods that don't require pre-training"
                },
                "questions": {
                    "value": "1. What do you mean by one-shot GAN referring to Ravuri et al., 2021? Is there any pre-training involved\n2. There is Weatherbench 2 available now, maybe to recent to be included in this submission, but should be mentioned in future work: https://arxiv.org/abs/2308.15560, https://sites.research.google/weatherbench/\n3. Are any of the competing methods such as GraphCast, PanguWeather, FourCastNet that now available?\n4. Is the comparison against ClimaX fair? The main idea of ClimaX is to use pre-training, but you state you use all methods without pertaining\n5. The statement \"IFS is still far ahead of any deep learning method\" doesn't really hold anymore, e.g.: https://arxiv.org/pdf/2307.10128.pdf\n6. Kreislers GNN work should be mentioned here as well: https://arxiv.org/pdf/2202.07575.pdf\n7. This work could be useful too: https://arxiv.org/pdf/2304.04664.pdf"
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "8: accept, good paper"
                },
                "confidence": {
                    "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                },
                "first_time_reviewer": {
                    "value": "Yes",
                    "readers": [
                        "ICLR.cc/2024/Conference/Program_Chairs",
                        "ICLR.cc/2024/Conference/Submission7174/Senior_Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission7174/Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission7174/Reviewer_F1k5"
                    ]
                }
            },
            "number": 4,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission7174/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698771148272,
            "cdate": 1698771148272,
            "tmdate": 1699636850596,
            "mdate": 1699636850596,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "yvhF9RjliR",
                "forum": "xuY33XhEGR",
                "replyto": "SVh6838jQy",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission7174/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission7174/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Response"
                    },
                    "comment": {
                        "value": "Many thanks for your thoughtful feedback and suggestions. We address all your comments below. \n\n##  Weaknesses:\n\n> A couple of Figures (e.g Figure 5) would benefit from a longer caption/description\n\nThanks for the feedback. We will add more details to the captions of fig 3 (the pipeline), fig 5 (ODE ablations) and fig 6 (emissions over time) to make them more descriptive. For instance, fig 5 caption will be expanded to \n\n**The effect of including different ClimODE components on RMSE**. An ablation showing how enhancing the vanilla neural ODE (blue) incrementally with advection (orange), global attention (green) and emission (red) leads to progressively better RMSE scores. We note that that advection yields most improvement in accuracy, while attention turns out to be the least important.\n\n\n##  Questions:\n\n> What do you mean by one-shot GAN referring to Ravuri et al., 2021? Is there any pre-training involved\n\nRavuri et al., 2021 propose a GAN framework to model weather prediction as a density estimation problem, where the network learns to predict the weather state at a fixed increment in time. One-shot emphasizes that their model does not unroll the weather state forward in multiple short time steps, instead taking a single leap. They do not perform pre-training and demonstrate their method by modeling precipitation over local regions.\n\n> There is Weatherbench 2 available now, maybe to recent to be included in this submission, but should be mentioned in future work: https://arxiv.org/abs/2308.15560, https://sites.research.google/weatherbench/\n\nMany thanks for the reference. We will include a citation and position appropriately in the paper. \n\n\n> Is the comparison against ClimaX fair? The main idea of ClimaX is to use pre-training, but you state you use all methods without pertaining\n\nThank you for the opportunity to clarify this. We trained the ClimaX model from scratch using the same dataset as for ClimODE without pre-training to compare how much signal the two methods are able to extract from the same data. Comparing to pre-trained ClimaX would mean comparing to a model that has seen much more data than us, which would give unfair advantage to ClimaX. We acknowledge that pretraining can be effective for a practical weather predictor, and are very keen to leverage pre-training in future with larger scale implementations of our advection ODE model.\n\n\n> The statement \"IFS is still far ahead of any deep learning method\" doesn't really hold anymore, e.g.: https://arxiv.org/pdf/2307.10128.pdf, Kreislers GNN work should be mentioned here as well:https://arxiv.org/pdf/2202.07575.pdf\n\nThank you very much for these  references. We will add these and update our statements about IFS."
                    }
                },
                "number": 1,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission7174/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700122920998,
                "cdate": 1700122920998,
                "tmdate": 1700122920998,
                "mdate": 1700122920998,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    }
]