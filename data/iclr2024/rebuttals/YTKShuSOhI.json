[
    {
        "title": "Demonstrating the capacity of a Path-Based variational inference formulation for robust hidden Markov modelling of complex and noisy binary trees"
    },
    {
        "review": {
            "id": "Bp51Gziz0J",
            "forum": "YTKShuSOhI",
            "replyto": "YTKShuSOhI",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission6037/Reviewer_1unB"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission6037/Reviewer_1unB"
            ],
            "content": {
                "summary": {
                    "value": "The paper explores a so-called paths-of-bifurcations approach to modelling tree structures with Hidden Markov Models (HMMs). Treating each bifurcation as a node and path from root to leaf in the tree as a sequences of nodes on path to be modelled by the HMM. The approach is evaluated in its ability to infer properties of synthetic trees generated using a procedural modelling approach developed for the purpose as well as human airway trees extracted from a public medical dataset."
                },
                "soundness": {
                    "value": "4 excellent"
                },
                "presentation": {
                    "value": "2 fair"
                },
                "contribution": {
                    "value": "3 good"
                },
                "strengths": {
                    "value": "- Generative modelling of tree structures is an important problem and is relevant.\n\n- Novelty appear to be reasonably clearly described, and described as contributions covering the paths-of-bifurcations approach, which is an original idea as far as I know, a procedural approach to synthetic tree generation, and the practical application to human airway trees.\n\n- Language, grammar and structure is of high quality.\n\n- The path-of-bifurcations concept is an interesting approach to modelling tree structures with HMM sequential modelling and appears to be novel.\n\n- Code appears to be available, which should make the results easier to reproduce."
                },
                "weaknesses": {
                    "value": "- I found the manuscript to be a relatively hard read. Methodological and implementation details are often not explained or reasoned about and there are many of them, moreover, figures and tables are too full of details. I would suggest this is a presentation problem, not all numbers and methodological details are equally important, and I feel like the authors could have made more of an effort in summarizing and selecting the important aspects. I believe this could make the work more interesting.\n\n- Almost all tables and figures are not readable except in very enlarged versions. Could they perhaps be changed and/or resized to be readable at reasonable magnification/print size?"
                },
                "questions": {
                    "value": "- Could some intuition or reasoning be provided for the specific employed priors and emission distributions?"
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "5: marginally below the acceptance threshold"
                },
                "confidence": {
                    "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 1,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission6037/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698787185597,
            "cdate": 1698787185597,
            "tmdate": 1699636649152,
            "mdate": 1699636649152,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "LtlFPQVDRN",
                "forum": "YTKShuSOhI",
                "replyto": "Bp51Gziz0J",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6037/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6037/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Response to review of Submission6037 by Reviewer 1unB"
                    },
                    "comment": {
                        "value": "We thank the reviewer for their detailed comments and suggestions. We appreciate your in-depth understanding of the novelty and originality of our work, as well as the importance of generative modeling frameworks for tree structures.\n\nWe greatly appreciate your feedback and provide detailed responses below, indicating modifications made to the revised manuscript. **Please note that we were granted an extension until December 1st because of a third review which was only made available to us yesterday, therefore the final manuscript may be further improved.**\n\n**[R2-1] I found the manuscript to be a relatively hard read. Methodological and implementation details are often not explained or reasoned about and there are many of them**\n\nWe appreciate this feedback and aimed to address your concerns as follows:\n\n- **Methodological Explanations:**  We have added details on the HMM model and spatial constraints design to Section 1 (Introduction); and Section 2.1.2 (Soft spatial constraints on termination of synthetic trees). \n- **Methodological Reasoning:** During development, we relied heavily on domain knowledge from our expert clinician co-author, who has > 10 years of experience in airway morphology, as well as medical literature, to ensure that our generative process includes all the variables and conditioning needed to yield high-fidelity synthetic airway trees. \n- **Implementation reasoning:**\n    - **Generative model implementation:** We relied on domain-knowledge (from expert clinician and medical literature) to design a generative model suitable for human airway trees. \n    - **Validation experiments:** Benchmarking experiments showcase key challenges that exist in binary tree-structured data observed in 3-D medical images e.g., CT modalities. We handle real-case scenarios with noisy observations.\n\n- **Implementation details:** We designed our implementation to integrate existing specialized open-source libraries.\n \n\n**[R2-2] \u2026, moreover, figures and tables are too full of details. I would suggest this is a presentation problem, not all numbers and methodological details are equally important, and I feel like the authors could have made more of an effort in summarizing and selecting the important aspects. I believe this could make the work more interesting. Almost all tables and figures are not readable except in very enlarged versions. Could they perhaps be changed and/or resized to be readable at reasonable magnification/print size?**\n\n- We appreciate this important constructive comment. We have taken extensive measures to improve data presentation and summarization throughout the paper and ensure that all tables and figures are now readable at print size, especially in Section 3 (Results and Discussion).\n-  We have added a section in Sup. D (Additional experimental results) for further details supporting the main paper.\n\n**[R2-3] Could some intuition or reasoning be provided for the specific employed priors and emission distributions?**\n\n- Our choice for the employed priors and emission distributions is based on previous literature [1,2, 3] and medical expert supervision during development to confirm fidelity of generated trees (as in **[R2-1]**).\n- We have added argumentation supporting our choice of priors in Section 1 (Introduction), Section 2.1.2 (Soft spatial constraints on termination of synthetic trees), and Section 2.3 (Inference).\n\n**References:**\n\n[1] Metzger RJ, Klein OD, Martin GR, Krasnow MA. The branching programme of mouse lung development. Nature. 2008;453(7196):745-50.\n\n[2] Abbasi Z, Boozarjomehry RB. Modeling of human conducting airways by stochastic parametric L-system. The European Physical Journal Plus. 2021;136(2):197. \n\n[3] Weibel ER, Cournand AF, Richards DW. Morphometry of the human lung. Berlin: Springer; 1963.\n\nOnce again, we sincerely thank the reviewer for the detailed, constructive comments and suggestions to improve our paper."
                    }
                },
                "number": 9,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6037/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700690849287,
                "cdate": 1700690849287,
                "tmdate": 1700690849287,
                "mdate": 1700690849287,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "J6wnSXeoRk",
            "forum": "YTKShuSOhI",
            "replyto": "YTKShuSOhI",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission6037/Reviewer_T8XB"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission6037/Reviewer_T8XB"
            ],
            "content": {
                "summary": {
                    "value": "The paper presentes a HMM approach to modeling binary trees. Approximate inference is performed using SVI in Pyro. The method is demonstrated on a broad array of synthetic data examples as well as a real human airways dataset."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "2 fair"
                },
                "contribution": {
                    "value": "1 poor"
                },
                "strengths": {
                    "value": "The proposed method is fairly simple, and builds on a well known methodology.\n\nStudies on simulated data help to illustrate the strenghts and limitations of the approach.\n\nSimple and effective models for tree structured data seem to be important for gaining statistical insights into important biological structures."
                },
                "weaknesses": {
                    "value": "There is no direct comparison with other competing approaches or baselines.\n\nThe technical novelty is limited.\n\nThe method could be more clearly described in the main paper, and variables/distributions could be more clearly defined."
                },
                "questions": {
                    "value": "\"Fast and scalable inference of a generative process governing such tree-structures is key for clas-\nsifying trees into categories.\" Are generative process modeling the prevalent approach to classification, or are there other (discriminative) approaches?\n\n\"...  and split trees into \u2018independent\u2019 paths of bifurcations ...\" why is independent in quotations?\n\nWould it be possible in the introduction to set up a more clear problem formulation so that is evident which types of data problem the paper addresses? For example, it is not clear whether the trees that are modelled have a graph-based or geometric representation, such as 3d coordinat-based or anatomical mesh representation.\n\nIf I understand correctly, emission probabilities for branching angles and roll are Gaussian. Is anything done to ensure that the first angle \"is the smallest angle by definition\" and that angles are within a suitable range?\n\nWould it be possible to provide some more details (possibly in the supplement) regarding the definitions of each term in the joint distribution (Eq. 1), such as a list with clear definitions of all variables and distributions.\n\nWhich variational distributions ('guide' in Pyro terminology) are used, and how important/sensitive is the choice?\n\nHave any other methods been used to model e.g. the human airways data? How does the proposed method perform in comparison?\n\nWhat would be the primary application of the proposed method?\n\nMinor issues: \nThere are a few typos etc. Examples from abstract and introduction:\n\"...prevalent multiple across fields...\" ?\nClosing parenthesis doubled \"))\" in a few citations.\n\"... and infer states...\" should be 'and infers states'\n\"... human airway trees segmented on CT images.\" unclear"
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "5: marginally below the acceptance threshold"
                },
                "confidence": {
                    "value": "2: You are willing to defend your assessment, but it is quite likely that you did not understand the central parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 2,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission6037/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698787461114,
            "cdate": 1698787461114,
            "tmdate": 1699636648978,
            "mdate": 1699636648978,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "lGhmAzLIG9",
                "forum": "YTKShuSOhI",
                "replyto": "J6wnSXeoRk",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6037/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6037/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Response to review of Submission6037 by Reviewer T8XB [Part 1/3]"
                    },
                    "comment": {
                        "value": "We thank the reviewer for their detailed comments and suggestions. \n\n- Thank you for recognizing the wide array of synthetic data examples used to illustrate the strengths and limitations of our proposed modeling approach, alongside our human airway dataset application. \n- We also appreciate your acknowledgement of the need for simple and effective models for tree structured data to gain more biological insights. \n\nWe have prepared a detailed response below and have extensively revised the manuscript to address your constructive comments and suggestions. **Please note that we were granted an extension until December 1st because of a third review which was only made available to us yesterday, therefore, the final manuscript may be further improved.**\n\n**[R1-1] There is no direct comparison with other competing approaches or baselines.**\n- The closest baseline for tree-HMMs modeling is cited in our paper as (Mohammadi et al., 2022) [1]. We tested this approach during our initial development but it did not work properly on our trees and the size of our dataset for the following reasons: CPU-implementation, design choices too domain specific (branching rules controlled by a genetically encoded subroutine). \n- We aim to simplify a specific modeling problem and integrate its implementation with open-source specialized libraries. Showing that this simplified modeling formulation provides correct and robust fits is our main goal. \n- In this context, we used synthetic benchmarking, a validation technique applied in studies such as that of Mohammadi et al. (2022) [1].\n- We develop this method in an academic setting, with limited computational resources, which limits our capacity to test complex models.  \n\n**[R1-2] The technical novelty is limited.**\n\nWe appreciate the reviewer's assessment regarding the novelty of our proposed method. We thank you for the opportunity to clarify the technical novelty of our work. \nWe argue that the technical innovation of our contribution lies primarily in the following three aspects: \n\n**(1) Technical novelty**: Our proposed \u201cpaths-of-bifurcations\u201d approximation is a novel approach, which raised several technical challenges: \n- Formulate the cost function on variables identified as needed and sufficient for an approximate variational inference to be able to recover ground truth parameters without accounting for the full tree structure; \n- Evaluation of quality of fits on real noisy binary tree-structured data observed in 3-D medical images; \n- Incorporate spatial constraints in the inference of HMM parameters; \n- Control optimization complexity with a limited number of model parameters;\n\n**(2) Increasing accessibility of complex methods**: We provide our code-implementation compatible with state-of-the-art sophisticated open-source packages, thus facilitating broader adoption of generative modeling for binary tree architectures. \n\n**(3) Robust validation on realistic synthetic data**: We include code to generate realistic airway trees based on previously-validated procedural models for readers to reproduce our results and further develop their own synthetic benchmarks (eg. to extend to botanics applications).\n\n**[R1-3] The method could be more clearly described in the main paper, and variables/distributions could be more clearly defined.**\n\n- The forms of HMM emission distributions, transition matrices, and start probabilities from Equations 1,2 are now detailed in Table 3 (Sup. B). We have also rephrased Section 2.1.1 (Generation of synthetic trees with hidden Markov modeling) for clarity.\n\n**[R1-4] \"Fast and scalable inference of a generative process governing such tree-structures is key for classifying trees into categories.\" Are generative process modeling the prevalent approach to classification, or are there other (discriminative) approaches?**\n\n- For 3-D binary trees, discriminative approaches are prevalent. We have now emphasized this point in Section 1 (Introduction). \n- Our approach is the first to fit a generative model to a large, real dataset of 3-D human airway trees. We cite three other tree-HMM inference methods. However, none of these provide fast scalable open-source inference pipelines nor designed to be applicable beyond their specific use-case domain.\n\n\n[1] Mohammadi F, Visagan S, Gross SM, Karginov L, Lagarde JC, Heiser LM, Meyer AS. A lineage tree-based hidden Markov model quantifies cellular heterogeneity and plasticity. Communications Biology. 2022;5(1):1258."
                    }
                },
                "number": 6,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6037/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700689061385,
                "cdate": 1700689061385,
                "tmdate": 1700689061385,
                "mdate": 1700689061385,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "GcolVYLJaS",
            "forum": "YTKShuSOhI",
            "replyto": "YTKShuSOhI",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission6037/Reviewer_xwzK"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission6037/Reviewer_xwzK"
            ],
            "content": {
                "summary": {
                    "value": "My sincere apologies, I posted the review of a different paper.\n\nThis paper is about HMMs on trees, and not about mutual information estimation. The authors use a variational technique to relax the problem, and introduce a parametric for states/transitions, making use of Categorical/Dirichlet and Gaussian/Inverse Gamma conjugacy."
                },
                "soundness": {
                    "value": "2 fair"
                },
                "presentation": {
                    "value": "2 fair"
                },
                "contribution": {
                    "value": "2 fair"
                },
                "strengths": {
                    "value": "-The authors address a interesting problem of expanding/branching HMMs.  \n-They introduce a tractable solution to this problem."
                },
                "weaknesses": {
                    "value": "* While I agree in spirit with the mathematical technique, I think section 2.3 needs work in clarifying notation (perhaps a block diagram?), and has possible errors due to its compression into a single page of 2 equations.  \n* It is not clear that air pathways actually have these complex state transitions? Could they instead be modeled using the (constant) branching process? Why are there hidden states, instead of constant branching factors or branching factors that are a function of depth? Basically, do the physical branching angles, rate of branching, etc., actually change?  \n* CT has imaging resolution on the order of mm (1mm isotropic is a very high quality human CT, multi-mm thick slice or gapped slices are standard clinical CT resolution). Do we expect the actual alveolar trees to be visible? If not, would these resolutions lead to non-tree like observations? (i.e., multi-compartment mergers)"
                },
                "questions": {
                    "value": "1) I'm fairly certain the ELBO should be a lower bound. Why can we have the log inside of the integral/summand in equation (1) without an inequality? Usually the latent variables are introduced at this stage, then either the spectral gap is derived, or Jensen's inequality used.  \n2) One motivating factor for this work is rule heterogeneity. However, is this actually possible using these priors? I think this is what your experiments are trying to show in 3.2; I encourage the authors to work on this. Branching processes with differing rules based on interesting conditions can be very interesting in applied fields, but Figures 4 and 5 are incredibly small and unreadable, as are table 1 and 2, but even more importantly, the authors should use the synthetic data to prove that if such a rule shift (so, a regime change between lung tissue structures) existed, it could be learned by this HMM, and wouldn't have been learned by the fixed branching process.  \n\nAdditional notes: If the authors are set on using lung tissue, I feel a medical applied conference (MICCAI, MIDL, etc.) may be better suited for this type of contribution. While the HMM is interesting, its need within the application domain will not be appreciated by this community as much as a more medically inclined community."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "5: marginally below the acceptance threshold"
                },
                "confidence": {
                    "value": "5: You are absolutely certain about your assessment. You are very familiar with the related work and checked the math/other details carefully."
                },
                "code_of_conduct": {
                    "value": "Yes"
                },
                "first_time_reviewer": {
                    "readers": [
                        "ICLR.cc/2024/Conference/Program_Chairs",
                        "ICLR.cc/2024/Conference/Submission6037/Senior_Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission6037/Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission6037/Reviewer_xwzK"
                    ]
                }
            },
            "number": 3,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission6037/-/Official_Review"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1699638877700,
            "cdate": 1699638877700,
            "tmdate": 1700596978697,
            "mdate": 1700596978697,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "SOoP5mjZn9",
                "forum": "YTKShuSOhI",
                "replyto": "GcolVYLJaS",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6037/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6037/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Initial response to review of Submission6037 by Reviewer xwzK"
                    },
                    "comment": {
                        "value": "We thank the reviewer for their detailed comments and suggestions. \n\nWe are working on addressing your comments and questions with an extension granted till December 1st due to us only receiving the review yesterday."
                    }
                },
                "number": 10,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6037/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700691970130,
                "cdate": 1700691970130,
                "tmdate": 1700691970130,
                "mdate": 1700691970130,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    }
]