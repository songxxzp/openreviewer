[
    {
        "title": "Compresso: Structured Pruning with Collaborative Prompting Learns Compact Large Language Models"
    },
    {
        "review": {
            "id": "nI3mocGwMG",
            "forum": "ktiikNTgK5",
            "replyto": "ktiikNTgK5",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission1784/Reviewer_VBbn"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission1784/Reviewer_VBbn"
            ],
            "content": {
                "summary": {
                    "value": "Main Contributions:\n* Introduction of a new paradigm for structurally pruning Large Language Models (LLMs), named Compresso.\n* Utilization of Low-Rank Adaptation (LoRA) and L0 regularization for resource-efficient training-based pruning.\n* Development of a collaborative pruning prompt that fosters better communication between the LLM and the pruning algorithm, thereby enhancing performance.\n\nMain Innovations:\n* Low-Rank Adaptation (LoRA) in L0 Regularization: A resource-efficient method that addresses high training costs and data collection challenges by tuning learnable binary masks to decide whether to retain or prune sub-modules like heads, FFN dimensions, etc.\n* Collaborative Pruning Prompt: Unlike existing approaches that treat the LLM as a passive entity subject to various compression algorithms, this prompt makes the LLM an active participant in the pruning process, resulting in improved performance.\n* Automated Layer-wise Sparsity Ratios: Compresso learns optimal sparsity ratios across different layers, unlike one-shot pruning methods that use uniform sparsity.\n\nSignificance:\n* Resource Efficiency: Addresses the critical challenge of deploying large models on resource-constrained hardware without sacrificing performance.\n* Benchmarking: Sets a new standard in the pruning of LLMs by outperforming one-shot pruning methods on multiple benchmarks.\n* Practical Applicability: The approach is particularly useful for applications requiring high-performance LLMs on resource-limited platforms, offering a balanced trade-off between size and performance.\n* Enhanced Understanding: The collaborative prompt innovation also hints at the growing capability of LLMs to understand and adapt to complex operational instructions, opening avenues for more sophisticated, dynamic interactions between algorithms and models.\n\nSetting:\n* Dataset: GPT4-Alpaca\n* Epochs: 7 (1 for fine-tuning, 5 for pruning, 1 for mask optimization)\n* Optimizer: AdamW with initial learning rate 5e-5, batch size of 8\n* Hardware: 4 Nvidia V100 GPUs\n* Target Models: LLaMA-7B pruned to 5.4B, 5B, and 4.5B\n* Evaluation: Zero-shot commonsense reasoning, Reading comprehension, and Few-shot learning\n\nMain Results:\n* Zero-shot Commonsense Reasoning: Compresso retains up to 96% of the original LLaMA-7B's performance.\n* Zero-shot Reading Comprehension: Compresso pruned models outperform the original LLaMA-7B by up to 3.91%.\n* Few-shot learning: Compresso significantly outperforms the baseline (LLM-Pruner) on MMLU and BBH benchmarks, retaining up to 87% of LLaMA-7B's capability.\n\nAblation Study:\n* Dataset selection matters a lot for the performance of the pruned models.\nIn summary, Compresso demonstrates superior performance in pruning LLaMA-7B across zero-shot and few-shot benchmarks compared to the baseline LLM-Pruner.\n\nConclusions:\n* Compresso effectively prunes the LLaMA-7B model down to 5.4B parameters while maintaining, or even enhancing, its original performance.\n* Compresso outperforms one-shot pruning methods across various benchmarks like commonsense reasoning, reading comprehension, MMLU, and BBH.\n* Training-based pruning methods like Compresso show promise in overcoming the limitations of one-shot pruning in the context of LLMs."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "3 good"
                },
                "strengths": {
                    "value": "* High Retention of Performance: The pruned models retain a high percentage of the original LLaMA-7B's capability across multiple domains, such as commonsense reasoning and reading comprehension. This indicates that the pruning technique is highly effective without compromising performance.\n* Versatility Across Domains: Unlike other works that only focus on specific tasks like perplexity or commonsense reasoning, this paper evaluates the pruned models across multiple domains. They examine zero-shot commonsense reasoning, reading comprehension, and few-shot learning capabilities, making the results more generalizable.\n* Outperforms Existing Methods: The paper shows that their method, Compresso, consistently outperforms the existing structured pruning baseline (LLM-Pruner) in all aspects and settings. This includes zero-shot and few-shot evaluations.\n* Efficiency: The method is efficient enough to be trained on 4 Nvidia V100 GPUs, which could be considered a relatively modest hardware setting for such large-scale models. This indicates that the method is not just effective but also practical.\n* Impact of Pruning Data: The ablation study indicates that the choice of dataset for the pruning process can greatly impact the effectiveness of the technique. This adds a new dimension to the study of model pruning and could be a valuable insight for future research."
                },
                "weaknesses": {
                    "value": "* on-Existent Discussion on Limitations: While the paper does provide a robust set of experiments and results, there is a lack of discussion regarding the limitations of the proposed methods. Understanding the boundaries of the method's applicability is crucial for both academic and industrial settings.\n\n* The ablation study indicates that the choice of dataset for the pruning process can greatly impact the effectiveness of the technique. Which also indicates that the pruned model might be not ideal for the data and use-cases not appeared in the instruction tuning process.\n\n* clearly description of which parts are pruned are expected."
                },
                "questions": {
                    "value": "* if the choice of dataset for the pruning process can greatly impact the effectiveness of the technique as the ablation part indicates in this manuscript, then is the pruning still meaningful in LLMs, given that the instruction tuning dataset might always be insufficient?\n\n* clearly description of which parts are pruned are expected. And how much acceleration benefit can be derived from the proposed pruning algorithm?"
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "6: marginally above the acceptance threshold"
                },
                "confidence": {
                    "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 1,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission1784/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698709928830,
            "cdate": 1698709928830,
            "tmdate": 1699636107724,
            "mdate": 1699636107724,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "rwZrq1t76g",
                "forum": "ktiikNTgK5",
                "replyto": "nI3mocGwMG",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission1784/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission1784/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Author Response to Official Review by Reviewer VBbn (1/3)"
                    },
                    "comment": {
                        "value": "We greatly appreciate your time, detailed and encouraging comments, positive feedback on our work and the constructive suggestions. These inputs will undoubtedly strengthen our work. We are very pleased to address your concerns.\n\n> If the choice of dataset for the pruning process can greatly impact the effectiveness of the technique, then is the pruning still meaningful in LLMs, given that the instruction tuning dataset might always be insufficient?  The pruned model might be not ideal for the data and use-cases not appeared in the instruction tuning process.\n\n**Response**: Thank you for your insightful observation and question regarding the potential impact of pruning dataset choice on the effectiveness of our pruning technique. We appreciate your keen interest in understanding the significance of LLM pruning in the context of dataset-related challenges. To answer your questions, we would like to clarify the following points:\n\n1. We acknowledge that the instruction tuning dataset, GPT4Alpaca, does not encompass all possible tasks. Despite this limitation, we opt for LLM pruning based on this dataset and we found that **the pruned models still exhibit a remarkable preservation of the original LLM's generalization ability across various tasks**. For example, in MMLU and BBH benchmarks, we identified 6 specific subtasks that are not covered in topics/domains from GPT4Alpaca. These tasks spanned topics and contexts beyond the dataset's coverage. Even in these uncovered tasks, our pruned 5.4B model maintains an average of 97.8% of the original LLaMA-7B's performance. The results demonstrate the robustness and generalizability of our pruned LLMs by the instruction tuning dataset. \n\n| Model | MMLU: philosophy| MMLU: prehistory     | MMLU: professional_psychology | BBH: penguins_in_a_table| BBH: dyck_languages| BBH: date_understanding|\n| :--:   | :--:    |:--:        |:--:        |:--:        |:--:        |:--:        |\n|LLaMA-7B| 45.0| 39.8| 34.2| 25.87| 23.88|26.31|\n|Compresso-5.4B| 37.3| 36.4| 32.7| 24.48| 36.03| 23.89|\n\n\n2. The primary reason we chose to use the instruction tuning dataset is due to the inaccessibility of the pre-training dataset and the substantial training resources required even if it were released. Despite its distribution differing from the pre-training data, the instruction tuning dataset is designed to better align with human intents. Some studies[1,2] have shown that fine-tuning pre-trained LLMs with it still exhibits strong cross-ability generalization on unseen data. Our above experiment results further validate this point. However, we acknowledge that the GPT4alpaca dataset we are currently using is not optimal. As discussed in our limitations and discussions (Appendix A.2), when pruning at higher sparsity ratios, the pruned LLM experiences a noticeable drop in performance. In such cases, a dataset with a distribution closer to the original pre-trained dataset is needed to recover the information loss. \n\n3. Our method, Compresso, and particularly the collaborative pruning paradigm, **is not limited to just the instruction tuning dataset. It can be applied to pre-trained text data**. For instance, in our ablation study, we used pure text data generated by the method proposed by LLM-QAT. Although the quality of the text data generated by LLaMA-7B is some problematic and its pruning performance is not as good as GPT4alpaca, it still outperforms other methods such as SparseGPT (structured), Wanda (structured), and LLM-Pruner as shown in the following Table. As for how to generate a high-quality dataset for efficient pruning, we leave it as future work.\n\n| Method (5.4B) | Commonsense reasoning (0-shot) | Reading comprehension (0-shot) | MMLU (5-shot) | BBH (3-shot)|\n| :--:   | :--:    |:--:        |:--:        |:--:        |\n|SparseGPT|58.12 | 54.32| 26.80|27.83 |\n|Wanda |58.06 | 55.54| 15.65| 16.08|\n|LLM-Pruner| **59.14**|48.92 |24.86 |28.97 |\n|Compresso with LLM-QAT generated data| 58.62|**55.18** |**27.89** |**29.65** |\n\n[1] Dynamics of instruction tuning: each ability of large language models has its own growth pace,  https://arxiv.org/pdf/2310.19651.pdf\n\n[2] Instruction Tuning with GPT4, https://arxiv.org/pdf/2304.03277.pdf"
                    }
                },
                "number": 13,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission1784/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700485480529,
                "cdate": 1700485480529,
                "tmdate": 1700487085714,
                "mdate": 1700487085714,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "GAvYmAir5T",
                "forum": "ktiikNTgK5",
                "replyto": "nI3mocGwMG",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission1784/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission1784/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Author Response to Official Review by Reviewer VBbn (2/3)"
                    },
                    "comment": {
                        "value": "> How much acceleration benefit can be derived from the proposed pruning algorithm?\n\n**Response**: Thank you for your valuable question. We measure the inference latency of our pruned LLMs using the VLLM framework[1] on an A100. We randomly select 10 questions from the GPT4alpaca dataset, and measure the inference latency of the generation process both with and without the use of the pruning prompt. The results are shown in the Table below. All latency numbers represent end-to-end latency. Our pruned LLMs of different sizes all accelerate the token generation process of the original LLaMA-7B, both with and without the pruning prompt. Specifically, Compresso-5.4B and 4.5B accelerate the generation process by 1.17x and 1.19x, respectively. When we add our pruning prompt, the latency slightly increases, but compared to LLaMA-7B, there is still an acceleration of 1.10x and 1.13x. \n\n| Model | Latency  | Acceleration| \n| :--:   | :--:    |:--:    |\n|LLaMA-7B| 195.58 ms| 1x| \n|Compresso-5.4B|170.76 ms| **1.17x**|\n|Compresso-5.4B (Inference with Pruning Prompt)| 180.81 ms| **1.10x** |\n|Compresso-4.5B|167.93 ms | **1.19x**  |\n|Compresso-4.5B (Inference with Pruning Prompt)| 177.16 ms| **1.13x** |\n\n[1] https://github.com/vllm-project/vllm \n\n> Lack of discussion on limitations \n\n**Response**: We appreciate your constructive suggestion. We add a discussion section and put it in the appendix section A.2 due to space constraints. Here is a shorter version:\n\nDue to computational constraints, we have not yet evaluated Compresso on larger models like the 33B and 65B. However, Compresso is highly generalizable and can be scaled up to larger models. The effectiveness of our method is influenced by the quality of the pruning dataset. Currently, we use an instruction tuning dataset (GPT4alpaca) for pruning, due to the inaccessible and resource-intensive nature of original pre-training datasets for LLMs. While it's promising, but the use of instruction tuning dataset as pruning data is not the optimal. \nFor instance, when pruning at higher sparsity ratios, we observe a noticeable performance decline.  Addressing this issue typically requires the original pre-training dataset to compenstate for the information loss of the pruned LLMs. As such, the generation of a high-quality pruning dataset that closely aligns the distribution of original pre-training dataset is a crucial consideration for further LLM pruning research."
                    }
                },
                "number": 14,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission1784/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700485526380,
                "cdate": 1700485526380,
                "tmdate": 1700486573371,
                "mdate": 1700486573371,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "CXpFVUrdaP",
                "forum": "ktiikNTgK5",
                "replyto": "nI3mocGwMG",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission1784/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission1784/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Author Response to Official Review by Reviewer VBbn (3/3)"
                    },
                    "comment": {
                        "value": "> Clearly description of which parts are pruned \n\n**Response**: Thank you for your valuable suggestion. As shown in the Figure 3 of the original paper (now we move to Appendix due to space limit), we present the layer-wise remaining ratios of attention heads and FFN intermediate size, and compare it to LLM-Pruner. This figure demonstrates that Compresso learns different pruned structures compared to LLM-Pruner that adopts the uniform-sparsity setting. Specifically, (i) Compresso automatically learns a different layer-wise sparsity ratio; (ii) Compresso tends to preserve more heads in the first and middle layers, while it prunes more heads in the final layers. \n\nTo provide more details on the pruned architectures, we list out the detailed model configurations in the following table (we also add a section in the Appendix section in the updated pdf). From the table, we can observe several interesting points:\n\n1):  Across all three pruned models, {\\sysname} exhibits a tendency to retain more heads in the first and middle layers, while pruning more heads in the final layers. This tendency, although less evident in the FFN intermediate, continues to persist.  Notably, in the 5.4B model, the heads and FFN intermediate size of certain middle layers are completely preserved.\n\n2): Compresso generally prunes slightly more heads than FFN layers.\n\n3): Only a few hidden dimensions are pruned.\n\n| Model | Hidden     | Layer      | \\# Heads | \\# Intermediate|\n| :--:   | :--:    |:--:        |:--:        |:--:        |\n| LLaMA-7B | 4096 | | 32| 11008|\n|Compresso-5.4B| 4042 | Layer 1-8: |19, 16, 32, 32, 21, 32, 32, 32|7594, 7582, 11008, 11008, 7366, 11008, 11008, 11008|\n| | |  Layer 9-16: |32, 32, 32, 30, 27, 32, 32, 32 | 11008, 11008, 11008, 7298, 7514, 11008, 11008, 11008 |\n| | | Layer 17-24: | 27, 32, 32, 32, 26, 32, 6, 32 | 7514, 11008, 11008, 11008, 7546, 11008, 7931, 11008|\n|||Layer 25-32: | 4, 10, 8, 6, 9, 8, 8, 8 | 7943, 7899, 7843, 7731, 7899, 7896, 7978, 8116|\n|Compresso-5.4B| 4060 |  Layer 1-8: | 21, 22, 27, 25, 28, 25, 29, 24 | 8072, 8161, 8141, 7993, 7965, 7989, 7959, 7903|\n||| Layer 9-16: | 26, 29, 30, 30, 30, 26, 31, 31 | 8001, 7933, 7862, 8055, 8133, 8278, 8260, 8391|\n|||Layer 17-24: | 29, 28, 29, 25, 26, 22, 16, 19 | 8429, 8447, 8412, 8492, 8400, 8408, 8360, 8365|\n||| Layer 25-32: | 19, 16, 16, 11,16, 14, 12, 13 | 8277, 8235, 8155, 8120, 8153, 8173, 8184, 8255|\n|Compresso-4.5B| 4044|   Layer 1-8: | 14, 19, 24, 15, 17, 18, 15, 17| 8136, 8184, 8145, 7942, 7889, 7890, 7935, 7886|\n|||Layer 9-16: | 22, 22, 22, 20, 26, 26, 26, 22|8014, 7970, 7979, 8067, 8237, 8266, 8279, 8351|\n|||Layer 17-24: | 22, 24, 22, 17, 17, 14, 8, 11|8401, 8433, 8415, 8466, 8446, 8391, 8324, 8312|\n|||Layer 25-32:| 5, 6, 7, 4, 9, 10, 7, 10|  8228, 8169, 8078, 8083, 8047, 8115, 8159, 8240|"
                    }
                },
                "number": 15,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission1784/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700485579072,
                "cdate": 1700485579072,
                "tmdate": 1700485579072,
                "mdate": 1700485579072,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "DdpAOQvNRo",
            "forum": "ktiikNTgK5",
            "replyto": "ktiikNTgK5",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission1784/Reviewer_dFpf"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission1784/Reviewer_dFpf"
            ],
            "content": {
                "summary": {
                    "value": "This paper introduces Compresso, a novel method designed to prune models during the instruction tuning phase. The experiments conducted across various datasets demonstrate that Compresso outperforms existing pruning methods in Large Language Models (LLMs)."
                },
                "soundness": {
                    "value": "2 fair"
                },
                "presentation": {
                    "value": "2 fair"
                },
                "contribution": {
                    "value": "2 fair"
                },
                "strengths": {
                    "value": "The paper is articulate and follows a clear, logical structure, making it accessible and easy to comprehend.\nThe integration of collaborative pruning prompts is a unique and innovative approach, distinguishing this work from existing pruning methods."
                },
                "weaknesses": {
                    "value": "The baseline method utilized in this study fine-tunes the model using the Alpaca dataset, whereas this paper employs the GPT4-Alpaca dataset for fine-tuning, which is inherently more robust. Given the significance of the instruction tuning dataset's quality in LLMs, it is imperative for the authors to present performance metrics post-application of the GPT4-Alpaca dataset.\nIncorporating the system pruning prompt during the inference phase substantially increases inference costs. This discrepancy makes the comparison with traditional pruned models somewhat skewed and potentially unfair.\nThe authors are encouraged to broaden their experimental scope to include other sparse patterns (e.g., unstructured and N:M sparse patterns) to further validate the efficiency of the pruning prompt.\nMinor Issues:\nCertain assertions within the paper lack sufficient backing. For instance, the claim \"To our knowledge, we are the first to apply instruction tuning to weight pruning\""
                },
                "questions": {
                    "value": "See Weaknesses"
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "5: marginally below the acceptance threshold"
                },
                "confidence": {
                    "value": "5: You are absolutely certain about your assessment. You are very familiar with the related work and checked the math/other details carefully."
                },
                "code_of_conduct": {
                    "value": "Yes"
                },
                "first_time_reviewer": {
                    "value": "Yes",
                    "readers": [
                        "ICLR.cc/2024/Conference/Program_Chairs",
                        "ICLR.cc/2024/Conference/Submission1784/Senior_Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission1784/Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission1784/Reviewer_dFpf"
                    ]
                }
            },
            "number": 2,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission1784/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698762986695,
            "cdate": 1698762986695,
            "tmdate": 1699636107648,
            "mdate": 1699636107648,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "VviS1naRfe",
                "forum": "ktiikNTgK5",
                "replyto": "DdpAOQvNRo",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission1784/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission1784/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Author Response to Official Review by Reviewer dFpf (1/3)"
                    },
                    "comment": {
                        "value": "We greatly appreciate your time, encouragement comments about our novelty, and insightful questions. In particular, we greatly appreciate your suggestion to expand our experimental scope by incorporating other sparse patterns to further validate the efficiency of the pruning prompt. This recommendation has indeed strengthened our approach.  We are pleased to address your concerns. \n\n> LLM-Pruner performance under fine-tuning with the GPT4alpaca dataset\n\n**Response**: Thank you for your insightful question. Following your suggestion, we use GPT4Alpaca dataset for fine-tuning LLM-Pruner pruned models. The fine-tuning settings follow the original paper and code base, and the results are presented in the following table. The results show that using GPT4Alpaca as the fine-tuning dataset can slightly improve the performance of LLM-Pruner's results. Despite this, our method still significantly outperforms LLM-Pruner across various benchmarks. Interestingly,  even with the use of the GPT4Alpaca dataset for fine-tuning, LLM-Pruner's performance on three benchmarks (i.e., reading comprehension, MMLU and BBH) are relatively poor. This emphansizes the importance of preserving the most crucial model weights during the pruning phase. Despite the efforts in fine-tuning, the information loss caused by pruned LLMs cannot be fully compensated if the most important weights are not retained. \n\n\n| Size | Method    | Commonsense Reasoning (0-shot)      | Reading Comprehension (0-shot) | MMLU (5-shot) | BBH (3-shot)|\n| :--:   | :--:    |:--:        |:--:        |:--:        |:--:        |\n|5.4B | LLM-Pruner (clean Alpaca)| 59.14| 48.92|24.86 | 28.97| \n| | LLM-Pruner (GPT4Alpaca) | 59.27 | 50.35| 24.80| 28.26 |\n| | Compresso | **60.09**| **60.35**| **31.90**| **31.47**|\n|5.0B | LLM-Pruner (clean Alpaca)| 56.37| 48.93| 23.22| 26.46| \n| | LLM-Pruner (GPT4Alpaca) |56.72 |47.65 |24.00 |26.71 |\n| | Compresso |**57.05** |**56.58** |**27.68** | **31.27**|\n|4.5B | LLM-Pruner (clean Alpaca)| 53.73| 47.70|23.85 | 24.67| \n| | LLM-Pruner (GPT4Alpaca) | 54.36| 48.00|23.10| 24.59|\n| | Compresso | **55.94**| **52.52**|**25.92** |**28.25** |\n\nWe appreciate your feedback and look forward to further discussions on this topic."
                    }
                },
                "number": 10,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission1784/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700485272284,
                "cdate": 1700485272284,
                "tmdate": 1700486849315,
                "mdate": 1700486849315,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "VdyHKKtz79",
                "forum": "ktiikNTgK5",
                "replyto": "DdpAOQvNRo",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission1784/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission1784/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Author Response to Official Review by Reviewer dFpf (2/3)"
                    },
                    "comment": {
                        "value": "> The authors are encouraged to broaden their experimental scope to include other sparse patterns (e.g., unstructured and N:M sparse patterns) to further validate the efficiency of the pruning prompt.\n\n**Response**: We appreciate your constructive suggestion. We utilize SparseGPT[1] for the experiment, which is a representative method for unstructured pruning and n:m sparsity. Specifically, we prune LLaMA-7B under a 50% sparsity ratio for unstructured pruning and under n:m (2:4) sparsity using SparseGPT. We then evaluate the pruned model under conditions with and without our pruning prompt for zero-shot commonsense reasoning and reading comprehension. As shown in the tables below, our pruning prompt significantly improves the performance on all benchmarks and tasks. \n\n|Model | Avg | StoryCloze| PIQA| HellaSwag| WinoGrande| ARC-e|ARC-c|OBQA|\n| :--:   | :--:    |:--:        |:--:        |:--:        |:--:        |:--:        |:--:        |:--:        |\n|2:4 sparsity | 51.46| 75.31| 70.18| 45.52| 58.33| 55.85| 31.4| 23.6|\n|2:4 sparsity + our prompt| **53.97**| **76.16**| **71.0**| **47.56**| **60.85**| **59.3**| **33.7**| **29.2**| \n|unstructured (50% sparsity)| 54.59| 79.10| 71.93| 48.87| 62.04| 60.44| 34.13| 25.6|\n|unstructured + our prompt (50% sparsity)|**57.25**|**79.69**| **73.12**| **50.58**| **64.33**| **66.2**|**36.86**|**30.0**| \n\n\n|Model | Avg | BoolQ| RACE-High|\n| :--:   | :--:    |:--:        |:--:        |\n|2:4 sparsity| 51.59| 67.00| 36.17|\n|2:4 sparsity + our prompt| **53.55**| **69.11**| **37.99**|\n|unstructured (50% sparsity)| 52.16| 67.19| 37.13|\n|unstructured + our prompt (50 sparsity)| **54.09**| **70.95**| **37.22**|\n\n[1] SparseGPT: Massive Language Models Can Be Accurately Pruned in One-Shot"
                    }
                },
                "number": 11,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission1784/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700485313173,
                "cdate": 1700485313173,
                "tmdate": 1700485313173,
                "mdate": 1700485313173,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "YsCf768b2i",
                "forum": "ktiikNTgK5",
                "replyto": "DdpAOQvNRo",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission1784/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission1784/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Author Response to Official Review by Reviewer dFpf (3/3)"
                    },
                    "comment": {
                        "value": "> Incorporating the system pruning prompt during the inference phase can increase inference costs.\n\n**Response**: Thank you for your insightful question.  Naively incorporating the system pruning prompt during the inference phase can indeed increase the inference latency. However, this pruning prompt is a fixed prompt, which only accounts for 256 tokens for LLaMA models,  and applied to all inference requests. Thus, many strategies can be applied to reduce the latency overhead caused by this fixed prompt. \n\nFor instance, we can simply leverage the key-value (KV) Cache approach, which eliminates the need to compute full attention for every token. To demonstrate this,  we take vllm framework[1] as an example which already supports the KV cache implementation. Specifically, we measure the inference latency of our pruned LLMs based on vllm framework on an A100. We randomly select 10 questions from the GPT4Alpaca dataset, and measure the inference latency of the generation process both with and without the use of the pruning prompt. The results are shown in the Table below. All latency numbers represent end-to-end latency. Our pruned LLMs of different sizes all accelerate the token generation process of the original LLaMA-7B, both with and without the pruning prompt. Specifically, Compresso-5.4B and 4.5B accelerate the generation process by 1.17x and 1.19x, respectively. When we add our pruning prompt, the latency slightly increases, but compared to LLaMA-7B, there is still an acceleration of 1.10x and 1.13x. \n\n| Model | Latency  | Acceleration| \n| :--:   | :--:    |:--:    |\n|LLaMA-7B| 195.58 ms| 1x| \n|Compresso-5.4B| 170.76 ms| **1.17x**|\n|Compresso-5.4B (Inference with Pruning Prompt)| 180.81 ms| **1.10x** |\n|Compresso-4.5B| 167.93 ms | **1.19x**  |\n|Compresso-4.5B (Inference with Pruning Prompt)| 177.16 ms| **1.13x** |\n\nMoreover, a recent work called \"PromptCache\" [2] has been introduced, which can be utilized to further mitigate the additional inference costs caused by the pruning prompt. PromptCache can pre-compute and reuse the attention states across multiple requests, which can significantly reduce the inference latency caused by our fixed system prompt. The latency reduction in the generation phase can be reduced by up to 10x, which is very promising. However, since it currently has not been open-sourced, we leave the latency measurement as future work.\n\n[1] https://github.com/vllm-project/vllm \n\n[2] Prompt Cache: Modular Attention Reuse for Low-Latency Inference https://arxiv.org/pdf/2311.04934.pdf"
                    }
                },
                "number": 12,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission1784/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700485366076,
                "cdate": 1700485366076,
                "tmdate": 1700486899827,
                "mdate": 1700486899827,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "aybpHM9uiV",
            "forum": "ktiikNTgK5",
            "replyto": "ktiikNTgK5",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission1784/Reviewer_FZK6"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission1784/Reviewer_FZK6"
            ],
            "content": {
                "summary": {
                    "value": "This work proposes a structured pruning method for large language models (LLMs) named Compresso. The work leverages the LoRA to achieve efficient training-based pruning. The work adopts $L_0$ reparameterization to enable differentiable masks to be jointly optimized with learnable parameters. Moreover, the work tries to prune with the proposed prompt to enhance the pruning results. The experimental result shows that Compresso can prune LLaMA-7B to a 5.4B size while maintaining the performance on zero-shot commonsense reasoning and reading comprehension, as well as few-shot MMLU and BBH benchmarks."
                },
                "soundness": {
                    "value": "2 fair"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "2 fair"
                },
                "strengths": {
                    "value": "- The writing is clear and easy to understand.\n- This research focuses on structured pruning for Language Model Models (LLMs), which can reduce the cost of making predictions without requiring specialized hardware support.\n- The research employs many techniques to make the training-based pruning effective and reduce its costs."
                },
                "weaknesses": {
                    "value": "- The work lacks novelty as many parts are taken from existing works such as LoRA and differentiable masks.\n- The proposed collaborative prompt is interesting, but the empirical study fails to support it convincingly. The ablation study in Table 6 is inconsistent, and it is recommended to perform the Compresso without prompting on both training and inference. Additionally, the lack of analysis or discussion on collaborative prompts prevents readers from fully understanding it.\n- The main experiment only includes one baseline, which makes the results less convincing.\n- There needs to be more explanation or discussion of the performance improvement without post fine-tuning in Table 7.\n- Equation 3 contains many undefined symbols and requires further clarification."
                },
                "questions": {
                    "value": "Please refer to the weaknesses."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "5: marginally below the acceptance threshold"
                },
                "confidence": {
                    "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                },
                "first_time_reviewer": {
                    "value": "Yes",
                    "readers": [
                        "ICLR.cc/2024/Conference/Program_Chairs",
                        "ICLR.cc/2024/Conference/Submission1784/Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission1784/Reviewer_FZK6",
                        "ICLR.cc/2024/Conference/Submission1784/Senior_Area_Chairs"
                    ]
                }
            },
            "number": 3,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission1784/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698835374799,
            "cdate": 1698835374799,
            "tmdate": 1700713229203,
            "mdate": 1700713229203,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "0WHWRZ9X2E",
                "forum": "ktiikNTgK5",
                "replyto": "aybpHM9uiV",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission1784/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission1784/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Author Response to Official Review by Reviewer FZK6 (1/3)"
                    },
                    "comment": {
                        "value": "We appreciate the time and effort you put in reviewing our work, as well as your detailed comments and valuable questions. We understand the concerns you raised and we're pleased to address these concerns. We also appreciate the opportunity to provide some clarification. \n\n> Add more baselines \n\n**Response**: We are grateful for your suggestion to include more baselines for comparison. However, due to constraints such as the absence of open-source code or the requirement of substantial GPU resources, we have selected two one-shot baselines, SparseGPT[1] and Wanda [2], for comparison. They are originally designed for unstructured pruning, and can be extended for N:M sparsity. We further extend them to structured pruning, allowing the removal of entire attention heads and FFN intermediate size. All other settings follow the original papers. \n\nThe results of our comparison are presented in the table below. More detailed numbers can be found in the updated PDF. Interestingly, we found that while SparseGPT and Wanda outperform LLM-Pruner on three of the benchmarks, they fall short on commonsense reasoning. Wanda performs better than SparseGPT at lower sparsity levels, but experiences a significant drop in accuracy at higher sparsity ratios (4.5B). One possible explanation is that Wanda relies on the activation and weights to conduct direct weight pruning, unlike SparseGPT which is dependent on second-order Hessian inverses and includes weight updates on pruned LLMs to recover information loss.\n\nIn contrast, our method significantly outperforms these baselines across all benchmarks, suggesting that our method is the most effective at preserving the generalization capability of the original LLaMA-7B. \n\n| Model | Method    | Commonsense Reasoning (0-shot)      | Reading Comprehension (0-shot) | MMLU (5-shot) | BBH (3-shot)|\n| :--:   | :--:    |:--:        |:--:        |:--:        |:--:        |\n|5.4B| *SparseGPT* | 58.12|54.32 |26.80 | 27.83|\n| | *Wanda*| 58.06|55.54 | 24.50|28.96 |\n| | LLM-Pruner | 59.14|48.92 | 24.86| 28.97|\n| | **Compresso** | **60.09**|**60.35**| **31.90**|**31.47**|\n|5.0B| *SparseGPT* |55.18 |51.35 |25.21 |29.40 |\n| | *Wanda*|54.45 | 51.43| 23.32|24.86 |\n| | LLM-Pruner | 56.37| 48.93| 23.22| 26.46|\n| | **Compresso** |**57.05** |**56.58** |**27.68** |**31.27**|\n|4.5B| *SparseGPT* |52.27 |50.39 | 22.30| 26.61|\n| | *Wanda*|  34.33| 39.47| 15.65|16.08|\n| | LLM-Pruner | 53.73| 47.70| 23.85|24.67 |\n| | **Compresso** |**55.94** |**52.52**|**25.92**|**28.25** |\n\n[1] SparseGPT: Massive Language Models Can Be Accurately Pruned in One-Shot\n\n[2] A Simple and Effective Pruning Approach for Large Language Models"
                    }
                },
                "number": 7,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission1784/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700485035395,
                "cdate": 1700485035395,
                "tmdate": 1700485035395,
                "mdate": 1700485035395,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "YCTCHL5Ybx",
                "forum": "ktiikNTgK5",
                "replyto": "aybpHM9uiV",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission1784/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission1784/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Author Response to Official Review by Reviewer FZK6 (2/3)"
                    },
                    "comment": {
                        "value": "> The ablation study in Table 6 is inconsistent, and it is recommended to perform the Compresso without prompting on both training and inference.  More analysis or discussions for pruning prompt. \n\n**Response (1/2)**: Thank you for your constructive suggestion. We have corrected the typos in Table 6 for consistency. Additionally, following your suggestion, we conduct an experiment to further evaluate the effectiveness of Compresso, where the pruning prompt is removed from the entire process, including training, fine-tuning and inference. The Table below presents the performance of 5.4B pruned LLMs under different settings. \n\n|Task| Compresso with Prompting | No Prompt in Inference| No Prompt in Training| *No Prompt in Training and Inference*| \n| :--:   | :--:    |:--:        |:--:        | :--:    |\n|Commonsense Reasoning (0-shot) |60.09 | 56.07|57.36  | 57.09 |\n|Reading Comprehension (0-shot) |60.35 |56.52 |56.62 | 55.84|\n|MMLU (5-shot)| 31.90| 31.49|29.30 |29.10  |\n|BBH (3-shot) | 31.47|30.57 | 28.08| 28.64| \n\nWe observe three key findings as follows:\n\n1) The results align with the original paper, indicating that removing the pruning prompt at any stage reduces the performance of pruned LLMs. \n2) We found that the impact of pruning prompt at different stages varies across benchmarks. For instance,  removing the pruning prompt at any stage affects zero-shot commonsense reasoning and reading comprehension. However, removing the pruning prompt during training has a greater impact on MMLU and BBH than during inference.\n3) Even if the pruning prompt is removed from training, reintroducing it during inference can still improve the performance of tasks such as commonsense reasoning, reading comprehension, and MMLU, while it may decrease performance on BBH.\n\nIn summary, the additional ablation study further validate the effectiveness of our collaborative pruning paradigm. The experiment results highlight the significant role of our collaborative pruning prompt during the training phase. Specifically, the integration of the pruning prompt during the training-based pruning process is pivotal, fostering a collaborative learning approach where both the LLM and the pruning algorithm jointly optimize for better pruning decisions. \n\n**Response (2/2)**: Moreover, we would like to share more empirical experiments to validate the effectiveness of our pruning prompt. Following the suggestion by Reviewer dFpf, we broaden our experimental scope to include other sparse patterns such as unstructured and N:M sparse patterns. **We demonstrate that our pruning prompt can also improve the pruning performance under unstructured and N:M sparsity patterns**.\n\nWe utilize SparseGPT[1] for the experiment, which is a representative method for unstructured pruning and n:m sparsity. Specifically, we prune LLaMA-7B under a 50% sparsity ratio for unstructured pruning and under n:m (2:4) sparsity using SparseGPT. We then evaluate the pruned model under conditions with and without our pruning prompt for zero-shot commonsense reasoning and reading comprehension. As shown in the tables below, our pruning prompt significantly improves the performance on all benchmarks and tasks. \n\n|Model | Avg | StoryCloze| PIQA| HellaSwag| WinoGrande| ARC-e|ARC-c|OBQA|\n| :--:   | :--:    |:--:        |:--:        |:--:        |:--:        |:--:        |:--:        |:--:        |\n|2:4 sparsity | 51.46| 75.31| 70.18| 45.52| 58.33| 55.85| 31.4| 23.6|\n|2:4 sparsity + our prompt| **53.97**| **76.16**| **71.0**| **47.56**| **60.85**| **59.3**| **33.7**| **29.2**| \n|unstructured (50% sparsity)| 54.59| 79.10| 71.93| 48.87| 62.04| 60.44| 34.13| 25.6|\n|unstructured + our prompt (50% sparsity)|**57.25**|**79.69**| **73.12**| **50.58**| **64.33**| **66.2**|**36.86**|**30.0**| \n\n|Model | Avg | BoolQ| RACE-High|\n| :--:   | :--:    |:--:        |:--:        |\n|2:4 sparsity| 51.59| 67.00| 36.17|\n|2:4 sparsity + our prompt| **53.55**| **69.11**| **37.99**|\n|unstructured (50% sparsity)| 52.16| 67.19| 37.13|\n|unstructured + our prompt (50 sparsity)| **54.09**| **70.95**| **37.22**|\n\n[1] SparseGPT: Massive Language Models Can Be Accurately Pruned in One-Shot"
                    }
                },
                "number": 8,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission1784/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700485160005,
                "cdate": 1700485160005,
                "tmdate": 1700485891026,
                "mdate": 1700485891026,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "SYIHeqxuR5",
                "forum": "ktiikNTgK5",
                "replyto": "aybpHM9uiV",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission1784/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission1784/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Author Response to Official Review by Reviewer FZK6 (3/3)"
                    },
                    "comment": {
                        "value": "> The work lacks novelty as many parts are taken from existing works such as LoRA and differentiable masks.\n\n**Response**: We thank you for your comment and appreciate the opportunity to clarify our contributions: \n 1. Our primary contributions are the introduction of the collaborative pruning LLM paradigm and the associated pruning prompt. Unlike conventional approaches treating LLMs passively, our paradigm makes the LLM an active participant in the pruning process, resulting in a substantial performance improvement. The behind insight is that recent state-of-the-art LLMs already have the capability to understand and adapt to complex operational instructions (i.e., encourage the LLM itself better adapt to the pruning process). We are pleased to note that Reviewers dFpf and VBbn have acknowledged and appreciated the novelty of this paradigm.\n 2. Besides, our structured pruning algorithm is not a simple combination of existing techniques. In contrast, every design choice is purposeful and aimed at addressing specific challenges. For instance, regarding LoRA, typically applied in fine-tuning and instruction tuning, we innovatively integrate it into the pruning process. This integration allows us to significantly reduce the resources required for training-based pruning while maintaining promising pruning performance.  The use of differentiable masks in our pruning algorithm aligns perfectly with our proposed collaborative pruning prompt. This is a departure from existing pruning algorithms that rely on weight importance metrics to determine which weights to prune, a process that presents challenges when integrating with our collaborative pruning prompt. This optimally leverages the capabilities of both the pruning algorithm and the LLM itself to learn the optimal pruning decisions. \n\nThank you for your consideration, and we look forward to your feedback. \n\n> There needs to be more explanation or discussion of the performance improvement without post fine-tuning in Table 7.\n\n**Response**: Thank you for your valuable suggestion. Upon delving into the detailed numbers, we found that the slight performance decrease for the 4.5B model after fine-tuning is due to the less significant improvement on our proposed collaborative pruning prompt. As shown in the table below, we list out the BBH scores both with and without the collaborative pruning prompt. *The numbers in ( ) denote the BBH scores without the collaborative pruning prompt*. We observed that the average BBH, BBH on NLP, and BBH on algorithmic all improve after fine-tuning without the collaborative prompt, which aligns with common practice.  However, after fine-tuning, the score of BBH on algorithmic with the prompt only improves by 0.97, while it originally improves by 3.81 before the fine-tuning. \n\n| 4.5B on BBH | BBH Avg     | NLP      | Algorithmic | \n| :--:   | :--:    |:--:        |:--:        |\n| No Fine-tuning | 29.56 (27.65)| 32.29 (32.90)| 27.37 (23.56)|\n| After Fine-tuning| 28.25 (27.71) |32.62 (32.50) | 24.75 (23.78)|"
                    }
                },
                "number": 9,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission1784/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700485199546,
                "cdate": 1700485199546,
                "tmdate": 1700485199546,
                "mdate": 1700485199546,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "J7EcPSlYXT",
                "forum": "ktiikNTgK5",
                "replyto": "aybpHM9uiV",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission1784/Reviewer_FZK6"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission1784/Reviewer_FZK6"
                ],
                "content": {
                    "comment": {
                        "value": "After reviewing the feedback from the authors, I have decided to change my initial rating from 3 to 5 as the authors have addressed some of my concerns, but the novelty of the work is limited and needs more insight."
                    }
                },
                "number": 17,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission1784/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700713148283,
                "cdate": 1700713148283,
                "tmdate": 1700713274416,
                "mdate": 1700713274416,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "8oSlREKBGP",
                "forum": "ktiikNTgK5",
                "replyto": "aybpHM9uiV",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission1784/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission1784/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Official Comment by Authors"
                    },
                    "comment": {
                        "value": "We sincerely appreciate your review and valuable feedback. We are pleased to see that our efforts to address your concerns have resulted in an improved evaluation of our paper. Your willingness to reconsider and increase the rating from 3 to 5 is sincerely appreciated. \n\nWe would like to take this opportunity to reiterate and clarify our key contributions:\n\n1. **Structured pruning of LLMs in training-based methods**. \nOur work sets itself apart from the majority of existing LLM pruning techniques, which predominantly focus on one-shot post-training pruning. These methods excel in unstructured and n:m sparsity pruning, but they fall short when it comes to structured pruning due to the pruning of entire channels/heads, leading to significant information loss. Compresso, on the other hand, pioneers the introduction of structured pruning within a training-based framework. We tackle the raised challenges of high training costs and data collection. Furthermore, since we jointly optimize the original model parameters and the pruning masks, we can better recover the errors caused by structured pruning, and the resulting structured pruned LLMs retain the original LLM capacity.\n\n\n2. **Introduction of collaborative pruning paradigm and the pruning prompt**. \nWe introduce a novel paradigm that harnesses the LLM in a collaborative pruning process. While we acknowledge the limited theoretical analysis in the current version, **the extensive experiments on different sparse patterns (i.e., unstructured pruning, n:m sparsity and structured pruning) and tasks demonstrate its effectiveness and unique role in LLM pruning**.  We are confident that this collaborative pruning paradigm and pruning prompt represents a promising direction for LLM pruning research. We are grateful for the recognition of its novelty by other reviewers (*dFpf and VBbn*), and we are enthusiastic about the potential it unveils for the LLM pruning community.\n\n\n3. **Promising pruning results achieved with minimal training resources**. \nOur pruning experiments have yielded promising results. For example, we have demonstrated the ability to prune LLaMA-7B to 5.4B, LLaMA-13B to 11B, while preserving their original generalization capability. Moreover, this is achieved with minimal training resources, i.e., it requires only 4x 32GB V100 GPUs and an instruction-tuning dataset with 52k examples. Finally, the pruned LLMs achieve direct inference latency speedups. This stands in stark contrast to current unstructured and n:m semi-structured pruning methods, which necessitate specialized inference frameworks and hardware for comparable speedups.\n\n\nWe once again express our gratitude for your time and consideration, and we eagerly anticipate any additional insights or suggestions you may have."
                    }
                },
                "number": 18,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission1784/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700720371331,
                "cdate": 1700720371331,
                "tmdate": 1700721212248,
                "mdate": 1700721212248,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "0gVMU7H0QP",
            "forum": "ktiikNTgK5",
            "replyto": "ktiikNTgK5",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission1784/Reviewer_uGct"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission1784/Reviewer_uGct"
            ],
            "content": {
                "summary": {
                    "value": "This paper proposes a one-shot structured pruning method, called Compresso, for Large Language Models (LLMs). Compresso incorporates Low-Rank Adaptation (LoRA) into the L0 regularization during the instruction tuning process, and it also fosters collaboration between the LLM and the pruning algorithm. The evaluation shows that Compresso outperforms LLM-Pruner on several datasets."
                },
                "soundness": {
                    "value": "2 fair"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "3 good"
                },
                "strengths": {
                    "value": "1. The writing is clear.\n2. The authors evaluated 7 benchmarks to show that Compresso outperforms LLM-Pruner."
                },
                "weaknesses": {
                    "value": "1. In Equation 3, what $d_h$ denotes is not explained;  Similarly, In Equation 5, what $\\lambda1$ and $\\lambda2$ denote is not explained.\n2. Some references or empirical evidence is needed to support it is the common practice of setting l to -0.1, r to 1.1, and \u03b2 to 2.\n3. In Section 4, it would be better if the authors could provide some insights, rather than only listing the numbers.\n4. Demonstrating the theoretical underpinnings of Compresso would greatly enhance the paper.\n5. This paper claims that LLM-Pruner is the only LLM structured pruning work. However, this claim appears to be open to question. The related works [1-7] that structurally prune LLMs are not mentioned or compared.\n6. There are some typos in the paper, e.g. \u201cWe introduce LoRA intro pruning in a novel manner. Formally\u201d.\n\n[1] Graph-to-Text Generation with Dynamic Structure Pruning\n\n[2] Sheared LLaMA: Accelerating Language Model Pre-training via Structured Pruning\n\n[3] ZipLM: Inference-Aware Structured Pruning of Language Models\n\n[4] Dynamic Sparse No Training: Training-Free Fine-tuning for Sparse LLMs\n\n[5] A Simple and Effective Pruning Approach for Large Language Models\n\n[6] Gradient-Free Structured Pruning with Unlabeled Data\n\n[7] LoRAShear: Efficient Large Language Model Structured Pruning and Knowledge Recovery"
                },
                "questions": {
                    "value": "1. Is it possible to compare Compresso with the related works (mentioned above)?\n2. In Section 3.3, the authors claim that this paper introduces LoRA into pruning in a novel manner\u201d. Can you explain the main difference between LoRA used in fine-tuning LLMs and the way used in pruning in this paper?\n3. Although Compresso is a one-shot pruning method, can the performance of LLMs be improved if we do Compresso iteratively?\n4. How to adjust the hyperparameters \u03bb1 and \u03bb2 using the AdamW optimizer? Can authors provide more details or an ablation study about that?"
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "5: marginally below the acceptance threshold"
                },
                "confidence": {
                    "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 4,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission1784/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1699138257599,
            "cdate": 1699138257599,
            "tmdate": 1699636107503,
            "mdate": 1699636107503,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "wGFpu3FQWS",
                "forum": "ktiikNTgK5",
                "replyto": "0gVMU7H0QP",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission1784/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission1784/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Author Response to Official Review by Reviewer uGct (1/4)"
                    },
                    "comment": {
                        "value": "We greatly appreciate your time, detailed comments, and valuable suggestions. We are pleased to address your concerns and make some clarifications. \n\n> Compare Compresso with related works\n\n**Response (1/2): Clarifications on the listed related works**: \nWe greatly appreciate your insightful comments and the opportunity to clarify our work in relation to the cited works. \n\nFirstly, we would like to address the timing of the publication of some of LLM structured pruning works, such as [2][7]. These papers were published on Arxiv after ICLR deadline, specifically after October 10. At the time of our paper's submission, we were not aware of any other structured pruning works on state-of-the-art LLMs like LLaMA, apart from LLM-pruner. Consequently, we stated in our paper that LLM-pruner was the only LLM structured pruning work. We have revised this statement in the updated PDF and added the appropriate citations. \n\nAlthough [2][7] are concurrent works, we would like to highlight the differences between our work and [2][7] as follows:\nSheared LLaMA [2] utilizes RedPajama, a replicated pretraining dataset for LLaMA with 50B tokens, for both pruning and fine-tuning. However, it requires 16 A100s with 80GB of memory[2], which may not be feasible for public users. In contrast, our method uses an instruction tuning dataset with 52k instances and integrates LoRA in pruning. This allows for experiments on 4x 32GB V100s, a more efficient and practical approach acknowledged by Reviewer VBbn. Apart from its pruning dataset, the pruning algorithm of Sheared LLaMA does not present much novelty, as it only introduces minor modifications to the original CoFiPruning[8]. In contrast, our method proposes a new learning-based structured pruning paradigm, which leverages the LLM itself to conduct collaborative pruning, this differentiates our work from traditional pruning works. \n\nLoRAShear[7] is a one-shot structured pruning work. It initially creates dependency graphs over LoRA modules and analyzes the knowledge distribution. It then iteratively prunes based on this distribution. However, due to the unavailability of its source code and the limited time for rebuttal, we have not included it in our comparison.\n\nSecondly, some of the related works you listed, like [4][5], are semi-structured pruning (n:m sparsity) that requires specified inference runtime and hardware for acceleration, while our focus is entirely on structured pruning that directly removes individual attention heads and reduces FFN intermediate size. [1] is specifically designed for dynamically pruning the structure of graph data, not on the pre-trained language model, while [6] is for BERT, not LLM. [3] only evaluated on BERT and GPT/GPT2. And there is no available open-source code for [3] and [6].\n\nWe hope this clarifies our position and the unique contributions of our work. We look forward to further discussions and feedback.\n\n[1] Graph-to-Text Generation with Dynamic Structure Pruning\n\n[2] Sheared LLaMA: Accelerating Language Model Pre-training via Structured Pruning\n\n[3] ZipLM: Inference-Aware Structured Pruning of Language Models\n\n[4] Dynamic Sparse No Training: Training-Free Fine-tuning for Sparse LLMs\n\n[5] A Simple and Effective Pruning Approach for Large Language Models\n\n[6] Gradient-Free Structured Pruning with Unlabeled Data\n\n[7] LoRAShear: Efficient Large Language Model Structured Pruning and Knowledge Recovery. \n\n[8] CoFiPruning: Structured Pruning Learns Compact and Accurate Models"
                    }
                },
                "number": 3,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission1784/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700484789429,
                "cdate": 1700484789429,
                "tmdate": 1700484789429,
                "mdate": 1700484789429,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "FJ1EecmgjI",
                "forum": "ktiikNTgK5",
                "replyto": "0gVMU7H0QP",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission1784/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission1784/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Author Response to Official Review by Reviewer uGct (2/4)"
                    },
                    "comment": {
                        "value": "> Compare Compresso with related works\n\n**Response (2/2): Comparision results with two new baselines**:  We are grateful for your suggestion to include more baselines for comparison. However, due to constraints such as the absence of open-source code or the requirement of substantial GPU resources, we have selected two one-shot baselines, SparseGPT and Wanda [5], for comparison. They are originally designed for unstructured pruning and can be extended to N:M sparsity. We further extend them to structured pruning, allowing the removal of entire attention heads and FFN intermediate size. All other settings follow the original papers. \n\nThe results of our comparison are presented in the Table below. More detailed numbers can be found in the updated PDF. Interestingly, we found that while SparseGPT and Wanda outperform LLM-Pruner on three of the benchmarks, they fall short on commonsense reasoning. Wanda performs better than SparseGPT at lower sparsity levels, but experiences a significant drop in accuracy at higher sparsity ratios (4.5B). One possible explanation is that Wanda relies on the activation and weights to conduct direct weight pruning, unlike SparseGPT which is dependent on second-order Hessian inverses and includes weight updates on pruned LLMs to recover information loss.\n\nIn contrast, our method significantly outperforms these baselines across all benchmarks, suggesting that our method is the most effective at preserving the generalization capability of the original LLaMA-7B. \n\n| Model | Method    | Commonsense Reasoning (0-shot)      | Reading Comprehension (0-shot) | MMLU (5-shot) | BBH (3-shot)|\n| :--:   | :--:    |:--:        |:--:        |:--:        |:--:        |\n|5.4B| *SparseGPT* | 58.12|54.32 |26.80 | 27.83|\n| | *Wanda*| 58.06|55.54 | 24.50|28.96 |\n| | LLM-Pruner | 59.14|48.92 | 24.86| 28.97|\n| | **Compresso** | **60.09**|**60.35**| **31.90**|**31.47**|\n|5.0B| *SparseGPT* |55.18 |51.35 |25.21 |29.40 |\n| | *Wanda*|54.45 | 51.43| 23.32|24.86 |\n| | LLM-Pruner | 56.37| 48.93| 23.22| 26.46|\n| | **Compresso** |**57.05** |**56.58** |**27.68** |**31.27**|\n|4.5B| *SparseGPT* |52.27 |50.39 | 22.30| 26.61|\n| | *Wanda*|  34.33| 39.47| 15.65|16.08|\n| | LLM-Pruner | 53.73| 47.70| 23.85|24.67 |\n| | **Compresso** |**55.94** |**52.52**|**25.92**|**28.25** |"
                    }
                },
                "number": 4,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission1784/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700484844518,
                "cdate": 1700484844518,
                "tmdate": 1700484844518,
                "mdate": 1700484844518,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "L2JpmVw1wi",
                "forum": "ktiikNTgK5",
                "replyto": "0gVMU7H0QP",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission1784/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission1784/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Author Response to Official Review by Reviewer uGct (3/4)"
                    },
                    "comment": {
                        "value": "> How to adjust the hyperparameters \u03bb1 and \u03bb2 using the AdamW optimizer? Can authors provide more details or an ablation study about that?\n\n**Response**: Thank you for the question! We have two AdamW optimizers in our pruning process. The first optimizer is used for optimizing the inserted LoRA modules for updating model parameters, while the second is used to learn differentiable masks. Specifically, \u03bb1 and \u03bb2 are optimized in conjunction with the second AdamW optimizer and the masks. These parameters, as gradient-enabled NN.parameters, are passed to the second AdamW optimizer. Given our initial reglr=0.05, they work together with the first AdamW optimizer to learn the best pruning decision. The value of 'reglr' can impact \u03bb1, \u03bb2, and the overall pruning performance. Specifically, a larger 'reglr' tends to optimize the Lagrangian loss in Equation 5, ensuring that the model sparsity of the pruned LLM strictly reaches the target sparsity ratio during the entire training process. Conversely, a smaller 'reglr' makes the pruning process more inclined to optimize the model prediction loss, but it may not guarantee a well-aligned sparsity ratio during the entire pruning process.\n\nTo validate this, we conduct an ablation study. As shown in the table below, in our original paper's experiment, we empirically set 'reglr' to 0.05. Now we chose a larger 'reglr' of 0.1 and a slightly smaller 'reglr' of 0.02. These three different 'reglr' values all can ensure that the model sparsity reaches the target sparsity ratio after pruning. However, both a large and small 'reglr' can impact the pruning performance. In our experiments, we empirically set 'reglr' to 0.05, and it performs well on both LLaMA-7B and 13B.\n\n\n|\u03bb1, \u03bb2| Commonsense Reasoning (0-shot) | Reading Comprehension (0-shot)|\n| :--:   | :--:    |:--:        |\n|0.1 | 56.10|56.13 |\n|0.05 (used in our experiments)| 60.09|60.35 |\n|0.02 | 58.54 | 56.36 |"
                    }
                },
                "number": 5,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission1784/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700484890461,
                "cdate": 1700484890461,
                "tmdate": 1700484890461,
                "mdate": 1700484890461,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "Zx4mp4dCYR",
                "forum": "ktiikNTgK5",
                "replyto": "0gVMU7H0QP",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission1784/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission1784/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Author Response to Official Review by Reviewer uGct (4/4)"
                    },
                    "comment": {
                        "value": "> Although Compresso is a one-shot pruning method, can the performance of LLMs be improved if we do Compresso iteratively?\n\n**Response**: Thank you for your thoughtful consideration and question! I appreciate your question, but there seems to be slight misunderstanding about Compresso. Contrary to the assumption that it is a one-shot pruning method, Compresso employs a collaborative pruning paradigm and differentiable masks. This allows it to learn optimal pruning decisions, making it more than a traditional one-shot method. I hope this clarification provides a clearer understanding of Compresso and its capabilities. Please let us know if you have any further questions. \n\n> Demonstrating the theoretical underpinnings of Compresso would greatly enhance the paper\n\n**Response**: Thanks for your suggestion! We acknowledge that theoretical analysis can provide deeper insight into our proposed pruning process. However, the behavior of LLMs remains unclear and is still an open question in the literature, making it challenging to conduct a theoretical analysis of our proposed pruning paradigm, especially regarding why our collaborative pruning prompt works. Instead, we conduct extensive experiments to demonstrate the effectiveness and generalizability of our approach. Our experiments span diverse datasets and multiple models under different sparsity ratios (new results on LLaMA13b can be found in the Appendix A.1), and show very promising results. We leave the theoretical analysis as the future works. \n\n\n> Can you explain the main difference between LoRA used in fine-tuning LLMs and the way used in pruning?\n\n**Response**: We appreciate your attention and have updated the PDF to address any confusion. Our initial goal was to emphansize that our method of optimizing differentiable masks naturally integrates with LoRA, as shown in equation (2). The implementation of LoRA used in fine-tuning and the way used in pruning in this paper are very similar, with the only differences being that both masks and LoRA modules are optimized together during pruning. \n\nHowever, we would like to emphasize that in the context of structured pruning based on training, traditional pruning methods and the recent Sheared LLaMA all require full gradient updates on the model parameters, which necessitate substantial training and GPU resources. By using LoRA to allow the update of a few model parameters during pruning, we can significantly reduce the training costs. For instance, we are able to run LLama13b on 4 V100 GPUs. However, this may also impact the pruning performance as only a few model parameters are allowed to update. Our Compresso demonstrates that it achieves superior performance despite these constraints."
                    }
                },
                "number": 6,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission1784/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700484925353,
                "cdate": 1700484925353,
                "tmdate": 1700484925353,
                "mdate": 1700484925353,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    }
]