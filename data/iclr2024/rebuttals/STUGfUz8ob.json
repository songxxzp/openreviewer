[
    {
        "title": "When can transformers reason with abstract symbols?"
    },
    {
        "review": {
            "id": "T80D4k3H6r",
            "forum": "STUGfUz8ob",
            "replyto": "STUGfUz8ob",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission6121/Reviewer_Fsbi"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission6121/Reviewer_Fsbi"
            ],
            "content": {
                "summary": {
                    "value": "This work presents an analysis of the abstract reasoning capability of the transformer architecture. The analysis yields a novel modification that improves out-of-distribution reasoning in symbolic tasks. The proposed modification also yields improved performance in an LLM (GPT-2) on a more realistic task."
                },
                "soundness": {
                    "value": "4 excellent"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "4 excellent"
                },
                "strengths": {
                    "value": "- The paper presents a formal analysis of OOD symbolic reasoning in both transformers and MLPs, finding that transformers, but not MLPs, are theoretically capable of a form of abstract symbolic reasoning, given sufficient training data diversity. This provides interesting insights into the source of reasoning capabilities in LLMs, and contrasts with the common view that their capabilities are due exclusively to scale. This sort of analysis is less common in reasoning papers, so it is a very welcome contribution.\n- The analysis yields a novel modification to transformers that further improves their abstract reasoning capabilities, improving sample efficiency on one class of tasks, and enabling generalization on another. \n- The proposed modification also yields improved performance in a pretrained LLM (GPT-2) on a realistic task (wikitext)."
                },
                "weaknesses": {
                    "value": "I think this paper provides a strong contribution. My comments are primarily about clarification and presentation:\n- The abstract and introduction refer to 'transformer large language models'. However, if I understand correctly, the experiments in Figures 1 and 2 are performed on transformers trained from scratch, not on LLMs (though an LLM is tested later on). If this is correct, I think it would be clearer to simply refer to transformers (rather than LLMs) in the abstract and introduction.\n- It would be helpful if an intuitive characterization of the proposed modifications ($aI$ and $bI$) could be provided earlier in the paper, along with some sense of why this modification helps.\n- Do the wikitext experiments involve OOD generalization in any sense (in the same way that the reasoning tasks do)? If not, I wonder whether this partly explains the smaller relative improvement from the modified models vs. GPT-2.\n- I was somewhat confused by the distinction between GPT-2 and 'GPT-2 pretrained' -- isn't GPT-2 by default pretrained (since this term refers to the trained model)? Just to clarify, do the results in Figure 4 reflect pretrained GPT-2, which is then fine-tuned on the wikitext datasets, or both of the models in this figure are trained from scratch only on wikitext?\n\nMinor comment:\n- The legend is cut off in figure 3a. In general the figure text is very small and difficult to read."
                },
                "questions": {
                    "value": "I found it interesting that GPT-2 already contains heads that implement a strategy similar to the modifications proposed in this paper. A preliminary investigation of GPT-4 suggests that it has a very strong ability to perform the abstract reasoning tasks from this paper based on just a few in-context examples. Do the authors expect that larger models (e.g. GPT-3 and GPT-4) may be able to perform these tasks without the proposed modifications, and if so how does that relate to the theoretical results? Do the authors expect that this capability would similarly depend on the emergence of heads that implement a diagonal attention strategy? Does the analysis in this paper have anything to say about the ability to learn these kinds of abstract reasoning tasks through *in-context* learning (as opposed to direct training of the model parameters)?\n\nI am also curious how the proposal in this work might relate to the idea of 'induction heads' [1]. Intuitively these seem to be related, in that both exploit the inductive biases of transformers to perform abstract tasks involving copying.\n\n[1] Olsson, C., Elhage, N., Nanda, N., Joseph, N., DasSarma, N., Henighan, T., ... & Olah, C. (2022). In-context learning and induction heads. arXiv preprint arXiv:2209.11895."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "8: accept, good paper"
                },
                "confidence": {
                    "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 1,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission6121/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698109624871,
            "cdate": 1698109624871,
            "tmdate": 1699636662928,
            "mdate": 1699636662928,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "yyb2unzuhf",
                "forum": "STUGfUz8ob",
                "replyto": "T80D4k3H6r",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6121/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6121/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Response"
                    },
                    "comment": {
                        "value": "## Thank you for your review\n\nThank you for your careful reading of the paper, your helpful suggestions on the presentation, and your interesting questions. Please see below for item-by-item responses.\n\n## Weaknesses\n\n> The abstract and introduction refer to 'transformer large language models'. However, if I understand correctly, the experiments in Figures 1 and 2 are performed on transformers trained from scratch, not on LLMs (though an LLM is tested later on). If this is correct, I think it would be clearer to simply refer to transformers (rather than LLMs) in the abstract and introduction.\n\nThank you for the suggestion. We will edit the intro and in particular our presentation of Figures 1 and 2 to make it clearer that those experiments are on language transformers and not pretrained language models.\n\n> It would be helpful if an intuitive characterization of the proposed modifications ($aI$ and  $bI$) could be provided earlier in the paper, along with some sense of why this modification helps.\n\nThank you for the suggestion. We will try to incorporate this into Section 1.1, and will expand on the intuition of the modifications in Section 4.2 and Section 5.\n\n> Do the wikitext experiments involve OOD generalization in any sense (in the same way that the reasoning tasks do)? If not, I wonder whether this partly explains the smaller relative improvement from the modified models vs. GPT-2.\n\nGood point. The Wikitext task is next-token prediction on Wikipedia, so it does not explicitly involve OOD generalization. There may be some implicit reasoning tasks in this problem, which could explain the improvement.\n\n> I was somewhat confused by the distinction between GPT-2 and 'GPT-2 pretrained' -- isn't GPT-2 by default pretrained (since this term refers to the trained model)? Just to clarify, do the results in Figure 4 reflect pretrained GPT-2, which is then fine-tuned on the wikitext datasets, or both of the models in this figure are trained from scratch only on wikitext?\n\nThese are models trained from scratch only on wikitext. We will clarify in the text.\n\n> The legend is cut off in figure 3a. In general the figure text is very small and difficult to read.\n\nOur apologies. This got accidentally introduced when we regenerated the figures right before submitting.\n\n## Questions\n> I found it interesting that GPT-2 already contains heads that implement a strategy similar to the modifications proposed in this paper. A preliminary investigation of GPT-4 suggests that it has a very strong ability to perform the abstract reasoning tasks from this paper based on just a few in-context examples. Do the authors expect that larger models (e.g. GPT-3 and GPT-4) may be able to perform these tasks without the proposed modifications, and if so how does that relate to the theoretical results? Do the authors expect that this capability would similarly depend on the emergence of heads that implement a diagonal attention strategy? Does the analysis in this paper have anything to say about the ability to learn these kinds of abstract reasoning tasks through in-context learning (as opposed to direct training of the model parameters)?\n\n* This is an excellent question. Unfortunately, our theory does not bear upon in-context learning. It seems that to understand that it will be necessary to understand feature-learning for these template tasks \u2013 our paper provides a baseline to build off of when conducting those future analyses.\n\n* We expect that the feature learning in the form of strong diagonal weights in the attention heads plays an important role in practice for both copying and for checking whether two symbols are equal. We do not know whether this learned weight structure is necessary for in-context learning to succeed, although our intuition is that it is. This is indeed a fantastic direction for future work.\n\n> I am also curious how the proposal in this work might relate to the idea of 'induction heads' [1]. Intuitively these seem to be related, in that both exploit the inductive biases of transformers to perform abstract tasks involving copying.\n\nThere is an interesting relation between our result and that work. Our result on copying, and our experiment in Figure 3a, indicate that the larger the embedding dimension, the more difficult it becomes for the model to learn to copy symbols it has not seen copied at training time. Thus, we should expect infinitely-large models to be unable to learn induction heads that generalize outside of the training data. So it would seem that transformer modifications are necessary for infinitely-large models if you want data-efficiency in learning to copy."
                    }
                },
                "number": 15,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6121/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700369265040,
                "cdate": 1700369265040,
                "tmdate": 1700369265040,
                "mdate": 1700369265040,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "417nd4Y5X2",
                "forum": "STUGfUz8ob",
                "replyto": "yyb2unzuhf",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6121/Reviewer_Fsbi"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6121/Reviewer_Fsbi"
                ],
                "content": {
                    "title": {
                        "value": "Response to rebuttal"
                    },
                    "comment": {
                        "value": "Thank you very much to the authors for the thorough responses. I enthusiastically support the paper's acceptance."
                    }
                },
                "number": 20,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6121/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700685824521,
                "cdate": 1700685824521,
                "tmdate": 1700685824521,
                "mdate": 1700685824521,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "LK6chKsVwT",
            "forum": "STUGfUz8ob",
            "replyto": "STUGfUz8ob",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission6121/Reviewer_xzui"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission6121/Reviewer_xzui"
            ],
            "content": {
                "summary": {
                    "value": "The paper investigates the \"variable-binding\" capability of transformers from a theoretic perspective, which refers to the generalization ability to handle unseen symbols during training. To formulate the variable-binding ability, the authors propose a framework called template tasks. Then the authors prove that a simplified transformer block can generalize to unseen input symbols when the output is a binary label, but cannot generalize when the output label is also dependent on novel input symbols. Finally, the authors propose a simple mechanism to augment the attention layer in transformers which is empirically shown to be effective."
                },
                "soundness": {
                    "value": "2 fair"
                },
                "presentation": {
                    "value": "2 fair"
                },
                "contribution": {
                    "value": "2 fair"
                },
                "strengths": {
                    "value": "- The author provides a theoretical formulation of variable-binding tasks called template tasks.\n- Proofs are provided for the capability and limitations of a simplified transformer architecture on two instantiations of template tasks. \n- Extensive empirical experiments are conducted on the template task framework."
                },
                "weaknesses": {
                    "value": "My main concern lies in the assumption of the proof. Throughout the whole paper, the authors assume a simplified depth-1 transformer architecture without residual connections and layer normalization. However, residual connections and layer normalization are known to be crucial for the performance of transformers [1][2]. The simplification limits the applicability of the main theoretical conclusions to more practical settings. On the other hand, all empirical results use a vanilla depth-2 transformer without modification. This makes it hard to draw direct parallels to justify the practical implications of the theoretical results.\n\n[1] On Layer Normalization in the Transformer Architecture. ICML 2020\n[2] Transformer Feed-Forward Layers Are Key-Value Memories. Mor Geva, et al. EMNLP 2021"
                },
                "questions": {
                    "value": "As I mentioned in the weakness section, I am especially interested in authors' opinions about how to extend the main proof in the paper to more practical transformer architecture with residual connections and layer normalization."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "6: marginally above the acceptance threshold"
                },
                "confidence": {
                    "value": "1: You are unable to assess this paper and have alerted the ACs to seek an opinion from different reviewers."
                },
                "code_of_conduct": {
                    "value": "Yes"
                },
                "first_time_reviewer": {
                    "value": "Yes",
                    "readers": [
                        "ICLR.cc/2024/Conference/Program_Chairs",
                        "ICLR.cc/2024/Conference/Submission6121/Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission6121/Reviewer_xzui",
                        "ICLR.cc/2024/Conference/Submission6121/Senior_Area_Chairs"
                    ]
                }
            },
            "number": 2,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission6121/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698799077829,
            "cdate": 1698799077829,
            "tmdate": 1700729963241,
            "mdate": 1700729963241,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "CD0N3RVijY",
                "forum": "STUGfUz8ob",
                "replyto": "LK6chKsVwT",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6121/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6121/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Response"
                    },
                    "comment": {
                        "value": "## Thank you for your review\nThank you for your positive comments and your helpful question. We address this question below.\n## Weaknesses\n> My main concern lies in the assumption of the proof. Throughout the whole paper, the authors assume a simplified depth-1 transformer architecture without residual connections and layer normalization. However, residual connections and layer normalization are known to be crucial for the performance of transformers [1][2]. The simplification limits the applicability of the main theoretical conclusions to more practical settings. On the other hand, all empirical results use a vanilla depth-2 transformer without modification. This makes it hard to draw direct parallels to justify the practical implications of the theoretical results.\n\n* As far as theoretical results, the self-attention+MLP setting in our work is not unusual and even goes beyond many theoretical works. All known theoretical analyses of transformer training dynamics use a combination of simplifications such as: (a) removing the softmax to get a linear attention mechanism, (b) replacing the $W_KW_Q^T$ matrices with just one matrix $W_{KQ}$ and similarly for $W_VW_O^T$, (c) considering only one layer, (d) assuming diagonal weight matrices, (e) removing layernorms and residual connections, and (f) even removing the MLP layers.\n* Furthermore, we believe that the same ideas in our analysis could be used to prove our theoretical results in the multilayer setting with residual connections \u2013 but this would require an even more involved analysis than what we currently have here, and we did not write this because we feel that the more convoluted technical arguments would distract from the main ideas of the proof which only need one self-attention layer + one MLP layer.\n\n* In our experiments, we do train standard multilayer transformers with residual connections and layer norm. These include practical models such as GPT-2 where we show a benefit of our theory-inspired modifications.\n\n* We will be clearer about our experimental details in the revision, explaining more clearly how the theoretical and experimental setups differ. In the revision, we will also  add extra experiments on deeper transformers (we do have some experiments for deeper transformers with up to 16 layers already in Figures 2,6,7). The 2-layer choice for most of our experiments was due to the larger computational cost of training deeper transformers.\n\n* Finally, we believe that our theory is relevant to practice since it suggests modifications to the transformer that improve data-efficiency on the reasoning tasks in practice by an order of magnitude."
                    }
                },
                "number": 9,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6121/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700275510505,
                "cdate": 1700275510505,
                "tmdate": 1700275679836,
                "mdate": 1700275679836,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "mtC5Ewxq4G",
                "forum": "STUGfUz8ob",
                "replyto": "CD0N3RVijY",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6121/Reviewer_xzui"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6121/Reviewer_xzui"
                ],
                "content": {
                    "comment": {
                        "value": "Thanks authors for addressing my concerns. I will raise my score to accept."
                    }
                },
                "number": 21,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6121/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700729951319,
                "cdate": 1700729951319,
                "tmdate": 1700729951319,
                "mdate": 1700729951319,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "dgI4VD7mg4",
            "forum": "STUGfUz8ob",
            "replyto": "STUGfUz8ob",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission6121/Reviewer_jCDP"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission6121/Reviewer_jCDP"
            ],
            "content": {
                "summary": {
                    "value": "This manuscript studies the ability of transformers to reason with abstract binding --- or symbol binding. The authors contrast MLPs and transformers and argue how MLPs trained with gradient descent are incapable of abstract reasoning. They then show how transformers on the other hand are capable of abstract reasoning given lots of data. Finally, they propose an a transformer variant that generalizes faster to the symbol binding task and verify the same empirically."
                },
                "soundness": {
                    "value": "4 excellent"
                },
                "presentation": {
                    "value": "4 excellent"
                },
                "contribution": {
                    "value": "3 good"
                },
                "strengths": {
                    "value": "The paper was a great read! The authors conduct a thorough theoretical analysis with practical insights suggesting changes to the transformer architecture. The work studies if transformers are capable of symbol binding, which is very important question and of broad interest to the community. The paper presents a diverse set of results, but makes them easy to understand to a broader audience too.\n\nThe template tasks are elegant and easy to understand. It grounds the problem in a concrete scenario that can be studied. The authors present concrete insights for real labels and symbolic labels and identify different sample complexity behaviors for both scenarios. The work identifies important factors like data diversity or transformer embedding size that change the convergence behavior.\n\nThe authors use their theory to develop practical insights for developing transformer architectures. In particular, they show experiments on a synthetic dataset and on Wikitext to validate their proposed modification."
                },
                "weaknesses": {
                    "value": "The theory for the transformers seems to rely on training only the final layer of the transformer. Does that mean that there are other architectures that can also do symbol binding? It is unclear which aspect of transformers are important for symbol binding: is the attention, the MLP, the invariance properties or something else? It isn't entirely clear to me how \n\nA limitation of most theory that uses the PAC framework often has vacuous bounds. While the paper derives asymptotic trends, it is unclear if they will predictive of what happens in practice as a result. However, I also acknowledge that this is the case for lot of theorems about deep networks. It is unclear if this probabilistic framework is the right tool for analysis."
                },
                "questions": {
                    "value": "1. The proof for the failure of MLPs relies on taking an expectation over $\\theta_t$ obtained through gradient descent. Does this also hold for a single run of an MLP training. Is it possible for MLPs to converge some of the time (and not with probability at least $1 - \\delta$ )?\n2. The proof seems to rely on the kernel ridge regression estimator. Does this mean that representation learning is not critical for symbol binding?\n3. If the data diversity is small (data follows a Zipf distribution), then do these results hold? In practice we expect datasets to follows such distributions and I am unsure if I am misunderstanding the theorem incorrectly. \n4. Are there technical reasons for using the kernel regression with gradient flow in section 4, but the cross-entropy loss with next-token prediction for section 5? Is it possible to conduct an analysis similar to section 4 if we consider next token prediction?"
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "8: accept, good paper"
                },
                "confidence": {
                    "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                },
                "first_time_reviewer": {
                    "value": "Yes",
                    "readers": [
                        "ICLR.cc/2024/Conference/Program_Chairs",
                        "ICLR.cc/2024/Conference/Submission6121/Senior_Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission6121/Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission6121/Reviewer_jCDP"
                    ]
                }
            },
            "number": 3,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission6121/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698952253214,
            "cdate": 1698952253214,
            "tmdate": 1699636662660,
            "mdate": 1699636662660,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "PKU3V2zp4U",
                "forum": "STUGfUz8ob",
                "replyto": "dgI4VD7mg4",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6121/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6121/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Response (1/2)"
                    },
                    "comment": {
                        "value": "## Thank you for your review\nWe are very glad that you enjoyed the paper, and we thank you for your thoughtful comments and insightful questions. We address these below.\n\n## Weaknesses\n> The theory for the transformers seems to rely on training only the final layer of the transformer. Does that mean that there are other architectures that can also do symbol binding? It is unclear which aspect of transformers are important for symbol binding: is the attention, the MLP, the invariance properties or something else? It isn't entirely clear to me how\n\n* Our analysis identifies the condition number of the N matrix as a key driver of the sample complexity for learning the template task. This condition number is always infinite for MLPs, and so they do not perform symbol binding. (In fact, we prove that MLPs do not perform symbol binding even when all parameters are trained.)\n\n* For non-transformer architectures, the condition number of the N matrix might be finite, in which case those architectures would also perform symbol binding. However, we only prove this for transformers in this paper. We will improve the clarity of the proof sketch in Section 4.2 of Lemmas 4.6 and 4.7 in the revision to better explain why the condition number is finite. The main reason is due to the self-attention layer, which, roughly speaking, allows the architecture to access the matrix XX^T. This matrix contains information about which symbols in the string are repeated and where. We will also improve the explanation in Section 4.3 for how this insight motivates the $W_KW_Q^T + aI$ modification. Here it may be illustrative to give concrete bounds on the condition number before/after the modification for the same-different task.\n\n* Re: training only the last layer, please also see our answer to the question 2 below. \n\n> A limitation of most theory that uses the PAC framework often has vacuous bounds. While the paper derives asymptotic trends, it is unclear if they will predictive of what happens in practice as a result. However, I also acknowledge that this is the case for lot of theorems about deep networks. It is unclear if this probabilistic framework is the right tool for analysis.\n\n* Yes, our sample complexity bounds are indeed non-quantitative in terms of the number and structure of the templates. The bounds could in principle be numerically computed by estimating the network\u2019s kernel matrix.\n\n* Nevertheless, we do get a qualitative result on the capabilities of transformers on symbol binding tasks. And we believe that our theory is relevant to practice since it suggests modifications to the transformer that improve data-efficiency on the reasoning tasks in practice by an order of magnitude."
                    }
                },
                "number": 12,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6121/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700350158445,
                "cdate": 1700350158445,
                "tmdate": 1700350158445,
                "mdate": 1700350158445,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "kgr1ZBgXff",
            "forum": "STUGfUz8ob",
            "replyto": "STUGfUz8ob",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission6121/Reviewer_gjp1"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission6121/Reviewer_gjp1"
            ],
            "content": {
                "summary": {
                    "value": "In this work, the authors aim to establish and understand the abilities of self-attention architecture to solve variable binding tasks. I find the targeted problem both valuable and exciting---indeed, variable binding is a core intelligence capability and yet we have not seen sufficient work in the community targeting it as a direct benchmark for understanding limitations of existing models. I think this work is a step in the right direction therefore."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "3 good"
                },
                "strengths": {
                    "value": "As noted in the summary, I find the targeted problem valuable and exciting. The theoretical framework itself involves several assumptions that are arguably impractical (making this essentially a kernel regression take on LLMs paper), but nonetheless the tasks established earlier in the paper are very well described and the results are accordingly insightful."
                },
                "weaknesses": {
                    "value": "1. I think the authors are over-claiming their results at several points. The simplified architecture that is studied in this work, i.e., a self-attention + MLP model, is not justified to be labeled a Transformer. Residual connections play a huge role in both optimization stability and, e.g., some of the seemingly emergent abilities of Transformers. In this sense, I would argue the paper is actually focused on understanding inductive biases and limitations of a feedforward, MLP model with self-attention. This is totally fine, but the over-claiming can yield, in my opinion, an incorrect takeaway that Transformers broadly cannot perform the variable binding tasks. It may also be worth mentioning that the results focus on a inference with a single pass through the model, i.e., tools like in-context learning or chain-of-though can impact the results. The latter is just a nitpick to better contextualize the paper's findings.\n\n2. Lack of experimental details: While the authors often state that their theoretical claims focus on a simplified architecture, it is unclear to me if the experiments involve this simplified architecture or an actual Transformer, i.e., with residual connections, is used. Generally, I think the experimental details can be improved.\n\n3. Relation with prior theoretical works on inductive biases of self-attention: A specific work that addresses a similar question as this paper is Edelman et al. [1]. Therein, the authors show a self-attention model can express sparse boolean circuits and performs implicit variable creation during forward inference. I think the work deserves thorough discussion in the current paper's related work. A few more empirical works also exist on this problem, e.g., Davies et al. [2], that will be worth discussing.\n\n4. Discussion with Systematic generalization: I would argue the tasks that the authors studied are extremely related to what NLP community has studied under the label of systematic generalization before. I think such papers warrant discussion as well (e.g., see [3]).\n \n\n\n[1] Inductive Biases and Variable Creation in Self-Attention Mechanisms, Edelman et al., 2022.\n\n[2] Discovering Variable Binding Circuitry with Desiderata, Davies et al., 2023\n\n[3] Compositionality Decomposed: How do Neural Networks Generalise?, Hupkes et al., 2020"
                },
                "questions": {
                    "value": "The proposed changes based on the theoretical models involve addition of a scaled identity matrix to parts of the attention matrices. This looks, at a surface, like addition of a residual connection in fact. Can the authors clarify this further? I found the discussion of this point to be quite unclear."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "8: accept, good paper"
                },
                "confidence": {
                    "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
                },
                "code_of_conduct": {
                    "value": "Yes"
                },
                "first_time_reviewer": {
                    "readers": [
                        "ICLR.cc/2024/Conference/Program_Chairs",
                        "ICLR.cc/2024/Conference/Submission6121/Senior_Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission6121/Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission6121/Reviewer_gjp1"
                    ]
                }
            },
            "number": 4,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission6121/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1699062396919,
            "cdate": 1699062396919,
            "tmdate": 1700670523782,
            "mdate": 1700670523782,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "ekAOLo5Qps",
                "forum": "STUGfUz8ob",
                "replyto": "kgr1ZBgXff",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6121/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6121/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Response (1/2)"
                    },
                    "comment": {
                        "value": "## Thank you for your review\nThank you for your positive comments and detailed constructive feedback. We are glad that you found this problem exciting and thought our results are a step in the right direction. Your questions and concerns are addressed point by point below.\n\n## Weaknesses\n> Weaknesses: As noted in the summary, I find the targeted problem valuable and exciting. The theoretical framework itself involves several assumptions that are arguably impractical (making this essentially a kernel regression take on LLMs paper), but nonetheless the tasks established earlier in the paper are very well described and the results are accordingly insightful.\n\n* As far as we are aware, there are **no previous results that prove the ability of transformers to learn to perform symbolic reasoning tasks** when trained. Our paper is the first to formalize a framework of such reasoning tasks and to prove it is learned by transformers when trained.\n\n\n* It was quite **unexpected to us that the transformer kernel analysis is sufficient** to characterize when the relational reasoning tasks can be learned. We began this work with the mindset that we would have to study feature-learning dynamics. Nevertheless, with the kernel analysis, we were able to *characterize* when the relational reasoning can be learned by large transformers (it can be learned anytime there is no copying of placeholder symbols; it cannot be learned when there is).\n\n\n* **The analysis was considerably involved**: (i) This is not a typical kernel method analysis where it is proved that the data can be memorized \u2013 instead, we must show that the network *generalizes in the correct way out of distribution*, for any task in our framework. (ii) Also, insofar as we know, this is also the first paper that manages to analyze how the transformer kernel learns a nontrivial task, due to the technical difficulties involved in studying this kernel. The technical tools we develop here may thus be useful for future work.\n\n\n\n* We believe that our theory is relevant since it suggests modifications to the transformer that **improve data-efficiency on the reasoning tasks in practice by an order of magnitude**.\n\n\n* **Our work opens up many directions** that we feel are outside of the scope of the current paper. One direction is to study feature learning. We completely agree that it is an excellent question to ask: can we characterize if/when feature learning is more powerful than NTK? But, to ask this question, an NTK analysis as in this paper is needed first. In the revision, we will add experiments comparing feature learning to NTK training \u2013 these indicate that feature learning is intriguingly more data-efficient on the relational reasoning tasks (although NTK also learns given enough data).\n\n* On a more philosophical note, our results raise the question: to what extent is transformer reasoning due to NTK, and to what extent is it due to feature learning such as head specialization? This is a highly relevant question in the context of interpreting the internal workings of transformers. The more NTK-like the solution, the more polysemantic heads that the network will have, and so the harder it will be to interpret a network by extracting sparse subnetworks (which is currently the main method of the mechanistic interpretability literature). It appears quite relevant to the reference [3] that you have pointed out."
                    }
                },
                "number": 7,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6121/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700274658568,
                "cdate": 1700274658568,
                "tmdate": 1700275602189,
                "mdate": 1700275602189,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "xo56Bcbf0C",
                "forum": "STUGfUz8ob",
                "replyto": "kgr1ZBgXff",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6121/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6121/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Response (2/2)"
                    },
                    "comment": {
                        "value": "## Questions\n> 1. I think the authors are over-claiming their results at several points. The simplified architecture that is studied in this work, i.e., a self-attention + MLP model, is not justified to be labeled a Transformer. Residual connections play a huge role in both optimization stability and, e.g., some of the seemingly emergent abilities of Transformers. In this sense, I would argue the paper is actually focused on understanding inductive biases and limitations of a feedforward, MLP model with self-attention. This is totally fine, but the over-claiming can yield, in my opinion, an incorrect takeaway that Transformers broadly cannot perform the variable binding tasks. It may also be worth mentioning that the results focus on a inference with a single pass through the model, i.e., tools like in-context learning or chain-of-though can impact the results. The latter is just a nitpick to better contextualize the paper's findings.\n\n* We are sorry that we give the impression of overclaiming. It is not at all our intention to overclaim. Our reasoning is as follows:\n    *  As far as theoretical results, the self-attention+MLP setting in our work is not unusual and even goes beyond many theoretical works. All known theoretical analyses of transformer training dynamics use a combination of simplifications such as: (a) removing the softmax to get a linear attention mechanism, (b) replacing the $W_KW_Q^T$ matrices with just one matrix $W_{KQ}$ and similarly for $W_VW_O^T$, (c) considering only one layer, (d) assuming diagonal weight matrices, (e) removing layernorms and residual connections, and (f) even removing the MLP layers.\n    * Furthermore, we believe that the same ideas in our analysis could be used to prove our theoretical results in the multilayer setting with residual connections \u2013 but this would require an even more involved analysis than what we currently have here, and we did not write this because we feel that the more convoluted technical arguments would distract from the main ideas of the proof which only need one self-attention layer + one MLP layer.\n\n    * In our experiments, we do train standard multilayer transformers, including practical models such as GPT-2 where we show a benefit of our theory-inspired modifications.\n\n* With respect to \u201cthe takeaway that Transformers broadly cannot perform the variable binding tasks\u201d, this was not our intention. Our intention was only to highlight that a large amount of data is needed for simple variable binding tasks, and that theory-inspired modifications can lower that amount of data substantially. Also, we uncovered an intriguing inverse scaling law for copying which shows that making transformers larger can actually break down some of their reasoning abilities on unseen symbols.\n\n> 2. Lack of experimental details: While the authors often state that their theoretical claims focus on a simplified architecture, it is unclear to me if the experiments involve this simplified architecture or an actual Transformer, i.e., with residual connections, is used. Generally, I think the experimental details can be improved.\n* Thank you for your suggestion. We will make it clearer that our experiments are on standard multilayer transformers with residual connections and layer-norm.\n\n> 3. Relation with prior theoretical works on inductive biases of self-attention: A specific work that addresses a similar question as this paper is Edelman et al. [1]. Therein, the authors show a self-attention model can express sparse boolean circuits and performs implicit variable creation during forward inference. I think the work deserves thorough discussion in the current paper's related work. A few more empirical works also exist on this problem, e.g., Davies et al. [2], that will be worth discussing.\n\n* Thank you for the references. These seem interesting and we will certainly incorporate discussion in the revision.\n\n\n> 4. Discussion with Systematic generalization: I would argue the tasks that the authors studied are extremely related to what NLP community has studied under the label of systematic generalization before. I think such papers warrant discussion as well (e.g., see [3]).\n* Thank you. We were unaware of this reference. Interestingly, our results show that reasoning is possible even without neuron/head specialization, which appears quite relevant to this reference. We will incorporate a discussion in the revision."
                    }
                },
                "number": 8,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6121/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700274748963,
                "cdate": 1700274748963,
                "tmdate": 1700275665551,
                "mdate": 1700275665551,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "gB1Ok4jBns",
                "forum": "STUGfUz8ob",
                "replyto": "kgr1ZBgXff",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6121/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6121/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Response (3/2)"
                    },
                    "comment": {
                        "value": "Our apologies: we missed answering your question earlier.\n\n> The proposed changes based on the theoretical models involve addition of a scaled identity matrix to parts of the attention matrices. This looks, at a surface, like addition of a residual connection in fact. Can the authors clarify this further? I found the discussion of this point to be quite unclear.\n\nThe $W_VW_O^T + bI$ modification is adding an \"attention-modulated\" skip connection. It is a skip connection except that it is multiplied by the attention matrix.\n\nThe $W_KW_Q^T + aI$ modification does not seem to have this interpretation. Instead, it encourages the attention head to use the matrix XX^T of the data, which encodes which symbols are repeated and where."
                    }
                },
                "number": 14,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6121/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700367979416,
                "cdate": 1700367979416,
                "tmdate": 1700367990733,
                "mdate": 1700367990733,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "4gUWsfrRSg",
                "forum": "STUGfUz8ob",
                "replyto": "kgr1ZBgXff",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6121/Reviewer_gjp1"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6121/Reviewer_gjp1"
                ],
                "content": {
                    "comment": {
                        "value": "Thank you for the response. I want to emphasize that I'm still critical of the writeup and argue that the writing is over-claiming what is shown. For example, quoting the abstract, \"we prove that Transformers can generalize to unseen symbols but require astonishingly large training data\". This is not true, however---the proved result is for a simplified scenario. The authors' rebuttal, i.e., that they *believe* that their theoretical results can be extended is insufficient to make a broad claim. If they prefer to make such a claim, it is important to say that they prove the result for a simplified setup and *hypothesize* the proof can be extended further. Similarly, the argument that empirical results indicate practical models fail to perform variable binding is not appropriate to vindicate the statement that \"we prove Transformers can generalize to unseen symbols but require astonishingly large training data\". \n\nOverall, I stress that it is important that over-claiming is avoided. I sincerely hope the writing will be addressed in the final version of the paper and am choosing to keep my score as is assuming that the authors will make the change."
                    }
                },
                "number": 16,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6121/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700626479008,
                "cdate": 1700626479008,
                "tmdate": 1700670542906,
                "mdate": 1700670542906,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "JU5NAMvdEj",
                "forum": "STUGfUz8ob",
                "replyto": "kgr1ZBgXff",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6121/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6121/Authors"
                ],
                "content": {
                    "comment": {
                        "value": "Thank you for getting back to us. We will definitely make changes to the abstract + intro to make it clearer earlier on what exactly it is that we show. To summarize:\n\n* Our theory showing that transformers can learn to reason is for one-layer transformer (= self-attention + MLP). This theory \nshows that this simple architecture is already capable of learning these relational reasoning tasks.\n\n* Our experiments showing that transformers need a large number of samples to learn to reason are for multilayer transformers & even for non-pretrained GPT-2. Also, our theory indicates that the need for a large number of samples is due to the poor conditioning of the matrix N associated with the architecture & template task. (Note: Once you pretrain GPT-2, then it is requires many fewer samples to learn to reason, and we have some discussion on this in Section 6.)\n\n* To be more clear about our previous comment in this thread, we are fairly confident that we could extend our theory to show that \nmultilayer transformers with residual connections learn, but the analysis would be messy & would not give qualitative insights beyond what we already have in this paper.\n\nSo our revision will make these changes: In the abstract, we will specify that the theoretical achievability result is for one-layer transformers & that our observation on large # of samples is mainly empirical. In the introduction, we will also put the \"one-layer\" qualifier when appropriate. In general, we will edit to clarify what our theory proves on one-layer transformers, versus how it informs the experiments & transformer modifications, which are conducted for multi-layer transformers."
                    }
                },
                "number": 17,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6121/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700669676497,
                "cdate": 1700669676497,
                "tmdate": 1700669734796,
                "mdate": 1700669734796,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "7K0ii3GAtM",
                "forum": "STUGfUz8ob",
                "replyto": "JU5NAMvdEj",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6121/Reviewer_gjp1"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6121/Reviewer_gjp1"
                ],
                "content": {
                    "comment": {
                        "value": "Perfect, thank you for taking the comments into thorough consideration! I've increased my score accordingly."
                    }
                },
                "number": 18,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6121/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700670507587,
                "cdate": 1700670507587,
                "tmdate": 1700670507587,
                "mdate": 1700670507587,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "MCQ34LT6VP",
            "forum": "STUGfUz8ob",
            "replyto": "STUGfUz8ob",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission6121/Reviewer_5tFF"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission6121/Reviewer_5tFF"
            ],
            "content": {
                "summary": {
                    "value": "This work studies the ability / inability of transformers to learn certain symbolic reasoning tasks, specifically real valued (\u201ca=+1, print(a)\u201d -> +1) and symbolic valued (\u201ca = `q\u2019 , print(a)\u201d => q) template tasks. To study whether models can learn a rule for an arbitrary new input symbols, they invoke a slightly different concept of generalization under distribution shift known as \u201cgeneralization to the unseen.\u201d This measures the intuitive notion of generalization of a rule to arbitrary inputs rather than inputs from the same distribution used for training (which is the usual notion of generalization in ML).  For both of these symbolic tasks, the authors argue that the permutation symmetry of multi-layer perceptrons (MLPs) trained with SGD prevents them from generalizing to unseen symbols (Appendix I). For transformer architectures, an analysis of the initial feature kernel under random Gaussian weights reveals that transformers can generalize on real-valued symbolic reasoning tasks by training the readouts only. The reason for this generalization follows from an approximation of the empirical kernel matrix as block diagonal with each block representing the inputs from a single template: K(x_a, x_{a\u2019}) = K(x_b,x_{b\u2019}) for x_a, x_b from template 1 and x_a\u2019 , x_b\u2019 from template 2. This approximation becomes increasingly valid as the \u201cdata diversity\u201d metric introduced by the authors increases. This approximation allows the authors to work with a # template x # template gram matrix N, which they show to be non-singular. The importance of having a well-conditioned the N matrix suggests a possible improvement to transformers where an identity matrix is added to the weight innerproducts WK WQ -> WK Wq +  a * Identity, etc. The authors show this improves generalization in their task. For symbolic tasks, the authors show that the gradient descent updates are orthogonal to the directions which would reduce the loss when the embedding dimension is large. They provide experiments verifying that large embedding dimension worsens performance on copy tasks."
                },
                "soundness": {
                    "value": "4 excellent"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "3 good"
                },
                "strengths": {
                    "value": "This paper studies an important problem of generalization to unseen symbols in transformer architectures. Much of the contribution is formalizing a set of symbolic reasoning tasks which can be analyzed in different architectures. The authors give a theoretical analysis that suggests implementation tweaks (adding the identity matrices) which improve performance on real-valued template tasks and preserve good performance on natural language modeling. They also give an important separation result between multi-layer perceptrons and transformer architectures and explain why the transformers can learn the real-valued regression tasks at large width. Lastly they observe that large embedding dimension can be harmful in transformers on copy tasks. I appreciate the effort the authors took in performing experiments (several in the Appendix) to evaluate their theoretical claims, which are often lacking in theory papers."
                },
                "weaknesses": {
                    "value": "Though the paper provides some generic results about architectures for MLPs, the main result for transformers relies on operating the model in the kernel regime. It is unclear at the moment if any of the results would change (1) at finite width or (2) in the feature learning regime (see questions below). Further, the proposed theory bounds the generalization error in terms of the data diversity metric, which does not have an obvious scaling with samples n, making it hard to reason about the number of samples needed to attain good generalization."
                },
                "questions": {
                    "value": "1. Do the sample complexity results / rank of N matrix change if you allow the network to learn its internal weights rather than just the readout weights? \n2. Do the authors have any empirical evidence showing the emergence of this block diagonal structure in the NNGP kernel at initialization (I imagine this would be easy to compute)? The block-diagonal approximation seems reasonable, but some empirical support + visualization could be useful. A similar comparison of the predictor from kernel regression and the average of the labels over a template could also be useful. \n3. Do the authors have a sense of how wide the transformer must be compared to samples n, templates r, etc for the theory to be accurate (N non-singular etc)? Wouldn\u2019t the kernels become singular at some finite width? What if every layer is trained at large width (NTK vs NNGP)? Do real networks (which learn features) have to be as wide as kernel analysis would suggest? \n4. The perplexity improvements on GPT + Wikitext seem rather small. Does this suggest that transformers trained in practice evolve to have well conditioned N matrices, removing the need to add an explicit identity matrix? Is this related to the pronounced diagonals in Wv Wo the authors report in the next section? Or is the idea that real data behaves differently than the proposed template tasks? \n5. In Theorem 1.1 it may be helpful to clarify that the gradient flow is only performed on the last layer. \n\n\nSmall typos\n1. Figure 3b caption should read W_V W_O^T  (transpose dropped in second writing)\n2. Page 28 d/dx in the Wronskian should be d/dt"
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "8: accept, good paper"
                },
                "confidence": {
                    "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
                },
                "code_of_conduct": {
                    "value": "Yes"
                },
                "first_time_reviewer": {
                    "readers": [
                        "ICLR.cc/2024/Conference/Program_Chairs",
                        "ICLR.cc/2024/Conference/Submission6121/Senior_Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission6121/Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission6121/Reviewer_5tFF"
                    ]
                }
            },
            "number": 5,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission6121/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1699537485064,
            "cdate": 1699537485064,
            "tmdate": 1700320705971,
            "mdate": 1700320705971,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "AprXoiIU4d",
                "forum": "STUGfUz8ob",
                "replyto": "MCQ34LT6VP",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6121/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6121/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Response (1/2)"
                    },
                    "comment": {
                        "value": "## Thank you for your review\n\nThank you for the in-depth reading of our paper and your insightful and constructive comments. We are glad that you found the problem setting significant, the new formalization interesting, and the separation with fully-connected networks important, and that you also appreciated the in-depth experimental analyses that support our claims. We address your questions and concerns item-by-item below.\n\n## Weaknesses\n> Though the paper provides some generic results about architectures for MLPs, the main result for transformers relies on operating the model in the kernel regime. It is unclear at the moment if any of the results would change (1) at finite width or (2) in the feature learning regime (see questions below).\n\nRe: (1) finite width\n\n* We will add experiments in the appendix to the revision where we vary the width of the network.\n\nRe: (2) feature learning vs. kernel analysis\n\n* As far as we are aware, there are **no previous results that prove the ability of transformers to learn to perform symbolic reasoning tasks** when trained. Our paper is the first to formalize a framework of such reasoning tasks and to prove it is learned by transformers when trained.\n\n\n* It was quite **unexpected to us that the transformer kernel analysis is sufficient** to characterize when the relational reasoning tasks can be learned. We began this work with the mindset that we would have to study feature-learning dynamics. Nevertheless, with the kernel analysis, we were able to *characterize* when the relational reasoning can be learned by large transformers (it can be learned anytime there is no copying of placeholder symbols; it cannot be learned when there is).\n\n\n* **The analysis was considerably involved**: (i) This is not a typical kernel method analysis where it is proved that the data can be memorized \u2013 instead, we must show that the network *generalizes in the correct way out of distribution*, for any task in our framework. (ii) Also, insofar as we know, this is also the first paper that manages to analyze how the transformer kernel learns a nontrivial task, due to the technical difficulties involved in studying this kernel. The technical tools we develop here may thus be useful for future work.\n\n\n* Note also that **all known theoretical analyses of transformer dynamics use a combination of simplifications** such as: (a) removing the softmax to get a linear attention mechanism, (b) replacing the $W_KW_Q^T$ matrices with just one matrix $W_{KQ}$ and similarly for $W_VW_O^T$, (c) considering only one layer, (d) assuming diagonal weight matrices, (e) removing layernorms and residual connections.\n\n\n\n* We believe that our theory is relevant since it suggests modifications to the transformer that **improve data-efficiency on the reasoning tasks in practice by an order of magnitude**.\n\n\n* **Our work opens up many directions** that we feel are outside of the scope of the current paper. One direction is to study feature learning. We completely agree that it is an excellent question to ask: can we characterize if/when feature learning is more powerful than NTK? But, to ask this question, an NTK analysis as in this paper is needed first. In the revision, we will add experiments comparing feature learning to NTK training \u2013 these indicate that feature learning is intriguingly more data-efficient on the relational reasoning tasks (although NTK also learns given enough data).\n\n* On a more philosophical note, our results raise the question: to what extent is transformer reasoning due to NTK, and to what extent is it due to feature learning such as head specialization? This is a highly relevant question in the context of interpreting the internal workings of transformers. The more NTK-like the solution, the more polysemantic heads that the network will have, and so the harder it will be to interpret a network by extracting sparse subnetworks (which is currently the main method of the mechanistic interpretability literature).\n\n\n> Further, the proposed theory bounds the generalization error in terms of the data diversity metric, which does not have an obvious scaling with samples n, making it hard to reason about the number of samples needed to attain good generalization.\n\nA large number of samples n is not enough, because all n samples could be copies of each other, in which case the algorithm will not be able to generalize beyond the training data distribution. Therefore, it is necessary to have a control on the data diversity. We opt in our case to have a parameter rho which measures diversity, but otherwise we are agnostic to the data distribution."
                    }
                },
                "number": 5,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6121/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700273399074,
                "cdate": 1700273399074,
                "tmdate": 1700275588534,
                "mdate": 1700275588534,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "SLVygSuqa4",
                "forum": "STUGfUz8ob",
                "replyto": "MCQ34LT6VP",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6121/Reviewer_5tFF"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6121/Reviewer_5tFF"
                ],
                "content": {
                    "title": {
                        "value": "Response to Rebuttal"
                    },
                    "comment": {
                        "value": "I thank the authors for their detailed responses to all of my questions. I really appreciate the novelty and analysis of this paper so I am in favor of acceptance and will raise my score.\n\nWith the promised additional numerical tests, I think this paper would be a nice addition to ICLR."
                    }
                },
                "number": 10,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6121/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700320693174,
                "cdate": 1700320693174,
                "tmdate": 1700320693174,
                "mdate": 1700320693174,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    }
]