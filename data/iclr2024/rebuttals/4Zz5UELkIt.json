[
    {
        "title": "Adaptive Instrument Design for Indirect Experiments"
    },
    {
        "review": {
            "id": "y24Z8IMSnB",
            "forum": "4Zz5UELkIt",
            "replyto": "4Zz5UELkIt",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission1014/Reviewer_QTvC"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission1014/Reviewer_QTvC"
            ],
            "content": {
                "summary": {
                    "value": "The paper introduces the computational procedure DIA to increase the sample efficiency for indirect experiments for CATE estimation.  Specifically, the procedure leverages influence functions for iteratively optimizing the data collection policy through adaptive instrument selection.  Optimality is defined through a minimal mean-squared error of the estimator.  The paper emphasizes the applicability of the theoretical procedure through experiments conducted on two synthetic datasets and an extended version of the semi-synthetic TripAdvisor dataset."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "2 fair"
                },
                "contribution": {
                    "value": "3 good"
                },
                "strengths": {
                    "value": "1) To the best of my knowledge, the presented problem statement is novel and of high interest for CATE estimation in scenarios in which direct interventions are impractical, costly or unethical.\n2) The authors provide theory for the proposed method DIA."
                },
                "weaknesses": {
                    "value": "1) The paper suffers from impreciseness and multiple open questions (see below).\n2) The results are not reproducible: The experimental setting (e.g., the employed datasets) are not described, neither is code provided. Besides the reproducibility aspects, this also hinders understanding and interpretation of the presented figures and results.\n3) The paper does not employ the required format of citations in the text, i.e. reference number instead of author name + year. \n4) The motivation could be much improved by elaborating more exactly where the method is relevant and providing a real-world case study."
                },
                "questions": {
                    "value": "The paper would benefit from additional details on the following questions:\n\n1) Why is the MSE a good metric of choice? What is the benefit above other objectives (e.g., minimizing regret)?\n2) What would be the general form of the k-th order influence function?\n3) What is meant by the perturbation of the distribution function induced by Dn? In which sense are the samples perturbed?\n4) Why can the estimator theta(Dn) be considered symmetric? A short mathematical statement would benefit the flow of reading.\n5) What is the formulation of the importance ratio on the entire data? (page 6 might be difficult to follow for non-expert readers).\n6) Similarly, a short introduction/theory of the acceptance-rejection method would be beneficial. I am not convinced that the average reader is familiar with the concept.\n7) The authors mention the flexibility of their approach multiple times. Nevertheless, it is unclear what precisely is meant by flexibility/ which properties make the approach flexible.\n9) How does the performance of DIA-X for different X relate to the data generating mechanism? Can the optimal X be deducted from the data for the presented experiments?\n10) Figure 3: The funnel (standard dev.?) is only plotted for the IV-bias. Why is it not visible for the other cases or the variance plot?\n11) TripAdvisor data: Why was it necessary to synthetically enhance the data? Could you also provide a comparison of the results of the method on the original real-world dataset and the enhanced semi-synthetic dataset? It would also be interesting for the reader if the authors could state the optimal instruments for the real-world dataset.\n\nThe paper has multiple imprecise parts:\n\n1) Background: The theoretical background/ problem setting of the paper is taken from reference 23. In contrast to the original work, the paper lacks motivation for and explanation of the specific problem setting.\n2) Control Variates: The choice of the control variate (section 3.1) should be justified mathematically (possibly in the appendix).\n3) Figure 4: According to the text, one should observe an exponentially increasing variance for IS in the number of samples. However, the figure does not support this statement.\n4) Experiments: The synthetic data generation is not properly described. Furthermore, no details on the networks employed for estimation are stated.\n5) It would be nice to formalize \\pi in Sec 2 upon first experience. \n6) References: Multiple references are incomplete.\n\nThings to improve the paper that did not impact the score:\n\n1) Structure: The structure of the paper can be optimized to facilitate reading. A constant reminder of what will follow later (e.g., Section 4) might confuse the reader more than it aids the flow of the paper. Furthermore, key contributions (e.g. Theorem 2) are referred to the appendix. It would aid the understanding of the theory to have the main results presented as such in the main part of the paper.\n2) Consistency in wording, e.g., importance weighting vs. importance sampling\n3) Multiple times it is unclear if a certain aspect is only assumed or proven. Clarification emphasizes the contribution of the paper.\n\nMinor comments:\n\n1) There are some minor typos and grammar errors in the text."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "3: reject, not good enough"
                },
                "confidence": {
                    "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                },
                "first_time_reviewer": {
                    "value": "Yes",
                    "readers": [
                        "ICLR.cc/2024/Conference/Program_Chairs",
                        "ICLR.cc/2024/Conference/Submission1014/Senior_Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission1014/Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission1014/Reviewer_QTvC"
                    ]
                }
            },
            "number": 1,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission1014/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1697629764012,
            "cdate": 1697629764012,
            "tmdate": 1699636027487,
            "mdate": 1699636027487,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "RpGy48K4sJ",
                "forum": "4Zz5UELkIt",
                "replyto": "y24Z8IMSnB",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission1014/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission1014/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Response to Reviewer QTvC (1/3)"
                    },
                    "comment": {
                        "value": "We thank the reviewer for their appreciation of the novelty of the proposed results, and also for their valuable time to provide constructive feedback regarding all aspects of the draft. Your feedback has helped us significantly improve the accessibility of the paper for a wider audience.\n\n**W2. The results are not reproducible: The experimental setting (e.g., the employed datasets) are not described, neither is code provided. Besides the reproducibility aspects, this also hinders understanding and interpretation of the presented figures and results.**\n\nThank you for sharing the concern about reproducibility. We have uploaded the code under the supplementary material section. It contains the data-generating processes and the proposed algorithm.  We will publicly release the code and expand Appendix I to include more experimental details.\n\n**W3. The paper does not employ the required format of citations in the text, i.e. reference number instead of author name + year.**\n\nWe will update the reference style in the draft.\n\n**W4. The motivation could be much improved by elaborating more exactly where the method is relevant and providing a real-world case study.**\n\nDue to space constraints, we had presented the motivation concisely, but thank you for highlighting that further discussion on some real-world use cases would be helpful. Below we have mentioned three use cases across different fields of application:\n\n**Education:** It is important for designing an education curriculum to estimate the effect of homework assignments, extra reading material, etc. on a student\u2019s final performance [1]. However, as students cannot be forced to (not) do these, conducting an RCT becomes infeasible. Nonetheless, students can be encouraged via a multitude of different methods to participate in these exercises. These different forms of encouragement provide various instruments and choosing them strategically can enable sample efficient estimation of the desired treatment effect.\n\n\n**Healthcare:** Similarly, for mobile gym applications, or remote patient monitoring settings [2], users retain the agency to decide whether they would like to follow the suggested at-home exercise or medical intervention, respectively. As we cannot perform random user assignment to a control/treatment group, RCTs cannot be performed. However, there is a variety of different messages and reminders (in terms of how to phrase the message, when to notify the patient, etc.) that serve as instruments. Being strategic about the choice of the instrument can enable sample efficient estimation of treatment effect.\n\n\n**Digital marketing:** Many online digital platforms aim at estimating the impact of premier membership on both the company\u2019s revenue and also on customer satisfaction. However, it is infeasible to randomly make users a member or not, thereby making RCTs inapplicable. Nonetheless, various forms of promotional offers, easier sign-up options, etc. serve as instruments to encourage customers to become members. Strategically personalizing these instruments for customers can enable sample-efficient treatment effect estimation. In our work (Figure 1), we consider one such case study using the publicly available TripAdvisor domain [3].\n\n[1] Eren, Ozkan, and Daniel J. Henderson. \"The impact of homework on student achievement.\" The Econometrics Journal 11, no. 2 (2008)\n\n[2] Ferstad, J., Prahalad, P., Maahs, D. M., Fox, E., Johari, R., & Scheinker, D. (2022). 1009-P: \u201cThe Association between Patient Characteristics and the Efficacy of Remote Patient Monitoring and Messaging.\u201d Diabetes, 71\n\n[3] Syrgkanis, Vasilis, Victor Lei, Miruna Oprescu, Maggie Hei, Keith Battocchi, and Greg Lewis. \"Machine learning estimation of heterogeneous treatment effects with instruments.\" Advances in Neural Information Processing Systems\n\n**Q1. Why is the MSE a good metric of choice? What is the benefit above other objectives (e.g., minimizing regret)?**\n\nThat\u2019s a great question! Our chosen metric is closely related to simple regret (that compares the final performance of the estimator to the ground truth). The proposed method DIA (Section 3.3) adapts the key ideas and aims to be optimal after each round of re-allocation, which is related to the cumulative regret as it aims to learn an estimator that is optimal not just at the end, but also after each re-allocation."
                    }
                },
                "number": 6,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission1014/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700124716565,
                "cdate": 1700124716565,
                "tmdate": 1700124767214,
                "mdate": 1700124767214,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "HRmpH4mJPz",
                "forum": "4Zz5UELkIt",
                "replyto": "y24Z8IMSnB",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission1014/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission1014/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Response to Reviewer QTvC (2/3)"
                    },
                    "comment": {
                        "value": "**Q2. What would be the general form of the k-th order influence function?**\n\nThank you for highlighting that some readers might benefit from the general form of higher-order influence functions. Writing an explicit form for a general $k$-th order can often be tedious, and computing it can be practically challenging. Discussion about higher-order influences for the single-stage estimators can be found in the works by Alaa et al. [1] and Robins et al. [2]. As we formally show in Property 3, for our purpose, we recommend using $k=1$ as it suffices to dramatically reduce the variance of the gradient estimator, incurring bias that decays quickly, while also being easy to compute. \n\n[1] Alaa, Ahmed, and Mihaela Van Der Schaar. \"Discriminative jackknife: Quantifying uncertainty in deep learning via higher-order influence functions.\" International Conference on Machine Learning. PMLR, 2020.\n\n[2] Robins, James, et al. \"Higher order influence functions and minimax estimation of nonlinear functionals.\" Probability and statistics: essays in honor of David A. Freedman. Vol. 2. Institute of Mathematical Statistics, 2008. 335-422.\n\n**Q3. What is meant by the perturbation of the distribution function induced by Dn? In which sense are the samples perturbed?**\n\nWe will update the draft to emphasize that perturbing the distribution function (in the direction of a sample S) induced by Dn corresponds to up-weighting the moment conditions corresponding to the data sample S. A formal discussion of perturbed moment conditions, along with exact equations, are also available in Appendix C.\n\n**Q4. Why can the estimator theta(Dn) be considered symmetric? A short mathematical statement would benefit the flow of reading.**\n\nThank you for helping us improve the flow of the paper. We assume an estimator $\\theta(Dn)$ to be symmetric in its arguments as popular estimators do not treat data samples differently based on their index number in the dataset. For example, let $D_2=(S_1, S_2)$ and $D_2\u2019=(S_2, S_1)$, then $\\theta(D_2) = \\theta(D_2\u2019)$. \n\nWhile it is possible to define contrived estimators that are not symmetric, (e.g., estimators that only use the first sample, and discard all other samples), we focus on popular estimators that are symmetric.\n\n**Q5. What is the formulation of the importance ratio on the entire data? (page 6 might be difficult to follow for non-expert readers).**\n\nWe appreciate the reviewer\u2019s feedback regarding accessibility. We will updated the draft to include the importance ratio formulation of the entire data.\n\n$\\nabla \\mathcal L(\\pi)= \\underset{D_n \\sim \\beta} {\\mathbb E}\\left[\\left(\\prod_{i=1}^n \\frac{\\pi(Z_i|X_i)}{\\beta(Z_i|X_i)}\\right)\\text{MSE}(\\theta(D_n)) \\sum\\limits_{i=1}^n \\frac{\\partial \\log \\pi(Z_i|X_i)}{\\partial \\pi} \\right]$\n\n**Q6. Similarly, a short introduction/theory of the acceptance-rejection method would be beneficial. I am not convinced that the average reader is familiar with the concept.**\n\nWe are happy to add this. Due to space limitations, we will put it in Appendix F.\n\n**Q7. The authors mention the flexibility of their approach multiple times. Nevertheless, it is unclear what precisely is meant by flexibility/ which properties make the approach flexible.**\n\nThank you for raising this issue. By flexible, we mean that DIA can be used with a variety of estimators (it is suitable for approaches that assume a linear structure and non-linear), and settings (unconditional IV where instruments do not depend on the context, or conditional IV, where they do). We describe this at the start of Section 5, but we will clarify this earlier, when we first discuss the flexibility of our proposed approach.\n\n**Q8. How does the performance of DIA-X for different X relate to the data generating mechanism? Can the optimal X be deducted from the data for the presented experiments?**\n\nThank you for asking this question! We will add more details about the domain to clarify that X is not a variable that is being optimized, and hence there is no optimal X. Instead, X is a part of the domain specification. For instance, DIA-10 corresponds to the performance of using DIA when the domain has 10 instruments. Of course, given these 10 instruments, DIA needs to learn a sampling distribution over these instruments, conditioned on the context. \n\n**Q9. Figure 3: The funnel (standard dev.?) is only plotted for the IV-bias. Why is it not visible for the other cases or the variance plot?**\n\nYour careful observation is much appreciated. We will update Figure 3 to include the variance/std-err in the variance estimates itself as well."
                    }
                },
                "number": 7,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission1014/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700125128561,
                "cdate": 1700125128561,
                "tmdate": 1700125128561,
                "mdate": 1700125128561,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "ITowsLwcb5",
                "forum": "4Zz5UELkIt",
                "replyto": "y24Z8IMSnB",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission1014/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission1014/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Response to Reviewer QTvC (3/3)"
                    },
                    "comment": {
                        "value": "**Q10. TripAdvisor data: Why was it necessary to synthetically enhance the data? Could you also provide a comparison of the results of the method on the original real-world dataset and the enhanced semi-synthetic dataset? It would also be interesting for the reader if the authors could state the optimal instruments for the real-world dataset.**\n\nThat\u2019s an important point and we will include a discussion about this in the updated draft. As evident from Figures 1,5, and 7, adaptivity and learning the distribution of instruments are most relevant when there are a lot of instruments. Our paper is developed for the setting where online sampling is feasible. Unfortunately, simulators for real-world scenarios that we are aware of and could access publicly (e.g., TripAdvisor\u2019s) only consider a single/binary instrument. These simulator domains are modeled to represent the setting where expert knowledge was used to find optimal instruments (e.g., better/easier sign-up strategy to make the membership process easier). However, in reality, there could be multiple ways to encourage membership (emails, notifications, sign-up bonuses, etc.) that can all serve as instruments. Adaptivity is more relevant in such a setting to discover an optimal strategy for instrument selection, while minimizing the need for expert knowledge. Therefore, given the above considerations, we created semi-synthetic domains with varying numbers of potential instruments to simulate such settings.\n\n\n**Background: The theoretical background/ problem setting of the paper is taken from reference 23. In contrast to the original work, the paper lacks motivation for and explanation of the specific problem setting.**\n\nWe agree with the reviewer that having more motivation for the specific instrumental variable setting and method can potentially help some readers. Unfortunately, we were constrained by the page limit. Since the IV setting itself is already well established in prior literature, we chose to focus on the motivation regarding why strategic sampling of instruments is useful---that is the subject of our paper. We will revise the background to further emphasize and motivate our setting. \n\n**Control Variates: The choice of the control variate (section 3.1) should be justified mathematically (possibly in the appendix).**\n\nThank you for raising this wasn\u2019t clear\u2013 we did actually provide a formal justification of this (see Property 2 in Section 4 which states the proposed control variate-based gradient estimator is both unbiased and has lower variance: a formal proof is provided in the appendix under Theorem 4).  We will update the paper to mention to the readers earlier, in Section 3.1 itself when we introduce the control variate.\n\n**Figure 4: According to the text, one should observe an exponentially increasing variance for IS in the number of samples. However, the figure does not support this statement.**\n\nWe should have and will highlight that the naive importance sampling-based estimator can have variance exponential in the number of samples, in the worst case, though it may not always have exponential dependence in all domains. In practice, we observe that the variance is too large to do any meaningful gradient estimation. For instance, in Figure 4, the variance of the IS estimator is around 100000, whereas the variance of the proposed method is <10.\n\n**Experiments: The synthetic data generation is not properly described. Furthermore, no details on the networks employed for estimation are stated.**\n\nWe agree more details would improve the paper \u2013 we have uploaded the code under supplementary material. The code contains details about data generation and the models used. We will also expand Appendix I to include more experimental details.\n\n**It would be nice to formalize \\pi in Sec 2 upon first experience.**\n\nWe will update section 2 to emphasize that $\\pi(\\cdot|x) \\in \\Delta(Z)$ denotes a distribution over the instruments, conditional on the covariates.\n\n**References: Multiple references are incomplete.**\n\nWe found one reference that lacked relevant details (the reference to Phil Thomas\u2019s Safe RL was missing the school and that it was a Ph.D. thesis). If there are others with missing information, please let us know.\n\n**Things to improve the paper that did not impact the score**\n\nWe thank the reviewer again for their careful review, and we will incorporate as many suggestions as possible to improve the readability of the draft further."
                    }
                },
                "number": 8,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission1014/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700125289238,
                "cdate": 1700125289238,
                "tmdate": 1700125289238,
                "mdate": 1700125289238,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "YglPBj632q",
                "forum": "4Zz5UELkIt",
                "replyto": "ITowsLwcb5",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission1014/Reviewer_QTvC"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission1014/Reviewer_QTvC"
                ],
                "content": {
                    "comment": {
                        "value": "It is nice to see that the authors provide a very detailed and thoughtful response. I also appreciate that they promise to make several, important changes for the camera-ready version. However, it is unfortunate that the authors would do so only post rebuttal. Given the significance and scope of the changes, I would like to see the revised version before increasing my score."
                    }
                },
                "number": 9,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission1014/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700502901832,
                "cdate": 1700502901832,
                "tmdate": 1700502901832,
                "mdate": 1700502901832,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "hpDUzkwrJT",
                "forum": "4Zz5UELkIt",
                "replyto": "v62SpSFRmC",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission1014/Reviewer_QTvC"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission1014/Reviewer_QTvC"
                ],
                "content": {
                    "comment": {
                        "value": "Thank you for providing an updated version of your draft. We took of note that the revisions have improved the paper to some amount.\nNevertheless, there are still some open problems:\nFlow of paper:\n- The introduction of notation is not comprehensive (e.g., $\\pi$, $\\Pi$). Rewriting the beginning of Section 2 to include all notation used in this Section would significantly help the flow of the paper.\n- It is still difficult to follow the argument in the text (e.g. continuous references to later sections). Main results are still referred to the Appendix.\n- The restriction to symmetric estimators should be mentioned early in the paper, not only one page 5.\nInfluence functions:\n- How would a practicioneer know if all k-th order influence functions exist?\n- Introducing eq.9 is highly confusing at this point in the text. The reader would expect a general form of influence functions, not only the form for $k=1$.\nIf presenting a general form (or even forms for other small $k$ is not possible, then the order of equations 8 to 12 should be revised.\nIt should be clear from the beginning, that only $k=1$ is needed.\n- Why is $k=1$ suffient? Property 3 does not directly state this, since $\\mathcal(L)\\pi$ was defined over all k-th order functions.\nFigure 4):\n- We agree that the variance of IS is multiple times higher that the variance of RS. Nevertheless, it does not increase exponentially in the sample size (one could argue that this might happen only after ~4500 samples)\nTherefore, the figure still does not support the statement in the text."
                    }
                },
                "number": 13,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission1014/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700652434639,
                "cdate": 1700652434639,
                "tmdate": 1700652434639,
                "mdate": 1700652434639,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "LnOEuPoKJa",
                "forum": "4Zz5UELkIt",
                "replyto": "y24Z8IMSnB",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission1014/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission1014/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Further clarification (1/2)"
                    },
                    "comment": {
                        "value": "We thank the reviewer again for taking out their valuable time and engaging in a constructive discussion. We were glad to hear that our previous response was able to address some of the concerns. Below we provide comments for the remaining ones:\n\n**1. Flow of paper:**\n\n**The introduction of notation is not comprehensive (e.g., ,). Rewriting the beginning of Section 2 to include all notation used in this Section would significantly help the flow of the paper.**\n\nThank you for helping us improve the readability of the draft further. We have updated Section 2 to ensure that all the relevant notation is introduced before the problem statement is discussed. \n\n**It is still difficult to follow the argument in the text (e.g. continuous references to later sections). Main results are still referred to the Appendix.**\n\nWe appreciate the reviewer\u2019s encouragement to make the paper even clearer. As the reviewer can imagine, the page limits mean that many of our results and details had to be deferred to the appendix, and we do appreciate that the comments from other reviewers\u2019 suggest that the current organization does appeal to some of the target audience. Of course, we would be grateful if the reviewer could point out particular results in the appendix that they think would be beneficial to appear in the main text.\n\n\n**The restriction to symmetric estimators should be mentioned early in the paper, not only one page 5.** \n\nThank you for bringing this up.  We have also mentioned this now in Section 2, right where we first introduce the estimators, before stating the problem statement. And then in Section 3.2 again as a reminder to the readers, when the symmetric condition is used.\n\n**2. Influence functions:**\n\n**Introducing eq.9 is highly confusing at this point in the text. The reader would expect a general form of influence functions, not only the form for k=1. If presenting a general form (or even forms for other small is not possible, then the order of equations 8 to 12 should be revised. It should be clear from the beginning, that only k=1 is needed.**\n\nWe like the reviewer\u2019s suggestion! We have updated the draft to revise the ordering of this section, such that it is clear that only $k=1$ is needed. Thank you for helping us improve the clarity of this section."
                    }
                },
                "number": 15,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission1014/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700720810881,
                "cdate": 1700720810881,
                "tmdate": 1700721054410,
                "mdate": 1700721054410,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "9JBvCni7vP",
                "forum": "4Zz5UELkIt",
                "replyto": "y24Z8IMSnB",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission1014/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission1014/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Further Clarification (2/2)"
                    },
                    "comment": {
                        "value": "**How would a practitioner know if all k-th order influence functions exist?\nWhy is k=1 sufficient? Property 3 does not directly state this, since was defined over all k-th order functions.** \n\nThanks for letting us know we had not yet clearly explained this. The existence of higher-order influence requires smoothness of the estimate to perturbations in sample weights in the loss. For example, let $l_i(\\theta)$ be the loss from the $i^{th}$ sample, such that the total loss is $L(\\theta) = \\frac{1}{n} \\sum_i l_i(\\theta)$. Here, the weight associated with the loss of each sample is $1/n$. Here smoothness would refer to how would the minimizer of $L(\\theta)$ change if for one of the samples, the weight is changed from $1/n$ to $(1/n +\\epsilon)$, as $\\epsilon \\rightarrow 0$.\n\nNote that such an assumption on the smoothness of estimators is not new and is used across a wide range of applications of influence functions. For example: for model selection [1], dataset distillation [2], uncertainty quantification [3], studying model generalization [4], studying interpretability of models [5], and many other applications [6]. We have highlighted these works in the extended related work section in Appendix A.\n\nFortunately, under this (common) assumption, Property 3 ensures that $k=1$ suffices for our setting to reduce variance, incur small bias, and remain computationally feasible. It is worth pointing out that the above-mentioned works [1,2,3,4,5,6] also only consider $k=1$ for their respective applications.\n\nAdditionally, performance improvement achieved by DIA suggests that this assumption also seems robust to different kinds of estimators (linear with closed form (Fig 5), logistic regression (Fig 6), and neural-network-based non-linear estimators (Fig 1)) used for our experiments.\n\n[1] Alaa, Ahmed, and Mihaela Van Der Schaar. \"Validating causal inference models via influence functions.\" In International Conference on Machine Learning, pp. 191-201. PMLR, 2019.\n\n[2] Loo, Noel, Ramin Hasani, Mathias Lechner, and Daniela Rus. \"Dataset Distillation with Convexified Implicit Gradients.\" arXiv preprint arXiv:2302.06755 (2023).\n\n[3] Alaa, Ahmed, and Mihaela Van Der Schaar. \"Discriminative jackknife: Quantifying uncertainty in deep learning via higher-order influence functions.\" In International Conference on Machine Learning, pp. 165-174. PMLR, 2020\n\n[4] Grosse, Roger, Juhan Bae, Cem Anil, Nelson Elhage, Alex Tamkin, Amirhossein Tajdini, Benoit Steiner et al. \"Studying large language model generalization with influence functions.\" arXiv preprint arXiv:2308.03296 (2023).\n\n[5] Guo, Han, Nazneen Fatema Rajani, Peter Hase, Mohit Bansal, and Caiming Xiong. \"Fastif: Scalable influence functions for efficient model interpretation and debugging.\" arXiv preprint arXiv:2012.15781 (2020).\n\n[6] Koh, Pang Wei, and Percy Liang. \"Understanding black-box predictions via influence functions.\" In International conference on machine learning, pp. 1885-1894. PMLR, 2017.\n\n\n**3. Figure 4**\n\n**We agree that the variance of IS is multiple times higher that the variance of RS. Nevertheless, it does not increase exponentially in the sample size (one could argue that this might happen only after ~4500 samples) Therefore, the figure still does not support the statement in the text.**\n\nThank you for helping us improve this illustrative example. We have updated it to bring out this worst-case behavior better. We have also removed the log scale on the y-axis that was present earlier. Appendix I.4 contains more details about the plot, as well as the log-scale version of this plot (Fig 8) to highlight the difference in variances even at smaller values of n."
                    }
                },
                "number": 16,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission1014/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700720978012,
                "cdate": 1700720978012,
                "tmdate": 1700721004664,
                "mdate": 1700721004664,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "kJChAuS4mz",
            "forum": "4Zz5UELkIt",
            "replyto": "4Zz5UELkIt",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission1014/Reviewer_7XxM"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission1014/Reviewer_7XxM"
            ],
            "content": {
                "summary": {
                    "value": "The paper investigates enhancing sample efficiency for indirect experiments by adaptively designing a data collection policy over instrumental variables. The authors propose a practical computational procedure that utilizes influence functions to search for an optimal data collection policy, together with the idea of rejection sampling. By many experiments in various domains, the authors showcase the significant improvement of the sample efficiency in indirect experiments."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "3 good"
                },
                "strengths": {
                    "value": "1.\tThe problem considered in this paper, from my perspective, is important and interesting from both a theoretical and practical perspective.\n2.\tThe ideas of generalizing the influence functions and adopting rejection sampling are quite inspiring. Although the core concepts are standard, the generalization is still novel, in my opinion.\n3.\tThe paper is well written and relatively easy to follow, considering it is a quite theoretical one."
                },
                "weaknesses": {
                    "value": "1.\tAdaptivity can bring us a lot of benefits like the improvement of sample efficiency. However, the technical challenge is that adaptivity usually harms the independence among the data. The adaptively collected data is usually challenging to analysis, even for the basic M-estimator (see, e.g., [A]). The authors do not seem to cover any points along this line. It will be beneficial to present whether the adaptivity in this paper affects the independence structure and how the authors handle such difficulties.\n2.\tFor the multi-rejection sampling, if $\\pi\u2019$ and $\\pi_i$ are very different, the algorithm might reject many samples before getting a useful one, which can be very inefficient and impractical. Things become even worse when the dimensions of the problem get larger, for example, as the authors mentioned, when the natural language serves as instruments Additionally, it would be good to know how to choose the value of \"k\" in practice.\n3.\tIn the introduction, when summarizing the contributions, I didn't notice a clear mention of the technical challenges and novel aspects of the work. I found several such points in the main text. It would be beneficial, in my opinion, to include them in the introduction, especially since many of the ideas are quite traditional.\n4.\tOne minor point is that the writing can be further improved.\tWhen referring to an equation, it is better to put the equation number in parentheses. The phrase to define $D_{n\\i}$ ($D_n$ except the one in the $log \\pi (Z_i | X_i)$ term) is a little confusing.\n\n\nReference:\n[A] Zhang, K., Janson, L., & Murphy, S. (2021). Statistical inference with m-estimators on adaptively collected data. Advances in neural information processing systems, 34, 7460-7471."
                },
                "questions": {
                    "value": "See above."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "6: marginally above the acceptance threshold"
                },
                "confidence": {
                    "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 2,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission1014/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698898145727,
            "cdate": 1698898145727,
            "tmdate": 1699636027407,
            "mdate": 1699636027407,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "NgVmzB3ntR",
                "forum": "4Zz5UELkIt",
                "replyto": "kJChAuS4mz",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission1014/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission1014/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Response to Reviewer 7XxM"
                    },
                    "comment": {
                        "value": "We thank the reviewer for appreciating the importance of the problem and the novelty of the contributions. We were glad to see that we were able to convey the key ideas adequately and we agree with the reviewer on the next big steps in this direction. We answer the questions below, in order.\n\n**1. Adaptivity can bring us a lot of benefits like the improvement of sample efficiency. However, the technical challenge is that adaptivity usually harms the independence among the data. The adaptively collected data is usually challenging to analysis, even for the basic M-estimator (see, e.g., [A]). The authors do not seem to cover any points along this line. It will be beneficial to present whether the adaptivity in this paper affects the independence structure and how the authors handle such difficulties.**\n\nThat is a great point! While in this work we focused on adaptive data collection and empirical finite sample performance, we will update the conclusion to cite [A] and highlight that adaptive data collection can harm the independence assumption and can make inference more nuanced. Similar to [A], recent work by Gupta et al. [B] also presents initial steps to show consistency and asymptotic normality for simpler GMM estimators under adaptive data collection. While generalizing these results is important, it is orthogonal to our current contribution, and addressing this would result in interesting future work.\n\n[B] Gupta, Shantanu, Zachary Lipton, and David Childers. \"Efficient online estimation of causal effects by deciding what to observe.\" Advances in Neural Information Processing Systems 34 (2021)\n\n**2. For the multi-rejection sampling, if and are very different, the algorithm might reject many samples before getting a useful one, which can be very inefficient and impractical. Things become even worse when the dimensions of the problem get larger, for example, as the authors mentioned, when the natural language serves as instruments Additionally, it would be good to know how to choose the value of \"k\" in practice.**\n\nYour observation is accurate. A standard technique for density ratio estimation (that governs acceptance-rejection ratio in our setup) in higher dimensions is through performing density ratio estimation on a lower dimensional subspace [1, 2]. We believe that incorporating similar ideas into our framework can provide further improvements.\n\nRegarding setting the value of k: We parametrize $k$ as $n^\\alpha$. As the expected number of samples that get accepted via rejection sampling from a set of $n$ samples is $n/\\rho_\\text{max}$, it would be ideal for $\\alpha$ to be such that $n^\\alpha > n/\\rho_\\text{max}$. Empirical supremum can be used as a proxy for $\\rho_\\text{max}$. \n\n[1] Yamada, Makoto, and Masashi Sugiyama. \"Direct density-ratio estimation with dimensionality reduction via hetero-distributional subspace analysis.\" In Proceedings of the AAAI Conference on Artificial Intelligence, vol. 25, no. 1, pp. 549-554. 2011.\n\n[2] Sugiyama, Masashi, and Motoaki Kawanabe. \"Dimensionality reduction for density ratio estimation in high-dimensional spaces.\" \u4eba\u5de5\u77e5\u80fd\u5b66\u4f1a\u7b2c\u4e8c\u7a2e\u7814\u7a76\u4f1a\u8cc7\u6599 2009, no. DMSM-A901 (2009).\n\n**3. In the introduction, when summarizing the contributions, I didn't notice a clear mention of the technical challenges and novel aspects of the work. I found several such points in the main text. It would be beneficial, in my opinion, to include them in the introduction, especially since many of the ideas are quite traditional.**\n\nThank you for the good suggestion\u2013 we will update the introduction accordingly. \n\n**4. One minor point is that the writing can be further improved. When referring to an equation, it is better to put the equation number in parentheses. The phrase to define ... is a little confusing.**\n\nWe thank the reviewer again for their careful review, and we will incorporate these suggestions to improve the readability of the draft further."
                    }
                },
                "number": 5,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission1014/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700124284710,
                "cdate": 1700124284710,
                "tmdate": 1700124284710,
                "mdate": 1700124284710,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "qQ6c0vNBo8",
                "forum": "4Zz5UELkIt",
                "replyto": "NgVmzB3ntR",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission1014/Reviewer_7XxM"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission1014/Reviewer_7XxM"
                ],
                "content": {
                    "comment": {
                        "value": "Thank you for all your efforts and clarifications! I really appreciate it! However, since there is no choices between 6 and 8, I choose to remain my score."
                    }
                },
                "number": 14,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission1014/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700687100565,
                "cdate": 1700687100565,
                "tmdate": 1700687100565,
                "mdate": 1700687100565,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "TC4VC6CbFx",
            "forum": "4Zz5UELkIt",
            "replyto": "4Zz5UELkIt",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission1014/Reviewer_SUta"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission1014/Reviewer_SUta"
            ],
            "content": {
                "summary": {
                    "value": "Authors present a current and well motivated problem, execute the ideas well, communicate results clearly and as such make a relevant contribution the literature.\n\nThe problem statement is delivered at different levels of intuition and formality which helps exposition (i.e. \u201cconsider how to automatically learn data-efficient adaptive instrument-selection decision policies, in order to quickly estimate conditional average treatment effects\u201d and \u201caim to develop an adaptive data collection policy \u03c0(\u00b7|x) \u2208 \u2206(Z) over the instruments Z for all x \u2208 X that can improve sample-efficiency of the estimate of the counterfactual prediction f. Importantly, we aim to develop an algorithmic framework that can work with general (non)-linear two-stage estimators.\u201d)\n\nTheir \u201cgeneral framework for adaptive indirect experiments\u201d is well placed with a reasonable long-term perspective and careful analysis of limitations. They also maturely accommodate natural limitations by presenting a framework that is \u201cdesigned to minimize the need for expert knowledge and can readily scale with computational capabilities\u201d.\n\nI am unable to comment on the correctness of the theorems, though it seems the authors heavily rely on previously shown results and plug and play those, which, given the empirical results, suggests they are successful.\n\nEmpirical examples substantiated the theoretical claims well, though the final discussion has significant potential for development. It is possibly a bit underdeveloped with a weak conclusion of the impact of reallocation. \n\nThe conclusion of a \u2018Unshaped\u2019 trade off between number of instruments and number of reallocations might oversimplify deeper issues, though for the given work is perfectly adequate.\n\nOverall, the paper makes a relevant contribution to the literature, tackling an important problem with skilful navigation of theoretical tools (influence functions and multi-rejection importance sampling) resulting in convincing results and arguments for using DIA."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "4 excellent"
                },
                "contribution": {
                    "value": "4 excellent"
                },
                "strengths": {
                    "value": "- [ ] The background is curated at the right level of depth and supports exposition very well. They navigate the page limit well with a carefully formulated and rich appendix.\n- [ ] The conceptual development throughout the paper is very consistent and easy to follow.\n- [ ] Identifiability conditions are present effectively for the given task.\n- [ ] Figure 3 is incredibly effective to demonstrate the improvements, the last sentence could be boldened/underlined/emphasised more. (\u201cObserve the scale on the y-axes.\u201d)\n- [ ] The exposition of a linear example in the example is very much appreciated."
                },
                "weaknesses": {
                    "value": "- [ ] I was able to understand \u201cIndirect experiments\u201d on an intuitive level from the problem statement and the given examples, but a less informed reader might struggle and benefit from a more thorough/formal definition, though I am aware authors can\u2019t cater to all levels and the current introduction of the term is just fine for the usual causa ICLR reader.\n- [ ] The conclusion is possibly a bit underdeveloped with a weak conclusion of the impact of reallocation, e.g. Figure 5.\n- [ ] The conclusion of a \u2018Unshaped\u2019 trade off between number of instruments and number of reallocations might oversimplify deeper issues, though for the given work is perfectly adequate."
                },
                "questions": {
                    "value": "- [ ] Do you have more empirical or theoretical evidence to enrich the discussion on the \u2018U-shaped\u2019 trade off between number of instruments and number of reallocations? It seem like you might be running out of space, but if camera-ready allows another page, please enrich.\n- [ ] Figure 2: I am not sure what the dotted red lines indicate. I assume they are related to special conditions and assumptions on the SCM, but these are not connected to the text as far as I can see. Did I miss it?\n- [ ] Typo: Page 5 bottom: \u201cmulti-rejection important sampling\u201d should be importance I assume."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "8: accept, good paper"
                },
                "confidence": {
                    "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                },
                "first_time_reviewer": {
                    "value": "Yes",
                    "readers": [
                        "ICLR.cc/2024/Conference/Program_Chairs",
                        "ICLR.cc/2024/Conference/Submission1014/Senior_Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission1014/Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission1014/Reviewer_SUta"
                    ]
                }
            },
            "number": 3,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission1014/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1699372494074,
            "cdate": 1699372494074,
            "tmdate": 1699636027345,
            "mdate": 1699636027345,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "ObaOQp41GR",
                "forum": "4Zz5UELkIt",
                "replyto": "TC4VC6CbFx",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission1014/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission1014/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Response to Reviewer SUta"
                    },
                    "comment": {
                        "value": "We thank the reviewer for their support and valuable time to provide constructive feedback! We answer the questions, in order, below.\n\n**[ ]I was able to understand \u201cIndirect experiments\u201d on an intuitive level from the problem statement and the given examples, but a less informed reader might struggle and benefit from a more thorough/formal definition, though I am aware authors can\u2019t cater to all levels and the current introduction of the term is just fine for the usual causa ICLR reader.**\n\nWe agree with the reviewer. We had to indeed navigate the issues of addressing this to different audiences, within the prescribed page limit, while also discussing all the contributions. We wanted to provide some informal intuition and thus had to defer the formal problem statement to Eqn 4 in Section 2.\n\n**\"...impact of reallocation..\"  \"The conclusion of a \u2018Unshaped\u2019 trade off between number of instruments and number of reallocations might oversimplify deeper issues, though for the given work is perfectly adequate.\" , \"more empirical or theoretical evidence to enrich the discussion on the \u2018U-shaped\u2019 trade off between number of instruments and number of reallocations? It seem like you might be running out of space, but if camera-ready allows another page, please enrich.\"**\n\nThank you for your suggestions to improve the conclusions further! While in this work we took the first step towards addressing several bias-variance challenges underlying a general framework for adaptively designing the instrument sampling policy, our results do provide interesting next challenges to work on and improve the method further. We plan to continue this investigation in future work.\n\n(Unfortunately, it looks like the camera-ready version this year does not allow an additional page.)\n\n**[ ]Figure 2: I am not sure what the dotted red lines indicate. I assume they are related to special conditions and assumptions on the SCM, but these are not connected to the text as far as I can see. Did I miss it?**\n\nThat\u2019s correct, the dotted lines visually depict the standard IV condition (Assumption 1) for the SCM. We will update the text to mention this. \n\n**[ ]Typo: Page 5 bottom: \u201cMulti-rejection important sampling\u201d should be importance I assume.**\n\nThank you for catching this typo. We will fix it."
                    }
                },
                "number": 4,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission1014/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700123969051,
                "cdate": 1700123969051,
                "tmdate": 1700123969051,
                "mdate": 1700123969051,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "f5STNqIcK2",
                "forum": "4Zz5UELkIt",
                "replyto": "ObaOQp41GR",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission1014/Reviewer_SUta"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission1014/Reviewer_SUta"
                ],
                "content": {
                    "title": {
                        "value": "Response"
                    },
                    "comment": {
                        "value": "Thanks for the response!\n\nWithout the extra page, it will be hard to supply a rich discussion of the trade-offs, as the appendix would not be the right place, so I hope that content with lesser priority can be moved into the supplement leaving some more room for more detailed analysis of the trade-offs.\n\nThank you for your contribution to the literature, clear writing and sensible design choices and discussion of limitations."
                    }
                },
                "number": 12,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission1014/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700650383692,
                "cdate": 1700650383692,
                "tmdate": 1700650383692,
                "mdate": 1700650383692,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "lM9sc107rb",
            "forum": "4Zz5UELkIt",
            "replyto": "4Zz5UELkIt",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission1014/Reviewer_ST2k"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission1014/Reviewer_ST2k"
            ],
            "content": {
                "summary": {
                    "value": "This paper discusses how to design an adaptive data collection process over the instruments that can improve the sample-efficiency of the estimation of the counterfactual prediction. The previous works mitigate the bias in estimation of the predictor $f$, but they are often subject to high variance problem. This paper mitigates the high variance problem of the gradient estimator by using influence functions and multi-rejection importance sampling and provides theoretical analysis of the bias and variance of the proposed gradient estimator. Specifically, although there exists a slight estimation error, this paper proposes $\u2207^{IF}L(\u03c0)$ estimator based on influence functions to solve the time-consuming problem caused by re-training and the high variance problem. Meanwhile, this paper proposes a multi-rejection important sampling approach, which has lower variance compared to the traditional importance sampling approach. In addition, this paper proposes an algorithm that is able to design instruments adaptively. Moreover, experiments are conducted on three regimes to demonstrate the effectiveness of the proposed method."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "2 fair"
                },
                "contribution": {
                    "value": "3 good"
                },
                "strengths": {
                    "value": "S1: The motivation is clear. How to design indirect experiments when direct assign interventions is impractical is a important problem.\n\nS2: The techniques adopted in this paper are sound, and are supported by solid theoretical analysis. \n\nS3: The proposed algorithm is novel and demonstrates good performance.\n\nS4: The experimental results on the three datasets are convincing."
                },
                "weaknesses": {
                    "value": "W1: The paper uses uniform data collection method as the baseline, however, I think evaluating some more RL algorithms and comparing their performance will make the paper more convincing.\n\nW2:  In practice, the max mutli-importance ratio may not be known, so this paper use the empirical supremum instead. May $\\bar{\u03c1}(S_{i})$ also be unknown?\n\nW3: Is there some clear pattern for DIA-X with different X in Figure 1, 5 and 6? For example, the U-trend is not obvious in Figure 1.\n\nW4: Is Figure 3 showing the result with K=1 in $\u2207^{IF}L(\u03c0)$? Providing more results with varying K may helpful."
                },
                "questions": {
                    "value": "Please refer to the weaknesses part.\n\n***\n\nAfter rebuttal: Thank you very much to the authors for their answers to our reviews and for improving the paper during the rebuttal period. The modifications bring valuable content. I read also carefully the other reviews and the corresponding answers. My (positive) recommendation remains unchanged."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "details_of_ethics_concerns": {
                    "value": "N/A"
                },
                "rating": {
                    "value": "6: marginally above the acceptance threshold"
                },
                "confidence": {
                    "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                },
                "first_time_reviewer": {
                    "readers": [
                        "ICLR.cc/2024/Conference/Program_Chairs",
                        "ICLR.cc/2024/Conference/Submission1014/Senior_Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission1014/Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission1014/Reviewer_ST2k"
                    ]
                }
            },
            "number": 4,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission1014/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1699463586357,
            "cdate": 1699463586357,
            "tmdate": 1700780939022,
            "mdate": 1700780939022,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "MbKBs2CWwa",
                "forum": "4Zz5UELkIt",
                "replyto": "lM9sc107rb",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission1014/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission1014/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Response to Reviewer ST2k"
                    },
                    "comment": {
                        "value": "We were glad to hear that the reviewer found the motivation clear, and the theoretical and empirical analyses useful. We thank the reviewer for appreciating the novelty of the algorithm and taking their valuable time to provide constructive feedback.\n\n**W1: The paper uses a uniform data collection method as the baseline, however, I think evaluating some more RL algorithms and comparing their performance will make the paper more convincing.**\n\nWe agree that some justification regarding other RL methods would be useful. We will update the draft to mention that while we leverage tools from RL, our problem setup presents several unique challenges that make the application of standard RL methods as-is ineffective. \n\nOff-policy learning is an important requirement for our method, and policy-gradient and Q-learning are the two main pillars of RL. As we discussed in Section 4, conventional importance-sampling-based policy gradient methods can have variance exponential in the number of samples, rendering them practically useless for our setting. On the other hand, it is unclear how to efficiently formulate the optimization problem using Q-learning. From an RL point of view, the \u201creward\u201d corresponds to the MSE, and the \u201cactions\u201d corresponds to instruments. Since this reward depends on all the samples, the effective \u201cstate space\u201d for Q-learning style methods would depend on the combinatorial set of the covariates, i.e., let $\\mathcal X$ be the set of covariates and $n$ be the number of samples, then the state $s \\in \\mathcal X^n$. This causes additional trouble as $n$ continuously changes/increases in our setting as we collect more data.\n\n**W2: In practice, the max multi-importance ratio may not be known, so this paper uses the empirical supremum instead. May the importance ratio also be unknown?**\n\nThanks for asking this question! We should have and will clarify in the draft that the multi-importance ratio $\\bar \\rho(S)$ is always known in our setting. Since the proposed method does the data collection itself, we have access to both the current and the prior data-collection policies that are needed to compute the multi-importance ratio. \n\n**W3: Is there some clear pattern for DIA-X with different X in Figures 1, 5, and 6? For example, the U-trend is not obvious in Figure 1.**\n\nThat\u2019s a great observation. Indeed, the severity of the U-trend will vary from problem to problem. In general, our goal in mentioning the U-trend was to highlight the over-arching tension that as the number of potential instruments increases, there is a greater opportunity to be more effective. However, an increase in the number of instruments also increases the challenge with the optimization routine. Therefore, this results in the aforementioned U-trend.\n\n**W4: Is Figure 3 showing the result with K=1? Providing more results with varying K may helpful.**\n\nWhile we agree that having $k>1$ would be interesting, writing an explicit form for a general $k$-th order influence function can often be tedious, and computing it can be practically challenging. For instance, see the higher-order influences for the single-stage estimators in the works by Alaa et al. [1] and Robins et al. [2]. Fortunately, as we formally show in Property 3, for our purpose, using $k=1$  suffices to dramatically reduce the variance of the gradient estimator, incur a bias that decays quickly, while also being easy to compute.\n\n[1] Alaa, Ahmed, and Mihaela Van Der Schaar. \"Discriminative jackknife: Quantifying uncertainty in deep learning via higher-order influence functions.\" International Conference on Machine Learning. PMLR, 2020.\n\n[2] Robins, James, et al. \"Higher order influence functions and minimax estimation of nonlinear functionals.\" Probability and statistics: essays in honor of David A. Freedman. Vol. 2. Institute of Mathematical Statistics, 2008. 335-422."
                    }
                },
                "number": 3,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission1014/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700123668346,
                "cdate": 1700123668346,
                "tmdate": 1700123668346,
                "mdate": 1700123668346,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    }
]