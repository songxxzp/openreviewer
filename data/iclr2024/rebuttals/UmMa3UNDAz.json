[
    {
        "title": "EfficientDM: Efficient Quantization-Aware Fine-Tuning of Low-Bit Diffusion Models"
    },
    {
        "review": {
            "id": "wRdBzZoupu",
            "forum": "UmMa3UNDAz",
            "replyto": "UmMa3UNDAz",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission3007/Reviewer_SYoS"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission3007/Reviewer_SYoS"
            ],
            "content": {
                "summary": {
                    "value": "The paper proposes a new quantization scheme for diffusion models. In particular, the paper notes that post-training quantization (PTQ) may be efficient but brings relatively low performance compared to quantization-aware training (QAT). Conversely, QAT brings higher performance but requires heavy computational resources. To combine the advantages of these two main quantization approaches, the paper introduces a quantization counterpart of low-rank adapter (LoRA). The paper also proposes to quantize the model in a data-free manner through distillation from the original full-precision model."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "3 good"
                },
                "strengths": {
                    "value": "- The paper introduces a new quantization method that brings substantial efficiency improvement without incurring extra computational overhead and performance degradation.\n\n- The paper demonstrates strong performance.\n\n- The paper is clearly written."
                },
                "weaknesses": {
                    "value": "- Comparisons: What happens if other quantization models also employ LoRA and distillation, which are common techniques to use?\n\n- Novelty concern: I think the paper presents a combination of existing works (scale-aware optimization from LSQ, common distillation technique, and LoRA). Can the authors clarify the difference in contribution from the combination of existing works? If there is a difference, how does the performance differ compared to the combination?"
                },
                "questions": {
                    "value": "Please refer to the weaknesses section."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "6: marginally above the acceptance threshold"
                },
                "confidence": {
                    "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 1,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission3007/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698838473541,
            "cdate": 1698838473541,
            "tmdate": 1699636245239,
            "mdate": 1699636245239,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "GPQwlsLkYy",
                "forum": "UmMa3UNDAz",
                "replyto": "wRdBzZoupu",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission3007/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission3007/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Rebuttal by Authors"
                    },
                    "comment": {
                        "value": "Thanks to the reviewer for the valuable comments.\n\n**Q1: Clarify the difference in contribution from the combination of existing works (scale-aware optimization from LSQ, common distillation technique, and LoRA).** \nIn this paper, we propose a data-free, quantization-aware and parameter-efficient fine-tuning framework for low-bit diffusion models, which seamlessly integrates three tightly coupled components, QALoRA, scale-aware optimization and data-free distillation. \nOverall, our work has been well recognized by other reviewers, such as  \"the idea of QALoRA is novel\" (Reviewer 5Wot), \"this paper introduces low rank adapter and distillation loss ...is the first to achieve very good performance...\" (Reviewers ec6g) and \"the proposed QALoRA is data-free and efficient.\" (Reviewer BLfX). \n\nTo elaborate, **our scale-aware optimization differs from the ``STEP SIZE GRADIENT SCALE\" used in LSQ in both formula and function.** From a formula standpoint, we adjust the gradient of QALoRA weight using the averaged quantization scale, whereas LSQ adjusts the gradient of quantization scales using the number of weights and precision. The goal of our technique is to improve the learning effectiveness of QALoRA, a critical issue in its optimization. As referred to Table 3 in the paper, our scale-aware optimization significantly improves EfficientDM's performance, leading to a 10.95 decrease in sFID.\n\nCommon distillation methods require access to the training dataset, which may be challenging due to massive size or copyright concerns. The recent work LLM-QAT [ii] proposes a distillation method that utilizes generations produced by full-precision (FP) models. However, it requires generating massive amounts of data using the teacher model beforehand and training the entire quantized model, incurring significant training costs. **Our distillation scheme stands out by not requiring the generation and storage of any data.** Instead, we input the same random Gaussian noise to both FP and quantized models and minimize the mean squared error between their denoising results. The distillation process is conducted in a data-free manner, which is efficient and easy to implement.\n\n**The proposed QALoRA is also distinct from the existing work QLoRA [iii], which applies LoRA to quantized models.** As referred to ``Quantization-aware low-rank adapter\" part in the paper, QLoRA incurs limitations when both weights and activations are quantized. The full-precision LoRA weights can not be merged with quantized model weights, leading to increased model size and massive floating-point calculations during inference. In contrast, the proposed QALoRA is a new variant of LoRA that can be seamlessly integrated with quantized model weights. After fine-tuning, there is no additional storage needed and the calculations between quantized weights and activations can be efficiently implemented for faster inference. \n\n**Q2: What happens if other quantization models also employ LoRA and distillation, which are common techniques to use?** As referred to Q1, both QALoRA and our distillation scheme are distinct from previous methods and they are seamlessly integrated within the proposed data-free, quantization-aware fine-tuning framework for low-bit diffusion models.\n\n[i] Esser, Steven K., et al. ``Learned step size quantization.\" ICLR 2020.\n\n[ii] Liu, Zechun, et al. ``LLM-QAT: Data-Free Quantization Aware Training for Large Language Models.\" arXiv 2023.\n\n[iii] Dettmers, Tim, et al. \"Qlora: Efficient finetuning of quantized llms.\" NeurIPS 2023."
                    }
                },
                "number": 5,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission3007/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700186373606,
                "cdate": 1700186373606,
                "tmdate": 1700186373606,
                "mdate": 1700186373606,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "xWLle0bR6V",
                "forum": "UmMa3UNDAz",
                "replyto": "wRdBzZoupu",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission3007/Reviewer_SYoS"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission3007/Reviewer_SYoS"
                ],
                "content": {
                    "comment": {
                        "value": "I appreciate the authors' response.\nI acknowledge the differences in the distillation technique.\nHowever, a part of my concerns remain regarding the novelty.\nIn the main text, it says \"Inspired by LSQ (Esser et al., 2019), a technique where quantization scales are optimized alongside other trainable parameters through the gradient descent algorithm, we extend the activation quantization scale into the temporal domain.\"\nAccording to the text, it seems like the proposed scale-aware quantization is a simple extension of the one proposed in LSQ.\nI do not think simple extention of existing work to temporal domain is novel enough to be considered as one of main contributions.\nPlease clarify if there is any misunderstanding."
                    }
                },
                "number": 6,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission3007/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700538674217,
                "cdate": 1700538674217,
                "tmdate": 1700546077015,
                "mdate": 1700546077015,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "d1hQRYzqMr",
                "forum": "UmMa3UNDAz",
                "replyto": "wRdBzZoupu",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission3007/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission3007/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Response to Reviewer SYoS"
                    },
                    "comment": {
                        "value": "Dear Reviewer SYoS,\n\nThank you for your feedback. It appears there may be some misunderstandings regarding our proposed techniques. The scale-aware optimization and Temporal LSQ (TLSQ) are distinct techniques proposed in our paper. As referred to ``Variation of weight quantization scales across layers\" part of the paper, **the scale-aware optimization aims to improve the learning effectiveness of QALoRA due to variations in weight quantization scales across different layers, which is not an extension of LSQ.** \n\nIn addressing the temporal dynamics of activation distribution across steps, we introduce Temporal LSQ (TLSQ), which is outlined in the \"Variation of activation distribution across steps\" part of the paper. To contextualize our innovation, we highlight a comparison with a related approach TDQ [i], as referred to Q1 in the general response. Unlike TDQ, which employs additional MLP modules to approximate quantization scales, TLSQ optimizes temporal quantization scales directly, offering a more computationally efficient approach. As referred to Tables 1 and 3 in the paper, TLSQ greatly improves the performance of EfficientDM, **outperforming TDQ in both performance and efficiency** under W8A8 and W4A8 bit-widths on CIFAR-10 dataset. **These results affirm the advantages and contributions of the proposed TLSQ technique.**\n\nIf there are any additional concerns you have, please feel free to let us know.\n\nThank you once again for your time, guidance, and consideration.\n\nBest regards,\n\nAuthors of #3007. \n\n[i] So J, Lee J, Ahn D, et al. \"Temporal Dynamic Quantization for Diffusion Models.\" NeurIPS, 2023."
                    }
                },
                "number": 7,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission3007/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700546711547,
                "cdate": 1700546711547,
                "tmdate": 1700553981988,
                "mdate": 1700553981988,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "AgHfRO9GpV",
                "forum": "UmMa3UNDAz",
                "replyto": "d1hQRYzqMr",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission3007/Reviewer_SYoS"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission3007/Reviewer_SYoS"
                ],
                "content": {
                    "comment": {
                        "value": "Thanks for the clarification.\nThen, it seems the text I'm refering to is a bit misleading.\nIt would be great if the text is revised to avoid misunderstanding.\nOther than that, my concerns have been addressed."
                    }
                },
                "number": 8,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission3007/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700556322175,
                "cdate": 1700556322175,
                "tmdate": 1700556322175,
                "mdate": 1700556322175,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "iEjIvf2S6p",
            "forum": "UmMa3UNDAz",
            "replyto": "UmMa3UNDAz",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission3007/Reviewer_BLfX"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission3007/Reviewer_BLfX"
            ],
            "content": {
                "summary": {
                    "value": "This paper presents a data-free and efficient Quantization-Aware Training (QAT) method for diffusion models. For efficient QAT, it introduces the Quantization-Aware Low-Rank Adapter (QALoRA), which combines LoRA and QAT. The paper extends the LSQ QAT method a little to the Temporal LSQ method, which learns different scale factors for different time steps to handle the activation distribution difference across steps. The experimental of image diffusion and latent diffusion models on CIFAR-10, LSUN, and ImageNet demonstrates that this method can significantly outperform previous PTQ methods when doing W4A4 and W2 quantization."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "2 fair"
                },
                "strengths": {
                    "value": "- Applying QAT to diffusion models to achieve better quantization performance is reasonable.\n- The proposed QALoRA is data-free and efficient (cost about 10 GPU hours).\n- The experimental results are promising.\n- Actual speedup with CUTLASS is reported."
                },
                "weaknesses": {
                    "value": "There exist some formulas and details that are not clear enough. Some additional ablation and analysis experiments are needed to make the overall method more convincing. Check the questions section."
                },
                "questions": {
                    "value": "- How to get $\\bf{x}_t$ in equation (7) is not described properly. Do the authors sample $\\bf{x}_T \\sim \\mathcal{N}$, and run several solver steps using the FP model to get $\\bf{x}_t$, or otherwise? If it is the case, the equation (7) is not written properly.\n- The proposed Temporal LSQ (TLSQ) method uses a different activation quantization scale for different time steps. Can the authors show the learned scales and analyze how the scale factors of certain layers change w.r.t. the time steps on different datasets? \n- Can the authors compare TLSQ with deciding the time-step-wise activation quantization scale using some calibration data or even run-time dynamic quantization? This can help illustrate the necessity of LSQ.\n- The paper mentioned that \"we interpolate the learned temporal quantization scales to deal with the gap of sampling steps between fine-tuning and inference\". I found steps=100 experiments on CIFAR-10 and LSUN in Table 1 and Appendix A, I wonder if the authors experimented with using a different schedule with fewer steps? Does this scale-deciding technique work well in the fewer-step regime?\n- Is QALoRA applied for all the weights, including the convolutions and the attention layers?\n- For the good of future efficient diffusion, can the authors discuss more relevant limitations and raise questions worth future studying? The current discussion is not specific."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "6: marginally above the acceptance threshold"
                },
                "confidence": {
                    "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 2,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission3007/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1699370520933,
            "cdate": 1699370520933,
            "tmdate": 1699636245144,
            "mdate": 1699636245144,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "3u2zbyqC0O",
                "forum": "UmMa3UNDAz",
                "replyto": "iEjIvf2S6p",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission3007/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission3007/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Rebuttal by Authors"
                    },
                    "comment": {
                        "value": "Thanks to the reviewer for the valuable comments.\n\n**Q1: How to get $\\mathbf{x}_t$ in Eq. (7)? The Eq. (7) is not written properly.** Please refer to Q2 in general response. The input data $\\mathbf{x}_t$ is derived from denoising random Gaussian noise $\\mathbf{x}_T \\sim \\mathcal{N}(0,1)$ with the FP model through $T-t$ iterations. We have revised the explanation of Eq. (7) in the revised paper.\n\n**Q2: Can the authors show the learned scales and analyze how the scale factors of certain layers change on different datasets?** As referred to Figure B to C in the supplementary material of revised paper, we visualize the learned quantization scales and the variance of the activations collected from W4A4 LDM-4 model over ImageNet $256\\times256$ and LSUN-Bedrooms. Layers exhibiting significant shifts in activation distribution show considerable variation in the learned scale across different steps, and vice versa.\n\n**Q3: Can the authors compare TLSQ with deciding the time-step-wise activation quantization scale using some calibration data or dynamic quantization?** We conduct ablation experiments to compare the performance of TLSQ with dynamic quantization and time-step-wise post-training quantization, as referred to Table D in the supplementary material of revised paper. The naive Min-Max dynamic quantization fails to denoise images, even with QALoRA weights fine-tuned. Time-step-wise quantization scales, obtained through post-training techniques with calibration sets, outperform non-time-step-wise quantization by incorporating temporal information. Utilizing TLSQ further improves performance, resulting in a reduction of $1.64$ in FID and $2.03$ in sFID, showcasing the superiority of learned temporal quantization scales.  \n\n| Method                                                                                | Bit-width (W/A) | IS$\\uparrow$ | FID$\\downarrow$ | sFID$\\downarrow$ | Precision$\\uparrow$ |\n| :---: | :---: | :---: | :---: | :---: | :---: |\n| baseline (QALoRA+scale-aware optimization)                                            | 4/4         | 172.96     | 9.55          | 13.23          | 81.87              |\n| baseline + dynamic quantization                                                      | 4/4         | N/A        | N/A           | N/A            | N/A                |\n| baseline + PTQ time-step-wise quantization                                         | 4/4         | 224.02     | 7.81          | 9.78           | 82.42              |\n| baseline + TLSQ                                                                     | 4/4         | **250.90**  | **6.17**      | **7.75**       | **86.02**          |\n\n\n\n**Q4: Does scale-deciding technique work well in the fewer-step regime?** As referred to Table 2 in the paper, the performance on ImageNet $256\\times256$ is evaluated with 20 steps, which demonstrates the strong performance of EfficientDM in the fewer-step regime. Moreover, we conduct experiments on LSUN dataset with 20 steps, as referred to Table B in the supplementary material of revised PDF. The proposed EfficientDM consistently outperforms previous quantized diffusion models in the fewer-step regime, which demonstrates the effectiveness of the interpolated quantization scales.\n\n**Performance of unconditional image generation on LSUN-Bedrooms with 20 steps. `N/A' denotes failed image generation.**\n| Method | Bitwidth (W/A) | Model Size (MB) | IS$\\uparrow$ | FID$\\downarrow$ |\n| :---: | :---: | :---: | :---: | :---: |\n| FP     | 32/32       | 1045.4      | 2.21        | 9.74          |\n| Q-Diffusion | 8/8        | 261.67      | 2.13        | 10.10         |\n| Ours   | 8/8        | 261.69      | **2.20**    | **9.75**      |\n| Q-Diffusion | 6/6        | 196.33      | **3.78**     | 149.39        |\n| Ours   | 6/6        | 196.36      | 2.27        | **10.39**     |\n| Q-Diffusion | 4/4        | 130.99      | N/A         | N/A           |\n| Ours   | 4/4        | 131.02      | **2.24**    | **16.35**     |\n\n**Q5: Is QALoRA applied for all the weights, including the convolutions and the attention layers?** As referred to ``Quantization settings\" in Section 5.1 in the paper, the input embedding and output layers are fixed to 8-bit, whereas other convolutional and fully-connected layers are applied with QALoRA modules.\n\n**Q6: Discuss limitations and raise questions worth future studying.** Thanks for your valuable comment. We have updated the ``Limitations and future work\" part in the revised paper. Specifically, while EfficientDM can attain QAT-level performance using PTQ-level data and time efficiency, it employs a gradient descent algorithm for optimizing QALoRA parameters. Compared to PTQ-based methods, this places higher demands on GPU memory, particularly with diffusion models featuring massive parameters. To address this, memory-efficient optimization methods can be integrated. Moreover, efficient diffusion models for tasks such as video or 3D generation are still under explored."
                    }
                },
                "number": 4,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission3007/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700186246278,
                "cdate": 1700186246278,
                "tmdate": 1700187212615,
                "mdate": 1700187212615,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "69Xsih817L",
                "forum": "UmMa3UNDAz",
                "replyto": "3u2zbyqC0O",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission3007/Reviewer_BLfX"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission3007/Reviewer_BLfX"
                ],
                "content": {
                    "title": {
                        "value": "Thanks for the response"
                    },
                    "comment": {
                        "value": "Thanks for the authors' response. It addressed most of my questions. I keep my original rating.\n\nHow about a step number that is fewer than 20?"
                    }
                },
                "number": 11,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission3007/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700707715817,
                "cdate": 1700707715817,
                "tmdate": 1700707715817,
                "mdate": 1700707715817,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "WMVclxuBq0",
            "forum": "UmMa3UNDAz",
            "replyto": "UmMa3UNDAz",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission3007/Reviewer_5Wot"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission3007/Reviewer_5Wot"
            ],
            "content": {
                "summary": {
                    "value": "This paper introduces a data-free fine-tuning framework tailored for low-bit diffusion models. The key approach involves freezing the pretrained diffusion model and fine-tuning a set of quantization-aware LoRA variants (QALoRA) by employing knowledge distillation to capture the denoising capabilities in the full-precision model. The paper also introduces two techniques, namely scale-aware optimization and learned step-size quantization, to address challenges related to ineffective learning of QALoRA and variations in activation distributions. Extensive experiments highlight that EfficientDM achieves performance levels comparable to QAT methods while preserving the data and time efficiency advantages of PTQ methods."
                },
                "soundness": {
                    "value": "4 excellent"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "4 excellent"
                },
                "strengths": {
                    "value": "1.\tAchieving QAT-level performance with PTQ-level efficiency is significant and promising for low-bit diffusion models.\n2.\tThe idea of the QALoRA is novel. Compared to QLoRA, it avoids extra floating-point calculations during inference.\n3.\tThe results are encouraging and demonstrate the strong performance of EfficientDM under various bit-widths.\n4.\tThe paper is well-organized and easy to follow. The supplementary material provides additional experimental results and comprehensive visualization results, which enhance the overall credibility of the work."
                },
                "weaknesses": {
                    "value": "1.\tIt would be beneficial to evaluate EfficientDM over recent text-to-image diffusion models, such as Stable Diffusion.\n2.\tRecent work TDQ [1] also introduces a quantization method that adjusts the quantization scale at various denoising steps. The differences should be discussed.\n3.\tFormulating the gradient of LoRA weights can help elucidate the reasons for ineffective learning of QALoRA.\n4.\tFigure 2: the notation for scale-aware optimization is inconsistent with Eq. (8), please fix it.\n\n[1] So, Junhyuk, et al. \u201cTemporal Dynamic Quantization for Diffusion Models.\u201d arxiv 2023."
                },
                "questions": {
                    "value": "See weaknesses"
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "details_of_ethics_concerns": {
                    "value": "N/A"
                },
                "rating": {
                    "value": "8: accept, good paper"
                },
                "confidence": {
                    "value": "5: You are absolutely certain about your assessment. You are very familiar with the related work and checked the math/other details carefully."
                },
                "code_of_conduct": {
                    "value": "Yes"
                },
                "first_time_reviewer": {
                    "value": "Yes",
                    "readers": [
                        "ICLR.cc/2024/Conference/Program_Chairs",
                        "ICLR.cc/2024/Conference/Submission3007/Senior_Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission3007/Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission3007/Reviewer_5Wot"
                    ]
                }
            },
            "number": 3,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission3007/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1699496913558,
            "cdate": 1699496913558,
            "tmdate": 1699636245087,
            "mdate": 1699636245087,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "YJW7fWQBd6",
                "forum": "UmMa3UNDAz",
                "replyto": "WMVclxuBq0",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission3007/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission3007/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Rebuttal by Authors"
                    },
                    "comment": {
                        "value": "Thanks to the reviewer for the valuable comments.\n\n**Q1: Evaluate EfficientDM over recent text-to-image diffusion models.**\nAs referred to Figures K-M in the supplementary material, we include visualization results to evaluate EfficientDM over text-to-image Stable Diffusion models.\n\n**Q2: The differences from TDQ should be discussed.** Please refer to Q1 in the general response. TDQ incorporates additional MLP modules for each quantized layer to approximate quantization scales. This approach entails training these extra MLP modules, leading to a significant surge in training expenses. Conversely, TLSQ introduces a limited number of adjustable quantization scales per layer, making TLSQ more computationally efficient than TDQ. Empirically, TLSQ achieves a 20.9% faster training iteration speed compared to TDQ over DDIM model on CIFAR-10 dataset.\n\n**Q3: Formulating the gradient of LoRA weights.**  Referring to Eq.~(6) in the paper and considering the impact of STE [i], the gradient of LoRA weights $\\mathbf{BA}$ can be expressed as:\n\\begin{gather}\n    \\frac{\\partial \\mathbf{Y}}{\\partial (\\mathbf{BA})}= \\frac{\\partial \\mathbf{Y}}{\\partial \\hat{\\mathbf{W}}} \\frac{\\partial \\hat{\\mathbf{W}}}{\\partial (\\mathbf{BA})} = \\hat{\\mathbf{X}}^\\top\n\\end{gather}\nThe key insight is that the gradient magnitudes of LoRA weights remain unaffected by the quantization scale, which is exactly the step size of the quantization step-like function. Consequently, in layers with larger quantization scales, the minor updates to LoRA weights will be diminished by the round operation, which causes the ineffective learning of QALoRA.\n\n**Q4: The notation for scale-aware optimization in Fig. (2) is inconsistent with Eq. (8).** Thanks for the valuable comments. We have corrected it in the revised version.\n\n[i] Bengio, Yoshua, Nicholas L\u00e9onard, and Aaron Courville. \"Estimating or propagating gradients through stochastic neurons for conditional computation.\" arXiv, 2013."
                    }
                },
                "number": 3,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission3007/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700186118698,
                "cdate": 1700186118698,
                "tmdate": 1700186865117,
                "mdate": 1700186865117,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "Ulq6xWSjN5",
                "forum": "UmMa3UNDAz",
                "replyto": "YJW7fWQBd6",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission3007/Reviewer_5Wot"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission3007/Reviewer_5Wot"
                ],
                "content": {
                    "comment": {
                        "value": "Thanks for the authors' reply, and my questions are addressed very well. Overall, I like this paper since the motivation is very clear, and the proposed method is novel and brings new insights. I keep my score and recommend this paper for acceptance."
                    }
                },
                "number": 13,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission3007/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700709332829,
                "cdate": 1700709332829,
                "tmdate": 1700709332829,
                "mdate": 1700709332829,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "xwL7I36Hg3",
            "forum": "UmMa3UNDAz",
            "replyto": "UmMa3UNDAz",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission3007/Reviewer_ec6g"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission3007/Reviewer_ec6g"
            ],
            "content": {
                "summary": {
                    "value": "This paper proposes a quantization-aware variant of low rank adapter and a data-free training scheme  for fine-tuning quantized diffusion models. It introduces scale-aware techniques to optimize the weight quantization parameters. For activation quantization, this paper employs a separate activation quantization step-size parameter for each denoising time step. With tuning the low rank weight parameter adapters, this method can achieve  image generation performance comparable to QAT based methods with much lower fine-tuning cost. It firstly achieves FID score as low as 6.17 on conditional image generation on ImageNet 256x256 dataset with 4bit-weight, 4bit-activation diffusion model."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "2 fair"
                },
                "strengths": {
                    "value": "* This paper is the first to achieve very good image generation performance with W4A4 diffusion models and W2A8 diffusion models.\n\n* This paper introduces **low rank adapter** and **distillation loss** to fine-tune quantized diffusion models and achieve good results with relatively low cost than QAT methods."
                },
                "weaknesses": {
                    "value": "* The experimental results listed in this paper are confusing and do not align well. The effectiveness is not very well proved. \n\n* This paper proposes **TLSQ**, which is quite similar to TDQ in [1]. TDQ is applicable to diffusion models with both continuous time and arbitrary discrete time steps . The paper should clarify the number of time steps used in TLSQ and discuss the settings.  \n\n[1] Temporal dynamic quantization for diffusion models."
                },
                "questions": {
                    "value": "* In Table 2, the FID score of W4A4 model (6.17) is much lower than FP model (11.28) and W8A8 model (11.38) is comparable to FP model. Is there any possible explanation for that? And in the paper \"High-Resolution Image Synthesis with Latent Diffusion Models\", FID score of conditional generation on ImageNet 256x256 is 3.60, which is much lower than 11.28, why is there a gap? In the Appendix.A Table.A, the unconditional image generation on LSUN dataset, the FID score of W4A4 model is much worse than the FP model, how to explain the gap in these two set of experiments?\n\n* Table 3 shows the ablation study results. Does the **QALoRA** use LSQ algorithm to fine-tune the low rank adapter parameters and quantization step-size parameters?  \n\n* Are there any results on using LSQ method on quantized diffusion models on dataset other than Cifar10?\n\n* In **Data-free fine-tuning for diffusion models** part, is $\\mathbf{x}_t$ in Eq(7) sampled from Gaussion noise with an FP model?\n\n* In **Variation of activation distribution across steps** part, it proposes to assign a separate step size parameter for activation quantization in each denoising time step, and the results shown in Table 2 are obtained from 20-step sampling. Is the total time steps fixed to 20 for the fine-tuning. Is the data-free fine-tuning in Eq(7) fixed for 20 steps?\n\n* In Sec3.2 Eq(3), the quantization scheme has three parameters, $l, u, s$, are they all trainable? If so, is it optimized with LSQ [2] or LSQ+ [3] algorithm?\n\n\n[1] High-Resolution Image Synthesis with Latent Diffusion Models.\n\n[2] Learned step size quantization.\n\n[3] LSQ+: Improving low-bit quantization through learnable offsets and better initialization."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "6: marginally above the acceptance threshold"
                },
                "confidence": {
                    "value": "5: You are absolutely certain about your assessment. You are very familiar with the related work and checked the math/other details carefully."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 4,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission3007/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1699535446289,
            "cdate": 1699535446289,
            "tmdate": 1699636245020,
            "mdate": 1699636245020,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "mhQu2tTfe1",
                "forum": "UmMa3UNDAz",
                "replyto": "xwL7I36Hg3",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission3007/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission3007/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Rebuttal by Authors"
                    },
                    "comment": {
                        "value": "Thanks to the reviewer for the valuable comments.\n\n**Q1: The experimental results listed in this paper are confusing and do not align well. In Table 2, the FID score of W4A4 model is much lower than FP model. While in Table A, the FID score of W4A4 model is much worse than the FP model. How to explain the gap in these two sets of experiments?** \nThere might be a misunderstanding of our results. To clarify, **while FID provides an informative metric, it might not holistically capture the improved image quality**. Therefore, referring to Table 2 in the paper, we thoroughly evaluate EfficientDM's performance by reporting the results of four standard metrics: IS, FID, sFID, and Precision. It's crucial to emphasize the **comprehensive integration of these metrics** when evaluating the model, rather than relying solely on any individual metric. Through a thorough evaluation with these metrics, FP models consistently outperform W4A4 models. Moreover, we have provided visualizations in Figures D-J in the supplementary material, convincingly showcasing the quality of images generated by EfficientDM.\n\n**Q2: Why is there a gap between the FID results reported in this paper and LDM [i]?** \nThe settings are different. LDM paper uses 250 DDIM steps to obtain an FID of 3.60, while we use 20 DDIM steps to obtain an FID of 11.28.\n\n**Q3: The paper should clarify the number of time steps used in TLSQ and discuss the settings.**\nIn practice, we set the number of time steps as 100 during fine-tuning and interpolate the learned temporal quantization scales when sampling with fewer time steps. We include the settings in Section 5.1 in the revised paper.\n\n**Q4: Does the QALoRA use LSQ algorithm to fine-tune the low rank adapter parameters and quantization step-size parameters?**\nYes, the weight quantization step-size parameters are optimized during the fine-tuning process.\n\n**Q5: Additional experimental results of using LSQ [ii] method on quantized diffusion models.**\nAs referred to Table A in the supplementary material, we conduct experiments using LSQ method on LSUN dataset. Despite consuming $15.8\\times$ less time, our approach surpasses LSQ at W8A8 bit-width, demonstrating superior FID performance.  At W6A6 bit-width, our approach achieves an FID that is only 0.07 higher than LSQ, striking a better balance between performance and efficiency.\n\n**Q6: Is $\\mathbf{x}_t$ in Eq. (7) sampled from Gaussian noise with an FP model?** Yes. Please refer to Q2 in the general response. The input data $\\mathbf{x}_t$ is derived from denoising random Gaussian noise $\\mathbf{x}_T \\sim \\mathcal{N}(0,1)$ with the FP model through $T-t$ iterations. We have revised the explanation of Eq. (7) in the revised paper.\n\n**Q7: Is the data-free fine-tuning in Eq. (7) fixed for 20 steps?** \nAs referred to Q2, we set the denoising step for fine-tuning as 100 in practice and interpolate the learned scales for sampling with fewer steps. \n\n**Q8: In Eq. (3), the quantization scheme has three parameters, are they all trainable?**\nNo. Only quantization scale $s$ is trainable and optimized with LSQ algorithm, while $l$ and $u$ are determined by the target bit-width. We have revised it in the revised paper.\n\n[i] Rombach, Robin, et al. ``High-resolution image synthesis with latent diffusion models.\" CVPR, 2022.\n\n[ii] Esser, Steven K., et al. ``Learned step size quantization.\" ICLR 2020."
                    }
                },
                "number": 2,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission3007/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700186074268,
                "cdate": 1700186074268,
                "tmdate": 1700187018194,
                "mdate": 1700187018194,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "mSuuyXvysG",
                "forum": "UmMa3UNDAz",
                "replyto": "xwL7I36Hg3",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission3007/Reviewer_ec6g"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission3007/Reviewer_ec6g"
                ],
                "content": {
                    "comment": {
                        "value": "Thanks for the authors' response. It well addresses my concerns."
                    }
                },
                "number": 10,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission3007/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700669816245,
                "cdate": 1700669816245,
                "tmdate": 1700711003284,
                "mdate": 1700711003284,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "ZEVwj0TEoO",
                "forum": "UmMa3UNDAz",
                "replyto": "KYnJCGqYa2",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission3007/Reviewer_ec6g"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission3007/Reviewer_ec6g"
                ],
                "content": {
                    "comment": {
                        "value": "I have another question about the **Variation of activation distribution across steps** part. Since the training is on 100-step DDIM,  if there are 100 the activation quantizer step-size parameters, how is the training performed? I think a lot of step-size parameters will have 0 gradients in one training iteration. Did you do something to alleviate it?"
                    }
                },
                "number": 16,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission3007/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700715638216,
                "cdate": 1700715638216,
                "tmdate": 1700715638216,
                "mdate": 1700715638216,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "C4AEiKtaXw",
                "forum": "UmMa3UNDAz",
                "replyto": "xwL7I36Hg3",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission3007/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission3007/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Response to Reviewer ec6g"
                    },
                    "comment": {
                        "value": "Dear Reviewer ec6g,\n\nAs referred to \"Variation of activation distribution across steps\" part of the paper, we allocate temporal step-size parameters for activations and optimize them individually for each step. Therefore, during each training iteration, which corresponds to a single denoising step, only the step-size parameters associated with this step are updated, while other step sizes have zero gradients because they are not involved in forward propagation. **After a complete denoising process spanning all denoising steps, all temporal step-size parameters undergo optimization.**\n\nBest regards,\n\nAuthors of #3007."
                    }
                },
                "number": 17,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission3007/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700721830237,
                "cdate": 1700721830237,
                "tmdate": 1700739517853,
                "mdate": 1700739517853,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "BewYhIULcT",
                "forum": "UmMa3UNDAz",
                "replyto": "C4AEiKtaXw",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission3007/Reviewer_ec6g"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission3007/Reviewer_ec6g"
                ],
                "content": {
                    "comment": {
                        "value": "If an optimizer like Adam is applied, the momentum statistics will be affected by the zero gradients. Didn't it influence the training procedure?"
                    }
                },
                "number": 18,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission3007/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700729196767,
                "cdate": 1700729196767,
                "tmdate": 1700729196767,
                "mdate": 1700729196767,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "xi2H6J9vIB",
                "forum": "UmMa3UNDAz",
                "replyto": "xwL7I36Hg3",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission3007/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission3007/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Response to Reviewer ec6g"
                    },
                    "comment": {
                        "value": "Dear Reviewer ec6g,\n\nIn our method, during each training iteration corresponding to a single denoising step, **only the step-size parameters associated with this denoising step are updated**. To achieve this, we store a copy of the Adam optimizer's statistics for all other step sizes in a separate memory space and then temporarily zero them out to ensure they remain unaffected during the update process. For the step size parameters associated with this step, their statistics will be loaded back into the optimizer.\n\nBest regards,\n\nAuthors of #3007."
                    }
                },
                "number": 19,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission3007/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700736515819,
                "cdate": 1700736515819,
                "tmdate": 1700741038772,
                "mdate": 1700741038772,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    }
]