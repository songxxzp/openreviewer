[
    {
        "title": "The Role of Counterfactual Explanations in Model Extraction Attacks"
    },
    {
        "review": {
            "id": "w5m5K7MtVi",
            "forum": "ORHuMEwaC8",
            "replyto": "ORHuMEwaC8",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission2919/Reviewer_4YsF"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission2919/Reviewer_4YsF"
            ],
            "content": {
                "summary": {
                    "value": "The paper studies how counterfactual explanations can be used for model extraction attacks."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "2 fair"
                },
                "strengths": {
                    "value": "- Highly relevant research question\n- Paper is well structure and mostly well written (only a discussion of limitation of the proposed method is missing)\n- Nice intuitive geometric approach, although I think that there are some limitations (see Section \"Weaknesses\")"
                },
                "weaknesses": {
                    "value": "- Only closest counterfactuals are considered. However, in practice, plausibility and actionability are also very important aspects of recourse. Some explanation generation method might not output closest counterfactuals but plausible ones. \n- Lipschitz continuity and monotonicity are both very strong assumptions -- they might not hold for many models in practice.\n- Authors should also discuss limitations of their proposed method"
                },
                "questions": {
                    "value": "- How can the proposed method be extended to deal with plausible and actionable counterfactuals? As mentioned above, these two aspects are highly relevant in recourse, and might be used instead of closest counterfactuals.\n- What to do in case of really large Lipschitz constants? Would the proposed method still work?"
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "5: marginally below the acceptance threshold"
                },
                "confidence": {
                    "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 1,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission2919/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698216927364,
            "cdate": 1698216927364,
            "tmdate": 1699636235699,
            "mdate": 1699636235699,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "C26lDwb5Bd",
                "forum": "ORHuMEwaC8",
                "replyto": "w5m5K7MtVi",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission2919/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission2919/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Response to Reviewer 4YsF (1/2)"
                    },
                    "comment": {
                        "value": "We appreciate the recognition of the relevance of our work. Based on the comments, we make the following edits to our paper.\n\n**On other counterfactual-generation mechanisms:** We have now included results from a rich set of experiments covering different model architectures and counterfactual generating methods (see Section 4 and Appendix B.2). Particularly, the results cover sparse counterfactuals which are generated by using the L1-norm as the cost function in the counterfactual generating method. Moreover, we would like to point out that the proposed practical attack is independent of the counterfactual generating method, as long as the generated counterfactuals lie sufficiently closer to the decision boundary. They need not be the closest ones to the corresponding original instances. We included this in the limitations section (see page 9).\n\n**On the assumptions of Lipschitz continuity and monotonicity:** We note that the practical neural networks may have large global Lipschitz constants. However, we first make the observation that our theoretical guarantee (Theorem 3) would also extend to the local Lipschitz continuity, which may be more common as compared to global Lipschitz continuity (added Remark 2 on page 6). In fact, this observation leads to another interesting interpretation of our theoretical results that is generally insightful even for practical neural networks: *the regions of the decision boundary with low local-Lipschitz constant are more easily reconstructed.*\n\nFurthermore, we have now included a new set of experimental results demonstrating the relationship  of the attack performance with the Lipschitz constant (see Figure 17 in Appendix B.2 page 21). Following [1], we approximate the Lipschitz constant of a neural network by the product of the spectral norms of the weight matrices. We achieve different Lipschitz constants by controlling the L2-regularization of the layer weights while training the target model. Our approximations were in the range 37 to 713 and are also comparable to the values present in other works [1, Figure 4],[2, Figure 1],[3, Table 1]. Therefore, it is evident from the experiments that the proposed attack remains valid for significantly large Lipschitz constants. Our observations follow our theoretical insights, where a greater Lipschitz constant gradually degrades the fidelity for a given number of queries. \n\nOur findings are interesting and significant because they highlight an interesting connection between Lipschitz constant and vulnerability to model extraction. Furthermore, noting that a low Lipschitz constant is an indicator of good generalization of a model and adversarial robustness [1],[2],[3], our findings also point towards a potential tradeoff between good generalization and vulnerability to model extraction attacks, which could also be interesting for future research.\n\nMoreover, we note that monotonicity is a favorable characteristic in the context of fair and interpretable machine learning [4], which is achievable particularly in the case of tabular data. We would like to clarify that monotonicity is not assumed in case of the main theorems or in the proposed practical attack or experiments. We only assume monotonicity to show an additional reduction in the query complexity as pointed out in Corollary 1."
                    }
                },
                "number": 7,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission2919/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700179655792,
                "cdate": 1700179655792,
                "tmdate": 1700179655792,
                "mdate": 1700179655792,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "7k3jaHphlN",
                "forum": "ORHuMEwaC8",
                "replyto": "w5m5K7MtVi",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission2919/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission2919/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Response to Reviewer 4YsF (2/2)"
                    },
                    "comment": {
                        "value": "**On the discussion on limitations:** Following the suggestions of Reviewer 4YsF we have now included this section in our modified manuscript (see page 9). \n\n\u201cLimitations and future work: One limitation of our theoretical results is the assumption of a convex decision boundary. While this assumption is satisfied in some settings [5], it is not often the case. In addition, the derivations require the counterfactual generating mechanisms to provide the closest counterfactuals. Any relaxation to these assumptions are paths for exploration. We note that the attack proposed in Section 3.2 remains valid as long as the majority of counterfactuals lie closer to the decision boundary; they need not be the closest ones to the corresponding original instances. Utilizing techniques in active learning in conjunction with counterfactuals is another problem of interest. Extending the results of this work for multi-class classification scenarios can also be explored. Our findings also highlight an interesting connection between Lipschitz constant and vulnerability to model extraction, which could also have implications for future work on generalization, adversarial robustness, etc.\u201d\n\n[1] H. Gouk, E. Frank, B. Pfahringer, and M. J. Cree, \u201cRegularisation of neural networks by enforcing Lipschitz continuity,\u201d Mach Learn, vol. 110, no. 2, pp. 393\u2013416, Feb. 2021.\n\n[2] M. Jordan and A. G. Dimakis, \u201cExactly Computing the Local Lipschitz Constant of ReLU Networks,\u201d in Advances in Neural Information Processing Systems, Curran Associates, Inc., 2020, pp. 7344\u20137353.\n\n[3] P. Pauli, A. Koch, J. Berberich, P. Kohler and F. Allg\u00f6wer, \"Training Robust Neural Networks Using Lipschitz Bounds,\" in IEEE Control Systems Letters, vol. 6, pp. 121-126, 2022.\n\n[4] X. Liu, X. Han, N. Zhang, and Q. Liu, \u201cCertified Monotonic Neural Networks,\u201d in Advances in Neural Information Processing Systems, Curran Associates, Inc., 2020, pp. 15427\u201315438.\n\n[5] B. Amos, L. Xu, and J. Z. Kolter, \u201cInput Convex Neural Networks,\u201d in Proceedings of the 34th International Conference on Machine Learning, PMLR, Jul. 2017, pp. 146\u2013155."
                    }
                },
                "number": 8,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission2919/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700179739678,
                "cdate": 1700179739678,
                "tmdate": 1700179739678,
                "mdate": 1700179739678,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "clVUoQWpqT",
            "forum": "ORHuMEwaC8",
            "replyto": "ORHuMEwaC8",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission2919/Reviewer_q134"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission2919/Reviewer_q134"
            ],
            "content": {
                "summary": {
                    "value": "This paper presents a theoretical analysis and practical approach to model extraction using counterfactual explanations.\nIn the theoretical analysis, the authors investigate the query complexity of model extraction under ideal assumptions, where the positive region is convex, and the model is Lipschitz.\nIn terms of practical methods, the authors focus on the observation that many counterfactual explanations are only required in the direction how the negative decisions can be altered to positive ones.\nThe authors proposed a method for model extraction from such biased counterfactual explanations. \nSpecifically, they assumed that counterfactual explanations lie on a decision boundary where the prediction probability is constant, and proposed a modified binary cross-entropy loss based on this assumption.\nIn the experiments, the authors demonstrated that the proposed method outperformed conventional methods, particularly in addressing the phenomenon known as \"decision boundary shift.\""
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "3 good"
                },
                "strengths": {
                    "value": "This paper exhibits two key strengths: a theoretical analysis and a development of practical method for model extraction using counterfactual explanations.\nIn theoretical analysis, the authors established ideal assumptions such as a convex positive region and a Lipschitz model. Even under these ideal conditions, it would be important to theoretically elucidate query complexity, leading to an important step forward in the advancement of model extraction research.\nRegarding the practical method, the authors demonstrated that \"decision boundary shift\" can be easily addressed by a simple modification of the cross-entropy loss function.\n\n**Originality, Quality**\n\nThis study demonstrates originality in identifying conditions such as a convex positive region and a Lipschitz model as factors influencing query complexity in model extraction.\nWhile these conditions may be limited and idealized, the theoretical clarification of query complexity remains a crucial step in moving the model extraction research forward.\n\n**Clarity**\n\nThroughout the paper, the fundamental concepts and contributions of the research are clearly stated.\n\n**Significance**\n\nDemonstrating that \"decision boundary shift\" can be addressed through a straightforward modification of the cross-entropy loss is considered particularly significant.\nOn the other hand, the theoretical analysis of query complexity is still confined to ideal conditions, necessitating further in-depth analysis for this result to have a broad impact within the research field."
                },
                "weaknesses": {
                    "value": "This paper has two weaknesses: \"Novelty and Effectiveness of the Modified Cross-Entropy Loss\" and \"Gap Between Theoretical Analysis and Methodology.\"\n\n**Novelty and Effectiveness of the Modified Cross-Entropy Loss**\n\nAn inherent aspect of counterfactual explanations is that they correspond to points on the decision boundary, making it natural to consider their class probability as 0.5.\nWhen using counterfactual explanations as training data for model extraction, it is also natural to use them as data points with a class probability of 0.5.\nViewing the problem of model extraction in this light, it can be reduced to a learning problem involving soft labels.\nThe question that arises is whether the modified cross-entropy loss proposed in this study is a novel and particularly effective method for this problem.\nWhile this is not necessarily a fatal weakness, the paper appears to lack a discussion regarding the relevance of the modified cross-entropy loss to the broader context of soft label research and its unique effectiveness and novelty in this specific problem.\n\n**Gap Between Theoretical Analysis and Methodology**\n\nIn the theoretical analysis, the assumptions of the convexity of the positive region and the Lipschitz property of the model play essential roles.\nHowever, these assumptions are entirely disregarded in Section 4.\nWhile it is understood that models in real world do not exhibit convex positive regions, it appears that the paper currently contains two largely independent sections: one focused on theory and the other on methodology.\nIn Section 4, the authors mention, \"While the primary contribution of this work is theoretical, in this section we further present an empirical performance evaluation of the model extraction attack devised in the previous section for one-sided counterfactuals.\"\nThis statement likely refers to the content in Section 3.2.\nHowever, Section 4 lacks explicit mention of the Lipschitz property.\nTherefore, questions arise about whether the Lipschitz assumption plays a fundamental role in Section 4, as suggested in Section 3.2."
                },
                "questions": {
                    "value": "* Are there any other possible alternatives of the proposed modified cross entropy loss, in particular in the context of soft label? If not, what is the essential difference or advantage of the proposed the proposed modified cross entropy loss?\n* Do the Lipschitz assumption plays a fundamental role in Section 4, as suggested in Section 3.2? Or, all we need is the proposed modified cross entropy loss alone?"
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "6: marginally above the acceptance threshold"
                },
                "confidence": {
                    "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 2,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission2919/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698388588222,
            "cdate": 1698388588222,
            "tmdate": 1699636235628,
            "mdate": 1699636235628,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "z7D2lpquYB",
                "forum": "ORHuMEwaC8",
                "replyto": "clVUoQWpqT",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission2919/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission2919/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Response to Reviewer q134"
                    },
                    "comment": {
                        "value": "We are grateful to Reviewer q134 for their review and for pointing out our key strengths, i.e., \u201ca theoretical analysis and a development of practical method for model extraction using counterfactual explanations\u201d. As they have clearly identified, we provide novel results in a setting where the counterfactual explanations are provided for queries from only one class. \n\n**On the novelty and effectiveness of the proposed loss function:** We note that the problem setting of the broadly studied area of soft-label learning [1],[2] is different from the problem we have at hand due to the following two main reasons:\n\n(I) The labels in our problem do not smoothly span the interval [0,1]. Instead they are either 0, 1 or 0.5.\n\n(II) The label of 0.5 that is assigned to counterfactuals does not necessarily indicate a class probability. The class of a counterfactual is strictly y = 1 as it is a training example for the surrogate model. The counterfactuals that are well within the surrogate decision boundary should not cause a penalty even if their label is 0.5.\n\nBased on the suggestion of Reviewer q134, we have now included the above clarification in the manuscript under \u201cModel architectures\u201d in Section 4 (page 7). \n\nIn fact, in our early experiments we have tried using a loss function that symmetrically penalizes counterfactual explanations if $\\tilde{m}(\\boldsymbol{w}) \\neq 0.5$. This, however, did not provide expected results mainly due to some counterfactuals being  well within the boundary caused by imperfections in the generating method. The proposed loss function (Equation (5) page 8) alleviates this issue by not penalizing such counterfactual explanations.\n\n**On the gap between theoretical analysis and methodology:** We have addressed the comments in two ways. First, we present a synthetic experiment validating the sample complexity derived in Theorem 2 (see Figure 7 in Section 4 and Appendix B.1 page 16). For our experiment, we specifically choose a spherical decision boundary which is known to be particularly difficult for polytope approximation [3]. Our experiments demonstrate that for each choice of dimension $d$, the expected approximation error $\\epsilon =1-\\mathbb{E}[\\text{Fidelity}]$ decays faster than $n^{-2/(d-1)}$ where $n$ is the query size. We demonstrate this using a log-log plot of ln($\\epsilon$) vs ln($n$) (see Figure 7 page 7).\n\nNext, we present the results of a new set of experiments based on real-world data, which demonstrates the effect of the Lipschitz constant of the target model on the attack performance (see Figure 17 Appendix B.2 page 21). Following [4], we approximate the Lipschitz constant of a neural network by the product of the spectral norms of the weight matrices. We achieve different Lipschitz constants by controlling the L2-regularization of the layer weights while training the target model. Our approximations were in the range 37 to 713 and are also comparable to the values obtained in other works [4, Figure 4],[5, Figure 1],[6, Table 1]. Therefore, it is evident from the experiments that the proposed attack remains valid for significantly large Lipschitz constants. Our observations follow our theoretical insights, where a greater Lipschitz constant gradually degrades the fidelity for a given number of queries. \n\n[1] Q. Nguyen, H. Valizadegan, A. Seybert, and M. Hauskrecht, \u201cSample-efficient learning with auxiliary class-label information,\u201d AMIA Annu Symp Proc, vol. 2011, pp. 1004\u20131012, 2011.\n\n[2] Q. Nguyen, H. Valizadegan, and M. Hauskrecht, \u201cLearning classification with auxiliary probabilistic information,\u201d Proc IEEE Int Conf Data Min, vol. 2011, pp. 477\u2013486, 2011.\n\n[3] S. Arya, G. D. Da Fonseca, and D. M. Mount, \u201cPolytope Approximation and the Mahler Volume,\u201d in Proceedings of the Twenty-Third Annual ACM-SIAM Symposium on Discrete Algorithms, Society for Industrial and Applied Mathematics, Jan. 2012, pp. 29\u201342.\n\n[4] H. Gouk, E. Frank, B. Pfahringer, and M. J. Cree, \u201cRegularisation of neural networks by enforcing Lipschitz continuity,\u201d Mach Learn, vol. 110, no. 2, pp. 393\u2013416, Feb. 2021.\n\n[5] M. Jordan and A. G. Dimakis, \u201cExactly Computing the Local Lipschitz Constant of ReLU Networks,\u201d in Advances in Neural Information Processing Systems, Curran Associates, Inc., 2020, pp. 7344\u20137353.\n\n[6] P. Pauli, A. Koch, J. Berberich, P. Kohler and F. Allg\u00f6wer, \"Training Robust Neural Networks Using Lipschitz Bounds,\" in IEEE Control Systems Letters, vol. 6, pp. 121-126, 2022."
                    }
                },
                "number": 6,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission2919/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700179370779,
                "cdate": 1700179370779,
                "tmdate": 1700179370779,
                "mdate": 1700179370779,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "XXVTDtuSHa",
                "forum": "ORHuMEwaC8",
                "replyto": "z7D2lpquYB",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission2919/Reviewer_q134"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission2919/Reviewer_q134"
                ],
                "content": {
                    "title": {
                        "value": "Re: Response to Reviewer q134"
                    },
                    "comment": {
                        "value": "I would like to thank the authors for detailed comments and additional experiments.\n\nHere, I would like to add one comment on soft-labels.\nIn Eq.(5), the authors considered a customized loss function.\nI wonder whether this can be simplified as the standard cross entropy loss.\n$$\nL(m, y) = - \\sum_{(x, y) \\in D} \\left(y \\log m(x) + (1 - y) \\log (1 - m(x)) \\right)\n$$\nIn the current problem, as the authors noted, there are three possible $y$: $y = 0, 1$, and $0.5$.\nFor $y = 0.5$, the cross entropy loss $- \\left(y \\log m(x) + (1 - y) \\log (1 - m(x)) \\right)$ is minimized when $m(x) = 0.5$.\nSo, I think just by simply learning the surrogate $m$ by the standard cross entropy loss will keep the boundary point with $y = 0.5$ as the boundary on the surrogate as $m(x) = 0.5$."
                    }
                },
                "number": 9,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission2919/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700703891378,
                "cdate": 1700703891378,
                "tmdate": 1700703891378,
                "mdate": 1700703891378,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "1PALJB2fQV",
                "forum": "ORHuMEwaC8",
                "replyto": "clVUoQWpqT",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission2919/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission2919/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Re: Re: Response to Reviewer q134"
                    },
                    "comment": {
                        "value": "We thank Reviewer q134 for their review and for their positive opinion about our work. \n\n**Regarding the cross-entropy loss for counterfactuals:** \nIn our early experiments, we experimented with the standard binary cross entropy loss for counterfactuals with label 0.5. This loss function is symmetric around 0.5. However, we found that this symmetric loss function did not provide good model approximation results. Instead, our proposed loss function only penalizes when $\\tilde{m}(x) < 0.5$ for counterfactuals but not if $\\tilde{m}(x) \\geq 0.5$. We have found that this asymmetric loss function achieves good model approximation as demonstrated in our experimental results. We believe this happens because practical counterfactual generation mechanisms generate counterfactuals that are close to the boundary while being on the accepted side $(m(x) \\geq 0.5)$ but may not be exactly 0.5. \n\nWe include some examples from our experiments here (the dataset is Adult Income and the counterfactual generating method is DiCE, fidelities are for surrogate model 0):\n\nQuery size: 100 ----> Ordinary BCE loss: 0.424 -----> Proposed loss: 0.835\n\nQuery size: 200 ----> Ordinary BCE loss: 0.519 -----> Proposed loss: 0.887\n\nQuery size: 300 ----> Ordinary BCE loss: 0.532 -----> Proposed loss: 0.917"
                    }
                },
                "number": 10,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission2919/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700740644437,
                "cdate": 1700740644437,
                "tmdate": 1700740666269,
                "mdate": 1700740666269,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "m0qUaO7N9s",
            "forum": "ORHuMEwaC8",
            "replyto": "ORHuMEwaC8",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission2919/Reviewer_MQ33"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission2919/Reviewer_MQ33"
            ],
            "content": {
                "summary": {
                    "value": "This paper introduces two model extraction strategies that use counterfactuals. The first strategy exploits the properties of closest counterfactuals, while the second strategy leverages the Lipschitz continuity of target and surrogate models. The authors provide theoretical guarantees and address the issue of decision boundary shift in a system that provides one-sided counterfactuals. Experimental results show improved fidelity compared to a baseline method."
                },
                "soundness": {
                    "value": "2 fair"
                },
                "presentation": {
                    "value": "2 fair"
                },
                "contribution": {
                    "value": "2 fair"
                },
                "strengths": {
                    "value": "1. Remark 1 gives a false sense about the difficulty of the problem. The difficulty of approximating a non-convex body is way more difficult than this. A convex body can be approximated by the intersection of many half spaces, and this is what the authors are using in Section 3.1. However, it is unclear how to approximate a non-convex body using half spaces without logical rules (like boolean variables). Figure 4 is two-dimensional, and we can easily identify the intersections of two hyperplanes; however, for higher dimensions, it is absolutely not clear how to find these intersections. Thus, a similar representation using red piecewise linear curve like Figure 4 does not generalize to higher dimensions.\nThere is no clear message in Section 3.2: Theorem 3 is too simple to be a theorem, and there is no definitive description of the extraction strategy.\nSection 3: the authors claim ``Even though the attack is valid for a decision boundary of any shape\u201d, but there is no clear direction on how to generalize the attack to a non-convex boundary.\nThe extraction attack omits the queries that are predicted 0 by $m$ in the objective function (5). Why?\nThe paper provides some sample complexity results for the extraction attacks."
                },
                "weaknesses": {
                    "value": "1. Remark 1 gives a false sense of the difficulty of the problem. The difficulty of approximating a non-convex body is way more difficult than this. A convex body can be approximated by the intersection of many half-spaces, and this is what the authors are using in Section 3.1. However, it is unclear how to approximate a non-convex body using half spaces without logical rules (like boolean variables). Figure 4 is two-dimensional, and we can easily identify the intersections of two hyperplanes; however, for higher dimensions, it is absolutely not clear how to find these intersections (the intersection is again a $d-2$ dimensional manifold). Thus, a similar representation using red piecewise linear curve like Figure 4 does not generalize to higher dimensions.\n2. There is no clear message in Section 3.2: Theorem 3 is too simple to be a theorem, and there is no definitive description of the extraction strategy.\n3. Section 3: the authors claim ``Even though the attack is valid for a decision boundary of any shape\u201d, but there is no clear direction on how to generalize the attack to a non-convex boundary.\n4. The extraction attack omits the queries that are predicted 0 by $m$ in the objective function (5). Why?\n\nOverall, I could not find a strong argument to justify why this paper should be accepted at ICLR. The theoretical contribution of this paper is quite limited, and somewhat trivial by combining existing results in the literature. The practical contribution of this paper is also not strong."
                },
                "questions": {
                    "value": "1. Concerning Remark 2: suppose that MLaaS is using a robust recourse method. How can we estimate the value of $k$ so that we can perform model extraction?\n2. Figure 7 and 8 are too simple. Could the authors provide some illustrations for (i) harder dataset, and (ii) $\\tilde m$ of lower model complexity than $m$?\n3. How would the model behave for an unbalanced dataset, or when the number of counterfactuals is small?\n4. Is there any easy active learning method to query that can help us perform an extraction attack with a limited number of targeted queries?"
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "3: reject, not good enough"
                },
                "confidence": {
                    "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 3,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission2919/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698659198227,
            "cdate": 1698659198227,
            "tmdate": 1699636235543,
            "mdate": 1699636235543,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "i6FQIEikYm",
                "forum": "ORHuMEwaC8",
                "replyto": "m0qUaO7N9s",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission2919/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission2919/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Response to Reviewer MQ33 (1/2)"
                    },
                    "comment": {
                        "value": "We thank Reviewer MQ33 for taking out the time to review this paper. We have made the changes discussed below, in an effort to address the comments.\n\n**On the clarity of Remark 1:** We would like to clarify that our intention is not to downplay the difficulty of approximating a non-convex decision boundary but to simply highlight that concave regions are also amenable to polytope approximation, and we have updated Remark 1 accordingly to reflect this.\n\n\"Remark 1: Even though Theorem 2 assumes convexity of the decision boundary for analytical tractability, the attack can be extended to a concave decision boundary. This is because the closest counterfactual will always lead to a tangent hyperplane irrespective of convexity and now the rejected region can be seen as the intersection of these half-spaces (Theorem 1 does not assume convexity). However, it is worth noting that approximating a concave decision boundary is, in general, more difficult than approximating a convex region. To obtain equally-spaced out tangent hyperplanes on the decision boundary, a concave region will require a much denser set of query points (see Figure 4) due to the inverse effect of length contraction discussed in Aleksandrov (1967, Chapter III Lemma 2). Furthermore, approximating a decision boundary which is neither convex nor concave is much more challenging as the decision regions can no longer be approximated as intersections of half-spaces. This motivates us to propose an attack that does not depend on convexity assumption leveraging Lipschitz continuity, as discussed next. Experiments indicate that the query complexity of this Lipschitz-based attack is upper-bounded by the result in Theorem 2 (see Figure 16).\"\n\n**On 2D visualizations on more complex datasets:** Following the comments by Reviewer MQ33, we have now replaced Figures 7 and 8 (Figures 8 and 11 in the updated version) with results of an experiment including a more complex dataset (\"moons\" from sklearn package) and a surrogate model which is simpler than the target model (see Section B.1.)\n\n**On clarifying the attack proposed in Section 3:** We would like to clarify that the practical attack based on the Lipschitz continuity proposed in Section 3.2 does not assume the decision boundary to have any particular shape (convex or concave). It is formulated based on the insights of Theorem 3. However, when analyzing the query complexities for this attack, we assume the decision boundary to be convex. The proposed objective function (Equation (5), also given below) plays a vital role in ensuring the conditions of Theorem 3, where the surrogate model needs to be forced into predicting k ((0,1]) for counterfactual instances.\n\n$L_k(\\tilde{m},y) = \\frac{1}{|\\mathbb{D}|} \\sum_{\\boldsymbol{x} \\in \\mathbb{D}} \\Bigg( \\mathbb{1}[y(\\boldsymbol{x})=0.5, \\tilde{m}(\\boldsymbol{x}) \\leq k] \\Bigg[k \\log\\left(\\frac{k}{\\tilde{m}(\\boldsymbol{x})}\\right) + (1-k)\\log\\left(\\frac{1-k}{1-\\tilde{m}(\\boldsymbol{x})}\\right) \\Bigg]$\n$- \\mathbb{1}\\left[ y(\\boldsymbol{x})\\neq 0.5 \\right] \\Bigg[ y(\\boldsymbol{x}) \\log\\left(\\tilde{m}(\\boldsymbol{x})\\right) + (1-y(\\boldsymbol{x})) \\log\\left(1-\\tilde{m}(\\boldsymbol{x})\\right)\\Bigg] \\Bigg)$\n\nThis is achieved by the first term of the objective function, where all counterfactual explanations whose predictions are less than k are penalized. We do not penalize the counterfactuals that have a prediction larger than k, due to the fact that counterfactual generating methods sometimes generate explanations that are well within the decision boundary of the target model due to imperfections. All the ordinary instances (both 0\u2019s and 1\u2019s) are treated in the same way as a normal classifier would do. In particular, the queries that are predicted 0 by the target model $m(\\boldsymbol{x})$ will be treated as ordinary labeled examples. \n\n**On biased datasets and active learning:** We now include results of experiments on biased versions of the Adult Income dataset in Figure 19 in Appendix B.2 page 22. We observe that the proposed attack surpasses the baseline even with the biases present. The proposed attack can be used along with many existing active learning strategies as the attack  does not assume anything on the query generation. We acknowledge that combining active learning methods with exploiting counterfactual explanations for model extraction is an interesting research direction in the limitations section (see page 9)."
                    }
                },
                "number": 4,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission2919/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700178660278,
                "cdate": 1700178660278,
                "tmdate": 1700645328058,
                "mdate": 1700645328058,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "4nklnnnfKu",
                "forum": "ORHuMEwaC8",
                "replyto": "m0qUaO7N9s",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission2919/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission2919/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Response to Reviewer MQ33 (2/2)"
                    },
                    "comment": {
                        "value": "**On Remark 3 (previously Remark 2):** We would like to clarify that Remark 3 (previously Remark 2) is not the main focus of our paper, but a possible extension as we explicitly clarify now. We would only like to point out that the attack can be executed to approximate any contour of constant probability, given that the attacker knows the value for k. This provides some flexibility to mount a model extraction attack on an MLaaS that uses a robust recourse method. In future work, the problem of discovering the value of k in this may be approached in two ways as suggested under \u201cExperimental setup\u201d in Section 4 (page 8): (I) the attacker can tune k based on the cross-validation score achieved on the query set; (II) k can be directly known if the MLaaS provides probabilistic information as considered in [1].\n\n**On the organization of Section 3:** Section 3 of the paper is devoted to three main objectives. First, in Section 3.1, we introduce a novel sample complexity result for a model extraction attack which exploits closest counterfactual explanations. Then, in an effort to relax the conditions in the attack considered under Section 3.1, we state an important observation under Theorem 3 in Section 3.2, along with a novel attack strategy based on this observation. Considering the comments raised by Reviewer MQ33, we have now explicitly indicated this strategy with a topic \u201cProposed attack\u201d. Finally, in Section 3.3, we analyze the query complexity of this attack under conditions similar to Section 3.1.\n\n[1] F. Tram\u00e8r, F. Zhang, A. Juels, M. K. Reiter, and T. Ristenpart, \u201cStealing Machine Learning Models via Prediction APIs,\u201d presented at the 25th USENIX Security Symposium (USENIX Security 16), 2016, pp. 601\u2013618."
                    }
                },
                "number": 5,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission2919/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700178826799,
                "cdate": 1700178826799,
                "tmdate": 1700178826799,
                "mdate": 1700178826799,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "2cwmPMDIvT",
            "forum": "ORHuMEwaC8",
            "replyto": "ORHuMEwaC8",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission2919/Reviewer_vcnE"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission2919/Reviewer_vcnE"
            ],
            "content": {
                "summary": {
                    "value": "This paper studies model reconstruction attacks by using the proximity of counterfactuals to the decision boundary. The authors aim to establish theoretical guarantees for such attacks. To this end, they characterize the number of queries required for the attacker to achieve a given error in model approximation using results from polytope theory (Theorem 2). The authors\u2019 main result from Theorem 2 relies on the decision boundary being convex. To relax the convexity assumption, the paper additionally assumes Lipschitz continuity of the underlying model to provide approximation bounds, which depend on the Lipschitz constant which is typically unknown. \nFinally, the authors propose a strategy for model extraction.\n\nWhile the paper offers some strengths in terms of proposing new tools to analyze model extraction attacks, there are several weaknesses that require improvement, including a limited evaluation and theoretical results that are (mostly) confined to models with convex decision boundaries. Overall, the paper provides a good starting point for future research in the area of model extraction attacks through counterfactual explanations but further improvements are necessary to meaningfully generealize the analysis to general non-linear models."
                },
                "soundness": {
                    "value": "2 fair"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "2 fair"
                },
                "strengths": {
                    "value": "- **New theoretical approach to study extraction attacks**: The paper introduces a fresh approach to studying model extraction attacks using counterfactual explanation algorithms, employing methodologies from polytope theory that I have not seen explored in this context before.\n-  **New method**: The authors propose a new model extraction method.\n- **Clearly structured**: The paper is overall well written and clearly structured."
                },
                "weaknesses": {
                    "value": "**The empirical evaluation is limited**: (1) The paper lacks comparison with more recent model extraction techniques via counterfactual explanations, such as those by Wang et al. (2022). (2) Further, the dependence on dimensionality ($d$) is a critical factor influencing convergence (e.g., see Theorem 2), yet the paper lacks results concerning this aspect in the empirical evaluation of their attack. (3) There is also a disparity between the primary theoretical results (Theorem 2) and the subsequent sections of the paper. (4) I would expect that experimental results verify the validity of Theorem 2. This requires to fit a model with a convex decision boundary and to execute the proposed attack. Finally, (5) the attacks are exclusively conducted using one type of neural network and might not generalize well to other models or other network architectures. For example, it would strenghten the paper's empirical results to explore the suggested method's impact of varying model parameters, etc. on fidelity.\n\n**Confined theoretical results**: (1) The paper does not to adequately reconcile the theoretical analysis with commonly used sparsity-inducing loss functions in standard counterfactual explanation methods. (2) The main (interesting) theoretical results are confined to convex decision boundaries. Hence, the analysis on the number of required queries to reach a given error in fidelity (see Theorem 2) might be substantiialy underestimated."
                },
                "questions": {
                    "value": "- Can the authors provide insights into their attempts to estimate the Lipschitz constant in practical applications? Considering the inherent difficulty in obtaining low Lipschitz constants for neural networks of reasonable size, the practicality of the Lipschitz result may be questionable.\n- How did the authors determine the criteria for retaining explanations when generating multiple explanations using the method from Mothilal et al. (2020)?\n- Can the authors offer empirical verification of Theorem 2 to strengthen its validity?\n- It would be valuable to visualize the convergence rate from Theorem 2 in Figure 9, allowing for an evaluation of whether the empirical predictions for convex boundaries closely align with the empirical behavior for non-convex models."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "6: marginally above the acceptance threshold"
                },
                "confidence": {
                    "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 4,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission2919/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698768091767,
            "cdate": 1698768091767,
            "tmdate": 1699636235450,
            "mdate": 1699636235450,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "G7pJbSvNGc",
                "forum": "ORHuMEwaC8",
                "replyto": "2cwmPMDIvT",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission2919/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission2919/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Response to Reviewer vcnE (1/2)"
                    },
                    "comment": {
                        "value": "We thank Reviewer vcnE for their review and appreciate their acknowledgement of the novelty of our contribution. As Reviewer vcnE points out, our work \u201cintroduces a fresh approach to studying model extraction attacks using counterfactual explanation algorithms, employing methodologies from polytope theory that I have not seen explored in this context before.\u201d \n\n**On empirical verification of Theorem 2:** Based on the comment of Reviewer vcnE, we first include the results of a synthetic experiment that empirically validates Theorem 2 across several choices of dimension $d$ (see Section 4 page 7 and Appendix B.1). For our experiment, we specifically choose a spherical decision boundary which is known to be particularly difficult for polytope approximation [1]. Our experiments demonstrate that for each choice of dimension $d$, the expected approximation error $\\epsilon = 1-\\mathbb{E}[\\text{Fidelity}]$ decays faster than $n^{-2/(d-1)}$ where $n$ is the query size. We demonstrate this using a log-log plot of ln($\\epsilon$) vs ln($n$) (see Figure 7 in Section 4 and Appendix B.1).\n\nWe note that carrying-out the same attack on real data is constrained by the limitation of the counterfactual generation mechanisms that they do not always provide the closest counterfactuals, even if they are configured to do so. We have now discussed this in a limitation section (see page 9):\n\nThis limitation leads us to propose an alternative and more practical attack under Section 3.2 that has guarantees under Lipschitz assumptions. Nonetheless, we find that the number of queries obtained using Theorem 2 is not an underestimation, and is in fact higher compared to the actual number of queries required to achieve a certain fidelity for non-convex, real-world datasets using our alternative attack (see Figure 16 in Appendix B.2).\n\n**On the Lipschitz assumption:** We note that the practical neural networks may have large global Lipschitz constants. However, we first make the observation that our theoretical guarantee (Theorem 3) would also extend to the local Lipschitz continuity, which may be more common as compared to global Lipschitz continuity (added Remark 2 on page 6). In fact, this observation leads to another interesting interpretation of our theoretical results that is generally insightful even for practical neural networks: *the regions of the decision boundary with low local-Lipschitz constant are more easily reconstructed.*\n\nFurthermore, we have now included a new set of experimental results demonstrating the relationship of the attack performance with the Lipschitz constant (see Figure 17 in Appendix B.2 page 21). Following [2], we approximate the Lipschitz constant of a neural network by the product of the spectral norms of the weight matrices. We achieve different Lipschitz constants by controlling the L2-regularization of the layer weights while training the target model. Our approximations were in the range 37 to 713 and are also comparable to the values obtained in other works [2, Figure 4],[3, Figure 1],[4, Table 1]. Therefore, it is evident from the experiments that the proposed attack remains valid for significantly large Lipschitz constants. Our observations follow our theoretical insights, where a greater Lipschitz constant gradually degrades the fidelity for a given number of queries.\n\nOur findings are interesting and significant because they highlight an interesting connection between Lipschitz constant and vulnerability to model extraction. Furthermore, noting that a low Lipschitz constant is an indicator of good generalization of a model and adversarial robustness [2],[3],[4], our findings also point towards a potential tradeoff between good generalization and vulnerability to model extraction attacks, which could be interesting for future research.\n\nWe further clarify that while our theoretical guarantees are in terms of the Lipschitz constant, we are not required to estimate the Lipschitz constant in our actual implementation of the attack. \n\n**On other architectures and counterfactual-generation mechanisms:** We have now included results from a rich set of experiments covering different model architectures and counterfactual generating methods (see Section 4 and Appendix B.2). Particularly, the results cover sparse counterfactuals (using L1-norm as the cost function in the counterfactual generating method) and a comparison of the convergence rate from Theorem 2 with that corresponding to real-world datasets (see Figure 16 in Appendix B.2). In the case of DiCE counterfactual generating mechanism (by Mothilal et al. [5]), we set the diversity factor to 1 and obtain only one counterfactual explanation per query."
                    }
                },
                "number": 2,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission2919/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700176778186,
                "cdate": 1700176778186,
                "tmdate": 1700176778186,
                "mdate": 1700176778186,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "VlWoL25qqB",
                "forum": "ORHuMEwaC8",
                "replyto": "2cwmPMDIvT",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission2919/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission2919/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Response to Reviewer vcnE (2/2)"
                    },
                    "comment": {
                        "value": "**On the comparison to Wang et al. (2022):** We had discussed Wang et al. [6] in our related works and have now further emphasized on their contribution in our updated version. Wang et al. [6] is a significant contribution in the area of model extraction for counterfactuals by introducing a clever strategy of further querying for the counterfactual of the counterfactual. *However, this strategy can only be applied when one is allowed to query for counterfactuals from both the accepted and rejected regions.* Our problem setup deviates from this scenario and only allows for one-sided counterfactuals, i.e., counterfactuals only for the rejected points. This is motivated by the fact that a user who has received a favorable decision no longer requires any additional guidance/justification for the decision. Because of this mismatch in the problem setup, we are unable to perform a fair comparison with Wang et al. [6], and only compare with the original model extraction attack of A\u0457vodji et al. [7] for our one-sided problem setup.\n\n[1] S. Arya, G. D. Da Fonseca, and D. M. Mount, \u201cPolytope Approximation and the Mahler Volume,\u201d in Proceedings of the Twenty-Third Annual ACM-SIAM Symposium on Discrete Algorithms, Society for Industrial and Applied Mathematics, Jan. 2012, pp. 29\u201342.\n\n[2] H. Gouk, E. Frank, B. Pfahringer, and M. J. Cree, \u201cRegularisation of neural networks by enforcing Lipschitz continuity,\u201d Mach Learn, vol. 110, no. 2, pp. 393\u2013416, Feb. 2021.\n\n[3] M. Jordan and A. G. Dimakis, \u201cExactly Computing the Local Lipschitz Constant of ReLU Networks,\u201d in Advances in Neural Information Processing Systems, Curran Associates Inc., 2020, pp. 7344\u20137353.\n\n[4] P. Pauli, A. Koch, J. Berberich, P. Kohler and F. Allg\u00f6wer, \"Training Robust Neural Networks Using Lipschitz Bounds,\" in IEEE Control Systems Letters, vol. 6, pp. 121-126, 2022.\n\n[5] R. K. Mothilal, A. Sharma, and C. Tan, \u201cExplaining machine learning classifiers through diverse counterfactual explanations,\u201d in Proceedings of the 2020 Conference on Fairness, Accountability, and Transparency, in FAT* \u201920. New York, NY, USA: Association for Computing Machinery, Jan. 2020, pp. 607\u2013617.\n\n[6] Y. Wang, H. Qian, and C. Miao, \u201cDualCF: Efficient Model Extraction Attack from Counterfactual Explanations,\u201d in 2022 ACM Conference on Fairness, Accountability, and Transparency, Seoul Republic of Korea: ACM, Jun. 2022, pp. 1318\u20131329.\n\n[7] U. A\u00efvodji, A. Bolot, and S. Gambs, \u201cModel extraction from counterfactual explanations.\u201d arXiv, Sep. 03, 2020."
                    }
                },
                "number": 3,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission2919/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700176990943,
                "cdate": 1700176990943,
                "tmdate": 1700176990943,
                "mdate": 1700176990943,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    }
]