[
    {
        "title": "Towards Robust Out-of-Distribution Generalization Bounds via Sharpness"
    },
    {
        "review": {
            "id": "JStDFBYjZD",
            "forum": "tPEwSYPtAC",
            "replyto": "tPEwSYPtAC",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission5162/Reviewer_b2N6"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission5162/Reviewer_b2N6"
            ],
            "content": {
                "summary": {
                    "value": "This paper gives a tight upper bound of out-of-distribution (OOD) by taking robustness into account and discusses the connection between robustness and sharpness of the loss landscape. The author proves the robust generalization bound by partitioning the sample space and measuring the distributional shift of each sub-group. As to the connection between robustness and sharpness, the author proves a theorem stating that sharper models give a larger upper bound on robustness, which aligns with the intuition that sharper models are more prone to overfitting, which hurts OOD generalization."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "3 good"
                },
                "strengths": {
                    "value": "1. Using the partitioning method to achieve a tighter bound is interesting and also leads to a good result.\n2. The paper is well-written and easy to understand, with clear explanations of key concepts and terminology.\n3. The new distance metric better tolerates distributional shift compared with previous work."
                },
                "weaknesses": {
                    "value": "The assumptions and constraints are a bit hard to meet and also may hurt the generalizability of the results.(See my questions)"
                },
                "questions": {
                    "value": "1. The author can give a clear explanation of \u03b5(S) when describing definition of robustness (Def 2.2).\n2. Have you considered the impact of different hyperparameters on the performance of your method? Can give some deeper discussion on this."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "8: accept, good paper"
                },
                "confidence": {
                    "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 1,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission5162/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698468074934,
            "cdate": 1698468074934,
            "tmdate": 1699636511390,
            "mdate": 1699636511390,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "iXGa0btJqd",
                "forum": "tPEwSYPtAC",
                "replyto": "JStDFBYjZD",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission5162/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission5162/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Thanks for your reviews"
                    },
                    "comment": {
                        "value": "Thank you for the feedback and recognition of our contributions. Below are our responses.\n\n**Q1:The author can give a clear explanation of \u03b5(S) when describing definition of robustness (Def 2.2).**\n\nThanks for the nice suggestion. We have added the description \n> This definition captures the robustness of the model in terms of the input. Within each partitioned set\n$C_i$, the loss difference between any sample z belonging to $C_i$ and training sample $\\boldsymbol{s} \\in C_i$ will be\nupper bounded by a robustness constant $\\epsilon(S)$. Hence, the number of partition $K$ and robustness constant $\\epsilon(S)$ define robustness for learning models.\n\nbelow the Definition 2.2 in Section 2.2. Please refer to the highlighted revision in our new version.\n\n---\n\n**Q2: Have you considered the impact of different hyperparameters on the performance of your method? Can give some deeper discussion on this.**\n\nThanks for your nice suggestion. We conducted an ablation study on the spurious feature synthetic experiment with different numbers of partitions $K$ (Figure 7 in Appendix A.2). The results show that the bounds with partitioning ($K > 1$) can better capture the OOD generalization error changes along the distribution shifts."
                    }
                },
                "number": 4,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission5162/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700559312188,
                "cdate": 1700559312188,
                "tmdate": 1700559312188,
                "mdate": 1700559312188,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "HiGNODjRRi",
            "forum": "tPEwSYPtAC",
            "replyto": "tPEwSYPtAC",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission5162/Reviewer_q8BG"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission5162/Reviewer_q8BG"
            ],
            "content": {
                "summary": {
                    "value": "This paper provides generalization bounds for Out of Distribution Generalization based on the sharpness of the loss function minimum attained. One of the main ideas is to partition the input space according to the suggestion in [1]: it is assumed that the loss function doesn't vary too much inside each \"relevant\" subset of a partition of space (this is loosely related to the flatness of the minima) where \"relevant\" means close to an observed sample. Based on this assumption, the authors are able to bound (in Theorem 3.1)  the error as a sum of: \n\n1 the empirical error in the source domain\n2 the relaxed TV distance between the distributions in the partition considered\n3 The robustness of the algorithm/loss (how much the loss can vary for points in a given partition element close to a sample\n4 some function class capacity term. \n\nThe proof is a straightforward manipulation of the definitions.\n\nThe, corollary 3.2 attempts to show that the limiting behavior of Theorem 3.1 is the same as that of the main result of [1] which relies on the traditional TV distance. \n\nIn the next results, the authors rely on some ideas from [2] as well as brute force calculations to relate the concept of robustness of [1] and this work to that of the flatness of the local minima in the case of a kernel regression problem equivalent to a two layer neural network where only the last layer is trained.  The flatness and the norm of the parameter vectors are then claimed to be related in the case of ridge regression, and synthetic data experiments demonstrate superior OOD performance is associated with stronger genralization. \n\n\n\n\n\n\n\n[1] Robustness and generalization. Huan Xu and Shie Mannor. Machine Learning. 2012.\n\n[2] Henning Petzka, Michael Kamp, Linara Adilova, Cristian Sminchisescu, Mario Boley, \"Relative Flatness and Generalization\", NeurIPS 2021."
                },
                "soundness": {
                    "value": "1 poor"
                },
                "presentation": {
                    "value": "1 poor"
                },
                "contribution": {
                    "value": "3 good"
                },
                "strengths": {
                    "value": "Assuming they are correct, the results are certainly very interesting and promise to be the basis for further research. There is quite a lot of non trivial work in this paper, and many proofs require complicated calculations and take inspiration from a variety of existing work."
                },
                "weaknesses": {
                    "value": "The appendix and many parts of the main paper very severely lack polishing to the extent that communication is difficult. Many of the proofs look more like a first draft than a serious submission. In particular, I can't vouch for the correctness of any results past Theorem 3.1 (which is not 100 percent correct either. In addition to poor language and presentation, the organization of the paper in terms of which assumptions are made is not good. The paper just needs more calm work and rewording: the authors of the appendix appear in a rush. \n\n\nHere are more details: \n\nFirst, although this is a minor point, it is worth mentioning that the constants in Theorem 3.1 don't seem to be fully correct. Indeed, the proof relies on a combination of Lemma 1 and Lemma C.3 from the arXiv version of [1], with both theorems relying on excluding a low probability event. Since combining both results requires a union bound, all the $\\delta$s should be changed to $\\delta/2$, resulting in different constants throughout. The same issued shows up in the proof of Proposition C.5. Note also that the result cited from [1] in Lemma C.3. is not in the published version, but in the arXiv version only. There are no Theorems 2 and 3.2 in the NeurIPS version, THis is Theorem 2 from NeurIPS and Theorem 3.2 from arXiv (\nHowever, the same result can be lifter from [3] instead.) In addition, the combination of both results should be done explicitly since the constants are wrong again due to not applying the union bound. Also, I am really not sure the authors are actually using Theorem 3.2 rather than a simple generalization bound in terms of VC dimension. \n\n\nTheorem 3.4 makes sense as a statement (though I couldn't check the full proof), but is very hard to read and contains plenty of minor errors. Why is $z_i(A)=argmax...$ unique? It seems the authors mean to say that $z_i\\in argmax....$. When defining $\\mathcal{M}_i$ as \"the set of gobal minima in $C_i$\", the authors actually mean that $\\mathcal{M}_i$ as a set is the argmin of the objective function over $C_i$ (in particular, the elements are \"global\" minima inside the partition element $C_i$, but not necessarily global minima for the whole problem). This is absolutely not clearly written. It is also not clear why a different definition style is used for $|mathcal{M}_i$ and for $z-i(A)$ in that case Every statement in this paper is written vaguely using words instead of maths, adding to the burden of trying to make sense of what is attempted here. \n\n\n\n\n\n\n\n==================Minor comments============\n\n\nWhat is Theorem C.2 a restatement of? It seems it is Theorem 3.1 but it is not written (only the title \"restate\"). \n\nThe wording of transitions  is quite sloppy. For instance, in page 14 we have the sentence \"In order to give a fine-grained analysis, we follow the common choice where a two-layer NN function class is widely analysed in most literature, i.e. Neural Tangent Kernel, rich regime, random feature models.\" What do the authors mean by \"rich regime\"? \n\nNote also at the top of page 14, the integral is not properly written as I believe the authors actually meant to write $\\int f(x)g(y) \\tau_d(d(x,y))$ instead of $\\int f(x)g(y) \\tau_d(dx)$  (otherwise the quantity is just equal to 1). \n \n\nThe statement of Corollary 3.2 is not really mathematically well defined. What the authors mean is that the bound from Theorem 3.1 converges to the RHS of equation (3), but what is written is just that the OOD generalization error is bounded by it. The \"proof\" is not very clean either. \n\nThe second sentence of Theorem 3.1 should contain a word such as \"assume that\". \n\nThe description of the case where $K=1$ above corollary 3.2 seems quite dodgy as it implies that the loss is approximately constant in the whole of input space! \n\n\nNote that even the definition of one of the main concepts of this paper, i.e. robustness as in Definition 2.2, is not very well introduced: there \"for all\" which relates to $s,z$ is duplicated, and there is a \"for all i$ after the $forall $s,z\\in C_i$ (which depends on $i$). This makes this much harder to read than necessary. Note that the definition in [1] is much cleaner. It should be copied more faithfully. \n\n\n\n====================Typos====================\n\nThere are plenty of issues with the language, not only in terms of improper use of grammar to an extent that harms understanding, but also in terms of polishing, spelling and punctuation. Below is a highly non exhaustive list. \n\n\nIn the abstract, fourth line \"sharpness of learned minimum influences\" should be \"the sharpness of learned minima influences\" \n\nPage 2: to the left of the figure, \"as shown in \\cite... that when the loss lanscape...\": a coma would be better than \"that\"\n\nEvery theorem which is lifted from a reference involves the text of the name of the authors written twice (once manually and once via the \\cite function). This is probably due to copy and paste from another template with a different citation style without checking through it again. (prop. 2.1, definition 3.3\n\nPage 21, \"under this case\" should be \"in this case\" \n\nEquation (44), there is an equal sign with three bars instead of 2 where I think the authors actually mean equality in the strict sense. \n\nLine 3 of Section 3.1 \" $(K,\\epsilon)$-robust\" should be \"..robustness...\"\n\nIn page 5 (theorem 3.4), there is a \"w.p. a\" which probably should just be \"w.p.\"\n\n\nThere are plenty of \"w.r.t\" and \"i.i.d\" (missing period) throughout the text. \n\n\nIn appendix D, note the use of \"where definition of ....please refer to the corollary 3.5\" \n\nIn page 18 at the beginning of the proof of Lemma D.1, although I agree that equation (29) makes sense, the sentence which introduces it speaks of the smallest eigenvalue whilst the equation itself shows the equivalent statement expressed as an PSD inequality between matrices. \n\nJust below equation (27), it is unclear what the authors mean by saying that \"$\\mathcal{A}_{\\mathcal{F}\\Delta \\mathcal{F}}$ represents the algorithm\" WHat algorithm? \n\n\n====================References===========================\n\n[1] Robustness and generalization. Huan Xu and Shie Mannor. Machine Learning. 2012.\n\n[2] Henning Petzka, Michael Kamp, Linara Adilova, Cristian Sminchisescu, Mario Boley, \"Relative Flatness and Generalization\", NeurIPS 2021. \n\n[3] Learning Bounds for Domain Adaptation. John Blitzer, Koby Crammer, Alex Kulesza, Fernando Pereira, and Jennifer Wortman. NeurIPS 2007"
                },
                "questions": {
                    "value": "Could you write down a proof of  Proposition C.5 clarifying if you are using a standard VC bound or Theorem 3.2 from arxiv [1], and fixing the constants from the union bound? \n\n\nDo you stand by your proof of Lemma D.5? It seems sloppy to the point of being completely incomprehensible, though I believe a similar result probably holds. Is equation (46) an equation or an approximation ? It seems that the probability (LHS) should be equal to $2\\phi/\\pi$ and not involvea $cos$ at all. For equation (47), it seems that you are calculating the bound the wrong way around: equation (47) holds if the inequality is reversed inside the probability statement. In the next substantial revision you upload, could you also include a precise restatement and citation for \"Robbin's bounds\".\n\n\nWhat is going on in Equation (64)? The statement of Theorem 3.4 appears to be agnostic w.r.t. the choice of loss function, but the proof says \"ohh we can verify that this holds for common loss functions such as L1, MSE, MAE etc.'. How do you get the first equality in (64), and does it hold for all loss functions? Please rewrite the proof accordingly. \n\nCould you fix the \"definitions\" in corollary 3.5? When taken at face value, I maintain that $L_{x^*}=0$: there is something missing there. Also, although I guess that $\\hat{w}_min$ is the minimum absolute value of any entry of $\\hat{w}$ this is not clear from the definition since the notation $|\\cdot|$ to mean element wise absolute value is non standard. \n\n\n \nPlease rewrite all the proofs much more carefully and upload a revision. It may help to ask another author to read the proofs."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "5: marginally below the acceptance threshold"
                },
                "confidence": {
                    "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 2,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission5162/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698668785714,
            "cdate": 1698668785714,
            "tmdate": 1699636511257,
            "mdate": 1699636511257,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "pFBXtHp2lu",
                "forum": "tPEwSYPtAC",
                "replyto": "HiGNODjRRi",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission5162/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission5162/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Thanks for your detailed reviews."
                    },
                    "comment": {
                        "value": "Thank you for your valuable feedback and constructive suggestions. We have carefully reviewed and revised the proofs, as well as corrected any typos in the paper. Please find our responses to your comments below:\n\n## Main weaknesses\n\n**W1: The constants in Theorem 3.1 don't seem to be fully correct.**\n\nThank you for your careful review. We have corrected the constant in Theorem 3.1 as well as Proposition C.5. Following your suggestion, we have added the proof of Proposition C.5 and corrected the notions of VC-dimension by pseudo-dimension.\n\n---\n\n**W2: Theorem 3.4 makes sense as a statement, but is very hard to read and contains plenty of minor errors.**\n\nWe carefully reviewed all the proofs. Our revisions for Theorem 3.4 and Corollary 3.5 can be summarized below:\n- We have re-proven the Lemma D.1 by replacing the assumption $L_{x^*}>0$ by $m=Poly(d)$.\n- We have corrected the numbers in Lemma D.5.\n- We refine the definition of $\\mathcal{M}_i$ and $z_i(A)$.\n- Revised the setting and assumptions in Appendix B.\n----\n\n## Minor comments\nFor point 2, the term \"rich regime\" refers to a non-kernel regime in which training overparameterized networks through gradient descent leads to implicit biases that diverge from RKHS norms. We have supplemented this term with a previously omitted reference. For the remaining points, we have conducted the necessary revisions. Please consult our recently updated version for details.\n\n----\n\n**[Typos]**\n\nThank you for your careful review of our manuscript and for taking the time to point out the typographical errors in the original submission. The revised version of the manuscript has been uploaded with corrections highlighted in red.\n\n## Questions\n\n**Q1: Could you write down a proof of Proposition C.5 clarifying if you are using a standard VC bound or Theorem 3.2 from arXiv [1], and fixing the constants from the union bound?**\n\nWe have added proof of Proposition C.5 and corrected the error constant.\n\n---\n\n**Q2: Lemma D.5**\n\nWe have thoroughly revised the proof.\n\n---\n\n**Q3: What is going on in Equation (64)?**\n\nWe derived the first inequality by the chain rule. We made the choice of loss functions explicitly in Appendix B.1, please refer to the changes.\n\n---\n\n**Q4: Could you fix the \"definitions\" in corollary 3.5?**\n\nWe have refined our statement and introduced a supplementary assumption to Corollary 3.5, stipulating that the model size ($m$) is considerably greater than the data dimension ($d$). This new assumption is widely used in overparameterized regimes within which we have re-proven Lemma D.1. Revised Lemma D.1 has allowed us to present more precise and refined results for Corollary 3.5 in the revised version of our paper.\n\n----\n\nOverall, we do appreciate your recognition of our novelty as well as for providing thorough and thoughtful reviews that improve the rigor of our manuscript. In response to your insightful comments and constructive feedback, we have revised the proofs thoroughly. We are grateful for the opportunity to improve our manuscript with your guidance."
                    }
                },
                "number": 3,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission5162/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700559262940,
                "cdate": 1700559262940,
                "tmdate": 1700559262940,
                "mdate": 1700559262940,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "dK30DSxQid",
            "forum": "tPEwSYPtAC",
            "replyto": "tPEwSYPtAC",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission5162/Reviewer_m8jH"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission5162/Reviewer_m8jH"
            ],
            "content": {
                "summary": {
                    "value": "The authors introduce an out-of-distribution (OOD) generalization bound based on Sharpness that incorporates robustness, leading to a more precise bound compared to non-robust guarantees. The given results are validated through experiments conducted on both a ridge regression model and some deep learning classification tasks."
                },
                "soundness": {
                    "value": "2 fair"
                },
                "presentation": {
                    "value": "2 fair"
                },
                "contribution": {
                    "value": "2 fair"
                },
                "strengths": {
                    "value": "-\tThe given bound seem to be tighter than existing non-robust guarantees.\n-\tThe experiments are well conducted on ridge regression and simple classification tasks using MLP."
                },
                "weaknesses": {
                    "value": "-\tThe datasets being used are overly simplistic, making it difficult to ensure the validity of theoretical outcomes. Empirical evidence from [1], [2], [3], [4], [5] demonstrate that sharpness is limited in the context of small datasets like CIFA10 or SVHN. Comprehensive evaluations involving transformers, ConvNet, CLIP, and BERT  trained on larger datasets such as ImageNet and MNLI reveal a weak correlation between sharpness and generalization. Surprisingly, a consistent negative correlation between sharpness and out-of-distribution (OOD) generalization suggests that sharper minima might actually generalize better, contradicting the authors' proposed theory. Moreover, experiments in [6] indicate that the choice of sharpness definition heavily depends on the specific dataset. To substantiate their theoretical claims, it is essential for the authors to conduct more extensive experiments on larger and more intricate datasets using complex models.\n\n-\tNumerous studies propose that flatter minima might offer better generalization for both standard and out-of-distribution (OOD) data such as [7] and [8]. However, traditional sharpness definitions often fall short in capturing generalization accurately, potentially because they are not consistent under reparametrizations that do not change the model itself. To tackle these issues, Adaptive Sharpness and reparametrization-invariant sharpness have been developed. I anticipate seeing the theoretical results related to Adaptive Sharpness and reparametrization-invariant sharpness.\n\n[1] Kwon, J., Kim, J., Park, H., and Choi, I. K. Asam: Adaptive sharpness-aware minimization for scale-invariant learning of deep neural networks. ICML, 2021.\n[2] Keskar, N. S., Mudigere, D., Nocedal, J., Smelyanskiy, M., and Tang, P. T. P. On large-batch training for deep learning: Generalization gap and sharp minima. ICLR, 2016.\n[3] Jiang, Y., Neyshabur, B., Mobahi, H., Krishnan, D., and Bengio, S. Fantastic generalization measures and where to find them. ICLR, 2020.\n[4] Dziugaite, G. K. and Roy, D. Entropy-sgd optimizes the prior of a pac-bayes bound: Generalization properties of entropy-sgd and data-dependent priors. In ICML, pp. 1377\u20131386. PMLR, 2018.\n[5] Bisla, D., Wang, J., and Choromanska, A. Low-pass filtering sgd for recovering flat optima in the deep learning optimization landscape. AISTATS, 2022.\n[6] Andriushchenko, Maksym, et al. \"A modern look at the relationship between sharpness and generalization.\" arXiv preprint arXiv:2302.07011 (2023).\n[7] Xing, C., Arpit, D., Tsirigotis, C., and Bengio, Y. A walk with sgd. arXiv preprint arXiv:1802.08770, 2018.\n[8] Zhou, P., Feng, J., Ma, C., Xiong, C., Hoi, S. C. H., et al. Towards theoretically understanding why SGD generalizes better than Adam in deep learning. NeurIPS, 2020."
                },
                "questions": {
                    "value": "Furthermore, transfer learning has become the standard choice for vision and language tasks. However, there is limited understanding of sharpness in this context. Do the theoretical results still apply to transfer learning scenarios?"
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "3: reject, not good enough"
                },
                "confidence": {
                    "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 3,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission5162/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698717750956,
            "cdate": 1698717750956,
            "tmdate": 1699636511139,
            "mdate": 1699636511139,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "vvnQo7CXr0",
                "forum": "tPEwSYPtAC",
                "replyto": "dK30DSxQid",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission5162/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission5162/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Thank you for your reviews"
                    },
                    "comment": {
                        "value": "Thank you for the feedback and suggestions. Below are our responses.\n\n**Q1: Empirical evidence from existing work demonstrates that sharpness is limited in the context of small datasets like CIFA10 or SVHN**\n\n[1] has demonstrated that Stochastic Weight Averaging towards flat minima can improve OOD generalization on five standard DG benchmarks, namely PACS, VLCS, OfficeHome, TerraIncognita, and DomainNet. In addition, we have observed a **consistent phenomenon on larger-scale datasets** such as PACS, and WILDS-Camelyon17. Please refer to Figure 5,6 in Appendix A in our revision.\n\n-------\n\n**Q2: [3] shows a negative correlation between sharpness and out-of-distribution (OOD) generalization suggesting that sharper minima might actually generalize better, contradicting the authors' proposed theory.**\n\nThe distinction in the definition of sharpness can lead to disparate observations and interpretations. It is crucial to note that our measure (Definition 3.3) is different from the one presented in [3] where its sharpness is defined by \n$$S_{avg}^\\rho(w, c):=  E_{S \\sim P_m, \\delta \\sim(0, \\rho^2 \\text{diag}(c^2)} L_{S}(w+\\delta)-L_{S}(w) ~~~~(1)$$\nwhich captures the loss changes within a neighbor area. In contrast, our sharpness (following [4]) integrates the norm of weights and the trace of the Hessian matrix for each layer:\n$$\\kappa(w, S, A):= \\langle w, w \\rangle \\text{tr}(H_{S, A}(w)). ~~~(2)$$\nOur theoretical results derived the dependence of sharpness and robustness upon Eqn(2). Both experiments in [1] and our paper have validated the positive correlation between flatness and OOD generalization.\n\n-------\n\n**Q3: It is essential for the authors to conduct more extensive experiments on larger and more intricate datasets using complex models.**\n\nThanks for the nice suggestion. To better evaluate the correlation between our sharpness and Out-Of-Distribution (OOD) generalization, we conducted additional experiments on PACS with ResNet50, and on Wilds-Camelyon17 with DenseNet121 according to your suggestion (Figure 5 Appendix A in our revision). \n\n-------\n\n**Q4: I anticipate seeing the theoretical results related to Adaptive Sharpness and reparametrization-invariant sharpness.**\n\nWe have adopted the \"relative sharpness\" defined in [4] to account for **reparameterization-invariant sharpness** that alters certain flatness measures while leaving generalization unaffected. Moreover, [4] has established the rigorous link between sharpness and generalization. Works on adaptive sharpness such as ASAM [2] and [3] examine reparametrization-invariant sharpness from a different perspective. The differences we have shown in Q2.\n\n-------\n\n**Q5: Do the theoretical results still apply to transfer learning scenarios?**\n\nYes, we believe our results are applicable to transfer learning contexts, specifically domain adaptation. The framework of our bound is commonly shared in domain adaptation [5].\n\n-------\n\n**References**\n\n[1] Cha, Junbum, et al. \"Swad: Domain generalization by seeking flat minima.\" Advances in Neural Information Processing Systems 34 (2021): 22405-22418\n\n[2] Kwon, Jungmin, et al. \"Asam: Adaptive sharpness-aware minimization for scale-invariant learning of deep neural networks.\" International Conference on Machine Learning. PMLR, 2021.\n\n[3] Andriushchenko, Maksym, et al. \"A modern look at the relationship between sharpness and generalization.\" \n\n[4] Petzka, Henning, et al. \"Relative flatness and generalization.\" Advances in neural information processing systems 34 (2021): 18420-18432.\n\n[5] Redko, I., Morvant, E., Habrard, A., Sebban, M., & Bennani, Y. (2020). A survey on domain adaptation theory: learning bounds and theoretical guarantees. arXiv preprint arXiv:2004.11829."
                    }
                },
                "number": 2,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission5162/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700559253709,
                "cdate": 1700559253709,
                "tmdate": 1700559253709,
                "mdate": 1700559253709,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "zYkEL0UV6q",
            "forum": "tPEwSYPtAC",
            "replyto": "tPEwSYPtAC",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission5162/Reviewer_2MLh"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission5162/Reviewer_2MLh"
            ],
            "content": {
                "summary": {
                    "value": "This paper studies the relationship between robustness and sharpness in improving OOD generalization performance. The authors provided rigorous theoretical analyses through the PAC learning framework to give an intuitive insight into why minimizing sharpness can lead to better OOD performance. This paper is the first work to reveal the benefits of flatness to OOD generalization. Moreover, based on existing theoretical results, a titer error bound is proposed. Empirically, the authors choose two simple datasets RotateMNIST and a self-generated dataset to validate the findings of their theory. This is a pure theoretical paper which is a solid contribution to related fields."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "2 fair"
                },
                "strengths": {
                    "value": "- The theoretical derivation is rigorously demonstrated. It is solid work by providing support for encouraging flat minima on OOD generalization problems.\n- All the results are very intuitive and confirm many assumptions of my own.\n- This paper is well-written and easy to follow."
                },
                "weaknesses": {
                    "value": "- Why conducting partition on all training data is still not clear to me. It is reasonable that a small distribution shift in the same sub-group could lead to noise and should be ignored. But how such a strategy is formulated is unknown. Besides, could it be possible to conduct an ablation study to justify that such kind of partition is indeed helpful for OOD generalization?\n- The results in Figure 4 are interesting. However, some intuitive explanations are missing. For example, why did the test error of the worst-case group first decrease along the correlation probability and then increase?\n- It would be much more helpful if the authors could provide the experimental results on larger datasets such as DomainBed and WILDS. I understand theoretical papers could still have gaps in realistic application, but it would be helpful for us to find problems and look for possible directions."
                },
                "questions": {
                    "value": "Please see the weaknesses for detials."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "details_of_ethics_concerns": {
                    "value": "No ethics review needed."
                },
                "rating": {
                    "value": "8: accept, good paper"
                },
                "confidence": {
                    "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                },
                "first_time_reviewer": {
                    "readers": [
                        "ICLR.cc/2024/Conference/Program_Chairs",
                        "ICLR.cc/2024/Conference/Submission5162/Senior_Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission5162/Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission5162/Reviewer_2MLh"
                    ]
                }
            },
            "number": 4,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission5162/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1699085631308,
            "cdate": 1699085631308,
            "tmdate": 1700667208507,
            "mdate": 1700667208507,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "CpKtUdPn6n",
                "forum": "tPEwSYPtAC",
                "replyto": "zYkEL0UV6q",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission5162/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission5162/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Thank you for your reviews."
                    },
                    "comment": {
                        "value": "Thank you for the feedback and suggestions. Below are our responses.\n\n**W1-(a): Why conducting partition on all training data is still not clear to me.**\n\nAccording to the original definition in [1], the (whole) sample space $\\mathcal{Z}$ is partitioned into $K$ disjoint sets, not just on training data such that all unknown samples from OOD may fall into the same set as the training data. An example of formulation can be found in Example 1 in [1] where \n\n> Example 1 Fix $\\gamma>0$ and put $K=2 N (\\gamma / 2, X, ||\\cdot||_2 )$. If $\\mathcal{A}s$ has a margin $\\gamma$, then $\\mathcal{Z}$ can be partitioned into $K$ disjoint sets,  such that if $s_j$ and $z \\in \\mathcal{Z}$ belong to a same $C_i$, then $|l(\\mathcal{A}s, s_j)-l(\\mathcal{A}s, z)|=0$.\n\nThis example suggests that according to the covering number, sample space $X$ can be partitioned into $N (\\gamma / 2, X, ||\\cdot||_2 )$ subsets such that each subset has a diameter less or equal to $\\gamma$.\n\n\n**W1-(b): Could it be possible to conduct an ablation study to justify that such kind of partition is indeed helpful for OOD generalization?**\n\nYes, we conducted an ablation study on the spurious feature synthetic experiment with different numbers of partitions $K$ (Figure 7 in Appendix A.2). The results show that the bounds with partitioning ($K > 1$) can better capture the OOD generalization error changes along the distribution shifts.\n\n----\n\n**W2: The results in Figure 4 are interesting. However, some intuitive explanations are missing.**\n\nThanks for the nice suggestions, we added the following intuitive explanation on Page 9. Please refer to our highlighted revision.\n\n> As shown in Figure 4(d), when $p_{\\text{maj}} = 0.5$, there is no distributional shift between training and test data due to no spurious features correlated to training data. Thus, the training and test distributions align closer and closer when $p_{\\text{maj}}<0.5$ and increase, resulting in an initial decrease in the test error for the worst-case group.\nHowever, as $p_{\\text{maj}} > 0.5$ and deviates from 0.5, introducing the spurious features, a shift in the distribution occurs. This deviation is likely to impact the worst-case group differently, leading to an increase in the test error.\n\n----\n\n**W3: Experimental results on larger datasets such as DomainBed and WILDS.**\n\nWe have added the new experimental results on PACS and WILDS-Camelyon17. To extend the sharpness measure to complicated architectures, such as DenseNet-121, we compute the Hessian matrix from the last FC layer. Even though, the result is still consistent with what we report in Figure 3. The phenomenon that **sharper minima can lead to poor OOD generalization performance** can also be observed on large-scale datasets.\n\n---\n\n**References**\n\n[1] Xu, H., & Mannor, S. (2012). Robustness and generalization. Machine learning, 86, 391-423."
                    }
                },
                "number": 1,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission5162/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700559231923,
                "cdate": 1700559231923,
                "tmdate": 1700559231923,
                "mdate": 1700559231923,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "IVa4ozJ2nr",
                "forum": "tPEwSYPtAC",
                "replyto": "zYkEL0UV6q",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission5162/Reviewer_2MLh"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission5162/Reviewer_2MLh"
                ],
                "content": {
                    "title": {
                        "value": "Thanks for your reply"
                    },
                    "comment": {
                        "value": "The authors have carefully answered my questions. Additional experiments are also added to show its empirical effectiveness. I think this paper shows some insight into OOD generalization. The theoretical analyses are extensive. Therefore, I would like to raise my score to 8, but my confidence remains at 3."
                    }
                },
                "number": 5,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission5162/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700667164662,
                "cdate": 1700667164662,
                "tmdate": 1700667224539,
                "mdate": 1700667224539,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    }
]