[
    {
        "title": "Stoichiometry Representation Learning with Polymorphic Crystal Structures"
    },
    {
        "review": {
            "id": "1DjbUwDiWr",
            "forum": "yuGqe96t9O",
            "replyto": "yuGqe96t9O",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission4333/Reviewer_jsDD"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission4333/Reviewer_jsDD"
            ],
            "content": {
                "summary": {
                    "value": "This paper proposes PolySRL, which is a combination of previous self-supervise learning technics, to the task of crystal property preidction using structural and compositional information during training and only compositional information during inference. They show that instead of using deterministic way to obtain representations from crystal compositional information, it is better to use a distribution and a sampling process, due to the one-to-many nature between compositional information and structures."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "2 fair"
                },
                "strengths": {
                    "value": "- The first work to discuss using self supervise learning technics for crystal property prediction tasks without structural information.\n- Clear writing, with informative figures and extensive experiments"
                },
                "weaknesses": {
                    "value": "- The novelty is limited, due to the fact that the proposed pipeline is a combination of previous technics.\n- Improvements beyond baselines without structural information during training is not significant but in the near range. The errors are not very small and I'm a little concerned how practically useful the predictions will be.\n- The global idea of predicting properties based on crystal compositional information is a little bit tricky, due to that crystal properties are largely determined by the structure. As you mentioned in your figure 1, diamond and graphite have totally different properties.\n\n**I have viewed the rebuttals from authors.**"
                },
                "questions": {
                    "value": "As I mentioned in the weaknesses."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "5: marginally below the acceptance threshold"
                },
                "confidence": {
                    "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                },
                "first_time_reviewer": {
                    "readers": [
                        "ICLR.cc/2024/Conference/Program_Chairs",
                        "ICLR.cc/2024/Conference/Submission4333/Senior_Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission4333/Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission4333/Reviewer_jsDD"
                    ]
                }
            },
            "number": 1,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission4333/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698437099855,
            "cdate": 1698437099855,
            "tmdate": 1700611232943,
            "mdate": 1700611232943,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "8zcQeqQZkc",
                "forum": "yuGqe96t9O",
                "replyto": "1DjbUwDiWr",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission4333/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission4333/Authors"
                ],
                "content": {
                    "comment": {
                        "value": "Thank you for recognizing that our work is pioneering work for crystal property prediction tasks without structural information! We are more than willing to clarify the reviewer\u2019s concerns one by one.\n\n**W1. Limited Novelty.**\n\nAs the reviewer pointed out, this paper is the first work that utilizes self-supervised learning to learn the representation of stoichiometry for various downstream tasks. While techniques in our paper are highly inspired by previous works, we believe that our contributions come from 1) identifying a novel and important problem, 2) suggesting a suitable method for the problem, and 3) providing insightful results that can progress the field with the method.\n\n**Novelty and Importance of the Problem.**\nRecently, the majority of machine learning (ML) models in materials science are built on top of the crystal structure that are computed based Density functional Theory (DFT). However, in real-world wet lab experiments, it is common situation where we only have compositional information (i.e., stoichiometry) without structural information as also mentioned by [reviewer rRHK](https://openreview.net/forum?id=yuGqe96t9O&noteId=B4csbUBOsR), due to the atomic-level rearrangement of the materials during the materials synthesis process (We have provided a more detailed explanation on this situation by addressing [W3](https://openreview.net/forum?id=yuGqe96t9O&noteId=efaOs4V5j0) in the following) [1, 2]. This missing structural information complicates the application of such structure-based ML models in the real-world materials discovery process. Therefore, one promising avenue for enhancing the practicality of ML in materials discovery lies in the prediction of materials property without structural information, i.e. relying solely on stoichiometry. However, as the reviewer mentioned in [W3](https://openreview.net/forum?id=yuGqe96t9O&noteId=efaOs4V5j0), it is also widely known that crystal structure heavily determines the properties of the materials. \n\n\n**Suitability of the Method.**\nAs a solution, we proposed PolySRL, which distills the knowledge of DFT-calculated structure into the stoichiometry encoders during the pre-training stage, and fine-tune or evaluate the model solely on stoichiometry. One straightforward approach would be contrasting the object with its 3D representation, which has shown promising results in organic molecules [3, 4]. However, our extensive experiments reveal that these methods do not adequately capture the complexities of inorganic materials, such as polymorphism. To this end, we propose to learn a probabilistic representation that can learn not only the appropriate representation of stoichiometry but uncertainty induced by polymorphism.\n\n**Insightful Results.** Thanks to the suitability of methods for the task, we could make several insightful observations from experimental results. Briefly, uncertainty provided by models contains the information of stoichiometry regarding 1) a number of polymorphic structures, 2) computational challenges in calculating the accurate structure, and 3) similarity between polymorphic structures, all of which are common interest in materials science.\n\nIn conclusion, we fully agree with the reviewer that innovations in algorithms are crucial for the field's advancement. Concurrently, we also argue that a comprehensive investigation beyond novel algorithms, such as providing novel problems and insightful results, is also essential for advancing the field. Hence, we believe that PolySRL has contributed to the field's development by introducing problems that are more relevant to real-world applications, as well as by delivering meaningful results that have been long common interest in materials science.\n\n[1] Predicting the band gaps of inorganic solids by machine learning, The journal of physical chemistry letters 2018.\n\n[2] Predicting materials properties without crystal structure: Deep representation learning from stoichiometry, Nature communications 2020.\n\n[3] 3d infomax improves gnns for molecular property prediction, ICML 2022.\n\n[4] Pre-training molecular graph representation with 3d geometry, ICLR 2023."
                    }
                },
                "number": 9,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission4333/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1699928352956,
                "cdate": 1699928352956,
                "tmdate": 1699930154803,
                "mdate": 1699930154803,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "41XFxb1cnm",
                "forum": "yuGqe96t9O",
                "replyto": "1DjbUwDiWr",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission4333/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission4333/Authors"
                ],
                "content": {
                    "comment": {
                        "value": "**W2-1. Statistically significant improvement.**\n\nTo exhibit the statistical significance of the enhancement, we conducted a paired t-test within the representation learning scenario for each dataset. To do so, we additionally conducted 5 separate instances of 5-fold cross-validation, with each instance featuring entirely distinct data splits (amounting to a total of 25 individual runs), and then comparing the means from each set of cross-validation results. The resulting numbers in table represent the p-values from the paired t-tests conducted with PolySRL under the following hypotheses:\n\n$H_0 : \\mu_{PolySRL} = \\mu_{Baseline}$\n\n$H_1 : \\mu_{PolySRL} > \\mu_{Baseline}$\n\n|             | Band G.  | Form. E. | Metallic | E.C. (300K) | T.C. (300K) | Seebeck (300K) | E.C. (600K) | T.C. (600K) | Seebeck (600K) |\n|-------------|----------|----------|----------|-------------|-------------|----------------|-------------|-------------|----------------|\n| GraphCL     | 3.80E-04 | 4.18E-03 | 7.63E-03 | 3.12E-03    | 4.29E-04    | 2.38E-03       | 6.72E-04    | 1.39E-02    | 4.07E-02       |\n| MP Band G.  | 2.48E-01 | 1.20E-04 | 6.53E-04 | 4.48E-04    | 2.15E-04    | 4.55E-04       | 5.90E-04    | 1.47E-03    | 1.40E-03       |\n| MP Form. E. | 5.14E-02 | 9.23E-01 | 1.89E-02 | 3.93E-04    | 1.75E-03    | 5.03E-03       | 1.47E-03    | 3.23E-03    | 4.30E-02       |\n| 3D Infomax  | 1.21E-03 | 1.40E-03 | 3.42E-02 | 1.44E-02    | 2.72E-02    | 8.39E-04       | 6.06E-03    | 3.89E-02    | 5.64E-02       |\n\nWe have the following observations: \n1) PolySRL achieves statistically significant improvements over baseline methods that do not leverage structural information (such as GraphCL, MP Band G., MP Form. E.) at the 0.05 significance level except for Band G. and Form. E. datasets. \n2) On the other hand, in the datasets for Band G. and Form. E., PolySRL does not achieve statistical significance compared to models that benefit from the corresponding DFT-calculated values. For example, in Band G. dataset, we observe that the model trained with DFT-calculated band gap (i.e., MP Band G.) outperforms PolySRL, which was also described in observation 3 in Section 5.2. in the main paper. However, as discussed in the main text, these models are specifically tailored for particular properties, which may limit their broader applicability across a range of tasks.\n\n**W2-2. Practical usage of PolySRL.**\n\nMoreover, in terms of practical application, a further appeal of our model lies in its provision of uncertainty metrics. The quantification of uncertainties in model predictions is a critical factor when considering the deployment of machine learning in real-world scenarios, particularly for virtual screening in the scientific discovery process [1, 2]. Furthermore, comprehensive experiments on uncertainty presented in Section 5 show that the uncertainties produced by PolySRL are in consistent agreement with the established domain knowledge in materials science. Consequently, we argue that our model possesses several qualities that render it highly beneficial for practical use in the field.\n\n[1] Machine learning framework for enhanced molecular screening. Chemical science 2021.\n\n[2] Accelerating high-throughput virtual screening through molecular pool-based active learning. Chemical science 2021."
                    }
                },
                "number": 10,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission4333/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1699928383075,
                "cdate": 1699928383075,
                "tmdate": 1699928383075,
                "mdate": 1699928383075,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "efaOs4V5j0",
                "forum": "yuGqe96t9O",
                "replyto": "1DjbUwDiWr",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission4333/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission4333/Authors"
                ],
                "content": {
                    "comment": {
                        "value": "**W3. The global idea of predicting properties solely based on compositional information is tricky.**\n\nFirst of all, we appreciate the reviewer for raising an important discussion point! We fully understand the reviewer's comment that this topic is tricky, since most machine learning methods rely on structural data of crystalline materials. To further clarify the paper's contributions, we have added this topic to the discussion section in **Appendix H**.\n\nAs the reviewer mentioned, crystal property is highly determined by the structural information of the crystal. Most of the machine learning approaches for crystal property prediction utilize crystal structure information as an input, which is obtained through Density Functional Theory (DFT) calculations. However, most of the real-world wet lab experimental scenarios lack suitable structural information on the crystal due to the uncertainty of atomic arrangements [1, 2].\n\nMore specifically, during the synthesis process of materials, atomic-level rearrangement of the material occurs through the mixing of raw materials, heat treatment, and solvent reactions. Therefore, even if the crystal structure of the raw material is known, the synthesized material may have a new crystal structure due to thermodynamic uncertainty introduced by the synthesis operation, making it impossible to determine the crystal structure precisely.\n\nVarious chemical analysis techniques, such as X-ray diffraction (XRD) [3], have been developed to identify the crystal structure of synthesized materials, but due to cost and limitations in analytical accuracy, the crystal structure of synthesized materials is not typically the focus of analysis in actual chemical experiments.\n\nIn conclusion, a lack of knowledge about the crystal structure is a typical scenario in real-world wet laboratory experiments. Consequently, we argue that predicting properties using only compositional information aligns more closely with practical applications in the real-world material discovery process.\n\n[1] Predicting the band gaps of inorganic solids by machine learning, The journal of physical chemistry letters 2018.\n\n[2] Predicting materials properties without crystal structure: Deep representation learning from stoichiometry, Nature communications 2020.\n\n[3] X-ray diffraction (XRD) techniques for materials characterization, Materials characterization using nondestructive evaluation (NDE) methods 2016.\n\n**Final Remark.**\n\nAgain, thank you for recognizing our work is pioneering work for crystal property prediction tasks without structural information! We apologize for any confusion or ambiguity present in the initial submission. We hope our response has clarified the contents of the paper, and we are more than willing to engage in further discussion regarding any aspects that remain unclear."
                    }
                },
                "number": 11,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission4333/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1699928415475,
                "cdate": 1699928415475,
                "tmdate": 1699928894588,
                "mdate": 1699928894588,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "IAybhbGETI",
                "forum": "yuGqe96t9O",
                "replyto": "1DjbUwDiWr",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission4333/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission4333/Authors"
                ],
                "content": {
                    "comment": {
                        "value": "We kindly ask the reviewer to consider our response that addresses the issues regarding the limited technical novelty and practicality. Should the reviewer have any more concerns, we encourage them to raise these with us. We are more than willing to address any additional questions or concerns the reviewer might have."
                    }
                },
                "number": 20,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission4333/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700607014828,
                "cdate": 1700607014828,
                "tmdate": 1700607014828,
                "mdate": 1700607014828,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "DgkRNbETrh",
            "forum": "yuGqe96t9O",
            "replyto": "yuGqe96t9O",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission4333/Reviewer_sAC5"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission4333/Reviewer_sAC5"
            ],
            "content": {
                "summary": {
                    "value": "The paper attempted to generate a probabilistic representation of stoichiometry from structural information of crystalline materials."
                },
                "soundness": {
                    "value": "2 fair"
                },
                "presentation": {
                    "value": "2 fair"
                },
                "contribution": {
                    "value": "1 poor"
                },
                "strengths": {
                    "value": "The authors should be highly praised for studying important real objects such as solid crystalline materials. \n\nThe paper is generally well-written and contains enough details that helped understand the difficulties."
                },
                "weaknesses": {
                    "value": "The keyword \"stoichiometry\" was not explained but the authors likely meant the chemical composition of a given material, more exactly ratios of weights of involved elements.\n\nThe question \u201cIs it possible for stoichiometry-based models to also capture the structural information of crystals?\u201d has the trivial answer \"no\". Both diamond and graphite in Fig. 1c only a few lines before the question consist of pure carbon but have different crystal structures and vastly different properties, which is known even to school students.\n\nAtomic types were used as easy attributes in almost all past representations, especially for property prediction. Hence there is no need to separately talk about stoichiometry.\n\nThe word \"problem\" appears once (in the quote below), though a writing a rigorous problem statement might have helped the authors to understand the unresolved challenges. \n\nQuote: \"it is still an open problem to construct appropriate descriptions of materials, there is a general agreement on effective descriptors that encompass the following principles \"Descriptors should 1) preserve the similarity or difference between two data points (preservativity), 2) be applicable to the entire materials domain of interest (versatility), and 3) be computationally more feasible to generate compared to computing the target property itself (computability)\". \n \nComment. If the problem is to find a complete invariant description of a periodic crystal, crystallographers solved this problem nearly 100 years ago by using Niggli's reduced cell of a lattice and then recording all atoms in so-called standard settings, see the book \"TYPIX standardized data and crystal chemical characterization of inorganic structure types\" by Parth\u00e9 et al, which applies to all periodic crystals, not only inorganic. \n\nHowever, all these standardizations have become obsolete in the new world of big and noisy data because the underlying lattice (not even a unit cell) of any periodic crystal is discontinuous under almost any perturbation, which is obvious already in dimension 1.\n\nFor example, the set Z of all integers is nearly identical to a periodic sequence with points 0, 1+ep_1, ..., m+ep_m in the unit cell [0,m+1] for any small ep_1,...,ep_m close to 0, though their minimal periods (or unit cells) 1 and m+1 are arbitrarily different. \n\nThis discontinuity was reported for experimental crystals already in 1965, see Lawton SL, Jacobson RA. The reduced cell and its crystallographic applications. Ames Lab., Iowa State Univ. of Science and Tech.\n\nA more recent example from Materials Project shows two nearly identical crystals whose unit cells differ by a factor of (approximately) 2\nhttps://next-gen.materialsproject.org/materials/mp-568619\nhttps://next-gen.materialsproject.org/materials/mp-568656\n\nMoreover, atoms in any material always vibrate above absolute zero temperature, so their positions continuously change. As a result, any crystal structure with fixed atomic coordinates in a database is only a single snapshot of a potentially dynamic object, especially for proteins whose structures are often determined often by crystallization. \n\nHence the new essential requirement for any (better than the past) representations of crystals is a proved continuity under perturbations of atoms. \n\nAny graph representation of a crystal or a molecule is discontinuous because all chemical bonds are only abstract representations of inter-atomic interactions and depend on numerous thresholds on distances and angles, while atomic nuclei are real physical objects.\n\nQuote: \"we propose a novel multi-modal representation learning framework for stoichiometry that incorporates readily available crystal structural information\"\n\nComment. If the problem was to determine stoichometry only from a crystal structure, this problem was resolved by the Crystal Isometry Principle, which (briefly) says that any real periodic crystal (with all atomic types, hence stoichometry) is uniquely determined (without any uncertainty) by the geometric structure of atoms (without chemical elements). \n\nSee Widdowson et al (NeurIPS 2022) for theoretical proofs and 200+ billion comparisons on the world's largest collection of materials (the Cambridge Structural Database). The underlying invariants have a near-linear time in the motif size and were used for property predictions by Ropers et all (DAMDID 2022) and by Balasingham et al (arxiv:2212.11246). \n\nSince atomic coordinates have continuous real values, the space of materials is continuously infinite. Hence any sixteen (16 million or any large number of) finite datasets cover an infinitely tiny subspace of measure 0 in the full representation space."
                },
                "questions": {
                    "value": "What are the reasons to invent a new word such as \"preservativity\" in the first introductory paragraph without giving a definition, while the concepts of invariants (https://en.wikipedia.org/wiki/Invariant_(mathematics)), metric (https://en.wikipedia.org/wiki/Metric_space) and continuity (https://en.wikipedia.org/wiki/Continuous_function) have been used for centuries? \n\nOn what probabilistic space is the random variable below defined?\n\nQuote: \"we propose Polymorphic Stoichiometry Representation Learning (PolySRL), which\naims to learn the representation of stoichiometry as a random variable of polymorphs instead of a single deterministic representation\"\n\nQuote: \"assuming that polymorphs with an identical stoichiometry follow the same Gaussian distribution, PolySRL models each stoichiometry as a parameterized Gaussian distribution\"\n\nIs it a realistic assumption that all existing polymorphs of any fixed stoichiometry can be synthesized with probability proportional to a Gaussian distribution? Could you please specify this distribution in the case of pure carbon, including diamond and graphite? \n\nHow many CPU hours and hidden parameters were used in the experiments of section 5?\n\nDid the authors know about the classical results in crystallography cited above, starting from Niggli (1927), Lawton (1965), and Parthe (1987)?"
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "3: reject, not good enough"
                },
                "confidence": {
                    "value": "5: You are absolutely certain about your assessment. You are very familiar with the related work and checked the math/other details carefully."
                },
                "code_of_conduct": {
                    "value": "Yes"
                },
                "first_time_reviewer": {
                    "value": "Yes",
                    "readers": [
                        "ICLR.cc/2024/Conference/Program_Chairs",
                        "ICLR.cc/2024/Conference/Submission4333/Senior_Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission4333/Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission4333/Reviewer_sAC5"
                    ]
                }
            },
            "number": 2,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission4333/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698708264006,
            "cdate": 1698708264006,
            "tmdate": 1699636403491,
            "mdate": 1699636403491,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "rhMFmuE7bA",
                "forum": "yuGqe96t9O",
                "replyto": "DgkRNbETrh",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission4333/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission4333/Authors"
                ],
                "content": {
                    "comment": {
                        "value": "Thank you for recognizing the importance of the problem! We are more than willing to clarify the reviewer\u2019s concerns one by one.\n\n**W1. Stoichiometry was not explained.**\n\nWe thank the reviewer for the suggestion that can definitely improve the presentation of our paper! Although we have provided the definition of stoichiometry in the footnote of the first page, we fully agree with the reviewer that its placement may not have been prominent. Therefore, we moved the definition of stoichiometry to the main introduction paragraph (colored in blue)!\n\n**W2. Possibility of stoichiometry-based models to capture the structure information of crystals.**\n\nThank you for pointing out our research question! As mentioned by the reviewer and depicted in Fig 1 (c) in the main manuscript, it is obvious that stoichiometry itself cannot capture the information about the structural information. However, thanks to the universal approximation theorem [1], we believe that deep neural networks possess the capacity to learn a function that correlates stoichiometry with its corresponding structural information.   Furthermore, a recent application of generative models to deduce stable crystal structures from given stoichiometries [2] provides empirical support that models based on stoichiometry can indeed infer the structural details of crystals.\n\n[1] Multilayer feedforward networks are universal approximators, Neural networks 1989\n\n[2] Crystal Structure Prediction by Joint Equivariant Diffusion, NeurIPS 2023\n\n**W3. Atomic types and stoichiometry were used as easy attributes in almost all past representations.**\n\nWe fully agree that atomic types and stoichiometry have been widely employed in numerous preceding studies. We have recognized these prior contributions in our research and references to the relevant works are comprehensively listed in Section 2.2 of the main manuscript.\n\n**W4. Problem Description.**\n\nFirst of all, we would like to clarify our research problem statement. In materials science, it is a common situation where we cannot observe the exact structural information of crystalline materials during materials synthesis, since the atomic-level rearrangement of the material occurs through mixing of raw materials, heat treatment, and solvent reactions. However, the majority of machine learning models in materials science are built on top of the structural information, restricting their applicability in the real-world material discovery process. Therefore, in this paper, we aim to build a machine learning model that can predict the properties of materials given only stoichiometry.\n\n**W4-1. Find a complete invariance description of a periodic crystal?**\n\nWe agree with the reviewer that the challenge of identifying an invariant description of a periodic crystal was addressed almost a century ago, and also recognize that inductive biases related to invariances in the architectural design of deep neural networks for crystalline materials [1]. However, in this paper, we focus on learning the probabilistic representation of stoichiometry where the crystal structure remains unidentified, as opposed to seeking a comprehensive invariant description of a periodic crystal.\n\n[1] Periodic graph transformers for crystal material property prediction, NeurIPS 2022\n\n**W4-2. Determining stoichiometry only from a crystal structure?**\n\nWe concur with the reviewer that, in theory, stoichiometry is uniquely determined by the geometric arrangement of atoms, as also described in our response to [reviewer rRHK](https://openreview.net/forum?id=yuGqe96t9O&noteId=D5aw44Ub3h).\nHowever, in this paper, our objective is not to determine stoichiometry itself, but to learn the encoder that establishes a representation of stoichiometry where the crystal structure is not known.\n\n**Q1. Reasons to invent a new word.**\n\nThank you for your suggestion! We originally coined the term \u201cpreservativity\u201d to denote the retention of similarities or differences among data points within the latent space. Upon the reviewer\u2019s suggestion, we agree that \u201cinvariance\u201d is a suitable alternative and have accordingly replaced \u201cpreservativity\u201d with \u201cinvariance\u201d throughout the text (colored in blue).\n\n\n**Q2. What probabilistic space defined?**\n\nThe random variable is defined on the probability space whose measure is Gaussian distribution parameterized with deep neural networks with $\\mathbb{R}^F$ dimensional space as sample space.\n\nOn the other hand, acknowledging that the term \u201crandom variable\u201d may cause confusion for readers, we have decided to revise the sentence as follows: we propose Polymorphic Stoichiometry Representation Learning (PolySRL), which aims to learn the representation of stoichiometry as a probabilistic representation of polymorphs instead of a single deterministic representation."
                    }
                },
                "number": 7,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission4333/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1699928255087,
                "cdate": 1699928255087,
                "tmdate": 1699930892237,
                "mdate": 1699930892237,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "0ZUg3oR53r",
                "forum": "yuGqe96t9O",
                "replyto": "DgkRNbETrh",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission4333/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission4333/Authors"
                ],
                "content": {
                    "comment": {
                        "value": "**Q3. Appropriateness of Gaussian assumption.**\n\nWe appreciate the reviewer for providing a great point for discussion! We have incorporated this discussion into the discussion section located in **Appendix H**.\n\nIn fact, the particles that make up a material are distributed discretely [1], and the material itself manifests following a distinct probability distribution, which is a composite of the discrete distributions attributed to its constituent particles [2]. However, parameterizing such discrete distributions for each material is impossible, and therefore, an alternative distribution that can approximate the actual distribution is required. \n\nTherefore, we choose the Gaussian distribution as an approximate, which has multiple advantages when incorporated with deep neural networks as follows:\n- Efficient gradient computation is available with a reparameterization trick.\n- Analytical computation of KL divergence is available and theoretically guaranteed.\n\nFurthermore, we note in Section 5.3 that the uncertainty, which is obtained from the variance of the Gaussian distribution, is consistent with established materials science expertise. Given that our approach involves a probabilistic representation of stoichiometry to offer both precise representation and model uncertainty, we believe that the Gaussian distribution is effectively fulfilling its intended role.\n\n[1] Density functional theory of electronic structure, The journal of physical chemistry 1996\n\n[2] Exploiting solid-state dynamic nuclear polarization NMR spectroscopy to establish the spatial distribution of polymorphic phases in a solid material, Chemical Science 2023\n\n\n**Q4. How many CPU hours and hidden parameters?**\n\nSince we have trained our model on GPU, we will report the GPU hours used for this process. It takes 3 hours to train the model 100 epochs with the MP dataset which consists of 80,162 distinct stoichiometries with their corresponding 112,183 crystal structures in 24 GB NVIDIA GeForce RTX 3090. Moreover, We have 1,445,800 hidden parameters for the stoichiometry encoder and 2,541,811 hidden parameters for the structural encoder.\n\n\n**Q5. Did the authors know about the classical results in the crystallograph cited above?**\n\nWhile we recognize the fact that 1) there exists an invariant description of a periodic crystal, and 2) the stoichiometry is uniquely determined by the geometric arrangement of atoms, we were not fully aware of the specific details within the cited papers. We greatly appreciate the seminal research that has laid the groundwork for current advancements in the field, and we will ensure to acknowledge this body of work appropriately.\n\n**Final Remark.**\n\nOnce again, we appreciate the reviewer highlighting valuable discussion points in our study. We also offer our apologies for any confusion or ambiguity in our initial submission. We hope that our response has made the details of the paper clearer, and we are fully prepared to continue the conversation about any points that may still need further explanation."
                    }
                },
                "number": 8,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission4333/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1699928306181,
                "cdate": 1699928306181,
                "tmdate": 1699928933928,
                "mdate": 1699928933928,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "SuCBOeKExS",
                "forum": "yuGqe96t9O",
                "replyto": "0ZUg3oR53r",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission4333/Reviewer_sAC5"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission4333/Reviewer_sAC5"
                ],
                "content": {
                    "comment": {
                        "value": "Thank you for the answers and references.\n\n> it is obvious that stoichiometry itself cannot capture the information about the structural information. However, thanks to the universal approximation theorem [1], we believe that deep neural networks possess the capacity to learn a function that correlates stoichiometry with its corresponding structural information. \n\nIf \"it is obvious that stoichiometry itself cannot capture the information about the structural information\", then how can you \"believe that deep neural networks possess the capacity to learn a function that correlates stoichiometry with its corresponding structural information\" and what is the exact meaning of \"correlates\" here?\n\n>[2] provides empirical support that models based on stoichiometry can indeed infer the structural details of crystals.\n\nIf the reference was to https://arxiv.org/abs/2309.04475, this paper also ignores the discontinuity of Niggli's reduced cell under almost any tiny permutation of atoms. \n\n>we aim to build a machine learning model that can predict the properties of materials given only stoichiometry.\n\nIf the given stoichiometry is pure carbon, how can vastly different properties of diamond and graphite be predicted from the same input?\n\n>we focus on learning the probabilistic representation of stoichiometry where the crystal structure remains unidentified\n\nWhat is the space on which probability distributions are considered?\n\n>learn the encoder that establishes a representation of stoichiometry where the crystal structure is not known\n\nDoes \"representation\" here mean a geometric structure of a crystal?\n\n>Analytical computation of KL divergence is available\n\nIf KL referred to https://en.wikipedia.org/wiki/Kullback-Leibler_divergence, this function fails the metric axioms.\n\n>We have 1,445,800 hidden parameters for the stoichiometry encoder and 2,541,811 hidden parameters for the structural encoder.\n\nIf a training set changes, should these 4 million parameters be recomputed?"
                    }
                },
                "number": 12,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission4333/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700435835734,
                "cdate": 1700435835734,
                "tmdate": 1700435835734,
                "mdate": 1700435835734,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "vssjC8qur2",
                "forum": "yuGqe96t9O",
                "replyto": "DgkRNbETrh",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission4333/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission4333/Authors"
                ],
                "content": {
                    "comment": {
                        "value": "Thank you for your time and efforts in reviewing our paper! We are happy to discuss more about our paper.\n\n> If \"it is obvious that stoichiometry itself cannot capture the information about the structural information\", then how can you \"believe that deep neural networks possess the capacity to learn a function that correlates stoichiometry with its corresponding structural information\" and what is the exact meaning of \"correlates\" here?\n\nFirstly, by \"correlates\" we are referring to the mapping between stoichiometry and structural information, implying that a neural network can be trained to map stoichiometry with its corresponding structural details.\n\nAlthough it's clear that stoichiometry alone doesn't encompass structural information, our premise is based on the existence of a function that can relate stoichiometry to its specific crystal structure. Thanks to the universal approximation theorem, this allows us to train deep neural networks to approximate this function using pairs of stoichiometry and their associated structures.\n\n> If the reference was to https://arxiv.org/abs/2309.04475, this paper also ignores the discontinuity of Niggli's reduced cell under almost any tiny permutation of atoms.\n\nAlthough this paper does not consider the discontinuity of Niggli\u2019s reduced cell, predicting crystal structure based on stoichiometry demonstrates that deep neural networks can learn the mapping function between stoichiometry and its possible stable structure.\n\nWe kindly request the reviewer to acknowledge the recent advances of deep generative models for crystal material generation, which sheds light on the possibility of deep neural networks to learn the crystal structure [1, 2 ,3].\n\n[1] Crystal Diffusion Variational Autoencoder for Periodic Material Generation, ICLR 2022.\n\n[2] Crystal Structure Prediction by Joint Equivariant Diffusion, NeurIPS 2023.\n\n[3] Towards Symmetry-Aware Generation of Periodic Materials, NeurIPS 2023.\n\n> If the given stoichiometry is pure carbon, how can vastly different properties of diamond and graphite be predicted from the same input?\n\nAs the reviewer pointed out, a model relying solely on stoichiometry may not be able to distinguish vastly different properties of materials with differing structures. To overcome the limitation, our model accounts for uncertainties in the materials, and the ability to quantify these uncertainties is crucial in the real-world application of machine learning, especially for virtual screening in scientific discovery [1, 2].\n\nAdditionally, it's common in wet lab experiments to have only stoichiometry information available as we responded to reviewer [jsDD](https://openreview.net/forum?id=yuGqe96t9O&noteId=efaOs4V5j0). In such cases, models that depend on structural information become inapplicable, presenting a challenge for their use in materials discovery. Consequently, while stoichiometry-based models may not differentiate between materials with the same stoichiometry but different structures, we propose that they represent a promising approach for machine learning to make significant contributions in the field of materials science.\n\n[1] Machine learning framework for enhanced molecular screening. Chemical science 2021.\n\n[2] Accelerating high-throughput virtual screening through molecular pool-based active learning. Chemical science 2021.\n\n> What is the space on which probability distributions are considered?\n\nThis space is the embedding space of stoichiometry, which also is the output space of the stoichiometry encoder.\n\n> Does \"representation\" here mean a geometric structure of a crystal?\n\nIn this context, \"representation\" refers to the vector output produced by the stoichiometry encoder, which transforms stoichiometry into a vector space. This is distinct from the geometric structure of a crystal. \nBy contrasting this representation with the representation from \u201cstructural encoder\u201d, representation of stoichiometry can contain the structural information of the material."
                    }
                },
                "number": 14,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission4333/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700452630019,
                "cdate": 1700452630019,
                "tmdate": 1700452695458,
                "mdate": 1700452695458,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "DrL1tf1rdH",
                "forum": "yuGqe96t9O",
                "replyto": "DgkRNbETrh",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission4333/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission4333/Authors"
                ],
                "content": {
                    "comment": {
                        "value": "> If KL referred to https://en.wikipedia.org/wiki/Kullback-Leibler_divergence, this function fails the metric axioms.\n\nThe reviewer correctly noted that KL divergence does not adhere to the metric axiom due to its lack of symmetry and failure to fulfill the triangular inequality. Nevertheless, within the machine learning community, KL divergence is often considered the most intuitive approach for comparing two probability distributions [1, 2]. This is because, as a core concept in information theory, it effectively measures the closeness of two probability distributions in terms of bits. Therefore, we decided to use KL divergence to measure the difference between the learned distribution and prior distribution.\n\n[1] Deep Variational Information Bottleneck, 2017 ICLR\n\n[2] Auto-Encoding Variational Bayes, 2014 ICLR\n\n> If a training set changes, should these 4 million parameters be recomputed?\n\nIf the training set undergoes complete change, it would be necessary to train all parameters from the beginning. However, in practical scenarios, such a situation is unlikely since our model is trained with all the possible stoichiometry-structure pairs in Materials Project website. Thus, in real-world applications, if a new combination of stoichiometry and crystal structure emerges, we can efficiently update the model by training it with the new data, rather than starting from scratch."
                    }
                },
                "number": 15,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission4333/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700452641447,
                "cdate": 1700452641447,
                "tmdate": 1700452813540,
                "mdate": 1700452813540,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "B4csbUBOsR",
            "forum": "yuGqe96t9O",
            "replyto": "yuGqe96t9O",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission4333/Reviewer_rRHK"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission4333/Reviewer_rRHK"
            ],
            "content": {
                "summary": {
                    "value": "This paper tackles the problem of learning representations of stoichiometries (ratio of chemical elements in a compound) for materials property prediction. In particular, this papers addresses the challenge of polymorphism, which refers to the fact that a single stoichiometry can correspond to multiple, diverse materials due to the different ways in which atoms can be arranged to form thermodynamically stable structures. The paper presents a machine learning algorithm where the structural information of compounds available in a data set is used to train a probabilistic embedding of the stoichiometry via a contrastive loss. The model optimises the parameters of a multivariate Gaussian distribution such that the graph representations of a stoichiometry and the structural graph representations of its polymorphs is minimised, while maximising the distance to other structures. The evaluation includes various data sets focused on different material properties and comparisons with a diverse set of methods."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "3 good"
                },
                "strengths": {
                    "value": "I have enjoyed reading this paper, it is interesting and well written and generally the strengths of the paper outweigh my concerns, which I mention in the next section. I will highlight here some of these strengths.\n\nFirst of all, the paper identifies an important challenge in the application of machine learning methods for materials discovery. Namely, that the structural information of new materials is not readily available, as the standard way to obtain it depends of computationally expensive simulations, for example with Density Functional Theory (DFT). Therefore, many of the most accurate methods in the machine literature for modelling materials and molecules, which are GNNs that use the structural information as input, cannot be effectively applied to new candidates of which we may only know the composition. This is an important subject that has received relatively little attention and this paper proposes a method that seems to obtain good results on various benchmarks.\n\nThe extensive evaluation of the method is also a strength of this paper. The authors compare their method against several diverse baselines, on an array of data sets focused on different materials properties and they include an ablation study of some of the most important components of the algorithm.\n\nRegarding the method itself, I think it is an original and reasonable idea to use a contrastive loss between the structural representation of polymorphs and the stoichiometry representation of their composition. This still leverages the potential of GNNs to learn good structural representations, but allows using only the stoichiometry representation at inference time. I believe there could be multiple variations of the proposed method and I was initially skeptical of some of the specific details of the method, but the results seem to support the choices, and future work may explore other alternatives.\n\nFinally, the paper is for the most part well written and easy to follow - with some exceptions I discuss below."
                },
                "weaknesses": {
                    "value": "I would encourage the authors to improve the clarity of the last part of the paper, namely Section 5. While the quality is not poor, I did notice a decrease in the quality and clarity of this section with respect to the methods part of the paper, which I found very clear. Note that the first paragraph of 5.1 contains a few typos or grammar mistakes. Also, the size of the figures in this section are too small.\n\nAn exception of this clarity in the methods section is Section 4.3, where I believe the notation is a bit confusing. For instance, $\\mathcal{P}^b$ is used here for the first time to refer to what I believe is the structural graph, previously referred to as $\\mathcal{G}^b$. Also, should the superscript not be $b$ instead of $a$ because it refers to the structural graph? In fact, the superscript of $z_p$ is $b$. Or perhaps I am missing something. In this section as well, $m$ is used in the conditional probability without defining it.\n\nAlthough there is additional information in the appendix, I would suggest to include some details regarding the data splits (train, validation, cross-validation) in the main paper as well to describe the evaluation protocol.\n\nMachine learning models that predict the structure given the stoichiometry can be reasonable or even better alternatives to richer representations of the stoichiometry as proposed here. I would have appreciated to find a discussion of the pros and cons of these two approaches and ideally a review of crystal structure prediction methods."
                },
                "questions": {
                    "value": "Some disconnected questions or comments:\n\n- Why the figure of merit metric is not included in the Table with transfer learning results?\n- Several times throughout the paper it is mentioned that there exists a one-to-many relationship between the stoichiometry and the possible structures. Does the structural graph contain information about the atoms species? I wonder if it is also the case, otherwise, that one structures actually corresponds to more than one stoichiometry. \n- Regarding the \"collapsed dimensions\" of the representation, I wonder whether it is actually due to the fact that some stoichiometries have no known polymorphs in the data sets and therefore their variance should in fact be zero. What do you think?"
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "8: accept, good paper"
                },
                "confidence": {
                    "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 3,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission4333/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698801487426,
            "cdate": 1698801487426,
            "tmdate": 1699636403420,
            "mdate": 1699636403420,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "LjmigDYHhY",
                "forum": "yuGqe96t9O",
                "replyto": "B4csbUBOsR",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission4333/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission4333/Authors"
                ],
                "content": {
                    "comment": {
                        "value": "Thank you for acknowledging the importance of the research topic and our efforts in extensive experiments! We are more than willing to clarify the reviewer\u2019s concerns one by one.\n\n**W1 & W3. Improving the clarity of Section 5 / Including some details regarding data splits.**\n\nWe greatly appreciate the reviewer for pointing out the unclarified parts in our paper, as this will undoubtedly enhance the presentation of our research. In response to the reviewer's feedback, we have implemented the following revisions, which are highlighted in blue in the main manuscript:\n\n- We have corrected the grammatical errors and typographical mistakes in the first paragraph of section 5.1\n- We have increased the size of Figure 3 on Page 8\n- We have increased the font size of Figure 4 on Page 9\n- We have increased the size of Figure 5 on Page 9\n- We have included more details on data splits in the third paragraph of Section 5.1\n\nAdditionally, we will ensure a thorough review of our paper to correct any grammatical errors throughout the document.\n\n**W2. Confusing notation in Section 4.3.**\n\nFirst of all, we apologize for any confusion caused by the use of the terms $\\mathcal{P}^a$ and $m$. \nIn fact, $\\mathcal{P}^a$ is intended to represent the set of polymorphic crystal structures associated with the stoichiometry graph $\\mathcal{G}^a$, as indicated in line 10 of Section 3.2. However, we fully agree with the reviewers that this notation might lead to ambiguity since superscript $b$ is consistently used for the structural graph. Therefore, to clarify our notation, we have decided to change the term $\\mathcal{P}^a$  into $\\mathcal{P}^{\\mathcal{G}^a}$.\nMoreover, we apologize for missing the precise definition of $m$, which is the indicator function of value 1 if $\\mathcal{P}^{\\mathcal{G}^a}$ is the set of polymorphic structures corresponding to $\\mathcal{G}^a$ and 0 otherwise. We highlighted the modified term in blue color in the main manuscript.\n\n**W4-1. Discussions on the pros and cons of using stoichiometry compared to crystal structure prediction (CSP).**\n\nThank you for pointing out a great discussion point! In our opinion, here are the advantages and disadvantages of employing stoichiometry-based models versus crystal structure prediction (CSP) methods.\n\n**Advantages of stoichiometry-based models**\n- CSP methods firstly predict the structure of crystals, and then train another model for downstream tasks based on the predicted structure. Therefore, accurate crystal structure prediction is crucial, as the success of downstream tasks hinges on the initial accuracy of crystal structure prediction. However, it is also well-known that CSP methods encounter difficulties with complex systems, potentially hindering their efficacy in various downstream applications [1]. On the other hand, since stoichiometry-based models derive predictions directly from the elemental composition, they avoid the pitfalls associated with predicting the precise structure.\n- Furthermore, we argue that models based on stoichiometry could be applicable to a broader range of materials, including doped and alloyed materials. Doping and alloying involve transformative processes that introduce a level of disorder into a conventional structure, making the precise prediction of the resulting material's structure exceedingly challenging for CSP methods [2]. On the other hand, stoichiometry-based models, which rely solely on the ratio of constituent atoms, offer greater versatility across a diverse spectrum of materials.\n- Additionally, the computational expense of stoichiometry-based models is expected to be significantly lower than that of CSP models. Traditional CSP methods, particularly those reliant on Density Functional Theory (DFT), are known to be computationally demanding [3]. On the other hand, it is acknowledged that stoichiometry-based approaches circumvent the need for extensive computational resources, thereby offering a cost-effective alternative [4].\n\n**Disadvantages of stoichiometry-based models**\n- Given that the crystal structure is a key determinant of a material's properties, CSP models that can precisely predict crystal structure have the potential to surpass the performance of stoichiometry-based models.\n\n[1] MLatticeABC: generic lattice constant prediction of crystal materials using machine learning. ACS omega 2021.\n\n[2] Effects of doping on the crystal structure of poly (3-alkylthiophene), Journal of Materials Chemistry 2.9 1992.\n\n[3] Density functional theory: a practical introduction, John Wiley & Sons 2022.\n\n[4] Representations of materials for machine learning, Annual Review of Materials Research 53 2023."
                    }
                },
                "number": 4,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission4333/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1699928020200,
                "cdate": 1699928020200,
                "tmdate": 1699929857265,
                "mdate": 1699929857265,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "YXxGfxctR6",
                "forum": "yuGqe96t9O",
                "replyto": "B4csbUBOsR",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission4333/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission4333/Authors"
                ],
                "content": {
                    "comment": {
                        "value": "**W4-2. A review of crystal structure prediction methods.**\n\nWhile we have examined the pros and cons of employing stoichiometry-based models as outlined in W4-1, we acknowledge the critical significance of crystal structure prediction (CSP), which has been a long-standing problem in physical sciences [1]. We fully agree with the reviewer on the significant relevance of CSP to our work, and we decided to add the following review in **Appendix G**!\n\nCrystal structure prediction (CSP) is the process of determining the stable three-dimensional structure of a compound from its chemical composition alone. Conventional CSP methods often combine density functional theory (DFT) with optimization algorithms. These algorithms carry out an iterative process searching for stable states that align with the local energy minima, while DFT is utilized to assess the energy at each step of the iteration [2, 3, 4]. A recent development in the field is DiffCSP [5], which employs a deep generative model within a diffusion framework to simultaneously optimize lattice matrices and atomic coordinates, offering a novel approach to the CSP problem.\n\nIt's important to highlight the growing interest among researchers in generating crystal structures without predefined stoichiometry, a direction distinct from CSP. The groundbreaking CDVAE [6] integrates a variational autoencoder (VAE) architecture with a diffusion-based decoder to produce the types of atoms, their coordinates, and lattice parameters. Unlike CSP-focused methods, CDVAE's primary goal is the generation of random crystal structures, providing a different avenue in the field of crystallography research.\n\n[1] Cryptic crystallography, Nature Materials 2022\n\n[2] Ab initio random structure searching, Journal of Physics: Condensed Matter 2011\n\n[3] Crystal structure prediction accelerated by bayesian optimization, Physical Review Materials 2018\n\n[4] Structure prediction drives materials discovery, Nature Reviews Materials 2019\n\n[5] Crystal Structure Prediction by Joint Equivariant Diffusion, NeurIPS 2023\n\n[6] Crystal diffusion variational autoencoder for periodic material generation, ICLR 2022\n\n\n**Q1. Figure of merit for Transfer Learning.**\n\nSpace limitations in our submission led us to exclude some results, which may result in a lack of clarity in our presentation. As done in representation learning, we determined the figure of merit using a rule-based approach to evaluate model predictions. Our observations indicate that models incorporating 3D information significantly surpass those that do not take 3D data into account.\n\n|             | 300K          | 600K          |\n|-------------|---------------|---------------|\n| Rand Init   | 0.073 (0.024) | 0.218 (0.076) |\n| GraphCL     | 0.064 (0.014) | 0.202 (0.086) |\n| MP Band G.  | 0.067 (0.011) | 0.206 (0.119) |\n| MP Form. E. | 0.069 (0.010) | 0.223 (0.097) |\n| 3D Infomax  | 0.066 (0.010) | 0.154 (0.032) |\n| PolySRL     | 0.058 (0.012) | 0.179 (0.052) |\n\n\n**Q2-1. Structural graph contains information about the atom species?**\n\nNo, the structural graph in PolySRL does not include atom species information in the structural graph. Instead, as detailed in line 11 of Section 3.2, each node in the structural graph is associated with a learnable feature vector to make sure we utilize only structural information. Traditional machine learning methods that use structural graphs [1, 2] typically embed atom species information within the nodes of the graph. However, we intentionally omitted atom species information to ensure that our focus was solely on structural information. This methodology has also been validated in accurately estimating the mutual information between 2D molecule graphs and their corresponding 3D point clouds [3].\n\n[1] Crystal graph convolutional neural networks for an accurate and interpretable prediction of material properties, Physical review letters 2018\n\n[2] Atomistic line graph neural network for improved materials property predictions, npj Computational Materials 2021\n\n[3] 3D Infomax improves GNNs for Molecular Property Prediction, ICML 2022"
                    }
                },
                "number": 5,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission4333/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1699928113082,
                "cdate": 1699928113082,
                "tmdate": 1699928916778,
                "mdate": 1699928916778,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "D5aw44Ub3h",
                "forum": "yuGqe96t9O",
                "replyto": "B4csbUBOsR",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission4333/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission4333/Authors"
                ],
                "content": {
                    "comment": {
                        "value": "**Q2-2. One structure corresponds to more than one stoichiometry?**\n\nYes, this can also be the case since we excluded the atom species information in the structural graph. That is, it is possible that more than one stoichiometry can have the same structural graphs. However, we believe this is due to the design choice of structural graph,  not due to the knowledge in materials science. Theoretically, a structural graph that assigns atom species to each node for machine learning should correspond to a unique stoichiometry.\n\nOn the other hand, an interesting phenomenon where a single structure corresponds to multiple stoichiometries has indeed been observed by scientists in real-world scenarios. However, this is not a widespread occurrence and is typically examined at a case study level within the field of chemistry [1, 2].\n\n[1] Multi-stoichiometric quasi-two-dimensional W n O 3n\u2212 1 tungsten oxides, Nanoscale 2020.\n\n[2] Crystal structures capture multiple stoichiometric states of an aqueous self-assembling oligourea foldamer, Chemical Communications 2021.\n\n\n**Q3. Regarding collapsed dimensions.**\n\nYes, we believe \u201ccollapsed dimension\u201d is due to the fact that some stoichiometries have no known polymorphs in the data sets, and we posit that Figure 4 corroborates this understanding. As depicted in Figure 4, the predicted uncertainties for stoichiometries associated with a single possible structure (that is, those without known polymorphs in the dataset) exhibit the lowest levels of uncertainty compared to other groups. This suggests that stoichiometries with a single possible structure are likely to present more collapsed dimensions.\n\n**Final Remark.**\n\nOnce again, thank you for strongly supporting our work, and we apologize for any confusion or lack of clarity in our initial submission. We hope our response has clarified the contents of the paper, and we are more than willing to engage in further discussion regarding any aspects that remain unclear."
                    }
                },
                "number": 6,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission4333/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1699928183135,
                "cdate": 1699928183135,
                "tmdate": 1699928183135,
                "mdate": 1699928183135,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "yFbJkW8hI1",
                "forum": "yuGqe96t9O",
                "replyto": "D5aw44Ub3h",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission4333/Reviewer_rRHK"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission4333/Reviewer_rRHK"
                ],
                "content": {
                    "title": {
                        "value": "Response to authors"
                    },
                    "comment": {
                        "value": "Thank you for the detailed answer to my review. I appreciate the discussion of my comments and the decisions to include part of these in the manuscript. I also welcome to decisions to clarify the notation.\n\nI think the decision of not including atom species in the structural graph could be defended. However, since the exclusion of atom species from the structural graph yields in theory a many-to-many scenario regarding stoichiometries and structures, would it not be more appropriate to discuss this explicitly in the paper? Currently, the text follows the premise of a one-to-many scenario.\n\nRegarding collapsed dimensions, after your confirmation that they will likely correspond to to stoichiometries with no known polymorphs, then I conclude that this is not a phenomenon to avoid, but rather a natural consequence of the modelling design. However, the paper treats collapsed dimensions as an indicator of \"worse\" fit. I wonder whether it would be appropriate to either tune the analysis regarding collapsed dimensions, or discuss this as a potential limitation of the method."
                    }
                },
                "number": 18,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission4333/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700575243744,
                "cdate": 1700575243744,
                "tmdate": 1700575243744,
                "mdate": 1700575243744,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    }
]