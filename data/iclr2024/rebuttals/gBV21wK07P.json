[
    {
        "title": "3D Autoencoding Diffusion Model for Molecule Interpolation and Manipulation"
    },
    {
        "review": {
            "id": "KdrwuaFBk7",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission6828/Reviewer_Xp9N"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission6828/Reviewer_Xp9N"
            ],
            "forum": "gBV21wK07P",
            "replyto": "gBV21wK07P",
            "content": {
                "summary": {
                    "value": "This paper considers the problem of manipulating known molecules and interpolating between known molecules with deep generative models, especially diffusion models. Specifically, this paper focuses on the two tasks by the recently proposed equivariant diffusion generative models (requires equivariance since molecules are represented by 3D point clouds). The authors propose an auxiliary variable to improve the steerability and interpretability of the diffusion model. Experiments are conducted on both interpolation and optimization problems in the absence or the presence of a \"template\" molecule."
                },
                "soundness": {
                    "value": "2 fair"
                },
                "presentation": {
                    "value": "2 fair"
                },
                "contribution": {
                    "value": "1 poor"
                },
                "strengths": {
                    "value": "* This paper studies an important problem, how to interpolate between molecules and optimize molecules is a crucial problem in molecular discovery which has wide applications such as molecule optimization. The study of semantic directions in diffusion models is also timely and encouraged as it is the best-performing model in terms of generation quality at the moment.\n* The idea of the method is quite simple but reasonable to introduce an auxiliary variable that learns control factors of the generative process.\n* The proposed metrics seem to be reasonable for this relatively new task."
                },
                "weaknesses": {
                    "value": "* The first major weakness of this paper is that it seems to ignore relevant literature in this area. Interpolation has been used and demonstrated for a long time [1, 2], the latent traversal has also been discovered before [3]. Despite this paper strikes the point that it focuses on diffusion models, but the authors should still consider proper comparisons or acknowledgments.\n\n* Given this problem has been studied before, especially interpolation, the technical contribution of this paper is very limited. Another major contribution claimed in the paper (learning a semantics-guided autoencoding diffusion model) has also been proposed in [4]. The formulation looks exactly the same.\n\n* It is not surprising that linear interpolation could lead to improved properties as studied widely in images and some in molecules (e.g. [3]), but the experimental details need to be included for a fair comparison and evaluation.\n\n* The template-based manipulation seems an interesting setup, but a more realistic one should be specifying a specific molecule and then manipulate that molecule, given the stochastic forward process of diffusion model, maybe it is not possible. The name of \"template-based\" manipulation seems referring to manipulate any given molecule rather than a randomly sampled molecule.\n\n* [Minor] The explanation of stability and validity seems to be different from the literature, see e.g. [5].\n\n[1] G\u00f3mez-Bombarelli, R., Wei, J.N., Duvenaud, D., Hern\u00e1ndez-Lobato, J.M., S\u00e1nchez-Lengeling, B., Sheberla, D., Aguilera-Iparraguirre, J., Hirzel, T.D., Adams, R.P. and Aspuru-Guzik, A., 2018. Automatic chemical design using a data-driven continuous representation of molecules. ACS central science, 4(2), pp.268-276.\n\n[2] Zang, C. and Wang, F., 2020, August. Moflow: an invertible flow model for generating molecular graphs. In Proceedings of the 26th ACM SIGKDD international conference on knowledge discovery & data mining (pp. 617-626).\n\n[3] Du, Y., Liu, X., Shah, N.M., Liu, S., Zhang, J. and Zhou, B., 2022. ChemSpacE: Interpretable and Interactive Chemical Space Exploration. Transactions on Machine Learning Research.\n\n[4] Wang, Y., Schiff, Y., Gokaslan, A., Pan, W., Wang, F., De Sa, C. and Kuleshov, V., 2023. InfoDiffusion: Representation Learning Using Information Maximizing Diffusion Models. ICML 2023.\n\n[5] Hoogeboom, E., Satorras, V.G., Vignac, C. and Welling, M., 2022, June. Equivariant diffusion for molecule generation in 3d. In International conference on machine learning (pp. 8867-8887). PMLR."
                },
                "questions": {
                    "value": "See weaknesses."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "3: reject, not good enough"
                },
                "confidence": {
                    "value": "5: You are absolutely certain about your assessment. You are very familiar with the related work and checked the math/other details carefully."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 1,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission6828/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1697165273250,
            "cdate": 1697165273250,
            "tmdate": 1699636789898,
            "mdate": 1699636789898,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "hIzmMZ5XbT",
                "forum": "gBV21wK07P",
                "replyto": "KdrwuaFBk7",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6828/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6828/Authors"
                ],
                "content": {
                    "comment": {
                        "value": "1\\. Comparison with interpolation and latent space optimization for 2D molecules\n\nOur focus is on semantics-guided diffusion in **3D molecular space**. We are aware of the existing works on interpolation and latent space optimization for molecules, but the majority of them are on 2D molecular graphs. The generation of 3D molecular structures poses different challenges such as preserving the symmetry, and incorporating semantic guidance into the generative process is a rarely explored topic. We will cite the mentioned papers, but it is not possible for direct comparison as these are different generation tasks.\n\n2\\. Contribution of the paper\n\nWe have to disagree on this claim. Our main contribution is achieving semantic guidance on a **3D equivariant diffusion model**, which is a challenging task considering the complexity of the 3D space and the equivariance of the diffusion process. 3D interpolation is very different from that in 2D molecules or images. Also, learning informative semantics for 3D molecules is not trivial since we need a learning paradigm that can effectively leverage both the invariant and equivalent features. Please refer to the main rebuttal part 3 for extended discussion.\n\n3\\. Interpolation and experimental details \n\nAs we have mentioned above, the generation of 3D molecules is a challenging task. Also, experimental details for the interpolation have been given in 5.4.\n\n4\\. Property manipulation\n\nWe\u2019d like to clarify that:\n\n(1) In fact, we are manipulating given molecule templates (which we now call \u201csource\u201d to avoid confusion). As described in 5.5, our property manipulation experiment takes the semantic embedding of a given source molecule, uses a simple linear model to alter its properties, and utilizes the altered embedding to generate a new molecule. We show in Fig 4 and Appendix Table 8 that molecules generated in this way largely resemble the source, while also gaining the altered property.\n\n(2) Our framework is based on DDIM, which allows for deterministic sampling. In other words, every embedding+noise combination could be deterministically mapped to a data point in the molecular space. Thus, the manipulated embedding also maps to a specific molecule.\n\n5\\. Stability and validity metrics\n\nWe\u2019d first like to clarify that our metric for \u201cstability\u201d is the same as Hoogeboom et al. (i.e. whether the allowed valency for the atoms is violated). However, as we are not modeling with explicit hydrogen, fragmented molecules can still be considered \u201cstable\u201d after adding the hydrogens back according to the allowed valency. This results in many false positives. Because of that, our \u201cvalidity\u201d metric adds another connectivity check, addressing the limitations of the previous metrics.\n\nFurthermore, for better comparison, we now report the validity metrics from MiDi, which are not very different from ours. Please see the main rebuttal part 4.1 for more details."
                    }
                },
                "number": 6,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6828/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700714008272,
                "cdate": 1700714008272,
                "tmdate": 1700714008272,
                "mdate": 1700714008272,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "Qr66kOy2zC",
            "forum": "gBV21wK07P",
            "replyto": "gBV21wK07P",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission6828/Reviewer_SYuH"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission6828/Reviewer_SYuH"
            ],
            "content": {
                "summary": {
                    "value": "The authors couple an autoencoder with a generative diffusion-based model for 3D molecule generation to overcome the potential limitation of not being able to operate on latent embeddings when using diffusion models. A semantic latent is trained as a condition for guiding the diffusion model to manipulate / interpolate molecules in 3D space. The authors present three different scenarios to show the effectiveness of the proposed method. One of the scenarios measures the ability to manipulate the latent embedding towards a target property using a linear regression model, which could be used, e.g., for the rational design of molecules."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "2 fair"
                },
                "contribution": {
                    "value": "2 fair"
                },
                "strengths": {
                    "value": "- Although many works have been proposed in recent years leveraging the latent embeddings of AE/VAE architectures for interpolation and optimization tasks, the combination of a diffusion model with an autoencoder provides some novelty."
                },
                "weaknesses": {
                    "value": "- Tables and figures are insufficiently described in the captions. \n- The paper only presents validity and stability metrics, but no similarity measures to examine the effectiveness of the template-guidance. Beyond that, the quality of the 3d geometries are not evaluated (e.g. energies and atomic forces).\n- egDiffAE does not perform well in terms of stability (e.g. QM9 template-based generation 85.8% vs de-novo methods like EDM  90.7% [Hoogeboom et al] / Midi 97.5 [Vignac et al 23]). GEOM mol stability metrics are not given (only atom stability).\n- The property manipulation does not seem to meaningfully alter the template, but mostly move atoms around and break/form some bonds. As a result, the results of property manipulation do not appear to be in equilibrium, but arbitrary conformations. Energies and atomic forces need to be carefully checked, since the optimized molecular properties are only meaningful in equilibrium. Beyond that, as far as I can tell, the property models have been trained on equilibirum molecules, i.e. they might be out of their domain of applicability at arbitrary conformations.\n- In Table 3, \"retrieval\" baseline yields similar results to egDiffAE, in some properties even performing better. For the the remaining properties, it is not possible to determine whether the improvement is significant and meaningful without error bars and units."
                },
                "questions": {
                    "value": "- What is the practical relevance of molecule interpolation?\n- How close are the generated / manipulated molecules to equilibrium?\n- Why use MMD regularization instead of KL prior regularization as in VAE?\n- How large is the batch size? MMD usually requires large batch sizes\n- From the figures, it seems that interpolation and manipulation is only possible for molecules with same number of atoms?\n- Why are there are no figures showing results on GEOM? This might be important to evaluate how the generation performs on larger molecules?"
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "3: reject, not good enough"
                },
                "confidence": {
                    "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 2,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission6828/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698312510072,
            "cdate": 1698312510072,
            "tmdate": 1699636789784,
            "mdate": 1699636789784,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "29SXksJE50",
                "forum": "gBV21wK07P",
                "replyto": "Qr66kOy2zC",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6828/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6828/Authors"
                ],
                "content": {
                    "comment": {
                        "value": "1\\. Captions\n\nThanks for the comment. We have already discussed all tables and figures extensively in the Results section. We also add some descriptions to the captions in the revision.\n\n2\\. Similarity and energy metrics\n\nThanks for the comment. We now also report similarity measures and energy estimated by xTB. Please find more details in the main rebuttal part 4.\n\n3\\. Comparison with *de novo* generation\n\nWe\u2019d like to point out that the template-based (which we now call \u201csemantics-guided\u201d to avoid confusion) generation in our study is not directly comparable with *de novo* generation results in those works because:\n\n(1) Our generation task is different from *de novo*. Please refer to the main rebuttal part 2 for more details.\n\n(2) We do not explicitly include hydrogen. As mentioned in the main rebuttal part 4.1, the implicit hydrogen also leads to different validity metrics as in those works.\n\nWe\u2019ve also shown *de novo* generation results in Appendix Table 7. We believe there is room for improvement in the quality of both tasks in future studies.\n\n4\\. Metrics for GEOM\n\nOur model is based on the framework of EDM, which only models the atom types and coordinates, and tends to produce disconnected structures for large molecules (Appendix A8). Thus, only atom stability is reported for GEOM, as in EDM.\n\n5\\. Property manipulation\n\nFirst of all, we have examples where atom types are modified in Fig 4. We also have discussed the limitations of the current results in Conclusions. \n\nAs our model is trained on QM9, which only contains equilibrium molecules, we\u2019d assume the generated molecules should resemble equilibrium ones. Thus, property models on equilibrium molecules could be applied to the generations, similar to EDM.\n\nWe use xTB to estimate the energy of the molecules. As shown in Appendix Table 8, for most properties, the energy distribution of the generated molecules shifts slightly higher from the test set (equilibrium), which means most of the generated molecules have near-equilibrium conformations.\n\n6\\. Retrieval\n\nWe\u2019d like to clarify that the \u201cretrieval\u201d method uses the **semantic embedding learned from egDiffAE** to directly select **molecules from the training set** with the desired property. This has been explained in 5.5. It is another way of obtaining molecules with desired compositions and properties using our semantics embedding. Its high performance is an expected result because:\n\n(1) It searches for real molecules, so validity is guaranteed.\n\n(2) It shows our semantic embedding contains sufficient information for the property-determining components, so if a known molecule has a similar embedding as z\u2019, it means that the molecule should carry the same property. This further proves the effectiveness of the semantics embedding.\n\nOn the other hand, this baseline does not meaningfully generate any new molecules but only searches among the training set. Thus, it mostly offers a sanity check and an approximate upper bound of the performance. We have further clarified that in Table 3 and Section 5.5."
                    }
                },
                "number": 4,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6828/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700713737366,
                "cdate": 1700713737366,
                "tmdate": 1700713737366,
                "mdate": 1700713737366,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "mXMy7TsEuR",
            "forum": "gBV21wK07P",
            "replyto": "gBV21wK07P",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission6828/Reviewer_bMs7"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission6828/Reviewer_bMs7"
            ],
            "content": {
                "summary": {
                    "value": "In this paper, the authors propose an augmentation to the 3D equivariant diffusion model proposed by Hoogeboom et al, 22. This is done by including an extra \u201csemantic embedding\u201d (from an auxiliary encoder) at each step of the reverse diffusion process. The authors show that the \u201csemantic embedding\u201d improve some generation metrics  (although the choice of metrics are not the best, see below) and achieve good \u201cproperty manipulation\u201d performance. Experiments are done on three standard molecule datasets (QM9, GEOM-drugs and ZINC"
                },
                "soundness": {
                    "value": "2 fair"
                },
                "presentation": {
                    "value": "2 fair"
                },
                "contribution": {
                    "value": "2 fair"
                },
                "strengths": {
                    "value": "- As mentioned in the paper, manipulate the latent space of diffusion models is not as easy as in other generative models. Understanding and improving on this issue is valuable for the research community.\n- Moreover, the problem tackled on this work (ie, 3D molecule generation) is an important (and under-explored) application for machine learning."
                },
                "weaknesses": {
                    "value": "- The paper is not very well written. Many definitions are wrongly used or used too loosely (eg, \u201cde novo\u201d or \u201ctemplate-based\u201d) and a lot of implementation details are missing, making reproduction difficult.\n- There are citations missing (many work do some kind of semantic guiding, eg Hoogeboom et al, 22, all the work on pocket-conditioning, linking, fragment-based generation, etc).\n- The idea of conditional generation in some semantic space is interesting. However, the way it has been proposed seems ad-hoc to me. It is unclear what the \u201csemantic encoding\u201d is learning if the only loss is MMD with Gaussian.\n- The metrics used on the experiments are not very convincing. The authors only use validity and atom stability\u2014metrics that are known to be not very informative of the quality of the samples. I would recommend the authors to use the MiDi metrics (Vignac et al, 23) at a minimum. It is also not clear to me that the \u201csmootheness\u201d metric used is very informative. The results shown on Table 2 (mean +- std for both \u201csmootheness mean\u201d and \u201csmootheness std\u201d are not clear).\n- The authors do not compute any measure of uniqueness/diversity of the generated molecules. It would be nice to see how diverse are the generated samples in this setting (since it is very important to generate diverse molecules in practice). I would imagine that the \u201csemantic embedding\u201d could highly reduce the diversity and this could be bad for some applications."
                },
                "questions": {
                    "value": "- Please see the weaknesses above. It would be nice to hear the authors\u2019 opinion about them.\n- Many work propose some kind of inpainting for scaffold/linking (eg, DiffHopp (Torge et al 23), SBDDDiff (Schneuing et al 22), DiffLinker (Igashov et al 22), etc). It would be good to compare the performance of the model with some inpainting baseline. How does the proposed method differs from those approaches?"
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "3: reject, not good enough"
                },
                "confidence": {
                    "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 3,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission6828/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698701605757,
            "cdate": 1698701605757,
            "tmdate": 1699636789665,
            "mdate": 1699636789665,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "FKnaiilRpk",
                "forum": "gBV21wK07P",
                "replyto": "mXMy7TsEuR",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6828/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6828/Authors"
                ],
                "content": {
                    "comment": {
                        "value": "1\\. Use of terms and experimental details\n\nWe believe *de novo* is properly used as we are randomly sampling molecules from the molecular space without any specification in the respective experiments. We do acknowledge that \u201ctemplate-based\u201d may be misleading so we changed that wording to \u201csemantics-guided\u201d, reflecting the real nature of our experiment. Please see the main rebuttal part 1 for more details.\n\nAlso, we\u2019ve included many implementation details in the Appendix, including on the data processing (A.3), model architecture (A.4), and model hyperparameters and training (A.5). We will make our references in the main text to the Appendix clearer. Also, if you could specify the missed implementation details, we will be happy to clarify and add them. \n\n2\\. Comparison with ligand and linker designs, and inpainting (also responding to question 2)\n\nIt is noteworthy that those works do not have the same \u201cguidance\u201d as ours. We consider those works as more of an externally **conditioned** generation, where a molecule (or a part of it) is generated conditioned on known pockets/fragments. There is no explicit control over the \u201csemantics\u201d (i.e. the composition and shape) of the generated molecule itself in those problems. Here our semantics contains direct information about the entire molecule, rather than the condition. Please refer to the main rebuttal part 2. We\u2019ve also discussed those works in the Related Works.\n\nWe do believe these are interesting applications for 3D diffusion models, and that our framework could be applied to them by leveraging both the condition and the explicit control of certain parts of the structure, and compared with those papers. However, it may require major modifications to the current training and generation framework to perform inpainting, so we\u2019d like to leave it for further studies.\n\n3\\. The loss for the semantics embedding\n\nWe\u2019d like to clarify that the semantic embedding is used as an input to guide the diffusion process. Thus, the diffusion model\u2019s noise estimation loss (equivalent to the reconstruction loss in traditional autoencoder settings) is also back-propagate to the encoder, and the MMD loss is an additional regularization term. Thus, as is proved in 4.3, it also contains information about the input molecule. This is similar to an autoencoder framework where the diffusion model effectively functions as a \u201cdecoder\u201d. \n\n4\\. Evaluation metrics\n\n4.1 Validity \n\nThanks for the suggestion. We now report the same validity metric as in MiDi. Interestingly, both MiDi\u2019s valid metric and our previous valid are both stability (valency not violated) plus connectivity (successfully sanitized by RDKit), the results are almost the same as before.\n\n4.2. Atom stability\n\nFor larger molecules, because we are building upon EDM\u2019s framework (see main rebuttal part 2), we encounter the same problem where the generations are fragmented. Thus, we also rely on only atom similarity like in EDM. We could improve the generation quality on those datasets by incorporating some more recent advances in the 3D modeling of molecules (e.g. explicitly generating the bonds). We\u2019d leave it for future studies.\n\n4.3 Interpolation\n\nWe have explained in detail the smoothness metrics in 5.4. Basically, for an interpolation trajectory, our desired characteristics are:\n\n(1) Overall smooth transitions between neighboring points (low smoothness mean)\n\n(2) Near-uniform steps taken across the trajectory (low smoothness std)\n\n(3) The midpoint being a proper mixture of the two endpoints, rather than something entirely different (high midpoint similarity) \n\nSpecifically for (3), we can observe in the interpolation with standard DDIM that the midpoint is a new molecule that does not resemble either of the endpoints. Thus, it is not a smooth trajectory from one end to the other. \n\n5\\. Novelty and uniqueness\n\nThanks for the comment. We now report the uniqueness and novelty using the same metrics as in MiDi (see Table 1 and Appendix A.7.3). \n\nAs shown in Table 1, we expect molecules generated with the same semantics embedding to have lower diversity than de novo generations. This is the exact purpose of our framework: to enforce sufficient control on the composition, shape, etc. of the molecule so that the same semantic embedding will result in mostly similar molecules regardless of the random noise. Then we can explore the molecular space with finer control over the direction.\n\nIf the goal is to generate diverse molecules, we could randomly sample a semantic embedding and use it for generation, as in Appendix Table 7."
                    }
                },
                "number": 3,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6828/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700713380752,
                "cdate": 1700713380752,
                "tmdate": 1700713380752,
                "mdate": 1700713380752,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "WkAqutlD7i",
            "forum": "gBV21wK07P",
            "replyto": "gBV21wK07P",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission6828/Reviewer_6Nzc"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission6828/Reviewer_6Nzc"
            ],
            "content": {
                "summary": {
                    "value": "This submission proposes a method to control the generation process of 3D molecule diffusion models. This is to mitigate the research gap that most existing works focus on de novo molecule design, aka, generate random molecules, without controlling the molecule's properties. Specifically, they utilize an auxiliary encoder's output to condition the generation process of an equivariant diffusion model.  This allows the direct operation on the embeddings for effective interpolation and property manipulation of template molecules."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "1 poor"
                },
                "contribution": {
                    "value": "2 fair"
                },
                "strengths": {
                    "value": "* The studied task of controlled molecule generation is of significant research and application value. Compared to de novo moleucle generation, controlled moelcule generation aligns better with the practical usage."
                },
                "weaknesses": {
                    "value": "I am not very familar to diffusion models and the generation of 3D molecules. To me, the biggest concern is on the evaluation of the proposed method. It seems that there are no baselines that are directly comparable for the main experiments (Table 1, Table 2, Table 3), and the used evaluation metrics are sometimes insufficient to prove the value of the proposed method. For example:\n\n* In Table 1, only `stableness` and `validity` are used as evaluation metric. However, for a template-based generation task, I expect metrics like `similarity to the template`, and `diversity of the generated molecules`. \n* In Table 2, the used evaluation metrics are somehow confusing. For `smoothness` and `midpoint similarity`, how are the similarity scores calculated? Do you use cosine similarity on embeddings? Or, do you apply other similarity metrics direclty on molecules?\n\n\n\nI am willing to re-evaluate my rating based on other reviewers' comments."
                },
                "questions": {
                    "value": "n/a"
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "5: marginally below the acceptance threshold"
                },
                "confidence": {
                    "value": "2: You are willing to defend your assessment, but it is quite likely that you did not understand the central parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 4,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission6828/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698823060017,
            "cdate": 1698823060017,
            "tmdate": 1699636789536,
            "mdate": 1699636789536,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "ZP4g0gAgal",
                "forum": "gBV21wK07P",
                "replyto": "WkAqutlD7i",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6828/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6828/Authors"
                ],
                "content": {
                    "comment": {
                        "value": "We acknowledge that there aren\u2019t many existing baselines to compare with our method, except for interpolation where we could directly compare with a simple DDIM. For example, regarding molecular properties, most existing studies rely on conditioned generation given the properties, with little to no control over other aspects of the generated molecule. In this study, we seek finer control on not only the properties but also the composition, overall shape, etc. with the semantics embedding. Thus, for most parts of our work, we are trying to prove the generated molecules are of good quality and could achieve the conditioning we want. \n\nAs mentioned in the main rebuttal part 3, here we try to demonstrate the usefulness of semantics guidance for the generation on a very well-established basis and dataset. We believe this framework could be extended to achieve finer guidance on more complex generative tasks, such as linkers and pocket-based ligands, by incorporating some recent progress in 3D molecule modeling dedicated to those tasks. \n\n1\\. Evaluation metrics\n\nThanks for the suggestion. We\u2019ve included similarity and uniqueness (i.e. diversity) in the results. Please refer to the main rebuttal part 4.3 for more details.\n\n2\\. Interpolation metrics\n\nThe similarity scores are defined as the cosine similarity between the embeddings. For an interpolation trajectory, our desired characteristics are:\n\n(1) Overall smooth transitions between neighboring points (low smoothness mean)\n\n(2) Near-uniform steps taken across the trajectory (low smoothness std)\n\n(3) The midpoint being a proper mixture of the two endpoints, rather than something entirely different (high midpoint similarity) \n\nSpecifically for (3), we can observe in the interpolation with standard DDIM that the midpoint is a new molecule that does not resemble either of the endpoints. Thus, it is not a smooth trajectory from one end to the other. Please find more detailed descriptions in 5.2 and 5.4."
                    }
                },
                "number": 2,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6828/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700713153595,
                "cdate": 1700713153595,
                "tmdate": 1700713413480,
                "mdate": 1700713413480,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    }
]