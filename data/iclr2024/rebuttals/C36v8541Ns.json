[
    {
        "title": "The Lipschitz-Variance-Margin Tradeoff for Enhanced Randomized Smoothing"
    },
    {
        "review": {
            "id": "Xg7ojJaAv5",
            "forum": "C36v8541Ns",
            "replyto": "C36v8541Ns",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission6520/Reviewer_W4Xb"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission6520/Reviewer_W4Xb"
            ],
            "content": {
                "summary": {
                    "value": "This work analyzes the certified radius that can be provided to off-the-shelf classifier that are also Lipschitz continuous. The authors use previous results (namely, that a certified radius can be derived deterministically for Lipschitz predictors, and that randomized smoothing provides probabilistic certified radius as well as Lipschitz smoothed predictors) to show that there exist an optimal way to determine the strength of randomized smoothing that should be applied to a Lipschitz function. In addition, the authors make the observation of changing  the mapping function to the probability simplex as well as better finite-sample concentration inequalities to derived slightly improved guarantees on popular benchmarks (CIFAR10 and ImageNet)."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "3 good"
                },
                "strengths": {
                    "value": "- While it has been known that randomized smoothing provides a Lipchitz continuous randomized classifier, with constant inversely proportional to the smoothing strength, it has been unclear what one can gain by incorporating the (natural) assumption that base (or sub) classifier is also Lipschitz. In my opinion, this is the main contribution of this paper, which is nice."
                },
                "weaknesses": {
                    "value": "- The paper is at times verbose, and at times unclear. Some comments are exaggerated or incorrect (See below).\n- Nomenclature is often incorrect (see below).\n- In my view, the contributions of employing a better concentration inequality to provide tighter tail guarantees for finite samples is small, as is the fact of changing the function that maps the sub-classifier predictions to the probability simplex."
                },
                "questions": {
                    "value": "**Major Points**\n\n* Throughout the paper, the authors refer to softmax (and other functions) as \"projections\" onto the probability simplex. The softmax is not a projection onto the simplex. In fact, this reviewer believes that the softmax is not a projection onto any set (is it?). Throughout the manuscript, the word \"projection\" is used in lieu of the term \"function\" or \"map\". \n\n* Randomized smoothing can provide a certified radius at varying levels, depending on the strength of the added noise. It is clear to me that leveraging the fact that $f$ is Lipschitz continuous allows the authors to find an optimal randomized smoothing strength, as indicated in Prop. 4. Such a smoothing strength results in a certified radius. What is unclear to me is, what can be done if one requires certification at a different radius? \n\n* page 3: The definition of $L(f)$ that the authors use require $f$ to be differentiable. This assumption is not necessary (as best as I can tell) for their results to hold (and indeed, not applicable to ReLU networks). So, just define $L(f)$ by its standard definition (without assuming differentiability).\n\n* The authors comment on some related works pertaining the analysis of Lipschitz-continuity for devising certified radii. There exist extensions of these ideas that refine the analysis to requiring only local Lipschitzness, as in [A], which lead to improvements on the certified radius. Can the authors comment on relations to that work, and on whether their results could apply in a local way as in [A] ?\n\n* page 4: the authors mention that \"these bounds are relevant for the composite classifier defined as $\\Phi^{-1} \\circ f$. However, I believe they mean the classifier $\\tilde{F}_s$, no? \n\n* The authors argue in Section 3.3 that different functions s(z) have different impacts in terms of the variance of s(Z) vs the variance in Z. This is quite obvious, and, respectfully, I find the Example 1 not useful/trivial. ii) It is unclear, however, how such a map should be chosen to be optimal. It seems to me (from their experimental section) that they simply compute different options based on different alternatives for s(z) and choose the one that results in larger empirical margin. Is this correct? Shouldn't one be able to provide a \"best\" choice for s(z)?\n\n* After Prop. 3, the authors mention that \"This refinement on the bound was possible by supposing Lipschitz continuity on the base classifier $f$. Note that its Lipschitz constant can be arbitrarily high, so this assumption is quite light\". What do the authors mean by \"light\" here?\n\n\nReferences:\n\n(A) Muthukumar et al, \"Adversarial Robustness of Sparse Local Lipschitz Predictors, SIAM Journal on Mathematics of Data Science, 5:4, 2023\n\n\n\n**Other points**:\n* page 1: the authors write that there's a \"circular dependency: the regularity of the smoothed classifier depends on the Lipschitz property of the base classifier and the variance of the Gaussian convolution which governs the induced level of smoothness.\" Yet, i don't see how this is a circular dependency.\n\n* page 3: what do the authors mean by \"furnished by $f$\"?\n\n* page 3: \"concerning the $\\ell_2$ norm\" -> \"w.r.t.... \"\n\n* page 3: In defining the margin of $f$ at $x$, it should be \"of $f$ at $(x,y)$\", since its definition uses the correct label $y$.\n\n* Prop. 1: The first sentence is incomplete. Please revise English usage.\n\n* The authors use the term \"sub-classifier\" to refer to the un-robustified function $f$, alas sometimes they refer to it as a \"classifier\" (as in Prop.3)\n\n* It might help the reader to make explicit what the final classifier is (which I believe is $\\argmax_{s,t} \\tilde{F}^t_s(x)$, no?)\n\n* In the conclusion: \"In this paper, we demonstrate a significant correlation between the variance of randomized smoothing and two critical properties of the base classifier\" I don't think the authors demonstrate any \"correlation\" between these things. Maybe they meant \"connection\"?"
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "6: marginally above the acceptance threshold"
                },
                "confidence": {
                    "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
                },
                "code_of_conduct": {
                    "value": "Yes"
                },
                "first_time_reviewer": {
                    "readers": [
                        "ICLR.cc/2024/Conference/Program_Chairs",
                        "ICLR.cc/2024/Conference/Submission6520/Senior_Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission6520/Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission6520/Reviewer_W4Xb"
                    ]
                }
            },
            "number": 1,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission6520/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698717442347,
            "cdate": 1698717442347,
            "tmdate": 1700605677544,
            "mdate": 1700605677544,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "R9GACBA9MC",
                "forum": "C36v8541Ns",
                "replyto": "Xg7ojJaAv5",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6520/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6520/Authors"
                ],
                "content": {
                    "comment": {
                        "value": "We would like to thank the reviewer for their interest, positive remarks, and extensive comments.\n\n## Weakness\n\n### The paper is at times verbose, and at times unclear. Some comments are exaggerated or incorrect (See below).\nWe have revised the paper in an effort to make it clearer.\n\n### In my view, the contributions of employing a better concentration inequality to provide tighter tail guarantees for finite samples is small, as is the fact of changing the function that maps the sub-classifier predictions to the probability simplex.\n\nOur approach generalizes the usage of argmax as a simplex map and provides insight into why methods like (Salman et al. 2019) which reduce Lipschitz of $f$ are crucial.\n\n## Question Major Points\n\n### Throughout the paper, the authors refer to softmax (and other functions) as \"projections\" onto the probability simplex. The softmax is not a projection onto the simplex. In fact, this reviewer believes that the softmax is not a projection onto any set (is it?). Throughout the manuscript, the word \"projection\" is used in lieu of the term \"function\" or \"map\".\n\nWe have modified the notation and replaced \"simplex projection\" by \"simplex map\".\n\n### Randomized smoothing can provide a certified radius at varying levels, depending on the strength of the added noise. It is clear to me that leveraging the fact that $f$ is Lipschitz continuous allows the authors to find an optimal randomized smoothing strength, as indicated in Prop. 4. Such a smoothing strength results in a certified radius. What is unclear to me is, what can be done if one requires certification at a different radius?\n\nAs we are doing Randomized Smoothing on an already Lipschitz classifier, we can as in Randomized Smoothing alone change the magnitude $\\sigma$. It will not be optimal: the cross effect of Randomized Smoothing and Lipschtz Continuity will not be maximal, but it allows to reach for a potentially greater certified radius.\nWe have also generalized our procedure for a simplex of mass $r$, changing $r$ allows to adapt to one targetted certified radius, as discussed in Section 3.4.\n\n### page 3: The definition of $L(f)$ that the authors use require $f$ to be differentiable. This assumption is not necessary (as best as I can tell) for their results to hold (and indeed, not applicable to ReLU networks). So, just define $L(f)without assuming differentiability).\n\nWe have modified the definition of $L(f)$ by:\n\n$L(f) = \\sup_{\\substack{x, x' \\in \\mathcal{X} \\\\ x \\neq x'}} \\frac{\\lVert f(x) - f(x') \\rVert_2}{\\lVert x - x' \\rVert_2} \\enspace$.$\n\n### The authors comment on some related works pertaining the analysis of Lipschitz-continuity for devising certified radii. There exist extensions of these ideas that refine the analysis to requiring only local Lipschitzness, as in [A], which lead to improvements on the certified radius. Can the authors comment on relations to that work, and on whether their results could apply in a local way as in [A] ?\n\nWe have devised a Theorem to bound $||\\nabla \\Phi^{-1} \\circ \\tilde{f}_k (x) ||$. This theorem can be used to derive bound on a the local Lipschitz constant.\n\n\n### page 4: the authors mention that \"these bounds are relevant for the composite classifier defined as $\\Phi^{-1} \\circ f$. However, I believe they mean the classifier $\\tilde{F}_{s, t}$, no?\n\nWe have corrected the error, we meant the classifier $\\Phi^{-1} \\circ \\tilde{f}_k$.\n\n### he authors argue in Section 3.3 that different functions s(z) have different impacts in terms of the variance of s(Z) vs the variance in Z. This is quite obvious, and, respectfully, I find the Example 1 not useful/trivial. ii) It is unclear, however, how such a map should be chosen to be optimal. It seems to me (from their experimental section) that they simply compute different options based on different alternatives for s(z) and choose the one that results in larger empirical margin. Is this correct? Shouldn't one be able to provide a \"best\" choice for s(z)?\nFor future works, I think, it is not obvious that there is a consensus. (60 \\% is $\\mathrm{argmax}$ rest $\\mathrm{sparsemax}$).\nWe are going to modify the procedure and add a phase where we determine $s$ and $t$ on a first $n_0$ sample of $\\delta_i$, in the same manner as \\cite{cohen_certified_2019}.\nThen run the standard, RS procedure with the classifier $F_{s, t}$ on another sample of size $n$.\nThis new procedure is statistically correct.\n\n### After Prop. 3, the authors mention that \"This refinement on the bound was possible by supposing Lipschitz continuity on the base classifier $f$. Note that its Lipschitz constant can be arbitrarily high, so this assumption is quite light\". What do the authors mean by \"light\" here?\n\nIt means that the Lipschitz constant $L(f)$ can be arbitrarily high at the end we come up with a bound which does not depend on  $L(f)$. So it is not a restrictive hypothesis to assume and this conducts to a better bound for most networks used in Randomized Smoothing."
                    }
                },
                "number": 10,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6520/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700101452614,
                "cdate": 1700101452614,
                "tmdate": 1700103428873,
                "mdate": 1700103428873,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "Tqs1INgXWT",
                "forum": "C36v8541Ns",
                "replyto": "Xg7ojJaAv5",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6520/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6520/Authors"
                ],
                "content": {
                    "comment": {
                        "value": "## Question Other Points:\n\n### page 1: the authors write that there's a \"circular dependency: the regularity of the smoothed classifier depends on the Lipschitz property of the base classifier and the variance of the Gaussian convolution which governs the induced level of smoothness.\" Yet, i don't see how this is a circular dependency.\n\nWe have removed this formulation. It was used because the Lipschitz constant of the base classifier plays a dual role in the MC variance and the Lipschitz constant of the smoothed classifier.\n\n### page 3: what do the authors mean by \"furnished by $f$\"?\nWe reformulated this sentence by \"given by $f$\".\n\n### page 3: \"concerning the $\\ell_2$ norm\" -> \"w.r.t.... \"\nSame as above.\n\n### page 3: In defining the margin of $f$ at $x$, it should be \"of $f$ at $(x, y)$\", since its definition uses the correct label $y$.\nWe modified the definition of the margin accordingly.\n\n### Prop. 1: The first sentence is incomplete. Please revise English usage.\nWe rewrote the sentence.\n\n### The authors use the term \"sub-classifier\" to refer to the un-robustified function $f$, alas sometimes they refer to it as a \"classifier\" (as in Prop.3)\nWe corrected it.\n\n### It might help the reader to make explicit what the final classifier is (which I believe is $\\argmax_{s, t} \\tilde{F}_s^t(x)$, no?)\n\nWe corrected it and defined it clearly in the paper now.\n\n### In the conclusion: \"In this paper, we demonstrate a significant correlation between the variance of randomized smoothing and two critical properties of the base classifier\" I don't think the authors demonstrate any \"correlation\" between these things. Maybe they meant \"connection\"?\n\nWe corrected this term usage."
                    }
                },
                "number": 11,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6520/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700101461444,
                "cdate": 1700101461444,
                "tmdate": 1700103749101,
                "mdate": 1700103749101,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "Y33cbGM9xh",
                "forum": "C36v8541Ns",
                "replyto": "Tqs1INgXWT",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6520/Reviewer_W4Xb"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6520/Reviewer_W4Xb"
                ],
                "content": {
                    "title": {
                        "value": "Thanks for the clarification"
                    },
                    "comment": {
                        "value": "I thank the authors for their comments: some have clarified some misunderstandings i had before, and other have corrected elements that were not initially completely correct in their paper.\n\nI'm increasing my score accordingly."
                    }
                },
                "number": 16,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6520/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700605640093,
                "cdate": 1700605640093,
                "tmdate": 1700605640093,
                "mdate": 1700605640093,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "0NKCLAeAF9",
            "forum": "C36v8541Ns",
            "replyto": "C36v8541Ns",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission6520/Reviewer_ay9y"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission6520/Reviewer_ay9y"
            ],
            "content": {
                "summary": {
                    "value": "In this paper authors study the interplay between randomized smoothing, Lipschitz bounds and margin of the classifier, to design a new robustness certification method with improved guarantees.  \nMore specifically, they show that when the Lipschitz constant of a base classifier $f$ is low, the robustness radius of the smoothed estimator $\\tilde f$ can be lower, and the variance of the associated estimators is also lower. Therefore, with the same cost (in $n$ the number of samples) a bigger certified radius can be estimated at risk level $\\alpha$.  \nThe robustness radii rely on a margin, typically the difference between the two highest logits. Author show that `argmax` might not be the best option, and that other options like `sparsemax` have better properties.\n\nFinally, the new certification method is tested and compared against randomized smoothing and Lipschitz-based certification, on Imagenet and Cifar-10 tasks."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "2 fair"
                },
                "contribution": {
                    "value": "3 good"
                },
                "strengths": {
                    "value": "### Originality\n\nThe work takes a new look at an existing topic, by incorporating Lipschitz constraints into randomized smoothing. It borrows tools from different fields, like concentration inequalities, projections onto the simplex (argmax, softmax, sparsemax), and robustness certification against adversarial attacks.  \n\n### Clarity\n\nFig 1. helps a lot to the understanding.\n\n### Significance\n\nThe proposed algorithm LVM-RS can be seamlessly ingrated into existing frameworks, it is very general (with different temperatures and simplex projections), and not too expensive to run. The empirical results are convinving, since the new method improves upon both (i) Randomized Smoothing (ii) 1-Lipschitz networks of (Wang & Manchester, 2023)."
                },
                "weaknesses": {
                    "value": "I struggled a lot to understand the paper at times. There is a lack of details, and even with the help of the related literature (e.g. Cohen et al) I couldn't be sure of what the authors were trying to say. My questions are detailed below. Clarifications would benefit a lot to the paper."
                },
                "questions": {
                    "value": "> Most of the randomized smoothing approaches simplify the margin $-\\max_{y\\neq k}\\hat f_k(x)\\geq -(1-\\hat f_y(x))$ (Cohen et al., 2019)\n\nCan you clarify where in the paper of Cohen? Are you referencing their choice $p_A=1-p_B$ in top of their p6 ?\n\n> For each combination of (s, t), we determine the risk-corrected margin $M_2(p_{st} , \\alpha)$.\n\nIs it statistically correct (w.r.t $\\alpha$) ? Since you perform multiple tests with the same scores $f(x+\\delta_i)$ ? \n\n### Sets and domains of functions\n\nIt is not always clear from context what are the definition of functions. For example:\n* $\\hat f$ is implicitly defined in top of page 4, I assumed you meant $\\hat f_k()$ in the argmax. So $\\hat f:\\mathcal{X}\\rightarrow\\mathbb{R}^c$\n* but $\\Phi$ is a scalar function (per its definition), so what is the meaning of $\\Phi^{-1}\\circ \\hat f$ ? Is it vectorized?\n* so, is $g$ a scalar or a vectorized function Eq (3) ? \n\nIn Sec 2.1 the notation $L()$ is defined as a maximum of gradient norm over $\\mathbb{R}^d$. But the gradient is only defined for scalar functions, not for multivariate functions (in which case it is a Jacobian, not a gradient). This makes sense to define $l(g)=\\max_k L(f_k)$. But, then, if $g$ is multivariate, how can you write $L(g)$ ? What does it mean?  \n\nI suggest to define clearly each notation, and specify the domain of each function, not in an implicit manner in the middle of a formula.\n\n### Runtime\n\nWhat is the runtime cost of your method compared to randomized smoothing?\n\n### Typo\n\nThe paper can be hard to read. In p6:\n\n> Cohen et al. (2019); Salman et al. (2019); Carlini et al. (2023) use argmax simplex projection they can use the Clopper-Pearson Bernouilli tailored confidence interval ... etc\n\nThis paragraph should be rewritten, the first two sentences are not grammatically correct.  \n\n> Proposition 2\n\nIs it a definition of the `shift` function in left hand side? Use `:=` notation like `\\vcentcolon=` if so. Otherwise, define it somewhere. Please add a discussion of what $Z_i$ is supposed to be in *your* context.  \n\n> Once the variance has been minimized via Lipschitz constant regularization and that we can leverage\nlow resulting empirical variance with Empirical Bernstein\u2019s inequality a vital aspect for achieving\na significant certified radius is negotiating the margins-variance trade-off\n\nAdd punctuation.  \n\n> This is because the compensatory shift, incorporated\nto address the inherent risk, becomes minimal\n\nWhat does this sentence mean?\n\n> Equation (4)\n\n$R_2$ and $R_3$ inequality should be reversed."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "8: accept, good paper"
                },
                "confidence": {
                    "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                },
                "first_time_reviewer": {
                    "value": "Yes",
                    "readers": [
                        "ICLR.cc/2024/Conference/Program_Chairs",
                        "ICLR.cc/2024/Conference/Submission6520/Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission6520/Reviewer_ay9y",
                        "ICLR.cc/2024/Conference/Submission6520/Senior_Area_Chairs"
                    ]
                }
            },
            "number": 2,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission6520/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698776467231,
            "cdate": 1698776467231,
            "tmdate": 1700219891496,
            "mdate": 1700219891496,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "GklpH1eofq",
                "forum": "C36v8541Ns",
                "replyto": "0NKCLAeAF9",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6520/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6520/Authors"
                ],
                "content": {
                    "comment": {
                        "value": "We would like to thank the reviewer for their interest, positive remarks, and extensive comments.\n\n# Questions\n\n### Most of the randomized smoothing approaches simplify the margin $-\\max_{y \\neq k} \\hat{f}_k(x) \\geq -(1 - \\hat{f}_y(x))$ (Cohen et al., 2019) Can you clarify where in the paper of Cohen? Are you referencing their choice $p_A = 1 - p_B$ in top of their p6 ?\n \nYes, it was the message we wanted to convey. In (Cohen et al.2019) they reduce the multi-class setting to a binary class setting, this reduction comes at the expense of a degraded certified radius.\nWe have rewritten this part to make it clearer, please see Appendix C.\n\n### For each combination of (s, t), we determine the risk-corrected margin $M_2(p_{s,t}, \\alpha)$. Is it statistically correct (w.r.t ) $\\alpha $? Since you perform multiple tests with the same scores $f(x + \\delta_i)$?\n\nWe have modified the procedure and added a phase where we determine $s^*$ and $t^*$ on a first $n_0$ sample of $\\delta_i$, in the same manner as \\cite{cohen_certified_2019}.\nThen run the standard, RS procedure with the classifier $F_{s^*, t^*}$ on another sample of size $n$. \n\n## Set and domain of functions\nIt is not always clear from context what are the definition of functions. For example:\n\n### $\\hat{f}$ is implicitly defined in top of page 4, I assumed you meant $\\hat{f}_k$ in the argmax. So $\\tilde{f} : \\mathcal{X} \\mapsto \\mathbb{R}^c$\n\nWe have modified this section and add a proper definition of the smooth sub classifier $\\tilde{f}$.\n\n### but $\\Phi$ is a scalar function (per its definition), so what is the meaning of $\\Phi^{-1} \\circ \\hat{f}$? Is it vectorized? so, is $g$ a scalar or a vectorized function Eq (3) ?\n\nWe have modified the notation in the paper and only note $\\Phi^{-1}(\\tilde{f}_k(x))$ with $\\Phi^{-1} : [0, 1] \\mapsto \\mathbb{R}$.\n\n### I suggest to define clearly each notation, and specify the domain of each function, not in an implicit manner in the middle of a formula.\nWe have done accordingly in the paper.\n\n### In Sec 2.1 the notation $L()$is defined as a maximum of gradient norm over $\\mathbb{R}^d$. But the gradient is only defined for scalar functions, not for multivariate functions (in which case it is a Jacobian, not a gradient). This makes sense to define $l(g) = max_k L(f_k)$. But, then, if $g$ is multivariate, how can you write L(g) ? What does it mean?\n\nWe have modified the definition of the Lipschitz constant as $L(f) = \\sup_{\\substack{x, x' \\in \\mathcal{X} \\\\ x \\neq x'}} \\frac{\\lVert f(x) - f(x') \\rVert_2}{\\lVert x - x' \\rVert_2} \\enspace$.\nWe also remove the notation $l(f)$ and will use $L(f_k)$ instead.\n\n### Runtime\n### What is the runtime cost of your method compared to randomized smoothing?\nWe have integrated runtime cost in the tables.\n\n### Typo\nWe have integrated your remarks."
                    }
                },
                "number": 9,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6520/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700101404083,
                "cdate": 1700101404083,
                "tmdate": 1700102744825,
                "mdate": 1700102744825,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "Bc8HcGvOP9",
            "forum": "C36v8541Ns",
            "replyto": "C36v8541Ns",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission6520/Reviewer_12zu"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission6520/Reviewer_12zu"
            ],
            "content": {
                "summary": {
                    "value": "This paper studies methods to obtain improved randomized-smoothing (RS) certificates against $\\ell_2$ bounded adversarial attacks. The main contribution is to incorporate the lipschitz constant of the _base_ classifier $f$ into RS certificates to obtain improved bounds on the certified radius of the smoothed classifier $g$. Additionally, RS certificates hold with a probability $1 - \\alpha$, where $\\alpha$ is small. The auxiliary technical contribution of this paper is to utilize the variance of the output of $f$ to control $\\alpha$ better than prior work. Empirical evidence supports the theoretical results, demonstrating improved certificates over prior work."
                },
                "soundness": {
                    "value": "2 fair"
                },
                "presentation": {
                    "value": "2 fair"
                },
                "contribution": {
                    "value": "3 good"
                },
                "strengths": {
                    "value": "1. RS is currently the state of the art certification method for obtaining certificates of robustness against $\\ell_p$ attacks. However, the interaction of the properties of the base classifier with the final certificate is not very well understood. This paper attempts an understanding of how the Lipschitz constant of the base classifier affects the final certificate \u2014 this is an interesting problem to study and is potentially very useful for the community. \n\n2. Further, the paper revisits computation of the confidence $\\alpha$ that the RS certificate hold with, and demonstrates how the variance of $f$ (the base classifier) can be used to improve $\\alpha$, via a better concentration inequality. Exploring improved concentration inequalities for RS is also a useful research direction."
                },
                "weaknesses": {
                    "value": "1. Writing: The writing of the paper is quite wordy in many places, and confusing at times, leading to major issues in readability and clarity. Details:\n\n\t-\tAbstract: It is unclear what \u201cvariance introduced by RS\u201d, \u201csimplex projection\u201d, \u201cvariance-margin tradeoff\u201d mean. It is unclear what does bernstein\u2019s inequality have to do with any of this. \n\n\t-\tIntroduction: Would be good to define prediction margin. All methods with certified radius deal with a way of controlling /estimating the Lipschitz constant of the network, it is unclear why is Tsuzuku et. al. specifically mentioned. The statements are also quite wordy here (\u201cradius that encompasses \u2026 constant\u201d), a simple $|f(x) - f(x + \\delta)| \\leq L ||\\delta||$ would suffice here.\n\t-\tFigure 1: What is radius binding, risk shift, simplex projection? \u201cRisk\u201d is used throughout the introduction without a definition. \n\t-\tP2: The circular dependency mentioned in paragraph 2 was not clear, what exactly is the circular dependency?\n\t-\tThe definition of R(f, x) is written in a very convoluted fashion, isn\u2019t it simply $\\min_\\epsilon$ such that $\\exists$ adversarial example $\\in B(x, \\epsilon)$. The benefit of the written form of the definition is unclear. \n\t-\tThe correct earliest reference for Randomized Smoothing is not Cohen et al. 2019, please see the related work section in Cohen et al. 2019 for the correct references. \n\t-\tDefining the certified radius for the composition of $\\Phi^{-1}$ and $\\tilde f$ is confusing, since the radius is to be used for certifying $\\tilde f$, and not the composition. \n\t-\tSection 2.4: Margins and Robustness \u2014 This is again too wordy \u201cpromise in bolstering classifier defense\u201d, \u201cinherent synergy between them\u201d, \u201cour exploration dives deep into this nexus unravelling novel insights \u2026\u201d. The message again simply seems to be that greater margin = larger certified radius (at fixed L), and could be stated in a single line.\n\t-\tSection 3.1: Relation between certified Radii. The highlight of this section seems to be the last paragraph, that variance plays a crucial role in the RS certificates. It is unclear what does the rest of the section add to this message. Perhaps it would be better to simply stress this strong point, and detail Table 3.1.\n\t-\tTable 3.1 is hard to parse, could simply plotting the difference between R2 and R3 convey the message better?\n\n2. Technical Correctness: Related to the point above, there are several places where some additional steps / statements are needed to support the technical claims made in the paper:\u2028\n\t-\tP3, Proposition 1. Isn\u2019t the condition for correct prediction simply that margin > 2 * Lipschitz Constant * perturbation radius? ( Assume class 1 is majority at x, class 2 is second highest, then $|f1(x) - f1(x + v)| \\leq L ||v|| = L \\epsilon$, and $|f2(x) - f2(x + v)| \\leq L epsilon$. Then, if $f1(x) - f2(x) > 2 L \\epsilon$, then $f1(x + v) > f2(x + v)$). Why is the constant $\\sqrt{2}$, instead of $2$?\u2028\n\t-\tAppendix P12, Proof of Proposition 3. \n\t\t-\tWhy is $u \\in R^c$ defined? Doesn\u2019t seem to be used in the proof. \u2028\n\t\t-\tAre there are several typos confusing $\\delta$ with $\\delta\u2019$? For instance why is $E_\\delta [v^\\top \\delta h(x + \\delta)] = E_\\delta [v^\\top \\delta\u2019 h(x + \\delta\u2019)]$? The next step then replaces one of the $\\delta$ with $\\delta\u2019$, which is unclear too. \u2028\n\t\t-\t**Major 1**: Why is $v^T \\nabla \\tilde h(x) = (1/\\sigma^2) E[\u2026]$? Expanding $v^T \\nabla \\tilde h(x)$ gives $v^T \\nabla \\tilde h(x) = E[v^T \\nabla h(x + \\delta)]$, it is unclear how to proceed from here. \u2028\n\t\t-\tIn the step marked (i) in the proof, is there some typo? $|h(x + \\delta) - h(x + \\delta\u2019)|$ is replaced by $\\min(1, 2L) |v^\\top \\delta|$, why is this true? Isn\u2019t this bound $L ||\\delta - \\delta'||$?\n\t\t-\t**Major 2**: In the construction for the lower bound on $J$, $h_0 = (\u2026) \\min (\u2026, l(h)\u2026)$, but how can the constructed classifier depend on its own lipschitz constant. Some clarity is needed on why one can do this, and why this classifier exists. \n\n\n3. Technical Clarity: There are several places where additional clarity would help the reader.\n\t-\tIt is unclear how one obtains (4) by using the bound mentioned in the paragraph preceding it. A few lines would be great for readers not familiar with the proof in Cohen et al. 2019. \u2028\n\t-\tThe Gaussian Poincare inequality seems to be very similar to other well known concentration inequalities for functions of gaussian random variables. A brief contextualization would be great. For instance, how does this relate to the standard concentration inequality for Lipschitz functions of sub gaussian random variables: $P( |h(Z) - E h(Z)| > \\delta ) \\leq \\exp(-c \\delta^2 / L(h))$ (for a reference, see Theorem 5.2.2 in High Dimensional Probability by Roman Vershynin)\u2028\n\t-\tEq (5), where is alpha in the RHS? Specifically, it is unclear how the $p_1, p_2$ have any explicit dependence on $\\alpha$. I believe the dependence is that the number of samples n affects both alpha and $p_1, p_2$. But this is not clear at all by looking at (5). \n\n\t-\tRelated to the above point, now since the dependence was not specified in (5), it is unclear how $M_2$ is computed in the main algorithm Algorithm 1. Specifically, what is $\\bar M_2(p, \\alpha)$ on Line 6 of Algorithm 1, how does it relate to $s$, how does it relate to $t$?\u2028\n\t-\tWhat are the simplex projections being used in line 4, algorithm 1? The text mentions \u201cfor various projections \u2026 spanning softmax and sparsemax\u201d \u2014 Which projections specifically? \u2028\n\t-\tNow, in order to compute the margin $M_2$, I believe one needs to know the lipschitz constant of the classifier $s$ composed with $f$, how is this computed for each simplex projection chosen?\u2028\n\t-\tExperiments: How is the 1-Lipschitz backbone constructed. This should be detailed as it relates to the main contribution. \u2028\n\t-\tExperiments: The effects of the change in the $\\alpha$ calculation vs the change in the certificate are unclear. In particular, what are the results when the $\\alpha$ calculation in this paper is used on top of Cohen et. al.? Similarly, what are the results when the Clopper-Pearson $\\alpha$ calculation are used on top of this paper\u2019s certificate?"
                },
                "questions": {
                    "value": "At a high level it would be good to,\n\n(1) clarify and augment the paper with additional technical details to complete the proofs and correct the typos (details above),\n\n(2) explain the precise mathematical details of the certification procedure from input to certificate (see details in weaknesses above), and\n\n(2) empirically ablate the two components of the proposed approach (see details above)."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "6: marginally above the acceptance threshold"
                },
                "confidence": {
                    "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
                },
                "code_of_conduct": {
                    "value": "Yes"
                },
                "first_time_reviewer": {
                    "value": "Yes",
                    "readers": [
                        "ICLR.cc/2024/Conference/Program_Chairs",
                        "ICLR.cc/2024/Conference/Submission6520/Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission6520/Reviewer_12zu",
                        "ICLR.cc/2024/Conference/Submission6520/Senior_Area_Chairs"
                    ]
                }
            },
            "number": 3,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission6520/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698792863999,
            "cdate": 1698792863999,
            "tmdate": 1700563128240,
            "mdate": 1700563128240,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "Ysfbqt3LEw",
                "forum": "C36v8541Ns",
                "replyto": "Bc8HcGvOP9",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6520/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6520/Authors"
                ],
                "content": {
                    "comment": {
                        "value": "We would like to thank the reviewer for their interest, positive remarks, and extensive comments. We have revised the paper based on your comments to make it clearer. Please do not hesitate to look at the new version of the paper and let us know if there is still some misunderstanding.\n\n**1. Writing**\n\n**Abstract: It is unclear what \u201cvariance introduced by RS\u201d, \u201csimplex projection\u201d, \u201cvariance-margin tradeoff\u201d mean. It is unclear what does Bernstein\u2019s inequality have to do with any of this.**  \nWe have modified the abstract to make these notions more clear. \n\n**Introduction: Would be good to define prediction margin. All methods with certified radius deal with a way of controlling /estimating the Lipschitz constant of the network, it is unclear why is Tsuzuku et. al. specifically mentioned. The statements are also quite wordy here (\u201cradius that encompasses \u2026 constant\u201d), a simple $| f(x) - f(x + \\delta) | \\leq L || \\delta ||$ would suffice here.**  \nWe have included the definition of margin and Lipschitz in the introduction.\n\n**Figure 1: What is radius binding, risk shift, simplex projection? \u201cRisk\u201d is used throughout the introduction without a definition.**  \nWe have added a sentence in the introduction to define the risk: the probability that the MC classifier outputs the wrong answer. We have added a definition of the risk $\\alpha$ in the related work section on randomized smoothing.\nWe also have defined what is a simplex map (previously called simplex projection) in the introduction.\n\n**The circular dependency mentioned in paragraph 2 was not clear, what exactly is the circular dependency?**  \nWe have removed the use of this term. It was used to describe the different impacts of the Lipschitz constant of the base classifier on the MC variance and on the Lipschitz constant of the base classifier. \n\n**The definition of R(f, x) is written in a very convoluted fashion, isn\u2019t it simply $\\min_\\epsilon$ such that $\\exists$ adversarial example $\\in B(x, \\epsilon)$. The benefit of the written form of the definition is unclear.**  \nWe have modified the definition of $R(f, x)$ accordingly.\n\n**The correct earliest reference for Randomized Smoothing is not Cohen et al. 2019, please see the related work section in Cohen et al. 2019 for the correct references.**  \nWe have added the previous reference of Randomized Smoothing, Lecuyer 2019, Li 2019.\n\n**Defining the certified radius for the composition of and is confusing, since the radius is to be used for certifying $\\Phi^{-1}$, and $\\tilde{f}$, not the composition.**  \nWhen performing Randomized Smoothing we estimate the smoothed classifier $\\tilde{f}: R^d \\mapsto [0, 1]$.\nWith this estimation, we have by composing with $\\Phi^{-1}$ the classifier $\\Phi^{-1} \\circ \\tilde{f} : R^d \\mapsto R$ which enjoys a better certified radius.\n\n**Section 2.4: Margins and Robustness \u2014 This is again too wordy \u201cpromise in bolstering classifier defense\u201d, \u201cinherent synergy between them\u201d, \u201cour exploration dives deep into this nexus unraveling novel insights \u2026\u201d. The message again simply seems to be that greater margin = larger certified radius (at fixed L), and could be stated in a single line.**  \nWe have reformulated those sentences to make them clearer, please see section 2.4.  \n\n**Section 3.1: Relation between certified Radii. The highlight of this section seems to be the last paragraph, that variance plays a crucial role in the RS certificates. It is unclear what does the rest of the section adds to this message. Perhaps it would be better to simply stress this strong point, and detail Table 3.1.**  \nWe have put this section in the Appendix as it does not contain important insights for the rest of the contribution.\n\n**Table 3.1 is hard to parse, could simply plotting the difference between R2 and R3 convey the message better?**  \nWe have added a column with the difference between the radius."
                    }
                },
                "number": 4,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6520/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700099955086,
                "cdate": 1700099955086,
                "tmdate": 1700100860285,
                "mdate": 1700100860285,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "xAdDrq7LOf",
                "forum": "C36v8541Ns",
                "replyto": "Bc8HcGvOP9",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6520/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6520/Authors"
                ],
                "content": {
                    "comment": {
                        "value": "**2. Technical Correctness: Related to the point above, there are several places where some additional steps/statements are needed to support the technical claims made in the paper:**\n\n**Proposition 1**. Isn\u2019t the condition for correct prediction simply that margin > 2 * Lipschitz Constant * perturbation radius? ( Assume class 1 is majority at x, class 2 is second highest, then $|f_1(x) - f_1(x + v)| \\leq L ||v|| ) =L \\epsilon$, and $|f_2(x) - f_2(x+v)| \\leq L \\epsilon$. Then, if $f_1(x) - f_2(x) > 2 L \\epsilon$, then $f_1(x+v) > f_2(x +v)$. Why is the constant $\\sqrt{2}$, instead of 2?\n\nThe demonstration that you gave to certify $x$ for classifier $f$ is true when you assume $f_k$ to be $L$ Lipschitz continuous for every $k$. Here we have the assumption that $f$ is $L$ Lipschitz continuous, hence we can obtain a stronger certificate.\n\nTsuzuku et al proposed a tighter version of this bound in Proposition 1 of [1]. \n\n[1] Lipschitz-Margin Training: Scalable Certification of Perturbation Invariance for Deep Neural Networks"
                    }
                },
                "number": 5,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6520/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700100023830,
                "cdate": 1700100023830,
                "tmdate": 1700101727663,
                "mdate": 1700101727663,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "jORFUcSwIi",
                "forum": "C36v8541Ns",
                "replyto": "Bc8HcGvOP9",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6520/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6520/Authors"
                ],
                "content": {
                    "comment": {
                        "value": "###  Appendix P12, Proof of Proposition 3.\n\n### Why is $u \\in \\mathbb{R}^d$ defined? Doesn\u2019t seem to be used in the proof\n\nIt is a typo and has been corrected. It is used in the next proof for the bound on $L(\\tilde{h}_k)$, but for $L(\\tilde{h})$ it is not required.\n \n\n### Are there are several typos confusing $\\delta$ and $\\delta^\\prime$ For instance why is $E_\\delta[v^\\top \\delta h(x + \\delta)] = E_\\delta[v^\\top \\delta^\\prime h(x + \\delta^\\prime)]$  ? The next step then replaces one of the $\\delta$ with  $\\delta^\\prime$, which is unclear too.\n\n$\\delta$ is sampled from a ${\\cal N}(0, \\sigma^2 I)$ distribution. For any vector $v \\in R^d$, such that $|| v ||_2 = 1$, we can write  $\\delta = \\delta^\\perp + \\tilde{\\delta}$, where $\\tilde{\\delta} = (v^T\\delta)v$ and $\\delta^\\perp \\perp v$.\nLet $\\delta' = \\delta^\\perp - \\tilde{\\delta}$.\nAs $\\delta^\\prime \\sim {\\cal N}(0, \\sigma^2 I)$ when $\\delta \\sim {\\cal N}(0, \\sigma^2 I)$\n\n$E_\\delta[v^\\top \\delta h(x + \\delta)] = E_\\delta[v^\\top \\delta^\\prime h(x + \\delta^\\prime)]$.\n\nConcerning the next step, we obtain that $v^\\top \\delta^\\prime = v^\\top (\\delta^\\perp - \\tilde{\\delta}) = 0 - v^\\top \\tilde{\\delta}$, as $\\delta^\\perp$ is orthogonal to $v$.\n\nThus\n$$ E_\\delta[v^\\top \\delta h(x + \\delta)] = - E_\\delta[v^\\top \\delta h(x + \\delta^\\prime)]$$\n\nWe can then write:\n$$\nE_\\delta[v^\\top \\delta h(x + \\delta)] = \\frac{1}{2} (E_\\delta[v^\\top \\delta h(x + \\delta)] - E_\\delta[v^\\top \\delta h(x + \\delta^\\prime)])\n$$\nwe are doing this to use the Lipschitz property of $h$.\n\n### Major 1 Why is $v^\\top \\nabla \\tilde{h} (x) = \\frac{1}{\\sigma^2}E[...]$ Expanding $v^T \\nabla \\tilde{h} (x)$ gives $E[v^T \\nabla h(x + \\delta)]$ it is unclear how to proceed from here : \n\nWe forgot to include Stein's Lemma [Charles M. Stein. Estimation of the mean of a multivariate normal distribution. The Annals of\nStatistics, 9(6):1135\u20131151, 1981] in the proof. It has been added.\n\nTo compute $\\nabla \\tilde{h} (x)$ we use Stein's Lemma :\n\nLemma:  (Stein's lemma) \\\\\nLet $\\sigma > 0$, let $h : R^d \\mapsto R$ be measurable, and let \n$\\tilde{h}(x) = E_{\\delta\\sim {\\cal N}(0, \\sigma^2 I)}[h(x + \\delta)]$. Then $\\tilde{h}$ is differentiable, and moreover,\n$$ \n\\nabla \\tilde{h}(x) = \\frac{1}{\\sigma^2} E_{\\delta\\sim {\\cal N}(0, \\sigma^2 I)}[ \\delta h(x + \\delta)] \\ .\n$$   \n\nWe will add it to the proof.\n\n\n### In the step marked (i) in the proof, is there some typo? $|h(x+\\delta) - h(x+\\delta^\\prime)|$ is replaced by $\\min(1, 2 L)|v^\\top \\delta|$}\n\nIt is explained later in the proof :\n\n\"where $(i)$ follows from the Lipschitz assumption on $h$ and the fact that $\\|\\delta-\\delta'\\| = \\| 2\\tilde{\\delta} \\| = \\|  2(v^T\\delta)v\\| = 2|v^T\\delta|$ and that $|h(x+\\delta) - h(x+\\delta')| \\leq 1$\"\n\n\nUsing that $|h(x+\\delta) - h(x+\\delta^\\prime)| \\leq l(h) \\|\\delta-\\delta'\\|$ and what is mentioned above, we get $|h(x+\\delta) - h(x+\\delta^\\prime)| \\leq 2 l(h) |v^T\\delta|$ and $|h(x+\\delta) - h(x+\\delta^\\prime)| \\leq 1$ as $h(x) \\in [0, 1]$. Finally, it is inferior to the minimum of the two bounds: $|h(x+\\delta) - h(x+\\delta^\\prime)| \\leq \\min(1, 2 l(h))|v^\\top \\delta|$.\n\n### Major 2 In the construction for the lower bound on $J$. But how can the constructed classifier depend on its own Lipschitz constant? Some clarity is needed on why one can do this, and why this classifier exists.}\n\nThere are several points:\n1 - $h_o$ depends on the Lipschitz constant $l(h)$ of $h$.\n2 - the Lipschitz constant of $h_o$ is $l(h)$\n3 - $h_o$ is a piecewise linear function and its slope coefficient is determined by its Lipschitz constant.\nFor instance, any affine function depends directly on its Lipschitz constant $x \\mapsto lx + b$.\nLet us know if it sounds clearer to you."
                    }
                },
                "number": 6,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6520/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700100244501,
                "cdate": 1700100244501,
                "tmdate": 1700103585176,
                "mdate": 1700103585176,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "a6fDIkp6sA",
                "forum": "C36v8541Ns",
                "replyto": "Bc8HcGvOP9",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6520/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6520/Authors"
                ],
                "content": {
                    "comment": {
                        "value": "### 3. Technical Clarity : There are several places where additional clarity would help the reader.\n\n### It is unclear how one obtains (4) by using the bound mentioned in the paragraph preceding it. A few lines would be great for readers not familiar with the proof in Cohen et al. 2019.\nThis is a typo and has been corrected\n\n### The Gaussian Poincare inequality seems to be very similar to other well known concentration inequalities for functions of gaussian random variables $P(|h(Z) - Eh(Z)| > \\delta ) \\leq \\exp(-c \\delta^2 / L(h))$. A brief contextualization would be great. For instance, how does this relate to the standard concentration inequality for Lipschitz functions of sub gaussian random variables: (for a reference, see Theorem 5.2.2 in High Dimensional Probability by Roman Vershynin)\n\nA discussion has been added to the paper in Section 3.2.\nThe sub-Gaussian inequality involving the Lipschtiz constant of $s_k \\circ f$, \nFor $\\delta_0, \\delta_1, \\dots, \\delta_n$ i.i.d standard normal, for all $\\mathrm{shift} > 0$:\n$$    \\mathbb{P}[ \\mathbb{E}[s_k(f(X + \\delta_0))] - \\frac{1}{n} \\sum_{i=1}^n s_k(f(x + \\delta_i)) \\geq \\mathrm{shift}] \\leq \\exp{\\left( -\\frac{\\mathrm{shift}^2}{2 L(s_k \\circ f)^2}\\right)}, \n$$\nThe issue here is that computing $L(s_k \\circ f)$ is NP-hard for common neural networks and the Lipschitz constant as a bound can overestimate the actual empirical variance.\nMost of the time the empirical variance provides a tighter bound on the true variance than $\\sigma^2 L(s_k \\circ f)^2$, which does not include the locality of the input $x$.\n\n\n### Eq (5), where is alpha in the  RHS? Specifically, it is unclear how the  $p_1, p_2$ have any explicit dependence on $\\alpha$. I believe the dependence is that the number of samples n affects both alpha and $p_1, p_2$. But this is not clear at all by looking at (5).\n\nIn our framework the risk $\\alpha$ is taken as a constant and for different sampling numbers it is the risk shift that is going to vary.\nWe have made clear and apparent the dependency of $\\alpha$ on $\\bar{p}_1$ and $\\bar{p}_2$. And on the risk corrected certified radius $R_2(\\bar{p})$."
                    }
                },
                "number": 7,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6520/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700100322201,
                "cdate": 1700100322201,
                "tmdate": 1700103661974,
                "mdate": 1700103661974,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "qI7wulKAyl",
                "forum": "C36v8541Ns",
                "replyto": "Bc8HcGvOP9",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6520/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6520/Authors"
                ],
                "content": {
                    "comment": {
                        "value": "### What are the simplex projections being used in line 4, algorithm 1? The text mentions \u201cfor various projections \u2026 spanning softmax and sparsemax\u201d \u2014 Which projections specifically?\nProjection are ranging $s \\in \\{ sparsemax, softmax, argmax \\}$ and also ranging accross different temperatures from [0.01, 50]. Details has been added in the Section 3.5 and Section 4.\n\n### Now, in order to compute the margin $M_2$, I believe one needs to know the lipschitz constant of the classifier composed with, how is this computed for each simplex projection chosen?\nTo compute the certified radius of the smoothed classifier one needs indeed its Lipschitz constant. For an input $x$, and the smoothed classifier $\\tilde{f}: \\mathbb{R}^d \\mapsto \\mathbb{R}^c$ base on the sub classifier $f$, indeed, $\\tilde{f}(x) := \\mathbb{E}[s (f(x + \\delta))]$. Let us call $p = \\tilde{f}(x)$,  suppose that $p$ is sorted in decreasing order.\nThe certified radius is given by $R_2(p) = \\frac{\\sigma}{2} (\\Phi^{-1}(p_1) - \\Phi^{-1}(p_2) )$. Here the Lipschitz constant of $\\Phi^{-1} \\circ \\tilde{f}$ is $1/\\sigma$ as derived by (Salman et al, 2019).\nThere is no assumption needed on the Lipschitz constant of $s \\circ f$. Therefore, for pure RS the choice of $s$ is not going to change the Lipschitz constant of $\\tilde{f}$.\n\n### Experiments: How is the 1-Lipschitz backbone constructed? This should be detailed as it relates to the main contribution. \n\nWe have taken the Small Sandwich architecture as described, in (Wang & Manchester, 2023). We will add a section in the appendix describing with more detail the architecture and the by-design Lipschitz layer.\n\n### Experiments: The effects of the change in the $\\alpha$ calculation vs the change in the certificate are unclear. In particular, what are the results when the $\\alpha$ calculation in this paper is used on top of Cohen et. al.? Similarly, what are the results when the Clopper-Pearson $\\alpha$ calculation is used on top of this paper\u2019s certificate?\n\nThe Clopper-Pearson confidence interval can only be use for binomial samples, here we smooth scalar outputs. Therefore we can not directly compare the two.\nWe have included an ablation study to measure the impact of Bernstein's inequality over Hoeffding's inequality (previously used in (Lecuyer et al. 2019, Levine et al. 2020).\n\n## Questions \nAt a high level, it would be good to,\n\n### (1) clarify and augment the paper with additional technical details to complete the proofs and correct the typos (details above),\n\nWe have added complementary details to the proof.\n\n### (2) explain the precise mathematical details of the certification procedure from input to certificate (see details in weaknesses above), and\n\nWe have completed the algorithm describing the LVM-RS procedure, see Algo. 1.\n\n### (2) empirically ablate the two components of the proposed approach (see details above).\n\nWe have added Fig.4  to compare Hoeffding's inequality previously used in (Lecuyer et al,2019) and (Levine et al, 2020) with Bernstein's inequality and their impact on risk corrected margin.\nWe have not included the Clopper-Pearson interval as it can only be used on Bernoulli trials and not on scalar outputs.\n\nSparsemax, Argmax, and Softmax and their impact on margin are compared in Fig.5."
                    }
                },
                "number": 8,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6520/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700101303937,
                "cdate": 1700101303937,
                "tmdate": 1700102642179,
                "mdate": 1700102642179,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "JKnGCIq3BK",
                "forum": "C36v8541Ns",
                "replyto": "jORFUcSwIi",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6520/Reviewer_12zu"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6520/Reviewer_12zu"
                ],
                "content": {
                    "title": {
                        "value": "Re: Clarity in Proofs"
                    },
                    "comment": {
                        "value": "Thanks for the clarifications. My concerns are mostly resolved, and I see the corrections in the paper. I think the proof techniques are novel, and am raising my score to reflect this. \n\nI am inclined to raise further if some lingering typos and minor edits are resolved: (1) $J$ has a supremum over $h$, so it is confusing to say $J(.., L(h_k))$. The correct notation would be $J(.., L) = \\sup_{h \\colon L(h) = L} ...$, i.e., the supremum is being taken over all $h$ with a specific lipschitz constant. (2) The previous point will also clear the confusion during the lower bound (3) In the lower bound, there is a typo $1$ to $r$ in the second equality (4) The lipschitz constant of $h_o$ indeed does seem to be $L$, but a small derivation should be included (e.g. for varying across any coordinate other than $x_1$, the function doesn't change, and $L$ is incurred only for $x_1$, there is however a kink at $r/2$ so please ensure that the lipschitz constant is ok there)"
                    }
                },
                "number": 13,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6520/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700563091181,
                "cdate": 1700563091181,
                "tmdate": 1700563091181,
                "mdate": 1700563091181,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "E5Lbdy3fND",
                "forum": "C36v8541Ns",
                "replyto": "Ysfbqt3LEw",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6520/Reviewer_12zu"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6520/Reviewer_12zu"
                ],
                "content": {
                    "title": {
                        "value": "Re: Related Work"
                    },
                    "comment": {
                        "value": "Thanks for incorporating the corrected references. I would like to point out a recent work studying other properties of the base classifier that affect the RS-classifier: [A] Pal et. al. (2023). Understanding Noise-Augmented Training for Randomized Smoothing. Transactions on Machine Learning Research."
                    }
                },
                "number": 14,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6520/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700564747028,
                "cdate": 1700564747028,
                "tmdate": 1700564747028,
                "mdate": 1700564747028,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "a7dx8hTx3m",
                "forum": "C36v8541Ns",
                "replyto": "Bc8HcGvOP9",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6520/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6520/Authors"
                ],
                "content": {
                    "title": {
                        "value": "Update in Proofs"
                    },
                    "comment": {
                        "value": "Thank you for your reply and for your involvement in reviewing our paper.\nFollowing your suggestion, we have changed $J(\\sigma, L(h_k))$ to $J(\\sigma, L)$ where $L$ is the Lipschitz constant of the subclassifier being smoothed. We have corrected the typo in (4) and provided a lemma to justify why the example $h$ used in the lower bound is indeed $L$-Lipschitz. Please see the updates in the proofs in Appendix C.\nWe have also included your suggested reference to the effect of noisy training on the subclassifier over the smoothed classifier in Section 3.1."
                    }
                },
                "number": 15,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6520/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700580952327,
                "cdate": 1700580952327,
                "tmdate": 1700581063076,
                "mdate": 1700581063076,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "nuQpqxyes2",
            "forum": "C36v8541Ns",
            "replyto": "C36v8541Ns",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission6520/Reviewer_2wVc"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission6520/Reviewer_2wVc"
            ],
            "content": {
                "summary": {
                    "value": "This paper identifies a circular dependency between the regularity of the smoothed classifier, the Lipschitz of the base classifier and the variance of gaussian noise in randomized smoothing procedure. Then they propose the LVM-RS framework, given either a Lipschitz constant or variance, one can select the complementary variance or Lipschitiz constant to maximize the synergistic effect of RS and Lipschitz continuity. Experiments show superior performance of the proposed method comparing with RS or deterministic Lipschitz training alone."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "3 good"
                },
                "strengths": {
                    "value": "This paper identifies an interesting circular dependency among each ingredient in the RS procedure, and propose a principled way to improve current certification radius in a zero-shot manner.\n\nIn general, the paper is well written and each statement seems to be well supported by proof, empirical evaluation and intuitive explanation. Especially Figure 1 did a great job in summarizing the contribution of this paper.\n\nExperiment results shows superior performance to the current state-of-the-art methods."
                },
                "weaknesses": {
                    "value": "1. In terms of presentation, I feel the authors could add an overview paragraph for section 3. Sometimes I fail to connect each sub-sections. It may be good to map the flow of section 3 to Figure 1.\n\n2. It will be good to discuss the computational cost of LVM-RS comparing to RS and deterministic Lipschitz."
                },
                "questions": {
                    "value": "1. Is there a typo in Eq 4 where \\leq should be \\geq? Currently it contradicts table 1.\n\n2. In algorithm 1, how many temperature do we need? And how to find those temperature?\n\n3. How much computational cost that is induced by using multiple temperature? How sensitive the certified accuracy is with respect to the corrected margin?"
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "6: marginally above the acceptance threshold"
                },
                "confidence": {
                    "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 4,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission6520/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698945705198,
            "cdate": 1698945705198,
            "tmdate": 1699636732624,
            "mdate": 1699636732624,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "E1e83gFcnF",
                "forum": "C36v8541Ns",
                "replyto": "nuQpqxyes2",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6520/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6520/Authors"
                ],
                "content": {
                    "comment": {
                        "value": "We want to thank the reviewer for their interest, positive remarks, and comments. \n\n**Weakness 1: In terms of presentation, I feel the authors could add an overview paragraph for section 3. Sometimes I fail to connect each sub-section. It may be good to map the flow of section 3 to Figure 1.**  \nSection 3.1 has been removed from the body of the paper as it was not very insightful to the core message of the work.\n\n**Weakness 2: It will be good to discuss the computational cost of LVM-RS compared to RS and deterministic Lipschitz.**  \nIt has been added to the paper in the presentation of the LVM-RS procedure. Time computational costs have been added to the tables.\n\n**Question 1: Is there a typo in Eq 4 where \\leq should be \\geq? Currently, it contradicts Table 1.**  \nWe corrected the typo in Eq. 4., it has been put in Appendix.\n\n**Question 2: In algorithm 1, how many temperatures do we need? And how to find those temperatures?**  \nIn Algo. 1 we use 50 temperatures ranging from $0.1$ to $50$.\nTemperatures are chosen with a grid search. This has been added to the paper, in the description of the experiments.\n\n**Question 3: How much computational cost is induced by using multiple temperatures?**  \nUsing multiple temperatures is going to induce several application of simplex mappings, but the inference in the model and the sampling is done once. Hence it is not the bulk of the computation.\nWe included the time of computation for RS, LVM-RS, and Lipschitz deterministic methods.\n\n**How sensitive the certified accuracy is with respect to the corrected margin?**  \nCertified accuracy accounts for the frequency of input in which the certified radius is above a threshold $\\epsilon$, the certified radius depends linearly on the margin.\nCan you please specify your question?"
                    }
                },
                "number": 3,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6520/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700099826302,
                "cdate": 1700099826302,
                "tmdate": 1700150099764,
                "mdate": 1700150099764,
                "license": "CC BY 4.0",
                "version": 2
            },
            {
                "id": "XWbl1in57n",
                "forum": "C36v8541Ns",
                "replyto": "E1e83gFcnF",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission6520/Reviewer_2wVc"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission6520/Reviewer_2wVc"
                ],
                "content": {
                    "comment": {
                        "value": "Thank you for answering my questions. Reorganizing section 3 has made the message clearer in the paper. For my last question, I wanted to see the certified accuracy curve with respect to the temperature (Fig 5 on page 24). However, it is a minor thing and overall I am ok with accepting the paper."
                    }
                },
                "number": 17,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission6520/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700705284525,
                "cdate": 1700705284525,
                "tmdate": 1700705284525,
                "mdate": 1700705284525,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "rjWdzXzIAM",
            "forum": "C36v8541Ns",
            "replyto": "C36v8541Ns",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission6520/Reviewer_ay9y"
            ],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission6520/Reviewer_ay9y"
            ],
            "content": {
                "title": {
                    "value": "Thank you for your detailed answers"
                },
                "comment": {
                    "value": "The quality of writing has improved significantly in the revised version of the paper. The messages conveyed by the paper are more clear.  \n\nThe experimental results show a significant advantage of the new method, with proper theoretical motivation.\n\nTo the best of my knowledge, this is the first time that Lipschitz constraints and randomized smoothing approaches are combined. This bridge is important for the community interested in robustness certification.  \n\nI improved my score accordingly."
                }
            },
            "number": 12,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission6520/-/Official_Comment"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1700219857988,
            "cdate": 1700219857988,
            "tmdate": 1700219857988,
            "mdate": 1700219857988,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": []
    }
]