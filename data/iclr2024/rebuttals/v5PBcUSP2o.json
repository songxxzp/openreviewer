[
    {
        "title": "Score-based Neural Processes"
    },
    {
        "review": {
            "id": "dRH7Xx8Odc",
            "forum": "v5PBcUSP2o",
            "replyto": "v5PBcUSP2o",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission4510/Reviewer_Gnhg"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission4510/Reviewer_Gnhg"
            ],
            "content": {
                "summary": {
                    "value": "The main objective of this work is to address the issue of intractable log-likelihood in predictive functions within the neural process model. The key contribution of this study is the utilization of the score-matching technique in the output space. To evaluate the effectiveness of this approach, experiments were conducted using both synthetic and real-world datasets."
                },
                "soundness": {
                    "value": "2 fair"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "2 fair"
                },
                "strengths": {
                    "value": "This motivation of this work is clear and the use of score-matching can be beneficial to the NP family.\nThe manuscript is easy to follow, and the experiments are complete in evaluation."
                },
                "weaknesses": {
                    "value": "**1. About the novelty.**\n\nIt seems there already exist a collection of methods combining the score-matching in neural processes or other meta learning models [1-3]. Advantages of this work over previous ones are not clear in some sense.\n\n[1] Dutordoir V, Saul A, Ghahramani Z, et al. Neural diffusion processes[J]. arXiv preprint arXiv:2206.03992, 2022.\n\n[2] Pavasovic, K. L., Rothfuss, J., & Krause, A. (2022). MARS: Meta-learning as score matching in the function space. arXiv preprint arXiv:2210.13319.\n\n[3] Mathieu E, Dutordoir V, Hutchinson M J, et al. Geometric Neural Diffusion Processes[J]. arXiv preprint arXiv:2307.05431, 2023.\n\n**2. About the experimental evaluation.**\n\nThe use of ISAB modules inevitably increase model complexity in comparison to vanilla NPs, where MLPs are used. I notice that authors claim the comparable model complexity are set in running different baselines. However, the encoder design or model complexity is not well explained. \n\nAnother concern lies in the set-up about the context and the target. On page 4, it seems the context and the target are disjoint while the context is the subset of the target in general NPs.\n\nMeanwhile, the evaluation in image completion is not clear about the number of context points."
                },
                "questions": {
                    "value": "See the weakness part."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "5: marginally below the acceptance threshold"
                },
                "confidence": {
                    "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 1,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission4510/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698118257754,
            "cdate": 1698118257754,
            "tmdate": 1699636427595,
            "mdate": 1699636427595,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": []
    },
    {
        "review": {
            "id": "HzLLThdSex",
            "forum": "v5PBcUSP2o",
            "replyto": "v5PBcUSP2o",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission4510/Reviewer_RB5P"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission4510/Reviewer_RB5P"
            ],
            "content": {
                "summary": {
                    "value": "In this paper, the authors propose score-based neural processes, a type of meta-learning model which combines neural processes with score-based modelling.\nThey propose corrupting the output values with a Gaussian corruption process and using an attention-based neural network to denoise them.\nThey suggest an approximation for obtaining a conditional score from a learnt joint score (theorem 1), and use this for conditional sampling.\nIn experiments across a range of different regression problems, the authors find that their score-based NP compares favourably to existing approaches."
                },
                "soundness": {
                    "value": "2 fair"
                },
                "presentation": {
                    "value": "2 fair"
                },
                "contribution": {
                    "value": "2 fair"
                },
                "strengths": {
                    "value": "In my view, the strengths of this work are as follows:\n\n__Interesting idea for a flexible model:__\nCombining score-based models with NPs is an interesting approach for building a flexible meta-learning model.\nThis appears to be a positive aspect of this work, although I have substantial doubts about its originality and significance, given that Dutordoir et al. (2023) already introduced a method which appears to be extremely similar.\nTherefore, while the idea presented in this paper is very interesting, I also have some doubts about the originality of this submission (see weaknesses section below).\n\n__Range of experiments:__\nThe authors present a range of experiments including synthetic data, EEG data, images on grids, fluid flows and weather data, to assess the performance of their method.\nThe score-based NP proposed by the authors seems to perform well across these data modalities (although the quality of the baselines used in some of these experiments does not seem to be particularly good; see weaknesses section below).\nThe variety in these experiments is a strong point of this work."
                },
                "weaknesses": {
                    "value": "In my assessment, the main weaknesses of this paper are as follows:\n\n__Similarity to Dutordoir et al. (2023):__\nThe present work appears highly similar to the work of Dutordoir et al. (2023), who introduced Neural Diffusion Processes (NDPs).\nIn an NDP, the target and context output variables (and optionally also the input variables) are corrupted according to a diffusion process, and then denoised using a reverse process where the score function is parameterised using an attention based network whose parameters are learnt from the data.\nThe present work does not seem any different from Dutordoir et al. in this respect (see for example eq. 10, which shows that the same denoising score matching loss is used as the training objective).\nThe main difference of this work to that of Dutordoir et al. seems to be that in the present work, the authors adopt an unconventional approach for sampling from the diffusion model (see Theorem 1 and eq. 7).\nThis seems like a minor difference between these works: conditional samples can be drawn from an NDP and associated predictive log-likelihoods can be modelled using standard sampling techniques, without approximations (see questions section below).\nTherefore, I do not clearly see how this work differentiates itself from Dutordoir et al. in a substantial way.\nCan the authors comment on any aspects that differentiate the present work?\n\n__Theoretical content does not seem fully rigorous:__\nThe theoretical content of the paper does not seem fully rigorous to me.\nFor example, in section 3.1 the authors state an \"approximate expression\" (eq. 7) for the conditional score.\nHowever, the sense in which this expression is approximate is not made rigorous neither in the theorem statement nor in its proof in the apprendix.\nI would recommend that the authors clarify the sense of this approximation sign in both the theorem and the proof.\nLooking at the proof in appendix A.1, it is clear for example that the authors are approximating an integral with a single monte carlo sample (eq. 13), and then taking the logarithm of this estimate later on (eq. 14).\nHowever, this procedure gives a clearly biased estimate of the score in eq. 14 (first line), which is glossed over using an \"approximately equal\" sign.\nI recommend that the authors should try to make their theoretical claims more precise as, in its current form, the rigour of the paper is not fully satisfactory.\n\n__Quality of baselines:__\nIt appears that the quality of the baselines to which the SNP is compared to does not appear to be particularly strong, and the extent to which these were carfeully trained and tuned seems insufficient.\nFor example, the ConvNP appears to perform unexpectedly poorly across a range of the tasks explored.\nFurther, in some occasions, the SNP performs much better than all other models by a suspiciously large margin.\nSee for example Table 3, where the SNP appears to outperform all other baselines by around 6-7 nats, which is an extremely large margin.\nThis raises questions about the quality of the experiments and whether enough care was taken to implement, train and tune the baselines to be competitive with the SNP.\nSince there is also no code submitted along with the paper which would be sufficient to check and reproduce these results, the baseline comparisons are not very convincing.\n\n\n__Summary:__\nDue to the above considerations on the originality of the work and the quality of the baselines used in the experiments I have recommended the paper for a score of 3.\nHowever, I invite the authors to comment on this response, particularly with any clarifications they might have on distinguishing features of their work which I may have missed (and remain open to adjusting my score accordingly)."
                },
                "questions": {
                    "value": "## Questions\n\n__Why not just learn the conditional score?__\nThe authors seem to have gone through a convoluted procedure in order to model the conditional score of the corrupted target variables given the context data and the target inputs (see eq. 7).\nInstead of making an approximation (which also does not appear to be fully rigorous to me), why not just learn the conditional score of the corrupted target outputs given uncorrupted target outputs?\nConcretely, at training time, one could: (1) separate a task into a context and a target set; (2) corrupt the target; (3) compute a score matching denoising loss for the corrupted target outputs given the context outputs (which are provided to the model).\nWorks such as [Batzolis et al. (2021)](https://arxiv.org/abs/2111.13606) have shown that one can learn the conditional score by passing the conditioning variables as inputs to the score model.\n\n__Why not just sample using the joint score?__\nAn alternative to the above for conditional sampling is to use the joint score, and a standard method such as in-painting together with a predictor-corrector sampler (Song et al. 2020).\nThis would allow to sample from the conditionals given just a trained joint score model, without requiring any approximations.\n\n__Unexpectedly poor ConvNP performance:__\nIn numerous parts of the experimental section, the performance of the ConvNP is significantly worse than that of other models, such as the ANP.\nThis is surprising given that previous works such as Foong et al. (2020), or Bruinsma et al. (2023) have found that the ConvNP significantly outperforms the ANP (see for example the evaluation tables in the appendix of Bruinsma et al., which are fairly extensive).\nCan the authors comment on these results and are they confident about their soundness?\n\n\n## Recommendations and changes\n\n__Baseline models and implementations:__\nRelated to the above issue on the unexpectedly poor performance of the ConvNP, in appendix C.6, the authors report that in their experiments they have used the models provided in the Neural Process Family of Dubois et al. (2020).\nHowever, a more extensive set of baseline implementations and carefully picked model parameters (which is also more recent than the repository above) is the [neuralprocesses](https://github.com/wesselb/neuralprocesses) repository.\nTwo options for cross-checking the validity of their experiments and soundness of their baselines are to use the official code releases of the baselines in question, or the aforementioned repository, which contains more carefully implemented versions of the baselines.\n\n__Using improved samplers:__\nIn this work, the authors are using an Euler-Maruyama sampler for integrating the reverse SDE.\nHowever, better sample quality has been reported in previous works when using (slightly) more sophisticated sampling schemes, such as predictor-corrector sampling.\nHave the authors considered using such samplers?\nThese seem to be a relatively easy way to obtain higher quality samples with relatively small implementation overheads.\n\nBelow are some further minor recommendations to improve the manuscript.\nThese include more minor clarifications, typographical corrections and a few phrasing suggestions.\n\n- In section 3, the authors write \"Regarding the second term, which necessitates estimating the distribution for $\\mathbf{y}_{\\mathcal{T}}$...\"\nIt is not clear what the authors mean to say with this expression and the following equation.\nWould it be possible to clarify on this point?\n- In section 3.1 the authors write \"Remarkably, this variance is intricately linked to the time progression of the perturbation process within the VP SDE.\"\nIt is not clear to me what the authors mean to say here.\nWould it be possible to clarify this point here and in the main text?\nMore generally, in this paragraph, the authors are trying to justify their approximation in eq. 7, but the argument provided is not convincing.\n- Typo change \"Previous study (...)\" to \"Previous studies (...).\"\nIs the $q$ distribution defined in eq. 8 an approximation to some other quantity, and how is it derived?\n- Change \"Definition 1 of context permutation invariance...\" to \"Definition 1...\" and \"Definition 2 of target permutation equivariance...\" to \"Definition 2...\"\n- In the same definitions, correct \"then the model is permutation invariant\" to \"then the model is permutation invariant\" and similarly for the equivariant definition.\n- Link theorem 2 to the associated proof in the appendix.\n- Modify \"This represents a significant advancement in our work.\" to \"This is a significant contribution of our work.\""
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "3: reject, not good enough"
                },
                "confidence": {
                    "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 2,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission4510/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698754750002,
            "cdate": 1698754750002,
            "tmdate": 1699636427521,
            "mdate": 1699636427521,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": []
    },
    {
        "review": {
            "id": "isIcHXP1Au",
            "forum": "v5PBcUSP2o",
            "replyto": "v5PBcUSP2o",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission4510/Reviewer_EWhp"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission4510/Reviewer_EWhp"
            ],
            "content": {
                "summary": {
                    "value": "This work proposes to utilise score-based diffusion models for meta-learning. In this regard, the authors adhere to the conventional meta-learning framework, where the training datasets are divided into context and target subsets consisting of input-output data samples. However, instead of following the approach of modelling the conditional distribution of the output in the target subset given the target input and context input-output data samples, a standard approach in Neural Processes, the authors employ a diffusion-based generative modelling approach (Song et al., 2020b) to approximate the distribution of output variables. During the data generation (the reversal of the stochastic diffusion) process, the method relies on the score of the marginal distribution of the output variables to generate the output from noise. As the primary theoretical contribution of the work, the authors derive an approximate representation of the score function for the conditional distribution of (perturbed) output variables. To train a predictor of the score function values, the authors also introduce a computationally efficient neural attention module within the feed-forward architecture of the score-predicting neural network. In the numerical experiments, the authors compare their method to several approaches based on neural processes. They benchmark on both synthetic and real datasets to evaluate the performance and effectiveness of the proposed method."
                },
                "soundness": {
                    "value": "2 fair"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "2 fair"
                },
                "strengths": {
                    "value": "The work addresses a significant area of machine learning.\n\nThe approach adopted by the authors appears to be novel within the area of meta learning.\n\nThe authors provide a theoretically grounded approximation and factorisation of the score function. \n\nThe employed attention mechanism alleviates the quadratic computational complexity w.r.t. the number of data points.\n\nIn comparison to various neural processes approaches, the empirical results demonstrate a competitive performance of the proposed method in terms of various metrics."
                },
                "weaknesses": {
                    "value": "I am not sure how the proposed method may fall under the category of neural processes. While neural processes are probabilistic models that explicitly model the conditional distribution of target output variables given target input and context input-output pairs, the proposed method leverages score-based diffusion models for meta-learning, which are fundamentally different from neural processes. Given this, empirical comparisons only involving meta-learning or few-shot approaches based on neural processes are insufficient in my opinion.\n\nThe proposed method does have a restriction that it requires the same number of (context+target) data points across datasets, which limits its applicability to tasks involving datasets of equal length, such as multivariate time-series or images. This restriction raises concerns about whether the proposed method (or meta-learning) should be considered as the default approach for tasks considered in the paper such as image inpainting and time-series forecasting. For example, there are competitive diffusion-based methods for image processing. Similarly, in the field of time-series forecasting, there exist few-shot/meta-learning methods that have demonstrated competitiveness and may be better suited for such tasks."
                },
                "questions": {
                    "value": "Can the authors clarify how they compute predictive (log-)likelihood for the proposed SNP approach?\n\nWhy is equation 8 chosen to be a Gaussian distribution?\n\nWhat was the size and dimensionality of synthetic datasets ?"
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "5: marginally below the acceptance threshold"
                },
                "confidence": {
                    "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 3,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission4510/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698797033792,
            "cdate": 1698797033792,
            "tmdate": 1699636427379,
            "mdate": 1699636427379,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": []
    }
]