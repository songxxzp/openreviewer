[
    {
        "title": "JointNet: Extending Text-to-Image Diffusion for Dense Distribution Modeling"
    },
    {
        "review": {
            "id": "ojvLNVoKW5",
            "forum": "kv5xE1p3jz",
            "replyto": "kv5xE1p3jz",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission3497/Reviewer_4SM3"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission3497/Reviewer_4SM3"
            ],
            "content": {
                "summary": {
                    "value": "The paper introduces JointNet, a novel neural network architecture that seeks to model the joint distribution of images and a dense modality like depth maps. Originating from a pre-trained text-to-image diffusion model, the architecture generates a replica of the initial network for the dense modality, integrating it densely with the RGB branch. Simultaneously, it locks the RGB branch during fine-tuning, ensuring the preservation of the generalization capabilities of the pre-trained model. JointNet\u2019s efficacy is validated across various applications, including joint RGBD generation, dense depth prediction, and 3D panorama generation, positioning the paper as a noteworthy contribution to the field of joint distribution modeling. It highlights a resourceful and efficient strategy that capitalizes on pre-trained models to enhance performance in computer vision tasks."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "2 fair"
                },
                "strengths": {
                    "value": "- The proposed methodology introduces a novel technique for modeling the joint distributions of images and dense labels.\n- JointNet successfully maintains the intricate details in the depth maps, showcasing its refinement capabilities.\n- The qualitative results are impressive, especially on the panoramic image and depth generation."
                },
                "weaknesses": {
                    "value": "- The performance enhancement provided by the proposed network is marginal. According to Table 1, while JointNet outperforms Direct Extend in terms of IS, it falls short in FID and CLIP scores. Considering the network design is a primary contribution of this paper and differs significantly from Direct Extend, the results from Table 1 suggest only a slight improvement in performance due to the proposed network structure.\n- Table 2 reveals that JointNet on its own yields poorer results compared to MiDaS. Although performance improves when combined with MiDaS, the enhancement is minimal, as seen in metrics such as AbsRel (improving from 0.0568 to 0.0561) and a decrease in RMSE (from 0.0601 to 0.0634). These results question the effectiveness of the proposed methods.\n- Given the marginal performance difference between the proposed method and MiDaS, one could generate images using diffusion models, input them into MiDaS, and obtain high-quality images and depth maps, raising questions about the necessity of RGBD generation methods."
                },
                "questions": {
                    "value": "- Does MiDaS+JointNet in Table 2 refer to initially extracting the depth map using MiDaS and subsequently refining it with JointNet? Could you please clarify?\n- Are the results depicted by JointNet in Figure 4 and \u2018Ours (depth)\u2019 in Figure 3 associated with 'JointNet (Ours)' or 'MiDaS+JointNet' as mentioned in Table 2?\n- If these results pertain to JointNet, the discrepancy between its quantitative performance in Table 2 (lower than MiDaS\u2019s results) requires further explanation."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "5: marginally below the acceptance threshold"
                },
                "confidence": {
                    "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 1,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission3497/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698627011147,
            "cdate": 1698627011147,
            "tmdate": 1699636302886,
            "mdate": 1699636302886,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "iCSAPQx0EO",
                "forum": "kv5xE1p3jz",
                "replyto": "ojvLNVoKW5",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission3497/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission3497/Authors"
                ],
                "content": {
                    "comment": {
                        "value": "\\* We recommend reviewers to view the rebuttal in our global response, which is uploaded as the __supplementary material__. Figures and tables are also available.\n\nWe thank the reviewer for the acknowledgement of the novelty of the network and finetuning design and the impressive qualitative quality. Here we address the questions raised by the review as follows. \n\n__Quantitative Evaluation of Joint Generation.__ In the analysis of the quantitative evaluation in the main paper, we attribute the marginal gap to the fact that the global image descriptor used by FID cannot capture the difference of the details. We also find that these metrics cannot capture further improvement of image quality. For example, SDXL is known to have much better generation quality, but achieves FID of 15.03 which is not significantly lower than other reported numbers. The authors of SDXL also extensively analyzed this issue in their technical report (Appendix Sec. F).\n\nTo this end, we conduct user study on overall quality of generated RGBD images. We compare JointNet with LDM3D, _Direct Extend_, and _ControlNet + Direct Extend_, which accepts joint modality by ControlNet and outputs as _Direct Extend_. We prepare 100 text prompts sampled from COCO validation set and let user choose the overall best generated RGBD image in terms of image-text consistency, image-depth consistency and the quality of image and depth themselves. The results are shown in Tab. 2. Among all the surveyed methods, JointNet achieves the highest satisfaction rate. We notice that LDM3D achieves the second highest score, which contradicts the qualitative and quantitative conclusion in the paper. After interviewing the participants, the main reason is that text-image consistency plays an important role in their decision making, which is LDM3D's strength, while the blurred image and the artifacts in the depth maps are not significant if the participants do not zoom in the samples. \n\n__Clarification of MiDaS+JointNet.__ Yes. The input image is resized to 384x384 and the corresponding depth map in the same size is estimated by MiDaS. Then we use JointNet to refine the depth conditioned on the image in the original size in a tile-based manner. \n\nThe _Ours (depth)_ in Fig. 3 (main paper) refers to JointNet. But both image and depth are generated so it is not relevant to the image-to-depth task. The _JointNet (Ours)_ in Fig. 4 (main paper) is from JointNet on its own. In Fig. 4 (main paper) we only select samples suitable for visualization. As shown in Fig. 2, there is a large amount of samples where only background area has ground truth but the background in the estimated depths are not distinguishable. And most large errors come from these kind of samples. For the samples shown in the main paper, the qualitative results are comparable. We will further analysis the quantitative results in the next paragraph. \n\n__Analysis of the quantitative image-to-depth results.__ In Sec. 5.2 (main paper), we have discussed the quantitative results of the image-to-depth task. First of all, because the training data is prepared by MiDaS, we only expect the quality of diffusion depths to be comparable. One possible reason for the worse evaluation of JointNet is that MiDaS is directly trained on MegaDepth dataset while our model does not. Also, for the samples similar to what are shown in Fig. 2, it is difficult to align the estimation and ground truth, and thus the calculated error is random. \n\nFor the depth refinement task (_MiDaS+JointNet_), we can observe qualitative improvement in Fig. 5 (main paper). One possible reason for the marginal quantitative improvement is that object boundaries, where most improvements happen, are filtered out in the ground truth and thus not counted in the statistics. \n\n__Necessity of JointNet.__ If we only consider joint generation, Stable Diffusion followed by MiDaS can achieve the same task, and is already a widely used strategy. But because diffusion models essentially capture the distribution of the data, so it can do more than sample generation, e.g. SDEdit for image editing and tile-based generation for high resolution. Similarly, JointNet can additionally do depth/joint refinement and panorama generation compared with the two-step system. And it is not meaningless to be able to perform multiple tasks by a single model, which is the trend for very large deep learning models. Also, in a concurrent work Wonder3D, which uses cross-modality attention to keep the alignment of generated RGB and normal maps for text-to-3D generation, the authors also discuss the differences between the two-step strategy (Sec. 5.6 and Fig. 7 in their paper) and show the benefits of joint generation."
                    }
                },
                "number": 5,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission3497/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700721436242,
                "cdate": 1700721436242,
                "tmdate": 1700721436242,
                "mdate": 1700721436242,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "GHRqFaHaGZ",
            "forum": "kv5xE1p3jz",
            "replyto": "kv5xE1p3jz",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission3497/Reviewer_cBx7"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission3497/Reviewer_cBx7"
            ],
            "content": {
                "summary": {
                    "value": "This paper proposed JointNet for modelling the joint distribution of images and dense information, e.g., depth and normal maps. JointNet is extended from a pre-trained text2img diffusion model by adding a copy of the original network as the new dense modality branch, densely connected with the RGB image branch, and while training the original network is locked. The proposed method extends the text2img diffusion models to more applications such as RGB-D generation, depth precautions, etc. Experiments show the improvements compared with previous methods."
                },
                "soundness": {
                    "value": "2 fair"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "2 fair"
                },
                "strengths": {
                    "value": "This paper proposed a joint network that differs from previous fine-tuning methods or control-net which shows some novetly. The idea of using joint and RGB information bidirectional is natural and interesting. The instruction of the network architecture and training details are proposed. The proposed method could be used for other applications such as depth prediction."
                },
                "weaknesses": {
                    "value": "Although the method compared with other methods on different applications to show the effectiveness. However, the experiments to show ablation study is not clear and also the comparison with control-net (the one that inspired the proposed method) is not clear."
                },
                "questions": {
                    "value": "- How is the comparison between control net with the proposed method? Although the two methods focus on different targets and applications, it is still possible to test on the same task, e.g., change the noise from joint to regular RGB task, or evaluate on the inpainting task that works for both architecture. \n- It is not clear if combine (a) and (b) in Figure 2 works well or not, e.g., use the same control net architecture but change the output as the joint and RGB, as based on Table 1 the numerical results are comparable and not that significant improved. \n- The ablation study is not sufficient, it is good to show different strategies or detailed architectures."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "6: marginally above the acceptance threshold"
                },
                "confidence": {
                    "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 2,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission3497/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698638244647,
            "cdate": 1698638244647,
            "tmdate": 1699636302805,
            "mdate": 1699636302805,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "nj708lGNTG",
                "forum": "kv5xE1p3jz",
                "replyto": "GHRqFaHaGZ",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission3497/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission3497/Authors"
                ],
                "content": {
                    "comment": {
                        "value": "\\* We recommend reviewers to view the rebuttal in our global response, which is uploaded as the __supplementary material__. Figures and tables are also available.\n\nWe thank the reviewer for the acknowledgement of the novelty of the network and finetuning design, and the capability of handling various of downstream tasks. Here we address the questions raised by the review as follows.\n\n__Comparison with ControlNet.__ In the paper we compare our method with ControlNet and also the depth conditioned Stable Diffusion v2.0 on the depth-to-RGB generation task qualitatively. To make the comparison more comprehensive, we additionally conduct quantitative comparison: we sample 30000 image-text pairs from the COCO validation dataset, estimate depth of them by MiDaS, perform depth-to-RGB generation and compare the FID between the ground truth and the generated images. The results are shown in Tab. 1. The depth conditioned SD v2.0 (_SD v2.0d_) achieves the best performance among all, but the finetuning scale is much larger than other two methods. Our method shows comparable result with ControlNet, which is coincide with the qualitative observation in the paper. The marginal quantitative gap is negligible because of the randomness of generation. Also in the answer to reviewer _4SM3_ we have an analysis of the relation between the FID score and the actual generation capability. \n\n__Ablation Study of Combining ControlNet and Direct Extend.__ We conduct the mentioned experiments and compare its joint generation quality with LDM3D, Direct Extend and JointNet via user study, whose details and results can be found in the answer to reviewer _4SM3_. The satisfaction rate of _ControlNet + Direct Extend_ and JointNet is 20.2% and 29.1% respectively, showing the effectiveness of our finetuning method. \n\nThe results is as expected because handling the output part is the key of finetuning a good joint generation model. As analyzed in the second paragraph of Sec.~3.1 of the main paper, directly extending the output will lead to catastrophic forgetting. We also show the training progression of this setup in Fig. 1 together with _Direct Extend_ and JointNet. We can see the RGB generation quality is degraded similarly to _Direct Extend_. Also we found a concurrent work Wonder3D, which uses cross-modality attention to keep the alignment of generated RGB and normal maps for text-to-3D generation, gives a similar analysis towards the _Direct Extend_ strategy."
                    }
                },
                "number": 4,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission3497/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700720720357,
                "cdate": 1700720720357,
                "tmdate": 1700720720357,
                "mdate": 1700720720357,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "prJvplwId2",
            "forum": "kv5xE1p3jz",
            "replyto": "kv5xE1p3jz",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission3497/Reviewer_UNzu"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission3497/Reviewer_UNzu"
            ],
            "content": {
                "summary": {
                    "value": "The authors introduce a neural network architecture for modeling the joint distribution of images and an additional \"dense modality\". The leading example of a dense modality is a depth map. Measurement of depth maps has important applications in designing self-driving cars, among many other use cases.  \n\nThe procedure takes as an input a pre-trained text-to-image diffusion model. This model is copied and used as an initialization to model the additional dense modality. The weights of the original model are then locked and used to generate the RGB component. The copied model is then trained on a relevant dataset. In this way, the good performance of the input model for the RGB component is maintained."
                },
                "soundness": {
                    "value": "4 excellent"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "4 excellent"
                },
                "strengths": {
                    "value": "The paper is very clearly written and provides a practical solution to an important problem. Their evaluation and assessment of their method is extensive and credible. They make several comparisons to alternative procedures, and provide a convincing argument that their approach is appropriate."
                },
                "weaknesses": {
                    "value": "As the authors note, the procedure requires doubling the size of the input diffusion model. This structure becomes cumbersome if it is repeated for several modalities. I encourage future work on assessing the performance of a single additional model for the generation of several modalities."
                },
                "questions": {
                    "value": "I have have no questions at this time."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "8: accept, good paper"
                },
                "confidence": {
                    "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                },
                "first_time_reviewer": {
                    "value": "Yes",
                    "readers": [
                        "ICLR.cc/2024/Conference/Program_Chairs",
                        "ICLR.cc/2024/Conference/Submission3497/Senior_Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission3497/Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission3497/Reviewer_UNzu"
                    ]
                }
            },
            "number": 3,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission3497/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698768087104,
            "cdate": 1698768087104,
            "tmdate": 1699636302716,
            "mdate": 1699636302716,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "7rd6YhTE3k",
                "forum": "kv5xE1p3jz",
                "replyto": "prJvplwId2",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission3497/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission3497/Authors"
                ],
                "content": {
                    "comment": {
                        "value": "\\* We recommend reviewers to view the rebuttal in our global response, which is uploaded as the __supplementary material__. Figures and tables are also available.\n\nWe thank the reviewer for the appreciation of the contribution and clear paper writing. Here we address the questions raised by the review as follows.\n\n__Additional Computational Complexity for Joint Modalities.__ Thanks for the suggestion on the possible future improvement and we agree with it. Because the additional branch needs to be trained to adapt to a new domain after all, preserving the original knowledge is less important than the RGB branch, and thus we can apply the direct extend strategy to merge multiple modalities into the joint branch. One disadvantage is the reduced flexibility. If each modality has its own JointNet, users can pick only the needed ones and use them in a plug-and-play manner just like multi-ControlNet."
                    }
                },
                "number": 3,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission3497/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700720216923,
                "cdate": 1700720216923,
                "tmdate": 1700720216923,
                "mdate": 1700720216923,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    },
    {
        "review": {
            "id": "w5VrVHbe5K",
            "forum": "kv5xE1p3jz",
            "replyto": "kv5xE1p3jz",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission3497/Reviewer_yguJ"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission3497/Reviewer_yguJ"
            ],
            "content": {
                "summary": {
                    "value": "The method tries to use text to image diffusion models to address different applications in vision such as monocular depth estimation."
                },
                "soundness": {
                    "value": "2 fair"
                },
                "presentation": {
                    "value": "2 fair"
                },
                "contribution": {
                    "value": "2 fair"
                },
                "strengths": {
                    "value": "+ The work seems to be well-motivated and has addressed an important field."
                },
                "weaknesses": {
                    "value": "- The work is not evaluated that well. For example, monocular depth estimation is not compared with several SOTA methods.\n\n- The work is inferior compared to the other methods.\n\n- The work tries to do many things but is irrelevant in all of them. \n\n- The work needs to be presented well with proper comparisons and illustrations."
                },
                "questions": {
                    "value": "What is the primary contribution of this work?\n\nWhat benefit it has for the user provided that this method is not giving best results for all the applications mentioned?"
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "3: reject, not good enough"
                },
                "confidence": {
                    "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 4,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission3497/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1699275036298,
            "cdate": 1699275036298,
            "tmdate": 1699636302639,
            "mdate": 1699636302639,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": [
            {
                "id": "nS6XhWfZup",
                "forum": "kv5xE1p3jz",
                "replyto": "w5VrVHbe5K",
                "signatures": [
                    "ICLR.cc/2024/Conference/Submission3497/Authors"
                ],
                "readers": [
                    "everyone"
                ],
                "writers": [
                    "ICLR.cc/2024/Conference",
                    "ICLR.cc/2024/Conference/Submission3497/Authors"
                ],
                "content": {
                    "comment": {
                        "value": "\\* We recommend reviewers to view the rebuttal in our global response, which is uploaded as the __supplementary material__. Figures and tables are also available. \n\nWe thank the reviewer for the acknowledgement of the motivation of this work and the importance of the task. Here we address the questions raised by the review as follows. \n\n__Clarification on the Contribution.__ We would like to clarify that the core idea is using joint distribution modeling to construct a large vision model capable of various of downstream tasks, instead of pushing the SOTA of each single downstream task. Because training large models is more and more expensive, it is desirable to design a general training objective for a multi-tasking model. For the performance gap of image-to-depth task, because our depth training data is prepared by the mentioned SOTA depth estimation network and we do not directly train on (the training split of) the depth datasets the benchmark uses, our model may not be able to outperform the SOTA depth estimator, which is indeed a limitation. Possible improvements include adding the depth datasets for training and finetuning the VAE for the joint modalities. More explanation can be found in the answer to reviewer _4SM3_. \n\nOn the other hand, the joint diffusion model unlocks several new usage such as tile-based consistency handling for high-res RGBD generation (e.g., RGBD panorama), which cannot be achieved by the traditional discriminative model of monocular depth estimation. To summarize, we believe our work demonstrates the potential of the joint training scheme, and there are possible ways of improvement to further push the performance on each downstream task."
                    }
                },
                "number": 2,
                "invitations": [
                    "ICLR.cc/2024/Conference/Submission3497/-/Official_Comment"
                ],
                "domain": "ICLR.cc/2024/Conference",
                "tcdate": 1700720107862,
                "cdate": 1700720107862,
                "tmdate": 1700720107862,
                "mdate": 1700720107862,
                "license": "CC BY 4.0",
                "version": 2
            }
        ]
    }
]