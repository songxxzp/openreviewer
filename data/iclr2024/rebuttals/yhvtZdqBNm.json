[
    {
        "title": "Pruning Attention Heads with Almost-sure Sparsity Targets"
    },
    {
        "review": {
            "id": "Kmz8WDLDnt",
            "forum": "yhvtZdqBNm",
            "replyto": "yhvtZdqBNm",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission7325/Reviewer_WBEj"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission7325/Reviewer_WBEj"
            ],
            "content": {
                "summary": {
                    "value": "This work introduces the concept of almost-sure sparsity for attention-head-pruning of language models. The gate parameters are jointly trained with the main network parameter, under the proposed PASS loss with the gate closing, gate opening, and non-binary probabilities. Furthermore, the proposed Concentrator loss ensures that the retained attention heads are primarily concentrated in a limited number of layers, leading to better latency improvements."
                },
                "soundness": {
                    "value": "2 fair"
                },
                "presentation": {
                    "value": "2 fair"
                },
                "contribution": {
                    "value": "2 fair"
                },
                "strengths": {
                    "value": "- Given the popularity of Large Language Models (LLMs) and Vision Transformers (ViTs), the compression of transformer-based models has emerged as a topic of significant interest.\n- Considering existing structured pruning works that overlook the latency, I appreciate the proposed 'Concentrator', which boosts inference speedups."
                },
                "weaknesses": {
                    "value": "- The original networks chosen for pruning (i.e., a 6-layer transformer and a 12-layer BERT (perhaps BERT-base?)) seem outdated. Could its applicability be demonstrated on LLMs (at least, 7B-LLaMA)? A potential approach might involve integrating or contrasting the proposed work with LLM-Pruner (https://arxiv.org/abs/2305.11627).\n- The performance gains in Table 1 are not particularly impressive, considering additional hyperparameters. How did the authors choose the value of lambda and lambda_c in (9)? Why was CoFi-Pruning (https://arxiv.org/abs/2204.00408) not included in the comparison?\n- Analyzing which parts are pruned would be interesting, to understand the network behavior.\n- Please include the number of parameters and the performance of the original network."
                },
                "questions": {
                    "value": "Please see the Weaknesses part."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "details_of_ethics_concerns": {
                    "value": "No ethics review needed."
                },
                "rating": {
                    "value": "3: reject, not good enough"
                },
                "confidence": {
                    "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 1,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission7325/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698592328131,
            "cdate": 1698592328131,
            "tmdate": 1699636875876,
            "mdate": 1699636875876,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": []
    },
    {
        "review": {
            "id": "mNFIXNMqUf",
            "forum": "yhvtZdqBNm",
            "replyto": "yhvtZdqBNm",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission7325/Reviewer_BTZ5"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission7325/Reviewer_BTZ5"
            ],
            "content": {
                "summary": {
                    "value": "This paper proposes a novel method to prune the attention heads in a Transformer model which results in impressive speedups in the attention layer during inference. The proposed method, PASS (Pruning with Almost Sure Sparsity targets) jointly learns the distribution of gates acting on top of each of the attention heads during the training / fine-tuning stage. The gates control whether a specific attention head will be pruned or not. To improve the inference efficiency further, the paper uses a concentrator loss to reduce the number of layers with unpruned heads, developing the PASSCONC (PASS with concentrator) framework. Clipping and selective re-opening strategy of closed gates during training results in better optimization and makes the proposed approach work well with respect to the speedup. The speedup gains on translation task using encoder-decoder architecture and on BLUE tasks using BERT are impressive."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "4 excellent"
                },
                "contribution": {
                    "value": "3 good"
                },
                "strengths": {
                    "value": "- The paper tackles an important problem of pruning models to obtain sparser architectures that are fast during inference, especially given the large scale deployment of Transformer-based models.\n- The proposed approaches - PASS and PASSCONC are novel in my opinion, and one of the only approaches that don't have to use a threshold probability for the gates that are being trained because of the almost sure sparsity constraints during training.\n- The paper builds the theory coherently by first building the $\\mathcal{R_{pass}}$ objective that avoids the local optimum issues of the $\\mathcal{R_{base}}$ loss objective. Subsequently, $\\mathcal{R_{passconc}}$ is proposed that reduces the number of layers with unpruned heads resulting in further speedups over PASS. Finally, clipping of $\\phi_{i}$'s to avoid zero gradients and selective reopening of closed gates using confidence scores improves the training process.\n- The empirical results on IWSLT translation dataset and the four GLUE benchmark tasks are impressive compared to the baselines."
                },
                "weaknesses": {
                    "value": "- A couple of claims in the introduction are wrong in my opinion. Firstly, several followup works to [1] and [2] have shown that attention is not really interpretable, for example see [3]. Secondly, the 50% number for inference latency in the attention layer is highly dependent on the model size and sequence length used for the model. For instance, a 1.5B parameter transformer model with 2k sequence length can have only around 25% of its computation being spent in the attention layer. For larger models, this percentage is reduced further. This is because the feedforward layer has huge weight matrices that are sharded across multiple accelerators which results in huge communication costs. I believe this blanket 50% number line should be removed.\n- The notion of almost-sure sparsity is not exactly novel and the first contribution listed in the paper feels bloated. The words used in other works might be different but sparsity research on skewing the probability distribution towards either 0 or 1 does exist.\n- I believe a proof/derivation is required for the claim of the gradient descent direction of $\\mathcal{R_{base}}$ mentioned above equation 7 on page 5. Can the authors please add this proof in the appendix?\n- In my opinion, the accuracy/BLEU score results should be reported for the unpruned model baseline too. This would give an idea of the difference between the pruned and the unpruned models.\n- Why did the authors only report numbers on 4 tasks in the GLUE benchmark, given that it is composed of 10 tasks. WNLI and AX have very high variances, so they can be skipped, but the numbers should be reported for the other 4 tasks too.\n- The empirical section is a bit weak. How does the proposed approach scale to larger models and decoder-only models? Can the authors at-least report performance of some QA tasks with large sequence length like HotpotQA or summarization tasks on datasets like Pubmed/arxiv etc.\n- Some important ablation studies comparing PASS and PASSCONC are missing like how many layers have unpruned attention heads in each of the experiments with the introduction of the concentrator loss?\n\n[1]: Voita et al., Analyzing multi-head self attention: Specialized heads do the heavy lifting, the rest can be pruned, 2019.\n\n[2]: Clark et al., What does BERT look at? an analysis of BERT's attention, 2019.\n\n[3]: Pruthi et al., Learning to Deceive with Attention-Based Explanations, 2020."
                },
                "questions": {
                    "value": "I have asked most of my questions in the weakness section, but here is one additional suggestion: Please add the meaning of each datapoint in Figure 6. I can infer that it represents the value $K$ (top-$K$ attention heads), but it requires context to figure out. Also add the datapoint on the accuracy of the unpruned model in Figure 6.\n\nIf the authors can address the questions in the weakness section and incorporate some of the suggestions, I am willing to increase my score."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "5: marginally below the acceptance threshold"
                },
                "confidence": {
                    "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
                },
                "code_of_conduct": {
                    "value": "Yes"
                },
                "first_time_reviewer": {
                    "value": "Yes",
                    "readers": [
                        "ICLR.cc/2024/Conference/Program_Chairs",
                        "ICLR.cc/2024/Conference/Submission7325/Senior_Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission7325/Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission7325/Reviewer_BTZ5"
                    ]
                }
            },
            "number": 2,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission7325/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1699068034915,
            "cdate": 1699068034915,
            "tmdate": 1699636875771,
            "mdate": 1699636875771,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": []
    },
    {
        "review": {
            "id": "LkFSKD5989",
            "forum": "yhvtZdqBNm",
            "replyto": "yhvtZdqBNm",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission7325/Reviewer_fbDA"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission7325/Reviewer_fbDA"
            ],
            "content": {
                "summary": {
                    "value": "This paper proposes a generic framework for pruning with almost-sure sparsity with Hard Concrete distribution, which also mitigate the train-testing inconsistency. \nFor further speedup, this paper also introduces a concentrator regularization to facilitate entire head pruning at some layers. \nThe proposed approach achieves competitive model acceleration while maintain comparable latency / BLEU scores, over the leading approaches, based on experiments on encoder-decoder (ED) Transformer and BERT."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "3 good"
                },
                "strengths": {
                    "value": "1. The proposed PASS and PASSCONC framework is effective in pruning away the redundant heads. \n2. This paper also introduce the theoretical analysis on the formulation of PASS and PASSCONC. \n3. Especially at the high sparsity level, PASS and PASSCONC provide significant speedup while preserving competitive accuracy / BLEU scores."
                },
                "weaknesses": {
                    "value": "1. Clipping and selective reopening strategy are an important part to facilitate efficiency improvement. But it's not clear how these are implemented. Could you add some details or formulate the strategy?\n2. It's not clear what's the impact of the training-testing inconsistency."
                },
                "questions": {
                    "value": "1. How would the proposed approach scale to large and deeper layers?\n2. What are the compute overheads with proposed approach as compared to the simpler yet effective DSP framework?"
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "6: marginally above the acceptance threshold"
                },
                "confidence": {
                    "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 3,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission7325/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1699074935396,
            "cdate": 1699074935396,
            "tmdate": 1699636875617,
            "mdate": 1699636875617,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": []
    },
    {
        "review": {
            "id": "D3323siD6V",
            "forum": "yhvtZdqBNm",
            "replyto": "yhvtZdqBNm",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission7325/Reviewer_K7dC"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission7325/Reviewer_K7dC"
            ],
            "content": {
                "summary": {
                    "value": "The paper proposes a regularizer that induces prunable attention heads in transformer models. The regularizer encourages the attention heads' gating variables to have high probabilities of taking binary values, 0/1. This regularizer is applied jointly with the training loss of transformers. Moreover, the authors extend the framework by encouraging all heads in a layer to be prunable, leading to skippable attention blocks, and further reduced latency.\n\nExperiments compare against several other regularizers, and seem to suggest the proposed regularizer is the best."
                },
                "soundness": {
                    "value": "3 good"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "2 fair"
                },
                "strengths": {
                    "value": "1. The paper makes some connection between learning the gating variables and evidence lower bound, which seems interesting.\n2. The illustrative analysis on why adopting Eq (7) instead Eq (6) is interesting."
                },
                "weaknesses": {
                    "value": "1. In terms of methodology, (Voita et al 2019) also uses hard concrete distribution to model the probability of a closed gate. The only difference is in the form of regularizer. It is less clear why the proposed regularizer is better than Voita's, though empirically it seems so. With that been said, novelty of this paper is also limited.\n\n2. Other than just reporting test metrics, the author should show the pattern of learned gate variables, and draw some insights there. This is especially important for showing the difference against (Voita et al 2019). Also, how concentrated are the prunable heads due to PASSCONC? Are they distributed at the bottom, middle, or top of the transformer layers?\n\n3. The clip and re-open trick seems a very crucial trick. Could it also be applied to (Voita et al 2019), would that also bring some gain on (Voita et al 2019)'s method?"
                },
                "questions": {
                    "value": "See weakness 2 and 3.\n\nAnother question, (Voita et al 2019)'s method doesn't specify sparsity level directly. So how to make sure the method yield a pruning pattern with pre-defined sparsity level? Footnote 5 isn't self-contained enough."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "5: marginally below the acceptance threshold"
                },
                "confidence": {
                    "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 4,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission7325/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1699485106456,
            "cdate": 1699485106456,
            "tmdate": 1699636875517,
            "mdate": 1699636875517,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": []
    }
]