[
    {
        "title": "A Causal Ordering Prior for Unsupervised Representation Learning"
    },
    {
        "review": {
            "id": "pR2U7nJaiM",
            "forum": "p5oXp5Kvq5",
            "replyto": "p5oXp5Kvq5",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission6924/Reviewer_5aVx"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission6924/Reviewer_5aVx"
            ],
            "content": {
                "summary": {
                    "value": "In recent years, the theory of identification for causal representation learning has come into prominence. This work proposes extensions to this theory and builds methods from the theory and empirically validates the proposal. The work makes following crucial assumptions to arrive at the identification guarantees: i) mixing map is piecewise affine, ii) the latent causal model is additive noise model, iii) the latent causal model is also expressed as a mixture of Gaussians. Under these assumptions, authors leverage two key recent results \u2013 a. Kivva et al., which establishes affine identification for gaussian mixture latents and piecewise affine mixing maps, and  b. Rolland et al., which provides a score based approach for causal discovery, to establish representation identification guarantees."
                },
                "soundness": {
                    "value": "1 poor"
                },
                "presentation": {
                    "value": "2 fair"
                },
                "contribution": {
                    "value": "2 fair"
                },
                "strengths": {
                    "value": "Along the axis of originality and significance, I believe the paper has some strengths. The problem that the authors have picked is a very important one. We need more work and ideas on how to move beyond standard independence assumptions on the latents. The authors considered the pure observational data setting, which is quite a challenging one.  The idea to combine the contributions from Kivva et al., and Rolland et al., to achieve identification with observational data only is interesting and practical."
                },
                "weaknesses": {
                    "value": "I have some major concerns with the paper and these concerns would fall under the quality axis and clarity axis. I elaborate on these below. \n\n1. **Issue with Proposition 1:** \nThe proof of Proposition 1 is not clear and seems incorrect. The loss function is summed from i=1 to d? It is not clearly written it says i to d. The term inside the summation can be undefined for non leaf nodes. The numerator in the logarithm would be non-zero but the denominator would be infinite if the denominator sums over terms that include a leaf node. \nThe proposition relies on results Rolland et al. However, it seems to use it incorrectly. Rolland\u2019s result assumes that the joint variables are Markov w.r.t a certain DAG. However, for a general set of latents z that are learned such a condition need not hold to begin with. \n\n2.  **Issue with Assumption 5:**  In Assumption 5, authors require the ANM latent model to be expressed as a mixture model. Below the assumption the authors justify it to be a relatively benign assumption as mixture models have arbitrary expressive power. However, there is a crucial point that is missed here. To express any distribution, the number of components need to go to infinity. However, the result from Kivva et al.  is only for finite mixtures. \n\nNow that means that the result requires that latent ANM model to be expressed as a finite mixture. The authors should provide examples of the data generation process that follows this assumption. If I were to follow the proof in the Appendix and reverse engineer a DGP that is compatible with it, there are some contradictions that we run into. From equation (9), the adjacency matrix dictates the covariance matrix. From the LHS in equation (9), it follows that conditioned on the parents the variable is independent of the ancestors. From the RHS in equation (9), it is not clear if the same independence condition holds. Rest of the proof relies on equation (9) and I am unable to trust the proof due to lack of clarity. I request the authors to construct a clear data generation process. \n\nConsider the set of latents Z1,Z2,Z3,Z4 and H. The DAG governing their relationships is Z1\u2192 Z2\u2192Z3\u2192Z4  and H\u2192Z1, H\u2192Z2, H\u2192Z3.  We can write an SCM for this situation as follows \n\nZ1 <-- H + N1, Z2 <--Z1+ H + N2, Z3 <-- Z2 + H+ N3, Z4 <-- Z3 + H + N3. \n\nIf H is a discrete random variable and all other variables are Gaussians, then Z1,Z2,Z3,Z4 conditional on H=h, follows a Gaussian distribution. This is a type of SCM consistent with RHS of equation (9).  Note that in the above DAG, Z3 conditioned on Z2 is not independent of Z1 as there is a path from Z3 to Z1 through H. The LHS of equation (9) requires that each Z_i is independent of its ancestors conditioned on its parents in Z. Thus there is a contradiction. \n\n\nMinor remark: In related works, you say Yang et al. show that it is possible to achieve identifiable models using volume preserving transforms. There are errors in that result -- see https://openreview.net/pdf?id=REtKapdkyI."
                },
                "questions": {
                    "value": "In the weakness section, I have highlighted the key issues. The authors can respond to those."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "3: reject, not good enough"
                },
                "confidence": {
                    "value": "5: You are absolutely certain about your assessment. You are very familiar with the related work and checked the math/other details carefully."
                },
                "code_of_conduct": {
                    "value": "Yes"
                }
            },
            "number": 1,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission6924/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698700844905,
            "cdate": 1698700844905,
            "tmdate": 1699636806519,
            "mdate": 1699636806519,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": []
    },
    {
        "review": {
            "id": "zmWdWT5G2E",
            "forum": "p5oXp5Kvq5",
            "replyto": "p5oXp5Kvq5",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission6924/Reviewer_4VV5"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission6924/Reviewer_4VV5"
            ],
            "content": {
                "summary": {
                    "value": "This paper is on learning causal representations of data in an unsupervised manner. A recent line of work in deep learning has proposed to learn data representations, either supervised or unsupervised, which are additionally causal. In this work, the representations are assumed to have a structural causal model on them. Furthermore, the authors make the same assumptions made in Kivva et al., that the latent priors form a Gaussian mixture model and that the mixing function is assumed to be non-linear piecewise affine. This model has universal approximation properties and identifiability results for such models have been shown before in (Kivva et al.). The authors extend this theory using additional assumptions (however, see weaknesses below), to a slightly better class of transformations.\n\nTo learn this, the authors propose the coVAE model to learn these representations. Using inspiration from prior work (Rolland et al.), the authors use a Hessian property to enforce acyclicity of the latent additive noise model. This lets them recover the causal ordering among the latents, and similar ideas as (Rolland et al.) are used. Experiments on synthetic datasets and simple image datasets (Causal3DIdent and variants of MorphoMNIST) validate their identifiability results (which are measured via MCC metrics and a new COD metric). The work is written well however it does not have many significant contributions either theoretically or experimentally."
                },
                "soundness": {
                    "value": "2 fair"
                },
                "presentation": {
                    "value": "2 fair"
                },
                "contribution": {
                    "value": "1 poor"
                },
                "strengths": {
                    "value": "- The research direction is important because causal representation learning is a promising extension of neural methods that aims to leverage additional causal information for robustness and generalization.\n\n- The proposed method coVAE shows improved MCC and R^2 metrics over prior experimental baselines, i.e. improved recovery of meaningful latents."
                },
                "weaknesses": {
                    "value": "- The abstract claims that all provable identifiable methods rely on additonal information, however the main work (Kivva et al.) that the authors cite, show that we do not need additional information, therefore, this claim should be revised.\n\n- It's hard to understand how Assumptions 2, 3, 5 together work. They seem unrelated assumptions with different motivations -- Assumption 2, 3 on latent SCMs is more directly related to the paper since it's inherently causal; however, Assumption 5 on GMMs is needed for identifiability due to some prior works. Could the authors precisely describe what kind of GMMs satisfy this sort of SCM structure?\n\n- The theory is incremental compared to (Kivva et al.), The main contribution of this work is that linear identifiability is strengthened to identifiability up to permutation block diagonal transformations. Could the authors comment on why this improvement is desirable in the context of latent variable models?\n\n- Since the main thrust of this work is experimental, I'd liked to see more a more comprehensive evaluation of coVAE. For instance, additional larger datasets and also potentially ablation studies (the dependence on alpha) would sigificantly strengthen the work."
                },
                "questions": {
                    "value": "Please address the questions above.\n\nTypo: In the 2nd line of proof in A.2, \"invertable\" -> \"invertible\""
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "3: reject, not good enough"
                },
                "confidence": {
                    "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
                },
                "code_of_conduct": {
                    "value": "Yes"
                },
                "first_time_reviewer": {
                    "value": "Yes",
                    "readers": [
                        "ICLR.cc/2024/Conference/Program_Chairs",
                        "ICLR.cc/2024/Conference/Submission6924/Senior_Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission6924/Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission6924/Reviewer_4VV5"
                    ]
                }
            },
            "number": 2,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission6924/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698785771385,
            "cdate": 1698785771385,
            "tmdate": 1699636806368,
            "mdate": 1699636806368,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": []
    },
    {
        "review": {
            "id": "w6aJ6KrUzc",
            "forum": "p5oXp5Kvq5",
            "replyto": "p5oXp5Kvq5",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission6924/Reviewer_fvDC"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission6924/Reviewer_fvDC"
            ],
            "content": {
                "summary": {
                    "value": "The paper suggests a new method to learn latent causal structures based on a more complex mixture of Gaussian prior in the latent space and a causal order loss based on the Jacobian of the score function. They study their approach on different datasets and they provide some identifiability results."
                },
                "soundness": {
                    "value": "2 fair"
                },
                "presentation": {
                    "value": "3 good"
                },
                "contribution": {
                    "value": "3 good"
                },
                "strengths": {
                    "value": "- The paper studies an important problem, i.e., how to learn latent variables with causal relations. \n- It nicely combines ideas from different fields: Identifiability of latent variable model with piecewise linear mixing, Gaussian mixture models, score based causal discovery.\n- The main paper is generally easy to follow \n- Experimental results look generally promising."
                },
                "weaknesses": {
                    "value": "- There do not seem to be any completely novel ideas in the paper (score based causal discovery, gmm latent prior, identifiability without auxiliary information). (this is a minor point)\n- For the identifiability part, there are some questions regarding the combination of assumptions (see questions).\n- The proofs in Appendix A could be much clearer (see questions), and, more generally, all math parts should be checked carefully (being slightly imprecise can make it very difficult to follow the details).\n- There are some questions regarding the metrics used in the experiments\n- References to 2023 works on CRL seem to be mostly missing. (just a todo, not relevant for the score)"
                },
                "questions": {
                    "value": "- Note that while GMM can approximate any distribution, the identifiability result in Kivva et al. (2022) does not hold for arbitrary distributions (i.e., the closure of GMMs). So in practice, it becomes harder to identify more complex mixtures. (I did not find any error in this direction in the paper but in the introduction it is emphasized that GMMs can approximate any distribution which might be not the right way to think about this result).\n\n- In relation to the previous point, I think that Assumption 5 needs stronger justification. Linear Gaussian SCMs clearly fall into this class, but what about further examples? Is there a closer connection beyond the generic approximability statement? \n\n- When reading Definition 2 it sounds like the set $\\mathcal{P}$ just agrees with all permutation matrices, or is there some implicit assumption about the block structure hidden in $\\tau$? (all permutation matrices are block diagonal permutation matrices with one block) This also has consequences for Definition 3.\n\n- From a theoretical standpoint, the causal order viewpoint seems less elegant than, e.g., stating identifiability of variables and graph up to permutations (relabeling).\n\n- Check statement of Theorem 2, if $l$ is really linear you just reduce from affine to linear, do you mean diagonal?\n\n- I could not follow the proof in Appendix A. There seem to be substantial inaccuracies, e.g., $G_1\\Sigma_j$ is generally not symmetric and therefore no covariance matrix. Also the general reasoning is not clear and a proof should not consist of 3 lines followed by a one page 'Example' paragraph. Given my understanding what could be done here is to combine existing results to conclude identifiability up to linear maps followed by an identifiability result for linear mixing function (e.g., Varici et al.). Then the only problematic point would be the SCM distribution = GMM. But this does not seem to be the case, here. It looks like some kind of GMM decomposition for an SCM is proved but this must be clarified and proved beyond a two node example. It is not clear how the affine ambiguity is removed in the proof.\n\n- It should be clarified whether the used causal order loss is consistent when not only trying to find leaf nodes given $(Z_1,\\ldots,Z_d)$\nbut given only linear mixtures $AZ$.\n\n- I am a bit puzzled by the COD metric used in the experiments. My understanding is the following: You learn a latent structure, d then you apply Causal discovery on the latent space and finally evaluate the indicated COD metric? However, this seems to have substantial shortcomings as it can be tricked easily, e.g., learning a random iid. representation (like the Darmois construction) results in a COD of 0. In particular, training a VAE such that the learned embeddings match the isotropic Gaussian prior in the latent space should result in an empty causal graph (independent variables) and therefore perfect COD, even though no information about the causal structure were obtained. Under the assumption that this is correct so far, the experiments provide no evidence that the true causal structure is found but potentially the causal order loss just results in representations where no arrows in the wrong direction are found, however, the arrows do not recover the ground truth structure. More evidence is needed to show that the approach helps to learn causal structures.\n\n- generally COD are tiny, so the estimated graphs seem very sparse (compared to the number of errors made in the simpler causal discovery problem). What method was used to estimate the graph?\n\nMinor points:\n\n- In Definition 1: $\\Leftrightarrow \\to \\Leftarrow$.\n\n- Eq (3) can be simplified by removing the inverse.\n\n-Below Eq. (13) the order is given by an unordered set\n\n- I am not very convinced by the discussion of the number of valid causal orderings. Why is this important? Once the variables are found causal discovery can (in principle) be used to find the true causal structure. Also, being much smaller than all permutations is not very helpful because this number will generally be growing superexponential (at least for sparse DAGs)."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "5: marginally below the acceptance threshold"
                },
                "confidence": {
                    "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                },
                "first_time_reviewer": {
                    "value": "Yes",
                    "readers": [
                        "ICLR.cc/2024/Conference/Program_Chairs",
                        "ICLR.cc/2024/Conference/Submission6924/Senior_Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission6924/Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission6924/Reviewer_fvDC"
                    ]
                }
            },
            "number": 3,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission6924/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698791252469,
            "cdate": 1698791252469,
            "tmdate": 1699636806260,
            "mdate": 1699636806260,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": []
    },
    {
        "review": {
            "id": "BUiTVQYx3N",
            "forum": "p5oXp5Kvq5",
            "replyto": "p5oXp5Kvq5",
            "signatures": [
                "ICLR.cc/2024/Conference/Submission6924/Reviewer_icPp"
            ],
            "nonreaders": [],
            "readers": [
                "everyone"
            ],
            "writers": [
                "ICLR.cc/2024/Conference",
                "ICLR.cc/2024/Conference/Submission6924/Reviewer_icPp"
            ],
            "content": {
                "summary": {
                    "value": "The work introduces a method for identifiable unsupervised representation learning, where the latent representations are encouraged to follow an ordering consistent with the (non-unique) causal ordering of a DAG. This is done by building on the work by Kivva et al., 2022, which guarantees identifiability of latent representations following a Gaussian mixture model (GMM). While (Kivva et al., 2022) prove identifiability up to affine transformations, this work shows that, by additionally enforcing a causal ordering, the ambiguity can be further reduced to a _\"permutation block-diagonal transformation\"_ followed by scaling and translation."
                },
                "soundness": {
                    "value": "2 fair"
                },
                "presentation": {
                    "value": "1 poor"
                },
                "contribution": {
                    "value": "2 fair"
                },
                "strengths": {
                    "value": "The paper attempts to provide a new method for causal representation learning, combining different results from the causal discovery and representation learning literature in a novel way."
                },
                "weaknesses": {
                    "value": "1. Theorem 2 is, on its own and in its current formulation, incomplete. Supposedly, it exploits the results in (Kivva et al., 2022). However, the statement says, _\"invertible mixing functions\"_. For any invertible mixing functions, without further assumptions (none are stated in Thm. 2), it is possible to build counterexamples to identifiability in the i.i.d. setting based on the Darmois construction [1]. It also appears non-rigorous to state that the mixing functions are not _\"identically distributed\"_: the authors might be referring to the push forward through two different mixing functions of the latent distributions relative to the two models, which may generate equal distributions. \n\n2. The mean correlation coefficient values are extremely low compared to other works on identifiable representation learning (I'm referring to MCC with respect to the ground truth variables). Even if the main contribution of the paper is meant to be theoretical, I find this result problematic. See for example the MCC results in [2, 3], the former with latent linear causal models, the latter with general mixing and general latent models but with a known causal graph: these are consistently significantly higher (~0.9) than the results reported in this paper, where it is unclear whether the reported values are better than what a non-identifiable baseline would achieve (see, e.g., [3], fig 4(b)).\n\n3. In my understanding, the paper's main contribution is to show that, by enforcing causal ordering as described in sec. 4.1, the ambiguity up to an affine transformation in the results by Kivva et al. (2022) can be further reduced to the permutational block diagonal equivalence. This could, in itself, be considered an interesting finding. The authors' motivation lies however in CRL, so whether, and under which conditions, the latent space can be considered causal, and precisely what _\"causal insights\"_ may be drawn from the representations, are critically important aspects. This is, in my view, poorly discussed in the paper. For example, in [2-6], the latent models and variables are deemed causal in the sense that the modularity of causal mechanisms is exploited: i.e., _\"it is possible to intervene on some of the mechanisms while leaving the others invariant\"_ [3]. In turn, the assumptions underpinning the causal interpretation of the conditional distributions in this observational setting are not spelled out in this work.\n\n4. For instance, a more in-depth discussion of latent causal graph discovery should be delved into more thoroughly. Section 4.2 reports that _\"given the organised latent representations, the causal relationships can be estimated as commonly done in causal discovery\"_, proceeding to cite references on the PC algorithm among others. Little discussion is dedicated to whether the assumption of causal discovery methods (such as the PC algorithm) may be expected to hold in the latent space: in particular, the faithfulness assumption---see [7]. In order to infer the DAG from (conditional independences of) the latent distribution, in a purely observational setting, it seems like the faithfulness assumption should be required; but as far as I could see, this is specified nowhere in the text. Moreover, since this assumption may be problematic in practice even for observed variables [8], a discussion of this would be required.\n\n5. Table 1 contains some inaccuracies, and it lacks several references. For example, [9] is related to counterfactual data (it is cited elsewhere in the paper); whereas (Lippe et al., 2022) does not require counterfactual data, but rather temporal sequences: also [10] should feature in the same category. Besides (Ahuja et al., 2022), [2-6] are examples of interventional CRL (with different assumptions---e.g., linear latent SCM [2], known graph [3], linear mixing [4], genericity and latent faithfulness [5], etc). \n\n6. Minor: The reference to (Higgins et al., 2022) on page 1 is misplaced, since said paper, which introduces a symmetry-based view on disentanglement, does not fit well with the rest of the references on _\"unveiling statistically independent latent variables\"_.\n\n7. Minor: There are several typos, e.g., \"invertable\"->\"invertable\" in multiple places; \"hessian\"->\"Hessian\" on page 5\n\nReferences:\n\n[1] Hyv\u00e4rinen, A., & Pajunen, P. (1999). Nonlinear independent component analysis: Existence and uniqueness results. Neural networks, 12(3), 429-439.\n\n[2] Buchholz, Simon, et al. \"Learning Linear Causal Representations from Interventions under General Nonlinear Mixing.\" NeurIPS 2023.\n\n[3] Liang, Wendong, et al. \"Causal Component Analysis.\" NeurIPS 2023\n\n[4] Squires, Chandler, et al. \"Linear Causal Disentanglement via Interventions.\" (2023).\n\n[5] von K\u00fcgelgen, Julius, et al. \"Nonparametric Identifiability of Causal Representations from Unknown Interventions.\" NeurIPS 2023.\n\n[6] Varici, Burak, et al. \"Score-based causal representation learning with interventions.\" arXiv preprint arXiv:2301.08230 (2023).\n\n[7] Spirtes, Peter, Clark N. Glymour, and Richard Scheines. Causation, prediction, and search. MIT press, 2000.\n\n[8] Uhler, Caroline, et al. \"Geometry of the faithfulness assumption in causal inference.\" The Annals of Statistics (2013): 436-463.\n\n[9] Von K\u00fcgelgen, Julius, et al. \"Self-supervised learning with data augmentations provably isolates content from style.\" Advances in neural information processing systems 34 (2021): 16451-16467.\n\n[10] Lachapelle, S\u00e9bastien, et al. \"Disentanglement via mechanism sparsity regularization: A new principle for nonlinear ICA.\" Conference on Causal Learning and Reasoning. PMLR, 2022."
                },
                "questions": {
                    "value": "- Please explain Remark 1. What does this mean in practice? What is the tradeoff which operates here? What is sacrificed by making this choice?\n\n- In Theorem 2, what does $\\hat{\\tau}$ represent? How can the _\"data distribution\"_ have a causal ordering (that should only pertain to the latent distribution)? \n\n- Given that the model identifiability in Thm. 2 requires two of the (non-unique) valid causal orderings, this seems to encode some knowledge on the latent DAG (as also mentioned in App. D). I would like to ask whether the authors could comment on this."
                },
                "flag_for_ethics_review": {
                    "value": [
                        "No ethics review needed."
                    ]
                },
                "rating": {
                    "value": "5: marginally below the acceptance threshold"
                },
                "confidence": {
                    "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
                },
                "code_of_conduct": {
                    "value": "Yes"
                },
                "first_time_reviewer": {
                    "value": "Yes",
                    "readers": [
                        "ICLR.cc/2024/Conference/Program_Chairs",
                        "ICLR.cc/2024/Conference/Submission6924/Senior_Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission6924/Area_Chairs",
                        "ICLR.cc/2024/Conference/Submission6924/Reviewer_icPp"
                    ]
                }
            },
            "number": 4,
            "invitations": [
                "ICLR.cc/2024/Conference/Submission6924/-/Official_Review",
                "ICLR.cc/2024/Conference/-/Edit"
            ],
            "domain": "ICLR.cc/2024/Conference",
            "tcdate": 1698843379334,
            "cdate": 1698843379334,
            "tmdate": 1699636806152,
            "mdate": 1699636806152,
            "license": "CC BY 4.0",
            "version": 2
        },
        "responses": []
    }
]