[
    {
        "id": "oIGJt9izyF",
        "forum": "oNlPtI7QfQ",
        "replyto": "oNlPtI7QfQ",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission3168/Reviewer_nXVu"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission3168/Reviewer_nXVu"
        ],
        "content": {
            "summary": {
                "value": "This paper introduces an embedding for DNA sequences based on transformer models. This embedding allows a distance between two DNS fragments of potentially differing lengths to be computed. Using this distance, an alignment algorithm is constructed under the usual seed-align framework, with the embedding distance taking the place of the seeding step. The embedding quality is assessed against other transformer models on synthetic reads."
            },
            "soundness": {
                "value": "1 poor"
            },
            "presentation": {
                "value": "3 good"
            },
            "contribution": {
                "value": "3 good"
            },
            "strengths": {
                "value": "The problem being tacked is an important one, and the proposed architecture does appear to have some benefits over existing transformer models. The ability to handle varying fragment lengths makes the method very flexible."
            },
            "weaknesses": {
                "value": "The experimental validation is the weak point of this paper. There are claims of efficiency yet no experimental evidence of any resource requirements and scaling such as time and memory. Furthermore, comparitive experiments are against existing transformer models and hence show that the embedding is superior to existing ones for alignment, but not that this is a good aligner overall. There are no comparisons against standard alignment algorithms (though they are referenced). There are no experiments on real data, or evaluation of the effect on downstream variant calling.\n\nGeneralisation to other species is very interesting, however the chosen species are all closely related.\n\nThe constraint in equation 4 cannot strictly hold on real data due to homology and repeat regions."
            },
            "questions": {
                "value": "- Have you evaluated the method on real data?\n- What are the runtime resource requirements?\n- Does the model generalise to less related organisms? Presumably there will be some dependence on degree of homology."
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "3: reject, not good enough"
            },
            "confidence": {
                "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        },
        "number": 1,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission3168/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698361784398,
        "cdate": 1698361784398,
        "tmdate": 1699636264342,
        "mdate": 1699636264342,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "rtlSgl8l0r",
        "forum": "oNlPtI7QfQ",
        "replyto": "oNlPtI7QfQ",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission3168/Reviewer_o7rD"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission3168/Reviewer_o7rD"
        ],
        "content": {
            "summary": {
                "value": "This manuscript tries to solve an alignment problem. The input are a set of short DNA sequences (reads) and a long reference sequence. The task is to find the location of each short read on the reference sequence. This manuscript proposes to solve this matching problem by projecting both short reads and reference (sub-)sequence to a shared embedding space such that reads originated from the same reference sequence region are close to each other in the embedding space. For a new read, its embedding is first calculated using the NN, after that it searches for the nearest K reference fragments in the embedding space. Exact alignment using classical Smith-waterman algorithm is between the given read and each of the K nearest reference fragments to identify the final mapping position of the read.\n\nRegarding implementation, the authors first split the reference sequence (length = 3Gb) into fragments (length = 1250bp). Then each fragment and their substrings (reads) are assigned the same label, which (a batch of several fragments and their substrings) is then fed into a transformer with a contrastive loss. The trained network can then project a given DNA sequence to the embedding space (dimension = 384). \n\nAlthough I think the idea is somewhat interesting, the authors may want to address the following points in the next version.\n1. Provide support to the hypothesis that a fragment and its subsequences are close in the embedding space. Figure 1 only contain the fragments, but it should also contain random subsequences. \n2. Make the notations more readable, e.g. in Eq. 2, q is used in SA(r,R). Eq. 6, really difficult to guess the meanings.\n3. Comparison with classic aligner such as BWA or bowtie. I will expect a >99.9% mapping rate of BWA or bowtie for the used data.\n4. Expand the comparison dimensions. Only Recall is used, could add precision, mapping rate etc.\n5. Compare on real data. The simulated data is too clean. Phred 30 is already 99.9% identical to the original sequence, that is 250/1000=0.25 bp mutation per read. It will be nice to see how the method works on real data where the error rate is higher and the read length varies.\n6. Provide details of the transformer. Do you do paddings to short reads?\n7. What happens to negative samples, i.e. a random read that is not similar to any reference fragment? How do you decide the boundaries of a reference fragment in the embedding space?\n8. Reorder the figures so it flows with the text.\n9. Appendix A, add legend for the lines\n10. Appendix B, B.3 the complexity is G, not log(G) as you have to compare with all reference fragments."
            },
            "soundness": {
                "value": "2 fair"
            },
            "presentation": {
                "value": "2 fair"
            },
            "contribution": {
                "value": "2 fair"
            },
            "strengths": {
                "value": "NA"
            },
            "weaknesses": {
                "value": "NA"
            },
            "questions": {
                "value": "NA"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "3: reject, not good enough"
            },
            "confidence": {
                "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        },
        "number": 2,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission3168/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698794296923,
        "cdate": 1698794296923,
        "tmdate": 1699636264246,
        "mdate": 1699636264246,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "PDLvj6NbeX",
        "forum": "oNlPtI7QfQ",
        "replyto": "oNlPtI7QfQ",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission3168/Reviewer_ModJ"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission3168/Reviewer_ModJ"
        ],
        "content": {
            "summary": {
                "value": "The paper presents EMBED-SEARCH-ALIGN, a method for DNA sequence alignment using transformer models.  Unlike traditional methods use algorithmic solutions like indexing and efficient searching to align reads. This paper proposes a different paradigm using transformer models to learn representations of DNA reads and reference genome fragments, and performing alignment based on similarity of these embeddings.\n\nThe main contributions of the proposed architecture are as  follows. First, the authors use a DNA sequence encoder DNA-ESA that is trained using self-supervision and contrastive loss to produce DNA sequence embeddings optimized for alignment. Next, the authors use a DNA vector store to enable efficient nearest neighbor search across the entire reference genome for each read. Finally, the authors formulate the sequence alignment as an \"embed-search-align\" task using the encoder and vector store.\n\nIn the experiments, the authors demonstrate that DNA-ESA can align 250 bp reads to the human reference genome with over 97% accuracy, exceeding several transformer baseline models. The approach also demonstrates ability to generalize - a model trained only on Chr 2 can still align reads from other chromosomes and even other species.\n\nThe paper argues this approach mitigates limitations of prior works on transformer models for genomics and provides sequence representations suitable for alignment. It also enables \"flat search\" over reads and reference fragments of different lengths. Future work is discussed to improve computational efficiency."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "3 good"
            },
            "contribution": {
                "value": "3 good"
            },
            "strengths": {
                "value": "+ The authors present a novel approach to align sequence reads which can provide new possibilities for DNA sequence representation and search.\n+ The proposed DNA-ESA encoder learns effective sequence embeddings for alignment, and outperforms several baseline transformer models designed for specific genomics tasks.\n+ The approach is promising and demonstrates ability to generalize to new sequences not seen during training, like different chromosomes and even new species. Furthermore, formulating alignment as embed-search-align could enable new capabilities like \"flat search\" over reads and reference fragments of different lengths."
            },
            "weaknesses": {
                "value": "- I felt that the paper is a very dense read for the general ML audience at ICLR for folks who do not have DNA sequencing background, and it will be great to make the paper more accessible.\n- The embedding approach currently shows promising results on simulated data, but needs more evaluation on real sequencing data.\n- The performance for short reads is worse than long reads, given that short reads are more commonly used, this may affect how this system can be actually used.\n- Limited demonstration of applications in downstream genomic tasks."
            },
            "questions": {
                "value": "1) Can the authors comment on how this paper is a good fit for ICLR, and the steps the author may take to make this paper more accessible to the ML audience?\n2) How does the model perform on real world sequencing data?"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "6: marginally above the acceptance threshold"
            },
            "confidence": {
                "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
            },
            "code_of_conduct": {
                "value": "Yes"
            },
            "first_time_reviewer": {
                "readers": [
                    "ICLR.cc/2024/Conference/Program_Chairs",
                    "ICLR.cc/2024/Conference/Submission3168/Senior_Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission3168/Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission3168/Reviewer_ModJ"
                ]
            }
        },
        "number": 3,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission3168/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1699034266375,
        "cdate": 1699034266375,
        "tmdate": 1700704821155,
        "mdate": 1700704821155,
        "license": "CC BY 4.0",
        "version": 2
    }
]