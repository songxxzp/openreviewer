[
    {
        "id": "rcAGDvJMNL",
        "forum": "LbJqRGNYCf",
        "replyto": "LbJqRGNYCf",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission4127/Reviewer_5uGr"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission4127/Reviewer_5uGr"
        ],
        "content": {
            "summary": {
                "value": "The paper introduces Joint MLP/Attention (JoMA) dynamics, a mathematical framework designed to understand the training process of multilayer Transformer architectures. This is accomplished by integrating out the self-attention layer in Transformers, resulting in a modified dynamics that focuses solely on the MLP layers. JoMA addresses limitations present in previous analyses by removing unrealistic assumptions, such as the lack of residual connections.\n\nThe authors predict that attention in JoMA initially becomes sparse to learn salient tokens and then transitions to dense attention to capture less salient tokens when nonlinear activations are incorporated. In the case of linear activations, the predictions align with existing literature. Additionally, JoMA is leveraged to provide qualitative explanations of how tokens combine to form hierarchies in multilayer Transformers, specifically in scenarios where input tokens are generated by a latent hierarchical generative model.\n\nTo validate their theoretical findings, the authors conduct experiments using real-world datasets (Wikitext2/Wikitext103) and various pre-trained models (OPT, Pythia). The experimental results support their claims and contribute to the credibility of their research."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "3 good"
            },
            "contribution": {
                "value": "3 good"
            },
            "strengths": {
                "value": "+ The paper introduces the JoMA dynamics, which is a new mathematical framework specifically designed to understand the training procedure of multilayer Transformer architectures.\n\n+ The authors highlight that previous analyses of similar models often make unrealistic assumptions, such as the lack of residual connections. In contrast, the JoMA framework removes these assumptions, making it more accurate and realistic in capturing the training dynamics of multilayer Transformers."
            },
            "weaknesses": {
                "value": "- Although the paper mentions experimental validation using real-world datasets and pre-trained models, it does not provide detailed quantitative evaluation metrics or comparisons against existing approaches. Including quantitative analysis would enhance the robustness and comprehensiveness of the findings.\n\n- The paper does not delve into specific implementation details of the JoMA framework, such as hyperparameter choices or training procedures. Providing more information on these aspects would enable researchers to replicate the experiments and further validate the proposed approach."
            },
            "questions": {
                "value": "1. Why is Figure 1(b) labeled as the \"problem setting\"?"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "5: marginally below the acceptance threshold"
            },
            "confidence": {
                "value": "2: You are willing to defend your assessment, but it is quite likely that you did not understand the central parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        },
        "number": 1,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission4127/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698041771244,
        "cdate": 1698041771244,
        "tmdate": 1699636378050,
        "mdate": 1699636378050,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "ZYPLhkltry",
        "forum": "LbJqRGNYCf",
        "replyto": "LbJqRGNYCf",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission4127/Reviewer_cMvf"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission4127/Reviewer_cMvf"
        ],
        "content": {
            "summary": {
                "value": "This paper proposes a novel mathematical framework called JoMA to understand the training procedure of multilayer Transformer architectures. By integrating out the self-attention layer in Transformers, the authors focus on the dynamics of MLP layers. The framework removes unrealistic assumptions and provides insights into the behavior of attention mechanisms. The authors leverage JoMA to explain how tokens form hierarchies in multilayer Transformers using a latent hierarchical generative model. Experimental results on real-world datasets and pre-trained models validate the theoretical findings."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "3 good"
            },
            "contribution": {
                "value": "3 good"
            },
            "strengths": {
                "value": "1. The proposed JoMA framework offers a new perspective on understanding the training dynamics of multilayer Transformers. By integrating out the self-attention layer, the authors provide valuable insights into the behavior of MLP layers.\n\n2. This paper presents theoretical findings that explain how tokens are combined to form hierarchies in multilayer Transformers. These findings are supported by experiments on real-world datasets and pre-trained models, enhancing the credibility of the results.\n\n3. This paper is well-written and structured, making it easy to follow the proposed framework and understand the theoretical explanations. The inclusion of references to related works in the field strengthens the paper's contribution."
            },
            "weaknesses": {
                "value": "1. Limited practical implications. This paper focuses on theoretical analysis and understanding the training dynamics of multilayer Transformers. It would be valuable to discuss potential practical applications or implications of the proposed framework in real-world scenarios.  \n\n2 Several lines of work around the learning preference of DNNs need to discussed [cite1-3].\n\n[cite1] Devansh Arpit, Stanis\u0142aw Jastrz\u02dbebski, Nicolas Ballas, David Krueger, Emmanuel Bengio,\nMaxinder S Kanwal, Tegan Maharaj, Asja Fischer, Aaron Courville, Yoshua Bengio, et al. A\ncloser look at memorization in deep networks. In International conference on machine learning,\npages 233\u2013242. PMLR, 2017  \n[cite2] Karttikeya Mangalam and Vinay Uday Prabhu. Do deep neural networks learn shallow learnable\nexamples first? 2019.  \n[cite3] Huh M, Mobahi H, Zhang R, et al. The low-rank simplicity bias in deep networks[J]. arXiv:2103.10427, 2021.\n\n3  I am not sure how the insights from this paper could help us train/design better DNNs."
            },
            "questions": {
                "value": "Please see Weaknesses."
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "6: marginally above the acceptance threshold"
            },
            "confidence": {
                "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        },
        "number": 2,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission4127/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698722604893,
        "cdate": 1698722604893,
        "tmdate": 1699636377963,
        "mdate": 1699636377963,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "ULCa8Zdr0v",
        "forum": "LbJqRGNYCf",
        "replyto": "LbJqRGNYCf",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission4127/Reviewer_h5HX"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission4127/Reviewer_h5HX"
        ],
        "content": {
            "summary": {
                "value": "This paper named JoMA, explores to explain the training procedure of multi-layer transformers. JoMA delivers a conclusion that transformers learn salient tokens at low layers while learning less salient tokens at high layers when the nonlinear activations involve training. To build a mathematical framework to show the learning mechanism of multi-layer transformer, JoMA proposes joint dynamics of self-attention and MLP.\n\nCompared with former works that focus on shallow transformer networks, linear activation or local gradient steps, JoMA builds a unified mathematical framework to characterize the learning mechanism of multi-layer transformers. Analyzing deep transformer networks is more challenging."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "4 excellent"
            },
            "contribution": {
                "value": "3 good"
            },
            "strengths": {
                "value": "JoMA is able to analyze deep and sophisticated transformer networks.\n\nIt's interesting to use dynamics to unify the MLP, self-attention, and non-linear activation.\n\nThe derived conclusion of how self-attention learns hierarchical data distribution is meaningful and can guide the design of follow-up transformer-based network."
            },
            "weaknesses": {
                "value": "It would be better to discuss the limitation of JoMA.\n\nIt's not clear why chose OPT and Pythis for verification. Can the findings in this work coincide with BERT-style models?"
            },
            "questions": {
                "value": "-"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "6: marginally above the acceptance threshold"
            },
            "confidence": {
                "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
            },
            "code_of_conduct": {
                "value": "Yes"
            },
            "first_time_reviewer": {
                "value": "Yes",
                "readers": [
                    "ICLR.cc/2024/Conference/Program_Chairs",
                    "ICLR.cc/2024/Conference/Submission4127/Senior_Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission4127/Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission4127/Reviewer_h5HX"
                ]
            }
        },
        "number": 3,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission4127/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698735394346,
        "cdate": 1698735394346,
        "tmdate": 1699636377872,
        "mdate": 1699636377872,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "KBO7SLYRwy",
        "forum": "LbJqRGNYCf",
        "replyto": "LbJqRGNYCf",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission4127/Reviewer_P4nM"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission4127/Reviewer_P4nM"
        ],
        "content": {
            "summary": {
                "value": "The paper proposes a mathematical framework called JoMA to understand the training dynamics of multilayer Transformers. JoMA integrates out the self-attention layer and produces a modified dynamics of MLP layers only. JoMA reveals the training dynamics under linear or non-linear attention, as well as how the attention sparsity change over time, and how they depend on the input distribution.. The paper also verifies its theoretical findings with experiments on real-world data."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "3 good"
            },
            "contribution": {
                "value": "3 good"
            },
            "strengths": {
                "value": "By integrating out the self-attention layer and analyzing only the modified dynamics of MLP layers, JoMA provides a fresh perspective on how these models learn and adapt during training. The paper demonstrates rigorous theoretical analysis on training dynamics, especially on how attention evolves over time. An interesting observation from the paper is that MLP and attention shares the same dynamics, which leads to several intriguing conclusions, for example, the rank of lower mlp layers first goes down and then bounces up. The mathematical derivations are presented clearly, making it accessible to researchers with different backgrounds."
            },
            "weaknesses": {
                "value": "1. One assumption in the paper is that the embedding vectors of all tokens are orthogonal to each other. Does this need to hold for token embedding in every layer? Have the authors verified this assumption is valid in real cases? How much does this assumption affect the following conclusions?"
            },
            "questions": {
                "value": "1. This paper analyze the training dynamics of multi-layer transformer and reveals how the attention is learned through time (first learning attention on tokens with most co-occurrence, and then expanding attention on other tokens). One question is, how is this dynamics dependent on model size? As we see from empirical results in the literature, larger model tends to learn attention that involves more complicated reasoning instead of simple co-occurrence. Can this factor be reflected by the analysis in the paper? How does the training dynamics (and entropy of attention) change when model size changes?\n\n2. Is the proposed JoMA also applicable to vision transformers? Since the input to vision transformer is different from text transformer in that the tokens are continuous instead of discrete and several assumptions in the paper may not hold. For example, the paper assumes tokens are orthogonal to each other, but for vision input lots of input tokens are very similar."
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "6: marginally above the acceptance threshold"
            },
            "confidence": {
                "value": "2: You are willing to defend your assessment, but it is quite likely that you did not understand the central parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        },
        "number": 4,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission4127/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698792455809,
        "cdate": 1698792455809,
        "tmdate": 1699636377789,
        "mdate": 1699636377789,
        "license": "CC BY 4.0",
        "version": 2
    }
]