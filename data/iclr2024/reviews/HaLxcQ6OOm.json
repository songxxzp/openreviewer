[
    {
        "id": "OcN0Qg0CHE",
        "forum": "HaLxcQ6OOm",
        "replyto": "HaLxcQ6OOm",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission5240/Reviewer_Lp2g"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission5240/Reviewer_Lp2g"
        ],
        "content": {
            "summary": {
                "value": "This study explores the challenges transformers face when confronted with multi-step decision tasks, in contrast to CNNs which show no difficulties with the same tasks. It was discovered that transformers can suddenly improve, or experience 'Eureka-moments', after their training and validation loss have been stagnant for hundreds of epochs. These moments differ from the known Grokking phenomena, as both validation and training loss plateau before suddenly improving during a Eureka-moment. The underlying issue was traced back to the Softmax function in the self-attention block of transformers."
            },
            "soundness": {
                "value": "2 fair"
            },
            "presentation": {
                "value": "2 fair"
            },
            "contribution": {
                "value": "2 fair"
            },
            "strengths": {
                "value": "- The paper is well-written and easy to follow.\n- The paper has a interesting discovery that transformers can suddenly improve, or just can not converge.\n- The paper present a fine-grained analysis on the problems that might be asked."
            },
            "weaknesses": {
                "value": "While the paper does not propose a new solution to the identified issue, the contribution lies predominantly in the realm of discovery, task design, and experimentation.\n\n- In terms of discovery and task design, the paper points out an intriguing issue with the softmax function (leading to slow and unstable convergence), an issue that has been identified and addressed by the previously proposed NormSoftmax. Moreover, the task designed within this study does not align with practical application needs and seems to lack significant utility, serving more as a platform for theoretical experimentation. It might be more beneficial to design an experiment around a multi-step task that is more natural and more applicable to visual applications.\n\n- The paper identifies a problem with traditional Transformers and suggests that NormSoftmax could mitigate this issue. Viewed from the perspective that the problem has already been solved, the paper's contribution lies in its detailed experimental analysis and the answers provided to some questions. However, most conclusions and answers are drawn from a speculative and \"might be\" perspective, lacking sufficient theoretical support or more reliable evidence. It is recommended to focus on the phenomena that provide the most insight and to provide stricter proof to serve as the core contribution of the paper.\n\n- The tasks designed in the paper are based on simpler datasets like MNIST and FashionMNIST. There is a lack of experimentation with more diverse and realistic high-resolution image datasets. For example, constructing new tasks using datasets like ImageNet and CelebA could increase the credibility and universality of the research results. We expect that the conclusions drawn still be as applicable to more complex real-world data."
            },
            "questions": {
                "value": "See weekness."
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "5: marginally below the acceptance threshold"
            },
            "confidence": {
                "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        },
        "number": 1,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission5240/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698753031618,
        "cdate": 1698753031618,
        "tmdate": 1699636523076,
        "mdate": 1699636523076,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "R60A24Jeg9",
        "forum": "HaLxcQ6OOm",
        "replyto": "HaLxcQ6OOm",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission5240/Reviewer_Ddae"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission5240/Reviewer_Ddae"
        ],
        "content": {
            "summary": {
                "value": "This paper studies multi-step classification in the context of Vision Transformers (ViTs). The authors claim that while CNNs are able to effectively learn multi-step classification tasks, ViTs struggle to do the same. The paper investigates this problem in ViTs and discusses the Eureka effect - a sudden improvement in the training and validation performance since the ViT learns the intermediate task. Further, the authors state that this inability to effectively learn the intermediate task stems from the Softmax operation in the self-attention mechanism and present methods to address this issue. Experiments show that the solutions improve the results of the multi-step tasks and ensure faster convergence."
            },
            "soundness": {
                "value": "2 fair"
            },
            "presentation": {
                "value": "3 good"
            },
            "contribution": {
                "value": "3 good"
            },
            "strengths": {
                "value": "Motivation - The paper explores a relatively underexplored problem in the context of ViTs. Specifically, the paper addresses multi-step classification without any supervision for the intermediate task, which is an interesting setting.\n\nAnalysis - The paper provides a detailed discussion of why ViTs fail to learn simple multi-step tasks and how the optimization problems can be alleviated. The analysis of the changes in the gradients, attention maps, and the linear probing accuracies of the indicators provide some insights into why ViTs fail in this setting and how Eureka moments are observed."
            },
            "weaknesses": {
                "value": "(a) Theoretical Concerns:\nThe problem setting of the paper, the experiments, and the analytical insights are all based on the synthetic MNIST - Fashion MNIST multi-step task. The significance of the whole paper and all the results strongly depends on the assumption that the insights from the experiments with the synthetic data translate to multi-step tasks on data distributions encountered in real-world scenarios. Despite the pivotal significance of this assumption, there is no proof for the same. The authors state in Section 1 that they have provided some indication of the validity of the assumption, but this doesn\u2019t seem to be present in the paper. Therefore, they should provide a sound background that demonstrates how the insights from the experiments with synthetic data scale to real-world data.\n\n(b) Problem Setting:\n\nRelationship between the intermediate tasks - It is possible that the Eureka moments and the failure of ViTs in multi-step tasks are affected by the nature of the relationship between the intermediate tasks. The multi-step classification task used in the paper involves two unrelated tasks, which may affect the insights drawn from the experiments. For example, the majority of the analyses are carried out on a multi-step task based on MNIST and Fashion MNIST, which are not directly related. While the authors consider the worst-case scenario where the tasks are unrelated, they should attempt to explore the effect of the relationship between the tasks on Eureka moments.\n\nSoundness of the setting - While the authors consider the important and practical setting of multi-step classification, the nature of the multi-step task explored in the paper might not be indicative of the settings often encountered in real-world use cases. I agree with the authors that there are several challenges involved in attempting such a study on real-world data, as they have outlined in Section 1. However, the task with 2x2 inputs for the multi-step task on small-scale datasets such as MNIST and CIFAR might not provide meaningful insights that extend to large-scale settings.\n\nRelation to Hierarchical Classification - Hierarchical classification [R1] can be considered as a specific case of multi-step classification where the intermediate tasks are highly related, i.e., the first task involves coarse categories while the second task involves fine categories under each coarse class. The authors should discuss the relationship between hierarchical classification and their proposed multi-step classification setting.\n\n[R1] Miranda, F\u00e1bio M., Niklas K\u00f6hnecke, and Bernhard Y. Renard. \"Hiclass: a python library for local hierarchical classification compatible with scikit-learn.\" Journal of Machine Learning Research 24.29 (2023): 1-17.\n\n(b) Experiments:\nScale of the models used in the experiments - Table 3 shows that the experiments are conducted on ViT architectures that are similar in scale to ViT-S. However, there are no experiments with larger models, which in part, is limited by the choice of dataset for the multi-step classification task. How do the insights from the smaller models translate to larger architectures such as ViT-B or ViT-L? What is the trend of Eureka moments observed in the larger models? \n\nExperiments with different relationships between the tasks - As mentioned in the previous section, the paper deals with multi-step classification where the intermediate tasks are unrelated. Do the insights on Eureka moments and the optimization challenges presented in the paper hold when the tasks are related? For example, the authors can conduct experiments using the hierarchy of CIFAR-100 or ImageNet (or a subset of ImageNet).\n\nNature of the multi-step tasks - The current MNIST/CIFAR-based setup does not make a strong case for the study of multi-step classification. The authors should experiment with more representative datasets such as CIFAR-100 and ImageNet. The classes from these datasets provide a wide range of possibilities for the multi-step tasks, and would also allow the authors to analyze the effect of the nature of the intermediate tasks on the occurrence of the Eureka moments."
            },
            "questions": {
                "value": "How does the proposed multi-step setup relate to hierarchical classification? Can hierarchical classification be considered a specific variant? How would the insights from the current setup translate to a hierarchical setup, if the latter is a specific variant of the former?\n\nHow can one study Eureka moments for larger ViT models, since it is likely that they might overfit the proposed MNIST/CIFAR-based classification tasks?"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "5: marginally below the acceptance threshold"
            },
            "confidence": {
                "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
            },
            "code_of_conduct": {
                "value": "Yes"
            },
            "first_time_reviewer": {
                "value": "Yes",
                "readers": [
                    "ICLR.cc/2024/Conference/Program_Chairs",
                    "ICLR.cc/2024/Conference/Submission5240/Senior_Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission5240/Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission5240/Reviewer_Ddae"
                ]
            }
        },
        "number": 2,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission5240/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698830276944,
        "cdate": 1698830276944,
        "tmdate": 1699636522945,
        "mdate": 1699636522945,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "qs7xfPkImU",
        "forum": "HaLxcQ6OOm",
        "replyto": "HaLxcQ6OOm",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission5240/Reviewer_ULYQ"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission5240/Reviewer_ULYQ"
        ],
        "content": {
            "summary": {
                "value": "Paper studies transformers and their ability to understand multi-step decision tasks. This paper mainly compares ViT and ResNet for two multi-step tasks. The work does not only show the deficiencies in a transformer to understand the task, but also reason them and provide a solution. In this work author studies the sudden ability of transformers to learn the subtasks. Mostly, the problem is found to be the Softmax layer in the attention, which leads to small gradients and thusly concludes local uniform attention being the cause for a transformer\u2019s learning problem. The paper describes the creation of two synthetic 2-step task datasets and uses them to compare the performance of ViT and a ResNet. The paper also finds the root cause and tries multiple solutions to remedy the issue. Various ViT model are compared."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "3 good"
            },
            "contribution": {
                "value": "3 good"
            },
            "strengths": {
                "value": "[1] The paper is clear, well thought out, and detailed. \n\n[2] The author has interesting finding in the transformer in compared to the convolution model. The finding and solution are promising and may have wide applicability.\n\n[3] The dataset creation and explanation were good, the detailed findings of the shortcomings of a transformer and the explanation of the solutions were well supported by the set of experiments done. \n\n[4] The extensive analysis presented in this paper regarding the issue is both thorough and impressive."
            },
            "weaknesses": {
                "value": "[1] The experiment is carefully designed and demonstrates issues where the transformer architecture lags behind the convolutional architecture. However, the experiments are conducted on a small-scale dataset (MNIST/CIFAR), which may not be very representative of real-world scenarios. The real-world scenario may be much more challenging. I kindly request the author to provide results over the tinyImageNet or ImageNet100 datasets. \n\n[2] It will be interesting to see the robustness of the proposed solution, i.e., how it behaves when faced with more than two multi-step decision tasks. Also, If we extend the model beyond just the vision domain, for instance, in a multimodal setting, do the same assumptions and proposed solutions still hold?\n\n[3] Reproducing the results may be challenging. I kindly request the author to please provide the code for replication."
            },
            "questions": {
                "value": "Please refer to the weakness section."
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "6: marginally above the acceptance threshold"
            },
            "confidence": {
                "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        },
        "number": 3,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission5240/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698866225130,
        "cdate": 1698866225130,
        "tmdate": 1699636522846,
        "mdate": 1699636522846,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "yRWIK2hdis",
        "forum": "HaLxcQ6OOm",
        "replyto": "HaLxcQ6OOm",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission5240/Reviewer_Kjsr"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission5240/Reviewer_Kjsr"
        ],
        "content": {
            "summary": {
                "value": "This paper introduces a setting in which the authors discover what's termed a \"eureka moment\" where both training and validation loss decrease quickly after initially both saturating.  The setting they propose consists of a two-stage task where the transformer has to learn first by comparing top left and bottom right squares to see whether it needs to classify the image in the top right or bottom left.  They show transformers often struggle with this two-stage task while ResNets do not and hypothesize poor gradient flow through the softmax resulting from either attention collapse or too disperse attention weights. They propose adding temperature or using NormSoftmax to alleviate small gradient norms and show increased frequency of Eureka moments than standard attention without adding temperature.  These approaches have higher rate of eureka moments than using standard Softmax attention."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "2 fair"
            },
            "contribution": {
                "value": "2 fair"
            },
            "strengths": {
                "value": "- As far as I know, Eureka moment is a new category of phase transition phenomenon where both training and validation curves saturate before then suddenly making progress.  This differs from Grokking where training is saturated by not validation.\n- The authors identify mitigations that increase the rate of reaching Eureka moments for a simple ViT architecture.  At a high level, these mitigations add entropy to attention softmax and include using a fixed temperature, or an increasing schedule for temperature (termed by the authors Heat Treatment), or a previously proposed NormSoftmax that uses the minimum of the empirical standard deviation of inputs and temperature."
            },
            "weaknesses": {
                "value": "- Setting seems contrived and signal for Eureka moments is much weaker for Roberta model compared to ViT.  The two-stage tasks studied is structure such that the model needs to be able to learn the relationship between task 1 and task 2 and not become hyper-fixated on the classification task in 2.  The proposed mitigations directly address the structure by effectively encouraging exploration during training so that the relationship can be discovered.\n- Adding entropy to softmax increases rate of Eureka moments but there isn't sufficient evidence for low gradient norm being the cause when Eureka moments do not occur.  In particular, Figure 5 doesn't show a big difference between norms of Vit vs NormSoftmax based on what I can tell with log axis.\n- The authors do not sufficiently identify the source of the problem.  In particular, I expected a deeper investigation into the role of initialization; missing Eureka moments seems like it could be driven by bad initialization which is then fixed with higher entropy.\n\nTypos:\n- \"With other initializations they never learn the __taks__ 1 within 1000 epochs\"\n- Unusual to see artefact instead of artifact."
            },
            "questions": {
                "value": "- How do the L1 Gradient Norms look for ViT without temperature in an extended horizon through reaching eureka moment?  How does this compare to the norms for a run of ViT without Eureka moment?\n- What is the role of initialization in this?  Can we address the issue with better initialization schemes instead?  My sense is yes since the mitigation schemes effectively encourage exploration throughout the training process to ensure the model can eventually learn the relationship between task 1 and task 2.\n- For roberta in Figure 7B, is the loss curve training or validation?  How do the training and validation curves compare for this task?\n- Does a Eureka moment exist for larger ViT architectures with more layers?"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "5: marginally below the acceptance threshold"
            },
            "confidence": {
                "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
            },
            "code_of_conduct": {
                "value": "Yes"
            },
            "first_time_reviewer": {
                "value": "Yes",
                "readers": [
                    "ICLR.cc/2024/Conference/Program_Chairs",
                    "ICLR.cc/2024/Conference/Submission5240/Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission5240/Reviewer_Kjsr",
                    "ICLR.cc/2024/Conference/Submission5240/Senior_Area_Chairs"
                ]
            }
        },
        "number": 4,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission5240/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1699056117112,
        "cdate": 1699056117112,
        "tmdate": 1700722564497,
        "mdate": 1700722564497,
        "license": "CC BY 4.0",
        "version": 2
    }
]