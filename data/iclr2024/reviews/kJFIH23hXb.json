[
    {
        "id": "DdZb67zqC1",
        "forum": "kJFIH23hXb",
        "replyto": "kJFIH23hXb",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission3838/Reviewer_Nm3A"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission3838/Reviewer_Nm3A"
        ],
        "content": {
            "summary": {
                "value": "This paper presents FoldFlow models, extensions of Riemannian flow matching objective for distributions over $SE(3)^N$ with applications to protein backbone generation. Specifically, FoldFlow-Base leverages Riemannian FM defined on $SO(3)$. FoldFlow-OT further enhances the approach by Riemannian optimal transport. FoldFlow-SFM introduces stochasticity into the flow model. The models have been comprehensively benchmarked on protein backbone generation tasks and achieved strong performance compared with the diffusion-based baselines."
            },
            "soundness": {
                "value": "4 excellent"
            },
            "presentation": {
                "value": "4 excellent"
            },
            "contribution": {
                "value": "3 good"
            },
            "strengths": {
                "value": "1. The method is very well motivated as an application of flow matching on data with the form of $SE(3)^N$, e.g., protein backbones.\n\n2. The presentation is very clear and the paper is well prepared.\n\n3. The experimental evaluations are interesting and the results are promising."
            },
            "weaknesses": {
                "value": "1. It would be better if some detailed results on the generation process are presented (see Q1).\n\n2. Ablation studies could be improved to provide a full picture on the proposed techniques/tricks (see Q2)."
            },
            "questions": {
                "value": "1. Is it possible to analyze how the sampling steps affect the quality of the generated samples? Presenting such results would give the readers better insight how the generation process works for this flow-matching based model, especially compared with diffusions (e.g., FrameDiff).\n\n2. For the ablation study, it would be great to have the ablate the four parts (Stochas., OT, Aux loss, inf. annealing) on top of the full version, besides the incremental approach adopted in this paper. That is, it would be interesting to see how the performance would be if we remove  one of the four parts respectively from the full version with all four techniques."
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "8: accept, good paper"
            },
            "confidence": {
                "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        },
        "number": 1,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission3838/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698623186499,
        "cdate": 1698623186499,
        "tmdate": 1699636341856,
        "mdate": 1699636341856,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "wQjnqYQD6B",
        "forum": "kJFIH23hXb",
        "replyto": "kJFIH23hXb",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission3838/Reviewer_zh9j"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission3838/Reviewer_zh9j"
        ],
        "content": {
            "summary": {
                "value": "The authors extend previous work on conditional flow matching on Riemannian manifolds and apply it to generate protein backbones. Their theoretical results lead to fast and stable training, and they empirically generate more diverse and designable structures than non-pretrained denoising diffusion probabilistic models of protein backbone. \n\nIn general, I think this is an interesting and strong paper. Most of my concerns (detailed below) are around specifics of the evaluation, and I believe that they are addressable"
            },
            "soundness": {
                "value": "4 excellent"
            },
            "presentation": {
                "value": "3 good"
            },
            "contribution": {
                "value": "4 excellent"
            },
            "strengths": {
                "value": "- \\[originality\\] This is in the first cohort of work applying conditional flow matching to generate protein backbones. The paper makes a number of theoretical contributions, such as proving the existence of a Monge map on $SE(3)_0^N$ and a closed-form expression of the target conditional vector field for SO(3). \n- \\[significance\\]  Conditional flow matching is a family of generative models that relaxes many of the constraints of normalizing flows, and extending them to SE(3) enables many applications in biology, chemistry, and materials. The specific application studied here is of great importance and interest. \n- \\[quality\\] The theoretical results seem sound, although I did not carefully check the proofs. Empirically, FoldFlow does generate more designable, diverse, and novel structures than previous comparable methods. The comparisons between FoldFlow-Base, OT, and SFM are thorough and sound. \n- \\[clarity\\] The paper is generally well-written, the contributions are clear, and the empirical results are easy to follow. Despite an obvious need to compress a lot of material into the page limit, the paper is well-cited and well-situated in the current literature."
            },
            "weaknesses": {
                "value": "The main empirical claim in this paper is that using flow matching instead of diffusion results in better generated protein structure backbones. Therefore, the major weaknesses of the paper are in explaining why we see this result and in showing, with as many other parameters held constant as possible, that the flow matching objective is responsible for improvements in generation quality. In addition, the section on conformation generation lacks the proper ablations to support the claim that flow matching is helpful there, as well as a justification for why this is a useful task. \n\nI will now try to detail these weaknesses in clarity and quality and suggest ways to address them where applicable. Within each section, I will move from more important to less important. \n\n### Clarity\n\n- While the theoretical contribution lies in enabling stochastic flow matching for protein backbone generation, there is no theoretical or qualitative discussion of why flow matching should result in more efficient training and higher-quality generations. \n- In general, the authors have the unenviable task of explaining the background for both protein generation and Riemannian flow matching within the page limit. I think people from outside the fields will have a lot of trouble following the more technical parts of the exposition, but I'm not sure it's possible to do much better given the depth of material and the page limit. \n- Is generating from the equilibrium distribution over conformations after training on data from molecular dynamics useful? I can see how this would be useful if it generalized to new structures, but it seems that if you've already done the MD for that particular model, using another model to sample from the distribution is superfluous. \n- There is some information relegated to the supplement that should be in the main text. For example, that the authors use the same neural architecture as FrameDiff but a slightly different training set is very important for interpreting the empirical results. \n- The two paragraphs beginning \"Our approach\" and the final list of main contributions at the end of the introduction are fairly redundant, with several sentences of repeated content. Given how much theory, experiment, and background the authors need to cover, reducing redundancy here could help clarify other parts of the paper. \n- In section G.1.1, I think \"Here we find that FOLDFLOW is over 2x faster than FoldFlow-Improved per step\" should be \"Here we find that FOLDFLOW is over 2x faster than FrameDiff-Improved per step.\"\n\n\n### Quality\n\n- The claim that FoldFlow outperforms FrameDiff in particular and diffusion in general would be stronger if the training set and other train compute were matched between FrameDiff-improved and FoldFlow. As it is, they are very similar, but the slight discrepancy in train sets and hyperparameters such as batching weaken the comparison. \n- The section on equilibrium conformation generation doesn't make a strong case that FoldFlow is better than (1) diffusion from a simple prior trained on the same data or (2) flow matching from a simple prior trained on the same data. \n- In Table 2, the numbers for Diversity and novelty should include uncertainties. It would also be nice to have scRMSD in this table. \n- Ablations of FoldFlow-OT and -SFM without the Aux loss or inference annealing would strengthen the case that the auxiliary loss and inference annealing are universally helpful. \n- FoldFlow-Base and FoldFlow-SFM do poorly on designability for longer proteins. This may be because the deduplicated dataset does not have very many longer proteins."
            },
            "questions": {
                "value": "- Are there applications for the arbitrary starting distribution other than trying to sample from the conformational ensemble via generation?\n- Is there a reason to prefer scRMSD instead of scTM, as was seen in some earlier work? \n- Is DP vs DDP something intrinsic to the models, or could, for example, FrameDiff be trained with DDP?"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "8: accept, good paper"
            },
            "confidence": {
                "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
            },
            "code_of_conduct": {
                "value": "Yes"
            },
            "first_time_reviewer": {
                "readers": [
                    "ICLR.cc/2024/Conference/Program_Chairs",
                    "ICLR.cc/2024/Conference/Submission3838/Senior_Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission3838/Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission3838/Reviewer_zh9j"
                ]
            }
        },
        "number": 2,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission3838/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698695869538,
        "cdate": 1698695869538,
        "tmdate": 1700508686030,
        "mdate": 1700508686030,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "gDUXwEL2jz",
        "forum": "kJFIH23hXb",
        "replyto": "kJFIH23hXb",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission3838/Reviewer_PWT4"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission3838/Reviewer_PWT4"
        ],
        "content": {
            "summary": {
                "value": "Flow matching, and OT flow matching are applied to the problem of learning generative models of protein backbones. Three variants of the method are provided (1) train a CNF via flow matching, (2) train a CNF via conditional flow matching with minibatch optimal transport, and (3) they replace the deterministic flow model with a model that learns to map between the base and target sources via stochastic dynamics. Strong empirical results are shown when training on structures from the PDB:\n- The OT version shows significant improvement above the base model\n- They improve upon FrameDiff substantially. \n- Their model does not rely on a pretrained model, and is substantially cheaper to train than RosettaDiff\n\nAdditionally, the flow matching paradigm allows for an arbitrary base distribution to be used - and this is demonstrated in an experiment on conformer generation of the BPTI protein where noised samples from pre-trained models are used as the base distribution."
            },
            "soundness": {
                "value": "4 excellent"
            },
            "presentation": {
                "value": "4 excellent"
            },
            "contribution": {
                "value": "4 excellent"
            },
            "strengths": {
                "value": "- Well motivated: The presentation of the method is clear, the method (flow matching/OT flow matching) is well suited to the problem of protein generation, and is the first to explore this. The ability to use arbitrary base distributions is well suited to confomer generation where we can choose informed base distributions (e.g. using cheminformatics methods, or with existing models e.g. AlphaFold). \n- Strong experimental section: The results (improving upon the FrameDiff model) look really good. The models are trained for substantially less time than the RFDiffusion alternative, and do not rely on pre-training. Good baselines are presented, showing the benefit of the OT-flow over the flow trained with vanilla flow matching."
            },
            "weaknesses": {
                "value": "- The FOLDFLOW-SFM does not have much motivation provided (besides empirical results e.g.  noting that they have higher novelty). \n- The experiment on equilibrium confomer generation utilizing the informed base distribution does not compare against an uninformed base distribution. Thus, it is hard to judge exactly how helpful this is (although intuitively it seems like it would be very helpful!)."
            },
            "questions": {
                "value": "- What is the advantage of the FOLDFLOW-SFM over the other models in theory? \n- I find the term \u201cstochastic flow\u201d a bit confusing as typically flow refers to deterministic dynamics - could the authors please clarify?"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "8: accept, good paper"
            },
            "confidence": {
                "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        },
        "number": 3,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission3838/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698740566454,
        "cdate": 1698740566454,
        "tmdate": 1699636341689,
        "mdate": 1699636341689,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "LINjKZhUZ9",
        "forum": "kJFIH23hXb",
        "replyto": "kJFIH23hXb",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission3838/Reviewer_4M3T"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission3838/Reviewer_4M3T"
        ],
        "content": {
            "summary": {
                "value": "The paper introduces a series of novel generative models called FoldFlow, which are designed to accurately model protein backbones. The models are based on the flow-matching paradigm over rigid motions, allowing for the construction of stable and fast training methods.\nThe first model introduced is FoldFlow-Base, a simulation-free approach that learns deterministic continuous-time dynamics and matches invariant target distributions. This model is then improved upon by incorporating Riemannian optimal transport, resulting in FoldFlow-OT, which creates more simple and stable flows.\nLastly, the authors design FoldFlow-SFM, which combines Riemannian optimal transport and simulation-free training to learn stochastic continuous-time dynamics."
            },
            "soundness": {
                "value": "2 fair"
            },
            "presentation": {
                "value": "3 good"
            },
            "contribution": {
                "value": "3 good"
            },
            "strengths": {
                "value": "The paper introduces a novel approach called FoldFlow for generative modeling of protein structures. This approach is based on the flow-matching paradigm over rigid motions. The authors claim that incorporation of Riemannian optimal transport and simulation-free training techniques improves the stability and efficiency of the models compared to diffusion-based approaches.\nThe authors present a series of models within the FoldFlow framework, each with increasing modeling power."
            },
            "weaknesses": {
                "value": "The work raised a couple of questions.\n\n1. Why should optimal transport be a good prior for protein backbone generation? Section 3.2 on FoldFlow-OT provides little explanation why this should overall improve the quality of the generated samples. Could you elaborate on that? Similarly, it would be great if you could provide an intuition for motivating the introduction of the stochastic version. The results (Table 2) also do not suggest that there is any benefit in introducing three variants.\n\n3. Studying Table 2, the authors confirm that FoldFlow significantly underperforms RFDiffusion. Also, as raised in Question 1, there is no pattern of improvement between each method of FoldFlow. My main concern regards the stability of the results? You seem to report a single value, is this a lucky single shot. I would suggest to align the analysis to previous literature, i.e., as conducted in FrameDiff, and report results on several runs and examples. It would also be important to also extend Figure 4b to include a comparison to RFDiffusion, FrameDiff, and Genie in terms of scRMSD. Similarly, why not repeat the analysis in Figure 5 with the considered baselines?\n\n3. You claim that FoldFlow models are designed to be fast, stable, and efficient training. Why are the runtimes of the baselines in Table 2 missing? Regarding Table 3, what are the time differences between -base, -OT, and -SFM? What does FoldFlow in Table 3 refer to? You claim in Appendix B that you \"want to get straighter flows for faster inference and more stable training\". Is this something you observe?\n\n4. Using flow matching methods on protein structures is not new. It would be important to cite previous work here and highlight the differences [1].\n\nI very much enjoyed reading the paper and the direction is exciting. The current experimental validation, however, raises several concerns that need to be addressed. This in particular concerns the absence of a pattern in performance of different FoldFlow variants and chosen reported metrics and comparisons.\n\n[1] Somnath, Vignesh Ram, et al. \"Aligned Diffusion Schr\u00f6dinger Bridges.\" Conference on Uncertainty in Artificial Intelligence (UAI), 2023."
            },
            "questions": {
                "value": "See above. If my concerns are addressed, I am willing to increase my score."
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "6: marginally above the acceptance threshold"
            },
            "confidence": {
                "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
            },
            "code_of_conduct": {
                "value": "Yes"
            },
            "first_time_reviewer": {
                "value": "Yes",
                "readers": [
                    "ICLR.cc/2024/Conference/Program_Chairs",
                    "ICLR.cc/2024/Conference/Submission3838/Senior_Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission3838/Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission3838/Reviewer_4M3T"
                ]
            }
        },
        "number": 4,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission3838/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1699465724625,
        "cdate": 1699465724625,
        "tmdate": 1699636341615,
        "mdate": 1699636341615,
        "license": "CC BY 4.0",
        "version": 2
    }
]