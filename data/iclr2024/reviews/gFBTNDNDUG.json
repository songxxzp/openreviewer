[
    {
        "id": "kmsDSq9zKh",
        "forum": "gFBTNDNDUG",
        "replyto": "gFBTNDNDUG",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission4210/Reviewer_feJt"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission4210/Reviewer_feJt"
        ],
        "content": {
            "summary": {
                "value": "The authors study the task of optimal transport framing it as an optimization of a lagrangian. They find particular instances where the optimization of this generally hard problem can be performed more efficiently from a dual characterization of the optimization. Their framework works particularly well when the Hamiltonian is linear in the density variable and they give special cases where this occurs. The experiments focus on RNA sequencing tasks for which their method seem to perform well."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "3 good"
            },
            "contribution": {
                "value": "2 fair"
            },
            "strengths": {
                "value": "**Disclaimer:** I am not an expert in optimal transport and have no background in the biological task which appears to be the motivation for this particular work. The AC asked me still to provide a high level review and I will try my best to do so below.  I will refrain from making strong statements about the paper due to my lack of expertise. \n\nThe strength of this paper seems to lie in its efficiency in addressing a potentially challenging optimal transport problem. Their reformulation of the optimal transport into an efficient scheme is noteworthy to me. Their algorithm is clearly laid out in section 3 and I could follow along relatively well, albeit many choices such as the neural network architecture are not specified (perhaps to give one flexibility in this choice)."
            },
            "weaknesses": {
                "value": "As stated above, I am not an expert in this area, and reading this paper, I was impressed by the rigor and extensive detail of their approach. Nevertheless, in the end, I could not come to a concrete conclusion regarding its novelty and relevance for someone who is not specifically in their field. Let me explain a bit further.\n\nFirst, they propose a method which they say is effective and efficient in a wide variety of domains including transport with constraints and unbalanced transport. On this point, my opinion seems to agree with the authors overall, but the specifics contradict the generality at times. For example, the constraints that the authors are able to enforce are constraints on the marginal values themselves. However, what if the constraints come in a different form, e.g. a symmetry in the problem or distributions? This happens all the time in physics and it's not obvious to me that the approach covers a constraint like that. \n\nSecond, the authors motivate this problem with a RNA sequencing task saying that we can only observe population statistics and we want to infer individual statistics from this. I can understand this would be useful. But looking at the experiments, none of the experiments test this specific point. All the experiments are predicting population statistics. This may be an issue in how one collects the data rather than the learning of that data, but nonetheless it leaves me unconvinced that this approach actually achieves the high level goal.\n\nTypos/grammar and notational comments:\n- pg. 2: \"which forms the basis the Lagrangian formulation\u201d\n- section 2.1 writes the Lagrangian as inputting path variables, but later on, the inputs to the Lagrangian are momentum variables. This should be consistent.\n- pg. 3 grammar: \"allows us to consider of potential energy functionals which depend\"\n- Hyperlinks for OT, SB, etc. seem to be broken. What are these supposed to point to?\n\nQuestions:\n- Below eq 27, the authors say that they perform optimization with respect to $\\eta$ using a reparameterization trick. What is this trick? I couldn\u2019t find a reference to it.\n- In the experiments, which time points are the left-out marginals? Are the left-out marginals in the future and need to be extrapolated? Or is it interpolated as in-between points? The former task seems to be a lot harder in my opinion.\n\n\nMinor comments:\n- I wish the authors expanded a bit more about the potential extension to the quantum Schr\u00f6dinger equation, since this is a field I am particularly interested in. The Madelung transformation in the appendix appears to only be for one particle (unless I am missing something) which is not really of practical relevance. The authors do not state this exactly and I wish they were more precise in how they view this extension in their appendix section. Extending classical densities of particles to work in the quantum setting for multiple particles is a tricky task as it needs to account for factors like entanglement; e.g. see density functional theory which takes on this complication in rather extensive detail. \n- The particular task in the experiment is tough to follow unless one goes into the appendix and digs into the details of the Kaggle competition itself. I wish the authors would describe more what exactly is going on. E.g. simple things like what the raw data is in the form of. The resulting task is the PCA of this raw data.  \n- As stated in my disclaimer above, I am by no means an expert in this topic, but I do not think this paper unifies the field. In fact, there were many situations where the authors stated to their credit that their method may not apply very well (e.g. Schrodinger equation). I am sure people would have to get a different perspective for these problems. So I would caution the authors in their language surrounding this point.\n\nOn a final point, given my lack of background, I did not check equations line by line and proofs were not checked.\n\nOverall, I have chosen a score of marginal accept for the reasons stated in my admittedly limited review above. My confidence is low in this score so I welcome thoughts from the authors and other reviewers."
            },
            "questions": {
                "value": "All questions stated above."
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "6: marginally above the acceptance threshold"
            },
            "confidence": {
                "value": "1: You are unable to assess this paper and have alerted the ACs to seek an opinion from different reviewers."
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        },
        "number": 1,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission4210/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1697812886460,
        "cdate": 1697812886460,
        "tmdate": 1699636388015,
        "mdate": 1699636388015,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "HI7M1bvnX6",
        "forum": "gFBTNDNDUG",
        "replyto": "gFBTNDNDUG",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission4210/Reviewer_zR9h"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission4210/Reviewer_zR9h"
        ],
        "content": {
            "summary": {
                "value": "This paper introduces a deep learning based method to solve a wide range of Optimal Transport (OT) problems by using as the loss the dual of the Lagrangian obtained from the dynamic formulation of OT. It notably covers the Wasserstein distance, the Wasserstein-Fisher-Rao distance, physic constrained OT and Schr\u00f6dinger bridges. The method is then applied on tasks of trajectory inference of single-cell RNA sequencing data."
            },
            "soundness": {
                "value": "4 excellent"
            },
            "presentation": {
                "value": "4 excellent"
            },
            "contribution": {
                "value": "4 excellent"
            },
            "strengths": {
                "value": "The task of solving the dynamic OT problem is an important problem which has received recently much attention combined with deep learning. This works is part of this literature and provides a unified method which can be applied to several useful OT based problems.\n\n- The paper provides a method applicable to solve different OT Problem by using the dual of the Lagrangian, which is a very nice contribution in my opinon.\n- The theory and the method are well explained and a lot of examples are provided.\n- While some part of the paper are rather technical, it is well written and comprehensive.\n- The results on single-cell trajectory inference seem to be SOTA by combining different OT problems (namely UOT with physic constraints)"
            },
            "weaknesses": {
                "value": "In my opinion, there is no major weakness. Maybe, a simple example showing how well the proposed method allows to approximate the true dynamic is lacking, for instance using the closed-form for the Schr\u00f6dinger bridge between Gaussian proposed in [1].\n\n[1] Bunne, Charlotte, Ya-Ping Hsieh, Marco Cuturi, and Andreas Krause. \"The Schr\u00f6dinger Bridge between Gaussian Measures has a Closed Form.\" In International Conference on Artificial Intelligence and Statistics, pp. 5802-5833. PMLR, 2023."
            },
            "questions": {
                "value": "I may have missed it, but I think the notation $\\phi_{\\overset{.}{\\mu_t}}$, for instance in Equation (7), is not defined.\n\nTypos:\n- At equation (5), there is a point.\n- Equation 23, a parenthesis is in the wrong place"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "8: accept, good paper"
            },
            "confidence": {
                "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
            },
            "code_of_conduct": {
                "value": "Yes"
            },
            "first_time_reviewer": {
                "value": "Yes",
                "readers": [
                    "ICLR.cc/2024/Conference/Program_Chairs",
                    "ICLR.cc/2024/Conference/Submission4210/Senior_Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission4210/Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission4210/Reviewer_zR9h"
                ]
            }
        },
        "number": 2,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission4210/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698159889622,
        "cdate": 1698159889622,
        "tmdate": 1699636387932,
        "mdate": 1699636387932,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "66lHTXspcv",
        "forum": "gFBTNDNDUG",
        "replyto": "gFBTNDNDUG",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission4210/Reviewer_E9Se"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission4210/Reviewer_E9Se"
        ],
        "content": {
            "summary": {
                "value": "The paper proposes a novel computational algorithm to obtain trajectories on the space of probability distributions that come from a Lagrangian variational formulation. The algorithm is based on a dual formulation of the problem, where the trajectories and dual functionals are represented with neural network. The algorithm is illustrated on several numerical examples, including the dynamics of a cell population, which also forms the main motivation for this paper."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "2 fair"
            },
            "contribution": {
                "value": "2 fair"
            },
            "strengths": {
                "value": "The paper is concerned with an interesting problem that is valuable for research and applications. \nThe mathematical presentation is rigorous and educative. \nThe review of the literature is appropriate (to the best of my knowledge)."
            },
            "weaknesses": {
                "value": "The paper does not provide sufficient evidence for the validity of their approach to solve all Lagranian type problems. The reported numerical experiments is limited and it is not clear what is the distingusihing characteristic of the proposed approach in relation to other works. \n\nMinimizing the Lagrangian may not be the appropriate objective in general, because Lagrangian flows are not the minimizer, but the extreme points of the action integral. \n\nMost of the background material can be moved to appendix as they are not critical to the proposed algorithm. The dual formulation, which is basically the main component, may be explained without much of the background material. \n\nThere is not enough motivation for parametrizing the flow according to (26). For a standard OT problem, what is the optimal function that replaces the neural net in this equation?"
            },
            "questions": {
                "value": "Please see my comments above"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "3: reject, not good enough"
            },
            "confidence": {
                "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        },
        "number": 3,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission4210/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698862976620,
        "cdate": 1698862976620,
        "tmdate": 1699636387871,
        "mdate": 1699636387871,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "Efqo2hK1zy",
        "forum": "gFBTNDNDUG",
        "replyto": "gFBTNDNDUG",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission4210/Reviewer_uk1R"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission4210/Reviewer_uk1R"
        ],
        "content": {
            "summary": {
                "value": "This paper proposes a computational framework for solving Wasserstein\nLagrangian Flows. The focus is on problems in the form of equation (12)\nwhere the cost is given by the minimum-action function in equation (1).\nSpecial cases of this problem include OT, unbalanced OT,\nand Schrodinger Bridge.\nProposition 1 shows the dual of this problem, and the main insight\nof this paper is that it can be efficiently solved with a\nflow given in equation (26).\nThis is done by the generative model in equation (26)\nand solved with algorithm 1.\nThe experiments focus on single-cell RNA sequencing data."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "3 good"
            },
            "contribution": {
                "value": "3 good"
            },
            "strengths": {
                "value": "1. One large challenge in developing OT and SB solvers in general\n   and with flow-based models is needing to satisfy the\n   marginal constraints.\n   The generative model in equation (26) has the nice\n   property that the marginals are always satisfied\n   and the path is\n2. Table 1 shows superior performances to OT, UOT, and SB methods."
            },
            "weaknesses": {
                "value": "1. My main concern with the paper (and perhaps the research area)\n   is that the quality of the solution to the OT/UOT/SB problems\n   is not directly measured or compared to other methods.\n   In other words, the objective values of the optimization\n   problem in (12) are never reported or compared between methods\n   that are solving that problem.\n   This is because solvers may solve the problem in different\n   forms, such as dual forms, where the value being optimized\n   is not comparable between methods.\n   Because of this difficulty, research in this space often\n   reports another diagnostic metric that is assumed to be\n   correlated with a better solution to equation (12).\n   In this paper, Table 1 reports the W1 distance to\n   the left-out marginals. While they indeed show that\n   WLF variants are often better than two other papers\n   published in 2023, it would be better if the field\n   had a more direct way of comparing solvers.\n2. If I understand correctly, the representational capacity of equation (20) not\n   clear or discussed. E.g., can it universally approximate distribution paths,\n   and it is obvious that it can capture an optimal transport path?\n   Experimentally it seems that it is the case, but it would be good to\n   present or discuss more intuition behind this family of paths.\n3. The experimental results are mostly focused on the\n   existing scRNA setting. While these are seemingly good,\n   it seems like the experimental settings considered\n   by the other [Lagrangian SB](https://arxiv.org/abs/2204.04853)\n   and [generalized SB](https://arxiv.org/abs/2209.09893)\n   papers would be reasonable to compare against.\n   This would help better-quantify the approach as\n   a general-purpose solver for these large problem classes.\n4. Appendix C.2 has some image generation experiments,\n   but they seem incomplete and there are no quantitative\n   evaluations of the method."
            },
            "questions": {
                "value": "I am overall positive about the methodological and\nexperimental contributions in this paper.\nMy only hesitation on the paper is in the weaknesses I pointed out\nthat 1) the paper never quantifies or compares the solution\nquality of the OT/SB problems that are being solved\nand 2) the expressivity of equation (20) is not clear to me (e.g., can\nit universally approximate OT paths?).\nI am very willing to re-evaluate my score during the\ndiscussion period and would find it helpful if the\nauthors shared their thoughts."
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "8: accept, good paper"
            },
            "confidence": {
                "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
            },
            "code_of_conduct": {
                "value": "Yes"
            },
            "first_time_reviewer": {
                "readers": [
                    "ICLR.cc/2024/Conference/Program_Chairs",
                    "ICLR.cc/2024/Conference/Submission4210/Senior_Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission4210/Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission4210/Reviewer_uk1R"
                ]
            }
        },
        "number": 4,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission4210/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698902210024,
        "cdate": 1698902210024,
        "tmdate": 1700530468976,
        "mdate": 1700530468976,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "D9lFjzGZeA",
        "forum": "gFBTNDNDUG",
        "replyto": "gFBTNDNDUG",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission4210/Reviewer_sAE6"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission4210/Reviewer_sAE6"
        ],
        "content": {
            "summary": {
                "value": "This paper presents a novel deep learning-based framework for solving various variations of the optimal transport problem. Optimal transport involves finding the most efficient way to transport one distribution into another, taking into account different geometric and potential energy considerations. Realizations of this framework include the Schr\u00f6dinger bridge, unbalanced optimal transport, and optimal transport with physical constraints, among others.\nSolving the associated variational problems can be computationally challenging because the optimal density path is often unknown. However, the authors propose a dual formulation of the Lagrangians that leverages deep learning techniques to address these challenges. Importantly, their method does not require simulating or backpropagating through trajectories or accessing optimal couplings."
            },
            "soundness": {
                "value": "2 fair"
            },
            "presentation": {
                "value": "2 fair"
            },
            "contribution": {
                "value": "2 fair"
            },
            "strengths": {
                "value": "The paper introduces a novel deep learning-based framework for solving various variations of the optimal transport problem.\nThe proposed framework is versatile and can be applied to different variations of the optimal transport problem, such as the Schr\u00f6dinger bridge, unbalanced optimal transport, and optimal transport with physical constraints. This approach offers a fresh perspective and provides a new ansatz to a challenging problem."
            },
            "weaknesses": {
                "value": "From a methodological standpoint, could the authors highlight the conceptual differences between your method and Chow et al. (2020) as well as Carrillo et al. (2021)? They seem to capture several of the frameworks discussed in this work and it is unclear in what sense you are providing a \"unifying framework\" here.\n\nBesides, the current experimental validation is incomplete. Some questions:\n\n1. I am surprised by the choices of baselines. Could the authors comment on why they only compared against Tong et al., 2023a and Tong et al., 2023b? There are several approaches that propose Schr\u00f6dinger bridges for modeling single-cell dynamics and beyond, in particular Shi et al. (2023), Somnath et al. (2023), Liu et al. (2023), and Chen et al. (2022) to name a few. Vargas et al. (2021) and Somnath et al. (2023) in particular contain single-cell experiments.\n\n2. It seems a bit odd not to compare against methods that also incorporate unbalanced solutions. Missing comparisons are here Eyring et al. (2022) and L\u00fcbeck et al. (2022) that propose neural unbalanced OT solvers. The most obvious comparison would be with Pariset et al. (2023) and Pooladian et al. (2023b), which you cite but do not compare against. Is there a reason why?\n\n3. What is the motivation of running the method on the first 5 principal components (Table 1) besides running on 50 and 100 PCs? Does the method not scale to larger problems? Usually, single-cell data is reduced to 50 to 100 PCs to capture most of the variance, 5 PCs are not enough.\n\n4. Why does the method barely outperform the exact OT method? For Table 2, why is exact OT even better on 50 and 100 PCS than the proposed method WLF-OT?\n\n5. Is there any reasoning when to use which version of the method? If you compare the three methods using the same number of neural network parameters, do the results change?\n\n6. In your conclusion you state: \"we studied the problem of trajectory inference in biological systems, and showed that we can integrate various priors into trajectory analysis while respecting the marginal constraints on the observed data, resulting in significant improvement in several benchmarks\". This is not what the results suggest in my opinion. The chosen datasets do not allow for a thorough study of cell death and birth and thus do not provide a framework that allows studying unbalanced formulations of OT. However, there are multiple datasets that contain screens of cancer drugs that induce cell death (see Srivatsan et al., 2020) as well as the datasets studied in Pariset et al. (2023), L\u00fcbeck et al. (2022), or Eyring et al. (2022) that would be more suitable.\n\n7. Minor, but a work connected to \"Optimal Transport with Lagrangian Cost\" to include is Fan et al. (2022).\n\nReferences:\n\n- Shui-Nee Chow, Wuchen Li, and Haomin Zhou. Wasserstein Hamiltonian flows. Journal of Differential Equations, 268(3):1205\u20131219, (2020).\n- Carrillo, Jose A., Daniel Matthes, and Marie-Therese Wolfram. \"Lagrangian schemes for Wasserstein gradient flows.\" Handbook of Numerical Analysis 22 (2021).\n- Shi, Y., De Bortoli, V., Campbell, A. & Doucet, A. Diffusion Schr\u00f6dinger Bridge Matching. arXiv preprint arXiv:2303. 16852 (2023).\n- Liu, Guan-Horng, et al. \"I$^ 2$SB: Image-to-Image Schr\u00f6dinger Bridge.\" International Conference on Machine Learning (ICML) (2023).\n- Somnath, Vignesh Ram, et al. \"Aligned Diffusion Schr\u00f6dinger Bridges.\" Conference on Uncertainty in Artificial Intelligence (UAI) (2023).\n- Vargas, Francisco, et al. \"Solving Schr\u00f6dinger bridges via maximum likelihood.\" Entropy 23.9 (2021).\n- Chen, Tianrong, Guan-Horng Liu, and Evangelos A. Theodorou. \"Likelihood training of Schr\u00f6dinger bridge using forward-backward SDEs theory.\" International Conference on Learning Representations (ICLR) (2022).\n- L\u00fcbeck, F. et al. Neural unbalanced optimal transport via cycle-consistent semi-couplings. arXiv preprint arXiv:2209.15621 (2022).\n- Eyring, Luca Vincent, et al. \"Modeling single-cell dynamics using unbalanced parameterized Monge maps.\" bioRxiv (2022).\n- Pariset, Matteo, et al. \"Unbalanced Diffusion Schr\u00f6dinger Bridge.\" arXiv preprint arXiv:2306.09099 (2023).\n- Srivatsan, S. R. et al. Massively multiplex chemical transcriptomics at single-cell resolution. Science 367, 45\u201351 (2020).\n- Fan, Jiaojiao, et al. \"Scalable computation of Monge maps with general costs.\" ICLR Workshop on Deep Generative Models for Highly Structured Data (2022)."
            },
            "questions": {
                "value": "No further questions."
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "5: marginally below the acceptance threshold"
            },
            "confidence": {
                "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
            },
            "code_of_conduct": {
                "value": "Yes"
            },
            "first_time_reviewer": {
                "value": "Yes",
                "readers": [
                    "ICLR.cc/2024/Conference/Program_Chairs",
                    "ICLR.cc/2024/Conference/Submission4210/Senior_Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission4210/Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission4210/Reviewer_sAE6"
                ]
            }
        },
        "number": 5,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission4210/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1699473109319,
        "cdate": 1699473109319,
        "tmdate": 1699636387717,
        "mdate": 1699636387717,
        "license": "CC BY 4.0",
        "version": 2
    }
]