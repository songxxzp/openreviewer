[
    {
        "id": "ICs5uVPPjU",
        "forum": "GKxmmAwxj1",
        "replyto": "GKxmmAwxj1",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission8285/Reviewer_3BfG"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission8285/Reviewer_3BfG"
        ],
        "content": {
            "summary": {
                "value": "The authors introduce a new flow architecture and training loss to train Boltzmann generators for large proteins. The flow architecture operates on internal coordinates of the backbone and the side chains, while bonds and bond angles of the side chain remain fixed. In addition to the commonly used forward and reverse KL divergence to train Boltzmann generators, they also employ a novel loss based on the distribution of the backbone all atom distance matrix. \nThey show in their experiments on protein G and HP35 that their Boltzmann generator is capable of generating samples with low energies. Moreover, they show for protein G that their Boltzmann generator samples meta-stable states unseen during training."
            },
            "soundness": {
                "value": "2 fair"
            },
            "presentation": {
                "value": "3 good"
            },
            "contribution": {
                "value": "3 good"
            },
            "strengths": {
                "value": "- The paper is well written and easy to follow. \n- The authors introduce a new normalizing flow architecture, which uses preexisting building blocks. \n- The main novelty is the training with the 2-Wasserstein distance loss that measures the derivation of the all distance matrix for the backbone between Boltzmann generator samples and samples from the target distribution. \n- The new loss (in combination with the architecture) provides a way to scale Boltzmann generators to larger proteins\n- Their experiments demonstrate that these trained Boltzmann generators produce samples with low energies, and in the case of protein G, they even generate structures that were previously unseen during the training phase.\n- That the Boltzmann generators samples unseen states might allow to have non equilibrium training data that even misses some meta-stable states, which is important to gain advantages over traditional MD. \n- The work hast the potential to be an important contribution for the community."
            },
            "weaknesses": {
                "value": "- One of the main goals of Boltzmann generators is to generate samples from the equilibrium Boltzmann distribution. As the output distribution will usually differ from the target distribution, Boltzmann generators employ reweighting to the target distribution (Noe et al. 2019). This allows to generate unbiased samples from the target distribution with the Boltzmann generator. However, efficiently doing reweighting requires that the output distribution is close to the target distribution. This can be measured using Kish's effective sample size (ESS), using the reweighting weights. Hence, the ESS should be reported in the paper. Merely presenting the mean energy values of samples does not provide a comprehensive assessment of the Boltzmann generator's ability to efficiently generate samples from the equilibrium distribution. In addition, also reweighted energies distribution could be shown. \n- Boltzmann generators generally struggle to achieve a speed-up over traditional MD simulations, as they require data from these MD simulations to be trained.  The comparison presented in Figure 4 may not be entirely fair, given that generating Boltzmann generator samples necessitates the entire training dataset, which probably took considerably more time to generate than the test data.\n- In general, it does not seem that the method could be made transferable, which makes it difficult to provide a real alternative to traditional MD simulations. \n- The authors should consider discussing this limitation in their work, along with citing relevant work on transferable models for MD acceleration, such as references [1, 2, 3], and the recent advancements in Boltzmann generators for molecules in Cartesian coordinates, e.g. [4, 5]. These could be directly trained in a transferable manner, unlike Boltzmann generators operating in internal coordinates.\n- The code is currently not available\n\nIn summary, I believe that if the authors address these concerns, including reporting the ESS and discussing limitations, their paper has the potential to make a substantial and impactful contribution to the community.\n\n[1] Bowen Jing et al. Torsional diffusion for molecular conformer generation. NeurIPS, 2022\n\n[2] Leon Klein et al. Timewarp: Transferable acceleration of molecular dynamics by learning time-coarsened dynamics. arXiv preprint arXiv:2302.01170, 2023\n\n[3] Xiang Fu et al. Simulate timeintegrated coarse-grained molecular dynamics with multi-scale graph networks. Transactions on Machine Learning Research, 2023.\n\n[4] Leon Klein et al. Equivariant flow matching. arXiv preprint arXiv:2306.15030, 2023.\n\n[5] Laurence I Midgley et al. Se (3) equivariant augmented coupling flows. arXiv preprint arXiv:2308.10364, 2023"
            },
            "questions": {
                "value": "- The 2-Wasserstin loss is supposed to measure the distance between the backbone atom all distance distributions. However, from the notation in Equation (6) it seems as they measure the distance of the backbone bond and torsion angles.\n- Only the mean energy is reported. Although this is computed with only samples with below median energy, I suspect that this mean might still be distorted significantly. Could the authors comment on how the energy distribution looks like when all high energy samples are discarded? In general, high energy samples will have nearly zero weight and are therefore not relevant if the rest of the samples have reasonable energies. Alternatively, one might consider reporting the minimal sampled energy in addition to the mean. That way, it is easier to see which methods do not generate any useful samples. \n- Can the authors elaborate on the time requirements for equilibrium Molecular Dynamics (MD) simulations in comparison to the time required for sampling with a Boltzmann generator?\n- Have the authors attempted to train the baseline model using their proposed training method? This experiment could help discern the relative impact of the new loss function and the proposed architecture on the improved results.\n- What does the energy distribution for HP35 look like? Is it close to the target distribution? What does the reweighted distribution look like?"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "6: marginally above the acceptance threshold"
            },
            "confidence": {
                "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
            },
            "code_of_conduct": {
                "value": "Yes"
            },
            "first_time_reviewer": {
                "value": "Yes",
                "readers": [
                    "ICLR.cc/2024/Conference/Program_Chairs",
                    "ICLR.cc/2024/Conference/Submission8285/Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission8285/Reviewer_3BfG",
                    "ICLR.cc/2024/Conference/Submission8285/Senior_Area_Chairs"
                ]
            }
        },
        "number": 1,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission8285/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698680813856,
        "cdate": 1698680813856,
        "tmdate": 1700691645797,
        "mdate": 1700691645797,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "eahTULk4Wh",
        "forum": "GKxmmAwxj1",
        "replyto": "GKxmmAwxj1",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission8285/Reviewer_xhnH"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission8285/Reviewer_xhnH"
        ],
        "content": {
            "summary": {
                "value": "The authors create a tractable Boltzmann generator for medium sized protein molecules and show it can recapitulate realistic simulations."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "2 fair"
            },
            "contribution": {
                "value": "3 good"
            },
            "strengths": {
                "value": "Table 1 is very clean and interpretable. Generally, this is an ablation study baked into the main results of the paper, which is helpful. \n\nI think it is great that this method scales to something larger than alanine dipeptide! It makes me sad how frequently this is the only system a method is developed on.\n\nI think Figure 3 is also good to show the examples of proteins that the authors are modeling. I think the figure would be improved by showing the secondary structure on the x-axis of the plot."
            },
            "weaknesses": {
                "value": "While I think the background section is helpful, sections 2.2 and 2.3 may be helpful to put into context when discussed in the method. While I realize they are described in detail in previous literature, it seems somewhat disjointed when all presented together.\n\nGenerally, I need some justification as to why ML models need to be fit to simulation data. Can\u2019t I just run the simulation? What does this give us that a simulation doesn\u2019t?\n\n\u201cFor protein G, we use a von Mises base distribution for dihedral coordinates; we noticed that using a von Mises base distribution improved training for the protein G system as compared to a uniform or truncated normal distribution.\u201d Why isn\u2019t this consistent? While I like the Von Mises Distribution, it is odd to me that it isn\u2019t consistent across proteins. As a reader, I want a method I can apply to any protein of interest, or heuristics on which probability distribution to use.\n\nHow was the training and test set defined for Protein G? I\u2019d prefer for any notion of novel conformations to be independently confirmed by the simulation. For Figure 4b and 4c, would they never be observed during the simulation?\n\n\u201cAn overlay of high-resolution, lowest-energy all-atom structures of protein G generated by the BG model. This demonstrates that our model is capable of sampling low-energy conformations at atomic resolution.\u201d - I don\u2019t think this conclusion is validated by the Figure in 4d. The most you can say is that it kind of looks like the same protein?"
            },
            "questions": {
                "value": "How do \u201cmetastable\u201d conformations differ from stable conformations?\n\nFor equation 3, for the upper triangle of a distance matrix, over the sum, one can potentially use the (i < j) notation.\n\n\u201cIn addition, for larger systems, maximum likelihood training often results in high-energy generated samples.\u201d What does this mean in practice?\n\nAny reason in particular for 58 rotational quadratic spline coupling layers? Or any of the other subsequent number of coupling layers in section 4.1?\n\nTable 1: \u201cResults for \u2206D and u(\u00b7) that are within tolerable range are bold-faced,\u201d What is \u201ctolerable range\u201d?\n\nCan you define RMSF? I only have a rough understanding of it based of RMSD.\n\nWhat exactly is unstable during training of these methods? There is a number of works by John Ingraham et al showing instability during training of chaotic systems, particularly of proteins.\n\nFigure 4a - What is the star? I don\u2019t see this defined in the paper."
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "6: marginally above the acceptance threshold"
            },
            "confidence": {
                "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        },
        "number": 2,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission8285/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698722961996,
        "cdate": 1698722961996,
        "tmdate": 1699637030162,
        "mdate": 1699637030162,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "kDzcxC30Gs",
        "forum": "GKxmmAwxj1",
        "replyto": "GKxmmAwxj1",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission8285/Reviewer_2JvV"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission8285/Reviewer_2JvV"
        ],
        "content": {
            "summary": {
                "value": "The paper presents a flow architecture and training scheme that improves scalability of Boltzmann generators, allowing application to macromolecules.\nThe architecture operates on a subset of the internal coordinates (bond angles of side chains are held constant) - which is lower dimensional that the full set of internal coordinates (or cartesian coordinates) while still capturing the most important information on the protein's structure.\nThe authors introduce a 2-Wasserstein loss which encourages the flow to match the marginal distribution of the distance matrices of the backbone atoms, which leads to more realistic samples."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "3 good"
            },
            "contribution": {
                "value": "2 fair"
            },
            "strengths": {
                "value": "- The authors apply their method to larger molecules than much of previous literature - this is an important step away from toy problems like alanine dipeptide. \n- The addition of the Wasserstein loss helps the model generative more realistic molecules that don\u2019t have clashes."
            },
            "weaknesses": {
                "value": "- Multi-stage training strategy introduces complexity that means significant more effort will be required to tune the algorithm. The third stage of training actually contains two stages. Although the rationale behind the individual losses is clear, the authors do not provide much rationale for each stage of the multi-stage training.\n- The architecture is not novel and I do not think this is a significant contribution - internal coordinates have been commonly used, and fixing bond angles of side chains has also been done in literature."
            },
            "questions": {
                "value": "- What is the rationale/intuition behind each stage of the multistage training? For example, how come the Wasserstein loss is dropped for the final training period? Can this be unified into a single training stage (potentially with annealing of some loss coefficients)?\n- The protein-G dataset introduced in the paper seems like it would be useful - will this dataset be released?"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "5: marginally below the acceptance threshold"
            },
            "confidence": {
                "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        },
        "number": 3,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission8285/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698744879311,
        "cdate": 1698744879311,
        "tmdate": 1699637030036,
        "mdate": 1699637030036,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "YyROEkEmcN",
        "forum": "GKxmmAwxj1",
        "replyto": "GKxmmAwxj1",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission8285/Reviewer_VZgX"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission8285/Reviewer_VZgX"
        ],
        "content": {
            "summary": {
                "value": "Based on previous works which use normalizing flows to generate distribution of conformations of proteins, this paper extends the scalability of NFs by (1) using internal coordinates instead of Cartesian coordinates (2) introducing 2-Wasserstein distance as training loss. (3) introducing new architecture. The proposed methods were proved useful in a small \"protein\" ADP and two larger proteins, in terms of distance distortion, energy and NLL loss."
            },
            "soundness": {
                "value": "4 excellent"
            },
            "presentation": {
                "value": "2 fair"
            },
            "contribution": {
                "value": "3 good"
            },
            "strengths": {
                "value": "This paper proposed to use internal coordinates instead of Cartesian coordinates, and split the backbone and side chain. From my point of view, this is the correct way to do protein conformation generation, since the Cartesian coordinates is redundant and highly correlated, whereas the internal coordinate is more compact and less correlated. I like this idea."
            },
            "weaknesses": {
                "value": "Please refer to the \"questions\" section."
            },
            "questions": {
                "value": "1. I didn't fully understand the exact difference between the proposed \"new architecture\" and NSF. Is GAU the difference, or something else? Could you illustrate the difference more explicitly. Thanks.\n2. The experiment results are very good, but it is better to understand what is the key factor for the improvement by more ablation studies, such as NSF+NLL+KL+W2, Cartesian coordinate+your architecture+NLL+KL+W2, etc.\n3. In Table 1, I notice that in Protein G and HP35, some energy are as large as 10^6 to 10^10. What are the reasons for these extremely high energies? If they are caused by some naive reasons, can we quick-fix them to make the comparison more fair?\n4. In Table 1, NLL loss of Protein G is negative, why?"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "6: marginally above the acceptance threshold"
            },
            "confidence": {
                "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        },
        "number": 4,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission8285/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698748254433,
        "cdate": 1698748254433,
        "tmdate": 1699637029906,
        "mdate": 1699637029906,
        "license": "CC BY 4.0",
        "version": 2
    }
]