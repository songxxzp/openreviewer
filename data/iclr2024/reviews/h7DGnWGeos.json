[
    {
        "id": "Kfy0Cp1cUz",
        "forum": "h7DGnWGeos",
        "replyto": "h7DGnWGeos",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission7875/Reviewer_23Kg"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission7875/Reviewer_23Kg"
        ],
        "content": {
            "summary": {
                "value": "This work considers multi-step retrosynthetic search in a scenario where an expensive-but-accurate reaction quality metric is available. This motivates the authors to develop an algorithm that decides to query said metric adaptively, so that it can learn to trade-off the cost of querying it against other costs/rewards inherent to the routes themselves. The authors then run experiments to compare with existing retrosynthetic planning algorithms."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "3 good"
            },
            "contribution": {
                "value": "3 good"
            },
            "strengths": {
                "value": "(S1): The framework proposed by the authors is original, well-motivated, and generally reasonable. The paper also includes valuable discussion. \n\n- (a) In particular, the discussion on how routes produced by existing search algorithms may be not useful in the real world (due to e.g. the reaction being low yield or otherwise infeasible) is useful. This is something that should perhaps be given more attention in the ML-for-retrosynthesis  community. \n\n- (b) The high-level modelling and architectural choices are reasonable and appropriate for the task at hand.\n\n- (c) There are interesting connections of this work to retro-fallback [1] - a very recent parallel work - which is also concerned with the fact that the routes found by off-the-shelf algorithms may not be of high quality. However, I think the attack angles are somewhat complementary, as [1] tries to find _several_ routes that complement each other in their shortcomings, whereas this work focuses on _more accurately estimating the quality of a single route_ through a (possibly expensive) quality oracle. \n\n(S2): The paper is generally well-written and easy to understand (although with some room for improvement; see the \"Questions\" and \"Nitpicks\" sections)."
            },
            "weaknesses": {
                "value": "(W1): My main concern is that it is not very clear to me what the quality metric would actually be in a real-life scenario and how it would be implemented. First, the framework proposed by the authors seems to only make sense if querying the quality metric is _expensive but not too expensive_: if the quality oracle is not much more expensive that the single-step model itself (e.g. if it's a yield prediction model), then there is no need for the adaptive querying; if the metric is very expensive (e.g. asking a human chemist or running the reaction in the lab) then it wouldn't make sense to allow the algorithm to query it autonomously, even if it only does so for e.g. 20% of the cases (as that would still be prohibitively expensive and the human/lab would become a bottleneck). What would a realistic quality metric be? The authors in the paper use a trained model, which perhaps falls into the category of \"not expensive enough to bother with adaptive querying\", unless the model is *much* larger than the single-step model itself. Or perhaps the quality metric could result from e.g. running expensive quantum chemistry simulation, but this is a bit forward-looking as I don't think any existing frameworks for such calculations are robust enough to plug them in directly. Overall, at the very least I would expect more discussion on how the quality metric should be realized in practice. \n\n(W2): The related works section is missing several references of established/SotA models and algorithms. On the single-step side, it is missing LocalRetro [2], RetroKNN [3] and RootAligned [4]. On the multi-step side, it is missing PDVN [5]. \n\n=== Summary ===\n\nI like some aspects of this work, but the general real-world use case could be more discussed. I am looking forward to the rebuttal and, if productive, I may consider revising my score accordingly.\n\n=== Other comments === \n\n(O1): The introduction section casually mentions that the average length of a retrosynthetic route is 3.36 without giving any sources. Where does this come from? I think this number would heavily depend on the precise assumptions, and for very challenging molecules the average route length would be even higher than this. It may be better to change this statement to be more vague (e.g. say that the routes are usually 3 or more steps) and give a citation, instead of using a very specific number which is only true if one fixes a lot of variables. \n\n \n\n=== Nitpicks === \n\nBelow I list nitpicks (e.g. typos, grammar errors), which did not have a significant impact on my review score, but it would be good to fix those to improve the paper further. \n\n- \"while this often leads to substantial query costs\" -> in this context I would replace \"while\" with e.g. \"but\" \n\n- in many places there is a missing space before parenthesis (see the \"Multi-step planning\" part of the \"Related work\" section for some examples) \n\n- \"with is initialized\" -> \"which\" \n\n- \"Moreover, We define\" -> lowercase \"we\" \n\n- \"There are three steps for each roll\" -> \"rollout\"? \n\n- First sentence in the \"Reaction cost annotation\" paragraph is a bit hard to parse \n\n- \"USPTI-MIT\" -> \"USPTO-MIT\"? \n\n- Equation 9 looks as if it's missing some text \n\n \n\n=== References === \n\n[1] Tripp et al, \"Retro-fallback: retrosynthetic planning in an uncertain world\" \n\n[2] Chen et al, \"Deep Retrosynthetic Reaction Prediction using Local Reactivity and Global Attention\" \n\n[3] Xie et al, \"Retrosynthesis Prediction with Local Template Retrieval\" \n\n[4] Zhong et al, \"Root-aligned SMILES: a tight representation for chemical reaction prediction\" \n\n[5] Liu et al, \"Retrosynthetic Planning with Dual Value Networks\"\n\n=== Update 21/11 ===\n\nAfter the rebuttal, I increase my score to 6."
            },
            "questions": {
                "value": "(Q1): Could you expand on \"critic takes both the current molecule and its preceding reaction cost as input\"? Is the previous reaction cost literally concatenated into the molecule representation somewhere as a single floating point number? \n\n(Q2): Is Equation 6 fully correct? I am confused about the fact that it does not include the discount factor $\\gamma$, and also the way $N(s)$ is used seems slightly off; I may be wrong though. \n\n(Q3): Could you elaborate on how the quality metric is used by the baseline algorithms like Retro* to produce the results from Table 2? I understand that for the baselines it is assumed the quality metric is always queried, which leads to 100% query rate. Could you discuss how the resulting quality value is used by the algorithms themselves during optimization? \n\n(Q4): Is the depth of the exhaustive search used to normalize route quality the same as the maximum depth that the search algorithms are allowed to explore?"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "6: marginally above the acceptance threshold"
            },
            "confidence": {
                "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
            },
            "code_of_conduct": {
                "value": "Yes"
            },
            "first_time_reviewer": {
                "readers": [
                    "ICLR.cc/2024/Conference/Program_Chairs",
                    "ICLR.cc/2024/Conference/Submission7875/Senior_Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission7875/Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission7875/Reviewer_23Kg"
                ]
            }
        },
        "number": 1,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission7875/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698779100538,
        "cdate": 1698779100538,
        "tmdate": 1700569624194,
        "mdate": 1700569624194,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "By8myqDbiE",
        "forum": "h7DGnWGeos",
        "replyto": "h7DGnWGeos",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission7875/Reviewer_zSxo"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission7875/Reviewer_zSxo"
        ],
        "content": {
            "summary": {
                "value": "The paper addresses the challenge of retrosynthetic planning when the reaction cost is unknown during the planning process. To balance the trade-off between query costs and route quality evaluation, the authors introduce the Active Retrosynthetic Planning (ARP) framework. This framework employs an actor-critic model to decide whether to query reaction costs and to estimate molecule values. The ARP framework demonstrates a 6.2% improvement in route quality on a benchmark dataset and a 4.9% improvement on an annotated dataset, while reducing the number of query costs."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "3 good"
            },
            "contribution": {
                "value": "3 good"
            },
            "strengths": {
                "value": "- The paper identifies a key issue in retrosynthetic planning: the assumption of knowing the reaction cost for every reaction during the planning phase is impractical. In response, the authors introduce a novel solution by leveraging an actor-critic framework from reinforcement learning to address this problem.\n- The proposed method demonstrates strong empirical performance on top of state-of-the-art methods, as shown in comprehensive evaluations.\n- The proposed method is generic, able to work alongside various existing retrosynthetic planners, enabling their capabilities to balance between query costs and route quality evaluation.\n- The paper introduces the normalized route quality to normalize the scores for different synthesis routes, thus improving the accuracy of planning outcome evaluation."
            },
            "weaknesses": {
                "value": "- In the ablation study, actor+critic does not show consistent and significant improvement on success rate compared with random+critic baseline. The paper should include additional discussion to clarify this issue."
            },
            "questions": {
                "value": "- In the ablation study, why doesn't the actor+critic consistently and significantly improve the success rate compared to the random+critic baseline, as observed with normalized route quality?\n- Why doesn't the success rate change monotonically with the query rate, unlike the normalized route quality?"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "8: accept, good paper"
            },
            "confidence": {
                "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        },
        "number": 2,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission7875/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698799883373,
        "cdate": 1698799883373,
        "tmdate": 1699636965821,
        "mdate": 1699636965821,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "x3FDjzL9vq",
        "forum": "h7DGnWGeos",
        "replyto": "h7DGnWGeos",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission7875/Reviewer_BDYr"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission7875/Reviewer_BDYr"
        ],
        "content": {
            "summary": {
                "value": "This paper aims to consider the route quality (i.e., yield of a reaction) in the retrosynthetic planning problem. Since querying such information requires labor-intensive lab/expert verification, this paper proposes an active planning framework to strike a balance between query cost and route quality. This framework consists of an actor that decides whether to query the cost of a reaction or not and a critic that evaluates whether to expand a molecule or not."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "2 fair"
            },
            "contribution": {
                "value": "3 good"
            },
            "strengths": {
                "value": "1. The route quality in terms of yield is of pivotal significance for practical CASP, and this paper is well motivated from this perspective;\n2. The active planning framework is designed to consider route quality, with balancing the query cost; the actor-critic technique adopted in general is reasonable and justified;\n3. The evaluation using defined metrics support the major claims of balancing query quality and rate."
            },
            "weaknesses": {
                "value": "1. The paper representation can be improved with better clarification. See details in Questions.\n2. Some claims that motivate the method should be verified. See details in Questions.\n3. Important related work [1] that targets on multi-step planning should be discussed.\n\n[1] Liu, Songtao, et al. \"FusionRetro: molecule representation fusion via in-context learning for retrosynthetic planning.\" International Conference on Machine Learning. PMLR, 2023."
            },
            "questions": {
                "value": "#### Unverified Claims\n1. In reaction cost annotation, the authors adopt a surrogate model to provide reaction cost annotation, and hope \u201cthe model prioritizes the identification of high-yield reactions over high-frequency reactions\u201d. Can the authors empirically verify this claim? \n2. Are there real cases when high-yield reactions and high-frequency reactions are not overlapping? Intuitively, high-frequency reactions are usually high-yield ones, otherwise they cannot be frequently collected in a dataset, right?\n\n#### Method\n3. How is the state encoder $\\mathcal{E}$ trained? It should also wrap $s_t$ in Eq. (4), right?\n4. In Selection, is there any exploration or possibility to generate multiple routes? \n5. How is the masked value M set?\n6. During inference, does the method require the external surrogate model to obtain the reaction cost? How accurate/reliable is this surrogate model?\n\n#### Writing\n7. The term \u201creaction cost\u201d is misleading and inconsistent: \u201ccost\u201d usually refers to some undesired property that should be as low as possible, however, this paper defines cost as yield (i.e., higher \u201ccost\u201d indicates better quality). This is misleading and counterintuitive. Meanwhile, \u201cobserving in Fig, 2 that a molecule with a low preceding reaction cost should be prioritized to expand first\u201d, is clearly inconsistent with Fig. 2 (i.e., low-cost=low-quality route should not be prioritized). \n8. The description of Expansion in the inference stage is not clear. Q* sometimes refers to a value, or a function (i.e., in Eq. (5)), which is confusing. What is Q*(a) and Q*(s) exactly?"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "6: marginally above the acceptance threshold"
            },
            "confidence": {
                "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
            },
            "code_of_conduct": {
                "value": "Yes"
            },
            "first_time_reviewer": {
                "readers": [
                    "ICLR.cc/2024/Conference/Program_Chairs",
                    "ICLR.cc/2024/Conference/Submission7875/Senior_Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission7875/Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission7875/Reviewer_BDYr"
                ]
            }
        },
        "number": 3,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission7875/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1699067067563,
        "cdate": 1699067067563,
        "tmdate": 1700584526624,
        "mdate": 1700584526624,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "LGDsq64SJT",
        "forum": "h7DGnWGeos",
        "replyto": "h7DGnWGeos",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission7875/Reviewer_iEQU"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission7875/Reviewer_iEQU"
        ],
        "content": {
            "summary": {
                "value": "an RL based search algorithm that incorporates some definition of route quality for retrosynthesis is proposed.\n\n\nedit after discussion\n- I am still not 100% convinced about the novelty of this work, but nevertheless will raise the score."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "2 fair"
            },
            "contribution": {
                "value": "2 fair"
            },
            "strengths": {
                "value": "- interesting new ideas of using RL for scoring applied to retrosynthesis"
            },
            "weaknesses": {
                "value": "- somewhat disconnected from previous evaluation\n- the model to assign quality is not described in enough detail\n- it is not convincingly defined what reaction quality is\n- prior work is not correctly attributed\n\n\"Practical efficacy: we, for the first time, draw\nan insight into the disappointing practicality of existing retrosynthetic planners that regard single-step probabilities as reaction qualities.\"\n\nDifferent and flexible ways to incorporate step and route cost beyond single step probabilities) was already included in many prior works, for example Segler (2018), Coley (2019) and Schwaller (2020). These works also used reaction feasibility models, which are a proxy for quality. Please reference this accordingly.\nalso, the method seems to be very similar to Liu et al 2023, which is also a very flexible framework able to incorporate arbitary cost. this needs to be discussed more carefully.\nI think the paper can receive higher score if prior work is referenced properly, but in the current form this is insufficient."
            },
            "questions": {
                "value": "- I would suggest to order the related work section, in particular the Multi-step planning section, by the order in which the works appeared, because subsequent works influenced each other."
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "details_of_ethics_concerns": {
                "value": "-"
            },
            "rating": {
                "value": "6: marginally above the acceptance threshold"
            },
            "confidence": {
                "value": "5: You are absolutely certain about your assessment. You are very familiar with the related work and checked the math/other details carefully."
            },
            "code_of_conduct": {
                "value": "Yes"
            },
            "first_time_reviewer": {
                "readers": [
                    "ICLR.cc/2024/Conference/Program_Chairs",
                    "ICLR.cc/2024/Conference/Submission7875/Senior_Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission7875/Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission7875/Reviewer_iEQU"
                ]
            }
        },
        "number": 4,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission7875/-/Official_Review"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1700694125287,
        "cdate": 1700694125287,
        "tmdate": 1700740837071,
        "mdate": 1700740837071,
        "license": "CC BY 4.0",
        "version": 2
    }
]