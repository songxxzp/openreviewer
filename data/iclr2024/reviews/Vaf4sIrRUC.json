[
    {
        "id": "Clsjd2puxi",
        "forum": "Vaf4sIrRUC",
        "replyto": "Vaf4sIrRUC",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission6386/Reviewer_VMQ3"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission6386/Reviewer_VMQ3"
        ],
        "content": {
            "summary": {
                "value": "The paper introduces AlignProp, a novel method for aligning text-to-image diffusion models with specific reward functions. The authors argue that existing reinforcement learning methods are inefficient due to high variance gradients. AlignProp aims to overcome these limitations by using end-to-end backpropagation to fine-tune the model. The paper also discusses techniques to manage memory overhead, such as fine-tuning low-rank adapter (LoRA) modules and using gradient checkpointing."
            },
            "soundness": {
                "value": "2 fair"
            },
            "presentation": {
                "value": "2 fair"
            },
            "contribution": {
                "value": "2 fair"
            },
            "strengths": {
                "value": "Comparative Analysis: The paper does a good job of positioning AlignProp against existing methods, particularly reinforcement learning techniques. This helps in understanding the unique advantages of AlignProp.\n\nResults: The paper claims that AlignProp achieves higher rewards in fewer training steps and is preferred by human users, although the empirical evidence supporting these claims could be strengthened."
            },
            "weaknesses": {
                "value": "* The writing is not good. \\cite and \\citep are different. And there are many other typos and missing/wrong references, which cause some difficulties in understanding the work.\n* The idea is simple and straightforward. If authors want to convince me to increase the score and demonstrate the effectiveness of the approach,  can authors provide an anonymous  website to list un-cherry-picked images across different iterations and different methods? It is good to use open-eval prompts, such as the ones provided in part image generation eval benchmark."
            },
            "questions": {
                "value": "See above"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "3: reject, not good enough"
            },
            "confidence": {
                "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        },
        "number": 1,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission6386/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698128758385,
        "cdate": 1698128758385,
        "tmdate": 1699636707491,
        "mdate": 1699636707491,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "184LF3eAzd",
        "forum": "Vaf4sIrRUC",
        "replyto": "Vaf4sIrRUC",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission6386/Reviewer_e5M5"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission6386/Reviewer_e5M5"
        ],
        "content": {
            "summary": {
                "value": "This paper aims at aligning a pre-trained text-to-image diffusion model with downstream objectives using the most straightforward way. The proposed AlignProp fully reconstructs the input images during training, which are then taken as input to an off-the-shelf reward model for end-to-end reward optimization. The authors utilize several well-acknowledged optimization tricks for better GPU memory management and aligning efficiency. The extensive experiments demonstrate the superiority of AlignProp."
            },
            "soundness": {
                "value": "2 fair"
            },
            "presentation": {
                "value": "3 good"
            },
            "contribution": {
                "value": "1 poor"
            },
            "strengths": {
                "value": "- The authors construct this paper with clear architecture and detailed discussion.\n- The proposed method is fairly simple with extensive experiment results.\n- The motivation is relatively clear and consistent with the human intuition."
            },
            "weaknesses": {
                "value": "- Novelty would be a controversial problem of this paper:\n  - Methodology: The main technical components of this paper consist of two parts: 1) directly propagating the reward back to the diffusion models without RL, following DDPO, and 2) spanning the whole denoising process and perform back propagation through time, which has been utilized for diffusion model guidance / alignment early in DiffusionCLIP published in CVPR 2022.\n  - Implementation: According to the authors, the main difficulty of applying the methodology above in the considered datasets is the high GPU memory usage, which, however, can be simply solved by several commonly used optimization tricks of diffusion models including LoRA, gradient checkpointing and gradient truncation.\n  - Therefore, although nobody has conducted experiments by combining all these things together before, it is still hard to convince me that there exists a novel research problem and this work should be considered as a research paper for top-tier conference like ICLR instead of a solid technical report.\n- About compute efficiency\n  - In order to propagate gradient back to the whole sample chain, AlignProp needs to perform the whole T (=50 according to the authors) for each data sample during training even with DDIM, which instead requires only 2 steps for DDPO, and this is a huge efficiency gap.\n  - Therefore, I cannot understand why in the 2nd row of Fig. 4, AlignProp can demonstrate efficiency even with respect to Time. Can you give more implementation details about how these experiments are conducted, and why the re-implemented DDPO converges so quickly?\n  - Another perceptive to view DDPO and AlignProp together is that both of them are working on a practical estimation towards fully fine-tuning UNet with respect to reward models using BPTT. DDPO chooses to back propagate only one step, while AlignProp chooses to use LoRA and gradient checkpointing.\n  - Therefore, a more fair comparison should be between AlignProp and DDPO with fully fine-tuning and no gradient checkpoint.\n\n- About generalization of the proposed AlignProp:\n  - I wonder if AlignProp can generalize to any circumstances as long as there exists a reward model.\n  - In other words, if the alignment ability requires the pre-trained diffusion models have the downstream-desired generation ability at first (e.g., Aesthetics). For example, can AlignProp be applied to allow Stable Diffusion to generate medical images with a reward model trained on medical images?\n  - In the 2nd paragraph, the authors claim that the motivation to utilize reward models instead of supervised fine-tuning is the requirement of high-quality data samples. However, in my understanding even aligning with reward models still require these high-quality samples with high rewards for alignment optimization."
            },
            "questions": {
                "value": "- Implementation details:\n  - During fine-tuning, are the reward model parameters $\\phi$ fixed or also tunable?\n  - What is the specific T value (i.e., total denoising steps) utilized in your experiments? According to the \"Baselines\" paragraph in Sec. 5, the T value is set to be 50, which, however, is 1000 for Stable Diffusion trained with DDPM during pre-training.\n- Writing:\n  - Fix the citation style by using the correct latex command.\n  - Typo in the 2nd line of Page 5 ($\\pi_{\\theta}$ instead of $\\pi_theta$)"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "5: marginally below the acceptance threshold"
            },
            "confidence": {
                "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        },
        "number": 2,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission6386/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698669206948,
        "cdate": 1698669206948,
        "tmdate": 1699636707354,
        "mdate": 1699636707354,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "3L6tXfRCox",
        "forum": "Vaf4sIrRUC",
        "replyto": "Vaf4sIrRUC",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission6386/Reviewer_JeN1"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission6386/Reviewer_JeN1"
        ],
        "content": {
            "summary": {
                "value": "This paper introduces \"AlignProp,\" a technique that refines text-to-image diffusion models using end-to-end backpropagation of the reward gradient during the denoising phase. Rather than consuming excessive memory, AlignProp fine-tunes low-rank weight modules and uses gradient checkpointing. When tested, AlignProp efficiently optimized diffusion models for various objectives like semantic alignment and aesthetic enhancement. It outperformed existing methods, achieving better results in fewer steps, making it a preferred choice for optimizing diffusion models."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "3 good"
            },
            "contribution": {
                "value": "2 fair"
            },
            "strengths": {
                "value": "The experiments conducted are comprehensive and of high quality."
            },
            "weaknesses": {
                "value": "1. **Originality & Novelty:** The paper seems to lack significant originality and novelty. Implementing the two memory-saving techniques - finetuning with LoRA and gradient checkpointing - does not appear challenging, especially since they are already available in the \u201cdiffusers\u201d package. Further, randomizing the number of denoising steps appears to be a straightforward approach, and it's not guaranteed to address the collapsing issue.\n\n2. **Previous Work Reference:** The concept of using a differentiable reward function and backpropagating the gradient directly to each timestep was earlier introduced in the Diffusion-QL[1] paper. It would be beneficial to cite the D-QL paper. There's also another very recent concurrent work on the subject [2].\n\n3. **Issue of Collapsing:** Both the present paper and [2] have highlighted the issue of collapsing when using a differentiable reward function for backpropagation. As demonstrated in the DDPO paper, using policy gradient through a non-differentiable reward signal doesn't present this issue. A more detailed exploration of the collapsing issue, along with effective mitigation strategies, would be a valuable addition. The currently proposed method of randomized denoising length seems somewhat simplistic. A more robust solution, accompanied by a thorough analysis, is anticipated.\n\n[1] Wang, Zhendong, Jonathan J. Hunt, and Mingyuan Zhou. \"Diffusion policies as an expressive policy class for offline reinforcement learning.\" arXiv preprint arXiv:2208.06193 (2022).\n\n[2] Clark, Kevin, et al. \"Directly Fine-Tuning Diffusion Models on Differentiable Rewards.\" arXiv preprint arXiv:2309.17400 (2023)."
            },
            "questions": {
                "value": "1. In Figure 4, the HPSv2_Score is noted as ranging from 2.4 to 3.6. However, to the left of Table 1, the paper mentions a score of 0.28. Is this a typographical error?\n\n2. In Figure 5, the color map and object shapes from AlignProp appear quite similar. Yet, the results from Stable Diffusion and DDPO exhibit greater diversity. Could you clarify this?"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "5: marginally below the acceptance threshold"
            },
            "confidence": {
                "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        },
        "number": 3,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission6386/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698787853867,
        "cdate": 1698787853867,
        "tmdate": 1699636707154,
        "mdate": 1699636707154,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "u9jkSnoxoI",
        "forum": "Vaf4sIrRUC",
        "replyto": "Vaf4sIrRUC",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission6386/Reviewer_MYQY"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission6386/Reviewer_MYQY"
        ],
        "content": {
            "summary": {
                "value": "In this paper proposes AlignProp, a method that aligns diffusion models to downstream reward functions using end-to-end backpropagation of the reward gradient through the inference chain. The main challenge the paper is trying to solve is the prohibitive memory cost required by naive implementation of such backpropagation."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "3 good"
            },
            "contribution": {
                "value": "2 fair"
            },
            "strengths": {
                "value": "- The paper studies an important problem of end-to-end backpropagating a reward function through the denoising process.\n- The presented results look promising and the experiments are extensive and convincing."
            },
            "weaknesses": {
                "value": "- Clarification: in eq 3, does the first term come from weight decay?\n- Typos: 1) eq 3 and 4, cdot notations are not consistent; 2) page 5 \"policy \\pi_{theta}\"; 3) page 5 \"k\"m\".\n- Figure 3 presents visual results on a single image, which seems not \"comprehensive\" enough to study the impact of value of K (as stated in the last paragraph in page 5)."
            },
            "questions": {
                "value": "- It might be interesting to study other PEFT methods besides LoRA."
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "6: marginally above the acceptance threshold"
            },
            "confidence": {
                "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        },
        "number": 4,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission6386/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698872794427,
        "cdate": 1698872794427,
        "tmdate": 1699636707029,
        "mdate": 1699636707029,
        "license": "CC BY 4.0",
        "version": 2
    }
]