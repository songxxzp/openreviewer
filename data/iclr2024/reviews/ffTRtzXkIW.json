[
    {
        "id": "elixQpU4ux",
        "forum": "ffTRtzXkIW",
        "replyto": "ffTRtzXkIW",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission4732/Reviewer_58y7"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission4732/Reviewer_58y7"
        ],
        "content": {
            "summary": {
                "value": "This paper addresses the reward misalignment problem in IRL, which refers to the problem that reward maximization does not guarantee task success. To address this problem, PAGAR introduces both an antagonist policy - an optimal policy trained to perform similarly to the expert - and a protagonist policy that is trained to be closer to the antagonist policy using a PPO-style objective function. PAGAR then derives a reward function that maximizes the performance difference between the protagonist policy and the antagonist policy. When the performance margin remains within a certain bound, the protagonist policy's performance with the updated reward function does not fall below a certain threshold, indicating reward alignment. By training the protagonist policy in a minimax manner, the authors argue that an aligned reward function can be identified and used to optimize the policy. The authors demonstrate PAGAR's performance in partially observable navigation tasks and transfer environments."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "3 good"
            },
            "contribution": {
                "value": "3 good"
            },
            "strengths": {
                "value": "The authors conducted a thorough analysis of reward function alignment and successfully applied their insights within the IRL framework. They demonstrated that the PAGAR-(IRL) algorithms outperform baselines, requiring fewer samples and enabling zero-shot imitation learning in transfer environments."
            },
            "weaknesses": {
                "value": "There are a few minor typos present:\n\n- On the 2nd line from the bottom in Figure 1, $U_{r^-}(\\pi^-) \\rightarrow U_{r^-}(\\pi^*)$.\n- On the 5th line from the bottom, please confirm whether the direction of the inequality sign is correct.\n- On the first line in section 2, Related works, contextx should be changed to contexts."
            },
            "questions": {
                "value": "I'm curious if the antagonist policy can be a non-optimal policy. In Figure 2 (b), VAIL does not appear to have enough successful episodes to qualify as an optimal policy and serve as a proxy. Would it be acceptable for the policy to have non-zero returns instead of being fully optimal?"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "6: marginally above the acceptance threshold"
            },
            "confidence": {
                "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
            },
            "code_of_conduct": {
                "value": "Yes"
            },
            "first_time_reviewer": {
                "value": "Yes",
                "readers": [
                    "ICLR.cc/2024/Conference/Program_Chairs",
                    "ICLR.cc/2024/Conference/Submission4732/Senior_Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission4732/Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission4732/Reviewer_58y7"
                ]
            }
        },
        "number": 1,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission4732/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698735094370,
        "cdate": 1698735094370,
        "tmdate": 1699636455074,
        "mdate": 1699636455074,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "tdr4WGkZTN",
        "forum": "ffTRtzXkIW",
        "replyto": "ffTRtzXkIW",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission4732/Reviewer_rmTC"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission4732/Reviewer_rmTC"
        ],
        "content": {
            "summary": {
                "value": "The paper is inspired by unsupervised environment design (UED) [Dennis et al. 2020] which optimizes a protagonist policy an antagonist policy and the dynamics parameters with respect to the regret (performance difference between antagonist and protagonist; protagonist aims to minimize the regret, antagonist and \"environment\" aim to maximize regret). However, in contrast to that prior work, the current submission tackles the imitation learning setting, by maximizing the regret with respect to a reward function instead of dynamics parameter. The motivation for this approach is to learn policies that perform well across a distribution of reward function making them less susceptible to reward misalignment, where a policy performs well on an inferred reward function but still fails in the underlying task."
            },
            "soundness": {
                "value": "2 fair"
            },
            "presentation": {
                "value": "1 poor"
            },
            "contribution": {
                "value": "3 good"
            },
            "strengths": {
                "value": "Although there is a close connection to UED, the application to imitation learning is quite original.\n\nI also think that the problem setting, focusing on solving the actual underlying task, is very relevant."
            },
            "weaknesses": {
                "value": "1. Clarity\n------------\nI'm struggling to make sense of some parts of the work. For now, I view these as clarity issues that I hope the authors can address in the rebuttal, but there may also be issues regarding soundness or relevance:\n\n- I'm not fully convinced of the motivation for the method. The paper argues that existing IL/IRL methods may fail in optimizing the underlying task because they learn a policy that optimizes a misaligned reward function. However, I do not think that the typically used problem formulation suffer from such problems. For example IL methods are often formulated as divergence minimization problems, and assuming that they succeed in bringing the divergence to zero, they would perform as well as the expert on any reward function. Of course, in practice we will typically not achieve zero divergence due function approximations, limited data and potentially unstable optimization, but I don't think that these challenges are specific to the problem formulation and they affect the proposed method in similar way. For some IRL methods, it was even shown that the optimal policy for the learned reward function may outperform the (suboptimal) expert, in the sense that it performs no worse but potentially better on every reward function within the hypothesis space. With that in mind, I also find Example 1 quite misleading. The example argues that IRL would lead to a bad policy in a simple toy problems, by arguing that a constant reward function would solve the IRL problem. However, already Ng & Russell [2000] noted, that such IRL formulation would be illposed, and additional constraints / objectives are required. For example, MaxEnt-IRL would maximize the likelihood for a MaxEnt-policy, where a constant reward function (leading to a uniform policy) would certainly not be a solution in the toy problem.\n\n- The conditions used in Theorem 1 are not satisfiable if the hypothesize space of the reward function includes a reward function for which there is no gap between the best performing failing policy and a succeeding policy. For example, if a task is considered to succeed when the distance to a goal is below a certain threshold, and the reward uses a quadratic penalty on the distance to the threshold as cost, we can get arbitrary close in terms of reward to a succeeding policy while still failing. Potentially related to this, it not clear to me how the method optimizes with respect to a distribution $\\mathcal{P}\\_{\\pi}(r)$ over reward functions. Where does this distribution appear in Algorithm 1?\n\n- Section 4.2 defines a set $R\\_{E,\\delta} =  \\\\{ r \\| U\\_{r}(E) - \\underset{\\pi \\in \\Pi}{\\max} U\\_{r}(\\pi) \\ge \\delta \\\\}$ where $\\delta$ is chosen to be strictly positive. Wouldnt this set be empty if the expert policy is in $\\Pi$?\n\n- I am wondering how the success of a policy or its performance can be deterministic, given that both policy and environment are stochastic.\n\n- The transfer experiment is not clear to me. Is the learned policy transferred to the new environment, or is it learned from scratch in the new environment, using demonstration from the source environment?\n\n2. Evaluation\n-------------\nThe experimental results in the continuous domain are not convincing. For example, IQ-Learn should clearly outperform GAIL in these environments. The paper states that it should perform better if a bigger replay buffer was used, but then I wonder why no adequate hyperparameter tuning was performed for the comparisons,"
            },
            "questions": {
                "value": "For questions, please refer to my comments under \"Weaknesses\"."
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "5: marginally below the acceptance threshold"
            },
            "confidence": {
                "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        },
        "number": 2,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission4732/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698764235773,
        "cdate": 1698764235773,
        "tmdate": 1699636454967,
        "mdate": 1699636454967,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "qypCZRHCEf",
        "forum": "ffTRtzXkIW",
        "replyto": "ffTRtzXkIW",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission4732/Reviewer_BsED"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission4732/Reviewer_BsED"
        ],
        "content": {
            "summary": {
                "value": "The paper introduces a method for reducing reward misalignment in RL and IL settings. The method follows the paradigm introduced in PAIRED, where there is a triple-level objective: the protagonist tries to minimize regret, a design agent selects a reward function to maximize regret, and the antagonist also tries to maximize regret. The paper first formalizes task-reward alignment using the introduction of success and failure intervals. Regret is defined as the difference in expected return achieved by the best-case antagonist and the protagonist. Then the authors provide a theoretical result demonstrating that, under certain conditions, the protagonist policy optimizing for minimax regret can guarantee avoiding failing the task and possibly succeed as well. Next the authors analyze the IL setting, where expert demos are provided in lieu of a reward function. Then they provide an algorithm for PAGAR-based IL, which alternates between the policy optimization steps (for P and A) and reward selection step. The policy optimization step is fairly straightforward using a PPO-style objective. Reward selection for regret maximization uses bounds on the difference in expected return between P and A using only the samples of one policy. Experiments are conducted in maze navigation and MuJoCo continuous control tasks, both demonstrating PAGAR can mitigate reward misalignment."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "1 poor"
            },
            "contribution": {
                "value": "2 fair"
            },
            "strengths": {
                "value": "The strengths of this paper are 1) the novelty in applying PAIRED's paradigm to reward misalignment and 2) the very appreciable amount of technical novelty. Regarding the latter, the authors formalize task-reward misalignment (which is generally only explained intuitively), define regret for the reward misalignment mitigation problem, and give algorithms for both RL and IL with PAGAR. The authors provide theoretical results showing that under certain conditions, PAGAR's minimax regret objective, if optimized perfectly, is able to guarantee avoiding task failure and possibly succeed, in both the RL and IL settings. These are important and strong results. \n\nExperiments are provided in both gridworlds/discrete envs and continuous envs."
            },
            "weaknesses": {
                "value": "The paper was very difficult to follow. There was quite a lot of new notation introduced for a fairly intuitive concept, and it was prohibitively difficult to keep track of all the new notation, definitions, and theorems. I was not able to fully appreciate the implications of the theory. I would be willing to raise my score if the paper were made significantly more readable, since this is an interesting and novel idea.\n\nIn particular, the paper does not answer the question of how the set R (under which reward optimization is performed) is chosen in the RL setting, instead redirecting to the IL setting. Is PAGAR meant to be applied in the RL setting or is the selection of R prohibitively difficult and therefore PAGAR as described is only applicable in practice to IL? It would help to make this more explicit.\n\nIn the IL setting, it seems that generation of the R_E,delta set is difficult, but it is not discussed how to obtain such a set. Example 1 does not provide intuition for the basis functions it chose to parameterize R_E so it was difficult to understand. Is the discussion at the bottom of pg 5 meant to be a construction of R_E or just a non-constructive description? \n\nThe paper is missing a discussion of the computational complexity of PAGAR, both theoretically and empirically. This is a crucial property of the method. \n\nExperiments are only conducted with a very limited number of demonstrations (10). I don't find this realistic for real-world deployment where we care about alignment. Is this because providing more demonstrations would reduce misalignment and thus the need for a complicated method like PAGAR?"
            },
            "questions": {
                "value": "- Is PAGAR meant to be applied in the RL setting or is the selection of R prohibitively difficult and therefore PAGAR as described is only applicable in practice to IL?\n- Is the discussion at the bottom of pg 5 meant to be a construction of R_E or just a non-constructive description? \n- how difficult is it to specify success/failure for non-binary-outcome tasks in general? \n- definition 2 is not a definition as written, it is a claim about the method.\n- how strong of a condition is (2) in theorem 1?\n- some of the lines in figure 2 look like they are still increasing and not yet converged. can you run them for longer?\n- in figure 2 does timesteps count just the protagonist or everyone? if not, can you compare with # FLOPS as well? I imagine PAGAR is quite a bit more expensive. \n- is AIRL a suitable baseline? it's also disentangled from transition dynamics which is related to your objective for the zero-shot transfer experiments. \n- can you provide more details what exactly the transfer is? is it transferring from one random instantiation of a family of envs to another?\n- It is odd to put a definition in the intro, I would suggest keeping the intro at a high level and moving the definition to a following section. \n- I noticed that often a definition would introduce many new objects at once and require reading an equation given later in order to appreciate a previous sentence. I would recommend re-ordering the presentation of material such that the flow of understanding is always moving forward, which can be accomplished by introducing new terms/definitions/concepts one step at a time and building up from the first object the reader should know (and can understand without needing to pull in other objects first)."
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "3: reject, not good enough"
            },
            "confidence": {
                "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
            },
            "code_of_conduct": {
                "value": "Yes"
            },
            "first_time_reviewer": {
                "value": "Yes",
                "readers": [
                    "ICLR.cc/2024/Conference/Program_Chairs",
                    "ICLR.cc/2024/Conference/Submission4732/Senior_Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission4732/Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission4732/Reviewer_BsED"
                ]
            }
        },
        "number": 3,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission4732/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698825138693,
        "cdate": 1698825138693,
        "tmdate": 1699636454901,
        "mdate": 1699636454901,
        "license": "CC BY 4.0",
        "version": 2
    }
]