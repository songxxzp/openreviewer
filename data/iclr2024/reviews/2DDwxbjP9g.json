[
    {
        "id": "TPe6U4Facq",
        "forum": "2DDwxbjP9g",
        "replyto": "2DDwxbjP9g",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission3136/Reviewer_hGFX"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission3136/Reviewer_hGFX"
        ],
        "content": {
            "summary": {
                "value": "This papers offers a new look into the \"Do Wasserstein GANs approximate the Wasserstein distance\" debate. The authors argue, despite previous litterature, that Wasserstein GANs actually __do__ minimize the Wasserstein distance. To justify this conceptual shift, they look at the form of the distance w.r.t. the choice of discriminator architecture. In this sense, the authors propose the idea of \"patch Wasserstein distance\", which is a Wasserstein distance between groups of patches. In their paper, the authors argue that, when the discriminator takes the form of a CNN, the WGAN minimizes this novel distance."
            },
            "soundness": {
                "value": "2 fair"
            },
            "presentation": {
                "value": "2 fair"
            },
            "contribution": {
                "value": "2 fair"
            },
            "strengths": {
                "value": "The authors tackle an important and relevant point in the intersection of Generative Modeling and Optimal Transport, that is, whether or not Wasserstein GANs actually minimize the Wasserstein distance. This problem is of key importance for the theoretical understanding of popular, optimal transport-based generative neural networks. The authors' writing is engaging, and they present their ideas and arguments in a fluid way."
            },
            "weaknesses": {
                "value": "__Major__\n\n- __W1.__ The \"Discrete Wasserstein GAN\" corresponds to computing the (primal) Wasserstein distance between mini-batches sampled from the noise distribution, that is, $x\\_{i} = f(z\\_{i})$ and mini-batches sampled from the data set, that is, $y\\_{i}$. However, such strategy was already described in two works: [Genevay, Peyr\u00e9 and Cuturi, 2018] and [Salimans et al., 2018]. Authors should include an appropriate citation to these works, and include a comparison with them in the discussion, highlighting, for instance, the effects of using exact OT (authors submission) in place of Entropic OT (previous work).\n\n- __W2.__ The authors discussion is confusing w.r.t. the estimation of Wasserstein distances. For instance, Eqns. 1 and 2 refer to continuous OT, where $P$ and $Q$ are two distributions/measures. However, Eqn. 3 refers to a discrete OT, or, more formally, to an empirical estimate of the Wasserstein distance. __The authors could improve notation__. For instance, for (continuous) $P$ and $Q$, one has the true value of the Wasserstein distance $W_{p}(P, Q)$, which cannot be estimated directly since $P$ and $Q$ are unknown or too complicated. In contrast, when approximating $P$ and $Q$ empirically, one has indeed the discrete OT cost $W_{p}(\\hat{P}, \\hat{Q})$, based on sampled drawn from $P$ and $Q$. Note that this is an __empirical estimate__ (thus a random variable) and may be differ from the true $W_{p}(P, Q)$. With this remark in mind, authors should update their notation and discussion, making clear __what is minimized throughout GAN optimization__. Furthermore, the authors could consider the work of [Fatras et al., 2020], who explore in approximating OT through mini-batches. In my view, this play a major role in the learning of GANs (and any OT-base minibatch optimization algorithm for that matter).\n\n- __W3.__ The theoretical results of the paper are a bit imprecise. On this point, I refer authors to my questions.\n\n- __W4.__ Some notions introduced by the authors are never defined properly.\n\n__Minor.__ Note, the minor points did not affect my overall score.\n\n- Abstracts should be 1 paragraph long.\n\n- __Notation.__ While using $W1$ for the Wasserstein distance is readable, authors should consider using subscripts (e.g., $W_{1}$). Also, for the sake of uniformity, authors should use $W_{1}$ along the paper (e.g., in Eqn. authors use $W(P, Q)$). Whenever authors discretize continuous OT, especially from samples, the authors should consider using \"$\\hat{\\cdot}$\", to highlight that the said quantity is an estimate rather than the true value.\n\n__References__\n\n[Genevay, Peyr\u00e9 and Cuturi, 2018] Genevay, A., Peyr\u00e9, G., & Cuturi, M. (2018, March). Learning generative models with sinkhorn divergences. In International Conference on Artificial Intelligence and Statistics (pp. 1608-1617). PMLR.\n\n[Salimans et al., 2018] Salimans, T., Zhang, H., Radford, A., & Metaxas, D. (2018, February). Improving GANs Using Optimal Transport. In International Conference on Learning Representations.\n\n[Fatras et al., 2020] Fatras, K., Zine, Y., Flamary, R., Gribonval, R., & Courty, N. (2020, June). Learning with minibatch Wasserstein: asymptotic and gradient properties. In International Conference on Artificial Intelligence and Statistics (pp. 2131-2141). PMLR."
            },
            "questions": {
                "value": "- __Q1.__ The argmin in Eqn. 4 is taken w.r.t. which variable? Furthermore, I am curious if there is any relationship of this eqn. and the Barycentric Projection used in [Courty et al., 2017] (e.g., Eqn. 13 of the said reference)\n\n__Related to Weakness 3.__\n\n- __Q2.__ In __Theorem 2__ of the paper, the authors use \"approximately minimizing\" in their statement. On the paragraph following the proof the authors mention,\n\n> The term \u201dapproximately minimizing\u201d in the theorem statement is the same as in the original proof of WGANs\n\nCould you clarify to which proof the authors refer? Note that there are multiple theorems in the WGAN paper. Furthermore, I would like that the authors clarify what __approximately minimizing__ means. Does this comes from the fact of using mini-batches? Does this comes from the Lipschitzness constraint?\n\n- __Q3.__ __Theorem 3__ is defined in loose terms, and is overall confusing. First, it is not clear how the distributions playing a role in this theorem are defined. Second, the authors seem to consider the \"patch Wasserstein distance\" between samples from underlying distributions. In this sense one would expect that the statement would hold w.r.t. a given probability according to the choice of samples (e.g., PAC theory), but the authors never offer any such analysis. An example on why this raises problems is with statements of the sort _\"Since the number of patches is large in the M generated images and in the training set, and they come from the same distribution, then the Wasserstein distance over patches will be close to zero\"_. Note that this statement is not informative since one does not know _how close to zero_ the said distance gets. A similar remark can be made about the second sentence, _\"On the other hand, when we take the linear combination of $M / N$ different images we will almost always create additional patches that are not one of the $K$ possible patches in the distribution\"_. Here, even if we agree that the linear combination operation will generate patches not in the possible set of patches (and that is not guaranteed, as it depends on the set of patches being combined!), the affirmation that this occurs _almost always_ is very loose. Again, it should be defined as a probability over the choice of samples."
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "3: reject, not good enough"
            },
            "confidence": {
                "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
            },
            "code_of_conduct": {
                "value": "Yes"
            },
            "first_time_reviewer": {
                "value": "Yes",
                "readers": [
                    "ICLR.cc/2024/Conference/Program_Chairs",
                    "ICLR.cc/2024/Conference/Submission3136/Senior_Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission3136/Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission3136/Reviewer_hGFX"
                ]
            }
        },
        "number": 1,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission3136/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1697638598451,
        "cdate": 1697638598451,
        "tmdate": 1699636260726,
        "mdate": 1699636260726,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "bsXKNWi3Wb",
        "forum": "2DDwxbjP9g",
        "replyto": "2DDwxbjP9g",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission3136/Reviewer_L98k"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission3136/Reviewer_L98k"
        ],
        "content": {
            "summary": {
                "value": "This paper proposes to analyze an intriguing property of Wasserstein GANs, which suggests that their success may be attributed to a partial failure in minimizing the Wasserstein distance. The authors demonstrate that, when applied to image data, the characteristics of the generated images are, in fact, influenced by the architecture of the discriminator. They use a discrete setting, where the generator takes as input a vector from a set of M vectors. Their study reveals the following findings:\n1. WGANs with fully connected discriminators do effectively minimize the Wasserstein distance.\n2. WGANs with CNN+GlobalAvgPool discriminators minimize a Patch-based Wasserstein distance.\n3. WGANs with CNN discriminators minimize location-specific patch Wasserstein distance."
            },
            "soundness": {
                "value": "2 fair"
            },
            "presentation": {
                "value": "3 good"
            },
            "contribution": {
                "value": "2 fair"
            },
            "strengths": {
                "value": "* The authors analyze and showcase the impact of the discriminator's architecture and inductive bias on the images generated by a WGAN. Doing so, they partly answer the question of what do WGANs actually minimize, since there are suspicions that they do not minimize the Wasserstein distance.  \n\n* The paper is well written and easy to read."
            },
            "weaknesses": {
                "value": "* Missing an important reference [1] which tackles and solves the same question. They prove theoretically that WGANs-GP actually correspond to the minimization of a \"congested transport distance\" rather than the standard Wasserstein distance. The authors claim that it explains the diversity observed in generated distributions, since this distance penalizes \"congestion\" in transport plans. What can you comment on this? \n[1] Tristan Milne and Adrian I. Nachman. \"Wasserstein gans with gradient penalty compute congested transport.\" Conference on Learning Theory. PMLR, 2022.\n\n* What about WGANs with transformer architectures, which also generate sharp images although they have no inductive bias for patch learning? Or other architectures like MLP-Mixer? Notably, TransGAN [2] uses a WGAN-GP loss and still generates high-quality images. \n\n[2] Jiang, Y., Chang, S., & Wang, Z.. Transgan: Two pure transformers can make one strong gan, and that can scale up. NeurIPS 2021.\n\n* About the interpretation of CNN-GAP and Theorem 2: Depending on the depth of the neural net and kernel size of convolutional filters, the receptive field of each patch might actually be the whole image. Then, why would it lead to different results than the fully connected discriminator? Wouldn't it be another reason, like optimizability of the neural net, explaining the fact that we have different results?  To verify this, it could be interesting to progressively increase the size of receptive field, and observe the changes in the generated images. \n\n* About the setting $M<<N$ : is it really realistic when GANs actually try to approximate a discrete distribution (empirical distribution with N training points) with a continuous one (generator with continuous latent space)?  How to connect the results with $M<<N$ to the realistic setting? What does it say about the realistic setting? This is not clear from the paper.\n\n* \"As is common in WGAN training we do not train the discriminator until convergence but rather do a single update after each mini-batch and use the gradient penalty to regularize the generator\" Actually, in WGANs, discriminators are generally either updated for several steps per generator update, either have a larger learning rate than generators (TTUR). This might lead to a problem in your setting (2.1). If the discriminators was trained optimally, we could expect the generator to overfit and to reproduce some images of the training set. How come does it not happen? Is it because of your setting M<<N, or could it happen because of suboptimal optimization? \n\n* The multi-scale minimization of SWD seems interesting but should be studied more in depth. Moreover, it should be explained more carefully, at least with some equations or with an algorithm.\n\n* Minor remarks on writing/formatting problems: title, some citations are not well included in the text (page 3: \"the POT package Flamary et al. (2021)\" or \"reweighted least squares. Weiszfeld (1937)\"), no end to the proof of Theorem 2, 'locaton' -> 'location' page 8, \"in defence of wasserstein\" in the Openreview title."
            },
            "questions": {
                "value": "See weaknesses."
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "3: reject, not good enough"
            },
            "confidence": {
                "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
            },
            "code_of_conduct": {
                "value": "Yes"
            },
            "first_time_reviewer": {
                "value": "Yes",
                "readers": [
                    "ICLR.cc/2024/Conference/Program_Chairs",
                    "ICLR.cc/2024/Conference/Submission3136/Senior_Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission3136/Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission3136/Reviewer_L98k"
                ]
            }
        },
        "number": 2,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission3136/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698067765677,
        "cdate": 1698067765677,
        "tmdate": 1699636260649,
        "mdate": 1699636260649,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "5bUyfZ0Mdw",
        "forum": "2DDwxbjP9g",
        "replyto": "2DDwxbjP9g",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission3136/Reviewer_ZrfD"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission3136/Reviewer_ZrfD"
        ],
        "content": {
            "summary": {
                "value": "The paper contributes to a debate \"do Wasserstein GANs actually optimize Wasserstein distance and is that why they work well?\"\n\nIt's previously been noted that a batch of blurry Kmeans images achieve better Wasserstein distance than a batch of real images. It brought up a question if W1 is a sensible optimization metric for generative image modeling. This paper analyzes the influence of discriminator architecture on the exact mathematical objective. The authors claim that a fully connected discriminator indeed optimizes image Wasserstein distances and yields blurry images in agreement with the prior work. However, convolutional architectures optimize Wasserstein distance on the distribution of image patches which is different and doesn't lead to blurry images. Moreover, the authors compare CNN discriminator with Global Average Pooling layer vs FC layer and notice that it determines whether the GAN captures location information (ex: where eyes should be on human faces).\n\nIt is worth noting that the authors use a discrete version of WGAN in order to faciliate the exact computation of Wasserstein distance: they fix a certain number of latent vectors.\n\nThe authors also suggest a simple way to directly optimize this simplified version of Wasserstein distance. It supports their claims of the influence of discriminator objective on the generated image distribution."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "4 excellent"
            },
            "contribution": {
                "value": "3 good"
            },
            "strengths": {
                "value": "Related work is great, it explains well the prior conversation about WGANs and why there are doubts whether it is a good thing to optimize the Wasserstein distance. The experiments are quite sound and easy to follow. The paper is well-written in general. I also liked that the authors support the WGAN experiments with alternative ways to directly optimize Wasserstein distance. I think the idea is also original enough to warrant a publication and will be useful for future research even if it doesn't have immediate practical implications like pushing SOTA."
            },
            "weaknesses": {
                "value": "I suppose the main weakness is that the architectures analyzed in the paper are quite dated and simple compared to what people use nowadays. The datasets are pretty basic and small as well. The field moved a lot since the WGAN paper hence most likely their findings can't be applied to the state-of-the-art GANs. Nevertheless, I find this analysis interesting and insightful, it highlights that the architecture influences the exact mathematical function we optimize during training and affects the outcome in a more dramatic way than just \"this network gets better accuracy on ImageNet-like problems\"."
            },
            "questions": {
                "value": "I suggest to add network architecture diagrams at least in supplementary material. Focusing on subtle differences in architectures without clearly explaining them is odd."
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "8: accept, good paper"
            },
            "confidence": {
                "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        },
        "number": 3,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission3136/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698407257498,
        "cdate": 1698407257498,
        "tmdate": 1699636260557,
        "mdate": 1699636260557,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "NdNXLXeHHx",
        "forum": "2DDwxbjP9g",
        "replyto": "2DDwxbjP9g",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission3136/Reviewer_scef"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission3136/Reviewer_scef"
        ],
        "content": {
            "summary": {
                "value": "This paper claims that the WGANs optimizes the Wasserstein distance between the real data and generated data distributions. The authors used a so-called discrete generator which generates data from a finite number of fixed random noises. They claimed that when the discriminator architecture is a fully connected network, then WGANs minimize the Wasserstein distance between real data and generated data distributions. If the discriminator architecture is a Convolutional Neural Network (CNN), then the WGANs minimize the Wasserstein distance between the patches in the real images and generated images."
            },
            "soundness": {
                "value": "2 fair"
            },
            "presentation": {
                "value": "2 fair"
            },
            "contribution": {
                "value": "2 fair"
            },
            "strengths": {
                "value": "The authors showed in Theorem 3 in this paper that when a discriminator is a CNN with global average pooling in the second last layer, the WGAN approximately optimizes the Wasserstein distance between patches of the real images and the generated images."
            },
            "weaknesses": {
                "value": "Weakness:\n\n1. The theoretical result in Theorem 1 does not support the claim that when the discriminator architecture is a fully connected network, WGANs minimize the Wasserstein distance between real data and generated data distributions. \n    - My major concern is the discrete generator, that generates only $M$ samples. In fact, a generator could generate infinity number of samples. So, \"when each generated sample is a linear combination of at least $N/M$ training samples\" in Theorem 1 is not correct. Therefore, why previous works generates blurry images cannot be explained by the linear combinations of training samples introduced in Theorem 1. \n    - The authors obtained Theorem 1 from Eq. 4, which is a primal form of Optimal Transport (OT), but they claimed that WGANs produce the results in Theorem 1. In fact, a WGAN approximates the OT in the dual form, and the generator and discriminator in a WGAN perform updates alternatively. The finally generated data may be different from the generated data $x_j$ shown in Eq. 4. Therefore, Theorem 1 does not support the claim that when the discriminator architecture is a fully connected network, WGANs minimize the Wasserstein distance between real data and generated data distributions. \n\n2. The premises in Theorem 3 does not hold. \n    - The authors assume $M < N$ in Theorem 3, but as I mentioned above, $M$ should be infinity or should be at least much greater than $N$. Also, the authors should assume in Theorem 3 that the patch size of the generated images and the real images should be the same. \n\n3. WGANs have been proposed for many years. I cannot imagine that a WGAN generates poor images like those shown in Figs. 3 and 5. The authors should choose CNNs for the discriminator and generator. \n\n4. The authors uses the Sliced Wasserstein Distance (SWD) to approximate the Wasserstein distance between all the 16x16 patches. How close is a SWD to the real Wasserstein distance? Are there any evidences of literatures that indicating SWD and Wasserstein distance are consistent? \n\n5. Writing in several parts is not clear.\n    - The proof of Theorem 4, when $w_{jc} = 0$ for all $j \\ne i$. Here $i$ and $j$ are just two random indices. I don't understand when $j \\ne i$. \n    - $x_j = y_i$ in theorem 1 is not correct."
            },
            "questions": {
                "value": "In the end of the first paragraph of Sec. 2.1, the authors use \"gradient penalty to regularize the generator.\" Is this a typo? Because, in general, we use the gradient penalty to regularize the discriminator.\n\n\nDo the patches have overlap in Theorems 2 and 4? \n\n\nTypos: \n\n\"in the layer last linear layer \" in Theorem 4."
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "3: reject, not good enough"
            },
            "confidence": {
                "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        },
        "number": 4,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission3136/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698810579648,
        "cdate": 1698810579648,
        "tmdate": 1699636260429,
        "mdate": 1699636260429,
        "license": "CC BY 4.0",
        "version": 2
    }
]