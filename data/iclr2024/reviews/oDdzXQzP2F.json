[
    {
        "id": "u9wmHfcqlR",
        "forum": "oDdzXQzP2F",
        "replyto": "oDdzXQzP2F",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission8575/Reviewer_gEU7"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission8575/Reviewer_gEU7"
        ],
        "content": {
            "summary": {
                "value": "The paper proposes a novel attention mechanism with linear time complexity. The core idea is to apply vector quantization (VQ) on Keys, leading to the primary computing being (Query x Codebooks), where the number of codebooks is relatively small (256, 512, 1024) compared to the entire sequence length. The proposed method, termed Transformer-VQ, is applicable for both Transformer Encoder and Decoder models. Experimental results in long-context language modeling and image density estimation show that the proposed attention modification achieves performance comparable to prior works."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "3 good"
            },
            "contribution": {
                "value": "3 good"
            },
            "strengths": {
                "value": "* While the idea of adopting VQ into Transformers is not entirely new (ex: Clustered Attention), the paper\u2019s innovation is in using VQ for Keys and demonstrating its effectiveness (especially for Decoder). This is a nice contribution.\n* The paper provides a comprehensive review of related works, addressing various aspects. Furthermore, the equations and notations are presented clearly to help clarify the core idea."
            },
            "weaknesses": {
                "value": "* Although this paper focuses on efficient computation, there is no direct comparison of FLOPs or actual inference latency on GPUs/TPUs with previous works. It would also be beneficial to include a comparison between models with and without VQ.\n* Only one model size (1.3B for PG-19, 1.2B for ImageNet64) is used for experiments. To demonstrate the effectiveness, it would be valuable to test with multiple (smaller) model sizes where the sequence length exceeds the hidden dimension of Transformers. I assume that the actual inference speedup would arise when the sequence length is sufficiently larger than the hidden dimension of Transformers \u2013 I\u2019m not sure if the tested models are such a case."
            },
            "questions": {
                "value": "* As the authors mentioned in Section 5.2.1, it seems that simple attention dropout is not applicable; is searching for the appropriate regularization setting a challenging job? In other words, is the model robust enough regarding regularization hyperparameters?\n* The paper uses the GAU Transformer instead of a vanilla Transformer; Is there any reason why you used this variant? If the reason is that GAU employs single-headed attention, is Transformer-VQ applicable to a base (na\u00efve) Transformer architecture?\n* Linear-time Encoder is also explained in Section 3.2 but there are no corresponding experiments.\n* The \u201ctruncation-free fixed-size cache\u201d part is confusing. Does this refer to the limitation of the total stored Key size to \u201cLK\u201d (Section 3.4.2)? If so, then where does the \u2018truncation-free\u2019 part come?\n* Suggestion: It would be beneficial to include a figure of the computation process (especially visualizing L, C, K, and V) for both the encoder and decoder. The current version only presents mathematical formulations, which can make it difficult to understand the core algorithm.\n* (minor) In Section 3.1, maybe the \u201cgated activation unit\u201d is a typo of \u201cgated attention unit\u201d?\n* (minor) Large \u201cK\u201d seems to be used in two different contexts (key and query block size); consider changing the latter to another letter."
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "8: accept, good paper"
            },
            "confidence": {
                "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
            },
            "code_of_conduct": {
                "value": "Yes"
            },
            "first_time_reviewer": {
                "readers": [
                    "ICLR.cc/2024/Conference/Program_Chairs",
                    "ICLR.cc/2024/Conference/Submission8575/Senior_Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission8575/Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission8575/Reviewer_gEU7"
                ]
            }
        },
        "number": 1,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission8575/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698395576241,
        "cdate": 1698395576241,
        "tmdate": 1700321510356,
        "mdate": 1700321510356,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "Su6PGR8iw5",
        "forum": "oDdzXQzP2F",
        "replyto": "oDdzXQzP2F",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission8575/Reviewer_1jb5"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission8575/Reviewer_1jb5"
        ],
        "content": {
            "summary": {
                "value": "This paper proposes a new attention mechanism that can be realized to be linear in time. The proposed method uses vector quantization (mapping with learnable smooth codebooks) in a way that has non-zero gradients following [van den Oord *et al.* (2017)). Showing that attention as expressed in Definition 3.1. can be realized in linear time is not trivial, so the authors show in Thm. 3.7 how this speed up can be implemented using \"cache\" variables."
            },
            "soundness": {
                "value": "4 excellent"
            },
            "presentation": {
                "value": "3 good"
            },
            "contribution": {
                "value": "3 good"
            },
            "strengths": {
                "value": "* Practicality: Instructions on how to implement the architecture is very detailed, and it looks like the authors experimented quite a lot to design an architecture that works well with various architecture sizes (190M, 1.2B, 1.3B parameters)\n* Large-scale experiments across various challenging tasks."
            },
            "weaknesses": {
                "value": "The authors experiment with various architecture sizes; how did the authors choose which parameters to scale up? Is there some \"scaling laws\" that the authors observed to be useful? For example, fixing the codebook size to 256 may restrict the model's expressiveness which can be extremely critical for generative models. Given that the authors are emphasizing a decoder model which is particularly useful for generative tasks, I believe this paper would benefit from analysis on this new parameter's effect in addition to Sec. 5.1.1. One type of experiment that could demonstrate this effect would be to see if the model's performance saturates at some parameter count, and see if performance saturation is caused by the codebook size by training the same model with a larger codebook size S. Sharing these would be useful to anyone who plans to use this architecture for custom tasks. \n\nOverall the paper is well written, but I think the paper could benefit if the authors provide intuition for the caching mechanisms and the implementation for efficient attention (Theorems 3.4-3.7). Further, the proofs are written just as a sequence of equations without any conceptual descriptions, so it's quite hard to understand what steps are being used in the proofs."
            },
            "questions": {
                "value": "* In Sec. 5.1.2 the authors say that the codebook size is 256 but Table 6 in the appendix shows S is 512. Is this a typo?\n* What are the authors trying to show with ImageNet64? Is this part trying to show-case the model's applicability as a \"vision transformer\" type of model?"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "8: accept, good paper"
            },
            "confidence": {
                "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
            },
            "code_of_conduct": {
                "value": "Yes"
            },
            "first_time_reviewer": {
                "value": "Yes",
                "readers": [
                    "ICLR.cc/2024/Conference/Program_Chairs",
                    "ICLR.cc/2024/Conference/Submission8575/Senior_Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission8575/Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission8575/Reviewer_1jb5"
                ]
            }
        },
        "number": 2,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission8575/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698616289314,
        "cdate": 1698616289314,
        "tmdate": 1699637072678,
        "mdate": 1699637072678,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "VcJd60ytG4",
        "forum": "oDdzXQzP2F",
        "replyto": "oDdzXQzP2F",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission8575/Reviewer_5aiB"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission8575/Reviewer_5aiB"
        ],
        "content": {
            "summary": {
                "value": "* The paper proposes a linear-time attention mechanism based on vector-quantization.\n* This scheme is evaluated quantitatively and qualitatively on various datasets."
            },
            "soundness": {
                "value": "2 fair"
            },
            "presentation": {
                "value": "2 fair"
            },
            "contribution": {
                "value": "2 fair"
            },
            "strengths": {
                "value": "* The idea of using vector-quantization to achieve linear attention sounds reasonable.\n* The paper includes a detailed discussion of various related works and how they differ from Transformer-VQ.\n* Code is provided, aiding reproducability.\n* The paper provides qualitative samples of the various trained models."
            },
            "weaknesses": {
                "value": "* I think the presentation of the paper could be improved. I think some pseudocode or diagrams illustrating the main ideas would be useful, while some of the theorems could potentially be moved to the Appendix.\n* It seems to me that Transformer-VQ only significantly outperforms prior work on ImageNet64 where it uses a 7x larger model than the second best model.\n* It also not entirely clear to me what the real-world advantage of Transformer-VQ is, I assume that the attention mechanism is significantly faster for longer context due to being linear. If so, it would be useful to demonstrate this with some actual speedup experiments.\n* The datasets Transformer-VQ is evaluated on are also not current mainstream LLM datasets (which is the main application of Transformers and attention at the moment); I think results for e.g. standard token-level language modeling on C4 or The Pile would be more convincing.\n\nOverall, while I find the general idea reasonable, I am not fully convinced of it's effectiveness by the current set of experiments, hence I am leaning more towards rejection."
            },
            "questions": {
                "value": "See weaknesses."
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "6: marginally above the acceptance threshold"
            },
            "confidence": {
                "value": "2: You are willing to defend your assessment, but it is quite likely that you did not understand the central parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
            },
            "code_of_conduct": {
                "value": "Yes"
            },
            "first_time_reviewer": {
                "value": "Yes",
                "readers": [
                    "ICLR.cc/2024/Conference/Program_Chairs",
                    "ICLR.cc/2024/Conference/Submission8575/Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission8575/Reviewer_5aiB",
                    "ICLR.cc/2024/Conference/Submission8575/Senior_Area_Chairs"
                ]
            }
        },
        "number": 3,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission8575/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698788735120,
        "cdate": 1698788735120,
        "tmdate": 1700667461746,
        "mdate": 1700667461746,
        "license": "CC BY 4.0",
        "version": 2
    }
]