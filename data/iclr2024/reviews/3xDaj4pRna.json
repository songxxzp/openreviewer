[
    {
        "id": "gF8i8Z7Vxf",
        "forum": "3xDaj4pRna",
        "replyto": "3xDaj4pRna",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission7986/Reviewer_Jhr2"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission7986/Reviewer_Jhr2"
        ],
        "content": {
            "summary": {
                "value": "This paper shows that SAM can enhance the quality of features in datasets containing redundant or spurious features and this effect can't be explained by in-distribution alone. They show two possible mechanisms for this effect, namely (1) SAM will upweight examples that can't predict well using so-called 'hard features', and (2) the modified gradient in SAM optimizer will attribute more to 'hard features' instead of well-learned 'easy features'. They support the claims with a simple controlled toy experiment and also experiment on real datasets."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "3 good"
            },
            "contribution": {
                "value": "3 good"
            },
            "strengths": {
                "value": "* **Originality.** To the reviewer's knowledge, this paper is very novel. The phenomenon that SAM may learn more diverse features than SGD even when both reach nearly perfect generalization hasn't been reported before.\n\n* **Quality.** The experiments conducted are complete and thorough.\n\n* **Significance.** The reviewer believes that the finding will deepen the understanding of the mechanism of SAM."
            },
            "weaknesses": {
                "value": "* **Clarity.** The reviewer feels that clarity requires improvement in the paper. For example, the legend of Figure 5 is hard to follow. Also, the equality (1) seems to contain a typo. \n\n* **Verification of mechanism.** A possible way to verify whether the effect pointed out in the paper really contributes to the phenomenon is to try designing different variants using the discovered mechanism. The paper now only verifies that the importance weighting mechanism exists in real-world experiments but hasn't connected it with the diversity of features."
            },
            "questions": {
                "value": "* **Q1.** Is it possible to verify the effect of the found mechanisms? (see weaknesses)\n\n* **Q2.** Can the authors try disentangle the two mechanisms and verify which is more important for the phenomenon?"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "6: marginally above the acceptance threshold"
            },
            "confidence": {
                "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        },
        "number": 1,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission7986/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698418679282,
        "cdate": 1698418679282,
        "tmdate": 1699636983763,
        "mdate": 1699636983763,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "FXhdPz19u6",
        "forum": "3xDaj4pRna",
        "replyto": "3xDaj4pRna",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission7986/Reviewer_qpzp"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission7986/Reviewer_qpzp"
        ],
        "content": {
            "summary": {
                "value": "The paper focuses on the effectiveness of Sharpness-Aware Minimization (SAM).\nThe authors claims that SAM can enhance downstream generalization through feature diversity.\nEmpirical analysis of SAM trues to demonstrate that SAM offers feature-diversifying benefit."
            },
            "soundness": {
                "value": "2 fair"
            },
            "presentation": {
                "value": "1 poor"
            },
            "contribution": {
                "value": "2 fair"
            },
            "strengths": {
                "value": "- The paper provides clear motivation.\n- The paper provides several experimental results from various perspectives."
            },
            "weaknesses": {
                "value": "- Although the paper introduces several concepts including feature-probing error or phantom parameter, but it is still unclear why SAM can improve feature diversity.\n- What is the meaning of the ratio $v_{\\text{hard}}/v_{\\text{easy}}$? Why we can say the high ratio means re-balancing effect?\n- Why do we need to perturb the last layer only? It would be nice to describe in detail."
            },
            "questions": {
                "value": "See Weaknesses."
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "6: marginally above the acceptance threshold"
            },
            "confidence": {
                "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
            },
            "code_of_conduct": {
                "value": "Yes"
            },
            "first_time_reviewer": {
                "readers": [
                    "ICLR.cc/2024/Conference/Program_Chairs",
                    "ICLR.cc/2024/Conference/Submission7986/Senior_Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission7986/Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission7986/Reviewer_qpzp"
                ]
            }
        },
        "number": 2,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission7986/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698827846752,
        "cdate": 1698827846752,
        "tmdate": 1700647150919,
        "mdate": 1700647150919,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "4GHqkzpeL0",
        "forum": "3xDaj4pRna",
        "replyto": "3xDaj4pRna",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission7986/Reviewer_KbQq"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission7986/Reviewer_KbQq"
        ],
        "content": {
            "summary": {
                "value": "Sharpness-aware minimization (SAM) is an alternative method to the traditional stochastic gradient descent (SGD) for training neural networks. The core idea behind SAM is to guide models towards \"flatter\" minima, believed to enhance generalization. However, recent works revealed that flatness is not the only reason for good generalization. This study proposes an additional advantage of SAM: it improves the quality of dataset features, especially in datasets with redundant or unnecessary features. SAM achieves this by suppressing already well-learned features, allowing lesser-known features to be recognized. This process leads to a more balanced model feature update. Consequently, SAM enhances representation learning by promoting feature diversity. This sheds light on SAM's effectiveness in out-of-distribution performance, offering a new perspective on SAM's benefits."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "3 good"
            },
            "contribution": {
                "value": "3 good"
            },
            "strengths": {
                "value": "Generally, I think this paper provides an interesting view of SAM. \n\n- This paper provides a new point of view that the SAM algorithm can boost feature diversity. In detail, SGD may be biased towards learning the strongest features from the training data, while SAM promotes the learning of a diverse set of features. Such an explanation is different from the view of the sharpness-based or Hessian-based analysis. \n\n- The new view indicates that the SAM can not only benefit in-distribution tasks but also downstream or out-of-distribution tasks. The empirical study supports their results. The findings may inspire the community to develop new algorithms to improve feature learning.\n\n- This paper is well-organized and presented with comprehensive experiments and interesting illustration figures."
            },
            "weaknesses": {
                "value": "- Incomplete Understanding of Mechanisms: The discovery that SAM can result in a variety of features is interesting. However, the underlying mechanisms of this finding are not entirely comprehended, particularly in the theoretical aspects.\n\n- Clarity in Data Model Description: The study explores SAM from a feature learning perspective. Nevertheless, the data model described in the paper lacks clarity. It would enhance the paper's comprehensibility if the authors could explicitly present the formula of the toy model (perhaps in the Appendix).\n\n- Elaboration on Feature Measurement: The paper introduces a method to measure strong and weak features. I think it would be an independent significant contribution. An in-depth elaboration on this measure would further strengthen the paper's impact."
            },
            "questions": {
                "value": "- In experiments such as CIFAR-MINIST, do all the data have a strong feature and a weak feature, or only some of the data have a strong feature while others do not? In equation 6, the authors divide the gradient into the direction of the easy feature and the hard feature, so it seems that each data has both strong and weak features.\n\n- A recent theoretical paper [1] shows that SAM can prevent noise memorization by deactivating the neurons that align with noise and, therefore, can get better in-distribution performance. The authors provide a novel view of the strong-weak features but haven't considered the noise in the model. So, I am wondering how the noises (which are independent of the label ) influence the SAM and SGD's out-of-distribution performance. \n\n-  The batch size $m$ of SAM updates plays an important role [2, 3, 4]. It is observed and proved that m-SAM (SAM with batch size $m$) can have different implicit biases and, therefore, get different performances. It would be better if the author could include the batch size in the methodology and have some discussions. \n\n- I checked the appendix in detail and found that the authors calculate the ratio of importance weighting terms for different neural network architectures. The authors only calculate the gradient for deep linear networks and leave the general networks blank. I agree that the general network's gradient is complex and hard to compute. However, adding some discussion for the two-layer neural networks can help the authors better understand the intuition of this paper,  which is still simple and easy to calculate [1, 4]. \n\n[1] Chen et al. \"Why Does Sharpness-Aware Minimization Generalize Better Than SGD?\" arXiv preprint arXiv:2310.07269, 2023.\n\n[2] Foret et al. \"Sharpness-aware minimization for efficiently improving generalization.\" In ICLR, 2021.\n\n[3]  Andriushchenko et al. \"Towards understanding sharpness-aware minimization.\" In International Conference on Machine Learning, pp. 639\u2013668. PMLR, 2022.\n\n[4] Wen et al. \"Sharpness minimization algorithms do not only minimize sharpness to achieve better generalization.\" arXiv preprint arXiv:2307.11007, 2023."
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "6: marginally above the acceptance threshold"
            },
            "confidence": {
                "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        },
        "number": 3,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission7986/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698862533456,
        "cdate": 1698862533456,
        "tmdate": 1699636983519,
        "mdate": 1699636983519,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "23Auk2tF1M",
        "forum": "3xDaj4pRna",
        "replyto": "3xDaj4pRna",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission7986/Reviewer_BgWc"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission7986/Reviewer_BgWc"
        ],
        "content": {
            "summary": {
                "value": "This paper empirically studies the mechanism of Sharpness-Aware Minimization (SAM), which improves generalization beyond in-distribution data (e.g., on downstream or out-of-distribution tasks). The authors demonstrate that SAM has a significant impact on improving representation quality through feature diversity, i.e., promoting a neural network to learn both easy and hard features. Through toy experiments, the authors isolate two core mechanisms within SAM that lead to better feature quality: 1) importance sampling, and 2) learning rate scaling. The former one is further verified on real-world datasets."
            },
            "soundness": {
                "value": "2 fair"
            },
            "presentation": {
                "value": "2 fair"
            },
            "contribution": {
                "value": "3 good"
            },
            "strengths": {
                "value": "- Explaining the effectiveness of SAM from the perspective of feature quality is novel.\n- The authors identify that SAM\u2019s feature improvement cannot be solely explained by in-distribution improvements.\n- The authors carefully design a toy experiment, based on which two reasonable mechanisms are isolated to explain why SAM can learn the hard-to-learn features."
            },
            "weaknesses": {
                "value": "- The authors argue that due to the ability to learn diverse features (both easy and hard), SAM can improve the generalizability beyond in-distribution. However, this raises a question: are all these features beneficial to the out-of-distribution generalization or downstream tasks? For example, in Table 1, the hard-to-learn feature in CelebA is the \"gender feature\" while the task is to predict the \"hair color\". In this case, the easy features are correctly related to the labels, and there exists spurious-correlation between the hard \"gender feature\" and the labels. The SAM indeed decreases both the probe errors for easy and hard features, but the latter is harmful for ood generalization. Thus, it seems contradictive between \"SAM learns diversity features\" and \"SAM improved generalizability beyond in-distribution\". The authors should provide more explanations.\n- While the authors identify two underlying effects to explain why SAM learns diversity features with better quality, the learning rate effect is hard to verify in real-world datasets.\n- Minor: In Sec3.1, Eq 1, replace the $\\phi_\\theta$ to $\\Phi_\\theta$."
            },
            "questions": {
                "value": "Please see weaknesses."
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "6: marginally above the acceptance threshold"
            },
            "confidence": {
                "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        },
        "number": 4,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission7986/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698871356588,
        "cdate": 1698871356588,
        "tmdate": 1699636983417,
        "mdate": 1699636983417,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "vJcB47ouQ3",
        "forum": "3xDaj4pRna",
        "replyto": "3xDaj4pRna",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission7986/Reviewer_NKN8"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission7986/Reviewer_NKN8"
        ],
        "content": {
            "summary": {
                "value": "This paper studies why Sharpness-Aware Minimization (SAM) can generalize well. They provide an explanation based on the weight that SAM/SGD put on different features, explaining SAM can up-weight features that are harder to learn."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "3 good"
            },
            "contribution": {
                "value": "2 fair"
            },
            "strengths": {
                "value": "I think the idea of balancing features is interesting, and it makes sense to study SAM from this perspective. I agree that sharpness of the loss cannot alone explain the differences of SAM/SGD, and I appreciate this work's attempt to go beyond."
            },
            "weaknesses": {
                "value": "The paper is inherently more on the empirical side, which I think is fine. However, I think some simplified theory could increase the contribution of the work. Based on this, I'd rate the paper as borderline accept."
            },
            "questions": {
                "value": "-"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "6: marginally above the acceptance threshold"
            },
            "confidence": {
                "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
            },
            "code_of_conduct": {
                "value": "Yes"
            },
            "first_time_reviewer": {
                "value": "Yes",
                "readers": [
                    "ICLR.cc/2024/Conference/Program_Chairs",
                    "ICLR.cc/2024/Conference/Submission7986/Senior_Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission7986/Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission7986/Reviewer_NKN8"
                ]
            }
        },
        "number": 5,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission7986/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1699050847805,
        "cdate": 1699050847805,
        "tmdate": 1699636983312,
        "mdate": 1699636983312,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "rSG4PfG68u",
        "forum": "3xDaj4pRna",
        "replyto": "3xDaj4pRna",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission7986/Reviewer_LFgC"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission7986/Reviewer_LFgC"
        ],
        "content": {
            "summary": {
                "value": "Several learning theories, e.g., PAC Bayes, explain that flatter minima generalize better.\nThus, SAM is formulted to find flatter minima, and is known to improve in-distribution\ngeneralization.\nHowever, the beyond in-distribution performance is not well understood.\nThis paper focuses on  a feature-diversifying effect of SAM that is relevant for downstream generalization.\nAs seen in simplicity bias or gradient starvation,SGD exhibits a bias toward learning simple/easy-to-fit feature, even if the training data has multiple latent features that are all useful for prediction.\nIn contrust, this paper explans that SAM also learn the hard-to-fit features.\nThe authors shows this property of SAM by constructing a toy setting consisting of an easy-to-fit and a hard-to-fit features."
            },
            "soundness": {
                "value": "2 fair"
            },
            "presentation": {
                "value": "3 good"
            },
            "contribution": {
                "value": "3 good"
            },
            "strengths": {
                "value": "This paper seems to be the first to show the relationship between easy-to-fit and hard-to-fit features and learning by SAM. \nThis perspective is useful in that it opens up the possibility that SAMs can solve problems that SGD has, such as gradient starvation."
            },
            "weaknesses": {
                "value": "While the analysis of the toy setting is interesting, it is unclear to what extent the analysis is applicable to learning with real images such as the winter bird and CelebA datasets."
            },
            "questions": {
                "value": "Q1.What does it take in the future to extend the theory from toy setting to reality image identification? Please explain how difficult it would be. \nQ2: As a question related to Q1, in the toy setting, easy-to-fit and hard-to-fit are separated as latent features, but this may not necessarily be the case in real-world data. For example, is it possible that at the time of the feature extractor, the SGD is trained in such a way that the signals of hard-to-fit features do not reach the output layer in the first place? Is there any way to know that easy-to-fit and hard-to-fit features are disentangled in latent features in a real-world problem?\nQ3: How much is the influence of the terms after the second order in Eq.(20), which can be ignored since the hessian trace is small for the purpose of finding the fat minima? In this case, what is the effect during the learning process?\nQ4. The word \"diversity\" is used in this paper; however, it actually refers only to two characteristics, easy-to-fit and hard-to-fit.\nIn terms of beyond-in-distribution setting,  transferabiliity is also important. For example, robust/non-robust features in the analysis of adversarial examples, etc. could be considered. Please explain the relationship with other features.\nQ5. There are oftern noisy features as well as easy-to-fit and hard-to-fit features in real images. Is it possible to analyze the effect of SAM on noisy features that are typically hard-to-fit."
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "6: marginally above the acceptance threshold"
            },
            "confidence": {
                "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        },
        "number": 6,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission7986/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1699230420452,
        "cdate": 1699230420452,
        "tmdate": 1699636983202,
        "mdate": 1699636983202,
        "license": "CC BY 4.0",
        "version": 2
    }
]