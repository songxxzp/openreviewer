[
    {
        "id": "GjxXPQBgH6",
        "forum": "rUH2EDpToF",
        "replyto": "rUH2EDpToF",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission7731/Reviewer_kkqm"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission7731/Reviewer_kkqm"
        ],
        "content": {
            "summary": {
                "value": "The paper presents Marginalization Models (MAMs) as a novel approach to generative modelling for high-dimensional discrete data. MAMs offer scalability, tractable likelihood calculations, and efficient evaluation of marginal probabilities. They support any-order generative models and excel in energy-based training. Experimental results demonstrate MAMs' effectiveness across diverse data types, emphasizing their significant speedup in marginal probability evaluation and their capacity to handle high-dimensional problems, surpassing previous methods."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "3 good"
            },
            "contribution": {
                "value": "3 good"
            },
            "strengths": {
                "value": "The paper introduces a novel family of generative models that offer both computationally feasible marginalisation and scalability for generating high-dimensional discrete data."
            },
            "weaknesses": {
                "value": "My primary concern centres around the aspect of marginalization self-consistency. I'm sceptical about whether the soft constraint presented in equation 7 can effectively ensure self-consistent marginalization. The paper lacks reports on real-world applications that involve marginal evaluation. Is it possible to validate the effectiveness of the marginal constraint in some toy examples, like training the model on a predefined  Gaussian distribution with a known marginal density and directly testing it using the mean squared error?"
            },
            "questions": {
                "value": "- To implement the self-consistency constraint outlined in equation 7, you must specify a distribution $q(x)$ for subsampling. How does the choice of the $q$ distribution impact the training process? Is $q(x)$ set to be the data distribution, or can it be any arbitrary distribution?\n- When it comes to inference, do you employ equation 6 for sampling, or do you utilize the conditional distribution $p_\\phi(x_{\\sigma(d)} | x_{\\sigma(<d)})$? What\u2019s the difference between these two schemes?\n- Point 2) in section 4.3 appears unclear. To train an order-agnostic AutoRegressive Model within the EBM framework, it seems plausible to employ the reinforce gradient estimation method outlined in equation 9. By replacing $\\log p_\\phi (x)$ with the Monte Carlo estimation of $\\mathbb{E}_\\sigma \\log p_\\phi(x|\\sigma)$, one could potentially achieve this. Therefore, the statement \"ARMs cannot be trained with the expected DKL objective over all orderings simultaneously\" is somewhat unclear to me.\n- In section 4.3, point 3), I hold a different perspective regarding the efficiency of MAMs compared to ARMs, especially in high-dimensional scenarios. While it's true that in ARM-Full, you do require D feed-forward runs for gradient computation, in MAMs, you also necessitate Gibbs sampling to generate samples from the model. Even if you employ block-wise Gibbs sampling, it still demands multiple steps to guarantee MCMC chain convergence. Hence, I doubt that MAMs also face challenges in high-dimensional problems.\n- Auto-regressive diffusion models have demonstrated strong performance on the CIFAR-10 dataset. Is it conceivable that MAM could also yield promising results on CIFAR-10?\n- Could you offer additional examples to illustrate why we should be concerned with any-order AutoRegressive models? Do any-order ARMs exhibit superior performance compared to their order-specified counterparts?"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "6: marginally above the acceptance threshold"
            },
            "confidence": {
                "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        },
        "number": 1,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission7731/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698615079749,
        "cdate": 1698615079749,
        "tmdate": 1699636943320,
        "mdate": 1699636943320,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "yHbHjMsrMS",
        "forum": "rUH2EDpToF",
        "replyto": "rUH2EDpToF",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission7731/Reviewer_CcDR"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission7731/Reviewer_CcDR"
        ],
        "content": {
            "summary": {
                "value": "The paper develops marginalization models (MAMs) for modelling all marginals and conditionals for discrete data. It introduces a consistency loss that is combined with either a maximum likelihood objective or an energy-based objective. MAMs require only a single forward pass for computing likelihoods in energy-based learning setups, in contrast to autoregressive models (ARMs). On MLE tasks, the method leads to similar NLL as any-order ARM, but with much smaller marginal inference time. Similarly, for energy-based learning task, the suggested approach performs similar to ARM, but with significant speedup."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "3 good"
            },
            "contribution": {
                "value": "3 good"
            },
            "strengths": {
                "value": "The paper is generally well written and easy to follow. It addresses an important question. \n\nThe idea to introduce a scalable optimisation term that encourages marginalisation self-consistency is new as far as I am aware. \n\nThe approach seems to be applicable broadly (I am not sure how well this extends to non-discrete data) and is illustrated on challenging problems. Various experiments on both maximum likelihood training illustrates that it performs comparable with any-order ARMs, while being significantly faster."
            },
            "weaknesses": {
                "value": "In Section 4.3 2), the authors argue that if the model is not perfectly self-consistent, this poses an issue for ARMs for energy-based setups. As MAMs will likewise not be perfectly self-consistent, why is this not an issue for them? In particular, it is not clear to me that the Gibbs sampling procedure then leads to samples from $p_{\\theta}$. Are you adjusting via importance sampling in the experiments?\n\nThe paper often assumes that neural networks are universal approximators. It has not become clear why this is a practical assumption for the used architectures as the number of marginal constraints scales badly with K and D. Does this consistency loss actually go to zero in the experiments?"
            },
            "questions": {
                "value": "Is there a reason why you choose the squared difference of the log densities to be matched due to marginalisation constraints over samples from q? If these distributions should coincide, why not use a divergence between them such as their KL? \n\nCan you clarify when the \u2018generative\u2019 conditional eq. (6) is used vs. the learnable conditionals with parameter $\\phi$?\n\nCan you clarify why a high correlation with AO-ARM-E is a sensible evaluation measure?"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "6: marginally above the acceptance threshold"
            },
            "confidence": {
                "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        },
        "number": 2,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission7731/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698634021854,
        "cdate": 1698634021854,
        "tmdate": 1699636943203,
        "mdate": 1699636943203,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "BWFUDfxBAt",
        "forum": "rUH2EDpToF",
        "replyto": "rUH2EDpToF",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission7731/Reviewer_sWKU"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission7731/Reviewer_sWKU"
        ],
        "content": {
            "summary": {
                "value": "Authors propose Marginalization Models (MaMs), generative models for discrete data allowing (approximate) marginal inference. They key idea is to minimize a penalty term aimed at approximately satisfying the marginalization self-consistency constraint (Eq. 5). The model is evaluated on binary images, text, and molecules."
            },
            "soundness": {
                "value": "2 fair"
            },
            "presentation": {
                "value": "2 fair"
            },
            "contribution": {
                "value": "1 poor"
            },
            "strengths": {
                "value": "None."
            },
            "weaknesses": {
                "value": "- The paper presents false claims, and the whole modelling framework is not theoretically solid/supported\n- By evaluating what authors call \"augumented vector representation\" we are not really summing-out the unobserved variables, i.e. we are not performing marginalisation. Rather, we are computing a simple p(x) where x belongs to an augmented state space, and therefore there's no guarantee that this satisfy what authors call \"marginalization self-consistency\".\n- The novelty of the work boils down to the constraint in the loss function (cf. Eq. 9)\n- The model is not agnostic to variable orderings and, as such, cannot deal with efficient and *exact* marginalization (see first equation in section 4.2).\n- As far as I understood, there's no guarantee that the model satisfies the marginalization self-consistency constraint (Eq. 5), and therefore the model compares to any other dealing with approximate marginal inference, such as [1] [2].\n- Sampling is still sequential, as standard autoregressive models. This is weird, as a model allowing for proper marginal inference should not have sequential sampling.\n- In general, there should be much more focus and discussion on Probabilistic Circuits, as they satisfy the self-consistency constraint by design, with no need for a penalty term, resulting in exact marginal inference (which is the goal of this paper). Furthermore, PCs are not limited on working with discrete variables only, but can handle heterogeneous data. PCs allow one-shot (conditional) sampling, without relaying on a variable ordering as in MaMs. In short, I believe PCs should be treated as the main competitor of this work, but this is not the case.\n\n[1] Shih, Andy, Dorsa Sadigh, and Stefano Ermon. \"Training and Inference on Any-Order Autoregressive Models the Right Way.\" arXiv preprint arXiv:2205.13554 (2022).\n\n[2] Strauss, Ryan, and Junier B. Oliva. \"Arbitrary conditional distributions with energy.\" Advances in Neural Information Processing Systems 34 (2021): 752-763."
            },
            "questions": {
                "value": "- INTRO: why marginal evaluations in transformer should be O(D)? I would say that O(D) is the evaluation cost of a fully observed sample,\nnot for partially observed samples (i.e. marginals). Indeed, transformers, as any standard autoregressive models, cannot perform arbitrary marginalisation.\n\n- INTRO: why EBMs should be limited in fixed-order generative modeling? I do not agree with this claim\n\n- I do not agree with most of what is said in paragraph \"Energy-based training\", e.g. Why do authors say that in this setting there are no data available?\nAFAIK, we do not have access to $f$, rather we model $f$, an unnormalized density/PMF.\nWhen mentioning EBMs I think about [1] and the immense literature deriving from it.\n\n[1] LeCun, Yann, et al. \"A tutorial on energy-based learning.\" Predicting structured data 1.0 (2006).\n\n\n- What MaMs provide that PCs don't?"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "5: marginally below the acceptance threshold"
            },
            "confidence": {
                "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
            },
            "code_of_conduct": {
                "value": "Yes"
            },
            "first_time_reviewer": {
                "value": "Yes",
                "readers": [
                    "ICLR.cc/2024/Conference/Program_Chairs",
                    "ICLR.cc/2024/Conference/Submission7731/Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission7731/Reviewer_sWKU",
                    "ICLR.cc/2024/Conference/Submission7731/Senior_Area_Chairs"
                ]
            }
        },
        "number": 3,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission7731/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698662267485,
        "cdate": 1698662267485,
        "tmdate": 1700389549283,
        "mdate": 1700389549283,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "UOTAwqKbn5",
        "forum": "rUH2EDpToF",
        "replyto": "rUH2EDpToF",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission7731/Reviewer_G1Dh"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission7731/Reviewer_G1Dh"
        ],
        "content": {
            "summary": {
                "value": "The paper introduces Generative Marginalization Models (MAMs), which are a new type of generative model for high-dimensional discrete data. MAMs address the limitations of existing methods by explicitly modeling all derived marginal distributions, allowing for scalable and flexible generative modeling. MAMs can rapidly evaluate any marginal probability with a single forward pass of a neural network, without requiring accurate marginal inference. MAMs also support scalable training of generative models with arbitrary orderings of high-dimensional problems in an energy-based training setting. The effectiveness of MAMs is demonstrated on various discrete data distributions, including binary images, language, physical systems, and molecules. MAMs significantly speed up the evaluation of marginal probabilities, enabling the modeling of arbitrary orderings of high-dimensional problems that were not achievable with conventional methods in energy-based training tasks."
            },
            "soundness": {
                "value": "2 fair"
            },
            "presentation": {
                "value": "3 good"
            },
            "contribution": {
                "value": "2 fair"
            },
            "strengths": {
                "value": "- The authors introduce a new family of generative models called Marginalization Models (MAMs) that have tractable likelihoods and offer scalable and flexible generative modeling.\n  - MAMs allow for fast evaluation of arbitrary marginal probabilities with a single forward pass of the neural network, overcoming a limitation of autoregressive models.\n  - The proposed model supports scalable training of any-order generative models for high-dimensional problems under the energy-based training setting.\n  - MAMs achieve significant speedup in evaluating marginal probabilities.\n- The effectiveness of the proposed model is demonstrated on various discrete data distributions, including binary images, language, physical systems, and molecules.\n- The authors identify an interesting connection between generative marginalization models and GFlowNets, showing their equivalence under certain conditions in A.3 in the appendix."
            },
            "weaknesses": {
                "value": "- When I read the introduction, I expected to find a way to rigorously guarantee self-consistency constraints, but in fact I was somewhat underwhelmed because the actual way is only to impose soft constraints during optimization.\n- The experimental results are not so good. In many experiments, the evaluation with NLL is slightly worse than the baseline, which does not fully demonstrate the superiority of the MAM.\n- The effectiveness of two-stage training has not been adequately explained. At least, there should be an experimental comparison with the case without the two-stage training."
            },
            "questions": {
                "value": "- I do not understand why two-stage training is effective. Do the authors have any hypothesis on it?\n- What is the definition of the marginal inference time in Tables 2, 3, and 4?"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "5: marginally below the acceptance threshold"
            },
            "confidence": {
                "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        },
        "number": 4,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission7731/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1699083438488,
        "cdate": 1699083438488,
        "tmdate": 1699636942982,
        "mdate": 1699636942982,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "XKVmF6uhtV",
        "forum": "rUH2EDpToF",
        "replyto": "rUH2EDpToF",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission7731/Reviewer_2RBk"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission7731/Reviewer_2RBk"
        ],
        "content": {
            "summary": {
                "value": "This paper introduces Marginalization Models (MAMs), a novel class of generative models that brings scalability and flexibility to generative modeling while allowing tractable estimation of the marginal likelihood for any subset of multivariate random variables. MAMs can accommodate both maximum likelihood training and energy-based training, making them exceptionally versatile, particularly when dealing with discrete random variables, such as molecules, or random variables defined by an energy function. Extensive experimental results show the superior efficiency of MAMs compared to autoregressive models."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "4 excellent"
            },
            "contribution": {
                "value": "3 good"
            },
            "strengths": {
                "value": "Originality & Significance: The paper proposes a new type of generative models MAMs. It can handle both maximum likelihood training and energy-based training, which is quite promising. The ability to handle such diverse training methods strengthens the significance of this work.\n\nQuality: The work is well-motivated and logically compact. The claim in Sec. 4.1 and discussion in Sec. 4.3 are sound.\n\nClarity: The paper is generally well-written and easy to follow. Figures are very illustrative."
            },
            "weaknesses": {
                "value": "One issue with this paper is that it mainly uses small, simple datasets for its experiments. While the results look good with these small datasets, I'm not sure how well the model would work with larger, more complex real-world data. Real-world data is often much bigger and more complicated, presenting a lot of variables and intricacies. For instance, the number of possible orderings scales fractionally with data dimension To really understand if this approach is useful in practice, it would be helpful to test it on bigger and more diverse datasets.\n\nMinor:\n- typo in page 4: where $K$ is the number of discrete values $x_d$ can take -> ... discrete values $x_{\\sigma(d)}$ can take"
            },
            "questions": {
                "value": "- >In this paper, we focus on the sampling procedure that generates one variable at a time, but marginalization models can also facilitate sampling multiple variables at a time in a similar fashion.\n\n    How can MAMs generate multiple variables simultaneously? It appears that MAMs are limited to generating variables sequentially, as indicated in Equation (5) and (6).\n\n- How does the order in which variables are sampled impact the quality of the samples?\n\n- How does different $q$ (e.g., uniform v.s. $p_{\\\\mathrm{data}}$) affect the learning of MAMs?\n\n- I'm a bit confused about the sample generation process with MAMs. In Section 3, it mentions using the normalized conditional (Equation (6)) for sampling, but in Section 6.1, it's said that the conditional model $p_{\\\\phi}$ is used to generate data. Can you clarify this process?\n\n- Given the two-stage training approach for MLE, it seems that the learned conditional model $p_{\\phi}$ is independent of the marginalization model $p_{\\\\theta}$. As mentioned on page 5, $p_{\\\\theta}$ is described as distilling marginals from conditionals. How does the conditional model, as an AO-ARM model, compare to the AO-ARM baselines?\n\n- In the experiments, how are the NLL (bpd) values estimated for MAM? Are these values the outputs of $p_{\\theta}$ or the logarithmic products of $p_{\\\\theta}$?"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "8: accept, good paper"
            },
            "confidence": {
                "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        },
        "number": 5,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission7731/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1699178012031,
        "cdate": 1699178012031,
        "tmdate": 1699636942867,
        "mdate": 1699636942867,
        "license": "CC BY 4.0",
        "version": 2
    }
]