[
    {
        "id": "sk3bFbRiOJ",
        "forum": "KAseclJyj5",
        "replyto": "KAseclJyj5",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission701/Reviewer_7Hkf"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission701/Reviewer_7Hkf"
        ],
        "content": {
            "summary": {
                "value": "This paper introduces DOI (Diverse Offline Imitation) for improving diversity of learned skill-conditioned policies. These skills are trained to have maximum diversity (via maximizing mutual information between states and skills) and to be close to expert state distributions. Prior work, SMODICE, is an instance of DOI where the KL-divergence between each skill state-visitation distribution and the expert state-visitation distribution must be 0, but DOI relaxes this constraint to be up to $\\varepsilon$.\n\nDOI is evaluated on a 12-DOF quadruped both in sim and real as well as in D4RL and shown to promote greater diversity of skills. However, there is a tradeoff between skill diversity and performance."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "2 fair"
            },
            "contribution": {
                "value": "2 fair"
            },
            "strengths": {
                "value": "- Method was deployed on a real robot, and website has videos showing the learning of presumably 3 different skills involving locomotion at 3 different base heights.\n- Figure 1 was helpful.\n- Writing in the main text sections of the paper was mostly clear, and the math was pretty understandable step-by-step."
            },
            "weaknesses": {
                "value": "## Method, Experiments, and Argument\n\n(A1) Novelty and algorithmic contribution seems quite limited compared to SMODICE. The main differences are (1) Learning a discrete number of skill-based policies instead of a single policy, and (2) allowing skill-based policies and the expert to have up-to-$\\varepsilon$ KL divergence. Limited algorithmic novelty is fine if robotic performance on at least a few downstream tasks is a lot better than prior work, but experiments show ultimate performance is not improved with DOI.\n\n(A2) Experimental metrics are not very illustrative of the performance of DOI. Most of the plots (Figure 3, 4a) show proxy measures of how diverse the skills are. Only Figure 4b (and Tables S2, S3) compares DOI performance with SMODICE. Figure 4b shows that performance of DOI at smaller epsilon values is comparable to SMODICE, and Tables S2 and S3 show that SMODICE ($\\varepsilon = 0$) does better than any $\\varepsilon > 0$. Perhaps this is expected, as the authors argued there is a diversity-performance tradeoff in Section 6. But if so, there should be experiments, such as those testing generalization, where higher skill diversity leads to better robustness than narrowly-learned policies. However, the authors did not have experimental results of this kind, which brings into question when DOI should be used over SMODICE.\n\n(A3) Abstract and conclusion states that this paper proposes \u201ca principled offline algorithm for unsupervised skill discovery.\u201d However, the paper assumes that the set of skills $Z$ is finite, which suggests that skill candidates are predefined and presumably not continuous-spaced. If predefined, where is the \u201cskill discovery\u201d coming from? This is different from how CIC [1] does skill discovery, where skill vectors are continuous and sampled from a prior distribution.\n\n\n## Presentation/Coherence\n\nOverall, results graphs and algorithm boxes need to be clearer.\n\n(B1) Paper did not precisely define what a skill is, what the set of finite skills $Z$ is initialized to, or where $Z$ is from. Is $z \\in Z$ a continuous vector or a one-hot?\n\n(B2) Since method section relies so much on SMODICE, and Figure 2 refers to DICE (which was not introduced until page 7), I would recommend putting the related work section before the preliminaries section.\n\n(B3) Nitpick: Section 3.2.1, first line, should refer to Problem (eqn 7) instead of Problem (eqn 6), I believe.\n\n(B4) Algorithm 1 talks about a discriminator $c^{*}$ mapping state to predicted probability that the state is from $d_E$ vs $d_O$. However, this discriminator is not mentioned anywhere in the main text and can be confused with the skill discriminator $q(z|s)$.\n\n(B5) Phase 2 in Algorithm 1 mentions training $\\pi_z^{*}$ when Section 3.2.1 seems to say the policy is trained in Phase 1 instead.\n\n(B6) Section 5, Related Work, reads more like a laundry list of prior papers. There is no comparison at all to this paper\u2019s proposed method, DOI.\n\n(B7) Real robot results are not discussed in Section 6.\n\n(B8) Tables S2 (Walker2D) and S3 (HalfCheetah) contain the exact same entries (at least for the ~20 cells I looked at). This seems like an unfortunate mistake.\n\n## Reference\n[1] CIC: Contrastive Intrinsic Control for Unsupervised Skill Discovery. Laskin et al."
            },
            "questions": {
                "value": "1. How would DOI be extendable to a continuous skill space?\n\n2. How did authors define the skill space $Z$ for each of the different environments? What was $Z$ and $|Z|$ for the D4RL envs? Presumably it was $|Z| = 3$ and $Z = [\\text{low base}, \\text{mid base}, \\text{high base}]$ for locomotion?\n\n3. Given Assumption 2.1, I wonder what the state representation is for the locomotion task. Can DOI be adapted to work on image observations, or a learned image feature space?\n\n4. What is $N$ in Tables S2 and S3?\n\n5. What does the color-coding in Figure 3a mean? Is it the same color meaning as Figure 3b?\n\n6. In Algorithm 1, the reward is defined as function of the output of $c^{*}$, which could easily be confused with the reward terms mentioned in Equations 8 and 14. How is this reward term, which doesn\u2019t depend on actions, used to compute importance sampling ratios $\\eta_{\\tilde{E}}(s,a)$, which does?\n\n7. Figure 3a: x-axis is confusingly labeled \u201cdata.\u201d Section 6 describes this as \u201cacross the dataset assignment.\u201d What do these things mean?\n\n8. I suggest using a slightly more descriptive title for the paper."
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "3: reject, not good enough"
            },
            "confidence": {
                "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
            },
            "code_of_conduct": {
                "value": "Yes"
            },
            "first_time_reviewer": {
                "value": "Yes",
                "readers": [
                    "ICLR.cc/2024/Conference/Program_Chairs",
                    "ICLR.cc/2024/Conference/Submission701/Senior_Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission701/Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission701/Reviewer_7Hkf"
                ]
            }
        },
        "number": 1,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission701/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698621982826,
        "cdate": 1698621982826,
        "tmdate": 1699635997155,
        "mdate": 1699635997155,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "5FB1iZUiNN",
        "forum": "KAseclJyj5",
        "replyto": "KAseclJyj5",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission701/Reviewer_iADi"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission701/Reviewer_iADi"
        ],
        "content": {
            "summary": {
                "value": "The paper addresses the question of learning diverse skills from offline dataset while being close to expert. The objective is formulated and existing ideas are used to solve the combined objective effectively. The resulting method is tested on offline datasets from D4RL and a real robot to demonstrate the diversity induced by their method."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "2 fair"
            },
            "contribution": {
                "value": "2 fair"
            },
            "strengths": {
                "value": "1. The paper presents a new objective for unsupervised skill learning from offline datasets - maximize mutual information combined with staying close to expert. To facilitate this, the method leverages algorithms from previous works that are off-policy in nature. To solve the mutual information objective they use the variational lower bound previously seen in DIAYN, to optimize the KL-constraint they use DICE method and for optimizing objective and constraint jointly the lagrangian method is used, commonly seen in safe RL literature. The combination results in a new off-policy skill discovery method.\n2.  The paper empirically demonstrates effectiveness of their method on simulated tasks on D4RL by comparing metrics for diversity using the offline dataset. They show the tradeoff of contraint vs diversity and the expected difference of importance ratio.\n3. The paper also test the algorithm on a real quaduped which learns gaits with various heights."
            },
            "weaknesses": {
                "value": "1. The paper misses to explain the motivation behind proposing the objective:\n\nWhy stay close to expert? If the objective is to generate diverse skill, what is the objective of incoporating the constraint of staying close to expert. An explanation through examples might help to motivate the paper better.\nKL divergence to expert: Any objective that uses KL divergence is extremely sensitive if the learned skill goes out of support of the expert dataset. It is motivated in the paper the skill should imitate some part of expert but this is not what is enforced by the KL divergence.\n\n2. Theoretical contributions: I believe the lemma\u2019s are minor variations over previous works in DICE space [1,2,3,4] which might be discussed and compared to more thoroughly. \n3. Evaluation:\n    1. Online evaluation: The paper currently only plots metrics on offline dataset. I believe this is not the correct metric. A learned visitation distribution might not be practically feasible although theoretically it should be. One way to test it in simulated domains, is to roll out pi_z for different skills and compare the resulting visitation distribution. \n    2. Qualitative Diversity of skill: An important part of the evaluation process should be a qualitative comparison of the skills the algorithm learns. If the algorithm learn meaningless skills it would be clear from the deployed policy. \n    3. Baselines and Quantitative diversity of skill: No prior methods for skill discovery are compared against. A standard comparison might be the resulting estimated mutual information of skills between prior methods and DOI. Although prior methods are not developed for offline setting, a simple extension would be to pair them with offline RL. Example: DIAYN could be combined with IQL instead of SAC."
            },
            "questions": {
                "value": "1. In the paragraph after Figure 3, How does skill conditioned variant of SMODICE does not have a discriminator?  SMODICE itself learns a discriminator in the original method which estimates ratio of expert to offline data. Do you mean the skill discriminator? \n2. I am not sure how to compute the expectation of importance ratio for different skills. Is the expectation over the offline dataset?\n3. For SOLO12, the data is already generated by a skill-based algorithm which seems their is a strong prior to recovering the same skills as the original algorithm? Can you ablate how the learned skills are different from skills found by Domino?"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "3: reject, not good enough"
            },
            "confidence": {
                "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        },
        "number": 2,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission701/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698794128432,
        "cdate": 1698794128432,
        "tmdate": 1699635997080,
        "mdate": 1699635997080,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "sWQ69J9Zts",
        "forum": "KAseclJyj5",
        "replyto": "KAseclJyj5",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission701/Reviewer_gvyu"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission701/Reviewer_gvyu"
        ],
        "content": {
            "summary": {
                "value": "This paper proposes a novel algorithm to connect Fenchel duality, reinforcement learning, and unsupervised skill discovery to maximize a mutual information objective subject to KL-divergence state occupancy constraints. This approach is used to diversify offline policies for a 12-DoF quadruped robot and several environments from the standard D4RL benchmark in terms of both \u21132 distance of expected successor features and \u21131 distance of importance ratios."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "3 good"
            },
            "contribution": {
                "value": "3 good"
            },
            "strengths": {
                "value": "The strength of this paper is that it proposes a principled offline algorithm for unsupervised skill discovery that maximizes diversity while ensuring each learned skill imitates state-only expert demonstrations to a certain degree. In order to compute the optimal solution to the problem formulation, the authors propose to use an approximation algorithm \"alternative optomization\". The authors demonstrate the effectiveness of the method on standard offline benchmarks and a custom offline dataset collected from a quadruped robot. The resulting skill diversity naturally entails a trade-off in task performance, which can be controlled via a KL constraint level \u03f5."
            },
            "weaknesses": {
                "value": "1. In the experiment section, it will be good to see some comparison between the proposed method with other state-of-the-art methods for unsupervised skill discovery. \n2. Computational complexity of the proposed algorithm is not mentioned in the paper. \n3. The paper does not provide a comprehensive evaluation of the proposed method on a wide range of tasks and environments."
            },
            "questions": {
                "value": "Is there a convergence analysis of the algorithm? What if the algorithm does not converge?"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "5: marginally below the acceptance threshold"
            },
            "confidence": {
                "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
            },
            "code_of_conduct": {
                "value": "Yes"
            },
            "first_time_reviewer": {
                "value": "Yes",
                "readers": [
                    "ICLR.cc/2024/Conference/Program_Chairs",
                    "ICLR.cc/2024/Conference/Submission701/Senior_Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission701/Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission701/Reviewer_gvyu"
                ]
            }
        },
        "number": 3,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission701/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698821295829,
        "cdate": 1698821295829,
        "tmdate": 1699635997009,
        "mdate": 1699635997009,
        "license": "CC BY 4.0",
        "version": 2
    }
]