[
    {
        "id": "bAKMNG4JoM",
        "forum": "2Pup7olzxj",
        "replyto": "2Pup7olzxj",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission9253/Reviewer_Npa9"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission9253/Reviewer_Npa9"
        ],
        "content": {
            "summary": {
                "value": "This manuscript follows the approach in [Li et al., 2023] to build a direct approach to solving the KSDFT equations for systems in periodic solid-state systems (by using a parameterization of the periodic part of the Bloch functions analogous to the prior work). The resulting formulation is then used for band-structure prediction and geometry optimization."
            },
            "soundness": {
                "value": "2 fair"
            },
            "presentation": {
                "value": "3 good"
            },
            "contribution": {
                "value": "2 fair"
            },
            "strengths": {
                "value": "The manuscript is reasonably well written (though many details are necessarily relegated to the appendix), and does show the potential efficacy of the proposed scheme through some experiments. While, in a certain sense, the core technical insights come from [Li et al., 2023] there are invariably details to be worked out and they seem appropriately covered in detail in the appendix (though its length coupled with the reviewing timeline means I have, admittedly, not checked all the details). The problem space considered is clearly important, so the present work is certainly interesting and could have some impact."
            },
            "weaknesses": {
                "value": "Given the framing of this manuscript, a core part of the contribution is empirical illustration of the methods efficacy. (As it has to be shown to work to be interesting.) While the results are suggestive that it does, they are somewhat limited and mostly limited to qualitative comparisons with little quantitative characterization of the methods efficacy. This makes it hard to evaluate the potential impact. More concrete tests and conclusions that address these points could easily elevate the potential impact of the manuscript. \n\nIn the band structure interpolation case, no quantitative errors/discrepancies are provided for the structure. For well separated (e.g., insulating) bands this should be easy to do. Is the method accurate on a fine k-mesh? Even for \"entangled\" bands this could be done sufficiently far from the largest eigenvalues considered.  The plots (especially in Fig. 5) show clear differences, are these meaningful? could the accuracy of the method be improved? what is considered the \"ground truth?\" Similarly, often in band structure plots there are more fine-grained structures than \"gap or not\" that are of interest (e.g., certain types of crossings), yet those are not explored here. Absent this more detailed analysis it is hard to assess whether or not the method is effectively computing band structure. \n\nOn a related note, a common technique to go from the k-mesh to band structure on some path in k-space is Wannier interpolation. Any comparison with this is missing from the present manuscript (even if it was interpolation from the k-mesh used with the proposed method). Given the need for \"fine tuning\" per point on the k-mesh maybe interpolation is preferable. A comparison seems warranted. Details for this point (and the prior comments) can be found in, e.g., Section VI of [Marzari, Nicola, et al. \"Maximally localized Wannier functions: Theory and applications.\" Reviews of Modern Physics 84.4 (2012): 1419.].\n\nFor the geometry optimization, given the ambiguity in the results having only one system makes it hard to draw conclusions. What are the conclusions beyond some optimizers going to local minima and some not in this one case? The manuscript would benefit from clarifying this point, and doing so may require more systems.\n\nSimilarly to the above points, while the single comparison with SCF for the potential energy surface is nice, it is ultimately one material and it seems pertinent to consider others across a range of \"types\" to be able to more strongly advocate for the relative efficacy of the method. Also, no qualitative or quantitative discussions of performance are given with classical approaches (across any experiments). While there may be advantages even if not speed, it would be good to have some sense of how such an approach stacks up with prior work (to at least better under stand the tradeoffs of using it).\n\n**update after author response**\n\nI would like to thank the authors for their thoughtful replies to my concerns and those of other reviewers. \n\nIn brief, the response does address some of my questions (though raises others, like just how limited is the current approach with respect to cutoff and k-point mesh\u2014that seems important to think of it as a competing method). While I appreciate some of the small (proposed) quantitative additions to the manuscript, my overall assessment of the manuscript remains essentially unchanged."
            },
            "questions": {
                "value": "Some of the setup in Figure 2 + section 3 is slightly unclear/inconsistent and should be clarified. In the text it is suggested that the first step computes on the k-mesh (which is consistent with section 2), but the caption says \"first k-point.\" Is this a typo? or is something else meant. \n\nIs there any interpolation (beyond for plotting) done in Figure 2? the lower part of the figure suggests a rather sparse set of points on the path through k-space.\n\nAdditional questions specifically related to weaknesses of the manuscript are outlined in that section of the review."
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "5: marginally below the acceptance threshold"
            },
            "confidence": {
                "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
            },
            "code_of_conduct": {
                "value": "Yes"
            },
            "first_time_reviewer": {
                "value": "Yes",
                "readers": [
                    "ICLR.cc/2024/Conference/Program_Chairs",
                    "ICLR.cc/2024/Conference/Submission9253/Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission9253/Reviewer_Npa9",
                    "ICLR.cc/2024/Conference/Submission9253/Senior_Area_Chairs"
                ]
            }
        },
        "number": 1,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission9253/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698722186323,
        "cdate": 1698722186323,
        "tmdate": 1700705669315,
        "mdate": 1700705669315,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "q6kL4lfVMx",
        "forum": "2Pup7olzxj",
        "replyto": "2Pup7olzxj",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission9253/Reviewer_TgFK"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission9253/Reviewer_TgFK"
        ],
        "content": {
            "summary": {
                "value": "This paper introduces a method to compute differentiable DFT solutions in the plane-wave/materials setting. This is achieved by avoiding the self-consistent equation loop where the Hamiltonian is dependent on the electron density, and the wave functions are eigenstates of the Hamiltonian. Differentiating through this SCF procedure requires differentiating through many iterations of eigendecomposition, which is highly unstable.\n\nThe proposed solution is to minimize an energy functional over a set of orthogonal vectors that has been parameterized as the QR decomposition of an unconstrained matrix. This approach requires differentiating only through one QR decomposition and the minimum of the optimization problem.\n\nExperiments are shown where 1) band structure is determined for various materials and 2) atom positions are optimized, showcasing the differentiability of the solution."
            },
            "soundness": {
                "value": "4 excellent"
            },
            "presentation": {
                "value": "4 excellent"
            },
            "contribution": {
                "value": "3 good"
            },
            "strengths": {
                "value": "This work addresses an important problem and opens the door to differentiating through DFT solutions, making these approaches more amenable to machine learning and optimization tools, which can have vast applications in materials science. I really like to see this problem being addressed after having run into it in a different context at one point. \n\nThe paper is well written for the conference, giving a comprehensive yet concise introduction to the problem setting.\nThe experiments are well chosen and cover the main ideas.\n\nI will point out that I am not familiar with the literature landscape around these methods and will defer to the judgment of other reviewers for novelty of the method."
            },
            "weaknesses": {
                "value": "1) If I am not mistaken, there is nothing much stopping this approach from being applied to other DFT settings, such as small molecules, using some form of Gaussian-harmonic basis set. At least the orthogonality of the orbitals can be guaranteed in the same way, though one uses the orthogonality of the plane waves. If this method is capable of covering this domain as well, I wish it was done in this paper, since it would showcase the strong generality of the approach.\n\n2) A lot of related work is mentioned, some of which close enough to allow for direct numerical comparisons. These would have improved the evaluation of the method."
            },
            "questions": {
                "value": "Would the authors be able to comment on Weaknesses point 1 and 2?"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "6: marginally above the acceptance threshold"
            },
            "confidence": {
                "value": "2: You are willing to defend your assessment, but it is quite likely that you did not understand the central parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        },
        "number": 2,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission9253/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698806160078,
        "cdate": 1698806160078,
        "tmdate": 1699637164780,
        "mdate": 1699637164780,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "z9FESeyxaz",
        "forum": "2Pup7olzxj",
        "replyto": "2Pup7olzxj",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission9253/Reviewer_AFLR"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission9253/Reviewer_AFLR"
        ],
        "content": {
            "summary": {
                "value": "This paper introduces a modification to density functional theory(DFT) codes which will enable back propagation through materials property predictions. The paper presents a novel and fully differentiable approach to address the Kohn-Sham Density Functional Theory (KS-DFT) in the context of solid-state physics, which is a fundamental method for studying electronic properties and structures in materials. This approach uses a plane-wave basis and is designed to leverage emerging deep learning frameworks and optimization techniques, offering robust convergence performance. The paper demonstrates the accuracy and effectiveness of the proposed approach in predicting the electronic band structures of various crystalline materials, such as lithium, aluminum, carbon (diamond), and silicon. The related works of machine learning and DFT are discussed, while a lot of details of algorithms and experiments are also present in appendix sections."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "3 good"
            },
            "contribution": {
                "value": "3 good"
            },
            "strengths": {
                "value": "The modifications to density functional theory proposed in this paper will enable DFT to become a layer in a machine learning model, such as being used to compute the loss. Also, given how important DFT is to the problem of materials design, this improvement is bound to have an impact if it gets incorporated into DFT code bases like VASP and Quantum Espresso (there is no discussion of this in the paper).\n\nIt correctly identifies insulating, metallic, and semiconductor properties in these materials, in line with established implementations. The optimization of atomic structures within crystals are also important. The paper presents experiments showing that the proposed approach, combined with optimization algorithms like Adam and Yogi, can successfully identify optimal atomic configurations, including those for diamond and graphite-like structures. These geometry optimizations have implications for understanding the properties of materials.\nThe authors also compare the proposed direct optimization approach with traditional Self-Consistent Field (SCF) methods. The results indicate that the direct optimization method consistently converges, while SCF methods may encounter challenges in achieving full convergence, especially in complex energy landscapes."
            },
            "weaknesses": {
                "value": "Overall, however, I think the work would be more interesting and relevant if it had more discussion of how the work might synergize with other work, in particular materials generation and property prediction. As is, some of the impact of the paper seems left to the reader. Explicit explanation and examples of impact would be helfpul.\n\nAs such, I wonder if it would be more appropriate in a computational physics venue."
            },
            "questions": {
                "value": "Looking through the \"Related Works\" section, it seems like much of what was done in this paper was already done for the so-called \"orthonormal basis functions\", the basis used in DFT to study the chemistry of molecules, i.e. systems without a periodic crystalline structure. This paper may have just replaced these basis functions with the \"plane wave\" basis functions used in this paper. So it is possible this paper took established work and just changed the basis. A switch which hardly seems like a big advance, though nevertheless a useful one."
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "5: marginally below the acceptance threshold"
            },
            "confidence": {
                "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
            },
            "code_of_conduct": {
                "value": "Yes"
            },
            "first_time_reviewer": {
                "value": "Yes",
                "readers": [
                    "ICLR.cc/2024/Conference/Program_Chairs",
                    "ICLR.cc/2024/Conference/Submission9253/Senior_Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission9253/Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission9253/Reviewer_AFLR"
                ]
            }
        },
        "number": 3,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission9253/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698807274771,
        "cdate": 1698807274771,
        "tmdate": 1699637164640,
        "mdate": 1699637164640,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "wn7cxK7jC1",
        "forum": "2Pup7olzxj",
        "replyto": "2Pup7olzxj",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission9253/Reviewer_Arv3"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission9253/Reviewer_Arv3"
        ],
        "content": {
            "summary": {
                "value": "# Initial comment\nIn this paper, the authors utilize differentiable optimization to enhance the convergence robustness of solving KS-DFT, compared to the traditional SCF method. The proposed approach is implemented in JAX to utilize its automatic differentiation capability. Experiments on band structure prediction and geometry optimization are performed to show the effectiveness of the proposed method.\n\n# After author-reviewer rebuttal\nThanks very much for your detailed response and careful work updating the manuscript. Sorry for missing the deadline to feedback to your response, as I encountered website failure.\n\n- Your clarification has been very helpful.\n- Sorry I think I made a mistake thinking you claimed efficiency in the paper.\n- I find several reviewers shared the concern on the plane wave basis set selection. We don't mean it is not OK nor important. I think we are questioning the proposed method does not need to be limited to it.\n- However, the biggest concern from me remains that, I am sorry to say I still find the contribution of the proposed method, compared to traditional methods and previous works, to be marginal, for both the SCF equation solving and the geometry optimization tasks.\n\nWith all the factors considered, I tend to remain my original score for now."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "3 good"
            },
            "contribution": {
                "value": "3 good"
            },
            "strengths": {
                "value": "Using automatic-differentiation-assisted optimization instead of equation solving to improve the convergence robustness and certain optimization tasks is a promising and emerging direction."
            },
            "weaknesses": {
                "value": "The claim that the iterative nature of SCF obstructs the application of deep learning is not very suitable. See previous works such as DEQ, KSR, DQC, etc.\n\nThe experiments are not quite sufficient:\n- For the band structure experiment, although several popular packages are compared, the advantages of the proposed method are not clear.\n- For the geometry optimization experiment, no baseline methods are compared, while there are mature automation tools such as geomeTRIC and pyberny.\n\nHow the automatic differentiation capability of JAX is utilized is not clearly described in the paper. I will recommend Fig. 8 to be displayed in the main context with more detailed introduction."
            },
            "questions": {
                "value": "- I think the defining difference between the proposed method and the traditional method is to solve the eigenvalue problem with optimization (which has also been heard before, see https://neurips.cc/virtual/2023/poster/70089). But then to me, this is still an iterative method. So can the authors explain why in the paper it is emphasized to overcome the iterative nature of the traditional method?\n- Besides the robustness of convergence, efficiency is also claimed in the paper. However, it seems that the claimed advantage in efficiency is not demonstrated?\n- For the geometry optimization task, traditionally there can be analytical derivatives available. So I wonder if there is any advantage of using the proposed method?\n- Can the authors further clarify why is the plane-wave basis set emphasized?"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "3: reject, not good enough"
            },
            "confidence": {
                "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
            },
            "code_of_conduct": {
                "value": "Yes"
            },
            "first_time_reviewer": {
                "value": "Yes",
                "readers": [
                    "ICLR.cc/2024/Conference/Program_Chairs",
                    "ICLR.cc/2024/Conference/Submission9253/Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission9253/Reviewer_Arv3",
                    "ICLR.cc/2024/Conference/Submission9253/Senior_Area_Chairs"
                ]
            }
        },
        "number": 4,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission9253/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1699060887903,
        "cdate": 1699060887903,
        "tmdate": 1700751231374,
        "mdate": 1700751231374,
        "license": "CC BY 4.0",
        "version": 2
    }
]