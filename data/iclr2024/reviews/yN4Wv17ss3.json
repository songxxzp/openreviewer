[
    {
        "id": "DAy7QoBJFr",
        "forum": "yN4Wv17ss3",
        "replyto": "yN4Wv17ss3",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission4682/Reviewer_E6sG"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission4682/Reviewer_E6sG"
        ],
        "content": {
            "summary": {
                "value": "The paper examines the theoretical basis of in-context reinforcement learning (ICRL), specifically focusing on the supervised pretraining approach. This analysis builds upon previous studies [1, 2] and sheds light on the specific capabilities of algorithms trained through supervised pretraining. Theoretical findings demonstrate that transformers can approximate well-known algorithms such as LinUCB for bandit problems and UCB-VI for tabular MDPs under certain conditions. Empirical simulations further confirm the authors' findings that trained transformers effectively imitate bandit algorithms.\n\n[1] Laskin M, Wang L, Oh J, et al. In-context reinforcement learning with algorithm distillation[J]. arXiv preprint arXiv:2210.14215, 2022.\n\n[2] Lee J N, Xie A, Pacchiano A, et al. Supervised Pretraining Can Learn In-Context Reinforcement Learning[J]. arXiv preprint arXiv:2306.14892, 2023."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "3 good"
            },
            "contribution": {
                "value": "3 good"
            },
            "strengths": {
                "value": "1. This work offers a timely investigation into the theoretical understanding of ICRL. Based on previous findings, the proposed framework advances this line of research by providing valuable analysis with guarantees on sample complexity.\n2. The analysis is overall well-executed.  It is good to have a clear and unified overview of the previous work.\n3. The paper is easy to follow."
            },
            "weaknesses": {
                "value": "1. Although this work theoretically covers tabular MDPs, it lacks the necessary experimental results to support the analysis.\n2. I am unsure if the proposed framework can offer insights on improving pretraining approaches for ICRL. I recommend that the authors address this in their manuscript."
            },
            "questions": {
                "value": "1. Can you provide further explanation on the importance of calculating loss on the entire trajectory in Equation 3?"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "6: marginally above the acceptance threshold"
            },
            "confidence": {
                "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
            },
            "code_of_conduct": {
                "value": "Yes"
            },
            "first_time_reviewer": {
                "value": "Yes",
                "readers": [
                    "ICLR.cc/2024/Conference/Program_Chairs",
                    "ICLR.cc/2024/Conference/Submission4682/Senior_Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission4682/Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission4682/Reviewer_E6sG"
                ]
            }
        },
        "number": 1,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission4682/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698658589373,
        "cdate": 1698658589373,
        "tmdate": 1699636449587,
        "mdate": 1699636449587,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "k5Zk7sKJt0",
        "forum": "yN4Wv17ss3",
        "replyto": "yN4Wv17ss3",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission4682/Reviewer_fr59"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission4682/Reviewer_fr59"
        ],
        "content": {
            "summary": {
                "value": "**Update after rebuttal:** I consider all issues raised by all reviewers sufficiently addressed by the authors. I stand by my original recommendation to accept the paper and have raised my confidence accordingly.\n\nThe paper theoretically investigates the conditions under which Transformers, pre-trained with offline RL datasets, can be trained to perform In-Context RL (ICRL). To this end, the paper distinguishes between an offline algorithm, used to collect trajectories, and an expert algorithm, which is evaluated on the offline trajectories and the goal of the transformer is to learn to imitate the expert algorithm. The main result of the paper is a generalization bound that depends on model capacity (somewhat expected) and on the distribution ratio between the offline algorithm and the expert algorithm to imitate; implying that ICRL is possible if the model capacity is large enough and the online algorithm performs \u201cclose enough\u201d to the expert algorithm. The paper then theoretically analyzes three RL algorithms in detail (LinUCB, ThompsonSampling, and UCB-VI), concluding that Transformers are able to learn these and then perform them in-context. The theoretical analysis is complemented with simulations that support the theory."
            },
            "soundness": {
                "value": "4 excellent"
            },
            "presentation": {
                "value": "3 good"
            },
            "contribution": {
                "value": "3 good"
            },
            "strengths": {
                "value": "The paper is quite technical, but well written; leaning towards formalism and clean definitions over extensive prose (which I consider a plus in this case, if the paper length were not limited by 9 pages I would recommend adding additional explanation / interpretation of the formal statements and results). The analysis is timely and original, looks very plausible to me (though I did not check the proofs in detail), and sheds some much needed light on the properties of Transformers that are often portrayed as borderline mystical. I think the work lays some much needed groundwork and provides a theoretical framework for analysis of further RL algorithms; I thus have no concerns regarding the paper's significance to the ICLR community.  \n\n**Pros:**\n * Timely problem, approached from a solid theoretical angle. The result is a sophisticated theoretical framework for analyzing RL algorithms and their learnability by Transformers via offline supervised pre-training.\n * Generalization error bound regarding the imitation performance of the Transformer w.r.t. the expert algorithm. Additionally, when assuming realizability, the supervised pre-trained Transformer (log-loss minimization on offline trajectories) is proven to be able to imitate the expert algorithm, given that the offline policy used to collect data \u201cis close\u201d to the expert algorithm (quantified in terms of a distribution ratio).\n * Analysis of 3 concrete RL algorithms, showing theoretically that Transformers can learn to imitate them in-context (with some extra conditions).\n * Simple simulations to confirm the theoretical results for the 3 algorithms."
            },
            "weaknesses": {
                "value": "The paper is interesting and results look good - my main criticism is that the paper stops somewhat short of situating the results within a wider agenda and clearly stating open issues and limitations of the current results. Overall I currently think that the paper is ready for publication and interesting to a significant part of the ICLR audience. I therefore suggest acceptance at the moment, and will update my verdict based on the other reviews and the authors\u2019 response (it is possible that I missed or overlooked some critical details in the theory and required assumptions for it to hold; therefore I have lowered my confidence accordingly).\n\n**Cons:**\n * The paper currently lacks a strong discussion of limitations. The theory requires some assumptions, and while having the generalization bound is very good it remains somewhat unclear how hard/easy it is to make the bound tight in practice (a lot comes down of course to the mismatch between offline and expert algorithm; how easy is it in practice to keep this mismatch low? What can even be easily said about the distribution ratio in practice?). How do the theoretical statements in the paper lead to non-vacuous practical take-aways (after all requiring low distribution ratio between offline and expert algorithm, and sufficient model capacity are not the most surprising requirements)? Or do additional problems need to be solved to make such statements?\n * Another issue that is missing from the discussion (and perhaps even the analysis) is partial observability. If the expert algorithm depends on unobservables, I believe it would be possible to create settings that lead to a failure to imitate the expert; essentially leading to \u201cSelf-Delusions\u201d - see [1]. Taking a wild guess here, but this would probably imply additional assumptions around identifiability? This point becomes even more important when considering humans as \u201cexpert policies\u201d.\n * This is perhaps more a question than a weakness with actionable improvement (so consider this point addressed if it can easily be clarified/answered). I am wondering about the relationship between the transformer learning an **amortized algorithm** (i.e. the trained net behaves as if it were running the algorithm under the hood, but only on-distribution because it is not actually running the algorithm but has learned a function that produces the same outputs) **vs. actually implementing something close to the expert algorithm**. It seems to me that the paper suggests the latter (which is why it is important that Transformers can implement accelerated gradient descent and matrix square roots algorithmically). Naively I would have guessed that the transformer learns an amortized solution rather than the actual algorithm. On-distribution the two are indistinguishable, but typically the amortized solution generalizes less well. There are some experiments that could tease apart the two possibilities (but I\u2019d also be interested in a general comment by the authors; most importantly whether anything in the paper would break with an amortized solution). Sketches for experiments (I do not necessarily expect to see them performed, but they might help clarify the discussion):\n    * Let the offline algorithm not fully cover the state space. At test time input these parts of the state-space (e.g. a coordinate input in a gridworld that is much larger than anything the Transformer has ever seen; but same dynamics, same reward function, etc). An amortized solution should struggle in this case (and potentially break down catastrophically), whereas learning the correct algorithm should not.\n    * Change the reward function at test-time (e.g. picking up bananas in a gridworld has positive reward and apples have negative reward during pre training, but at test-time the rewards are reversed). The amortized solution should struggle in this case.\n\n[1] Shaking the foundations: delusions in sequence models for interaction and control, Ortega et al. 2021."
            },
            "questions": {
                "value": "1) (How) Could ICRL be used to surpass the performance of the expert (e.g. going from human chess as the expert to superhuman chess)? Most RL algorithms have fairly simple parameters to increase performance (train longer, lower discount, deeper backups, more unrolls, \u2026) - how could this look like for ICRL. Or, alternatively, is it possible make a theoretical statement showing that ICRL performance is capped at exactly the level of the expert (even if we used ICRL to generate a new dataset of supervised trajectories where it slightly surpasses expert performance)?\n\n2) After Eq (2): \u201call the algorithm outputs [...] along the trajectory can be computed in a single forward propagation.\u201d Does that also imply having masked (causal) attention?"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "8: accept, good paper"
            },
            "confidence": {
                "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
            },
            "code_of_conduct": {
                "value": "Yes"
            },
            "first_time_reviewer": {
                "readers": [
                    "ICLR.cc/2024/Conference/Program_Chairs",
                    "ICLR.cc/2024/Conference/Submission4682/Senior_Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission4682/Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission4682/Reviewer_fr59"
                ]
            }
        },
        "number": 2,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission4682/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698687879072,
        "cdate": 1698687879072,
        "tmdate": 1700741377474,
        "mdate": 1700741377474,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "Ty7PLt2JRJ",
        "forum": "yN4Wv17ss3",
        "replyto": "yN4Wv17ss3",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission4682/Reviewer_HUY7"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission4682/Reviewer_HUY7"
        ],
        "content": {
            "summary": {
                "value": "This paper provides a theoretical framework that analyzes supervised pretraining for ICRL. It provides two proofs: 1. the supervised-pretrained transformer will imitate the conditional expectation of the expert algorithm given the observed trajectory; 2. transformers with ReLU attention can efficiently approximate near-optimal online reinforcement learning algorithms."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "3 good"
            },
            "contribution": {
                "value": "2 fair"
            },
            "strengths": {
                "value": "1. Their original theory proved the feasibility of using a supervised pretraining transformer on in-context reinforcement learning and provides a quantitative analysis framework.\n2. The theoretical analysis demonstrates the important role of supervised pretraining Transformers in in-context RL."
            },
            "weaknesses": {
                "value": "1. Since my research does not focus on the theory of RL. Therefore, I give some general comments. \n2. I am not sure the conclusion is a little bit narrow. The conclusion is limited in a supervised paradigm, using pretraining, and in an ICRL setting. It seems that these conditions restrict the conclusions to be general."
            },
            "questions": {
                "value": "1.Would different pre-trained method lead to different results?\n\n2.Can learning-from-scratch DT figure out similar conclusion? What\u2019s the difference?\n\n3.Will your conclusions help to inspire the empirical study? Such as figuring out better DT-based offline RL algorithms when using D4RL datasets?"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "6: marginally above the acceptance threshold"
            },
            "confidence": {
                "value": "1: You are unable to assess this paper and have alerted the ACs to seek an opinion from different reviewers."
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        },
        "number": 3,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission4682/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698710744441,
        "cdate": 1698710744441,
        "tmdate": 1699636449391,
        "mdate": 1699636449391,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "EPTl7BxcOi",
        "forum": "yN4Wv17ss3",
        "replyto": "yN4Wv17ss3",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission4682/Reviewer_ycZf"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission4682/Reviewer_ycZf"
        ],
        "content": {
            "summary": {
                "value": "This paper addresses the theory of supervised pretraining for in-context reinforcement learning (ICRL) via transformers. \n- It first proves that supervised pre-training will imitate the expert algorithm, with a generalization error that scales with the model capacity and a distribution ratio between the expert algorithm and the context algorithm that is used to generate offline trajectories. \n- It then transformers can approximate RL algorithms including LinUCB (w ridge regression), Thompson sampling (w ridge regression), and UCB-VI."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "3 good"
            },
            "contribution": {
                "value": "2 fair"
            },
            "strengths": {
                "value": "1. The theory of supervised pretraining for in-context reinforcement learning via transformers is an interesting and important problem. This paper is among the first to explore that area. \n\n2. The paper shows a comprehensive understanding of the existing literature via the related work. \n\n3. The paper shows technical depth in the proofs of Theorems. \n\n4. The paper is technically sound and well-written."
            },
            "weaknesses": {
                "value": "1. My main concern is that the two main sets of results are not as dependent/relevant to Transformers. \n- For Theorem 6 (supervised pretraining can imitate the expert algorithm) -- this seems to be a general result that is not specific to Transformers. In fact, any supervised pretraining models that satisfy the approximate realizability assumption should suffice Theorem 6. Is this true? \n- For the theorems in Section 4, the paper mostly constructs a specific Transformer structure (e.g., 3-head attention + MLP with a specified QVK) and says that this certain Transformer can mimic the gradient update in the no-regret RL/bandit algorithms. My understanding is that the Transformer is an overkill, and this can generally apply to NNs that have similar structures. Is this true?\n\n\n2. The idea of proofs of Theorems in Section 4 seems essentially similar to that of Bai et al. 2023, though with nuances. \n\n\n3. If I understand correctly, the distribution ratio $\\mathcal{R}$ in Equation (6) can be arbitrarily large. This significantly limits the usefulness of the bound. In fact, in many cases (except the Algorithm distillation case), this ratio should be sufficiently large as Alg_E and Alg_0 are usually different, and the difference is accumulated over the entire trajectory. \n\n\n4. Minor issues:\n- $M$ is used as both an MDP environment and the number of heads\n- Not sure if I missed this -- $n$ Equation (5) and onwards has not been formally introduced. Is this the number of trajectories/samples?"
            },
            "questions": {
                "value": "Please see my questions as in the above."
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "5: marginally below the acceptance threshold"
            },
            "confidence": {
                "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        },
        "number": 4,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission4682/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698986343968,
        "cdate": 1698986343968,
        "tmdate": 1699636449311,
        "mdate": 1699636449311,
        "license": "CC BY 4.0",
        "version": 2
    }
]