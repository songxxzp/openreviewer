[
    {
        "id": "cDn5CB3bl8",
        "forum": "ByR3NdDSZB",
        "replyto": "ByR3NdDSZB",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission7021/Reviewer_fXDT"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission7021/Reviewer_fXDT"
        ],
        "content": {
            "summary": {
                "value": "This paper studies the policy alignment in reinforcement learning and proposes a unified framework, PARL, which is a new bilevel optimization framework to address existing problems in the previous works. Specifically, the PARL explicitly considers the dependence of the alignment objective on the data generated by policy trajectories (the alignment goal is evaluated on the learned policy, which also generates the data). In the algorithmic side, the authors propose A-PARL, which is provably efficient, to solve the problems under the PARL framework and empirical results are provided."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "3 good"
            },
            "contribution": {
                "value": "3 good"
            },
            "strengths": {
                "value": "1 The paper first identifies a good point on the existing problem of the previous works. The argument that the alignment objective in the upper-level depends on the lower level through the learned policy is convincing and is clearly clarified. These arguments make the proposed PARL framework natural and intuitive. This is the main point I would like to recommend acceptance for the work.\n\n2 The paper further proposes an algorithm named A-PARL to solve the PARL problem, which is with sound mathematical guarantee under suitable assumptions and demonstrate impressive empirical performances. Based on the literature review, I think the baselines in the experiment part are competitive, which further support the advantage of the proposed framework and algorithm.\n\n3 The writing is good and the paper is easy to follow."
            },
            "weaknesses": {
                "value": "1 I am not very familiar with the literature of the benchmarks used in this area but I go through the papers along the line and confirm that the experiments conducted by the authors are commonly adopted in the literature so I assume that the experiments are satisfactory (which may need to be further evaluated by other expert reviewers).\n\n2 Could you comment on the generality of the proposed framework? In particular, I am interested in whether this framework can be extended to handle the alignment of language model because the reward model quality is the bottleneck in many cases and most of the existing approaches use only a fixed reward model."
            },
            "questions": {
                "value": "see weakness"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "8: accept, good paper"
            },
            "confidence": {
                "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
            },
            "code_of_conduct": {
                "value": "Yes"
            },
            "first_time_reviewer": {
                "readers": [
                    "ICLR.cc/2024/Conference/Program_Chairs",
                    "ICLR.cc/2024/Conference/Submission7021/Senior_Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission7021/Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission7021/Reviewer_fXDT"
                ]
            }
        },
        "number": 1,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission7021/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698784455518,
        "cdate": 1698784455518,
        "tmdate": 1700711605506,
        "mdate": 1700711605506,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "gde2fIkAMR",
        "forum": "ByR3NdDSZB",
        "replyto": "ByR3NdDSZB",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission7021/Reviewer_iimX"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission7021/Reviewer_iimX"
        ],
        "content": {
            "summary": {
                "value": "The paper under review studied policy alignment problem of reinforcement learning.\nThe authors proposed a bilevel framework to improve the efficiency of the alignment and to better evaluate the alignment.\nAn algorithm was derived analytically to optimize this bilevel problem, and convergence to stable point was proved.\nIn addition, simulations was included to demonstrate the capacity of the proposed framework."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "3 good"
            },
            "contribution": {
                "value": "3 good"
            },
            "strengths": {
                "value": "The bilevel formulation of policy alignment problem is novel and interesting.\nThe paper is mostly well written, easy to follow (see questions below). \nThe theoretical derivation is novel and thorough."
            },
            "weaknesses": {
                "value": "1. The objective of the paper is somewhat confusing to me. \nWould the authors please clarify the cause of the misalignment that is considered? and what role does the human agent play?\n\n* Is there a fixed RL problem, but the agent can only get some feedback from a human who partially knows the real reward, and such \nfeedback changes over time as human learns more about the reward?  \n\n* or a dynamically changing RL problem is consider i.e. reward (value function) changes over time, \nand one possible cause of such change is due to how the reward is generated (feedback produced by a human's preference).\n\nMore precisely, the authors used $\\nu$ to parameterize the upper level (evaluating the lower level policy). \nWhat is does each $\\nu$ represent?\n\n\n2. My other concern is experiments are not detailed. Descriptions and simulation set up are all missing. For instance, figure 2, \nwhat precisely do 'walker' or 'door open' or 'button press' aim to do? \nhow does the misalignment occur? what does oracle represent? what are the upper level objective functions $G(\\nu, \\theta^*(\\nu))$ for these tasks?"
            },
            "questions": {
                "value": "1. On top of page 4, the author mentioned $\\nu \\in \\mathbb{R}^n$. What does $n$ represent here? \n\n2. In the paper, the authors used $H_l$ to represent the horizon of the lower-level trajectory, and $H_u$ to represent the horizon of the lower-level trajectory. Why there are two different horizons? are trajectories used for upper level resampled?\n\n3. On page 7, in assumption 4, what do $\\mu, \\hat{l}, \\hat{\\mu}$ represent?\n\n4. In Lemma 1, does eq 21 hold for any choice of convex function $f$ or a specific $f$? also $L_{\\pi}$ should be $L_2$?\n\n5. Suggestion: through Lemma 2 and Thm 1, there are too many constant symbols such as $L_1, L_5, L_6$. It might be a good idea to combine some of them together in the main text to make the statement cleaner."
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "6: marginally above the acceptance threshold"
            },
            "confidence": {
                "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
            },
            "code_of_conduct": {
                "value": "Yes"
            },
            "first_time_reviewer": {
                "value": "Yes",
                "readers": [
                    "ICLR.cc/2024/Conference/Program_Chairs",
                    "ICLR.cc/2024/Conference/Submission7021/Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission7021/Reviewer_iimX",
                    "ICLR.cc/2024/Conference/Submission7021/Senior_Area_Chairs"
                ]
            }
        },
        "number": 2,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission7021/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1699062355407,
        "cdate": 1699062355407,
        "tmdate": 1700341227940,
        "mdate": 1700341227940,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "iei2Yxq8tR",
        "forum": "ByR3NdDSZB",
        "replyto": "ByR3NdDSZB",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission7021/Reviewer_nxvi"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission7021/Reviewer_nxvi"
        ],
        "content": {
            "summary": {
                "value": "This paper formulates the policy alignment problem in RL (PARL) as a bi-level optimization, where the upper-level optimization corresponds to reward design while the lower-level optimization corresponds to the policy optimization for the designed reward function. Solving the bilevel optimization is challenging, due to the complicatedness of computing the gradient for the upper-level optimization, requiring information about the optimal policy for the given reward function. A practical algorithm is presented with approximations that use K-step policy gradient updates, and sample-based estimation of Jacobian/Hessian. Convergence analysis is provided, achieving the rate of O(1/T). In the experiments, the proposed A-PARL achieves near-oracle performance in a faster time than the baselines."
            },
            "soundness": {
                "value": "4 excellent"
            },
            "presentation": {
                "value": "3 good"
            },
            "contribution": {
                "value": "3 good"
            },
            "strengths": {
                "value": "1. This paper introduces a mathematical framework for policy alignment in RL as a bilevel optimization, which includes useful applications like RLHF.\n2. A theoretical convergence guarantee is provided for the proposed method.\n3. In the experiments, it outperforms the baselines, showing better sample efficiency."
            },
            "weaknesses": {
                "value": "1. Empirical evaluations could have been more thorough. In Figure 2, only three domains were considered (2 manipulation / 1 locomotion), which is much smaller than the ones in the baseline papers. For example, in the PEBBLE/SURF papers, they conducted experiments in 9 domains (6 manipulation / 3 locomotion). I am curious if A-PARL still outperforms the baselines in other domains.\n2. Some part of the algorithm is unclear. For example, it seems that gradient/Jacobian/Hessian estimation (Eq 15-17) requires 'on-policy' samples for their computations. Still, I was first assuming the lower-level policy optimization is done using an off-policy RL algorithm, as in the previous work (e.g. PEBBLE). Then, is my understanding correct that upper-level optimization is done using on-policy samples while the lower-level optimization is done in an off-policy way? Does lower-level optimization also use on-policy updates (Algorithm 1 line 5 seems to perform on-policy updates)? If so, I am curious how the on-policy algorithm could have shown better sample efficiency than the off-policy baselines.\n3. Lack of ablation studies. For example, to see the efficiency of A-PARL more properly, it would be great to see the results using varying the number of feedbacks. In the current form of the paper, it is even unclear how many feedbacks were used or how frequently the feedback was collected in the experiments.\n4. Another concern is the scalability of the algorithm. Given that the method requires Hessians, it seems the complexity of the method is quadratic w.r.t. the number of parameters of the policy network. The method may not be applicable to the setting where the network size is large (e.g. millions of parameters)."
            },
            "questions": {
                "value": "1. Please see the weaknesses section above.\n2. Though it was interesting to see the corrected gradient updates for the upper-level optimization, it was hard to interpret the terms directly. Could you provide some intuitive interpretation of the additional terms in the upper-level gradient ($\\tilde M^K(\\nu_t)$)?\n3. Without the $U_\\nu(\\tau) \\sum \\tilde M^K(\\nu_t) \\nabla_\\theta f_h(\\theta^K(\\nu_t))$ term in Eq (14), does A-PARL reduce to the existing method or not?"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "details_of_ethics_concerns": {
                "value": "N/A"
            },
            "rating": {
                "value": "6: marginally above the acceptance threshold"
            },
            "confidence": {
                "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
            },
            "code_of_conduct": {
                "value": "Yes"
            },
            "first_time_reviewer": {
                "readers": [
                    "ICLR.cc/2024/Conference/Program_Chairs",
                    "ICLR.cc/2024/Conference/Submission7021/Senior_Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission7021/Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission7021/Reviewer_nxvi"
                ]
            }
        },
        "number": 3,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission7021/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1699394481222,
        "cdate": 1699394481222,
        "tmdate": 1700716440990,
        "mdate": 1700716440990,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "binFhWCk2e",
        "forum": "ByR3NdDSZB",
        "replyto": "ByR3NdDSZB",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission7021/Reviewer_fCoY"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission7021/Reviewer_fCoY"
        ],
        "content": {
            "summary": {
                "value": "[This review is submitted upon an emergency review request.]\n\nThe paper introduces PARL (Policy Alignment Reinforcement Learning), a bilevel optimization framework for addressing policy alignment in reinforcement learning. It identifies and aims to fill a gap in existing methods by considering the relationship between policy alignment and data generated from policy trajectories. PARL comprises an upper level focused on reward design and a lower level dedicated to policy optimization. The paper also presents a new algorithm, A-PARL, and reports improved sample efficiency in tests conducted in environments like the DeepMind control suite and MetaWorld."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "2 fair"
            },
            "contribution": {
                "value": "3 good"
            },
            "strengths": {
                "value": "- The paper's approach to formulating preference-based reinforcement learning as a bilevel optimization problem is intuitive and appears well-reasoned. This framework effectively captures the influence of the lower-level policy optimization on the upper-level objective.\n\n- There is a commendable theoretical analysis of the framework and the proposed A-PARL algorithm, which contributes to the understanding of the methodology and its potential impacts."
            },
            "weaknesses": {
                "value": "The paper lacks empirical evidence to substantiate the claim that their method effectively handles the shift in policy distribution at the lower level. While it shows improved final policy return performances, more diagnostic evaluations are needed to conclusively attribute these improvements to the framework's ability to manage lower-level distribution shifts and alignment issues."
            },
            "questions": {
                "value": "- What values of K and N were used in Algorithm 1 for the experiments?\n- Could you elaborate on how these parameters were tuned and the impact of selecting different values?\n- Specifically, how does a larger K value, which implies more accurate solving of the lower problem but at the cost of additional environment trajectories, affect the overall outcomes? What trade-offs are observed with varying K values?"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "8: accept, good paper"
            },
            "confidence": {
                "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        },
        "number": 4,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission7021/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1699621524079,
        "cdate": 1699621524079,
        "tmdate": 1699636823055,
        "mdate": 1699636823055,
        "license": "CC BY 4.0",
        "version": 2
    }
]