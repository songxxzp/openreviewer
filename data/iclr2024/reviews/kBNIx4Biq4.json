[
    {
        "id": "trLKEErw3s",
        "forum": "kBNIx4Biq4",
        "replyto": "kBNIx4Biq4",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission5851/Reviewer_RfcP"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission5851/Reviewer_RfcP"
        ],
        "content": {
            "summary": {
                "value": "- The authors propose a new kind of injective flow (a normalizing flow with lower-dimensional latent space than the data space).\n- Unlike some previous attempts, they use unconstrained encoders and decoders, and introduce a new estimator for the gradient of the change-of-variables term in the log likelihood.\n- The authors also discuss a training issue for injective flows that was previously pointed out by Brehmer & Cranmer (2020).\n- They demonstrate the method by training generative models on tabular data and CelebA, reporting metrics of generative quality like FID."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "3 good"
            },
            "contribution": {
                "value": "2 fair"
            },
            "strengths": {
                "value": "1. The main idea (the new estimator of the gradient) is wonderfully simple, sensible, and efficient.\n2. The paper is clearly structured and well-written."
            },
            "weaknesses": {
                "value": "1. Injective flows are academically interesting, but do not have a very clear use case, especially if they do not have a tractable density (see questions below).\n2. The discussion of joint manifold and likelihood training is not novel (see Brehmer & Cranmer, 2020), which the authors are open about. The proposed solution leaves questions open (see below).\n3. I am not yet convinced by the experimental evaluation. Given the quality of the samples in Figure 1, I am surprised by the claim that the method outperforms various VAE methods (see questions below).\n4. Overall, the paper's contributions are quite thin."
            },
            "questions": {
                "value": "1. What's the main use case for this injective flow? In what situations do you expect benefits from the manifold structure of this generative model compared to, say, diffusion models or VAEs?\n2. Is the density (not its gradient) of the model tractable? That would extend use cases substantially.\n3. I don't understand the \"fix\" of the pathological behaviour pointed out in Sec. 4.2. Could you expand the discussion of why it would work? Is it guaranteed to work? Consider the toy problem that Brehmer & Cranmer (2020) use to illustrate the same problem (Fig 4 in the arXiv version, 2003.13913). Here the encoder $f(x)$ is linear, thus $f'(\\hat{x}) = f'(x)$ , and the \"fix\" does not change anything.\n4. Do you have an explanation for why the problem discussed in Sec. 4.2 does not affect the experiments?\n5. In the experimental evaluation, are the models converged? How do the results change if the models (in particular the baselines) are trained for longer? I find it hard to believe that none of the VAE methods are able to produce higher-quality samples than what we see in Fig. 1."
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "5: marginally below the acceptance threshold"
            },
            "confidence": {
                "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
            },
            "code_of_conduct": {
                "value": "Yes"
            },
            "first_time_reviewer": {
                "readers": [
                    "ICLR.cc/2024/Conference/Program_Chairs",
                    "ICLR.cc/2024/Conference/Submission5851/Senior_Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission5851/Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission5851/Reviewer_RfcP"
                ]
            }
        },
        "number": 1,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission5851/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1697716335259,
        "cdate": 1697716335259,
        "tmdate": 1700487197698,
        "mdate": 1700487197698,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "fCiovfW2EX",
        "forum": "kBNIx4Biq4",
        "replyto": "kBNIx4Biq4",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission5851/Reviewer_SnSS"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission5851/Reviewer_SnSS"
        ],
        "content": {
            "summary": {
                "value": "This papers builds upon rectangular flows, a method for end-to-end training of injective normalizing flows. Three modifications are proposed: (a) not restricting the architecture with normalizing flows, since the reconstruction error encourages injectivity in it of itself, (b) a more efficient gradient estimator, thus addressing a main limitation of rectangular flows, and (c) a further modification to the gradient estimator, which changes the gradient itself and improves numerical stability.\n\nOverall, the paper is well-written and I believe it makes a significant methodological contribution to the area of injective normalizing flows. That being said, I also believe that ablations are missing to properly identify the sources of empirical improvement that the authors observed.\n\n------------------------------------------------------------------------------\n11/22 UPDATE\n------------------------------------------------------------------------------\n\nThe authors have adequately addressed the points I raised in my original review and I am thus increasing my score."
            },
            "soundness": {
                "value": "4 excellent"
            },
            "presentation": {
                "value": "4 excellent"
            },
            "contribution": {
                "value": "3 good"
            },
            "strengths": {
                "value": "This paper has several strengths:\n\n1. It is well written and easy to follow, and I think the authors did a good job of deciding which material to include in the main manuscript and which details to include in the appendix.\n\n2. It is well motivated, as I agree with the authors that the current injective flow literature uses overly restrictive architectures and/or computationally intensive training procedures.\n\n3. The simple observation that, when the encoder $f$ is the left inverse of the decoder $g$, allows to write Jacobians of $g$ as Jacobians of $f$ is elegant, and does result in clear computational gains.\n\n4. Empirical results are good, showing that the proposed method outperforms other injective flows and generative autoencoders."
            },
            "weaknesses": {
                "value": "5. In my view, the main weakness of the paper is the lack of ablations. As mentioned, the paper proposes 3 improvements over rectangular flows, and it is unclear how much each of these contributes to the empirical performance of the proposed method. I think table 1 provides a perfect test bed to carry out these ablations: results using the same architecture as rectangular flows should be added to the table, both (a) using the gradient estimator from eq 10, and (b) that from eq 16. Ideally, using eq 10 (and the same architecture as rectangular flows) would simply show a speed up and the same performance compared to rectangular flows, whereas using eq 16 should improve performance but not match the results of FIF with a fully flexible architecture. I would see this as strong empirical evidence backing up the claims in the paper. I will increase my score if these ablations are included.\n\n6. While the authors include a discussion as why $x$ should be used (eq. 16) instead of $\\hat{x}$ (eq. 10), I think there are several relevant points missing from the discussion: (a) why does the pathological behaviour described by the authors not happen in rectangular flows? Is it because the more restrictive architecture implicitly regularizes the curvature? Or is this actually a hidden issue in rectangular flows as well (the above ablation will obviously also help answer this question)?. (b) Since, when $f$ and $g$ are consistent, $f(x)=f(\\hat{x})$, it seems to me like one can attempt to justify both objectives as attempting to maximize log-likelihood subject to perfect reconstructions. In this view, the problem of using $\\hat{x}$ could be seen as an inappropriate way of enforcing the constraint through a penalty term. Could you further discuss? (c) There is also an additional computational benefit to using $x$ instead of $\\hat{x}$, namely one less forward pass is required through the encoder, which I believe should also be mentioned.\n\nFinally, some minor points:\n\n- In the notation paragraph in sec 3, you write $f^{-1} = g$, which I think should be avoided: when $d<D$, $f$ cannot be an invertible function, since you defined its domain as $\\mathbb{R}^D$ (its restriction to a manifold could of course be injective though, I am not saying there's anything fundamentally wrong here, just nitpicking the notation): I think it'd be better to stick to the language of left inverses.\n\n- Missing period at the end of the injective flows paragraph in sec 3.\n\n- Use \\citep instead of \\citet in the first paragraph of appendix E.3."
            },
            "questions": {
                "value": "7. As you point out in eq 1, injective flows typically have a low-dimensional flow $h$ on the latent space. One could also interpret this architecture as a flexible distribution $p_Z$ on latent space, given by $h$, along with a decoder $w \\circ \\texttt{pad}$; rather than thinking of their composition as the decoder $g$. Throughout the paper you mention making $g$ more expressive, but another interpretation is that you are making $w \\circ \\texttt{pad}$ more expressive, and reducing expressivity on the latent space (instead of a flow, you use a Gaussian or a mixture of Gaussians). Previous research has found benefits of having flexible distributions on latent space (rectangular flows prefer using a flow-based p_Z rather than fixing it as a Gaussian, and other works also recommend using flexible distributions on latent space, e.g. [1, 2]), is there a reason why you do not use more flexible $p_Z$?\n\n[1] Diagnosing and Enhancing VAE Models, Dai & Wipf, ICLR 2019\n\n[2] Diagnosing and Fixing Manifold Overfitting in Deep Generative Models, Loaiza-Ganem et al., 2022"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "8: accept, good paper"
            },
            "confidence": {
                "value": "5: You are absolutely certain about your assessment. You are very familiar with the related work and checked the math/other details carefully."
            },
            "code_of_conduct": {
                "value": "Yes"
            },
            "first_time_reviewer": {
                "readers": [
                    "ICLR.cc/2024/Conference/Program_Chairs",
                    "ICLR.cc/2024/Conference/Submission5851/Senior_Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission5851/Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission5851/Reviewer_SnSS"
                ]
            }
        },
        "number": 2,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission5851/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698683049955,
        "cdate": 1698683049955,
        "tmdate": 1700694400401,
        "mdate": 1700694400401,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "4jsCWlokYT",
        "forum": "kBNIx4Biq4",
        "replyto": "kBNIx4Biq4",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission5851/Reviewer_vmge"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission5851/Reviewer_vmge"
        ],
        "content": {
            "summary": {
                "value": "A new Injective Flow named free-form injective \ufb02ow (FIF) is proposed. FIF is developed based on the rectangular flow (Caterini et al., 2021) and change of variables across dimensions. Different from the rectangular flow, FIF leverages the auto-coding architecture to approximately but efficiently calculate the gradient of maximum likelihood surragate wrt the parameters. The authors also identify pathological behavior in the naive application of maximum likelihood training and propose a fix."
            },
            "soundness": {
                "value": "2 fair"
            },
            "presentation": {
                "value": "2 fair"
            },
            "contribution": {
                "value": "3 good"
            },
            "strengths": {
                "value": "The presented techniques are original, with contributions on removing limitations from prior methods.\n\nThe presented techniques are interesting and potentially valuable."
            },
            "weaknesses": {
                "value": "The clarity should be significantly improved. For example, many important derivations should be moved to the main manuscript, and important assumptions should be highlighted."
            },
            "questions": {
                "value": "Without architectural constraints, how to guarantee that $det [g\u2032(z)^T g\u2032(z)] > 0$?\n\nIn the paragraph before Eq. (12), what are the assumptions underlying $f(\\hat x)=f(x)$? Also, why does Eq. (12) hold true? If $p_{data}(x)=\\hat p_{data}(\\hat x)$, then the right-hand side of Eq. (14) is fixed, right?\n\nAfter adopting the modification in Eq. (16), the final objective in Eq. (18) (or its first two terms) ultimately is not identical to the negative maximum likelihood, right? If so, what are the differences?"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "5: marginally below the acceptance threshold"
            },
            "confidence": {
                "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        },
        "number": 3,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission5851/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698719981410,
        "cdate": 1698719981410,
        "tmdate": 1699636618951,
        "mdate": 1699636618951,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "uwuJeZSPLr",
        "forum": "kBNIx4Biq4",
        "replyto": "kBNIx4Biq4",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission5851/Reviewer_KrZV"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission5851/Reviewer_KrZV"
        ],
        "content": {
            "summary": {
                "value": "This paper proposes a new technique for training flow-based architectures with manifold structure, entitled the \"Free-form Injective Flow\". This technique is derived by loosening the architectural constraints on previously-proposed injective flows; in particular, the proposed autoencoder is completely unconstrained besides using a pre-specified latent dimensionality $d$. Issues with the loss used for previous injective flows are also identified, and this paper derives a novel loss function to address those issues. This loss is computationally tractable while maintaining stability. Experiments are performed to compare with previous injective flow techniques, and other types of autoencoders."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "4 excellent"
            },
            "contribution": {
                "value": "3 good"
            },
            "strengths": {
                "value": "I'll enumerate the strengths below for ease of reference in discussion. These are not listed in order of importance.\n\n1. The paper is generally very well-written and comes up quite polished. I'll outline below:\n    - The introduction is very clean. The motivation for the method is clearly laid out.\n    - The paper is well-situated amongst the related work.\n    - The background is easy to digest.\n    - The path to the final model in Section 4 is laid out well.\n    - The appendix is quite thorough\n2. The autograd / linear-algebra-type derivations were quite well-done. I have personally always appreciated works that don't just blindly apply basic automatic differentiation techniques and instead think deeper about the problem and the requisite gradient estimators.\n3. I like the use of figures. Figure 2 in particular is quite nice for explaining how the technique improves on previous injective flow-based methods. Figure 3 also clearly demonstrates the trade-off between reconstruction and log-likelihood.\n4. I feel well-convinced that this technique is clearly better than previous injective flow techniques, both in terms of representation power and computational tractability."
            },
            "weaknesses": {
                "value": "I'll write weaknesses in a list as well. Again this list is not ordered in terms of importance.\n\n1. In the end, this paper could be summarized as simply training autoencoders with a different training loss, with the loss motivated by previous work in injective flows. The novelty and significance of this particular choice of loss over other types of autoencoder losses is not completely clear for a couple of reasons: (i) Table 3 is not convincing, as the best results are still produced by other autoencoders, and (ii) more modern autoencoder architectures are not compared against. Furthermore, this paper does not necessarily maintain all of the benefits of injective flows - mainly, we do not get exact inverses on the projections to the learned manifold. To summarize, I think *some* degree of discussion is warranted on the benefits of using this approach over other generative autoencoders, as the benefits over other injective flows are comparatively very well-documented here. \n2. This paper is missing a dedicated limitations section. This is partially covered by the conclusion, but not completely, and would show some more perspective from the authors considering the weaknesses laid out here.\n3. In section 5.3, it is suggested that Inception Scores are a reliable measure of diversity, although I don't know if that's actually a modern viewpoint. Furthermore, the Inception Scores generally seem just in-line with other methods, or worse at times. I am also confused about why the best Inception Scores are not bolded in Table 3.\n4. It seems like Section 5.2 and 5.3 are out-of-order on how things are defined. For example, the FID acronym is both cited and defined in 5.3, yet referred to in 5.2. Table 2 also requires more of a description -- including what \"IS\" is, and what the two samplers are -- some of which is contained within the caption of Table 3. I would just suggest making the requisite definitions in Section 5.2 first and then using acronyms or reduced descriptions in Section 5.3 as appropriate.\n5. It is discussed twice that traces are performed in the order $f' g'$, and that details are in the Appendix -- however, there is certainly space in the paper to provide a bit more discussion on that. \n6. The paragraph on Page 6 starting with \"Unfortunately\" is not sufficiently convincing: I don't think Fig 2 proves that reconstruction error is insufficient, as you could imagine that reconstruction becomes increasingly more difficult if the entropy becomes negative infinity which should therefore regularize the solution on the left to some extent so that it does not fall on the degenerate, negative-infinite entropy solution.\n7. It is suggested that rectangular flows require $O(d)$ `vjp`s / `jvp`s for convergence, but practically conjugate gradient has exponential convergence and thus much fewer iterations suffice.\n8. It is stated that the surrogate loss is only accurate if $f$ and $g$ are optimal with respect to reconstruction, and then assumed that this is indeed fulfilled by optimizing the reconstruction loss and by the fact that training is stable. However, I don't think this is fully proven:\n    - The reconstruction error is not checked in the paper\n    - One of the other changes to the loss function may be responsible for the training stability\n    - Trade-offs between optimizing the reconstruction error and reconstruction the likelihood contribution may prevent the reconstruction loss from being fully optimized (cf. Figure 3)\n9. There are no samples provided for the generative methods, which suggests that the generation quality may not actually be that good. FID has recently come under more scrutiny as an evaluation metric and so supporting the FID numbers with actual generated samples would be useful."
            },
            "questions": {
                "value": "1. Why is the training time speedup inconsistent in Table 1? It doesn't seem to scale with dimension in any predictable way.\n2. What is the definition of entropy as in e.g. (13) for a distribution that is supported on a manifold?\n\n**POST-REBUTTAL**\n\nI'll be upgrading my score after discussion with the authors."
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "8: accept, good paper"
            },
            "confidence": {
                "value": "5: You are absolutely certain about your assessment. You are very familiar with the related work and checked the math/other details carefully."
            },
            "code_of_conduct": {
                "value": "Yes"
            },
            "first_time_reviewer": {
                "readers": [
                    "ICLR.cc/2024/Conference/Program_Chairs",
                    "ICLR.cc/2024/Conference/Submission5851/Senior_Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission5851/Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission5851/Reviewer_KrZV"
                ]
            }
        },
        "number": 4,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission5851/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698787262483,
        "cdate": 1698787262483,
        "tmdate": 1700699830761,
        "mdate": 1700699830761,
        "license": "CC BY 4.0",
        "version": 2
    }
]