[
    {
        "id": "3pMZiZ53K0",
        "forum": "86w3LbTNI1",
        "replyto": "86w3LbTNI1",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission2096/Reviewer_jdVB"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission2096/Reviewer_jdVB"
        ],
        "content": {
            "summary": {
                "value": "This paper considers regularizing the learned policy with a safe policy to deal with the reward hacking issue. Instead of constraining the learned policy to the safe policy via minimizing the KL divergence of their action distribution, as existing methods do, authors propose regularizing based on occupancy measure (OM). Theoretical and empirical results show that OM regularization more effectively prevents reward hacking while allowing for performance improvement on top of the safe policy."
            },
            "soundness": {
                "value": "2 fair"
            },
            "presentation": {
                "value": "2 fair"
            },
            "contribution": {
                "value": "2 fair"
            },
            "strengths": {
                "value": "1. This paper is well written and easy to follow.\n2. Preventing reward hacking is an important and interesting topic for RL."
            },
            "weaknesses": {
                "value": "1. The authors claimed that there are no direct relationships hold for the returns of two policies under any reward and their action distribution divergence. However, Theorem 1 of [1] shows that we can indeed bound the returns of two policies by their action distribution, which from my perspective, just verifies the effectiveness of KL divergence minimization. And I highly recommend authors to thoroughly read [1], which already theoretically and empirically illustrates OM regularization is better than action distribution regularization.\n2. Regularizing the learned policy by OM divergence is not a novel idea, and has already been explored in RL, such as [2].\n\n[1] Xu T, Li Z, Yu Y. Error bounds of imitating policies and environments. Advances in Neural Information Processing Systems, 2020, 33: 15737-15749.\n\n[2] Kang B, Jie Z, Feng J. Policy optimization with demonstrations. International conference on machine learning. PMLR, 2018: 2469-2478."
            },
            "questions": {
                "value": "1. Why would the occupancy measure KL suddenly increases when $\\lambda$ increases (Figure 3)? If I am not wrong, as $\\lambda$ increases, we focus more on minimizing the OM divergence of the learned policy and the safe policy, so the occupancy measure KL should decrease?\n2. What do you mean by \"safe\" policy? I can not find a formal definition of it. Is it the policy that never visits some unsafe state-action pairs? Then some safe-RL or constrained RL methods should also be compared.\n3. Is proposition 3.1 just to conculde that the parameter $\\lambda$ is hard to tune if we use action distribution regularization? But in your proposed OM regularization, we need to adversarially train a discriminator, which has been claimed (e.g., [1]) to be unstable and sensitive to hyper-parameters, especially in high-dimensional domains.\n4. During training, do we need to roll out the safe policy? If so, OM regularization may need more environment interactions than action distribution regularization.\n\n[1] Becker E, Pandit P, Rangan S, et al. Instability and local minima in GAN training with kernel discriminators. Advances in Neural Information Processing Systems, 2022, 35: 20300-20312."
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "3: reject, not good enough"
            },
            "confidence": {
                "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
            },
            "code_of_conduct": {
                "value": "Yes"
            },
            "first_time_reviewer": {
                "value": "Yes",
                "readers": [
                    "ICLR.cc/2024/Conference/Program_Chairs",
                    "ICLR.cc/2024/Conference/Submission2096/Senior_Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission2096/Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission2096/Reviewer_jdVB"
                ]
            }
        },
        "number": 1,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission2096/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698127714208,
        "cdate": 1698127714208,
        "tmdate": 1699636142034,
        "mdate": 1699636142034,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "rinPY6Doa1",
        "forum": "86w3LbTNI1",
        "replyto": "86w3LbTNI1",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission2096/Reviewer_y14X"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission2096/Reviewer_y14X"
        ],
        "content": {
            "summary": {
                "value": "- The authors defined reward hacking as a problem where an AI agent seems to do well based on a chosen reward function but actually performs poorly according to the actual desired reward. \n- Previous solutions have tried to align the proxy reward function with the true reward by matching action distributions using measures like KL divergence, but this can be risky because even a small change in actions at one state can lead to very different state occupancies. \n- Authors propose a new approach called ORPO, which regularizes state occupancy measure instead of action distribution, which is more effective in preventing reward hacking while still allowing for performance improvement beyond a safe policy. \n- The authors show a theoretical connection between the returns of two policies and their OM divergence, which doesn't exist for action distribution divergence."
            },
            "soundness": {
                "value": "2 fair"
            },
            "presentation": {
                "value": "3 good"
            },
            "contribution": {
                "value": "1 poor"
            },
            "strengths": {
                "value": "- The paper is easy to follow and well presented\n- Discusses interesting topic of reward hacking, which the authors clearly defined as the \"reward mismatch\". Previously the reward hacking  problem was somewhat vague.\n- Proposition 3.1 shows a nice differentiation between action dist. regul. and om regul.\n- experiment shows the superiority of proposed method against action regularization"
            },
            "weaknesses": {
                "value": "- While the paper discusses with a new problem formulation on reward hacking, the problem definition itself does not seem to be very different from what offline RL algorithms do, which assume a transition/reward function mismatch and learns a robust policy for underlying true transition/reward function. The potential differences could be, e.g. surrogate reward function can be largely different, or transition function stays exact, etc. However, the authors do not make much difference in designing their algorithm, and I could not find much difference in proposed OM algorithm and other offline RL algorithms out there.\n- In that sense, there are a number of occupancy matching algorithms (algaeDICE, OptiDICE, ...) for offline RL, and I believe that it should have been shown how the proposed OM algorithm is different to those and why it is better suited in this case."
            },
            "questions": {
                "value": "- In offline RL, having KL-divergence regularization usually results in an over-regularization, since we could have more flexible learned policy by having other divergences that matches support only. Is there any specific reason why KL divergence is chosen in this paper? The similar mathematical results should be able to be derived using many other divergences."
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "5: marginally below the acceptance threshold"
            },
            "confidence": {
                "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        },
        "number": 2,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission2096/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698807651377,
        "cdate": 1698807651377,
        "tmdate": 1699636141963,
        "mdate": 1699636141963,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "V9t7HDeGaw",
        "forum": "86w3LbTNI1",
        "replyto": "86w3LbTNI1",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission2096/Reviewer_Jr8S"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission2096/Reviewer_Jr8S"
        ],
        "content": {
            "summary": {
                "value": "The authors present an alternative method for regularization to a safe policy, via occupancy measure rather than KL divergence of action distribution. The paper explains that action distribution KL divergence is a bad measure of policy difference with respect to reward hacking and resulting behavior because small changes in the action distribution can result in drastically different behavior and vice versa (large differences in action distribution may not matter). State-action (or sometimes state only) occupancy measure is justified as a good measure of alignment between policies both theoretically and empirically. The authors prove that the occupancy measure total variation distance tightly bounds the returns between the policies. They then provide intuition in a small environment and show the difference between action distribution and occupancy measure when comparing the desired policy, a safe policy, and a reward hacking policy. They introduce a PPO-based algorithm to achieve this regularization. Crucially, it is intractable to compute the ground truth TV distance so it* is estimated with a discriminator akin to the one used in GAIL. *Actually they use KL divergence rather than TV distance in practice because it is more stable to compute in practice, and they cite theoretical justification for this trick. Empirical results are shown in a small gridworld, Flow, and a glucose monitoring environment."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "4 excellent"
            },
            "contribution": {
                "value": "2 fair"
            },
            "strengths": {
                "value": "The idea of regularizing to a safe policy via occupancy measure rather than KL divergence over action distribution is novel. (Although I am somewhat surprised this is the case! I was aware of safe policy regularization as a way to reduce reward hacking, but not familiar with the specific methods, so I'm surprised to learn this.)\n\nThe theoretical results appear strong and sound; a tight bound is given relating changes in TV distance of occupancy measure to changes in the true reward. Theoretical justification is provided for why KL divergence is used in practice rather than TV distance, supporting an empirical finding that it is more stable. Furthermore, a theoretical result from Huszar (2017) is cited to connect a proof relating the scores of a GAN discriminator of safe vs learned policy to the KL divergence between occupancy measure. This keen application of discriminators is used to give a tractable algorithm for occupancy measure regularization. \n\nA very simple MDP is provided to give intuition for why action distribution is not a good measure to regularize for. \n\nThe gridworld environment provides a clear illustration of the benefits of occupancy measure vs action distribution regularization. Experiments in more complex environments (flow and simglucose) are provided.\n\nThe paper is written very clearly and it was easy to follow with minimal effort."
            },
            "weaknesses": {
                "value": "Overall the paper is strong theoretically and empirically and convinces me of a real issue with the action distribution regularization SOTA. While alignment is important and this work demonstrates a better way to regularize to a safe policy, the novelty is primarily in a detail of that regularization, and I'm surprised people hadn't considered other metrics to regularize besides action distribution KL divergence. \n\nThe authors do not address the question of whether occupancy measure regularization is stable / will converge, which is a crucial consideration of the method. I'd like to see some discussion on that both theoretically and empirically. The authors don't show the training curves either (performance over time) so I'm unable to assess convergence. \n\nI'd also like to see some discussion of what sort of environments the authors expect the method to do well in, extrapolating from the experiments. I.e. is this *the* solution to reward hacking or should it be used in conjunction with other methods, and is it effective anywhere or only in environments with particular properties?"
            },
            "questions": {
                "value": "- Why do you choose TV distance in (3) in the first place? is it because it makes the theory resulting in the tight bound nice? \n- Can you provide intuition for why the Huszar (2017) result applies to KL divergence rather than TV distance?\n- Can you provide empirical comparison of KL div and TV dist occupancy measure regularization?\n- How many trials were run? Can you provide error bars for the graphs and ranges for the table?\n- Can you analyze the computation complexity (theoretical and empirical)? I guess it shouldn't be too new since it's application of an existing discriminator method.\n- In figure 3: how come at the very right end of the plots (high lambda) the occupancy measure KL div increases at the end for glucose? why is performance so poor in traffic and glucose for low lambda? is it due to reward hacking or poor policy optimization? can you plot training reward in addition to what I'm assuming is test/true reward to demonstrate reward hacking?"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "6: marginally above the acceptance threshold"
            },
            "confidence": {
                "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
            },
            "code_of_conduct": {
                "value": "Yes"
            },
            "first_time_reviewer": {
                "value": "Yes",
                "readers": [
                    "ICLR.cc/2024/Conference/Program_Chairs",
                    "ICLR.cc/2024/Conference/Submission2096/Senior_Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission2096/Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission2096/Reviewer_Jr8S"
                ]
            }
        },
        "number": 3,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission2096/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698818431315,
        "cdate": 1698818431315,
        "tmdate": 1699636141897,
        "mdate": 1699636141897,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "jvtJPXG70e",
        "forum": "86w3LbTNI1",
        "replyto": "86w3LbTNI1",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission2096/Reviewer_M4hZ"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission2096/Reviewer_M4hZ"
        ],
        "content": {
            "summary": {
                "value": "This paper considers the problem of reward hacking in reinforcement learning (RL), where an RL is trained to optimize a proxy reward that can lead to suboptimal performance on the true reward. Given a safe policy, $\\pi_{safe}$, that performs adequately with respect to the true reward, a common approach in the literature is to train a policy, $\\pi$, to optimize the proxy reward while trying to ensure that the KL-divergence $D_{KL}(\\pi(\\cdot | s) \\ || \\ \\pi_{safe}(\\cdot | s))$ , or *action distribution divergence*, is small at each $s$. The paper provides examples illustrating the drawbacks of this approach and proposes regularizing using divergences between state(-action) occupancy measures, instead. The primary contributions are:\n1) theoretical results that (a) illustrate when action distribution divergence regularization fails, and (b) draw connections between suboptimality due to reward hacking and occupancy measure divergence regularization;\n2) a practical method for performing occupancy measure divergence-regularized policy optimization;\n3) experimental results illustrating benefits of the proposed approach on three environments."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "3 good"
            },
            "contribution": {
                "value": "2 fair"
            },
            "strengths": {
                "value": "The paper proposes an interesting way to deal with reward hacking that is likely of interest to the community. This is based on the useful insight that, in problems where the state space has a clear geometric interpretation or where rewards are purely state-dependent, encouraging the policies trained to remain within a \"safe\" region prescribed by an existing policy can help prevent reward hacking in the case where the proxy reward differs greatly from the true reward outside that safe region. The overall motivation is very clear and convincing, and the illustrative examples presented (the car example in the intro, two-state example in Fig. 1, and gridworld environment pictured in Fig. 2) are effective. The proposed ORPO algorithm is interesting, and the experiments support its effectiveness on three environments."
            },
            "weaknesses": {
                "value": "Though the key idea and motivation of the paper is nice, there are important weaknesses, including:\n1. The paper claims Proposition 3.2 (page 5) as a primary theoretical contribution, yet its proof in the appendix is not novel: the supporting Prop. A.1 is standard in MDP theory, as the RHS is the objective of the dual LP formulation for solving an MDP; the remaining bound is trivial (it is also previously known -- see its use in, e.g., the proof of Theorem 1 in [Qu et al., *Scalable multi-agent reinforcement learning for networked systems with average reward*, NeurIPS 2020]). This undermines the theoretical contribution of the paper.\n2. The idea of using state(-action) occupancy measure divergence to address reward hacking does appear to be novel, yet using it as part of an RL objective has been fairly extensively studied -- see, e.g., [Hazan et al. *Provably efficient maximum entropy exploration*, ICML 2019], [Lee et al., *Efficient exploration via state marginal matching*, arXiv 2019], [Liu & Abbeel, *Behavior from the void: unsupervised active pre-training*, NeurIPS 2021]. It would be helpful to see the proposed method put in context of these and related works to more clearly highlight its novelty and the paper's methodological contribution.\n3. The experiments are not as extensive as one could hope. It is noted in the appendix that three replications are performed for each method, but only the median rewards are reported -- without error bars (and ideally more replications), it is tough to assess the statistical significance of the results reported in Table 1 and Fig. 3. In addition, though hyperparameters are reported, it is unclear how they were selected to ensure a fair comparison between all methods. In light of issue 1, it would be helpful to have more thorough experimentation to address 3."
            },
            "questions": {
                "value": "Specific questions:\n* how significant are the examples constructed in Prop. 3.1? these seem to require some work in the appendix -- do you view Prop. 3.1 as a significant contribution on its own?\n* what are the variance/confidence intervals for the values reported in Table 1? what about Fig. 3?\n* the true reward plots in Fig. 3 are a little confusing -- how should we interpret them?\n* why are some of the KL plots truncated in the Tomato experiment in Fig. 3?"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "6: marginally above the acceptance threshold"
            },
            "confidence": {
                "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
            },
            "code_of_conduct": {
                "value": "Yes"
            },
            "first_time_reviewer": {
                "value": "Yes",
                "readers": [
                    "ICLR.cc/2024/Conference/Program_Chairs",
                    "ICLR.cc/2024/Conference/Submission2096/Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission2096/Reviewer_M4hZ",
                    "ICLR.cc/2024/Conference/Submission2096/Senior_Area_Chairs"
                ]
            }
        },
        "number": 4,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission2096/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698885527734,
        "cdate": 1698885527734,
        "tmdate": 1700721661443,
        "mdate": 1700721661443,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "cX6b3lN382",
        "forum": "86w3LbTNI1",
        "replyto": "86w3LbTNI1",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission2096/Reviewer_rjUA"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission2096/Reviewer_rjUA"
        ],
        "content": {
            "summary": {
                "value": "This paper proposes a new method for preventing reward hacking in reinforcement learning. It highlights the limitations of the commonly used KL divergence between action distributions for regularization and proposes occupancy measure (OM) as a more effective alternative. Specifically, the paper identifies the limitations of action distribution based regularization where the authors show how small changes in action distribution can lead to significantly different outcomes, potentially causing calamitous results. Moreover, the paper introduces occupancy measure-based regularization: occupancy measure captures the proportion of time an agent spends in each state-action pair, which provides a more comprehensive picture of the policy's behavior. Furthermore, the paper provides theoretical justification of the approach via proving a direct relationship between the returns of two policies under any reward function and their OM divergence, demonstrating the effectiveness of OM for reward hacking prevention. Finally, the paper demonstrates through experiments that OM regularization outperforms action distribution-based methods in preventing reward hacking while allowing for performance improvements.\nThis work suggests that OM regularization is a promising technique for safe and effective reinforcement learning, offering advantages over traditional action distribution-based methods in mitigating reward hacking."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "3 good"
            },
            "contribution": {
                "value": "2 fair"
            },
            "strengths": {
                "value": "The paper presents a reasonable approach that mitigates reward hacking via occupancy measure matching in a way that is easy to follow and understand. Moreover, the paper shows a simple toy example to demonstrate the importance of using occupancy measure matching instead of action distribution matching, which makes it clear for readers to understand.\n\nThe paper also shows theoretical justifications of why using KL divergence between safe policy and learned policy might not be ideal for mitigating reward hacking and why occupancy measure matching is better, which makes the paper more principle.\n\nFinally, the authors provide empirical results that aligns with the theoretical finding and strengthen the paper a lot."
            },
            "weaknesses": {
                "value": "1. While the idea of the paper is neat, it is not super novel as similar ideas have been explored in previous works such as GAIL and [1]. It is unclear if the theoretical finding in the paper is fully new as it has been known in the literature that KL divergence as the action distribution regularization may not be ideal and occupancy measure matching can capture the total return variation more accurately [2].\n\n2. Moreover, the empirical results in the paper are less realistic. The experiments are all in simulated environment with not very complex control space. It would add more value if the authors can perform experiments in more complicated settings such as continuous-control settings like robotic manipulation/locomotion or large language models alignment setting that require RLHF.\n\n[1] Ma, Yecheng Jason, Kausik Sivakumar, Osbert Bastani, and Dinesh Jayaraman. \"Policy Aware Model Learning via Transition Occupancy Matching.\" In Deep Reinforcement Learning Workshop NeurIPS 2022. 2022.\n\n[2] Wu, Yueh-Hua, Ting-Han Fan, Peter J. Ramadge, and Hao Su. \"Model imitation for model-based reinforcement learning.\" arXiv preprint arXiv:1909.11821 (2019)."
            },
            "questions": {
                "value": "1. Please clarify the novelty of the paper.\n2. Please justify the new findings in the theoretical analysis that differs from previous works.\n3. Perform more realistic tasks such as LLM RLHF tasks and complex robotic manipulation/locomotion."
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "5: marginally below the acceptance threshold"
            },
            "confidence": {
                "value": "2: You are willing to defend your assessment, but it is quite likely that you did not understand the central parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        },
        "number": 5,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission2096/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1699224244528,
        "cdate": 1699224244528,
        "tmdate": 1699636141766,
        "mdate": 1699636141766,
        "license": "CC BY 4.0",
        "version": 2
    }
]