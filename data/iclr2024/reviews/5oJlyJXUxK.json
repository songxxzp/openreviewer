[
    {
        "id": "XEgvCMYWcc",
        "forum": "5oJlyJXUxK",
        "replyto": "5oJlyJXUxK",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission5402/Reviewer_Emzi"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission5402/Reviewer_Emzi"
        ],
        "content": {
            "summary": {
                "value": "This paper proposes a method to make conceptual interventions by modifying the activations of a pre-trained black-box model. Based on the popular counterfactual optimization approach by Wachter et al [1] for pixel-based counterfactuals, they propose to instead optimize for activations. That is, they apply the distance loss in the activation instead of pixel space and use the gradients obtained by an additionally trained concept detector ((non)-linear probe) instead of the gradients of the classifier (c.f., Eq. 1). Finally, the authors propose a fine-tuning scheme to make the classifier more reliant on the \u201cconcept activation vectors\u201d based on a proposed notion of intervenability (Eq. 2 & 3), while keeping the feature extractor frozen. Through experiments on tabular and vision data the authors show the efficacy of their intervention as well as fine-tuning scheme.\n\n[1] Wachter, Sandra, et al. \"Counterfactual explanations without opening the black box: Automated decisions and the GDPR.\" Harv. JL & Tech. 31 2017: 841."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "2 fair"
            },
            "contribution": {
                "value": "2 fair"
            },
            "strengths": {
                "value": "* The work addresses an interesting problem to better understand the behavior of models through conceptual interventions.\n* The intervention strategy is simple yet effective.\n* The fine-tuning scheme is well-designed and yet simple.\n* Code is provided via an anonymized repository and supplementary material."
            },
            "weaknesses": {
                "value": "* The work seems to have missed the most relevant work on conceptual (interventional) counterfactuals, e.g., [1,2]. While there are some technical differences (usage of the gradients stemming from the linear probe instead of the classifier in the counterfactual optimization problem), there is still significant overlap. For example, Abid et al. [1] also use linear probes to identify concept activation vectors and use it to intervene on the features.\n\n* The work motivates their approach by stating that \u201cconcept labels are not required [during training]\u201d (p. 2). While true, it is still required for the fine-tuning (as we need to train the probes initially; Sec. 3.3, and shown to be important in the experiments), which one could also see as part of model development. For the case that we would like to make the same conceptual interventions as for CBMs, this would result in a similar amount of annotation cost.\n\n* The paper makes the (implicit) assumption that the feature extractor $h_{\\phi}$ learns the concept; both in their intervention approach and fine-tuning (since $\\beta$ is set to 1). However, the authors provide no evidence that this is actually the case. The linear probes could just learn to predict from some correlated concept/feature. Further evidence would be required that the black-box feature extractor has actually learned the concept that is intervened on.\n\n* It is very unclear whether the intervention strategy actually results in *plausible* and not just *adversarial* changes of the activations. This is a prominent problem for pixel-spaced counterfactuals methods, where, e.g., different types of regularization or generative models are used to obtain plausible counterfactuals.\n\n* There are no comparisons to prior work that converted pretrained models into CBMs [3,4]. It would be interesting to show how the proposed method compares to them (using the proposed intervention strategy).\n\n[1] Abid, Abubakar et al. \"Meaningfully explaining model mistakes using conceptual counterfactuals.\" ICML 2022.\n\n[2] Kim, Siwon, et al. \"Grounding Counterfactual Explanation of Image Classifiers to Textual Concept Space.\" CVPR 2023.\n\n[3] Yuksekgonul, Mert et al. \"Post-hoc concept bottleneck models.\" ICLR 2023.\n\n[4] Oikarinen, Tuomas, et al. \"Label-Free Concept Bottleneck Models.\" ICLR 2023."
            },
            "questions": {
                "value": "* Why does Eq. 2 & 3 assume that c\u2019 does not change y to y\u2019? As is, it assumes that the concept does not change the class. Let\u2019s say the concept c\u2019 changes the fur texture of a cat, then the resulting class may also change. This seems not to be included in the current notion of intervenability and may be easily obtained by a suitable choice of the distribution $\\pi(c\u2019,y\u2019|x,\\hat{c},c,\\hat{y},y)$, which subsumes $\\pi(c\u2019|x,\\hat{c},c,\\hat{y},y)$ when $y\u2019=y$.\n\n* Why is the ResNet-18 architecture used with four fully-connected layers instead of the standard setting? Why are not just the bottleneck features used?\n\n* What happens for the baseline (fine-tuned, MT) if we interleave intervened activations $z\u2019$ also during training? As is, it just may be that (fine-tuned, I) is more robust to the interventions.\n\n* Are AUROC and AUPR computed for the concepts or targets/classes? This may also change for the different experimental results (e.g., for the figures in the main paper this is unclear). Could the authors clarify this?\n\n## Suggestions\n\n* It\u2019d have been good to discuss the data-generating mechanisms (bottleneck, confounder, incomplete) in the main text and not only supplemental.\n\n* Given the overlapping confidence bands in Fig. 3(c) it would be good to either run more simulations or reformulate the sentence since it is unclear if \u201cblack-box classifiers are expectedly superior to the CBM\u201d."
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "5: marginally below the acceptance threshold"
            },
            "confidence": {
                "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
            },
            "code_of_conduct": {
                "value": "Yes"
            },
            "first_time_reviewer": {
                "value": "Yes",
                "readers": [
                    "ICLR.cc/2024/Conference/Program_Chairs",
                    "ICLR.cc/2024/Conference/Submission5402/Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission5402/Reviewer_Emzi",
                    "ICLR.cc/2024/Conference/Submission5402/Senior_Area_Chairs"
                ]
            }
        },
        "number": 1,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission5402/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1697982196422,
        "cdate": 1697982196422,
        "tmdate": 1700647330252,
        "mdate": 1700647330252,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "JuwhnKjY00",
        "forum": "5oJlyJXUxK",
        "replyto": "5oJlyJXUxK",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission5402/Reviewer_icNv"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission5402/Reviewer_icNv"
        ],
        "content": {
            "summary": {
                "value": "The authors introduce a method to perform concept-based interventions on pre-trained neural networks. They then formalize intervenability as a metric to measure concept-based interventions. Finally, they show that finetuning probes for intervenability can improve intervenability."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "3 good"
            },
            "contribution": {
                "value": "3 good"
            },
            "strengths": {
                "value": "- The paper's proposed metric of intervenability is interesting and helps practically measure the utility of methods such as CBMs\n- The introduced methods are clear and intuitive\n- Strong comparisons are made to baselines from previous work"
            },
            "weaknesses": {
                "value": "- Limited improvements over CBMs -- In most settings, CBMs seem to outperform the proposed Fine-tuned, I method while providing much greater interpretability (the main exception is in Fig 5)\n- Potential missing baseline: I am not sure if a simple convex combination of the predictions of the CBM and the black-box would outperform the proposed model"
            },
            "questions": {
                "value": "- Note: would be nice for the paper to mention the link between intervenability and concept/feature importance - this should be straightforward based on interventions, as this is how many feature importance metrics (e.g. LIME/SHAP) are computed\n- Would be nice to describe the experimental setup in more detail, e.g. the three synthetic scenarios are only described in previous work\n- Minor: fig legends in Fig 4 are slightly difficult to read."
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "8: accept, good paper"
            },
            "confidence": {
                "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
            },
            "code_of_conduct": {
                "value": "Yes"
            },
            "first_time_reviewer": {
                "readers": [
                    "ICLR.cc/2024/Conference/Program_Chairs",
                    "ICLR.cc/2024/Conference/Submission5402/Senior_Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission5402/Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission5402/Reviewer_icNv"
                ]
            }
        },
        "number": 2,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission5402/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698249645489,
        "cdate": 1698249645489,
        "tmdate": 1700591602625,
        "mdate": 1700591602625,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "4aiLRNX3sR",
        "forum": "5oJlyJXUxK",
        "replyto": "5oJlyJXUxK",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission5402/Reviewer_39mA"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission5402/Reviewer_39mA"
        ],
        "content": {
            "summary": {
                "value": "- The paper proposes interventions on black-box models in CBM style.\n\n\n- Given a black-box model:\n     -  Train a probing network to extract concepts from an intermediate representation $z$\n     -  Now that they have the probing network for a given sample $x$ they can extract $z$ and concepts $c$, given the ground-truth concepts $c'$ they learn a new embedding $z'$ that should produce concepts $c'$ when given to probing network.\n     -  For interventions they replace the original $z$ with new $z'$\n\n- Given $z$ how do we calculate $z'$? (from the text is a bit unclear I had to look at the code to understand how this is done so please correct me if I am wrong)\n     -    Start from $z'==z$ but $z'$ is differentiable.\n     -    The probing network is frozen where you calculate concepts $q_\\xi(z')$\n     -    Update $z'$ based on the loss in equation 1 you repeat multiple times i.e for a few epochs.\n\n\n- The paper quantifies the effectiveness of interventions as the gap between the regular prediction loss and the loss attained after the intervention.\n- The paper proposes a fine-tuning strategy for intervention that can be summarized as follows:\n     -    Given a black-box model $f_\\theta$, we will look at the network as if its a cbm model such that we first have a network $h_\\phi(x)=z$ that gives us the intermediate representation used to train the probing network and $g_\\psi(z)=y$ that gives the final prediction.\n     -    The black box network is now trained end to end using loss in equation 4: the first term is regular black-box optimization the second term is optimizing the outer network subjected to the intervention and all of this is in addition to optimizing $z'$  as mentioned previously.\n     -    Equation 4 is then simplified to avoid trilevel optimizing the first loss is ignored so the feature extractor layer is basically frozen.\n-  Experiments:\n    -    The paper one synthetic tabular dataset, 3 image datasets.\n    -    The paper tested the proposed fine-tuning approach against a black-box NN a CBM and two other different fine-tuning approaches."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "3 good"
            },
            "contribution": {
                "value": "4 excellent"
            },
            "strengths": {
                "value": "Strength:\n- Originality: The paper is original, there has been work around post-hoc CBM (cited by the paper) but this intervention strategy is novel and very interesting.\n- Quality: The paper is evaluated against a reasonable baseline on multiple datasets.\n- Significance: The paper's contribution is significant, if we can intervene on model in test time we can get higher accuracy as shown on multiple datasets."
            },
            "weaknesses": {
                "value": "Method weakness:\n- There is no guarantee that a network has learned the desired concepts, i.e. there is a big probability that the probing network can not learn a concept you would want to intervene on.\n- The method is quite expensive optimizing to get the $z'$ and optimizing for fine-tuning on top of $z'$ can be quite costly.\n- Creating a probing network per concept can be costly when we have a large number of concepts, it is not clear if this can scale to hundreds or thousands of concepts.\n- It is not clear which concepts one should intervene on.\n- What if we can never intervene during test time (say we don't have ground-truth concepts or even ground-truth label at that point) it is unclear how this can be useful in that case.\n\n\nPaper quality:\n- How you get $z'$ and the intervening strategy is not very clear in the main paper I would strongly recommend moving Algorithm A.1 to the main text for clarity."
            },
            "questions": {
                "value": "- Which layer do you do probing on is it the last layer before the classifier?\n- Usually how many iterations do you need to extract a reasonable $z'$.\n- In the experiments, the accuracy on the test set is \"with\" interventions correct?\n- How do you select the concepts to intervene on?\n- How would this model be used practically? (I am assuming something similar to the following steps):\n   \n\n    - You have an example that is incorrect\n    - You calculate the concepts that affect that example.\n   - You show the concepts to a domain expert, and they propose different concepts.\n   - You calculate $z'$ using this new concept and make a new prediction.\n\nIf so how is the original model improved it?"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "8: accept, good paper"
            },
            "confidence": {
                "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        },
        "number": 3,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission5402/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698528126488,
        "cdate": 1698528126488,
        "tmdate": 1699636547263,
        "mdate": 1699636547263,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "EQZgTuE1kn",
        "forum": "5oJlyJXUxK",
        "replyto": "5oJlyJXUxK",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission5402/Reviewer_JHNX"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission5402/Reviewer_JHNX"
        ],
        "content": {
            "summary": {
                "value": "This paper presents a way to do concept interventions on standard neural networks without the need for a Concept Bottleneck Model. This can be done by learning classifiers to predict the presence of a concept based on the hidden layer representation, and then optimizing to find representation that is as close as possible to original but changes the concept classifier prediction. They also propose to improve the effectiveness of interventions by finetuning the model to get better results under intervention."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "3 good"
            },
            "contribution": {
                "value": "2 fair"
            },
            "strengths": {
                "value": "Clearly written. Interesting perspective highlighting that intervention could be useful even on standard networks."
            },
            "weaknesses": {
                "value": "I don't really see any use cases where we would want to intervene on standard models instead of just creating a CBM. \n- Intervention performance on models that weren't finetuned is quite poor, and still requires labeled concept data to learn the classifiers.\n- The performance of models (even finetuned) is worse than CBM on most datasets, while both require additional training and the same kind of data with dense concept labels, most cases it would be better to just learn a CBM\n- Intervening now requires solving an optimization problem making it more costly and harder to understand than original CBM interventions\n- CBMs have many interpretability benefits in addition to intervene-ability, which we lose when using standard architecture, such as predictions being simple functions of interpretable concepts. \n\nLacking evaluation:\n- I think improved performance on CheXpert is likely caused by the fact that the model can use information outside of concepts to make the prediction. This is similar to having residual as is done by Posthoc-CBM-h, and I think some comparison agaisnt that would be needed.\n- Choice of datasets is a little odd, should use at least some of the datasets original CBM was trained on such as CUB"
            },
            "questions": {
                "value": "Looks like each intervention requires running gradient descent to minimize eq. 1, what is the computational cost of this? \nHow did you intervene on multiple concepts at once?"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "5: marginally below the acceptance threshold"
            },
            "confidence": {
                "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        },
        "number": 4,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission5402/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698817964801,
        "cdate": 1698817964801,
        "tmdate": 1699636547156,
        "mdate": 1699636547156,
        "license": "CC BY 4.0",
        "version": 2
    }
]