[
    {
        "id": "lM1JxrZ8RJ",
        "forum": "k2lkeCCfRK",
        "replyto": "k2lkeCCfRK",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission6741/Reviewer_cxrP"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission6741/Reviewer_cxrP"
        ],
        "content": {
            "summary": {
                "value": "This paper derives a connection between generative flow networks (GFlowNets) and policy gradient methods. An equivalence of gradients between GFlowNet objectives and gradients of variational objective is (re)derived, and from this emerges an equivalence with a reinforcement learning problem that can be solved using policy-based RL methods such as TRPO. Experiments are performed on three amortized sampling problems from past work and the algorithm is claimed to deliver improved samplers on two of them."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "2 fair"
            },
            "contribution": {
                "value": "2 fair"
            },
            "strengths": {
                "value": "- The connection between GFlowNets and policy-based RL is stated for the first time, which can be valuable if it can produce improved training algorithms for GFlowNets.\n- New result extending the SubTB gradient analysis from [Malkin et al., 2022b] to state flows.\n- Experiments on diverse problems, representing a nontrivial engineering effort by the authors."
            },
            "weaknesses": {
                "value": "- There are many instances of unclear and incorrect mathematical language and notation in section 2 and 3.\n  - Section 2.1:\n    - \"Assume there are $T+1$ topological orderings\" -- that is not what \"topological ordering\" means; a topological ordering is a partial order homomorphism from a given partial order to a total order (i.e., a list of the states where no state is preceded by its descendant). Is it meant that the DAG is graded (as stated in the following paragraph) and that the layers are indexed by $0,\\dots,T$? \n    - Similarly, an instance of two elements being in a binary relation is not a \"partial order\". A partial order is a set with a binary relation (satisfying some properties), equivalent to a DAG.\n    - It is incorrect to **define** ${\\cal S}_0:=\\{s_0\\}$ and similar for ${\\cal S}_T$, if the stratification into ${\\cal S}_t$ already comes with the data of a graded DAG. That $s^0$ is the only state in the first graded component ${\\cal S}_0$ is an **assumption/requirement**.\n  - Section 2.2:\n    - The second sentence of 2.2 is self-contradictory. \"Probability measure\" means the measure of the entire $\\cal T$ is 1. In fact $F$ is just a measure, and $P$, its normalization, is a probability measure.\n    - Equation (2) is missing a condition that this should hold only for $s\\neq s^0$.\n    - In equation (3), backward policy was not introduced/defined.\n    - I did not understand this: \"$\\hat Z$ is a constant whose value is clamped to $Z$\".\n  - Section 3 start: I don't believe [Madan et al., 2023] discusses the relationship between TB and KL divergence. However, that relationship is discussed in [Malkin et al., 2022b] and in [Zimmermann et al., \"A variational perspective on generative flow networks\", TMLR].\n  - Section 3.1:\n    - \"Expectation over $P_B$ is intractable due to unknown $Z^*$\" -- even with known $Z^*$, sampling $P_B$ is not necessarily tractable.\n    - \"This forward gradient equivalence [in [Malkin et al., 2022b]] does not take the total flow estimator into account\" -- in fact, that paper shows that the equivalence on $P_F$ parameter gradients holds independently of $Z$ and *also* states the equivalence for the $\\log Z$ gradient (after equation (12) in that paper). Thus there is **nothing original in Proposition 1**.\n    - In Proposition 1, it should be made clear that we do not propagate gradients to the distribution $P_F$ over which the expectation is taken. Otherwise, the proposition is not true. (This remark is made in Appendix A but not pointed to.)\n- The paragraphs following Definition 1 are extremely difficult to understand, switching between GFlowNets and regular RL settings. \n  - I object to the statement that in \"regular RL\" the Markov chain determined by the policy and transition environment is ergodic (many RL settings feature \"irreversible\" actions).\n  - It should be noted that the math following Definition 1 is related to that in max-ent RL, which effectively places negative log-policy into the reward.\n    - Most importantly, how can the policy gradient methods described here work off policy (which is the important advantage of GFlowNets, and important for preventing mode collapse)?\n- The second sentence of section 3.3 seems key but does not make sense to me. The backward policy is a distribution over parents of each state and induces a distribution over subtrajectories. How can the $P_B$ be higher/lower for trajectories that precede a high-reward state $x$ if it is a distribution conditioned on $x$? \n  - Also, please check grammar in that sentence.\n- The experiment results are not very convincing for a few reasons:\n  - On the hypergrid, the policy-based methods effectively learn from partial trajectory information, so a fairer comparison may be to subtrajectory balance (which actually performs better on large hypergrids [Madan et al.]).\n  - Why is RL-G not tested in sections 4.2 and 4.3?\n  - How were training hyperparameters selected?\n  - I am not convinced by the evaluation of total variation in 4.2 and 4.3 if it is performed by sampling, which can induce high variance in the estimate. It should be possible to compute the true terminating distribution, at least for the structure learning problem. JSD between the full distributions would allow comparison with past work; right now, there is no way to validate that TB faithfully reproduces results from [Deleu et al.] and [Malkin et al., 2022b].\n  - The same concerns apply to the bit sequence problem (4.2).\n- Miscellaneous: \n  - Please check your citation type (`\\citet`/`\\citep`) and consistent capitalization in \"GFlowNet\", which is wrong in multiple places.\n  - Broken ref at the bottom of p.5."
            },
            "questions": {
                "value": "Please see above."
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "5: marginally below the acceptance threshold"
            },
            "confidence": {
                "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
            },
            "code_of_conduct": {
                "value": "Yes"
            },
            "first_time_reviewer": {
                "readers": [
                    "ICLR.cc/2024/Conference/Program_Chairs",
                    "ICLR.cc/2024/Conference/Submission6741/Senior_Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission6741/Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission6741/Reviewer_cxrP"
                ]
            }
        },
        "number": 1,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission6741/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698688877367,
        "cdate": 1698688877367,
        "tmdate": 1700516582901,
        "mdate": 1700516582901,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "kT8zgzMh5p",
        "forum": "k2lkeCCfRK",
        "replyto": "k2lkeCCfRK",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission6741/Reviewer_gXTK"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission6741/Reviewer_gXTK"
        ],
        "content": {
            "summary": {
                "value": "This work shows that there is an equivalence (in expectation) between training GFlowNets (GFN) with the Trajectory Balance objective, and a special form of non-stationary-reward policy gradient (PG) method. This is derived through the equivalence (in expectation) between TB and a forward KL-Divergence shown in prior work. This enables the algorithm to be treated as a PG method, onto which one can apply methods like TRPO.\n\nThe authors perform some empirical evaluations of their method on grids, bit sequences, and Bayesian networks."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "2 fair"
            },
            "contribution": {
                "value": "2 fair"
            },
            "strengths": {
                "value": "This paper continues the work of relating GFlowNets and other frameworks, here RL, and of building novel methods upon that. In that sense the work here is a novel and interesting contribution."
            },
            "weaknesses": {
                "value": "The two main weaknesses of this paper are presentation and strength of empirical results.\n\nPresentation: what the authors are trying to do isn't incomprehensible, I kind of get it and staring at the appendix helps, but I honestly think  section 3 could be heavily reworked to be more concise and tell a story, e.g. make it clear at every step what the symbols are, where they come from and how they make us progress in going from TB to RL with a non-stationary reward.\n\nResults: \n- Hypergrids and bit sequences are not very hard nor interesting problems, they were meant to be toy examples in the papers in which they were introduced. Learning to produce Bayesian nets is interesting, but I don't think the authors properly compare to Deleu et al.\n- There isn't much in terms of \"why does this work [better]?\" which is usually a good thing to have in a paper.  \n\n\nNow I realize this paper may be more \"theory\" than experiment, but it does feel unfortunate that there's a mismatch between the \"we're doing PG therefore we can bring in the whole RL arsenal\" and the lack of big results.\n\nThis may be tangential, and just a semantics argument, but I find it slightly far-fetched to call this a policy gradient algorithm, or maybe even RL. The reason: the reward changes at every state, _and_ in a self-referential manner. The closest we have is maybe methods like Random Network Distillation, but even then the update of $R$ is decoupled from the update of $\\pi$. Just because the update equation \"looks like\" PG, doesn't mean it's the most \"scientifically useful\" way to describe it. Methods like TRPO certainly assume a fixed reward, so I don't even know if what's being done here is correct."
            },
            "questions": {
                "value": "- > \"Value-based methods, however, face the difficulties of designing a powerful sampler that\ncan balance the exploration and exploitation trade-off, especially when the combinatorial space is\nenormous with well-isolated modes.\"   \n  \n  I really don't see what this challenge has to do with a method being value-based or not. Soft-Q-Learning is very powerful and handles this trade-off. SubTB-GFlowNets seem to work very well and handle this trade-off through means like temperature conditioning.\n- I don't understand if the authors mean something specific (or different) when they talk about absorbing MDPs; GFlowNets already operate on absorbing DAGs through the definition of $s_f$.\n- In section 3.2, the authors write \"It is clear that...\", I beg to differ, it would be helpful to explain where this equation is pulled from. Why can $V_F$ be substituted for (4)?\n- The authors carry on to write that the gradients of TB can be written something like $(Q(s,a) -C)\\nabla \\log P_F$, which sounds cool but at this point in the paper $Q$ (nor $V$) hasn't been fully defined. It appears to be the action-value function of policy $P_F$, but for which reward? For which MDP?\n- \"Following the pipeline by Shen et al. (2023), we must solve the optimization of LT B\u2212G to find the desired PB at first\". I'm not 100% sure but fairly confident that in Shen et al. $P_B$ and $P_F$ are \"trained\" simultaneously, it's just that $P_B$ is non-parametric, thus it evolves in time as more states are visited.\n- Hypergrid:\n    - Gridworlds, in GFNs and in RL, are useful to _sanity check_ an idea, but I really wouldn't use it as a strong base of comparison between algorithms\n    -  \"[P] can be estimated empirically by sampling\" in a hypergrid it can be computed exactly as well through dynamic programming.\n- BN: Deleu et al. use detailed balance, not TB, to train their model. It would be good to compare performance to their setup exactly rather than a possibly suboptimal one.\n- After Eq (12), I'm not sure what Lemma 1 has to do with the fact that the expected value of a score is 0.\n\n\n- There are lots of typos and some citation formatting mistakes throughout, I'd recommend another round of proofreading."
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "5: marginally below the acceptance threshold"
            },
            "confidence": {
                "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        },
        "number": 2,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission6741/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698697167620,
        "cdate": 1698697167620,
        "tmdate": 1699636776067,
        "mdate": 1699636776067,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "2TBdoQiWe9",
        "forum": "k2lkeCCfRK",
        "replyto": "k2lkeCCfRK",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission6741/Reviewer_MZqG"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission6741/Reviewer_MZqG"
        ],
        "content": {
            "summary": {
                "value": "The paper proposes a new approach for improving the training of GFlowNets from the perspective of policy-based rewards and guided backward policy. The proposed method includes a coupled training strategy that jointly solves GFlowNet training and backward policy design, which aims to improve training efficiency. The method is tested a few benchmark including hypergrid, bit sequence generation and bayesian structure learing."
            },
            "soundness": {
                "value": "2 fair"
            },
            "presentation": {
                "value": "1 poor"
            },
            "contribution": {
                "value": "2 fair"
            },
            "strengths": {
                "value": "This paper tries to connect the field of RL and GFlowNets, which forms an interesting problem. The experimental part is well-explained."
            },
            "weaknesses": {
                "value": "The main concern for the paper is that the experimental evaluation part is too toy -- which focuses on some synthetic problems including hypergrid and bit sequence generation only, and the evaluation metric does not follow previous paper, and some of the claims are not well supported."
            },
            "questions": {
                "value": "> Our theoretical results are also accompanied by performing experiments in three application domains, hyper-grid modeling, Bit sequence modeling, and Bayesian Network (BN) structure learning.\n\nCould the authors also consider molecule generation and biological sequence design, which are more practical and larger-scale tasks for validating the effectiveness of the approach?\n\n> Definition 1 (Policy-dependent Rewards).\n\nIf the rewards are dependent on the policy, will it change during the course of training? Doesn't this introduce additional instability? \n\nRegarding the experiments, why not following the standard metric for evaluating the algorithms, e.g., L1 error, the number of modes?"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "5: marginally below the acceptance threshold"
            },
            "confidence": {
                "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        },
        "number": 3,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission6741/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698758259432,
        "cdate": 1698758259432,
        "tmdate": 1699636775953,
        "mdate": 1699636775953,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "rSugaROiXF",
        "forum": "k2lkeCCfRK",
        "replyto": "k2lkeCCfRK",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission6741/Reviewer_U7wX"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission6741/Reviewer_U7wX"
        ],
        "content": {
            "summary": {
                "value": "This paper reformulates the the GFlowNet training problem as a RL problem over a special MDP. A policy gradient method is proposed to do RL training in this setting. The authors also formulate the design of backward policies in GFlowNets as a RL problem and propose a coupled training strategy. Theoretical and empirical results are provided to validate and help understand the proposed method."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "4 excellent"
            },
            "contribution": {
                "value": "3 good"
            },
            "strengths": {
                "value": "**originality**\n- The main novelty of the paper is on formulating the GFlowNet problems as RL problems and allow the use of RL in these problems. The problem formulation and the training strategies proposed can be considered novel results. \n- The theoretical results are interesting and can be considered novel\n\n**quality**\n- The paper is overall well-written, with only minor isuses\n\n**clarity**\n- The paper is quite clear\n\n**significance**\n- The new problem formulation and training strategies discussed in this paper allow RL to be used in GFlowNet training problems, together with theoretical and empirical results, can be a significant contribution."
            },
            "weaknesses": {
                "value": "Related work:\n- It seems to me the related work can be improved, for example, what is the most relevant standard RL algorithm? And how is your proposed policy gradient method different in design? Additionally, GFlowNet and RL are discussed together in some other papers in the literature, such as the \"GFlowNet Foundations\" by Bengio et al. How is the analysis in your work related to these previous works? \n\nAdditional technical details: \n- Would be nice to have more technical details, for example, how does your method compare to others in terms of computation efficiency? Will formulating into RL problems make training much slower. \n\nAblations:\n- I think more ablation on the proposed method with different hyperparameters can help us understand better how it can be applied/tuned to different problems. \n\nOther issues: \n- End of page 5, a figure reference seems to be broken. Is this figure in the paper?"
            },
            "questions": {
                "value": "- Can you elaborate on why is RL a good strategy to use for these problems and what unique advantages it can bring? Are there concrete problems where they have to be solved with RL and not other strategies?"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "5: marginally below the acceptance threshold"
            },
            "confidence": {
                "value": "2: You are willing to defend your assessment, but it is quite likely that you did not understand the central parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        },
        "number": 4,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission6741/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698818944322,
        "cdate": 1698818944322,
        "tmdate": 1699636775817,
        "mdate": 1699636775817,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "2Ld3yUKoJj",
        "forum": "k2lkeCCfRK",
        "replyto": "k2lkeCCfRK",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission6741/Reviewer_xjL5"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission6741/Reviewer_xjL5"
        ],
        "content": {
            "summary": {
                "value": "This work introduces a way to train GFlowNets through policy gradients from the RL literature. The work proposes a coupled training strategy to train the forward and backward policies in GFlowNets."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "3 good"
            },
            "contribution": {
                "value": "3 good"
            },
            "strengths": {
                "value": "1. This work discusses an interesting direction of training GFlowNets and using learning from RL policy-based methods to introduce a policy-based GFlowNet.\n2. The discussion and perspective around backward trajectories is interesting and a useful way to improve GFlowNet training.\n3. The gradient equivalence discussion and analysis is useful to understand the theoretical claims and some of the motivation behind this work."
            },
            "weaknesses": {
                "value": "1. The related work section could be made more exhaustive by adding the other GFlowNet losses and their references.\n2. It will be useful to expand the number of environment configurations. For hypergrid, N=2 and N=3 are the only options used and using a higher value will help.\n3. Previous work has analyzed number of states visited for hypergrid domain, which has not been included here. \n4. Adding other GFlowNet based baselines, such as Detailed Balance, would be useful as it is an important and commonly used objective.\n5. Some of the domains that were used in the previous work have been not included here. In order to corroborate that the proposed method can be used over different settings, including them would be helpful.\n6. For bit sequence domain, including all bits used in the previous work would be beneficial for a fair comparison across methods.\n7. Related work could be expanded and made more exhaustive, including the recent improvements in GFlowNets as well."
            },
            "questions": {
                "value": "The main concerns are about the coverage of the experiments section. If the authors could address and answer those concerns, stated in the weaknesses section, it will be useful for the contribution of the work."
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "5: marginally below the acceptance threshold"
            },
            "confidence": {
                "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
            },
            "code_of_conduct": {
                "value": "Yes"
            },
            "first_time_reviewer": {
                "readers": [
                    "ICLR.cc/2024/Conference/Program_Chairs",
                    "ICLR.cc/2024/Conference/Submission6741/Senior_Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission6741/Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission6741/Reviewer_xjL5"
                ]
            }
        },
        "number": 5,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission6741/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698879302137,
        "cdate": 1698879302137,
        "tmdate": 1700687202300,
        "mdate": 1700687202300,
        "license": "CC BY 4.0",
        "version": 2
    }
]