[
    {
        "id": "DyojlzrUsO",
        "forum": "UMOlFJzLfL",
        "replyto": "UMOlFJzLfL",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission7646/Reviewer_SPXN"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission7646/Reviewer_SPXN"
        ],
        "content": {
            "summary": {
                "value": "This manuscript investigates the linear stability of SGD and obtain a sufficient condition for instability (equivalently, a necessary condition for stability).\nThe authors introduce a coherence measure $\\sigma$ to measure the strength of  alignment among Hessian matrices. Using this measure, they derive their main result Theorem 1, which, as they claim, is more general than Theorem 3.3 in [Wu et al, 2022]. The authors also show that Theorem 1 is nearly optimal given that $\\sigma$ and $n/B$ are $O(1)$ quantities. Some experiments are carried out to support the theoretical results."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "2 fair"
            },
            "contribution": {
                "value": "3 good"
            },
            "strengths": {
                "value": "On a whole I think these results are neat, novel and have their own advantages.  The characterization seems to be rather precise and Lemma 4.1 is of particular interest."
            },
            "weaknesses": {
                "value": "- The writing of this manuscript needs to be improved. In particular, the many details are present in an unclear way and I find it very hard to follow them smoothly. The citations and references also need to be re-organized. See Question section for more details. \n\n- The definition of ``Coherence measure'' is not intuitive.  Personally, I do not understand why the proposed definition can quantify the coherence among Hessian matrices. In particular, the authors claim that $\\lambda_1(H_i)$ is the i-th diagonal entry of $S$. This is obviously not true unless that $H_i$ is rank-1.\n\n- The authors might make a better interpretation of Theorem 1. What does this result imply about the implicit regularization of SGD (beyond that of GD)? How stability is related to the hyperparameters, e.g. $\\eta$, $B$, and alignment of $H_i$? Some relevant discussion can be found in the experiment part Section 5.2, but I think it would be better to provide some intuition right after Theorem 1.\n\n - In Section 3.2.1 the authors compare Theorem 1 to Theorem 3.3 in [Wu et al, 2022], and stated the advantages of their result. Among these stated advantages,\n   - The first point makes sense to me.\n   - In the second point, why do you say ``This definition is notably weaker than our notion of stability''?\n   - By the third point, you seem to imply that the bound in Theorem 1 is sharper in the low-rank case. But what is the point in considering $\\sigma$ equal to one? To me, the third point is an unclear comparison between two results, which cannot prove the advantage of Theorem 1.\n\n\n- Theorem 2, the optimality of Theorem 1, strongly relies on the condition that $\\sigma, n/B = O(1)$. There are two concerns:\n   - In Theorem 2 the authors assume that $\\sigma \\in [n]$. Is there anything to guarantee $\\sigma \\leq n$? I don't think it is clear from the definition of $\\sigma$. Is $\\sigma$ inherently bounded? Moreover, do you mean $\\sigma\\leq n$? Hence, it is unclear what the assumption $\\sigma=O(1)$ means.\n   - Also, I do not think it is natural to assume $n/B=O(1)$ as usually $B\\ll n$."
            },
            "questions": {
                "value": "- In paragraph 1, when introducing the concept of \"implicit bias\", instead of citing (Li et al., 2022), I think it is more appropriate to cite the seminar works  (Neyshabur et al., arXiv:1412.6614) and (Zhang et al., ICLR 2017). \n - In paragraph 2, when citing empirical works on relating sharpness to generalization, I think the important comprehensive investigations by (Jiang et al., ICLR2020) is missed.  \n - In paragraph 4, when stating \"GD ... empirically validated to predict the sharpness of overparameterized neural network\", the author cites (Cohen et al., 2021). However, this empirical predictability of linear stability analysis has been observed in (Wu et al., NeurIPS2018).\n - In Section 2\n \t- In paragraph 1, when stating the rationale for assuming over-parameterization, the authors cite the work (Allen-Zhu et al., 2019). This seems quite strange to me. \n \t- In Definition 1,  it is unclear whether the sampling is done with or without replacement.\n- In Section 3\n\t- What is the $\\frac{1}{B}\\sum_{i=1}^n x_i H_i$ in the second paragraph. \n\t- In Theorem 1, what does the subscript in $\\hat{J}_i$ stand for? Complexity measure => coherence measure. \n\t- In Theorem 2, what do you mean $\\sigma\\in [n]$? Is $\\sigma$ a real value?"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "6: marginally above the acceptance threshold"
            },
            "confidence": {
                "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        },
        "number": 1,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission7646/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698746816699,
        "cdate": 1698746816699,
        "tmdate": 1699636929573,
        "mdate": 1699636929573,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "9HBusHX1cW",
        "forum": "UMOlFJzLfL",
        "replyto": "UMOlFJzLfL",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission7646/Reviewer_ELtf"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission7646/Reviewer_ELtf"
        ],
        "content": {
            "summary": {
                "value": "The paper analyzes the linear stability of SGD of any additively decomposable loss function around the minimum $w^*$. The paper then derives a necessary and sufficient condition for the (in)stability, which relies on a novel *coherence measure* $\\sigma$, which is, in turn, intuitively connected to the alignment property of the collection of Hessians (of individual loss function). This is verified experimentally."
            },
            "soundness": {
                "value": "4 excellent"
            },
            "presentation": {
                "value": "4 excellent"
            },
            "contribution": {
                "value": "4 excellent"
            },
            "strengths": {
                "value": "1. Very well-written. I especially liked how the theoretical discussions are backed with intuitions and specific examples. I very much enjoyed reading this work.\n2. Although the mathematics used here are rather elementary, the theoretical discussions are complete; a necessary-sufficient condition for stability is provided, and the motivation and intuition behind the coherence measure $\\sigma$ are well-explained. (Elementaryness is a plus for me)\n3. Clear contribution and a good advancement in the linear stability analysis of SGD"
            },
            "weaknesses": {
                "value": "1. The analysis relies on the Bernoulli sampling model, which, although is in expectation the same as with replacement sampling or uniformly sampling from all $B$-sets, still is a bit different as the size of $\\mathcal{S}$ itself now becomes random. Have the authors tried to consider multinomial distribution as the sampling distribution?\n2. Moreover, without replacement sampling where the event $i \\in \\mathcal{S}$ is dependent on $j \\in \\mathcal{S}$ (depending on the order), there should be some theoretical discussions on the effect of using these two (most-widely-used) random sampling schemes. (I appreciate that the paper has experiments on this, but then, theorem-wise, what would possibly change?)"
            },
            "questions": {
                "value": "1. The analyses presented here are solely on the stability of the iterates, i.e., whether they diverge or not. Is there any chance that this gives some insight into whether they converge? Even further, depending on the alignment of the Hessians, can we say something about the local convergence rate?\n2. The relationship between batch size and learning rate that I'm more familiar with (e.g., starting from Goyal et al. (2017)) is the linear scaling rule, but here it is shown to be squared, which has also been reported in the past (e.g., Krizhevsky (2014)). Can the authors elaborate on why this stability analysis leads to squared? Then, at least locally, is squared scaling law the way to go, given that the Taylor expansion is accurate?\n3. In Figure 1, for small batch sizes, there is a large gap between Theorem 2 and the red boundary for $\\eta = 0.8$. Any particular reason for this?\n4. How would this be extended to momentum gradient descent or any of the adaptive gradient methods (e.g., Adam)? If the time allows, can the authors provide experiments for these as well in the same setting?\n5. In the prior works on linear stability, were there any quantities that resemble $\\sigma$ in their role? If there were, can the authors compare those to the proposed $\\sigma$?"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "8: accept, good paper"
            },
            "confidence": {
                "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
            },
            "code_of_conduct": {
                "value": "Yes"
            },
            "first_time_reviewer": {
                "value": "Yes",
                "readers": [
                    "ICLR.cc/2024/Conference/Program_Chairs",
                    "ICLR.cc/2024/Conference/Submission7646/Senior_Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission7646/Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission7646/Reviewer_ELtf"
                ]
            }
        },
        "number": 2,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission7646/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698778734684,
        "cdate": 1698778734684,
        "tmdate": 1699636929456,
        "mdate": 1699636929456,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "RoL4dJv2IV",
        "forum": "UMOlFJzLfL",
        "replyto": "UMOlFJzLfL",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission7646/Reviewer_mpeb"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission7646/Reviewer_mpeb"
        ],
        "content": {
            "summary": {
                "value": "In this paper, the authors considered quadratic approximations of the loss function around the zero-loss manifold that allows the definition of the 'linearized SGD dynamics' (given in Equation 1). This quadratic approximation allows the definition of the coherence measure (Definition 1), which is used in the statement of Theorem 1: SGD dynamics diverge when the coherence measure lower bounds the first eigenvalue of the Hessian of the loss function. In Theorem 2, they provide a partial converse to their proven divergence results in Theorem 1. The paper concludes with some experiments."
            },
            "soundness": {
                "value": "2 fair"
            },
            "presentation": {
                "value": "1 poor"
            },
            "contribution": {
                "value": "1 poor"
            },
            "strengths": {
                "value": "- an important problem on the stability of SGD\n- having experiments"
            },
            "weaknesses": {
                "value": "The introduction section (i.e., the first two pages) is poorly written. For example, the definition of 'linearized dynamics of SGD' is missing and is just referred to in Section 2. But this is probably one of the most necessary things one needs to know to follow the paper. Moreover, the section 'contributions' is also vague. Instead of long sentences, it's better to use a concise way to deliver the message. It's fairly impossible to identify the contributions of the paper based on that section (before reading the whole paper). \n\n\nSection 2: the approximation is called 'linearized dynamics,' but I think this is not the right word since you are essentially approximating the loss function with a quadratic function. Moreover, this dynamics only happens if you project to the zero-loss manifold at each step; otherwise, there is a term relating to the gradient. As a result, the setting is quite limited to only quadratic loss functions. \n\n\nThe word 'stability of dynamics' is used frequently in the paper while not being explained in the early pages."
            },
            "questions": {
                "value": "- the font used in the paper looks weird; I think the authors have changed something in the latex code\n\n- In Theorem 1, $\\hat{J}_i$ is used, while it is never defined (the reference to Definition 1 only defines $\\hat{J}$).\n\n- After Theorem 1, why the expectation and the arg max are equal? Also, how does divergence allow you to conclude that for almost all initial parameters, SGD convergences? These claims are not clear and are vague.\n\n\n\n\n\n------------------------------------------------------------------------------------------------------------\n\n\nAfter the rebuttal: I appreciate the authors for their response. They partially answered some of my concerns but this paper is still not well-written, in my opinion. The authors only referred me to another reviewer for this part of my comments which I think is not an approrpiate response."
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "3: reject, not good enough"
            },
            "confidence": {
                "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
            },
            "code_of_conduct": {
                "value": "Yes"
            },
            "first_time_reviewer": {
                "value": "Yes",
                "readers": [
                    "ICLR.cc/2024/Conference/Program_Chairs",
                    "ICLR.cc/2024/Conference/Submission7646/Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission7646/Reviewer_mpeb",
                    "ICLR.cc/2024/Conference/Submission7646/Senior_Area_Chairs"
                ]
            }
        },
        "number": 3,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission7646/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698807547734,
        "cdate": 1698807547734,
        "tmdate": 1700790827368,
        "mdate": 1700790827368,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "Cmetfbx872",
        "forum": "UMOlFJzLfL",
        "replyto": "UMOlFJzLfL",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission7646/Reviewer_asFh"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission7646/Reviewer_asFh"
        ],
        "content": {
            "summary": {
                "value": "This paper analyzes the linear stability of SGD through the lens of the loss surface geometry. Assuming a scenario where the model perfectly fits the data, the necessary and sufficient conditions for linear stability is characterized by learning rates, batch sizes, sharpness (the maximum eigenvalue of the Hessian), and a coherence measure of the individual loss Hessians, which is newly proposed in this work. The theoretical findings are validated through experiments on a synthetic optimization problem."
            },
            "soundness": {
                "value": "2 fair"
            },
            "presentation": {
                "value": "3 good"
            },
            "contribution": {
                "value": "2 fair"
            },
            "strengths": {
                "value": "- The paper relaxes certain assumptions in characterizing the stability of SGD, e.g., the restriction to MSE loss, from existing works.\n- The mathematical derivations appear to be sound and accurate."
            },
            "weaknesses": {
                "value": "- The paper lacks intuitive and qualitative explanations of the characterized linear stability, which could enhance its accessibility.\n- The experiments are limited to engineered quadratic losses without considering actual neural networks or real-world data.\n- The paper should address scenarios where the condition $\\nabla_w l_i (w) = 0$ is violated. There may be various cases that $\\| \\nabla_w l_i \\|$ is small but non-zero, e.g., cross-entropy loss without label smoothing, early stopping, and so on. How can the proposed analysis accommodate these cases? \n- There are existing works to characterize the stability of SGD considering the noise covariance matrix $\\Sigma = \\frac{1}{n}\\sum_i \\nabla l_i(w) \\nabla l_i(w)^T - \\nabla L(w) \\nabla L(w)^T$, without assuming $\\nabla_w l_i (w) = 0$. The paper should clarify how its results relate to these existing works."
            },
            "questions": {
                "value": "- What is the exact notion of stability considered in the paper? It is not clearly explained in the manuscript.\n- Is the coherence measure easily computable for typical neural networks? How complex would it be to compute in practice?\n- On page 4, the term $x_i$ is used but not defined. \n- It seems that the second last paragraph on page 4 assumes that $H_i$ is a matrix of rank one. Is this the case?"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "6: marginally above the acceptance threshold"
            },
            "confidence": {
                "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
            },
            "code_of_conduct": {
                "value": "Yes"
            },
            "first_time_reviewer": {
                "value": "Yes",
                "readers": [
                    "ICLR.cc/2024/Conference/Program_Chairs",
                    "ICLR.cc/2024/Conference/Submission7646/Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission7646/Reviewer_asFh",
                    "ICLR.cc/2024/Conference/Submission7646/Senior_Area_Chairs"
                ]
            }
        },
        "number": 4,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission7646/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1699244817632,
        "cdate": 1699244817632,
        "tmdate": 1700723957184,
        "mdate": 1700723957184,
        "license": "CC BY 4.0",
        "version": 2
    }
]