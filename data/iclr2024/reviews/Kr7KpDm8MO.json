[
    {
        "id": "2IMs2pJ4kT",
        "forum": "Kr7KpDm8MO",
        "replyto": "Kr7KpDm8MO",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission2732/Reviewer_Fts9"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission2732/Reviewer_Fts9"
        ],
        "content": {
            "summary": {
                "value": "This work explores how the combined effect of weight decay and gradient update drives GD iterates to a rotational equillibrium for various optimizers. The authors propose that this rotational equiliibrium can be achieved early in training and how achieving this equillibirum can play a key role in effectiveness of AdamW compared to Adam with L2-regularization. To study the equillibirum point, the authors analyze a simplified setting, the optimization of a random loss function, resulting in a random walk for the neural network parameters and derive this point for various optmizers."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "3 good"
            },
            "contribution": {
                "value": "3 good"
            },
            "strengths": {
                "value": "1) The paper is easy to read and follow.\n2) This work attempts to understand an important problem."
            },
            "weaknesses": {
                "value": "Here are some of my major concerns:\n1) I doubt comparing the dynamics of random walk (with zero mean gradients) with neural network training with true objective is meaningful. In particular, it is not clear how a random walk (drawing gradients from a normal 0 mean distribution) can trace the dynamic of neural network trained with a true loss. \n2) The authors state *\"Although the noise component can easily depend on the the progress on the underlying objective function, we can\nview the random walk as an approximation of this noise component.\"* but the random walk is not a function of the true loss, hence making it unclear how it is close to real training dynamics. It maybe possible that I misunderstood, so I will wait for further clarification from the authors. \n3) \"This causes the expected rotation of the vector in each update to remain constant along with its magnitude.\": Although the GD iterates converge in some sense but for moderate lr GD, oscillates in the edge of stability regime https://arxiv.org/abs/2103.00065. Hence, it is not necessarily true that expected rotation in each update remains constant. \n\nMinor:\n\n4) In figure-2,3, the weight norm equillibrium is a scalar, but denoted as a vector in the figure, does the author mean the weight vector at equillibrium?\n5) Similarly for figure-3, please redefine the figure as the expected quantities are scalars but shown as a vector. \n6) Define what is the expectation over, when defining the angular update?"
            },
            "questions": {
                "value": "1) In particular, the justification of neural network random walk with actual training is not clear. I would like to hear from the authors regarding this. \n2) Additionally, it is important than authors correct the terminologies."
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "5: marginally below the acceptance threshold"
            },
            "confidence": {
                "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        },
        "number": 1,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission2732/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698590743804,
        "cdate": 1698590743804,
        "tmdate": 1699636215539,
        "mdate": 1699636215539,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "Q9ajAXjDLO",
        "forum": "Kr7KpDm8MO",
        "replyto": "Kr7KpDm8MO",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission2732/Reviewer_tLyV"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission2732/Reviewer_tLyV"
        ],
        "content": {
            "summary": {
                "value": "This paper studies the interplay between the weight decay and the gradient updates. The underlying phenomenon being studied is related to equilibrium state, which is achieved when the gradient update and the weight decay cancel each other out. In such a state, the parameter updates keep the magnitude same but rotate the update. This work characterizes such equilibrium for various layers in a neural network, for different optimizers including AdamW and SGD. It also argues that rotational equilibrium is the root cause for the performance gap between AdamW and Adam+L2 regularization. Finally, this work also proposes routine to enforce rotational equilibrium in various optimizers."
            },
            "soundness": {
                "value": "2 fair"
            },
            "presentation": {
                "value": "1 poor"
            },
            "contribution": {
                "value": "2 fair"
            },
            "strengths": {
                "value": "- Empirical analysis to explain the difference between AdamW and Adam+L2 regularization using rotational equilibrium is promising\n- Simple procedure to create rotational variants of the existing optimizers"
            },
            "weaknesses": {
                "value": "- It is unclear what the advantage of the rotational variants of an optimizer like AdamW over the vanilla optimizer. Paper does not do any justifications as to why one would prefer rotational variants in practice over the vanilla counterparts given that there is a non-trivial change required. For instance, Table 2 does not convincingly says that the RV AdamW would be the preferred choice.\n- Paper structure makes too many keypoints which hinders the impact of the really important aspects of this work. Since this work is more on the empirical analysis, it would be beneficial if fewer experiments are discussed in details, rather than discussing many experiments in few paras.\n- Need clarifications on many observations made in the paper (see questions below)"
            },
            "questions": {
                "value": "- In Figure 4, what do the colors correspond to? Do these correspond to different neurons or different layers?\n- In Table 1, do you have any intuition as to why the RMS update for Lion is devoid of any beta terms? In contrast, AdamW updates depend on both beta and C.\n- In Table 2, can you explain the performance degradation in RV-AdamW Zero Shot on dataset IWSLT2014 de-en? Also, why is the Wrapped Adam+L2 missing for the ImageNet-1k dataset?\n- In Figure 8, you show the ImageNet-1k+ResNet50 performance for 10 epochs. Does the trend hold true for longer training? Do the baselines and RV variant achieve significantly different Top-1 accuracy?"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "details_of_ethics_concerns": {
                "value": "N/A"
            },
            "rating": {
                "value": "3: reject, not good enough"
            },
            "confidence": {
                "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        },
        "number": 2,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission2732/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698807130342,
        "cdate": 1698807130342,
        "tmdate": 1699636215444,
        "mdate": 1699636215444,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "VGTChNqXX8",
        "forum": "Kr7KpDm8MO",
        "replyto": "Kr7KpDm8MO",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission2732/Reviewer_Yv1K"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission2732/Reviewer_Yv1K"
        ],
        "content": {
            "summary": {
                "value": "This paper investigates the impact of weight decay on the optimization dynamics of deep neural networks. It focuses on the concept of \"equilibrium,\" where the effects of weight decay and gradient updates on the magnitude of parameter vectors cancel out on average, leading to stable parameter rotations and magnitudes during training. The paper explores how different optimization algorithms, including AdamW and SGD with momentum, interact with weight decay, initialization, normalization techniques, and learning rate schedules to achieve equilibrium states. The authors demonstrate that enforcing rotational equilibrium throughout training can simplify the training dynamics by eliminating chaotic transient phases. Additionally, they discuss the role of rotational behavior in the effectiveness of AdamW compared to Adam with L2-regularization, the performance of different normalization layers, and the need for learning rate warmup."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "3 good"
            },
            "contribution": {
                "value": "3 good"
            },
            "strengths": {
                "value": "The paper studies the concept of equilibrium in the context of weight decay and optimization dynamics of SGDM and Adam. A good extension over Wan et al. 2020.\n\nIn-Depth Analysis: The paper provides a comprehensive analysis of how various factors, including optimization algorithms, weight decay, initialization, normalization, and learning rate schedules, interact and affect equilibrium states. The analysis though of over-simply assuming *random walk* updates gives estimation of the *expected angular* and *equilibrium norm*. It is interesting to see these measures are correlated with the observational phenomena of AdamW vs Adam+L2, normalization and warmup.\n\nMoreover, the findings have practical implications for deep learning practitioners, as they suggest ways to simplify and improve training dynamics. Overall, the paper presents an intriguing concept and thorough analysis of equilibrium states in deep learning optimization."
            },
            "weaknesses": {
                "value": "**Gap between theory and practice** The expected angular exhibits different behaviors for different algorithms, e.g., Adam, AdamW and SGDM, empirically (see Figure 4 and 6). At the same time, the analysis based \"random walk\" gives estimation of *expected angular* and *equilibrium norm* (see Table 1). However, the theoretical estimation cannot predict the empirical differences. This makes the paper not coherent enough. \n\n**Induced algorithm shows some improvement but not significant enought**. It is a bit disappointing that the theory motivated modification Rational Variants cannot compensate Adam+L2 to make it as good as AdamW."
            },
            "questions": {
                "value": "Can the equilibrium argument explain the practical tuning wisdom of keeping $\\eta\\lambda$ constant? Does this wisdom apply to all optimizers?"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "details_of_ethics_concerns": {
                "value": "N/A"
            },
            "rating": {
                "value": "5: marginally below the acceptance threshold"
            },
            "confidence": {
                "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        },
        "number": 3,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission2732/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698989972291,
        "cdate": 1698989972291,
        "tmdate": 1699636215388,
        "mdate": 1699636215388,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "y2gwiFsmpC",
        "forum": "Kr7KpDm8MO",
        "replyto": "Kr7KpDm8MO",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission2732/Reviewer_Pvr2"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission2732/Reviewer_Pvr2"
        ],
        "content": {
            "summary": {
                "value": "This submission follows the Spherical Motion Dynamics (Wan et al., 2021) to further investigate the rotational equilibrium when using normalization techniques and weight decay jointly. Some findings are further shown for analyzing the balanced and imbanced rotation, particularly for AdamW and Adam+L2."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "3 good"
            },
            "contribution": {
                "value": "2 fair"
            },
            "strengths": {
                "value": "- Simple and intuitive derivation of the \"rotational equilibrum\" for different optimizers\n- Based on the balanced and imbanlaced rotation, interesting discovery for discribing the difference between AdamW and Adam+L2. \n- Propose a simple normalization technique to explicitly control the average angular update size, forcing it to match equilibrium throughout training."
            },
            "weaknesses": {
                "value": "- I acknowledge the contribution that analyzing the difference between between AdamW and Adam+L2 from the imbalanced rotation view. However, further careful justification is required. First, the rigorous explaination is required to show why AdamW is imbanlaced while Adam+L2 is not. Second, why the balanced rotation helps to perform well in general. Without these justification, I cannot see the significant contribution of this paper, since other contribution points are too incremental and minor. \n\n- There is a number typo in Table2, row IWSLT2014 de-en."
            },
            "questions": {
                "value": "see above"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "5: marginally below the acceptance threshold"
            },
            "confidence": {
                "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        },
        "number": 4,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission2732/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1699496141572,
        "cdate": 1699496141572,
        "tmdate": 1699636215298,
        "mdate": 1699636215298,
        "license": "CC BY 4.0",
        "version": 2
    }
]