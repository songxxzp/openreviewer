[
    {
        "id": "4EZw2bwPcY",
        "forum": "Jos5c7vJPP",
        "replyto": "Jos5c7vJPP",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission8217/Reviewer_xVE8"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission8217/Reviewer_xVE8"
        ],
        "content": {
            "summary": {
                "value": "The paper studies amortization schemes for variational Bayesian approximate inference methods. The approach is akin to the inference procedure used in standard variational autoencoders (maximize the reverse KL/ELBO), but amortization is performed over datasets instead of over individual datapoints. To solve this, the paper employs standard exchangeable aggregation architectures like deep sets or transformers.\n\nIn the experimental evaluation the authors consider a range of probabilistic models and explore two architectural choices: (i) deep sets vs. transformer-based aggregation (ii) Gaussian vs. normalizing flow variational posterior approximations. They compare against non-amortized inference schemes (max. likelihood, MCMC, random) as well as against an amortized approach based on the forward KL. The authors also evaluate how the methods perform under distribution shift."
            },
            "soundness": {
                "value": "2 fair"
            },
            "presentation": {
                "value": "3 good"
            },
            "contribution": {
                "value": "2 fair"
            },
            "strengths": {
                "value": "The paper is mostly well written and the authors provide an extensive experimental evaluation with enough details to ensure reproducibility. I think that the architectural comparisons (Gaussian vs. normalizing flow/deep set vs. transformer) are interesting. Unfortunately, the experiments in their current form due not yet convince me of the paper's significance (see weaknesses)."
            },
            "weaknesses": {
                "value": "My main concerns are (i) that the approach lacks novelty and (ii) that the experimental evaluation should be improved in various aspects.\n\nDetails:\n\n(i) Amortized inference has been studied extensively in the past, e.g., in the context of the variational autoencoder. Amortization on the dataset level is also not new: it has been studied for years in the meta-learning community. In fact, the method is conceptually very similar to neural process (NP) [1] like approaches. The difference is that inference is performed over the decoder parameters directly and that, consequently, there are no free parameters that are optimized for predictive performance. While this is an architectural difference, it does not require any adaptations wrt to the posterior inference method (which is the only methodological proposal of the paper): both methods just optimize the ELBO wrt the variational parameters. The authors acknowledge these similarities, but argue that their method is new in the sense that NP-like methods are \"predominantly designed for predictive modeling and thus cannot be used to provide useful information and uncertainty about model parameters\". Unfortunately, the authors also largely focus on posterior predictive performance. The only results studying the quality of the approximate posterior are in Tab. 4 and Fig. 4 (c,d) which lack any comparisons against non-amortized baselines. I encourage the authors to explore further in which sense their method yields \"useful information and uncertainty about model parameters\", at least by adding more baselines to Tab. 4 (in particular baselines that allow to judge the amortization gap introduced by their method, cf. below).\n\n(ii) Following my remarks above, I consider the paper's contribution to be exclusively empirical. While the provided architectural comparisons are interesting, I do not yet consider the contribution significant enough  to be of interest for the community. Thus, I encourage the authors to improve/extend their experimental evaluation:\n- Please provide details about how the L2 and accuracy metrics were computed. (Please provide the exact formulae).\n- Could you elaborate on why you do not evaluate the predictive log marginal likelihood instead of the L2 loss (as is typically done for assessing the predictive performance of Bayesian models). This metric should better measure the quality of predictive epistemic uncertainty estimates and, thus, implicitly of the posterior approximation.\n- How much variance is introduced in the results due to the algorithm's/network's initialization? Please provide confidence intervals for your experimental results. In its current form it is impossible to judge their significance.\n- I would propose to also add a non-amortized version of the proposed method as a baseline. This would allow to judge the amortization gap, i.e., the approximation error introduced by amortization alone.      \n- The authors state that normalizing flows do not increase approximation accuracy due to the mode-seeking behavior of the reverse KL objective. I would be interested in a discussion and/or comparison to recent natural-gradient based methods such as [2,3] that perform VI with expressive Gaussian mixture approximations by inducing terms in the objective that prevent mode collapse.\n- The authors argue that deep sets are inferior to transformer-based architectures because of the naive sum/mean-based aggregation of deep sets. [4] propose a Bayesian aggregation method that tackles exactly this problem. It would be interesting to see how Bayesian aggregation compares to transformer-based aggregation.\n\n[1] https://arxiv.org/abs/1807.01622\n[2] https://arxiv.org/abs/2002.10060\n[3] https://openreview.net/pdf?id=tLBjsX4tjs\n[4] https://openreview.net/forum?id=ufZN2-aehFa"
            },
            "questions": {
                "value": "See my comments below \"Weaknesses\"."
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "details_of_ethics_concerns": {
                "value": "---"
            },
            "rating": {
                "value": "3: reject, not good enough"
            },
            "confidence": {
                "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        },
        "number": 1,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission8217/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1697735157727,
        "cdate": 1697735157727,
        "tmdate": 1699637020316,
        "mdate": 1699637020316,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "SBIpMu4rzA",
        "forum": "Jos5c7vJPP",
        "replyto": "Jos5c7vJPP",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission8217/Reviewer_iJJB"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission8217/Reviewer_iJJB"
        ],
        "content": {
            "summary": {
                "value": "This manuscript proposes a method for amortized Bayesian posterior inference. In particular, this method leverages set-based neural network architectures to design an amortized posterior that can deal with observation of varying cardinality. The model is trained using the reverse-KL divergence which is shown empirically to work better for the considered benchmarks. The authors also show that this leads to better performance when the model used differs from the data-generating process."
            },
            "soundness": {
                "value": "2 fair"
            },
            "presentation": {
                "value": "1 poor"
            },
            "contribution": {
                "value": "2 fair"
            },
            "strengths": {
                "value": "* The method is sound.\n* Building amortized Bayesian inference algorithms that can deal with sets of observations of different cardinality and be robust to model specification is significant."
            },
            "weaknesses": {
                "value": "Overall, I find that the paper lacks of clarity making it hard to follow. Here is a list of things that, in my opinion, harms clarity:\n\n* The contributions are not clear. Here are the three claimed contributions:\n   1. *\"Proposing a novel method for performing Bayesian inference in probabilistic models solely through inference on a trained amortization network, and demonstrating its effectiveness in a variety of settings and with several well-known probabilistic models.\"* \nThroughout the paper, it is not clear to me what is claimed as novel in the proposed method. Is performing Bayesian inference based on a trained amortization network claimed to be novel? Is using the reverse KL divergence novel? Is the fact of using a backbone that accepts sets as input to handle datasets of different cardinality novel?\n\n\t2. *\"Providing insights into various design choices like the architectural backbone used and the choice of parametric distribution through detailed ablation experiments.\"* Ok\n\n\t3. *\"Highlighting the superior performance of our proposed approach when compared to existing baselines, especially in the presence of model misspecification and real-world data.\"* Does the contribution lie in the design of a new method to handle model misspecification or the empirical study of existing methods in this context?\n\n* There are figures all over the place while they all belong to section 4. It is very confusing to see experimental figures in the middle of the introduction. In addition, when reading the experiment section, the reader has to jump back to the introduction to see the figure.\n\n* Equation (8) seems to be very similar to equation (9) from prior work. Would it be easier to start from there, explain what $\\chi$ is and say that you use the reverse KL instead? I feel that previous explanations dilute the message and make things hard to follow while equation (9) is straightforward to understand.\n\n* Section 4.3 seems to be full of methodological elements while being in the middle of the experiments section. I think grouping all the methodological elements together would help clarify the contributions.\n\n* In section 4.3 it is said that \"In contrast, we can leverage our proposed reverse KL approach to train an amortized inference model to predict the posterior over the assumed probabilistic model\u2019s parameters by directly using the available unpaired data during training.\" It is not clear to me how this is done while this seems to be a contribution of the paper. It would be worth to expand on this more. \n\t\nI think the following paper should be discussed in the related works. It addresses the problem of amortized Bayesian inference for datasets of different cardinality. It exploits the fact that the scores of each individual observation can be composed to produce the score of the joint observations. This joint score can then be used to efficiently produce samples from the posterior distribution.\nGeffner, T., Papamakarios, G., & Mnih, A. (2023). Compositional Score Modeling for Simulation-Based Inference.\n\nIn the experiments, the quality of the approximate posteriors is quantified using either the expected $L_2$ loss or the expected accuracy loss. This is unclear to me what those losses are. I think it is important to include their mathematical definition in the manuscript. From what I understood, the expected $L_2$ loss can be defined as \n$L_2 = E_{p(\\theta|D)}[(\\theta - \\tilde{\\theta})^2] $\nwhere $\\tilde{\\theta}$ would be the parameters used to generate $D$. I think this metric is unsuited when the posterior is multimodal. An approximation that puts the mass in the middle of the two modes (where there should be no mass) will have a lower $L_2$ than an approximation that puts half the mass in each mode. \n\nI cannot assess the novelty due to the lack of clarity regarding the contributions."
            },
            "questions": {
                "value": "* Could you clarify what in the manuscript is a contribution and what belongs to the background?\n\n* Could you clarify what are the quantities used for evaluation and justify the use of those?"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "3: reject, not good enough"
            },
            "confidence": {
                "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
            },
            "code_of_conduct": {
                "value": "Yes"
            },
            "first_time_reviewer": {
                "value": "Yes",
                "readers": [
                    "ICLR.cc/2024/Conference/Program_Chairs",
                    "ICLR.cc/2024/Conference/Submission8217/Senior_Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission8217/Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission8217/Reviewer_iJJB"
                ]
            }
        },
        "number": 2,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission8217/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698748860973,
        "cdate": 1698748860973,
        "tmdate": 1699637020200,
        "mdate": 1699637020200,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "yBdwl2NfUJ",
        "forum": "Jos5c7vJPP",
        "replyto": "Jos5c7vJPP",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission8217/Reviewer_oaRk"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission8217/Reviewer_oaRk"
        ],
        "content": {
            "summary": {
                "value": "The paper presents a framework for amortized inference of probabilistic model parameters, $\\theta$, using neural networks that maintain permutation equivariance among data points. The neural network takes in a dataset of some number of datapoints and provide amortized inference of the model parameters, it is also capable of taking in datasets of various dimensions. \n\nThe method doesn\u2019t require ground truth parameters during training. Instead, the objective is to minimize the reverse KL divergence under the Variational Inference (VI) framework, with the requirement that the model provides a closed-form likelihood of the data given the model parameters. The method is applied to probabilistic models such as (non-)linear regression/classification and Gaussian mixtures. On unseen problems, the amortized inference parameters serve as good initial guess that can speed up optimization based on that."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "3 good"
            },
            "contribution": {
                "value": "2 fair"
            },
            "strengths": {
                "value": "- *Versatility of Application*: The method is demonstrated to be effective for both fixed and variable-dimension parameter spaces. In the latter case, the method cleverly leverages masking to manage unused dimensions.\n- *Model Robustness*: By adopting a reverse KL approach rather than forward KL, the presented model offers greater resilience to model-misspecification. This implies that it can effectively handle cases where training datasets and test datasets might be characterized by different underlying probabilistic models."
            },
            "weaknesses": {
                "value": "- *Literature Gap*: The paper seems to omit relevant literature on amortized GP hyperparameters [1][2][3]. And GP belongs to the framework considered here because it has closed form likelihoods given model parameters. Specifically,[1] produces amortized inference for point estimate of the posterior for GP hyperparameters given a dataset. The neural network architecture proposed in [1] also makes use of transformer for permutation equivariance. [1][2][3] also generalize to unseen datasets, with the same meta-learning flavor. This paper broadens the perspective by considering general probabilistic models and considering a distribution rather than a point estimate. But the basic idea and architecture choices share the same spirit, which decreases the novelty in the methodological contribution.\n- *Variable Dimension Handling*: The method of managing variable-dimensions through masking might be limited. It wastes GPU memory and is not equivariant w.r.t. dimensions. There could be potential benefits in exploring the neural network employed by [1] if each dimension has its own parameters, such as in linear regression and GMM.\n- *Clarity on GMM*: It is unclear how the proposed approach would manage variable  number of mixtures in the case of Gaussian Mixture Models (GMM).\n- *Ablation Limitations*: While the mention of an ablation study is commendable, it would be beneficial to see a more comprehensive study, for instance, sweeping across dimensions ranging from 1-100D, to see how the approach extrapolates on dimensions different than the training data.\n\n[1] Liu, Sulin, Xingyuan Sun, Peter J. Ramadge, and Ryan P. Adams. \"Task-agnostic amortized inference of gaussian process hyperparameters.\" Advances in Neural Information Processing Systems 33 (2020): 21440-21452.\n\n[2] Simpson, Fergus, Ian Davies, Vidhi Lalchand, Alessandro Vullo, Nicolas Durrande, and Carl Edward Rasmussen. \"Kernel identification through transformers.\" Advances in Neural Information Processing Systems 34 (2021): 10483-10495.\n\n[3] Bitzer, Matthias, Mona Meister, and Christoph Zimmer. \"Amortized Inference for Gaussian Process Hyperparameters of Structured Kernels.\" UAI (2023)."
            },
            "questions": {
                "value": "- *Choice of MCMC*: What was the motivation behind choosing Langevin instead of HMC? Further, is the paper referring to stochastic gradient Langevin dynamics? Maybe HMC type algorithms such as NUTS [4] should also be considered, since they have shown to be performing well empirically and given the number of datapoints is not too large that needs stochastic gradient . \n- *Handling Variable Dimensions*: While masking is one approach to manage variable dimensions, could the authors clarify if they looked into other methods, like the ones used by [1]?\n- *GMM's Variable Dimension Handling*: How does the model handle variable output dimensions in number of mixtures for GMMs, and what is the strategy for determining the number of mixtures?\n- *Figure Positioning*: The positions of the figures within the paper were not specified. Could the authors provide more clarity on this aspect?\n- *Comprehensive Ablation Study*: Would the authors consider conducting an ablation that sweeps on dimensionality from 1-100D?\n\n[4] Hoffman, Matthew D., and Andrew Gelman. \"The No-U-Turn sampler: adaptively setting path lengths in Hamiltonian Monte Carlo.\" J. Mach. Learn. Res. 15, no. 1 (2014): 1593-1623."
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "5: marginally below the acceptance threshold"
            },
            "confidence": {
                "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        },
        "number": 3,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission8217/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698784398631,
        "cdate": 1698784398631,
        "tmdate": 1699637020090,
        "mdate": 1699637020090,
        "license": "CC BY 4.0",
        "version": 2
    }
]