[
    {
        "id": "8awB1tTEc0",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission1396/Reviewer_Eje2"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission1396/Reviewer_Eje2"
        ],
        "forum": "bJ3gFiwRgi",
        "replyto": "bJ3gFiwRgi",
        "content": {
            "summary": {
                "value": "This paper addresses the challenge of inferring both reward and cost functions from expert demonstrations within a meta-learning environment. Specifically, the environment comprises a set of tasks, each with its unique rewards and constraints. To aid the inverse learning process, every task is paired with a demonstration dataset, capturing the actions of expert agents. The objective is to derive meta-priors for both reward functions and constraints that can be readily adapted to new tasks.\n\nTo tackle the meta Inverse Constrained Reinforcement Learning (ICRL) problem, the paper extends the bi-level optimization framework proposed by Liu & Zhu (2022). In this model, the upper-level problem focuses on reward learning, while the lower-level problem tackles constraint learning. Following this framework, the paper introduces an algorithm that estimates gradients at multiple levels. Due to the computational challenges associated with calculating the inverse-of-Hessian term (or hyper-gradients) and solving the exact lower-level problems, a set of approximation methods is proposed. The primary techniques include 1) a first-order approximation to second-order gradients, 2) substituting the computation of the inverse-of-Hessian term with an optimization problem solution, and 3) approximating the solution to the lower-level problem with multiple iterations of gradient descent.\n\nTo validate the convergence of the proposed algorithm, this paper extends the results of the \u03f5-approximate first order stationary point (\u03f5-FOSP) from Fallah et al. (2020) to its context. Specifically, it demonstrates that the norm of the empirical loss estimation is bounded upon convergence (with optimal estimate). Furthermore, this paper derives an upper bound on the empirical loss estimation for new tasks, reinforcing the generalization performance of the proposed method.\n\nThe empirical study primarily focuses on the physical drone setting and the Mujoco setting. These settings are used to substantiate the empirical performance of this method."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "3 good"
            },
            "contribution": {
                "value": "2 fair"
            },
            "strengths": {
                "value": "1. The paper is well-structured and written, with many details provided to aid readers in understanding the principal contributions and the main claims. The notations are carefully designed and well-defined. \n2. The algorithm proposed is well presented and generally straightforward to understand, which speaks to the clarity and precision of the authors' exposition.\n3. The theoretical results appear sound overall. The requisite assumptions underlying the main proof are well conveyed. References to key methods appear comprehensive, though it's not entirely clear whether the convergence and generalization outcomes are consistent with and comparable to the principal results under the meta Inverse Reinforcement Learning (IRL) or Reinforcement Learning (RL) frameworks. In RL, the analysis of regret or sample complexity is typically expected, yet the theoretical results in this paper predominantly cater to gradient-based methods.\n4. The empirical results underscore the superior performance of the M-ICRL in comparison to other benchmarks. This highlights the practical efficacy of the proposed approach in real-world scenarios."
            },
            "weaknesses": {
                "value": "1.  **Novelty**. Liu & Zhu (2022) has proposed a bi-level optimization objective for ICRL. This paper expands upon that proposal, adapting the objective to fit within a meta-learning context. The primary innovation is the integration of a meta-prior into the initial objective (see objective (2)). The algorithm presented outlines a direct, gradient-based optimization method, which, unfortunately, is computationally infeasible under most circumstances. The core focus of this paper is on *mitigating this computational difficulty* through the implementation of three levels of approximation. Additionally, it explores the impact of these approximations on both convergence and generalization. However, it should be noted that this study deviates somewhat from the original goal of Meta ICRL. Moreover, the advancements it provides over Liu & Zhu (2022) could be considered somewhat marginal.\n\n2. **Theoretical Contributions.** I have several concerns about the theoretical results. \n- Theorem 1 sets an upper bound on the expected gradient of the exact optimal solution. When compared to other more frequently used results, such as the upper bound of regret or the sample complexity in the PAC (Probably Approximately Correct) analysis, this result doesn't appear particularly robust.\n- It is surprising to note that the upper bound is raised to the power of $K$ (the number of gradient steps), rather than being linear or sublinear with respect to $K$. This implies that the approximation error could accumulate rapidly with each gradient step. Unfortunately, the paper does not provide a satisfactory explanation for this issue.\n- I question the assertion that this upper bound can be regarded as an \u03f5-approximate first-order stationary point. While the construction of \u03f5 being proportional to $\\sqrt{1/N}$ is reasonable, the inclusion of an additional Big O term seems less comprehensible. It is my belief that the approximations exert a significant influence on convergence, which should not be overlooked.\n\n3. **Bi-level approximation.** In Liu & Zhu's (2022), the bi-level optimization framework of ICRL is structured such that the upper-level problem was focused on reward learning, while the lower-level problem addressed constraint learning. In this current paper, the upper-level problem has been expanded to include the learning of meta-priors for both rewards and constraints ($\\theta$ and $\\omega$). This shift deviates from the original bi-level optimization framework of ICRL, raising some questions about its consistency. Moreover, the paper proposes that the task-specific reward adaptation is carried out via a gradient update. However, it is unclear whether this is a well-defined adaptation for specific tasks. There is a concern that this adaptation may be inadequate. It would be beneficial to provide additional supporting evidence. This could include referencing relevant papers where similar strategies have been successfully applied.\n\n4. **The Audience of the current paper.** My final concern pertains to the intended audience of this paper. The manner in which the content is presented seems to diverge from the primary interests of the mainstream Reinforcement Learning (RL) and Machine Learning (ML) community. This paper primarily focuses on the approximation of computationally intractable gradients and the subsequent implications for convergence and generalization. While these advancements are valid, they may not be entirely consistent with the broader ML community. Furthermore, it's unclear how subsequent work can leverage and benefit from these methods. In my view, the style of this paper aligns more closely with the interests of the optimal control and robotics community. Subjectively speaking, ICLR may not be the most appropriate venue for this paper.\n\n5. **Empirical Results** There are several concerns about the empirical results.\n- The environmental parameters in the MuJoCo experiments raise some questions. The paper states (see Appendix B.2) that \"The design of the reward function is such that the robots will receive a reward of +1 if they maintain the target velocity and a reward of 0 otherwise.\" and \"For the constraint, the Swimmer experiment constrains all the states where the front tip angle exceeds a0, where a0 \u2208 [0.9, 1.2].\" These constraints do not appear to be significant. In particular, it's unclear why the agent would need to violate the constraint to maximize cumulative rewards, and whether maintaining the correct speed is a suitable reward for a MuJoCo task. More justification for these settings is required.\n\n- The results for Meta-IRL are counterintuitive. One would expect that imitation learning methods like IRL, which do not model constraints, would yield higher reward and constraint violation rates. The presented results do not align with this understanding. Please provide an explanation.\n\n- There's a considerable gap between the performance of the baselines and the expert performance. The lead of M-ICRL is substantial, suggesting that all the baselines fail in the task. Without careful design, the validity of these baselines could be called into question. More details or improvements on the baseline design are suggested."
            },
            "questions": {
                "value": "1. Line 4, Algorithm 1: It's unclear what the second $\\mathcal{D}_i^{tr}$ in the gradient is intended for. It appears that the final parenthesis doesn't correspond to any elements in the algorithm.\n\n2. Why does objective (1) incorporate a discounted log-likelihood? This suggests that the policy in later time steps has less impact on the likelihood objective. It raises the question: Would a Markov Decision Process (MDP) with a finite horizon be more consistent with the current objective?\n\n3. The $\\delta$ present in gradients (6) and (7) is not defined anywhere in the paper. It would be beneficial to provide an explicit definition or reference for this term."
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "6: marginally above the acceptance threshold"
            },
            "confidence": {
                "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
            },
            "code_of_conduct": {
                "value": "Yes"
            },
            "first_time_reviewer": {
                "readers": [
                    "ICLR.cc/2024/Conference/Program_Chairs",
                    "ICLR.cc/2024/Conference/Submission1396/Senior_Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission1396/Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission1396/Reviewer_Eje2"
                ]
            }
        },
        "number": 1,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission1396/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1697362343795,
        "cdate": 1697362343795,
        "tmdate": 1700704016021,
        "mdate": 1700704016021,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "KzHWc57TGY",
        "forum": "bJ3gFiwRgi",
        "replyto": "bJ3gFiwRgi",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission1396/Reviewer_byVV"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission1396/Reviewer_byVV"
        ],
        "content": {
            "summary": {
                "value": "The paper studies the meta inverse reinforcement learning problems in the constrained MDP. The paper proposes an approach that first learn meta-priors over reward functions and constrains from related tasks and then adapt the learned prior to new tasks with few expert demonstration. The problem is formulated as a bi-level optimization problem, where the upper level learns the prior on the reward functions and the lower level learns the prior on the constraints. The paper shows that the algorithm reaches the $\\epsilon$-station points at $O(1\\epsilon^2)$ and quantify the generalization error to new tasks. The theoretical results are supported empirically."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "3 good"
            },
            "contribution": {
                "value": "3 good"
            },
            "strengths": {
                "value": "- The paper proposes a theoretical framework for  meta inverse constrained reinforcement learning, which extends previous study on meta \n inverse reinforcement learning and inverse constrained reinforcement learning.\n- The theoretical study is solid. The paper shows the convergence guarantee of the proposed algorithm. Then, the paper studies the generalization error for a new arbitrary task.\n- The paper provides empirical study on the algorithm in two settings: navigation with obstacles in AR and mojoco experiments, showing that M-ICRL performs better than other methods.\n- The paper provides a clear presentation on its study, with a detailed discussion on the challenges and the approach."
            },
            "weaknesses": {
                "value": "- The paper is an extension of meta IRL and ICRL. Building upon these, the contribution of the study is not significant.\n- The paper only shows the convergence to $\\epsilon$-FOSP, whose optimality is not discussed. Convergence of gradient-based algorithms to stationary point is not a novel contribution.\n- Assumption 1 assumes that the reward function and the cost function are bounded and smooth up to the fourth order gradient, which is a strong assumption, especially for neural networks with ReLU activation and unbounded state-action space."
            },
            "questions": {
                "value": "See weaknesses for details."
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "6: marginally above the acceptance threshold"
            },
            "confidence": {
                "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        },
        "number": 2,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission1396/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698633173943,
        "cdate": 1698633173943,
        "tmdate": 1699636067303,
        "mdate": 1699636067303,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "aeFh67FgF9",
        "forum": "bJ3gFiwRgi",
        "replyto": "bJ3gFiwRgi",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission1396/Reviewer_NXcx"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission1396/Reviewer_NXcx"
        ],
        "content": {
            "summary": {
                "value": "In this work, the authors optimize the ability of inverse constrained reinforcement learning (ICRL) to learn the reward and constraint(s) for a new task by meta-learning reward and constraint function priors over multiple similar tasks. The ICRL problem is formulated as a bi-level optimization, as proposed by [1], and then the authors provide a way to meta-learn the priors efficiently through empirical approximations and iterative techniques. ICRL is a growing field, and being able to perform ICRL more efficiently across new tasks is definitely relevant and useful. The proposed approach could be slightly mis-formulated (as explained later in weaknesses), but is theoretically well-analyzed and has promising experimental results."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "3 good"
            },
            "contribution": {
                "value": "3 good"
            },
            "strengths": {
                "value": "1. Extensive theoretical analysis about the approximation errors and (approximate) convergence result\n2. The baselines clearly demonstrate the effectiveness of the approach since the proposed method can learn a good meta-prior over several tasks, and thus performs well when tested later\n3. Successful real world experiments"
            },
            "weaknesses": {
                "value": "1. The lower level optimization (as explained in Equation 11, Appendix A.1) maximizes the reward and causal entropy objective while matching the constraint feature expectations. On the other hand, the authors of [1] formulate the optimization as a maximization of the causal entropy while matching reward feature expectations and expected cumulative costs. The slight difference is that [1] has an additional Lagrange multiplier term $\\lambda$ in the dual formulation (see [1], page 4, below remark 2, in the definition of $G$). In this work, since the constraint feature expectations are directly matched, the overall form of the lower level objective $G$ (Appendix, equation 12) is not exactly the same as [1]. This is also apparent in the constrained soft Bellman policy definition adapted from [1] (no $\\lambda$ in the constrained policy for this work, whereas there is a $\\lambda$ in the constrained policy as described in [1], page 2, Appendix). The outcome is that the constraint function is just treated as a negative reward term that can be just added to the original reward and thus, constrained RL just amounts to running RL with reward $r-c$ (Appendix A.2 of this work also says this). I am not sure this is representative of typical constrained RL problems, since typically it is not possible to rewrite a constrained RL problem as an unconstrained RL problem with a different reward. (maybe the authors can elaborate on this)\n2. What if several demonstrations are available for each task? If more demonstrations are available, ICRL could perform better and the gap between M-ICRL & ICRL could be lesser. M-ICRL should still perform better, since it has a better meta-prior, but overall it would be useful to understand the empirical improvement of M-ICRL over ICRL as the number of demonstrations vary."
            },
            "questions": {
                "value": "1. While Equation 12 (Appendix A.1) is the dual of Equation 11, if the domain is extended from linear constraint functions to non-linear constraint functions, the equation would no longer behave as the dual of the original problem as formulated in Equation 11, right? Does it make sense to use this as the lower level problem, in that case?\n2. (Suggestion) more ablations (eg. empirical effect of $\\alpha$, batch size $B$, number of gradient descent steps $K$, etc.) can be performed. Also, are these values specified somewhere in the paper?\n3. (Suggestion) Notation can be slightly confusing at some places, so I would suggest mentioning in the algorithms what the inputs and the outputs are, in words (eg. meta-priors, etc.). Implicit hyperparameters should also be mentioned in the beginning of the algorithm, eg. $\\alpha$, $B$, etc. what do these refer to, in the algorithm?\n\n**References**\n1.  Distributed inverse constrained reinforcement learning for multi-agent systems, Liu & Zhu (2022)\n\n**Updates**\nIncreased score from 5->6 (22 Nov)"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "details_of_ethics_concerns": {
                "value": "_"
            },
            "rating": {
                "value": "6: marginally above the acceptance threshold"
            },
            "confidence": {
                "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
            },
            "code_of_conduct": {
                "value": "Yes"
            },
            "first_time_reviewer": {
                "value": "Yes",
                "readers": [
                    "ICLR.cc/2024/Conference/Program_Chairs",
                    "ICLR.cc/2024/Conference/Submission1396/Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission1396/Reviewer_NXcx",
                    "ICLR.cc/2024/Conference/Submission1396/Senior_Area_Chairs"
                ]
            }
        },
        "number": 3,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission1396/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698910659587,
        "cdate": 1698910659587,
        "tmdate": 1700686544223,
        "mdate": 1700686544223,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "Wh47hhszE6",
        "forum": "bJ3gFiwRgi",
        "replyto": "bJ3gFiwRgi",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission1396/Reviewer_5qhh"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission1396/Reviewer_5qhh"
        ],
        "content": {
            "summary": {
                "value": "This paper extends the inverse constrained RL problem studied in (Liu & Zhu 2022) to the meta-learning setting where authors propose to first learn meta priors over reward/cost functions from similar tasks and then adapt the priors to new task via few-shot learning. This problem is then formulated using the bi-level optimization which is intractable in general. Authors propose novel approximate methods to solve the formulated bi-level optimization problem and quantify the approximation errors. Both physical and numerical experiments are conducted to demonstrate the effectiveness of the proposed method."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "3 good"
            },
            "contribution": {
                "value": "3 good"
            },
            "strengths": {
                "value": "1. The author proposed a new setting which is based on the inverse constrained RL problem (Liu & Zhu 2022) and the meta RL/IRL (Xu et al 2019). It is a creative combination of existing ideas.\n\n2. The paper is well-written with the main ideas, algorithms, theories and experiments well presented.\n\n3. The demonstration using the physical experiment on drone navigation makes the proposed method more convincing."
            },
            "weaknesses": {
                "value": "See questions."
            },
            "questions": {
                "value": "1. In terms of novelty, it would be helpful for readers if authors can emphasize the unique novelty and challenges of solving meta inverse constrained RL beyond simply combining the techniques in the inverse constrained RL problem studied in (Liu & Zhu 2022) and the meta RL/ICRL studied in (Xu et al 2019; Rajeswaran et al 2019)? \n\n2. There is a related work \n\n\"A CMDP-within-online framework for Meta-Safe Reinforcement Learning, Vanshaj Khattar, et al, ICLR, 2023\" \n\nwhich studies the meta learning for the constrained RL. What is the similarity and differences between authors' methodology compared with their works in terms of how to deal with constraints and meta-learning? It is important to add such comparisons in the paper. \n\n3. Can authors further explain why the regularization term ||\\eta - \\omega||^2 in equation (3) is required for the M-ICRL problem?\n\n4. The formulated M-ICRL is a complicated formulation, and the proposed approximate methods further increases the complexity of the algorithm. Can authors summarize the tricks in the implementation level to achieve the reported good results? This is helpful for the future researchers who want to extend this paper."
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "details_of_ethics_concerns": {
                "value": "N/A"
            },
            "rating": {
                "value": "6: marginally above the acceptance threshold"
            },
            "confidence": {
                "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        },
        "number": 4,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission1396/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1699228635163,
        "cdate": 1699228635163,
        "tmdate": 1699636067132,
        "mdate": 1699636067132,
        "license": "CC BY 4.0",
        "version": 2
    }
]