[
    {
        "id": "gaBeNpCd5w",
        "forum": "eG9AkHtYYH",
        "replyto": "eG9AkHtYYH",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission3500/Reviewer_CLpu"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission3500/Reviewer_CLpu"
        ],
        "content": {
            "summary": {
                "value": "The authors propose a new approach to sparse attention in large language models called SEMSA (Semantic Sparse Attention). \n\nThe authors argue that uniform sparse attention masks can lead to suboptimal performance, and instead propose optimizing different attention masks for different heads. \n\nEmpirically, the authors evaluate SEMSA on several benchmark datasets and show speedups with small accuracy loss, and that the learned masks capture meaningful semantic information. The authors show that it outperforms other sparse attention methods in terms of sparsity, speedup, and accuracy."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "3 good"
            },
            "contribution": {
                "value": "2 fair"
            },
            "strengths": {
                "value": "1. The paper is well written and the presentation of the idea is clear and straightforward to follow."
            },
            "weaknesses": {
                "value": "1. The author claims that they achieved speedup with negligible loss in accuracy, but table 1 says otherwise. \n\n2. The speedup achieved by the proposed method is also somewhat unimpressive as SemSA can barely have any advantage over exact attention speedup methods like FlashAttention (as shown in Table 3).\n\n3. Table 1 evaluation is only limited to Wiki dataset. \n\n4. To argue for the superiority of SemSA, I believe the author should show the current landscape of acc/ppl vs efficiency tradeoff in sparsifying the attention and how SemSA breaks out of the current Pareto Frontier. Current experiments either show speedup or efficiency but do not systematically characterize the tradeoff."
            },
            "questions": {
                "value": "1. There is a tradeoff between ppl and efficiency. Figure 6 does not capture the tradeoff and is misleading in the sense that it's not clear the price that the authors paid to get such a speedup. Is it possible to juxtapose accuracy metrics with any efficiency metric in the efficiency evaluation?\n\n2. \"From Table 6.3, we can see that\nour kernels can consistently achieve higher end-to-end first-token-speedups on different models and\nwith different token lengths.\"\nWhere is table 6.3?"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "3: reject, not good enough"
            },
            "confidence": {
                "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        },
        "number": 1,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission3500/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698262500692,
        "cdate": 1698262500692,
        "tmdate": 1699636303638,
        "mdate": 1699636303638,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "7xYnHLnuFQ",
        "forum": "eG9AkHtYYH",
        "replyto": "eG9AkHtYYH",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission3500/Reviewer_1ev5"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission3500/Reviewer_1ev5"
        ],
        "content": {
            "summary": {
                "value": "This work introduces a gradient-based method for quantifying the impact of masking out elements of the attention matrix in a trained Transformer. Additionally, the method generates attention pruning masks to improve the speed of the attention layer in the Transformer model. The effectiveness of the proposed method has been evaluated on 7B LLMs, resulting in attention wall-time speedup ranging from 4.18 to 11.67 compared to dense PyTorch models."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "3 good"
            },
            "contribution": {
                "value": "2 fair"
            },
            "strengths": {
                "value": "Formalizing the attention pruning task as an optimization problem is meaningful and generalizable, as it can be applied to different models and tasks. \n\nThe proposed method focuses on creating block-sparse masks rather than element-sparse masks, which offers advantages in terms of hardware compatibility and overall speedup."
            },
            "weaknesses": {
                "value": "My main concern regarding this work pertains to its scope of comparison. I think this work falls under the category of pruning methods rather than sparse attention construction, warranting a direct comparison with existing pruning methods. Gradient-based pruning methods [1] aim to estimate the importance of pruning units using gradient-based scores and then prune the least important ones. Equation 2 in this work can be derived from the commonly used form in gradient-based pruning methods. While the generation of block-sparse attention masks shares the same spirit with structural pruning, such as block pruning in [2], I am not saying that the novelty of this work is limited, but the scope could be discussing pruning techniques.\n\nIf we consider this work as a pruning study, comparisons with SpTrans and Bigbird may be insufficient. In addition, comparing the acceleration with Flash Attention and xFormer is also indirect, and it would be more relevant to compare it with other pruning methods.\n\n[1] Accelerating Attention through Gradient-Based Learned Runtime Pruning \n[2] Block Pruning For Faster Transformers"
            },
            "questions": {
                "value": "Section 5 discussed the SRAM and said the implementation is based on Flash attention, so my understanding is that the implementation has already considered the IO of the attention layer. Is it correct?"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "5: marginally below the acceptance threshold"
            },
            "confidence": {
                "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        },
        "number": 2,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission3500/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698577890940,
        "cdate": 1698577890940,
        "tmdate": 1699636303531,
        "mdate": 1699636303531,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "zk7FAUTDwL",
        "forum": "eG9AkHtYYH",
        "replyto": "eG9AkHtYYH",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission3500/Reviewer_xq6q"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission3500/Reviewer_xq6q"
        ],
        "content": {
            "summary": {
                "value": "This paper proposes a sparse attention method that calculates the importance of each attention element/block by estimating the loss change when masking that position. This method improves performance over previous baselines while maintaining speedup. This paper experiments on language modeling tasks and application tasks like code completion, and document qa."
            },
            "soundness": {
                "value": "2 fair"
            },
            "presentation": {
                "value": "2 fair"
            },
            "contribution": {
                "value": "2 fair"
            },
            "strengths": {
                "value": "1. The proposed method shows improvements over previous methods. If the proposal is indeed effective and open source, it will be used by many people."
            },
            "weaknesses": {
                "value": "1. Problematic theory: Attention effect evaluation is based on \\textit{untenable} assumptions, and the calculation may be \\textit{wrong}. First, only $\\delta$ approaches 0, we can use first-order Taylor expansion, but the change in attention after being masked is not small enough to be close to 0, so we can not derive formulas 2 and 4. Second, Formula 3 seems wrong. For the first part,  is the condition \"n=j\"? For the second part, the influences of other attention are wrong, it should be +1 but not -1.  Therefore, Formula 5 which is a combination of Formula 3 and Formula 4 is questionable.\n\n2. Problematic speedup: Since this method generates masks for each sequence and each layer, the method does not only need to calculate the full attention matrix but also needs to calculate gradients even during the forward pass.  So I doubt whether we can reduce latency using this method.\n\n3. This paper is not easy to follow. For example,  what do you mean by \"mean attention matrix\" in Figure 5; Formula 6 is complicated but lacks descriptions; Section 4 is orthogonal to other parts, i.e., sparse attention method.  The title is more suitable for calling it a sparsization method based on the loss influence of attention masks.\n\n4. This paper needs to perform more comparisons, refer to \"Questions\"."
            },
            "questions": {
                "value": "1.  We would like to the the overall latency beyond attention speedup if we want to apply this technique.\n\n2. \"Explicit Sparse Transformer, Axiv 2019\" has proposed a top-k sparse attention method, which is a simplified version of this paper. Therefore, this paper needs to compare it.\n\n3. Does your performance drop actually come from the continual training on llama but your method?\n\n4. Why not test on longer sequences?\n\n5. Can you compare your findings on functional heads with studies in the age of Bert? Why is the surprise the semantic sparse attention is hidden in LLMs, is it hidden in all transformers?"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "3: reject, not good enough"
            },
            "confidence": {
                "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        },
        "number": 3,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission3500/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698951845171,
        "cdate": 1698951845171,
        "tmdate": 1699636303431,
        "mdate": 1699636303431,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "5WSlxkFYfs",
        "forum": "eG9AkHtYYH",
        "replyto": "eG9AkHtYYH",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission3500/Reviewer_xR4c"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission3500/Reviewer_xR4c"
        ],
        "content": {
            "summary": {
                "value": "There are two mainstream approaches to achieve sparse attention. One approach is to manually design a uniform sparse attention mask for all attention heads. Another approach is to use sparse masks to skip some attention computations.\n\nThe paper proposed to learn a different sparse patterns/masks for different heads, by solving an optimization problem to minimize the loss change when switch to a sparse attention method. It achieves 1.27x to 1.6x higher sparsity while maintaining the accuracy."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "4 excellent"
            },
            "contribution": {
                "value": "4 excellent"
            },
            "strengths": {
                "value": "The paper proposed a new way to employ sparse attention: using different sparse patterns for different heads. It optimizes the loss between using dense and sparse attentions to learn the sparse attention masks.\n\nThe paper adds a new approach and demonstrate good empirical results with state-of-the-art models. It also provides interesting analysis. For example, one experiment demonstrate how the different patterns for different layers/heads outperforms single attention pattern for the whole model."
            },
            "weaknesses": {
                "value": "The optimization to learn the sparse patterns required an already trained model. So the sparse attention cannot be applied at pre-training stage when a new model is trained from scratch."
            },
            "questions": {
                "value": "Questions:\n  - How the density bound d_t is chosen? How much is the density bound in the experiments."
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "5: marginally below the acceptance threshold"
            },
            "confidence": {
                "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
            },
            "code_of_conduct": {
                "value": "Yes"
            },
            "first_time_reviewer": {
                "readers": [
                    "ICLR.cc/2024/Conference/Program_Chairs",
                    "ICLR.cc/2024/Conference/Submission3500/Senior_Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission3500/Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission3500/Reviewer_xR4c"
                ]
            }
        },
        "number": 4,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission3500/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1699513132184,
        "cdate": 1699513132184,
        "tmdate": 1699644565213,
        "mdate": 1699644565213,
        "license": "CC BY 4.0",
        "version": 2
    }
]