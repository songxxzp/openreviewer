[
    {
        "id": "rBEZ40nuyt",
        "forum": "eCGpNGDeNu",
        "replyto": "eCGpNGDeNu",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission5280/Reviewer_3ipu"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission5280/Reviewer_3ipu"
        ],
        "content": {
            "summary": {
                "value": "This work addresses the challenge of learning a robust World Model in a task-agnostic setting, i.e., without the supervision of any reward distribution. For this matter, it formulates the problem as a minimax regret objective and proves that, under assumptions of learnability of the optimal policy (under reward supervision) and existence of a latent dynamics that models the real environment, the regret of a optimal \u201cWorld Model\u201d policy is bounded and depends on the state-action distribution and the total variation between the learnt latent and the true dynamics. Based on that, the paper introduces WAKER, an agent that actively samples environments to generate a reward-free curricula in order to learn a robust World Model. Experiments show that WAKER outperforms domain randomization in robustness and out-of-distribution settings."
            },
            "soundness": {
                "value": "2 fair"
            },
            "presentation": {
                "value": "3 good"
            },
            "contribution": {
                "value": "4 excellent"
            },
            "strengths": {
                "value": "- The work introduces the setting of generating task-agnostic curricula for learning robust world models, arguing that this direction may help learning generally-capable agents, which is an interesting perspective with good motivation. Furthermore, the paper is well written and didactic.\n- The paper mathematically formalizes learning robust World Models under a framework of minimax regret and proves a regret bound for optimal policies under learned World Models. For this, it clearly states the assumptions and presents the proof. The theoretical development is sound and clear. \n    - Furthermore, the derivation starting from the theoretical framework and arriving into the proposed learning agent (WAKER) is clever and well presented.\n\n- The experimental setting shows the effectiveness of WAKER in robust and OOD evaluation settings in comparison with the random sampling approach (DR). It also ablates the exploration policy and shows an interesting and interpretable illustration of the generated curricula."
            },
            "weaknesses": {
                "value": "- The proposed learning objective (and, therefore, learning agent) relies on a strong assumption that seems to be overlooked (or at least not discussed with appropriate depth): the \u201ccapacity\u201d of the exploration policy to cover the full state-action distribution. Equivalently, the relaxation of the bound by introducing an exploration policy is a big assumption and limits the generality of the proposed agent. It is questionable whether a single intrinsically-motivated policy could explore regions of the state-action space associated with high rewards for locomotion gaits (as in the walker scenario) with terrain variability, for instance.\n\n- Regarding \u201cZero-Shot Task Adaptation\u201d: The presented methodology for learning task-specific policies relies on the acquired dataset \u201cD\u201d to train the reward predictor. Nevertheless, this raises a similar problem to the previous concern: if D does not contain the state-action pairs associated with high rewards for a particular task, then the learned policy might be potentially very suboptimal. If the work relies on Assumption 1 to disregard this problem, then it should be clearly stated in the paper, but I believe that this would make Assumption 1 unreasonable.\n\n- In Figure 6 and 10, I understood that the prediction error is computed as the mean squared error on the pixel values. If this is indeed the case, it is questionable if this is the best metric to evaluate the prediction error. Furthermore, collecting the test set by sampling a random policy will omit part of the state space, and likely very relevant states (i.e., associated with high rewards in an optimal policy for locomotion). Therefore, the results are not quite convincing. I recommend trying to use the underlying physics of the simulator as a \u201ctrue latent\u201d dynamics and compute the distance from it.  Another possibility is to learn a separated embedding space (via metric learning or autoencoding) and use it as the ground truth representation. Additionally, I also recommend learning optimal policies for several different environments and use the history of policies generated during training to sample from the space. This would give a more complete covering of the state-action distribution.\n\n\n**Summary of the Review**:\n\nOverall, I believe the paper provides solid contributions, for introducing a new setting, and also providing a sound theoretical framework and cleverly translates it to a learning algorithm. Nevertheless, the introduction setting must consider the challengings of covering the state-action distribution correctly, which was overlooked in the paper. Furthermore, the experiments regarding model prediction error can be improved to be convincing.  From my perspective, concerns 1 and 2 should be addressed by clarifying these limitations in the paper. Concern 3 can be addressed by the suggestions in the experimental setting. *I will recommend acceptance if these concerns were addressed.*"
            },
            "questions": {
                "value": "- Following my second concern, does Assumption 1 imply that the learned latent dynamics will have support in the full state-action distribution? \n\n- Following my third concern, is the image prediction error indeed computed on pixel-based mean-squared error?\n\n\n====================== **POST-REBUTTAL** =======================\n\nI would like to thank the authors for putting efforts on the rebuttal discussion and addressing concerns. I believe my concerns were partially addressed, and, as a consequence, I am leaning towards acceptance of the paper (5 -> 6). Overall, as described in my initial review, my main concerns are related to the assumptions that the work is built upon. Although I still believe they are strong and limit the applicability of the method in harder scenarios, I also understand that these assumptions are present in previous work and the authors updated the work to highlight these as potential limitations, improving transparency.\n\nIn more details:\n\n- For my first point: the authors addressed the concern as possible, and showed average returns to provide evidence that, for the particular tasks in the paper, this was not a problem.\n\n- For my second point: similarly, they provided discussion on the limitations and clarified my question. \n\n- For my third point: I think it was partially addressed. The paper now provides evidence under a performant policy (rather than random policy) which substantially supports the validity of the experiments. I still have my concerns of using MSE as a predictive metric (and how much semantic value it brings). Nevertheless, I understand that it would indeed require an inverse mapping between image and true physics simulator state, which does not seem easy to obtain as mentioned."
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "6: marginally above the acceptance threshold"
            },
            "confidence": {
                "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
            },
            "code_of_conduct": {
                "value": "Yes"
            },
            "first_time_reviewer": {
                "readers": [
                    "ICLR.cc/2024/Conference/Program_Chairs",
                    "ICLR.cc/2024/Conference/Submission5280/Senior_Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission5280/Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission5280/Reviewer_3ipu"
                ]
            }
        },
        "number": 1,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission5280/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698354116751,
        "cdate": 1698354116751,
        "tmdate": 1700657899442,
        "mdate": 1700657899442,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "FVLgpFGObd",
        "forum": "eCGpNGDeNu",
        "replyto": "eCGpNGDeNu",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission5280/Reviewer_hsNK"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission5280/Reviewer_hsNK"
        ],
        "content": {
            "summary": {
                "value": "The work presents an approach for unsupervised environment design in a reward-free setting, using world models and based on the idea of minimax regret. By adopting WAKER, the agent samples environments based on the expected world model error, which is approximated using an ensemble of dynamics models."
            },
            "soundness": {
                "value": "4 excellent"
            },
            "presentation": {
                "value": "4 excellent"
            },
            "contribution": {
                "value": "3 good"
            },
            "strengths": {
                "value": "* **Presentation**: the paper is well-written and the presentation is clear and clean. The metrics plotted in the Results section are sensible and the empirical results well reflect the story of the work.\n* **Method**: the idea behind this work is innovative and well-motivated. Given the absence of previous work in this specific setting, I think the method will be useful for future work. The results also corroborate the usefulness of the approach."
            },
            "weaknesses": {
                "value": "* **Breaking assumptions in implementation**: I think the approach is well-motivated theoretically. However, in practice, the authors adopted a world model implementation that learns the dynamics using a recurrent module. By exploiting memory, the model is not encouraged to learn a Markovian latent state space. Given this is one of the assumptions behind the work, I think the authors should have opted for a memoryless model (e.g. learning from sequences of data but without keeping a memory) or they should make clear that their implementation is possibly breaking the assumptions (despite providing the expected improvements in practice)"
            },
            "questions": {
                "value": "* In [1], the authors present the \"latent dynamics discrepancy\" metrics to evaluate the world model's misspecification when trained in reward-free settings and show how it correlates with downstream task performance. I think the idea behind this metric is relevant to the latent dynamics error used here and might be worth discussing in related work or exploring the way it is used in [1] for future work\n* In Assumption 2, the authors talk about \"modelling the real environment exactly\", why what matters for the model is actually that the expected rewards are consistent along the distribution of state-actions visited by the actor. I suggest finding a better wording for that.\n* The approach seems to work well in cases where the set of parameters $\\theta$ for the environment's design is discrete/small. I recommend discussing how to extend the work for continuous sets of parameters, as this may require further approximations.\n\nTypos/writing suggestions:\n- in Preliminaries, there is a $\\Delta(X)$ which I think should be $\\Delta(S)$\n- In section 3.1, \"Futhermore\"\n\n[1] Rajeswar et al, 2023, Mastering the Unsupervised Reinforcement Learning Benchmark from Pixels\n\n**Post rebuttal** : the authors have clarified their implementation choices and addressed my concerns. They also extended their evaluation, according to some other reviewers' suggestions. Now, I feel more confident about recommending acceptance for the paper and I have updated my score to reflect this."
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "8: accept, good paper"
            },
            "confidence": {
                "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
            },
            "code_of_conduct": {
                "value": "Yes"
            },
            "first_time_reviewer": {
                "value": "Yes",
                "readers": [
                    "ICLR.cc/2024/Conference/Program_Chairs",
                    "ICLR.cc/2024/Conference/Submission5280/Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission5280/Reviewer_hsNK",
                    "ICLR.cc/2024/Conference/Submission5280/Senior_Area_Chairs"
                ]
            }
        },
        "number": 2,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission5280/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698600653731,
        "cdate": 1698600653731,
        "tmdate": 1700665535358,
        "mdate": 1700665535358,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "R8n84jTf7f",
        "forum": "eCGpNGDeNu",
        "replyto": "eCGpNGDeNu",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission5280/Reviewer_VCF1"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission5280/Reviewer_VCF1"
        ],
        "content": {
            "summary": {
                "value": "This work considers the problem of pretraining a world model on reward-free data using a learned exploratory policy, and subsequently using the learned model to train task-specific policies (using a provided reward function) without any additional model learning. The key difference between this work and prior work is the strong focus on learning models that are *robust*: designing curricula for learning world models in the presence of multiple environment variations such that downstream policies learned using the model are more likely to generalize to unseen environment variations. The paper starts by treating the problem formally, then introduces a practical algorithm -- WAKER -- motivated by theoretical insights, and then compares the \"robustness\" of learned world models on OOD environment variations in a number of simulated environments."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "4 excellent"
            },
            "contribution": {
                "value": "2 fair"
            },
            "strengths": {
                "value": "- The paper is very well written, and provides sufficient background for readers unfamiliar with the problem to appreciate their theoretical result (Proposition 1). The theoretical treatment is not particularly surprising in itself, but helps motivate the proposed method which I appreciate. Assumptions are clearly stated (perfect model and latent policy exists), which seem pretty reasonable to make for the sake of analysis.\n- The proposed method is intuitive and appears to be fairly straightforward to implement. I consider this a strength.\n- Experiments are conducted on a reasonably large amount of tasks, which makes the results fairly trustworthy overall despite similar results for methods on many of the individual tasks. The proposed method achieves the most significant gains in the OOD evaluations, as one would expect based on the derivation of the algorithm."
            },
            "weaknesses": {
                "value": "I have three concerns at the moment:\n\n- **Contributions.** While I really do consider simplicity a strength, the proposed method is undeniably incremental. At surface level, the main algorithmic contribution is automatic curricula by sampling of environments for which the current model error is large, which -- again, at surface level -- has been explored in numerous prior works as a means of guiding e.g. exploration, curricula for which rewards are available, gradient updates, or as model regularization (I will omit references to specific works here to avoid propagating my own biases, since I believe that the authors are aware of the literature, but can provide some during the discussion period if requested). This is in my opinion not a big problem given differences in problem setting as well as some of the more intricate algorithm details and theoretical contributions, but seems worth bringing up.\n- **Experimental design.** It is evident from the empirical results that performance between WAKER and domain randomization is fairly similar for in-domain environment variations, and that most of benefit from the WAKER curricula is in the OOD test environments (Figure 4, Figure 13). However, this appears to mainly be because (1) the task variations considered have a natural order of difficulty (e.g. number of objects or terrain amplitude), (2) WAKER strongly favors sampling more difficult tasks (e.g. max allowed number of objects), and (3) the OOD variations considered here are formulated such that they are most similar to the task variations favored by WAKER (e.g. max possible number of training objects + 1). Therefore, it is not clear whether the models learned by WAKER really are robust or simply converge on a data distribution that is more favorable in these particular test environments.\n- **Baselines.** The authors claim that there are no applicable baselines besides a naive domain randomization baseline that uniformly samples environment variations. However, there are several other manually designed curricula that would be very useful for validating the necessity for automatic curricula: (1) a baseline that strongly favors sampling the most difficult environments, (2) a baseline that is trained **only** on the most difficult environment, and (3) a baseline that performs automatic domain randomization by initially sampling from a small range of environments and gradually increases the range of sampled values (similar to ADR from https://arxiv.org/abs/1910.07113). Baselines 1 and 2 require some domain knowledge in that they need to know which environments are likely to be difficult (could be used as an oracle), but baseline 3 could easily be implemented without any domain knowledge by growing number of environments based on a linear schedule. It seems disingenuous to claim that there are no existing curriculum methods that would be applicable to this problem setting."
            },
            "questions": {
                "value": "I'd like the authors to address my questions and suggestions provided in the *weaknesses* section above. Addressing those comments are most likely to change my opinion. I have one additional clarification questions, though:\n- The reward-free MDP introduced in Sec 2 is defined as a tuple that exclude the reward function R (as opposed to the standard MDP) but still includes a discount factor. What is the role of the discount factor in the reward-free setting, if any? Is this just for notational convenience in Sec 3?\n\n\nLastly, typo:\n- P4, below Eq. 3: according the MDP\n\n**Post-rebuttal:** I believe that the authors have addressed my biggest concerns, and I raise my score (5 -> 6) and confidence (3 -> 4) accordingly."
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "6: marginally above the acceptance threshold"
            },
            "confidence": {
                "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
            },
            "code_of_conduct": {
                "value": "Yes"
            },
            "first_time_reviewer": {
                "readers": [
                    "ICLR.cc/2024/Conference/Program_Chairs",
                    "ICLR.cc/2024/Conference/Submission5280/Senior_Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission5280/Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission5280/Reviewer_VCF1"
                ]
            }
        },
        "number": 3,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission5280/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698812821368,
        "cdate": 1698812821368,
        "tmdate": 1700629232926,
        "mdate": 1700629232926,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "xfFV6zxLLI",
        "forum": "eCGpNGDeNu",
        "replyto": "eCGpNGDeNu",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission5280/Reviewer_j9LV"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission5280/Reviewer_j9LV"
        ],
        "content": {
            "summary": {
                "value": "This paper tackles the problem of learning world models through reward-free interactions that are robust to environments variations. First, it formulates the learning problem in terms of minimization of the minimax regret. Then, it proves that the problem formulated is equivalent to minimizing the expected error of the world model in the class of environments under an exploration policy. Hence, it designs an algorithm, called WAKER, to actively sample the environments on which the world model is trained on. Finally, it provides an empirical evaluation of the proposed approach in challenging domains, especially showing its superiority against naive domain randomisation."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "2 fair"
            },
            "contribution": {
                "value": "2 fair"
            },
            "strengths": {
                "value": "- (Relevance) The paper tackles a very relevant problem, which is learning a robust model of the world from reward-free interactions with a class of environments;\n- (Originality) The paper contributes some nice ideas, such as considering the model error in expectation under the worst-case policy."
            },
            "weaknesses": {
                "value": "- (Presentation) The first part of the paper seems to set a very ambitious goal, which is to tackle the general problem of learning a model of a class of environments that allows to approximately solve any RL task within the class. I would rather present a narrower scope of extending domain randomisation to reward-free settings through a model-based approach;\n- (Strong assumptions) The set of assumptions does not look completely reasonable. Especially assuming the knowledge of a decoder that maps every environment to an MDP on latent states and a planning oracle for a setting that is essentially POMDP;\n- (Empirical evaluation) Despite the very general problem formulation, the proposed algorithm is evaluated in very structured domains, where the variation between environments and tasks is fairly limited. Moreover, the set of baselines basically counts different variations of the proposed algorithm, without a real external competitor;\n- (Limited theoretical contribution) The paper sells the theoretical characterization of the problem as an important contributions, but there is not much in terms of novel theoretical results.\n\nThis paper proposes an interesting model-based algorithm for domain randomisation in reward-free settings, which is arguably very relevant given the recent advancements in reward-free RL (in a single MDP) and robust RL/domain randomization. However, while the WAKER algorithm looks like a reasonable approach, from the provided empirical evaluation it is hard to say whether the procedure can actually work when facing more diverse classes of environments. Moreover, I think the presentation is not great for this work: The wording of the first sections seems to imply a substantial theoretical contribution, while the actual contribution is essentially an heuristic algorithm. For these reasons, I am currently providing a slightly negative evaluation. I am open to raise my score if the authors can convince me that the proposed algorithm can actually work with reasonable efficiency and the presentation can be reworked to narrow the scope to \"model-based domain randomisation with active training\". I report more detailed comments below.\n\n(C1) The provided formulation of the problem is reasonable and clear, but the paper is overselling that contribution in my opinion. Everything that is said in the first sections is already known for a single environment (especially that the sub-optimality gap of a planning policy can be upper bounded with the approximation error on the transition model). The paper claims to extend that for multiple environments, but the extension become almost straightforward when the paper assumes the existence of a decoder from any of the environment to a single MDP on a latent state representation.\n\n(C2) The regret definition in Eq. 1 is also reasonable, even though it is mostly a generalization gap rather than an online learning regret, but not really novel (e.g., Chen et al., Understanding domain randomization for sim-to-real transfer, 2022). The $\\pi^\\star_{\\text{regret}}$ has also been formulated before under the name of \"domain-randomization policy\" (Chen et al., 2022) or \"Bayes-optimal policy\" (e.g., Ghavamzadeh et al., Bayesian reinforcement learning: A survey, 2015).\n\n(C3) The paper essentially assumes a planning oracle for POMDPs (Assumption 1) as the original problem is a POMDP. This is not uncommon, but it is hardly reasonable, as the original problem is arguably computationally hard (Lusena et al., Nonapproximability results for partially observable Markov decision processes, 2001).\n\n(C4) How can the representation model q be implemented? The requirement defined in Assumption 2, i.e., that a set of partially observable environments can be captured into a single MDP over a latent states, looks really strong.\n\n(C5) The paper says the \"aim is to train the world model such that the policies obtained are robust, as measured by minimax regret. However, we cannot directly evaluate regret as it requires knowing the true optimal performance.\" Is instead evaluating the regret against a world model trained for the test environment a reasonable \"ideal\" target?\n\n(C6) The notion of policy is never defined, which makes unclear whether the paper refers to Markovian policies or general history-dependent policies."
            },
            "questions": {
                "value": "Can the authors address my comments above?"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "5: marginally below the acceptance threshold"
            },
            "confidence": {
                "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        },
        "number": 4,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission5280/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1699098160264,
        "cdate": 1699098160264,
        "tmdate": 1699636527680,
        "mdate": 1699636527680,
        "license": "CC BY 4.0",
        "version": 2
    }
]