[
    {
        "id": "yRB7P3v0uI",
        "forum": "OIsahq1UYC",
        "replyto": "OIsahq1UYC",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission5779/Reviewer_hxZf"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission5779/Reviewer_hxZf"
        ],
        "content": {
            "summary": {
                "value": "This paper introduces Diffusion Generative Flow Samplers (DGFS), a neural-based sampling algorithm that utilizes diffusion models. DGFS draws heavy inspiration from GFlowNets (typically constrained to discrete data spaces) and offers a practical and scalable solution for sampling in continuous spaces. The primary message conveyed by this paper is that DGFS demonstrates the ability to leverage partial trajectory segments, thereby enabling a more efficient approach to the learning problem when compared to existing methods, which require learning over complete trajectories (from start to finish), as seen in denoising diffusion samplers (DDS). Consequently, DGFS can sample from target unnormalized probability distributions by updating its parameters during a time-dependent stochastic training process. In other words, it can do so without requiring a full trajectory specification and can accommodate intermediate signals injected between time steps before the sampling process is complete. To accomplish this, a neural network denoted as $F_n(\\theta)$ is trained to approximate the unnormalized density of the $n-th$ step.\n\nThe authors argue that DGFS should lead to more stable training, reduce variance in gradient computations, and ultimately provide access to informative intermediate training signals."
            },
            "soundness": {
                "value": "4 excellent"
            },
            "presentation": {
                "value": "3 good"
            },
            "contribution": {
                "value": "3 good"
            },
            "strengths": {
                "value": "- The paper is well-written, scientifically sound, and highly rigorous, featuring a compelling theoretical framework. The main text is effectively complemented by the appendix materials, which offer additional mathematical details and experimental results.\n\n- I particularly appreciate the table that discusses notation on the first page of the appendix. I believe this should be considered standard practice, as it greatly aids readers in navigating the mathematical content.\n\n- The paper extends the theory of GFlowNets to address sampling problems in continuous space. This extension holds significant relevance for numerous applications, especially in the field of physical and chemical sciences, where unnormalized target densities in continuous space are frequently encountered.\n\n- The concepts of leveraging information from partial trajectory paths and training intermediate layers offer benefits from both theoretical and practical standpoints."
            },
            "weaknesses": {
                "value": "- **Limited Experiments:** I consider the experiments presented in the paper to be its primary weakness. While the theory is well-presented and comprehensible, the experiments reported in the paper appear to fall short in terms of comparison with more sophisticated baseline methods, particularly in the context of flow-based samplers.\n\n- **Related Works:** Expanding the related work section to include discussions of prior research addressing similar problems, such as gradient variance reduction and efficient sampling of multimodal densities [1, 2, 3], would add significant value. More details are provided below."
            },
            "questions": {
                "value": "- On the bottom of page 5, the authors state, \"On the other hand, notice that our objectives in Equation 9 or Equation 14 do not require the training samples to follow any particular distribution (only have full support).\" While I believe that in the asymptotic regime of infinitely many samples this holds, it may not be true for practical cases with a finite number of samples. In such cases, amortized variational inference schemes might encounter issues, as discussed in recent works [4]. I'm interested in whether this assumption can be relaxed or if the authors can provide arguments for the general validity of the 'full support' assumption in their case.\n\n- In the discussion about Variance Gradient Updates (section 3.3A), the authors cite works like Roederer et al. (2017), which reported that the variance of the gradient does not necessarily vanish even when the optimal distribution is achieved. However, in Refs. [1,2], authors use information-theoretical arguments to demonstrate that the variance can indeed approach zero when the target distribution is perfectly learned, using the so-called path gradient method for normalizing flows. It would be interesting to see a comparison of DGFS with such a method (specifically designed for continuous normalizing flows in [2]). Additionally, given the discussion in Sec. 3.3A, it would be beneficial to include these references and expand the discussion.\n\n- The concept of injecting information between a sequence of transformations strongly reminds me of simulated annealing and annealed importance sampling (as seen in Stochastic Normalizing Flow [4,5]). Could the authors expand on this, highlighting the significant similarities and differences, if any? There appears to be a notable overlap worth exploring.\n\n- I'm interested in seeing how the lower bound estimator for the log partition function used in this work compares to the asymptotically unbiased estimator for the partition function proposed in [7,8].\n\n- As pointed out in the **Weaknesses** section, I'm curious about how the results for the many-well task compare to [3], which has reported notable results in data-free training for multimodal target densities for quantum chemical tasks as well as the many-well problem. \n\n**Side remark**: While I acknowledge the significant contribution and potential impact of the paper, I believe additional robust experimental evidence and a broader discussion, as outlined above, would strengthen its acceptance. Adding new baselines, particularly [2,3], to the comparison in Figure 2 and Table 1 would be a valuable addition to the paper.\n\n**Minor:**\n\n- Page 2: below eq (4) the authors state: \"It can be shown that the marginal distribution of P at the terminal time N is exactly proportional to the target \u03bc(\u00b7).\". While it might be self-evident to some, it might be helpful to provide a hint for an explicit derivation in the appendix.\n\n- Page 3: Above eq (7), the authors mention, \"[\u2026] stochastic optimal control formulation seen in prior works.\" It would be beneficial to include explicit references to these prior works.\n\n- Page 7: to the best of my knowledge, what the authors call \"Hamilton Monte Carlo\" is more often found in the literature as \"Hamiltonian Monte Carlo\".\n\n- Page 7: In the related work section, the authors might consider citing some of the references listed below, being relevant within the context of NF-based samplers. Notably, some of these references have shown how to derive an asymptotically unbiased estimator for the normalizing constant [7,8,9], also known as the partition function in the realm of Boltzmann distributions. This is a quantity of interest for the present work as well.\n\n**References:**\n\n- [1] [Vaitl, Lorenz, et al. \"Gradients should stay on path: better estimators of the reverse-and forward KL divergence for normalizing flows.\"\u00a0Machine Learning: Science and Technology\u00a03.4 (2022): 045006](https://iopscience.iop.org/article/10.1088/2632-2153/ac9455/pdf)\n- [2] [Vaitl, Lorenz, et al. \"Path-gradient estimators for continuous normalizing flows.\"\u00a0International Conference on Machine Learning. PMLR, 2022.](https://proceedings.mlr.press/v162/vaitl22a/vaitl22a.pdf)\n- [3] [Midgley, Laurence Illing, et al. \"Flow annealed importance sampling bootstrap.\"\u00a0arXiv preprint arXiv:2208.01893\u00a0(2022).](https://arxiv.org/pdf/2208.01893)\n- [4] [Wu, Hao, Jonas K\u00f6hler, and Frank No\u00e9. \"Stochastic normalizing flows.\"\u00a0Advances in Neural Information Processing Systems\u00a033 (2020): 5933-5944.](https://proceedings.neurips.cc/paper/2020/hash/41d80bfc327ef980528426fc810a6d7a-Abstract.html)\n- [5] [Caselle, Michele, et al. \"Stochastic normalizing flows as non-equilibrium transformations.\"\u00a0Journal of High Energy Physics\u00a02022.7 (2022): 1-31.](https://arxiv.org/pdf/2201.08862.pdf)\n- [6] [Nicoli, Kim A., et al. \"Detecting and Mitigating Mode-Collapse for Flow-based Sampling of Lattice Field Theories.\"\u00a0arXiv preprint arXiv:2302.14082\u00a0(2023).](https://arxiv.org/pdf/2302.14082)\n- [7] [Nicoli, Kim A., et al. \"Asymptotically unbiased estimation of physical observables with neural samplers.\"\u00a0Physical Review E\u00a0101.2 (2020): 023304.](https://link.aps.org/accepted/10.1103/PhysRevE.101.023304)\n- [8] [Wirnsberger, Peter, et al. \"Targeted free energy estimation via learned mappings.\"\u00a0The Journal of Chemical Physics\u00a0153.14 (2020).](https://pubs.aip.org/aip/jcp/article/153/14/144112/316574)\n- [9] [Nicoli, Kim A., et al. \"Estimation of thermodynamic observables in lattice field theories with deep generative models.\"\u00a0Physical review letters\u00a0126.3 (2021): 032001.](https://link.aps.org/pdf/10.1103/PhysRevLett.126.032001)"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "8: accept, good paper"
            },
            "confidence": {
                "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
            },
            "code_of_conduct": {
                "value": "Yes"
            },
            "first_time_reviewer": {
                "value": "Yes",
                "readers": [
                    "ICLR.cc/2024/Conference/Program_Chairs",
                    "ICLR.cc/2024/Conference/Submission5779/Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission5779/Reviewer_hxZf",
                    "ICLR.cc/2024/Conference/Submission5779/Senior_Area_Chairs"
                ]
            }
        },
        "number": 1,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission5779/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698161928468,
        "cdate": 1698161928468,
        "tmdate": 1700666199585,
        "mdate": 1700666199585,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "xXdH35OA4K",
        "forum": "OIsahq1UYC",
        "replyto": "OIsahq1UYC",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission5779/Reviewer_Tb6D"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission5779/Reviewer_Tb6D"
        ],
        "content": {
            "summary": {
                "value": "The paper considers the problem of sampling from a distribution given its unnormalized density. Recent work proposes training a diffusion process sampler to match the target distribution. At present such methods are trained by minimizing the Kullback-Leibler (KL) divergence computed using terminal states of the diffusion process as samples. As a result, complete trajectories need to be sampled during training, while only the terminal states get direct learning signal. In this paper, authors propose learning an additional neural net to provide learning signal for intermediate steps. Authors note that the resulting objective matches the detailed balance objective in GFlowNet literature, and tap into this literature to further improve the learning objective. Authors evaluate the method on several target distributions, showing improved performance compared to common baselines, including existing diffusion-based samplers (PIS/DDS)."
            },
            "soundness": {
                "value": "4 excellent"
            },
            "presentation": {
                "value": "3 good"
            },
            "contribution": {
                "value": "2 fair"
            },
            "strengths": {
                "value": "Significance: diffusion models are state of the art in generative modelling, where we can train them efficiently using the step-wise de-noising objective. Finding similarly effective objectives for training diffusion models as samplers is an important research direction.\n\nMotivation/soundness: the method is well-motivated and theoretically sound. Authors start with a clear problem with existing diffusion-based samplers (weak training signal at intermediate steps), and propose to define intermediate targets for the diffusion process using a neural network trained in parallel. The learning objective for the additional network neatly avoids having to estimate the integral in Eq. (11). The developed connection with GFlowNets allows the method to benefit from developments in this literature.\n\nResults: authors evaluate the propose method on several benchmarks, including the high-dimensional Cox distribution. A good selection of baselines is used, including MCMC, methods based on normalizing flows, and diffusion-based methods. The proposed method demonstrates improved performance across the board, as well as less variance in its results when compared to existing diffusion-based methods.\n\nQuality: the write-up is of high quality, with only a few minor typos, clean mathematical notation, and high-quality figures."
            },
            "weaknesses": {
                "value": "Originality/novelty: continuous GFlowNets and their connection to diffusion models have been explored by Lahlou et al. (2023) and Zhang et al. (2022a/2023b). The same authors have explored training diffusion models using alternative consistency-based objectives. While the setting in this paper is different (other work considers generative modeling, not sampling), it raises questions about the novelty of the method. Additional discussion with crisp comparisons to Lahlou et al./Zhang et al. would help.\n\nSignificance of the GFlowNet connection: Figure 10 in the appendix suggests that the effect of the forward-looking trick is relatively minor. It would be useful to see the effect of using Eqs. (14-15) instead of the originally proposed objective in Eq. (12). In other words, the practical effect of the GFlowNet connection (and associated improvements) is not clear from the results. \n\nClarity: Sections 2 and 3 are difficult to parse in places. The GFlowNet description in Section 2.2 is extremely dense. The separation of \"learning from intermediate steps\" vs. \"learning with incomplete trajectories\" in Section 3 is confusing. More generally, Section 3 could be re-structured to separate proposed methods, existing methods, and discussion more clearly. Section 4 is dense, with a lot of the references already introduced earlier in the paper."
            },
            "questions": {
                "value": "At the end of page 5 authors say that the method does not \"require the training sample to follow any particular distribution (only to have full support)\". Have authors measured the effect of choosing the sampling policy? Is it worthwhile to try to explore intelligently?"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "8: accept, good paper"
            },
            "confidence": {
                "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
            },
            "code_of_conduct": {
                "value": "Yes"
            },
            "first_time_reviewer": {
                "readers": [
                    "ICLR.cc/2024/Conference/Program_Chairs",
                    "ICLR.cc/2024/Conference/Submission5779/Senior_Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission5779/Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission5779/Reviewer_Tb6D"
                ]
            }
        },
        "number": 2,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission5779/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698763270035,
        "cdate": 1698763270035,
        "tmdate": 1700575354512,
        "mdate": 1700575354512,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "fc6bfynelU",
        "forum": "OIsahq1UYC",
        "replyto": "OIsahq1UYC",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission5779/Reviewer_oYBq"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission5779/Reviewer_oYBq"
        ],
        "content": {
            "summary": {
                "value": "In this paper, a novel training strategy for diffusion-based samplers is proposed, where the sampler is trained with learning signals for incomplete trajectories. Such a signal is amortized with a novel flow function. Training the sampler with these intermediate learning signals results in reduced variance with respect to similar modes trained only on full trajectories, and shows improved results on a wide set of benchmarks."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "3 good"
            },
            "contribution": {
                "value": "4 excellent"
            },
            "strengths": {
                "value": "The paper combines recent improvements to the credit assignment problem for partial trajectories in GFlowNets with recent diffusion-based sampler methods. The introduction of the amortized flow function is novel and well-supported with both theoretical and empirical results. The experimental section presents strong empirical results, as well as insightful analysis of the gradient variance and learned drift function which confirm the claims made by the authors. Overall, the proposed method presents strong performance on challenging tasks, making it a potentially high-impact contribution to the scientific community."
            },
            "weaknesses": {
                "value": "In my opinion, the paper could improve in terms of clarity and in separating the previous methods from the proposed one. The paper is heavily based on previous contributions, such as denoising diffusion sampler (DDS) and path integral sampler (PIS), as well as recent contributions in GFlowNets like [1,2]. While the authors provide brief explanations of these previous methods, I think it would be beneficial to first give a clearer introduction of what such methods do (especially for DDS and PIS), and then clearly outline how the ideas are combined in DGFS.\n\nThe off-policy training strategy is mentioned but could also benefit from additional explanations and perhaps an ablation study, for example, the empirical benefits of training DGFS off-policy vs on-policy. From the text, it is not immediately clear whether DGFS can only be trained off-policy, or if it has the possibility to be trained off-policy as opposed to on-policy. \n\n[1] Madan, Kanika, et al. \"Learning GFlowNets from partial episodes for improved convergence and stability.\" International Conference on Machine Learning. PMLR, 2023.\n\n[2] Pan, Ling, et al. \"Better training of gflownets with local credit and incomplete trajectories.\" arXiv preprint arXiv:2302.01687 (2023)."
            },
            "questions": {
                "value": "In the experiments, there is no comparison with GFlowNets methods. Is that because GFlowNets perform poorly on continuous sampling benchmarks? And on the other hand, can DGFS be used on discrete data space? And if so, how does it perform?"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "8: accept, good paper"
            },
            "confidence": {
                "value": "2: You are willing to defend your assessment, but it is quite likely that you did not understand the central parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
            },
            "code_of_conduct": {
                "value": "Yes"
            },
            "first_time_reviewer": {
                "value": "Yes",
                "readers": [
                    "ICLR.cc/2024/Conference/Program_Chairs",
                    "ICLR.cc/2024/Conference/Submission5779/Senior_Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission5779/Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission5779/Reviewer_oYBq"
                ]
            }
        },
        "number": 3,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission5779/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698770468747,
        "cdate": 1698770468747,
        "tmdate": 1699636607483,
        "mdate": 1699636607483,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "BGz7rQVYvE",
        "forum": "OIsahq1UYC",
        "replyto": "OIsahq1UYC",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission5779/Reviewer_1u4d"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission5779/Reviewer_1u4d"
        ],
        "content": {
            "summary": {
                "value": "The paper proposes an algorithm for better sampling from intractable high-dimensional density functions. The sampling procedure is formulated as a time sequence. The improvement then stems from the usage of partial trajectories instead of merely relying on the end-time variable. Empirical results show the superior performance of the proposed method."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "4 excellent"
            },
            "contribution": {
                "value": "3 good"
            },
            "strengths": {
                "value": "I haven't done any research in the sampling area, nor do I have a strong background of the sampling methods and their advantages and disadvantages. However, from reading the paper, I have gained an understanding of the problem to be solved in the paper. Moreover, the methodology makes sense to me. That being said, the paper is well written with a clear logic flow, even for people who is new to the field.\n\nThe experiments cover a wide range of data, including high-dimensional settings. The reported results look very promising and indicating the strength of the proposed method."
            },
            "weaknesses": {
                "value": "I am not very confident in evaluating the novelty of the proposed method. From the introduction, it seems like a combination of the existing ideas in constructing a forward Markov chain and exploitation of the detailed balance in GFlowNets. I would appreciate a discussion regarding the novelty.\n\nWhat is the running time comparison to existing baseline methods?\n\nThe reported results in table 1 uses a different metric for baseline methods. I am curious how does the proposed method compares to baseline methods using the results at the best checkpoint?"
            },
            "questions": {
                "value": "See weakness above."
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "6: marginally above the acceptance threshold"
            },
            "confidence": {
                "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
            },
            "code_of_conduct": {
                "value": "Yes"
            },
            "first_time_reviewer": {
                "readers": [
                    "ICLR.cc/2024/Conference/Program_Chairs",
                    "ICLR.cc/2024/Conference/Submission5779/Senior_Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission5779/Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission5779/Reviewer_1u4d"
                ]
            }
        },
        "number": 4,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission5779/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698802028998,
        "cdate": 1698802028998,
        "tmdate": 1700697888187,
        "mdate": 1700697888187,
        "license": "CC BY 4.0",
        "version": 2
    }
]