[
    {
        "id": "JGiXru1931",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission4104/Reviewer_CsHK"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission4104/Reviewer_CsHK"
        ],
        "forum": "QDrG0ALevs",
        "replyto": "QDrG0ALevs",
        "content": {
            "summary": {
                "value": "This paper proposes replacing the traditional reward-to-goal in RvS policy learning with the optimal advantage value as the conditional information. This approach allows for the attainment of the optimal policy by simply providing 0 as the goal information during evaluation, eliminating the need for complex reward-to-goal design since the optimal advantage value is 0. Specifically, this paper employs expectile regression in IQL to train the approximated optimal advantage value, which is then used as the conditional information when training a diffusion policy. A classifier-free guided sampling method is also implemented to enhance the guidance strength for improved performance. In addition, this paper incorporates the test-time value filtering trick from IDQL[1], which involve sampling multiple action candidates and selecting the best one to further enhance optimality. The primary evaluation is conducted on Antmaze tasks. However, the performance gains compared to the base method, IDQL, are marginal.\n\n[1]IDQL: Implicit q-learning as an actor-critic method with diffusion policies, 2023."
            },
            "soundness": {
                "value": "2 fair"
            },
            "presentation": {
                "value": "3 good"
            },
            "contribution": {
                "value": "2 fair"
            },
            "strengths": {
                "value": "1. The proposed method smartly circumvents the notoriously challenging reward-to-goal conditional information design in RvS type methods.\n2. The proposed method is simple and easy to implement.\n3. The paper is well organized."
            },
            "weaknesses": {
                "value": "1. Limited performance gains. The proposed method only obtains on-par performances compared to the base method, IDQL. The authors argue that IDQL does not incorporate any guidance during training and requires filtering from multiple sampled action candidates to obtain good results. However, the proposed method, ACD-F, still employs the same filtering trick to obtain good results and does not obtains significant performance gains. Furthermore, without this trick, ACD performs severely worse than IDQL.\n\n2. I noticed in a concurrent work [2] that simply training a BC model using diffusion policy can obtain on-par performance with ACD that utilizes additional conditional information. It seems that even without the additional advantage condition, the simplest Diffusion-BC can already perform well. Therefore, it is hard for me to tell whether the introduced conditional information works in this paper.\n\n3. Limited evaluation. This paper only evaluates on Antmaze tasks and only compares against limited baselines, which is hard for me to access the effectiveness the proposed method.\n\n4. Limited ablation studies. Most design choices in this paper are not well elaborated.\n\n5. The desired optimal advantage value is hard to obtain using expectile regression since severe instability will incurr when the expectile value $\\rightarrow 1$. This will result in some gap when implementing the method since only an near-optimal advantage value is allowed.\n\n[2] Consistency Models as a Rich and Efficient Policy Class for Reinforcement Learning, 2023."
            },
            "questions": {
                "value": "N/A"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "details_of_ethics_concerns": {
                "value": "N/A"
            },
            "rating": {
                "value": "3: reject, not good enough"
            },
            "confidence": {
                "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
            },
            "code_of_conduct": {
                "value": "Yes"
            },
            "first_time_reviewer": {
                "value": "Yes",
                "readers": [
                    "ICLR.cc/2024/Conference/Program_Chairs",
                    "ICLR.cc/2024/Conference/Submission4104/Senior_Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission4104/Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission4104/Reviewer_CsHK"
                ]
            }
        },
        "number": 1,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission4104/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1697381290670,
        "cdate": 1697381290670,
        "tmdate": 1699636375459,
        "mdate": 1699636375459,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "BFSu7IwTyQ",
        "forum": "QDrG0ALevs",
        "replyto": "QDrG0ALevs",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission4104/Reviewer_PrNq"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission4104/Reviewer_PrNq"
        ],
        "content": {
            "summary": {
                "value": "This work considers using conditional generative models for offline RL, which are conditioned on the advantage function. Then it utilizes IQL for learning approximately optimal advantages for in-distribution actions and Diffusion models for improving the expressive ability. Moreover, this work investigates many design choices, like network architectures, training, training, and sampling steps to test the performance. Finally, this work evaluates ACD and ACD-F in several tasks of D4RL, especially some antmaze tasks."
            },
            "soundness": {
                "value": "2 fair"
            },
            "presentation": {
                "value": "2 fair"
            },
            "contribution": {
                "value": "2 fair"
            },
            "strengths": {
                "value": "- Utilizing the advantage-conditioned diffusion model as policies for offline RL is interesting."
            },
            "weaknesses": {
                "value": "- The Experiments Section is too short, due to the ICLR requirement of 9 pages and this article currently only has 8 pages, I hope to see more experiment results and corresponding analyses (See Questions).\n\n- Many techniques of the proposed ACD are based on IDQL, but the performance of ACD is lower than IDQL."
            },
            "questions": {
                "value": "- In D4RL, there are several locomotion tasks, like HalfCheetah/Walker/Hopper-Medium-Expert/Medium/Medium-Replay, but experiments in Table 4 only test in HalfCheetah-Medium, what is the performance in other locomotion tasks?\n\n- What about the results of ACG in all evaluate tasks?\n\n- The authors have said that \" poor results for ACG with scalar advantages can be improved by changing the optimizer from Adam to AdamW \". Is there any ablation study about the performance of Adam and AdamW?\n\n- As the title of this work includes ''Offline RL via Generalization\", this work seems to mainly tackle the single task, what is the meaning of \"generalization\" in this work?"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "3: reject, not good enough"
            },
            "confidence": {
                "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
            },
            "code_of_conduct": {
                "value": "Yes"
            },
            "first_time_reviewer": {
                "value": "Yes",
                "readers": [
                    "ICLR.cc/2024/Conference/Program_Chairs",
                    "ICLR.cc/2024/Conference/Submission4104/Senior_Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission4104/Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission4104/Reviewer_PrNq"
                ]
            }
        },
        "number": 2,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission4104/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1697814609056,
        "cdate": 1697814609056,
        "tmdate": 1699636375374,
        "mdate": 1699636375374,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "HaJI6cvFD3",
        "forum": "QDrG0ALevs",
        "replyto": "QDrG0ALevs",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission4104/Reviewer_sXjs"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission4104/Reviewer_sXjs"
        ],
        "content": {
            "summary": {
                "value": "The authors propose an algorithm for offline RL which uses IQL to train an optimal Advantage function which does not require out of distribution querying for TD updates, and then train a diffusion policy which is conditioned on the advantage. This method of distillation of the policy leverages the expressive capabilities of diffusion models by not requiring some more difficult to optimize weighted form of maximum likelihood such as Advantage Weighted Regression."
            },
            "soundness": {
                "value": "2 fair"
            },
            "presentation": {
                "value": "3 good"
            },
            "contribution": {
                "value": "3 good"
            },
            "strengths": {
                "value": "1) The proposed method is simple and elegant, and I am convinced that it could be an effective method to distill policies from IQL. Advantage Weighted Regression has always been a very flawed method to distill optimal policies from the trained value functions since to obtain an optimal policy, the temperature must be close to 0 which results in a very difficult optimization problem. This approach of advantage conditioned diffusion is much simpler to optimize, while also benefiting from learning a multimodal policy.\n\n2) The paper communicates the motivation and algorithm clearly, and the presentation is good.\n\n3) This work is of high relevance to the offline RL community, which has increasingly become interested in leveraging generative models to frame reinforcement learning as a conditional generative modeling problem."
            },
            "weaknesses": {
                "value": "1) The experiments are quite weak. While I am fine with offline RL works being evaluated in D4RL as it is the standard, this paper only evaluates on a small subset of the D4RL benchmark. I would like to see evaluations of the method on the other locomotion tasks, Franka Kitchen, and Adroit.\n\n2) AntMaze results are good, but are beaten in the large mazes by the other 2 diffusion based offline RL algorithms DQL and IDQL. While I am fine with the algorithm not necessarily having to perform better than these algorithms, the fact that evaluation has only been done on AntMaze further makes the results look weak."
            },
            "questions": {
                "value": "1) Could the authors run more extensive experiments across D4RL and some ablations on hyperparameters?\n\n2) Could the authors relate the work to other approaches to diffusion for offline RL that directly try to do return conditioned generative modeling such as Decision Diffuser?\n\nThe main proposal is an algorithm which we can only judge based on empirical results, but the experiments are very weak. As such, I am leaning towards rejection of the paper. I am open to increasing the score if presented with a stronger suite of experimental results."
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "5: marginally below the acceptance threshold"
            },
            "confidence": {
                "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
            },
            "code_of_conduct": {
                "value": "Yes"
            },
            "first_time_reviewer": {
                "value": "Yes",
                "readers": [
                    "ICLR.cc/2024/Conference/Program_Chairs",
                    "ICLR.cc/2024/Conference/Submission4104/Senior_Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission4104/Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission4104/Reviewer_sXjs"
                ]
            }
        },
        "number": 3,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission4104/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698695604428,
        "cdate": 1698695604428,
        "tmdate": 1699636375297,
        "mdate": 1699636375297,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "fWOp0mk7h9",
        "forum": "QDrG0ALevs",
        "replyto": "QDrG0ALevs",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission4104/Reviewer_9qGT"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission4104/Reviewer_9qGT"
        ],
        "content": {
            "summary": {
                "value": "The authors propose an offline reinforcement learning method based on Implicit Q-learning (IQL) and diffusion based generative models. The proposed approach encodes the learned policy as a generative model conditioned on the desired advantage value. This generative model is trained on a dataset of state, action and estimated advantage value triplets with the goal of generating actions conditioned on state and advantage value. The advantage values are estimated using IQL with the stated goal of avoiding maximization of state-action values done in other Q-learning like methods. This is done by replacing the classical maximization, e.g., $\\text{max}_a \\hat{q}(s,a)$, with an expectile favoring larger values. This expectile is estimated over actions in the dataset in order to avoid out-of-distribution issues. \n\nFirst, the value of using IQL and advantage conditioned is explored using a simple MLP gaussian policy in three \"antmaze\" D4RL tasks. This variant is shown to perform better in 2/3 of tasks compared to an actor-critic, a behavior cloning (BC), and a weighted max-likelihood (AWR) method. Different encoding schemes are considered and two \"antmaze\" tasks. Between a raw encoding (just real-value), a one-hot discretization scheme, the discretization approach performed better but this depends on the optimizer used (Adam vs. AdamW).\n\nFollowing this, the \"full\" proposed diffusion model based method, called advantage-conditioned diffusion (ACD), is evaluated. Similarly, different encoding of the advantage values are considered but the authors found simply using the raw value to perform best. The show better performance in the antmaze-medium-play task which corroborates their conclusion.\n\nFinally, a \"value filtering\" variant (ACD-F) of their method is proposed which instead of generating a single action will sample several actions and pick the highest valued action. Both ACD methods are compared to various baselines on 7 D4RL tasks. Their results show that ACD performs worse than IQL and IDQL, comparable to DQL and better than BC and AWR. Their results also show that ACD-F is comparable to IDQL in all but 2 tasks, and otherwise outperforms all other methods."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "3 good"
            },
            "contribution": {
                "value": "3 good"
            },
            "strengths": {
                "value": "The main contribution is a nice addition to this idea of value-conditioned policies. The prospect of being able to leverage past and future advances in generative modelling is appealing.\n\nThe paper is well written and well structured. The authors do a good job of giving necessary background on relevant offline RL literature.\n\nI quite appreciated the discussion about the different design choices tried, most notably the discussion related to encoding the advantage values when conditioning."
            },
            "weaknesses": {
                "value": "The empirical results are a little on the weak side. I think the results are sufficient but I would have appreciated some further discussion comparing ACD-F to IDQL. In short, why might I ever consider ACD-F over IDQL? What potential advantages ACD-F might have?\n\nThere is little discussion on the experimental setup making reproducibility uncertain. Were baseline results taken from prior work, if so which ones? How were hyperparameters decided? What hyperparameters were chosen (learning rate, $\\tau$, $\\omega$, the optimizer, etc.)? How many seeds when learning the policy? How many seeds when evaluating the policies?"
            },
            "questions": {
                "value": "p. 4, para before sec 3.3, Do we assume we are operating in an episodic setting (i.e., trajectories always end in terminal states)? If that's the case, this should be stated. Otherwise, how do you properly estimate returns?\n\np. 5, thm 1, is the optimal policy unique?\n\np. 5, Fig 1, what is $\\tau$?\n\np. 6, \"improving upon the behavior policy in all three tasks\", what value does the behavior policy get? Would it make sense to add it to table 1?\n\np. 6, sec 4.2, how necessary is this additional \"unconditional\" aspect? Have you tried without it? Have you tried using a separate network for the unconditional part?\n\np. 7, \"while we found these two approaches perform similarly\", by what measure do they perform similarly if not by the policy performance?\n\np. 7, sec 5, what is the runtime of ACD and ACD-F during training and testing? How does it compare to IQL, DQL, and IDQL?\n\n# Minor comments\n\np. 2, \"opem\", typo\n\np. 2, \"bahavior\", typo\n\np. 3, \"expected total reward\", that's the expected *discounted* total reward\n\np. 4, \"substricts\", typo\n\np. 5, \"converge to the optimal action\", is this really true if we constrain to learn the advantage values to be \"in-distribution\"?\n\np. 7, \"MPL\", typo\n\np. 7, \"sinsusoidal\", typo"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "6: marginally above the acceptance threshold"
            },
            "confidence": {
                "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        },
        "number": 4,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission4104/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1699057907269,
        "cdate": 1699057907269,
        "tmdate": 1699636375210,
        "mdate": 1699636375210,
        "license": "CC BY 4.0",
        "version": 2
    }
]