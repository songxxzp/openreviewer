[
    {
        "id": "ala00Lyl4K",
        "forum": "JWwvC7As4S",
        "replyto": "JWwvC7As4S",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission2700/Reviewer_PiTj"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission2700/Reviewer_PiTj"
        ],
        "content": {
            "summary": {
                "value": "The paper discusses neural collapse and links it to batch normalization and weight decay regularization, in settings where the empirical cross entropy is close to its optimal value. Both theoretical and empirical evidence is presented for this connection."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "3 good"
            },
            "contribution": {
                "value": "3 good"
            },
            "strengths": {
                "value": "The paper deals with an interesting and timely topic and contributes to a better understanding of the phenomenon of neural collapse. The logical flow of arguments is clear, and the paper is quite accessible (thanks, e.g., to the sketch of the proof). The empirical evidence, at least for smaller architectures and synthetic datasets, seems to support the claims made based on theoretical considerations. This is a major strength of the paper, together with the theoretical analysis."
            },
            "weaknesses": {
                "value": "Some weaknesses currently prevent me from giving a better score, and I would appreciate the authors opinion on these:\n* For the theoretical analysis, the layer-peeled model is a very specific setting. I understand that narrow settings may be required to obtain rigorous results. I would like to understand, however, the rationale behind this choice and how the authors believe that the results can generalize (also theoretically) to more general settings.\n* At the beginning of Section 2.2, the authors claim that quantities proposed in the past to quantify NC fail to deliver insights whenever the \"values are non-zero\". Why is that the case? And how does cosine similarity excel in this regard? To my basic understanding, a measure such as SNR (which I take to be the ratio between inter-class distances over intra-class distances) seems quite intuitive (and also accounts for vector lengths, which the proposed cosine similarity does not). To some extent, I would even believe that SNR allows a similar theoretical analysis as cosine similarity (assuming that SNR also depends on Euclidean distances).\n* Some experimental details are not clear (see questions below), I would appreciate clarifications. Most importantly, what are the training and test errors for the settings in Fig. 1 and 2. I would appreciate if these curves could be plotted on top of the existing ones, to get a better understanding of the training success.\n* Another shortcoming of the paper is that the results for the larger architectures in Fig. 2 are not as clear; VGG11, for example, seems not to exhibit NC, at least not using the measures that are proposed. This limits the contribution of the paper slightly, as the phenomenon of NC is either not as prevalent as claimed, or the proposed measures are inadequate of capturing this phenomenon in interesting settings (i.e. for large architectures).\n* Connected to the previous point, the authors state that cosine similarity describes \"necessary conditions for the core observations of NC\". Hence, if NC occurs, this should be reflected in the measures (which suggests that the results in Fig. 2 do not exhibit NC). In contrast, even if the proposed measures behave as expected under NC (as in Fig. 1), there is no guarantee that NC actually occurred. This is some, if only a minor, shortcoming of the proposed measure. I acknowledge, however, that the authors are aware of this limitation and I agree that this does not affect the validity and usefulness of the theoretical results."
            },
            "questions": {
                "value": "* Why does the inter-class cosine similarity under the NC setting (NC2 on top of page 5) not depend on $d$? Is it implicitly assumed that $d>C$?\n* Is the $\\beta$ in Th. 2.1 the same as the $\\beta$ in the definition of BN? Is the $\\lambda$ in Lemma 2.1 the same as the regularization parameter?\n* Does \"unbiased BN\" refer to $\\beta=0$?\n* In Section 3.1, what is the number of classes $C$? What is the dimension of the penultimate layer $d$? In Section 3.2, what is the dimension of the penultimate layer $d$?"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "5: marginally below the acceptance threshold"
            },
            "confidence": {
                "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        },
        "number": 1,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission2700/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1697555177491,
        "cdate": 1697555177491,
        "tmdate": 1699636211652,
        "mdate": 1699636211652,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "YDlWLGqQVQ",
        "forum": "JWwvC7As4S",
        "replyto": "JWwvC7As4S",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission2700/Reviewer_QjJX"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission2700/Reviewer_QjJX"
        ],
        "content": {
            "summary": {
                "value": "This paper explores the phenomenon of \"Neural Collapse (NC)\" in the final layer of neural network classifiers. The study investigates the relationships between batch normalization (BN), weight decay, and their proximity to NC. It introduces an NC measure using intra-class and inter-class cosine similarity and provides theoretical guarantees for the emergence of NC in scenarios with near-optimal regularized cross-entropy loss. The theoretical results highlights the importance of BN and weight decay for the emergence of NC. The empirical evidence supports these findings, suggesting that BN and appropriate weight-decay values play a significant role in the occurrence of NC in neural network models."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "2 fair"
            },
            "contribution": {
                "value": "2 fair"
            },
            "strengths": {
                "value": "1. The effect of batch normalization (BN) for neural collapse (NC) makes sense to me. Previous works show that feature normalization plays an important role in NC, and BN together with $\\ell_2$ weight normalization encompasses feature normalization.\n2. The presentation of this paper is clear and easy to understand. The authors make a thorough comparison with previous works, highlight the contribution of this paper, and discuss the limitations and future directions.The author provides both theoretical and empirical evidence to support their claims."
            },
            "weaknesses": {
                "value": "1. The use of cosine similarity is not novel. Cosine similarity has long been used in previous works (e.g. [1]) to characterize the inter-class and intra-class feature variations. The authors should avoid saying that they \"propose the cosine similarity measure\", and should provide a more thorough discussion of related literatures. \n2. The use of cosine similarity is not well justified. Cosine similarity can only guarantee the directions of the feature vectors are similar, but has nothing to do with the norm of the feature vector. Using it as a metric for NC is too weak.\n3. The theoretical contributions are limited. The major theoretical contribution of this paper, is to establish a *near-optimal* NC configuration for a *near-optimal* CE loss. There are already various previous works proving this relationship for the exact setting (e.g. [2] ), and the paper mainly follow their proof outline. The novel component is Lemma 2.1, where the authors prove an approximate version of Jenson's inequality for strongly convex objectives. Therefore, I believe the major theoretical contribution is to directly extend previous guarantees for NC to the non-asymptotic cases. Furthermore, the exponential terms in the non-asymptotic bound implies that the result has a very high dependency on the parameter norm, which again questions whether such an extension is necessary or meaningful.\n\nMinor issues:\n1. Some terminologies are not accurate. For example, the authors repeatedly use \"unbiased neural network\" to refer to network architectures without bias, which causes ambiguity due to its statistical meaning.\n2. The figures are blurred. The authors should use a higher resolution for figures. \n\n\n[1] Kornblith S, Chen T, Lee H, et al. Why do better loss functions lead to less transferable features?\n\n[2] Jianfeng Lu and Stefan Steinerberger. Neural collapse under cross-entropy loss."
            },
            "questions": {
                "value": "Please answer the questions in the weakness section, including the use the cosine similarity and the significance of the theories."
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "5: marginally below the acceptance threshold"
            },
            "confidence": {
                "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
            },
            "code_of_conduct": {
                "value": "Yes"
            },
            "first_time_reviewer": {
                "value": "Yes",
                "readers": [
                    "ICLR.cc/2024/Conference/Program_Chairs",
                    "ICLR.cc/2024/Conference/Submission2700/Senior_Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission2700/Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission2700/Reviewer_QjJX"
                ]
            }
        },
        "number": 2,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission2700/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698052199411,
        "cdate": 1698052199411,
        "tmdate": 1699636211571,
        "mdate": 1699636211571,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "Kq3yLrp7kr",
        "forum": "JWwvC7As4S",
        "replyto": "JWwvC7As4S",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission2700/Reviewer_TmdP"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission2700/Reviewer_TmdP"
        ],
        "content": {
            "summary": {
                "value": "This paper theoretically investigates the relationship between BN and weight decay, and a near-optimal NC structure. As similar to most previous studies (e.g., unconstrained models Zhu et al. (2021)), this paper's theoretical analysis is limited to last-layer features but from a near-optimal perspective. The theoretical analysis indicates that BN and weight decay helps the achievement of NC in the near-optimal regime.\n\n-----------------------\nI have revised my score which more accurately reflect my current standing."
            },
            "soundness": {
                "value": "2 fair"
            },
            "presentation": {
                "value": "3 good"
            },
            "contribution": {
                "value": "2 fair"
            },
            "strengths": {
                "value": "1. The writing is good, and the idea is easy to follow.\n2. The perspective from Batch normalization and weight decay is novel and insightful. Theorem 2.2 demonstrates a larger weight decay coefficient $\\lambda$ would result in a tighter bound over both inter- and intra-class cosine similarity. Also, the experiments partially verified their theoretical results."
            },
            "weaknesses": {
                "value": "Theoretical side:\n1. The original NC phenomenon contains four aspects (conditions) but this paper only analyzes the NC1 and NC2. \n2. As previous works on NC, this paper is also limited to the last-layer feature vectors. \n3. The affine parameter $\\gamma$ for BN is not included in theorem 3.2, it is not clear that how BN influences the inter- and intra-class cosine similarities.\n4. The bias term of BN is ignored in this paper, which could be important as it would greatly influence the feature vectors' norms and further influence the bound over the cosine similarity.\nOverall, though the theoretical results on weight decay is interesting, the whole contribution of this paper is marginal.\n\nExperimental side:\n1. For Sec 3., only minimum intra-class and maximum inter-class cosine similarities are analyzed. I thought the authors might want to show the hardest case for both intra-class and maximum inter-class cosine similarities. But, to be pointed, the average value should be also measured as it could capture some general information of the cosine similarities across each pair of classes.\n2. In Fig 2., some experimental results cannot be predicted by their theorems. For example, for conic hull dataset and 3-layer MLP, at the same level of weight decay (e.g., $10^{-4}$), the model without BN layers holds better intra-class cosine similarities.\n3. In Fig 3., I don't see the value of including the results of ResNet. There is no clear baseline for ResNet (with BN) for comparison.\n\nSuggestions on Fig 2. and 3.\n1. Figures are of low resolution.\n2. The curves of Model (w/o BN) should be put into one single figure for better comparison."
            },
            "questions": {
                "value": "Is there any benefit to analyze the near-optimal regime over the optimal one?"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "5: marginally below the acceptance threshold"
            },
            "confidence": {
                "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
            },
            "code_of_conduct": {
                "value": "Yes"
            },
            "first_time_reviewer": {
                "value": "Yes",
                "readers": [
                    "ICLR.cc/2024/Conference/Program_Chairs",
                    "ICLR.cc/2024/Conference/Submission2700/Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission2700/Reviewer_TmdP",
                    "ICLR.cc/2024/Conference/Submission2700/Senior_Area_Chairs"
                ]
            }
        },
        "number": 3,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission2700/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698655518377,
        "cdate": 1698655518377,
        "tmdate": 1701072537329,
        "mdate": 1701072537329,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "BHj0YMVb56",
        "forum": "JWwvC7As4S",
        "replyto": "JWwvC7As4S",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission2700/Reviewer_Svsj"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission2700/Reviewer_Svsj"
        ],
        "content": {
            "summary": {
                "value": "This work studies the geometric structure of representations before the last layer of a deep neural network trained with cross entropy, batch normalization and weight decay. Specifically, an asymptotic bound on the average intra-class and inter-class cosine similarity in dependence of the regularization strength and the loss is proven. The theoretical results are supported by experiments on synthetic data and on MNIST / CIFAR10."
            },
            "soundness": {
                "value": "2 fair"
            },
            "presentation": {
                "value": "3 good"
            },
            "contribution": {
                "value": "2 fair"
            },
            "strengths": {
                "value": "This paper considers the near-optimal regime and bounds the average intra-class and inter-class cosine similarity in dependence of the value of the loss function. It improves upon prior work which only derived the minimizers."
            },
            "weaknesses": {
                "value": "### Theory\n\nThe main theoretical results are Theorem 2.1 and 2.2. They state that if the \"average last-layer feature norm and the last-layer weight matrix norm are both bounded, then achieving near-optimal loss implies that most classes have intra-class cosine similarity near one and most pairs of classes have inter-class cosine similarity near -1/(C-1)\".\n\nQualitatively, this result is an immediate consequence of continuity of the loss function together with the fact that bounded average last-layer feature norm and bounded last-layer weight matrices implies NC.\nQuantitatively, this work proves asymptotic bounds on the proximity to NC as a function of the loss. This quantitative aspect is novel. I am not convinced of its significance however, as I will outline below.\n  1. The result is only asymptotic, and thus it cannot be used to estimate proximity to NC from a given loss value.\n  2. The bound is used as basis to argue that *\"under the presence of batch normalization\n  and weight decay of the final layer, larger values of weight decay provide stronger NC guarantees in the sense that the intra-class cosine similarity of most classes is nearer to 1 and the inter-class cosine similarity of most pairs of classes is nearer to -1/(C-1).\"*  \nThis is backed up by the observation, that the bounds get more tight if the weight decay parameter $\\lambda$ increases. To be more specific, Theorem 2.2 shows that if $L< L{min}+\\epsilon$, then the average intra class cosine similarity is smaller than $-1/(C-1) + O(f(C,\\lambda,\\epsilon,\\delta))$ and $f$ decreases with $\\lambda$.  \nThe problem with this argument is that the loss function itself depends on the regularization parameter $\\lambda$ and so it is a-priori not clear whether values of $\\epsilon$ are comparable for different $\\lambda$. For example, apply this argument to the more simple loss function $L(x,\\lambda)=\\lambda x^2$. As $L$ is convex, it is clear that the value of $\\lambda>0$ is irrelevant for the minimum and the near optimal solutions. Yet, $L(x,\\lambda)<\\epsilon$ implies $x^2<\\epsilon/\\lambda$ which decreases with $\\lambda$. By the logic given in this work, the latter inequality suggests that minimizing a loss function with a larger value of $\\lambda$ provides stronger guarantees for arriving close to the minimum at $0$. Clearly, this is not the case and an artifact of quantifying closeness to the loss minimum by $\\epsilon$, when it should have been adjusted to $\\lambda \\epsilon$ instead.\n\nI have doubts on how batch normalization is handled. As far as I see, batch normalization enters the proofs only through the condition $\\sum_i \\| h_i \\|^2 =\\| h_i \\|^2$ (see Prop 2.1). However, this is only an implication and batch normalization induces stronger constraints. The theorems assume that the loss minimizer is a simplex ETF in the presence of batch normalization. This is not obvious, and neither proven nor discussed. It is also not accounted for in the part of the proof of Theorem 2.2, where the loss minimum $m_{reg}$ is derived.\n\n### Experiments\n\n- Theorems 2.1 and 2.2 are not evaluated empirically. It is not tested, whether the average intra / inter class cosine similarities of near optimal solutions follow the exponential dependency in $\\lambda$ and the square (or sixth) root dependency on $\\epsilon$ as suggested by the theorems.\n- Instead, the dependency of cosine similarities at the end of training (200 epochs) on weight decay strength is evaluated. As presumed by the authors, the intra class cosine similarities get closer to the optimum, if the weight decay strength increases. Yet, there are problems with this experiment. It is inconsistent with the setting of the theory part and thus only provides limited insight on if the idealized theoretical results transfer to practice.\n  1. The theory part depends only on the weight decay strength on the last layer parameters. Yet, in the experiments, weight decay is applied to all layers and its strength varies between experiments (when instead only the strength of the last layer should change).\n  2. The theorems assume near optimal training loss, but training losses are not reported. Moreover, the reported cosine similarities are far from optimal (e.g. intra class is around 0.2 instead of 1) which suggests that the training loss is also far from optimal. It also suggests that the models are of too small capacity to justify the 'unconstrained-features' assumption.\n  3. As (suboptimally) weight decay is applied to all layers, we would expect a large training loss and thus suboptimal cosine similarities for large weight decay parameters. Conveniently, cosine similarities for such large weight decay strengths are not reported and the plots end at a weight decay strength where cosine similarities are still close to optimal.\n  4. On real-world data sets, the inter class cosine similarity increases with weight decay (even for batch norm models VGG11), disagreeing with the theoretical prediction. This observation is insufficiently acknowledged.\n\n### General\n\nThe central question that this work wants to answer **What is a minimal set of conditions that would guarantee the emergence of NC?\"** is already solved in the sense that it is known that minimal loss plus a norm constraint on the features (explicit via feature normalization or implicit via weight decay) implies neural collapse. The authors argue to add batch normalization to this list but that contradicts minimality.\n\nThe first contribution listed by the authors is not a contribution.\n1. *\"We propose the intra-class and inter-class cosine similarity measure, a simple and geometrically intuitive quantity that measures the proximity of a set of feature vectors to several core\nstructural properties of NC. (Section 2.2)\"*\n\nCosine similarity (i.e. the normalized inner product) is a well known and an extensively used distance measure on the sphere. In the context of neural collapse, cosine similarities were already used in the foundational paper by Papyan et al. (2020) to empirically quantify closeness to NC (cf. Figure 3 in this reference) and many others.\n\nMinor:\n- There is a grammatical error in the second sentence of the second paragraph\n- There is no punctuation after formulas; In the appendix, multiple rows start with a punctuation\n- intra / inter is sometimes written in italics, sometimes upright\n- $\\beta$ is used multiply with a different meaning\n- Proposition 2.1 $N$ = batch site, Theorem 2.2 $N$ = number of samples per class. \n- As a consequence, it seems that $\\gamma$ needs to be rescaled to account for the number of batches"
            },
            "questions": {
                "value": "Is it possible to arrange features in a simplex ETF such that batch normalization is satisfied? Is it possible, if $\\gamma=1$, i.e., batch normalization without affine parameters? If not, does this affect the validity of Theorem 2.2?\n\nMinor: Why is $\\epsilon/\\delta \\ll 1$ listed as an assumption for Theorems 2.1 and 2.2? From my understanding, the big $O$ notation already states, that the result holds for $\\epsilon$ small enough?"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "3: reject, not good enough"
            },
            "confidence": {
                "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        },
        "number": 4,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission2700/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698929397524,
        "cdate": 1698929397524,
        "tmdate": 1699636211429,
        "mdate": 1699636211429,
        "license": "CC BY 4.0",
        "version": 2
    }
]