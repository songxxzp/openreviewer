[
    {
        "id": "HeUnJwT6Tn",
        "forum": "9jmUwjZi7j",
        "replyto": "9jmUwjZi7j",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission9052/Reviewer_6WsC"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission9052/Reviewer_6WsC"
        ],
        "content": {
            "summary": {
                "value": "This paper presents Dreamfuser, a diffusion model based offline RL algorithm. Dreamfuser works by jointly optimizing actions for multiple states in parallel, with the diffusion refinement steps integrated into the MDP as \"hidden transitions\" in the state-action space to make Q-learning tractable in parallel with behavioral cloning."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "3 good"
            },
            "contribution": {
                "value": "2 fair"
            },
            "strengths": {
                "value": "The method presented is algorithmically sound and supported by a good set of comparisons to multiple prior methods to validate its performance. The topic is important and the algorithm novel, to my knowledge.\n\nWhile I found the writing a little jargon/notation dense at times, overall the paper does a good job of presenting the method."
            },
            "weaknesses": {
                "value": "While it's a bit of a dirty word, I can't help but feel that this paper is a bit Incremental.\n\nTo be clear, I'm of the opinion that that shouldn't be an obstacle to publication- I'm recommending marginal acceptance as I do think the method is novel and sound and the improvement on prior work seems credible, which should be the bar for research to be considered worth sharing.\n\nMy general criticism is that this paper doesn't do a lot to justify that the presented algorithm is radically better than prior ones. The motivation makes sense as an extension of previous work, and the experimental results substantiate that Dreamfuser is comparable or better in several benchmarks, but as someone not working in offline RL specifically it's not clear to me how this work has moved the field forward beyond taking that incremental step. Is there an extension or new ground that could be broken to build off of this work? \n\nI've got a few specific questions and suggestions below, but my main concern is that the paper doesn't do a good job explaining its own significance. If there's something I'm missing here I am open to revising my score, for what it's worth."
            },
            "questions": {
                "value": "-There's a number of grammatical errors scattered throughout the paper, particularly after section 1. I'd suggest another editing pass, though this doesn't significantly impede understanding the paper.\n\n-How does the MDP formulation in Section 4.1 differ from a POMDP (with the action history as part of the observation)? Is there a reason it is not described as a particular subtype of POMDP? The hindsight framing M' seems to suggest that it can be treated as one.\n\n-What is the downside to the GNMDP formulation here? It seems like it should make action/Q-value gradients much more noisy and slow learning due to the temporal extension/noisy credit assignment. Are there drawbacks to this approach?\n\n-I understand the concept, but counting down from K to 0 in the forward direction of time for diffusion steps is confusing when present alongside typical \"0 to T\" timestep notation. I imagine this counting down notation is standard in the diffusion model literature, but from an RL perspective it would improve readability to have both incrementing in the same direction.\n\n-How does multi-action prediction affect the Gym tasks, similar to Figure 2a and 2b? The results in those figures are compelling, but intuitively I'd expect the importance of temporally extended action planning to vary significantly depending on the task, and this ablation seems to be the main motivation for a major element of the algorithm as presented, as I don't see a clear motivation for predicting a whole trajectory at once in the introduction. Perhaps there's some intuition from previous work I'm unfamiliar with, but it's not obvious to me why joint prediction of actions would improve forward action prediction accuracy at test time (outside a fully model-based method with forward dynamics). Does it benefit supervised training stability in some way?\n\n-In figure 2c, how does this overfitting issue without the dynamics model compare to other methods? I had gotten the sense that methods like CQL generally avoid/minimize overfitting (albeit perhaps at a cost in theoretical performance), am I mistaken and most offline RL methods still suffer overfitting late in training? \n\n-Where does the name \"Dreamfuser\" come from, out of curiosity? I understand the [dif]fuser part, but what about \"dream?\""
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "6: marginally above the acceptance threshold"
            },
            "confidence": {
                "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
            },
            "code_of_conduct": {
                "value": "Yes"
            },
            "first_time_reviewer": {
                "value": "Yes",
                "readers": [
                    "ICLR.cc/2024/Conference/Program_Chairs",
                    "ICLR.cc/2024/Conference/Submission9052/Senior_Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission9052/Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission9052/Reviewer_6WsC"
                ]
            }
        },
        "number": 1,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission9052/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698353316005,
        "cdate": 1698353316005,
        "tmdate": 1699637140166,
        "mdate": 1699637140166,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "eV1oyPV8Bp",
        "forum": "9jmUwjZi7j",
        "replyto": "9jmUwjZi7j",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission9052/Reviewer_vgVx"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission9052/Reviewer_vgVx"
        ],
        "content": {
            "summary": {
                "value": "The paper proposes DreamFuser, an algorithm that synergistically combines diffusion models and Q-learning for offline reinforcement learning. It models action sequences using a conditional diffusion model and incorporates the diffusion process into the MDP as hidden transitions, enabling efficient Q-function optimization. Experiments on D4RL and robot control tasks demonstrate significant improvements over strong baselines."
            },
            "soundness": {
                "value": "2 fair"
            },
            "presentation": {
                "value": "3 good"
            },
            "contribution": {
                "value": "2 fair"
            },
            "strengths": {
                "value": "1. The idea of incorporating the diffusion process into the MDP as hidden transitions is creative, and enables more efficient policy learning and optimization.\n2. DreamFuser elegantly combines diffusion modeling and Q-learning in a mutually beneficial way. The sequence modeling handles multimodality while Q-learning enables optimization.\n3. The empirical results are quite strong, with DreamFuser outperforming state-of-the-art methods on both D4RL and robotic manipulation tasks. The consistent gains are impressive.The ablation studies clearly demonstrate the value addition from Q-learning, sequence modeling, and dynamics modeling in DreamFuser"
            },
            "weaknesses": {
                "value": "1. The paper does not sufficiently analyze the increased computational costs and inference times resulting from modeling longer action sequences. Using longer sequences increases training and memory requirements, as well as inference latency. A quantification of these costs compared to shorter sequence models would be useful to characterize the trade-offs.\n2. The optimal sequence length likely varies across different tasks and environments. More ablation studies on a diverse set of tasks could help identify the best sequence lengths for different problem settings. This could make the method more adaptable and provide more concrete recommendations on sequence length selection.The sequence length is a difficult hyperparameter to tune. The paper could explore adaptive methods to automatically adjust sequence lengths during training to reduce the burden of manual tuning for each task.\n3. The paper does not provide an in-depth analysis comparing DreamFuser to prior diffusion model methods like DD and Diffuser using similar length action sequences. Clarifying the key differences and improvements would strengthen the claims.\n4. The paper lacks results comparing DreamFuser against Diffusion Policy on the D4RL benchmarks for mujoco and antmaze tasks. This is an essential control experiment to demonstrate the effectiveness of DreamFuser over diffusion modeling alone.\n5. From my perspective, this work combines elements from prior work like Q-values guide diffusion policy from diffusion policy, and trajectory generation from diffuser. While the approach is technically sound, the fundamental conceptual advance appears incremental. The novelty may be limited and no insight for me without deeper analysis and comparison."
            },
            "questions": {
                "value": "Please see the weakness above and address my concerns."
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "3: reject, not good enough"
            },
            "confidence": {
                "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
            },
            "code_of_conduct": {
                "value": "Yes"
            },
            "first_time_reviewer": {
                "value": "Yes",
                "readers": [
                    "ICLR.cc/2024/Conference/Program_Chairs",
                    "ICLR.cc/2024/Conference/Submission9052/Senior_Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission9052/Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission9052/Reviewer_vgVx"
                ]
            }
        },
        "number": 2,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission9052/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698742564296,
        "cdate": 1698742564296,
        "tmdate": 1699637140048,
        "mdate": 1699637140048,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "TIqxRVgKfo",
        "forum": "9jmUwjZi7j",
        "replyto": "9jmUwjZi7j",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission9052/Reviewer_pkRP"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission9052/Reviewer_pkRP"
        ],
        "content": {
            "summary": {
                "value": "The paper develops a learning protocol that integrates reinforcement learning (RL) with diffusion models, jointly training the underlying diffusion with a Q-function. The results are compared against five baselines."
            },
            "soundness": {
                "value": "2 fair"
            },
            "presentation": {
                "value": "1 poor"
            },
            "contribution": {
                "value": "2 fair"
            },
            "strengths": {
                "value": "Strengths\n* The concept of integrating diffusion models with RL is interesting.\n* The paper compares the method against five baselines.\n* The paper claims that the method outperforms baselines on most of the considered tasks."
            },
            "weaknesses": {
                "value": "Summary of weaknesses (for details, see below):\n* It is not clear how the \"inference\" of the method works (i.e., having everything trained: how do we execute actions? is $Q$-value used? do we only sample from the diffusion policy? etc.). There is no pseudo-code provided.\n* It is not clear what the components of the method are.\n* The loss formulas seem not to reconcile with the formalism of GNMD introduced in the paper.\n* The experimental section is lacking.\n\nThe method:\n* Figure 1, the main visual help to understand what is happening, seems to be attached to Section 4.1. However, it is being explained in  Section 4.2, an unfortunate layout choice, which extends the time needed to understand the approach. \n* Section 4.2 is confusing\n\t* It seems that the dynamics works like this:\n\t\t* for $k>0$, sampling an action $A_t^{k-1}\\sim \\pi(\\cdot|\\hat{s})$, with $\\hat{s}=(O_t, A_t^k)$ transitions to $\\hat{s}'=(O_t, A_t^{k-1})$.\n\t\t\t* This suggests that the correct formula for the \"consistency\" loss should be: $$\\mathcal L_{consistency}=\\left(\\gamma_2\\mathbb E_{A_t^{k-2}\\sim \\pi(\\cdot|\\hat{s}')} [Q_\\phi(\\hat{s}', A_{t}^{k-2})] - Q_\\phi(\\hat{s}, A_t^{k-1}) \\right)^2.$$\n\n\t\t* for $k=0$, $\\hat{s}=(O_t,A_t^0)$, the action is always $\\epsilon\\sim N(0,I)$, and the resulting the new state is $\\hat{s}'=(O_{t+l}, \\epsilon)$,\n\t\t\t* This suggests that the correct formula for the MSBE loss should be: \n\t\t$$\\mathcal L_{MSBE}=\\left((\\mathcal R_t + \\gamma Q_\\phi(\\hat{s}', A_{t+l}^{K-1})) -Q_\\phi(\\hat{s}, \\epsilon) \\right)^2.$$\n\t* The last term in equation (9) is unclear.\n\t* $\\epsilon_{t,k}$ in equation (10) is not defined.\n\t* TD3 is mentioned, but the losses do not reflect this (details are mentioned in passing in Appendix B.1, but no formula is provided).\n\t* There is no pseudo-code for the training protocol in the main paper (it can only be found in the Appendix).\n* In the Introduction, it is written that \"DreamFuser integrates a learned dynamic model\". It is only briefly mentioned in Section 5, paragraph \"effectiveness of the learned model\". However, Appendices B.2-3 unexpectedly describe GRU, stating that the diffusion policy now inputs history states $O_t$, noisy sequence $A_t^k$, and predicted future states $O_t'^{k}$ (which is not defined). This seems like an important piece of information, and its omission from the main body of the paper creates confusion as to how the method works. Additionally, transformers make their appearance. What also adds to the confusion is the introduction of $K_{inference}=4$ in B.2. which seems to be used as $K$, but it is not (it is chosen \"independently of chosen value for K\").\n\nExperiments:\n* Results are computed for a low number of seeds (equal to 3, information which can only be found in the Appendix). Additionally, no confidence intervals for the reported numbers are reported, which makes it hard to infer the relative performance of the methods (however, for three seeds, CIs might be too noisy to be informative).\n* In Section 5.2, it is mentioned that DreamFuser converges to optimal actions. Why?\n* In Section 5.2, it is written that the \"proposed trajectory learning optimization technique for Q values proves effective notably excelling in tasks labeled as 'umaze'\". What is the reason for that? How is it connected with the diffusion process?\n* Figures 2(a) and (c) show strange behavior in learning curves, which is not discussed. \n* The results in Figure 2(a-b) are only presented for length 1 or 7. What about other values?\n\nOther:\n* It would be interesting to investigate whether the method's success is related to specific features of the chosen environments (and if so, what features).\n* In equation (15), there should be $\\epsilon \\sim N(0, I)$."
            },
            "questions": {
                "value": "See above."
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "3: reject, not good enough"
            },
            "confidence": {
                "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
            },
            "code_of_conduct": {
                "value": "Yes"
            },
            "first_time_reviewer": {
                "value": "Yes",
                "readers": [
                    "ICLR.cc/2024/Conference/Program_Chairs",
                    "ICLR.cc/2024/Conference/Submission9052/Senior_Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission9052/Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission9052/Reviewer_pkRP"
                ]
            }
        },
        "number": 3,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission9052/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698870921622,
        "cdate": 1698870921622,
        "tmdate": 1699637139902,
        "mdate": 1699637139902,
        "license": "CC BY 4.0",
        "version": 2
    }
]