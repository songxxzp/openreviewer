[
    {
        "id": "owDCamiQ6I",
        "forum": "xEJMoj1SpX",
        "replyto": "xEJMoj1SpX",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission3513/Reviewer_tyf7"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission3513/Reviewer_tyf7"
        ],
        "content": {
            "summary": {
                "value": "This paper studies the problem of exposure bias in diffusion models.  Exposure bias is defined as the input mismatch between $x_t$ during training and $\\hat{x}_t$ during sampling, which results error accumulation during sampling and eventual sampling drift. This in turn affects the quality of generated images. \n\nThe primary cause of exposure bias is ascribed to the difference between the growth truth posterior distribution $q(x_{t-1} | x_t, x_0)$ and the sampling distribution $q(x_{t-1} | x_t, \\hat{x}^t_\\theta)$. In practice, the difference between the prediction $\\hat{x}_\\theta^t$ and ground truth $x_0$ is non-zero. The paper analytically shows that this is due to increased variance at sampling time which results in accumulation of error during sampling. Inspired by the error in variance, a metric to measure exposure bias is also proposed by drawing inspiration from FID. \n\nTo alleviate exposure bias, this work proposes a method called Epsilon scaling which can be used at sampling and does not require re-training/finetuning of diffusion models. The core idea is to scale down the predicted $\\epsilon_\\theta^s$ at sampling so that it is closer to training $\\epsilon_\\theta^t$.  \n\nQualitative and quantitative results indicate that the proposed method results in improved FID scores and helps in alignment of sampling trajectory with training trajectory, thus reducing exposure bias."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "3 good"
            },
            "contribution": {
                "value": "3 good"
            },
            "strengths": {
                "value": "1. The paper is well-written. The paper provides a clear explanation about the problem of exposure bias and its causes by deriving expressions for sampling probability distribution that shows increased variance. It also provides clear intuition for different choices while designing the proposed method. For instance, the intuition for correcting $\\epsilon_\\theta$ to reduce exposure bias instead of reducing variance error has been explained clearly. \n2. The method is relatively simple and easy to implement as it introduces a scaling factor in the sampling process of diffusion models and does not require re-training of diffusion models. Previous method by Ning et al. (2023) mitigates this issue by perturbing inputs during training which requires retraining diffusion models. \n3. The proposed method improves FID scores significantly for different families of diffusion models like DDPM, DDIM, ADM, EDM and LDM. \n4. The primary contribution of this work which is empirical demonstration of the fact that correction of exposure bias can be done without retraining diffusion models is valuable."
            },
            "weaknesses": {
                "value": "1. The proposed method of Epsilon scaling is not tuning-free as it is sensitive to the choice of hyper parameter of the schedule $\\lambda_t = kt+ b$ and thus requires extensive hyper parameter tuning. The choice of optimal hyperparameters varies for each dataset as well as the number of sampling steps T. As per Table 10, Table 11 and Table 12, values of k and b have been tuned up to 4th or even 5th decimal place. For instance, there are values like k=0.00022 , b=1.00291 in Table 10. This degree of hyperparameter tuning seems a bit extreme.  The paper is also missing relevant sensitivity analysis for hyperparameters k and b, and it would be useful to include it (both over large strides and small strides). \n2. The process of finding optimal hyperparameters for Epsilon scaling seems to be slow and can be computationally intensive.  Usually, generating 10K sampling to calculate FID takes several minutes for small sampling steps and several hours for large sampling steps. Tuning hyper-parameters for each dataset and each choice of sampling length T, can thus require lot of GPU compute and time. While the method itself is simple, tuning this method for optimal performance can be tricky.\n3. In Table 3, for CIFAR-10, values of EDM for VP and VE should be reported for NFE=35 which gets FID = 1.97 (VP) and 1.98 (VE) on CIFAR-10, respectively. Underreporting FID values of EDM is a bit misleading."
            },
            "questions": {
                "value": "1. In Figure 5, Figure 9b and Figure 10b, what is the reason for smaller values of $\\| \\epsilon \\|_2$ of ADM-ES compared to its values at training time towards end of sampling (time steps 18-21)?\n2. Could the authors include the number of sampling steps in qualitative results in Figures 11-15?\n3. Could the authors indicate the amount of compute (number of GPUs as well as time) needed to find optimal hyperparameters?"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "8: accept, good paper"
            },
            "confidence": {
                "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
            },
            "code_of_conduct": {
                "value": "Yes"
            },
            "first_time_reviewer": {
                "readers": [
                    "ICLR.cc/2024/Conference/Program_Chairs",
                    "ICLR.cc/2024/Conference/Submission3513/Senior_Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission3513/Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission3513/Reviewer_tyf7"
                ]
            }
        },
        "number": 1,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission3513/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698786781338,
        "cdate": 1698786781338,
        "tmdate": 1700717407352,
        "mdate": 1700717407352,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "wwoxkdcHN7",
        "forum": "xEJMoj1SpX",
        "replyto": "xEJMoj1SpX",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission3513/Reviewer_gcKq"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission3513/Reviewer_gcKq"
        ],
        "content": {
            "summary": {
                "value": "This work focuses on the `exposure` bias problem for diffusion models. The exposure bias is caused by error accumulation across the sampling trajectory since during inference only samples from the previous timestep step are used, while during training samples are exposed to ground truth training. The work then quantifies and analyzes the exposure bias during inference, during different timesteps showing the error is high by the end of sampling (for multi-step sampling) and shows a monotonic trend. Lastly, the paper proposes epsilon scaling as an inference time sampling strategy to mitigate this issue and shows higher quality generations compared to other samplers while (slightly) improving FID."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "3 good"
            },
            "contribution": {
                "value": "2 fair"
            },
            "strengths": {
                "value": "1. The work does an overall good job of introducing and explaining exposure bias. The section itself was didactic and a valuable portion of the paper. Results are shown for simple single and multi-step samplings that quantify the variance error caused by exposure bias.\n2. The work then proposes a simple approach to reduce the exposure bias, by scaling the norm of the predicted noise term. The work also shows that the scaling factor needs to be handled differently when sampling for different number of steps. \n3. Results are shown for several different variants of diffusion models, and several baseline samplers are considered. The proposed method shows competitive FID scores with similar or fewer timesteps."
            },
            "weaknesses": {
                "value": "1. Results for the proposed epsilon-scaling mechanism with DDIM solver aren't impressive. There's only a marginal change in the FID score, compared to the DDIM sampler which is used as a popular framework for many diffusion models. Here, the gains are marginal even for cases with reasonable timesteps (~50 or more).\n2. There is little information provided regarding how the scaling factor $k$ and $b$ are selected, and how many hyperparameters were searched for optimal $k$ and $b$. It would also be good to quantify sensitivity to these hyperparameters."
            },
            "questions": {
                "value": "1. Does the method perform worse than Heun solvers with suboptimal $k$ and $b$ selection?"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "6: marginally above the acceptance threshold"
            },
            "confidence": {
                "value": "2: You are willing to defend your assessment, but it is quite likely that you did not understand the central parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
            },
            "code_of_conduct": {
                "value": "Yes"
            },
            "first_time_reviewer": {
                "value": "Yes",
                "readers": [
                    "ICLR.cc/2024/Conference/Program_Chairs",
                    "ICLR.cc/2024/Conference/Submission3513/Senior_Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission3513/Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission3513/Reviewer_gcKq"
                ]
            }
        },
        "number": 2,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission3513/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698879726638,
        "cdate": 1698879726638,
        "tmdate": 1699636304813,
        "mdate": 1699636304813,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "hOezNHNdq9",
        "forum": "xEJMoj1SpX",
        "replyto": "xEJMoj1SpX",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission3513/Reviewer_ujfx"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission3513/Reviewer_ujfx"
        ],
        "content": {
            "summary": {
                "value": "This paper investigates the exposure bias problem in diffusion models by modeling sampling distribution, based on which they attribute the prediction error at each sampling step as the root cause of the exposure bias issue. They discuss potential solutions to this issue and propose a metric for it. Along with the elucidation of exposure bias, we propose a simple, yet effective, training-free method called Epsilon Scaling to alleviate the exposure bias. \nExperiments on various diffusion frameworks, unconditional and conditional settings, and deterministic vs. stochastic sampling verify the effectiveness of this method."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "2 fair"
            },
            "contribution": {
                "value": "3 good"
            },
            "strengths": {
                "value": "1. It is interesting and insightful to take in-depth exploration on the exposure bias problem in diffusion models. This paper connects exposure bias with prediction error and gives the expressions of prediction error.\n\n2. To solve the exposure bias in a learning-free manner, this paper proposes to scale the noise prediction in the sampling process to match the noise prediction in the training process. \n\n3. Solid experiments. Extensive experiments demonstrate the generality of Epsilon Scaling and its applicability to different diffusion architectures."
            },
            "weaknesses": {
                "value": "1. The main concern lies in the assumption at the start of the derivation. In part 3.2, the authors assume that the reconstructed image x_{\\theta}^t at the sampling process follows the Gaussian distribution, where the mean is the GT image x_0, and the variance is the Gaussian noise. This conflicts with some intuitive observations. For example, the reconstructed image x_{\\theta}^t is often a degraded version of the GT image, and the mean of x_{\\theta}^t is different from x_0. \n\n2. Some formulations, notations and explanations in part 3.1 and 3.1 are redundant. It is highly recommended to improve the organization and the writing of this section.\n\n3. It is necessary to discuss the further meaning and defects of exposure bias correction. For instance, the necessity of matching the forward and sampling process. Reducing such bias forces the generated images to be more similar to the training images in distribution, i.e, more data repetition in the generated images. The authors are encouraged to give more discussions."
            },
            "questions": {
                "value": "Please refer to the questions in the Weaknesses."
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "6: marginally above the acceptance threshold"
            },
            "confidence": {
                "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        },
        "number": 3,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission3513/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1699067084781,
        "cdate": 1699067084781,
        "tmdate": 1699636304701,
        "mdate": 1699636304701,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "6Klyh6hNhj",
        "forum": "xEJMoj1SpX",
        "replyto": "xEJMoj1SpX",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission3513/Reviewer_FqVz"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission3513/Reviewer_FqVz"
        ],
        "content": {
            "summary": {
                "value": "The paper studies the \"exposure bias\" in diffusion models, which boils down to the statistical discrepancy between neural predictions at different time $t$. To alleviate the issue, the authors propose a simple scaling strategy to match the norm of neural predictions at training and sampling time. The idea is to calculate the related empirical statistics and then determine the scaling factor at different time $t$. Empirically, the proposed scaling method improve the baseline across architectures, noisy schedule and datasets."
            },
            "soundness": {
                "value": "2 fair"
            },
            "presentation": {
                "value": "2 fair"
            },
            "contribution": {
                "value": "3 good"
            },
            "strengths": {
                "value": "- The paper tries to address an important issue in diffusion models, where the initial error accumulation can negatively affect the quality of the generated samples.\n\n- It introduces a method that employs the empirical $\\ell_2$ ratio during both training and sampling phases to decide the appropriate scaling factor. This technique is straightforward yet proves to be effective.\n\n- Extensive experiments show that the proposed method can consistently improve the pre-trained models across datasets."
            },
            "weaknesses": {
                "value": "- Several prior works have observed and identified the \"exposure bias\" problem studied in the current paper. It would be helpful to discuss them in the paper: (1) Section 4 (practical considerations) and Fig 13 in EDM [1] points out that the neural network tends to remove slightly too much noise. Hence they use an inflated noise to counteract it. I think adding $S_{noise}$ into ODE or SDE samplers is a valid baseline for the current paper. (2) Section 4.2 in PFGM [2] / Section 5, Fig 4.b in PFGM++ [3] further dig into the exposure bias problem and show that the strong norm-t relation in the diffusion model is the cause. \n\n- The current paper demonstrates the discrepancy of the prediction norms (Fig 2) without further examining the reason. [2] seems to offer a plausible explanation for this phenomenon. If their argument is true, this \"exposure bias\" mainly occurs in large $t$ (norm-t is strongly correlated). I guess one simple experiment to validate the hypothesis is to use true score up to a certain time $t$ during sampling and study the effects (like current Fig.2, but the green and red curve would be the same in [t,T]).\n\n\n- It's encouraging to see that the method improves over EDM, especially in the small NFE regime. Could the authors try to apply the method on PFGM++, which is claimed to be more robust to the \"exposure bias\"? It could also verify if or not the exposure bias is due to the strong norm-t correlation pertaining to diffusion models.\n\n### Minors\n\n- I think the prediction error is not $x^t_\\theta - x_0$ but $x^t_\\theta - E_{x_0|x_t}[x_0]$.\n\n[1] Elucidating the Design Space of Diffusion-Based Generative Models, NeurIPS 2022\n\n[2] Poisson Flow Generative Models, NeurIPS 2022\n\n[3] PFGM++: Unlocking the Potential of Physics-Inspired Generative Models, ICML 2023\n\nOverall I'm impressed by the empirical performance of the proposed methods. However, there are many loose threads (the reasoning of exposure bias, the question below, comparing to related work (e.g., EDM inflating). I will raise my score if the authors address some of them."
            },
            "questions": {
                "value": "- I don't immediately see why the quotient of $\\Delta N(t) = |\\epsilon^s|/|\\epsilon^t|$ can be translated into the scaling factor at $\\epsilon(x_t,t)$ during sampling. Because $\\Delta N(t) = |\\epsilon^s|/|\\epsilon^t|$ and $\\Delta N(t)=\\int_t^T \\lambda_t$ only implies that $\\frac{d |\\epsilon^s(x_t,t)|/|\\epsilon^t(x_t,t)|}{dt}=\\lambda_t$. \n\nI tried the simplest data distribution I can come up with --- $p(x)=\\delta(x-0)$. The argument even failed in this case. (I use the notation in EDM and assume $t=\\sigma$). The true $\\epsilon$ at $x_t$ is $\\epsilon(x_t,t) = -\\frac{x_t}{t^2}$. By solving the diffusion ODE $dx/dt = -\\frac{x_t}{t}$ we get $x_t = \\frac{Tx_T}{t}$ (assume the start point at time $T$ is $x_T$). However, when we scale $\\epsilon$ by $\\lambda_t$, the resulting $x_t$ does not directly relate to $\\Delta N(t)=\\int_t^T \\lambda_t$, but a interval over $\\lambda_t/t$. I suggest rethinking the principled way of scaling by working out the toy example first."
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "5: marginally below the acceptance threshold"
            },
            "confidence": {
                "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        },
        "number": 4,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission3513/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1699075660872,
        "cdate": 1699075660872,
        "tmdate": 1699636304632,
        "mdate": 1699636304632,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "2roaJSJf2c",
        "forum": "xEJMoj1SpX",
        "replyto": "xEJMoj1SpX",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission3513/Reviewer_nv6a"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission3513/Reviewer_nv6a"
        ],
        "content": {
            "summary": {
                "value": "This paper take account into the exposure bias problem in the diffusion model, which is the distribution shift between the distribution derived by the forward diffusion process and the (learned) reverse diffusion process at the same time. The exposure bias phenomenon starts with the observation that the expected noise (or signal) from a noisy input, or a drawn sample within the trajectory, is not accurately evaluated. Precisely, the variance of the expected signal given the more-noisy signal is greater in the generative reverse process than in the forward process. The intuitive approach to overcome this is to directly downscale the noise variance term with respect to the variance ratio, but from existing works, this is infeasible because when doing this, the output variance term will be outbounded to the (theoretically available) noise schedule. However, these existing works does not explain the ill performance in the low-NFE regime. This leads to the hypothesis that the negative effect of the exposure bias exceeds the gain of the optimal variance.\n\nEven though there exist some works that deal with the exposure bias, they all consider re-training of the existing diffusion models, which is costly and sometimes require additional hyperparameter tuning. To alleviate this, this paper proposes a new calibration method called epsilon scaling. The method of epsilon scaling is derived simply by a data-driven approach: draw expected noise from the training set (noisy data as input) and from sampling trajectory (intermediate particle in the trajectory) and compare the expected noise term. The motivating experiment shows that the noise term of the sampling data is always greater than that of the training data, and can be intuitively scaled via the ratio between the expectation of the training and sampling estimated noise mean. The experimental session shows that in a mid-NFE regime (20~100), this shows superior performance compared to non-calibrated cases. Moreover, the paper validates that this method alleviates the exposure bias."
            },
            "soundness": {
                "value": "4 excellent"
            },
            "presentation": {
                "value": "4 excellent"
            },
            "contribution": {
                "value": "3 good"
            },
            "strengths": {
                "value": "* The background and the motivating section is well clarified, by first notifying the necessity of calibrating the expected noise term in the diffusion sampling, and then compare the existing method to the newly proposed method.\n* To the best of our knowledge, this paper is the first training-free method that calibrates the distribution drift (e.g. exposure bias), by modifying the neural network output with some dataset statistics.\n* The experimental section showed that this training-free method works as a pipeline over a variety of existing diffusion model methods, including the early DDIM/ADM to the more recent LDM/EDM."
            },
            "weaknesses": {
                "value": "* Although this method is introduced as a simulation-free method, it is not completely simulation-free; in order to determine $\\lambda_t$ for each timestep, one can compute the dataset statistics with respect to all intermediate trajectory particle, which require some simulation. (But not heavy.)\n * The assumption that the model value $x_\\theta^t$ is averaged to the true $x_0$ should be more verified.\n * In the experimental section, only constant or linearized values are used as the scaling schedule $\\lambda_t$. This implies that constant reduction of the expected noise is helpful for the sampling process.\n * Analytic-DPM is also a simulation-free (only calculates the optimal variance over the timesteps) This paper proposed that the limit of the Analytic-DPM method is that this is not advantageous in the low-NFE regime, but this paper reproduces well even in low-NFE regime (NFE=10), if the variance clipping in high-SNR (last or second last sampling step) timesteps is held. The fair comparison in various NFE regime should be done, which can affect the scoring of this paper."
            },
            "questions": {
                "value": "* What about the case that the NFE is less than 20 or greater than 100?\n * At least for small NFE, I recommend adding some ablation studies on fully-searched $\\lambda_t$ with respect to all timesteps, rather than fixing this to the fixed value $b$ or taking a linear approximation.\n * It will more support the method, if the bias of the expected noise $\\epsilon_\\theta^s$ or $\\epsilon_\\theta^t$. This helps the reader to understand that by simply scaling down the expected noise calibrates the sampling steps, without taking bias (i.e. translating) the noise.\n\n======\n\nMiscellaneous\n * In the line below Equation 7, does $q ( x_t|x_{t+1},x_\\theta^{t+1})$ have the same distribution as $q(x_{t+1}|x_t,x_\\theta^t)$?\n * The exposure bias term $\\delta_t$ should be more precisely denoted in the main section. This proposed metric is only introduced in detail in the appendix section.\n * It will be helpful if the Analytic-DPM and the existing exposure bias methods are also considered as the benchmark, even though this does not use the baseline reverse diffusion process by modifying \n * It will be also helpful also to be mentioned if the Analytic-DPM requires the heavy clipping of the noise variance $\\beta_t$ in the near-signal part of the sampling, which causes"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "details_of_ethics_concerns": {
                "value": "None."
            },
            "rating": {
                "value": "6: marginally above the acceptance threshold"
            },
            "confidence": {
                "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
            },
            "code_of_conduct": {
                "value": "Yes"
            },
            "first_time_reviewer": {
                "value": "Yes",
                "readers": [
                    "ICLR.cc/2024/Conference/Program_Chairs",
                    "ICLR.cc/2024/Conference/Submission3513/Senior_Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission3513/Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission3513/Reviewer_nv6a"
                ]
            }
        },
        "number": 5,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission3513/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1699602945867,
        "cdate": 1699602945867,
        "tmdate": 1699636304554,
        "mdate": 1699636304554,
        "license": "CC BY 4.0",
        "version": 2
    }
]