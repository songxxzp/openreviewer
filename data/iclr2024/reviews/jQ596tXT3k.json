[
    {
        "id": "aYLEsy1R73",
        "forum": "jQ596tXT3k",
        "replyto": "jQ596tXT3k",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission8543/Reviewer_i5V7"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission8543/Reviewer_i5V7"
        ],
        "content": {
            "summary": {
                "value": "The paper proposes a new method for out-of-distribution detection using a normalizing flow. The method is motivated by the Local Intrinsic Dimension estimation using approximate Likelihood (LIDL) and at a high level rejects a datapoint as OOD if either its density or local intrinsic dimension is low. The paper presents an approximation to LIDL that allows it to be applicable given just a single normalizing flow. The authors choose hyperparameters for their approach by considering SVHN vs. CIFAR and the reverse as validation tasks and show good OOD detection performance across eight different image dataset pairs."
            },
            "soundness": {
                "value": "2 fair"
            },
            "presentation": {
                "value": "2 fair"
            },
            "contribution": {
                "value": "3 good"
            },
            "strengths": {
                "value": "1. Originality: The paper is the first to my knowledge to use an estimate of local intrinsic dimension to detection OOD datapoints. The authors come up with an approximation to a recent estimation technique for LID that allows it to be utilized with a single normalizing flow. \n2. Quality: The authors present great visualizations and and good supplemental analyses to the main results.\n3. Clarity: The method and experiments are clearly written.\n4. Significance: The authors address an interesting problem and propose a new angle."
            },
            "weaknesses": {
                "value": "Soundness:\n1. The approximation of $\\log \\rho_r(\\mathbf{x})$ comes about by using a first-order Taylor approximation of the invertible function $f_\\theta$ defining the flow. It's not clear to me how this upstream approximation affects the downstream approximation of the actual quantity of interest, $\\rho_r(\\mathbf{x})$. In addition, the fact that $\\hat{\\rho}_r(\\mathbf{x})$ is shown to be a poor approximation of $\\rho_r(\\mathbf{x})$ in \"Identifying Sharp Likelihood Peaks\" (in that the order for ID and OOD data is the opposite of what is intended) makes it a bit tenuous why it's ok for the $\\hat{\\rho}_r(\\mathbf{x})$ to be used to approximate $\\rho_r(\\mathbf{x})$ in $\\frac{\\partial}{\\partial r}\\log \\rho_r(\\mathbf{x})$.\n2. The proposed method is sensitive to choice of $r$, yielding almost no separation between datasets under some values of $r$. The authors instead set hyperparameters using two of the dataset pairs, CIFAR-10 vs. SVHN and the reverse, yet these two benchmarks are also two of the eight benchmarks presented in the main results, and at least one of the datasets is in four of the eight benchmarks. \n\nPresentation:\n1. It would benefit the authors to be a bit more careful in their discussion about manifolds and sub-manifolds. Namely, it is a bit strange to hypothesize that OOD data lies on a lower-dimensional submanifold than ID data and call these \"lower probability mass\" regions, since a submanifold constitutes a measure-zero set with respect to the Lebesgue measure of the ambient dimension of the data. At one point the authors use the phrase \"concentrate around a lower-dimensional submanifold\" which might be better, but it would be helpful to formalize what the authors mean so that the hypothesis makes mathematical sense.\n2. The first contribution claimed by the paper (to explain how DGMs can assign higher likelihood to OOD datapoints yet only generate in-distribution samples) has already been offered by previous work. See section 5.1 in [1], which offers the same explanation as the one given in this current submission, i.e. \"OOD datapoints can be assigned higher likelihood while not being generated if they belong to regions of low probability mass.\" Moreover, in the related work, the authors repeat arguments made in [1] as if they were their own, e.g. \"...we challenge this assumption...\"\n3. In Sec 4.1, the authors start by considering a uniform distribution over the volume of a given R-radius ball but then switch mid-paragraph to considering a uniform distribution on just the surface of said ball. It would help to explicitly mention the phenomenon that in high dimensions nearly all the volume is at the surface to justify the jump.\n\n[1] Zhang et al. 2021. Understanding Failures in Out-of-Distribution Detection with Deep Generative Models. ICML 2021."
            },
            "questions": {
                "value": "1. Do the authors have any analysis to suggest that $\\hat{\\rho}_r(\\mathbf{x})$ should be a good approximation of $\\rho_r(\\mathbf{x})$?\n2. Can the authors provide evidence that this method works better than, say, an arbitrary statistic of the generative model that is validated to perform well on both SVHN vs. CIFAR-10 and the reverse? How about that the proposed method is robust to the validation strategy (e.g. alternative dataset pairs or different strategy altogether)?\n\nI think the paper has the potential to yield an interesting contribution if at least one of the above questions is addressed. In such a scenario, provided the above weaknesses are also addressed, I would be happy to raise my score."
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "6: marginally above the acceptance threshold"
            },
            "confidence": {
                "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
            },
            "code_of_conduct": {
                "value": "Yes"
            },
            "first_time_reviewer": {
                "value": "Yes",
                "readers": [
                    "ICLR.cc/2024/Conference/Program_Chairs",
                    "ICLR.cc/2024/Conference/Submission8543/Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission8543/Reviewer_i5V7",
                    "ICLR.cc/2024/Conference/Submission8543/Senior_Area_Chairs"
                ]
            }
        },
        "number": 1,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission8543/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698639839830,
        "cdate": 1698639839830,
        "tmdate": 1700616963907,
        "mdate": 1700616963907,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "SMnaDwuTmr",
        "forum": "jQ596tXT3k",
        "replyto": "jQ596tXT3k",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission8543/Reviewer_c1to"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission8543/Reviewer_c1to"
        ],
        "content": {
            "summary": {
                "value": "This paper tried to explain the paradox \"OOD samples are never generated by these DGMs despite having\nhigh likelihoods\" and propose using the probability mass that the model assigns to a small neighborhood of a data sample as the OOD detection method."
            },
            "soundness": {
                "value": "2 fair"
            },
            "presentation": {
                "value": "3 good"
            },
            "contribution": {
                "value": "2 fair"
            },
            "strengths": {
                "value": "This paper analyzes the availability and efficiency of using LID estimators for OOD detection and proposes to use density-based methods instead of the previous data-based ones. Specifically, it is inspired by a previous observation of adding Gaussian noise to corrupt the density, which is easy to understand but low-efficiency in computing as multiple NFs are needed, the authors propose a much more efficient method that only needs one pre-trained NF."
            },
            "weaknesses": {
                "value": "**W1:** The claim **\"This observation becomes even more puzzling in light of the fact that said DGMs generate\nonly in-distribution samples...\"**, which is also the major motivation of this work, could be wrong. Though existing research always takes a different dataset like SVHN as an OOD dataset to quantitatively evaluate the model's OOD detection performance when trained on IID dataset like CIFAR-10, we should not only focus on these real-world datasets. For example, when drawing multiple generations out of a deep generative model, some of the generation samples could be very different and low-quality compared to the IID training set, where these samples should also be seen as OOD samples. When considering these OOD samples, the claim could be wrong. Overall, if the generative model cannot exactly model $p(x_{IID})$, there is no guarantee that a deep generative model would never generate OOD samples, otherwise there would be no such \"puzzling behavior\".\n\n**W2:** There are already some theoretical explanations for the flow-based generative model's over-confidence in OOD samples, such as the location and variances of the data and the model curvature [1]. Thus, what is the difference between their interpretation and the explanation in this paper? \n\n[1] Do Deep Generative Models Know What They Don't Know? ICLR 2019.\n\n**W3:** The proposed method highly depends on a strong assumption that the probability mass around an OOD sample is negligible. However, the authors seem not to provide sufficient support for this assumption, which may weaken the convincing of the proposed methods. And the experiments can also not support this assumption well, as the tested datasets are limited. Actually, not all OOD datasets would be assigned higher likelihoods by flow models [2], like detecting random noise images as OOD, what would happen when applying this method to these datasets? Besides, these OOD datasets especially random noise may not be \"sharply peaked\" as they are distributed widely in the input space.\n\n[2] Input Complexity and Out-of-distribution Detection with Likelihood-based Generative Models. ICLR 2020.\n\n**W4:** \"The explanation for the OOD paradox\" is a little bit weak and empirical."
            },
            "questions": {
                "value": "Here are some minor questions.\n\n**Q1:** As claimed \"While our main ideas are widely applicable to likelihood-based DGMs\" in Section 4, I am wondering how this could be applicable to DGMS like diffusion models or VAEs since these two kinds of DGMs are optimizing a lower bound of the marginal data likelihood."
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "5: marginally below the acceptance threshold"
            },
            "confidence": {
                "value": "1: You are unable to assess this paper and have alerted the ACs to seek an opinion from different reviewers."
            },
            "code_of_conduct": {
                "value": "Yes"
            },
            "first_time_reviewer": {
                "value": "Yes",
                "readers": [
                    "ICLR.cc/2024/Conference/Program_Chairs",
                    "ICLR.cc/2024/Conference/Submission8543/Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission8543/Reviewer_c1to",
                    "ICLR.cc/2024/Conference/Submission8543/Senior_Area_Chairs"
                ]
            }
        },
        "number": 2,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission8543/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698747209816,
        "cdate": 1698747209816,
        "tmdate": 1700733613722,
        "mdate": 1700733613722,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "CjCPY8JcGY",
        "forum": "jQ596tXT3k",
        "replyto": "jQ596tXT3k",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission8543/Reviewer_urvk"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission8543/Reviewer_urvk"
        ],
        "content": {
            "summary": {
                "value": "This paper investigates the well known issue of probabilistic generative model assigning higher likelihood to simple OOD data. It proposes a feasible way to estimate the probability mass around a datapoint, instead of just the value of the density function. Doing so allows filtering sample with high density but low probability mass around it (i.e., sharp density function), and hence can be a reliable OOD detector. Empirical results verify the effectiveness of this method."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "4 excellent"
            },
            "contribution": {
                "value": "3 good"
            },
            "strengths": {
                "value": "1. The paper tackles a well known and important issue of using DGM for OOD detection. Multiple methods has been proposed to correct the likelihood misalignment of DGM, but this paper tackles the problem in a principled way, by estimating the probability mass. Although it is intuitively clear that OOD samples with high density must have low probability mass, it is highly non-trivial to actually compute the mass. This paper shed a light on that.\n\n2. The idea of estimating the probability mass is interesting. It smartly uses a linearization to obtained tractable Gaussian distribution, which, when doing convolution with another Gaussian distribution, results in tractable form. This is a clever design, and it's a significant technical contribution.\n\n3. The experimental results are promising, showing significant improvements over competing methods."
            },
            "weaknesses": {
                "value": "1. The current analysis is built exclusively on normalizing flows, while it does not have discussion of other models. In particular, for models like VAEs, where the exact likelihood is not available, is it still applicable?\n\n2. The way to determine the radius $r$ seems to be ad hoc. It depends on the dataset and the flow model as well. Is there a more principled way of choosing it? Can we just set r to be extremely small?"
            },
            "questions": {
                "value": "My questions are stated above."
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "6: marginally above the acceptance threshold"
            },
            "confidence": {
                "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        },
        "number": 3,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission8543/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698792232238,
        "cdate": 1698792232238,
        "tmdate": 1699637068412,
        "mdate": 1699637068412,
        "license": "CC BY 4.0",
        "version": 2
    }
]