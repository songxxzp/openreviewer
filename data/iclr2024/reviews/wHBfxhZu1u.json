[
    {
        "id": "tvyg4PH3CY",
        "forum": "wHBfxhZu1u",
        "replyto": "wHBfxhZu1u",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission6096/Reviewer_swin"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission6096/Reviewer_swin"
        ],
        "content": {
            "summary": {
                "value": "This paper proposed an encoding scheme that could change the after training context window size of a model without sacrificing performance."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "2 fair"
            },
            "contribution": {
                "value": "3 good"
            },
            "strengths": {
                "value": "1. Motivated and written well.\n2. An important problem to work on."
            },
            "weaknesses": {
                "value": "1. Connection to NTK stuff is very difficult to understand and somehow not convincing. I feel the only thing authors want to say is we shouldn't treat all dimensions equally, which IMO is already a good idea. Connecting to NTK stuff actually confused me quite a bit.\n\n2. Part of baseline in experiments could be missing."
            },
            "questions": {
                "value": "In page 4 you mentioned RoPE can't retain high frequency information, but you also say RoPE closely resembles Fourier Features (Tancik et al., 2020) in many aspects, as it is possible to define RoPE as a special 1D case of a Fourier Feature. But somehow I don't know why Fourier Feature can't learn high frequency stuff. Fourier Feature is just trying to map the basis to all sort of features and your description here is fairly confusing. Without a full proper explanation, I think the motivation will be fairly questionable then.\n\n2. Is there a training-free context window extension stuff that should be included? \n    At least the baseline should be just using encoding scheme as in T5 that we could just change the context window size. For certain task I tried, it doesn't really affect the performance much. So this should be treated as a baseline as well.\n\n3. Can you also add the real \"clock-time\" of training of these 3 methods (PI, NTK, YaRN) so we will have a better understanding what's the cost of using it?"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "6: marginally above the acceptance threshold"
            },
            "confidence": {
                "value": "2: You are willing to defend your assessment, but it is quite likely that you did not understand the central parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        },
        "number": 1,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission6096/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698709684165,
        "cdate": 1698709684165,
        "tmdate": 1699636657627,
        "mdate": 1699636657627,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "2ZNnByd51d",
        "forum": "wHBfxhZu1u",
        "replyto": "wHBfxhZu1u",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission6096/Reviewer_HiJG"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission6096/Reviewer_HiJG"
        ],
        "content": {
            "summary": {
                "value": "The paper presents YaRN (Yet another RoPE extensioN method), a compute-efficient method to extend the context window of large language models (LLMs) trained with Rotary Position Embeddings (RoPE). YaRN requires 10x less tokens and 2.5x less training steps than previous methods. The method combines attention scaling, \"NTK-by-parts\" interpolation, and dynamic scaling to achieve state-of-the-art performance in context window extensions. YaRN is compatible with libraries that modify the attention mechanism, such as Flash Attention, and allows for efficient extrapolation with fine-tuning on shorter datasets."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "3 good"
            },
            "contribution": {
                "value": "3 good"
            },
            "strengths": {
                "value": "- YaRN achieves state-of-the-art performance in context window extensions with significantly fewer training steps and tokens compared to previous methods.\n- The method is compatible with libraries that modify the attention mechanism, such as Flash Attention 2, making it more versatile for various use cases. It provides a drop-in replacement for Position Interpolation (PI) with no downsides and minimal implementation effort.\n- YaRN allows for efficient extrapolation with fine-tuning on shorter datasets, enabling faster convergence in compute-constrained scenarios. The paper also demonstrates the capability of YaRN to extrapolate beyond the limited context of a fine-tuning dataset, showcasing its ability to generalize to unseen context lengths.\n- The experimental design of the paper is scientific. The authors evaluate YaRN on various benchmarks, including long sequence language modeling, passkey retrieval, and standardized benchmarks. The results consistently show that YaRN outperforms previous methods in context window extensions, supporting the author's claims."
            },
            "weaknesses": {
                "value": "- The paper does not provide a comprehensive comparison of YaRN with other length extending methods in terms of computational efficiency and memory usage.\n- In the Related Work Section, the authors mention two works, ReRoPE and LM-Infinite, which tackle the same target in terms of extending LLM sequence length, and claim that they can extend to infinite length without severe loss expansion. If that is true, the contribution of YaRN will be greatly reduced (i.e., extend to 16k). Also, I am interested in the results of these two works compared to the proposed YaRN. I know due to the attention modification, they are not supported directly by Flash Attention. However, they represent a series of length extending methods. It would be better to compare them as well even under a small but fair setting.\n- Please provide more detailed data points or loss curves between PI and YaRN along with training tokens. Is it possible that with the same tokens, PI will converge faster than YaRN?"
            },
            "questions": {
                "value": "- In Table 5, for the PASSKEY retrieval experiment, why not keep all the settings the same? Now, 7B-PI is trained on 32k and 7B-YaRN is trained on 64k, it is difficult to compare and draw reasonable conclusions. Also, how do you explain that the PI method can get 100% ACC in terms of key retrieval, while YaRN can only get 96.3% ACC (see row 1 and 3 in Table 5), does this mean that YaRN may lose some ability compared to the PI method? Another question is, is the total number of tokens trained in all experiments in Table 5 the same?\n- In what aspects or tasks does the PI method have advantages over YaRN?\n- In what aspects or tasks does the NTK method have advantages over YaRN?\n- Under what circumstances should we use PI? Under what circumstances should we modify the base of rope?"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "8: accept, good paper"
            },
            "confidence": {
                "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        },
        "number": 2,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission6096/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698852643988,
        "cdate": 1698852643988,
        "tmdate": 1699636657528,
        "mdate": 1699636657528,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "dXjxuXuPel",
        "forum": "wHBfxhZu1u",
        "replyto": "wHBfxhZu1u",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission6096/Reviewer_t3XG"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission6096/Reviewer_t3XG"
        ],
        "content": {
            "summary": {
                "value": "This paper presents YaRN, a method to efficiently extend the context window of large language models pretrained with Rotary Position Embeddings (RoPE). The key contributions are:\n\n- Identifying issues with existing interpolation methods like Position Interpolation (PI) and proposing solutions:\n    - \"NTK-aware\" interpolation to preserve high frequency information\n    - \"NTK-by-parts\" interpolation to maintain local distance relationships \n    - Dynamic scaling for inference-time interpolation\n- Introducing an attention temperature hyperparameter for entropy control\n- Combining these techniques into YaRN, which extends context 10x more efficiently than prior work  \n\nThe method is evaluated by fine-tuning LLaMA models and testing on long-context perplexity, retrieving passkeys, and standard benchmarks. Results show YaRN matches or exceeds prior context extension techniques."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "2 fair"
            },
            "contribution": {
                "value": "3 good"
            },
            "strengths": {
                "value": "- The paper clearly identifies limitations of prior work on extending context for RoPE models and proposes principled solutions grounded in theory. This shows strong technical understanding.\n\n- The YaRN method is innovative in how it combines multiple solutions in a synergistic way to efficiently extend context. The temperature parameter for controlling entropy is also novel.\n\n- The experiments comprehensively evaluate perplexity on long sequences, passkey retrieval, and standardized benchmarks. The results demonstrate YaRN's capabilities for few-shot context extension and extrapolation. \n\n- The writing is clear and well-structured. The background builds intuition and the methodology explains each component of YaRN in a logical progression."
            },
            "weaknesses": {
                "value": "- The ablation study evaluating the impact of each proposed technique in isolation would help validate their necessity in YaRN.\n\n- More analysis and intuition explaining why the temperature parameter works would strengthen that contribution."
            },
            "questions": {
                "value": "- For the temperature parameter, did you try other hyperparameters or learning it? Why is attention temperature most effective?\n\n- You mention the temperature provides a uniform perplexity improvement over the context window. Can you elaborate why you think this is the case?\n\n- Can you include results quantifying the impact of each proposed technique independently?"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "6: marginally above the acceptance threshold"
            },
            "confidence": {
                "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        },
        "number": 3,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission6096/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698951517447,
        "cdate": 1698951517447,
        "tmdate": 1699636657407,
        "mdate": 1699636657407,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "MzBqlMzn3Q",
        "forum": "wHBfxhZu1u",
        "replyto": "wHBfxhZu1u",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission6096/Reviewer_x5Kh"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission6096/Reviewer_x5Kh"
        ],
        "content": {
            "summary": {
                "value": "This paper proposes a way of modifying RoPE embeddings so that they extrapolate better to sequences longer than the model was originally trained on. The YaRN method leverages a recent (unpublished) method, called \"NTK-by-parts\" [1], as well as modifying the default temperature value of the attention softmax. The NTK-by-parts method is based on the following observation: Performing position interpolation [2] on the high-frequency (small wavelength) RoPE rotation angles could make it such that neighboring tokens have rotation angles that are very difficult for the model to distinguish, thus potentially confusing the model regarding the relative positions of those tokens. Thus, the NTK-by-parts method functions by determining the amount of position interpolation to perform based on the frequency of the RoPE rotation angles: no interpolation is used for high-frequency angles, while standard interpolation is used for the low-frequency angles (and \"middle\" frequency angles are handled with some interpolation). Once these updates to the RoPE embeddings (and attention temperature) are made, the whole model is fine-tuned on a small amount of data (~0.1% of the pre-training corpus).\n\nThe YaRN method is shown to perform relative well relative to baseline RoPE extension methods across various experiments (e.g., long sequence language modeling, and several standard LLM benchmark tasks from HuggingFace Open LLM leaderboard).\n\n- [1] https://github.com/jquesnelle/yarn/pull/1\n- [2] S. Chen, S. Wong, L. Chen, and Y. Tian. Extending context window of large language models via\npositional interpolation, 2023. arXiv: 2306.15595."
            },
            "soundness": {
                "value": "2 fair"
            },
            "presentation": {
                "value": "2 fair"
            },
            "contribution": {
                "value": "3 good"
            },
            "strengths": {
                "value": "- The proposed method appears to perform well relative to a few baseline RoPE extension methods.\n- The proposed method is relatively well-motivated --- it seems like a reasonable idea to not interpolate for high-frequency rotation angles.\n- The proposed method has already been used in open-source LLMs in industry."
            },
            "weaknesses": {
                "value": "- I found the paper relatively difficult to follow. I think the method could be presented in a much simpler and more direct manner. The \"NTK-aware interpolation\" could likely be moved to the appendix, as it is not part of the YaRN method. The background section could be significantly shortened (currently 1.5 pages).\n- I think the experimental results could be much more thorough, and much more clearly presented.\n  - Including more baselines throughout all the experimental results: Standard RoPE embeddings (e.g., Llama-2), ALiBi, T5 relative position embeddings, absolute position embeddings, Position Interpolation (PI), NTK-aware interpolation, YaRN (with and without fine-tuning, with and without temperature scaling, with static vs. dynamic scaling, different scale factors, etc.).\n  - Replacing tables with plots (similar to Figure 4 in appendix, but with clearer+more baselines). The tables are more difficult to interpret. And the plots show results for short sequences as well as long sequences, which is helpful for understanding the performance of the method.\n  - Adding detailed ablations for YaRN, as mentioned above (with and without fine-tuning, with and without temperature scaling, with static vs. dynamic scaling, different scale factors, etc.).\n  - Choosing better baselines. Why are Together and Code Llama chosen as the main baselines? Why is PI not included in every table?\n\nOverall, given the issues with the presentation of the method and (most importantly) the experimental results, I have currently chosen \"marginal reject\" (I was torn between \"marginal accept\" and \"marginal reject\"). While I think the community could benefit from seeing the proposed idea (in particular, the part about only doing interpolation for low-frequency RoPE angles), I think there are currently too many open questions related to the results, and how this method compares with baselines (and with itself, with ablations), to accept the paper in the current form to a peer-reviewed conference. Open to being swayed though, given the potential of this line of work!"
            },
            "questions": {
                "value": "- In equation (17), should you be using $b'$ or $b$? It seems more natural to use $b$, and would be confusing to use $b'$, which already includes some scaling modifications.\n- For equations 19 and 20, isn't this equivalent to $g(m) = (1-\\gamma(r(d))) * (1/s) + \\gamma(r(d))$, and $h(\\theta_d) = \\theta_d$? Perhaps this would be simpler, to make this look more like the position interpolation equations (which only modify $g(m)$), as opposed to the \"NTK-aware\" equations which only modify $h(\\theta_d)$.\n- Can you show results of YaRN with and without fine-tuning?\n- Can you clarify how the sliding window evaluation method works (Press et al., 2022)? I read the reference but was still confused, so adding a simple explanation in the paper would be very helpful. When reporting on performance with evaluation context window size $N$, does this mean you measure perplexity on predicting token N+1? Or you measure the average perplexity across all $N$ tokens (so each token on average sees N/2 context)?\n- When you say in your plots \"Yarn-Llama-2-7b-64k\", this means you used s=16? What fine-tuning data and sequence lengths did you use for both s=16 and s=32?\n- Are the only results in your paper that use dynamic scaling those in Figure 5 of appendix B.4?\n- Why do you compare with Code-Llama, which is specialized for code?\n- Do you have intuition for why temperature scaling is necessary? Does it improve performance with regular RoPE embeddings, for short documents? Or just for long documents when using YaRN? Can you add more explanation regarding the intuition/reasons for this method, and how it performs outside the context of YaRN?"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "5: marginally below the acceptance threshold"
            },
            "confidence": {
                "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        },
        "number": 4,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission6096/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698959650562,
        "cdate": 1698959650562,
        "tmdate": 1699636657301,
        "mdate": 1699636657301,
        "license": "CC BY 4.0",
        "version": 2
    }
]