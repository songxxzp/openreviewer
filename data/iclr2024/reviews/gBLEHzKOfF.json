[
    {
        "id": "0GxhL65I7m",
        "forum": "gBLEHzKOfF",
        "replyto": "gBLEHzKOfF",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission7888/Reviewer_fozM"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission7888/Reviewer_fozM"
        ],
        "content": {
            "summary": {
                "value": "This work proposes a general framework called GENOT that solves entropy regularized balanced/unbalanced OT and Gromov-Wasserstein extensions. The proposed framework is flexible with any ground cost, offers a way to sample from the optimal conditional plan, and can map across incomparable spaces. The key idea is to use solutions from a discrete OT solver as supervision to train conditional flow-matching models. Experiments on toy data and single-cell data are done to illustrate the proposed method's effectiveness compared to other methods."
            },
            "soundness": {
                "value": "4 excellent"
            },
            "presentation": {
                "value": "4 excellent"
            },
            "contribution": {
                "value": "3 good"
            },
            "strengths": {
                "value": "* The presentation of the paper is really good. The writing is concise and to the point, without lacking in rigor.\n* The proposed method is simple and effective, and the authors have adequately demonstrated its flexibility in various scenarios in the experiments section.\n* The way the paper handles unbalanced OT by learning a reweighting function is novel and I haven't seen it before.\n* Experiments seem solid and cover a good range of applications."
            },
            "weaknesses": {
                "value": "* The main weakness in my opinion is that the proposed framework is not actually solving OT; rather it relies on a discrete solver to compute approximate discrete transport plans and then fit a neural network (in this case conditional flow matching) to follow the the discrete solutions. This point is not obvious until I read to the end of Section 3.1 after describing the main method. I think the authors need to mention this reliance on a discrete solver in their abstract and introduction. Otherwise, I think the paper is overselling, since by reading the abstract and the introduction, I was very excited because I thought the paper has found a unified way to solve all EOT problems, without relying on a discrete solver.\n* Since the method is essentially regressing discrete OT solutions from a black-box discrete OT solver, very little of the proposed method is related to optimal transport. For example, if we have any task of mapping one measure to another (not necessarily in an optimal way) and if we can solve a discretized version of the task, then we could use the exact formulation (7) without any changes.\n* The proposed algorithm relies on the discrete OT solver to do the heavy lifting and hence must inherit the limitation of discretization. For instance, it might be difficult to apply to the image domain where using a small batch of images would not capture the whole distribution accurately. This is (to some degree) not a problem of other neural solvers like [De Bortoli 2021], [Korotin et al. 2022a;b]. This limitation should be discussed more.\n* While in Proposition 3.1, the authors proved minimizing (7) results in the correct optimal plan, in practice in Algorithm 1,2, a **biased** loss is being optimized due to finite batch sizes. By biased, what I mean is that the expectation of the discrete estimator in Algorithm 1,2 is not necessarily the same as (7). One could expect the biasedness will decrease as the batch size increases. However, the effect of batch sizes is not discussed at all; it is taken to be 1024 throughout. I view this point as a central limitation of the current work. If theoretical analysis is difficult, empirical evidence to show how the results degrade as a function of batch size could be important. For instance, using a batch size of 1 would likely break the algorithm."
            },
            "questions": {
                "value": "1. In \"Noise Outsourcing\" paragraph in Section 3.1, I think the condition $x \\sim \\mu$ can be replaced with \"for all x in the support of $\\mu$\" to improve the clarity of the sentence \"More precisely ...\"\n2. Above (5), it says \"instead of directly modeling $T_\\theta(\\cdot |x)$ as a neural network.\" What is the advantage of using flow matching versus a pushforward map? \n3. $\\hat \\pi$ under (7) is undefined.\n4. It would be great if the authors could comment on the biasedness issue I mentioned in the weakness section. Similarly, while Proposition 3.3 shows the consistency of the estimator of $\\hat{\\eta_n}$, it does not address the biasedness issue of this estimator.\n5. Is there any reason that the authors have not applied the current framework to image domains? Is it because the bottleneck is due to finite batch sizes as mentioned above in the weakness section?"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "6: marginally above the acceptance threshold"
            },
            "confidence": {
                "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        },
        "number": 1,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission7888/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698103380632,
        "cdate": 1698103380632,
        "tmdate": 1699636967828,
        "mdate": 1699636967828,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "FuBO5PJ4AC",
        "forum": "gBLEHzKOfF",
        "replyto": "gBLEHzKOfF",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission7888/Reviewer_NfWc"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission7888/Reviewer_NfWc"
        ],
        "content": {
            "summary": {
                "value": "This paper introduces a general method for computing neural OT couplings, called GENOT. GENOT can cover any cost function, can incorporate randomness using conditional generative models, can map points across incomparable spaces, and can be applied to the unbalanced problems. GENOT employs Conditional Flow Matching approach to fit the conditional distribution of couplings. The authors evaluated GENOT in various single-cell biology problems."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "3 good"
            },
            "contribution": {
                "value": "3 good"
            },
            "strengths": {
                "value": "-\tThe proposed GENOT is a flexible approach\tthat can address various OT problems.\n-\tThis work is overall well-written.\n-\tGENOT is well-motivated (Sec 3)."
            },
            "weaknesses": {
                "value": "-\t**W1.** This paper lacks a quantitative evaluation regarding whether GENOT is a reasonable approach for estimating OT couplings (Only qualitative samples in Fig 1 and 4). \n-\t**W2.** This paper lacks a comparative evaluation in Sec 5 with previous approaches for various single-cell biology problems, such as [1, 2] (presented in Introduction Section)."
            },
            "questions": {
                "value": "-\t**Q1.** What is the advantages of employing Conditional Flow Matching for modeling conditional generators $T(\\cdot | x )$? We could consider directly modeling $T(\\cdot | x )$ with neural networks as in [3].\n-\t**Q2.** Proposition 3.1 assumes $Y \\sim \\pi_{\\epsilon}^{\\star} (\\cdot | x)$ in Eq 7. In practice, Algorithm 1 adopts the mini-batch estimate for $\\hat{\\pi}_{\\epsilon}$. Can GENOT still recovers Optimal Conditional Generators by taking expectations over mini-batch estimate, e.g. [4]? In this respect, I am curious about the quantitative results for the OT coupling estimates from GENOT for Fig 1 and Fig 4.\n-\t**Q3.** Which algorithms are used for this mini-batch estimate?\n\n\n**Reference**\n\n[1] Schiebinger, Geoffrey, et al. \"Optimal-transport analysis of single-cell gene expression identifies developmental trajectories in reprogramming.\" Cell 176.4 (2019): 928-943.    \n[2] Demetci, Pinar, et al. \"SCOT: single-cell multi-omics alignment with optimal transport.\" Journal of Computational Biology 29.1 (2022): 3-18.       \n[3] Korotin, Alexander, Daniil Selikhanovych, and Evgeny Burnaev. \"Neural optimal transport.\" ICLR, 2023.       \n[4] Fatras, Kilian, et al. \"Unbalanced minibatch optimal transport; applications to domain adaptation.\" International Conference on Machine Learning. PMLR, 2021."
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "6: marginally above the acceptance threshold"
            },
            "confidence": {
                "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
            },
            "code_of_conduct": {
                "value": "Yes"
            },
            "first_time_reviewer": {
                "value": "Yes",
                "readers": [
                    "ICLR.cc/2024/Conference/Program_Chairs",
                    "ICLR.cc/2024/Conference/Submission7888/Senior_Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission7888/Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission7888/Reviewer_NfWc"
                ]
            }
        },
        "number": 2,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission7888/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698209858799,
        "cdate": 1698209858799,
        "tmdate": 1699636967697,
        "mdate": 1699636967697,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "2az8HGNJtV",
        "forum": "gBLEHzKOfF",
        "replyto": "gBLEHzKOfF",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission7888/Reviewer_DBjq"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission7888/Reviewer_DBjq"
        ],
        "content": {
            "summary": {
                "value": "---- REVIEW UPDATE ----\n\nI am negatively surprised that the authors have not added the requested numbers of metric baselines (this should have been very quick and simple). I regret that the authors have failed to dismiss my concerns about this evaluation in the Gaussian case. Overall, I am not confident that the evaluation is done correctly.\n\nGiven the fact that there is no real understanding of method's performance in learning entropy-regularized transport and the rest evaluation is done mostly in some biological data which is far from my expertise (and I can not clearly assess the results), I can not vote for the acceptance of the paper. I keep my initial score and increase my confidence.\n\n---- INITIAL SUMMARY ----\n\nIn this paper, the authors propose the method to compute entropic optimal transport couplings via a flow-based generative model. The proposed approach addresses different practical challenges met by typical optimal transport methods \u2013 it is applicable for arbitrary cost function, allows randomness by considering a stochastic version of optimal transport, can be used to map points across incompatible spaces considering the Gromov-Wasserstein problem and adapts unbalanced optimal transport formulations. The authors propose a two-step algorithm for estimating the continuous conditional entropy-regularized couplings $\\pi_{\\theta}$ defined as the set of conditional generators $T_{\\theta}(\\cdot|x)$. The generators are parametrized implicitly as the conditional flow matching model induced by a neural vector field. At each step of the algorithm, the authors estimate discrete conditional couplings between empirical samples of the source and target distributions, and then train a conditional matching model between samples from the source distribution and calculated discrete couplings. The algorithm is generalized for unbalanced settings and fused-GW setup. The evaluation is performed in the synthetic setups and problems from the field of single-cell biology, i.e., modeling development of cells, testing cells' response to different drugs, learning translation between different cells\u2019 modalities."
            },
            "soundness": {
                "value": "1 poor"
            },
            "presentation": {
                "value": "3 good"
            },
            "contribution": {
                "value": "2 fair"
            },
            "strengths": {
                "value": "The proposed approach addresses different challenges hampering the application of OT-based approaches in practical tasks. It is evaluated on several tasks in the field of single-cell biology where these challenges appear. The authors show that the proposed approach improves the metrics in comparison to other methods evaluated on the biological task."
            },
            "weaknesses": {
                "value": "I want to point out important aspects of evaluating this paper. First, the experiments mainly involve specific biology tasks that might require some biological background to fully understand (which I don't have). Second, a lot of experiments and important findings are put in the Appendix, which is about 20+ pages long. Based on my experience reviewing papers in similar conferences, I think these Appendix parts might not get a thorough review (at least from me). So, I can't tell if a big part of the paper contains truly important experiments with real-world applications or if these results are just complex experiments presented as being biologically significant. I hope another reviewer (or the area chair) can look into this part of the paper because it's important for deciding if it should be published. Therefore, I'll focus on evaluating the methodological aspects from a machine learning perspective.\n\nAs a whole, the algorithm presented in the paper seems incremental to some extent as it just aggregates the ideas which were already implemented in other papers. Indeed, the idea to distillate the discrete OT solutions using the flow matching was initially proposed by the authors of a conditional flow matching model (Tong et al., 2023). The authors claim that one of their contributions lies in using CFM for solving the GW problem, however, switching between classic OT and GW (Fused-GW) setups in their Algorithm 1 leads only to insignificant changes in computing discrete plans. Another contribution stated by the authors consists in extending the algorithm for solving the unbalanced OT (GW) problems. However, the provided scheme for re-weighting the source and target distributions has something in common with the algorithm provided in a paper (L\u00fcbeck et al, 2022). \n\nThe algorithm provided by the authors solves the continuous entropy-regularized OT (GW) problem by distilling the solutions of the discrete one. This raises my major concern about the paper because plans estimated on empirical samples are known to be bad approximations of the continuous ones which was also mentioned by the authors (in Section 5.2). The provided theoretical results do not clarify this. Furthermore, their Proposition 1 is a little bit misleading. It states that achieving zero value in the loss (7) one recovers the desired conditional plan. However, it is true when the loss is calculated using the samples from the ground truth conditional plan and not the discrete one as in the proposed algorithm. Thus, even when the loss in this algorithm decreases to zero, it is not clear what is actually being learned. This concern extends to the unbalanced variant of the algorithm since it is based on the balanced one. Here additional questions arise about the discrete approximation of scaling factors. The situation is getting even more complex in the case of a GW problem, since it is non-convex and, as such, may have multiple local minimums. Thus, the optimization objective may notably change at every step depending on the calculated discrete OT plans, which may make the result of the training even more unreliable. \n\nThe provided algorithm is assessed in simulated low-dimensional 2D (3D) experiments and several real-world single-cell tasks. These experiments do not demonstrate the nature of the learned solutions. Indeed, the comparison with the ground truth plans is performed only in low dimensions, in biological one the comparison is reduced to marginal distributions. Thus, taking into account my comments from the paragraphs above, it is not evident what it learns in high dimensions. This might impose severe risks in its application to biological tasks (again, I am not an expert in these applications, but this my comment seems fair). In order to show that the proposed algorithm indeed learns an entropic plan in high dimensions, I suggest the authors, for example, evaluate their algorithm on a recent benchmark (Gushchin et al., 2023) which seems to be relevant to the current study at least for the non-GW case.\n\nThe authors do not provide code for their method which is important since the provided biological setup seems to be not easy to reproduce. \n\n**Short summary:**\n- No clear assessment of the errors caused by discrete approximations of OT in high dimensions is provided (my main concern);\n- No code in the supplementary material to reproduce the experiments.\n- Not clear significance from the biological point of view (at least for me because I do not have a background in biology)."
            },
            "questions": {
                "value": "- Could you please compare with other neural unbalanced OT methods, e.g., (Yang & Uhler, 2018) and (L\u00fcbeck et al., 2022)? Maybe it is already present somewhere and I just missed this part.\n- Could you please evaluate your algorithm and compare with other entropy-regularized approaches in high dimensions using a recent benchmark (Gushchin et al., 2023)?\n- Could you please mention additional papers on neural OT for solving GW, e.g., (Bunne et al., 2019), an elaborate if they are relevant or not?\n\n**Minor:**\n\nIn section 5.1, 5.2 links to the Figures 5.1, 5.2 are incorrect;\nThe notation GW-LR on Figure 5 should be introduced in the main text.\n\n**References:**\n\nL\u00fcbeck, F., Bunne, C., Gut, G., del Castillo, J. S., Pelkmans, L., & Alvarez-Melis, D. (2022, October). Neural Unbalanced Optimal Transport via Cycle-Consistent Semi-Couplings. In NeurIPS 2022 AI for Science: Progress and Promises.\n\nYang, K. D., & Uhler, C. (2018, September). Scalable Unbalanced Optimal Transport using Generative Adversarial Networks. In International Conference on Learning Representations.\n\nGushchin, N., Kolesov, A., Mokrov, P., Karpikova, P., Spiridonov, A., Burnaev, E., & Korotin, A. (2023). Building the Bridge of Schr\\\"odinger: A Continuous Entropic Optimal Transport Benchmark. In Advances in Neural Information Processing Systems, 2023\n\nBunne, C., Alvarez-Melis, D., Krause, A., & Jegelka, S. (2019, May). Learning generative models across incomparable spaces. In International conference on machine learning (pp. 851-861). PMLR."
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "details_of_ethics_concerns": {
                "value": "No"
            },
            "rating": {
                "value": "5: marginally below the acceptance threshold"
            },
            "confidence": {
                "value": "5: You are absolutely certain about your assessment. You are very familiar with the related work and checked the math/other details carefully."
            },
            "code_of_conduct": {
                "value": "Yes"
            },
            "first_time_reviewer": {
                "readers": [
                    "ICLR.cc/2024/Conference/Program_Chairs",
                    "ICLR.cc/2024/Conference/Submission7888/Senior_Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission7888/Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission7888/Reviewer_DBjq"
                ]
            }
        },
        "number": 3,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission7888/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698782977738,
        "cdate": 1698782977738,
        "tmdate": 1700859218500,
        "mdate": 1700859218500,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "ijfd7h0Ttk",
        "forum": "gBLEHzKOfF",
        "replyto": "gBLEHzKOfF",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission7888/Reviewer_WAiP"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission7888/Reviewer_WAiP"
        ],
        "content": {
            "summary": {
                "value": "The authors consider different versions of entropic OT problem statement: unbalanced OT formulation, quadratic OT instead of linear OT, etc. They proved that these problems can be solve using the conditional flow matching framework. They proposed corresponding computational algorithms and tested them in single-cell biology problems."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "3 good"
            },
            "contribution": {
                "value": "3 good"
            },
            "strengths": {
                "value": "- a unified solution framework for different OT problem statements, important for practical cases\n\n- interesting computational experiments on practical tasks in the field of single-cell biology, where challenges of standard OT problems (unbalanced OT formulation, quadratic OT instead of linear OT, etc.) appear"
            },
            "weaknesses": {
                "value": "- the authors did not investigate computational limits of the proposed approach: how do comp. efficiency and accuracy scale w.r.t. dimensionality? sample size?\n\n- the code is not provided. However, the experimental protocol for working with biological data looks very complex. So it is not easy to replicate the results of the research\n\n- it seems the approach will not work in case of image data. Any ideas how it can be adapted for this case?\n\n- limited number of baselines were considered to verify the performance of the proposed approach on biomedical data\n\n- In proposition 1 the authors claim that using the proposed algorithm we can recover the desired conditional plan. However, this proposition assumes that the loss is calculated using the samples from the ground truth conditional plan. In the proposed algorithm the authors use the samples from the discrete conditional plan. So it is not clear whether based on such statistical estimate we really converge to the true solution of the corresponding continuous problem statement, especially in high-dimensional case\n\n- from a practical viewpoint it is difficult for a non-specialist to verify results of computational experiments in biological domain, whether they are significant or not. Moreover, in biological experiments the authors uses only marginal distributions to estimates accuracy of their results. In the comment above I articulate that it is not clear to which OT plan actually the solution, delivered by the proposed algorithm, converges. Thus, it is important to estimate accuracy of the solution based on high-dimensional statistics (not only marginal distributions). I understand that in biological use cases we do not have such possibility.\n\nHowever, there exist several benchmarks for OT, e.g. https://arxiv.org/abs/2306.10161 (Building the Bridge of Schr\u00f6dinger: A Continuous Entropic Optimal Transport Benchmark) and https://arxiv.org/abs/2106.01954 (Do Neural Optimal Transport Solvers Work? A Continuous Wasserstein-2 Benchmark)\n\nI wonder whether efficiency of the proposed algorithm can somehow be evaluated using high-dimensional test use cases from one of these benchmarks? \n\nAnswers to comments above are very important for me to finally assess the paper."
            },
            "questions": {
                "value": "- page 30. What is \"... choose alpha = 0.7m=, but ...\"?"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "8: accept, good paper"
            },
            "confidence": {
                "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
            },
            "code_of_conduct": {
                "value": "Yes"
            },
            "first_time_reviewer": {
                "readers": [
                    "ICLR.cc/2024/Conference/Program_Chairs",
                    "ICLR.cc/2024/Conference/Submission7888/Senior_Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission7888/Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission7888/Reviewer_WAiP"
                ]
            }
        },
        "number": 4,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission7888/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1699313238542,
        "cdate": 1699313238542,
        "tmdate": 1699700437070,
        "mdate": 1699700437070,
        "license": "CC BY 4.0",
        "version": 2
    }
]