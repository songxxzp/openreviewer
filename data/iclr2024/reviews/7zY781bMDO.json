[
    {
        "id": "XiWpkh0nyt",
        "forum": "7zY781bMDO",
        "replyto": "7zY781bMDO",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission4646/Reviewer_BsaB"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission4646/Reviewer_BsaB"
        ],
        "content": {
            "summary": {
                "value": "The paper proposes a novel method for off-line reinforcement learning based on return-conditioned supervising learning (RCSL) algorithms for policy selection working on an augmented data set of roll-out trajectories generated by means of a dynamics model learned from actually experienced trajectories. An empirical evaluation demonstrates the advantages of the proposed method on several decision problems. In addition, the paper provided theoretical analysis of why return-conditioned algorithms cannot stitch an optimal policy from segments of trajectories contained in a data set, thus motivating the idea to augment such a data set with rollouts."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "3 good"
            },
            "contribution": {
                "value": "3 good"
            },
            "strengths": {
                "value": "The main strength of the paper is the combination of RCSL with rollouts using a learned model for the purposes of augmentation of a collected data set of trajectories. The use of RCSL allows the use of machine learning models that are only adequate for representing the optimal policy, and not necessarily for representing the optimal Q-function of the problem, too, as required by methods based on dynamic programming (Bellman back-ups). This makes the selection of the neural network models for a given decision problem easier. On the other hand, the use of rollouts produces by means of a learned model increases the set of trajectories that the RCSL will be selecting from, thus increasing the cumulative reward of the resulting policy."
            },
            "weaknesses": {
                "value": "The inability of RCSL to stitch an optimal trajectory from multiple segments of trajectories in the data set it is working with seems like a major limitation. If it is true that RCSL can learn the optimal policy only if the optimal trajectory is in the data set, then for optimality, the augmented data set must be large enough to contain this trajectory. But, it is not clear how many rollouts will be needed for this, even in some probabilistic sense.\n\nAnother weakness of the paper is that it is hard to follow the proposed methods. For example, the RCSL method can be explained better.  \n\nA minor typo, in the abstract: \"unde\" -> \"under\""
            },
            "questions": {
                "value": "How exactly is the policy represented in the comparison in Section 3.1? To begin with, there seems to be a discrepancy between the kind of policies introduced in Section 2, where a policy maps trajectories to probability distributions over the action set, and the one in Section 3.1, where the policy is deterministic, and outputs a single action. Equation 2 is compatible only with the latter type of policy, and only if the actions are real-valued. But, the projection f(a) seems to be a thresholding operation, returning only possible values of 0 and 1. They could be used as real-valued actions, but then, how are problems with more than two actions represented? Also, if f(a) is a hard thresholding, it is not differentiable, how is the minimization problem in the MLP-RCSL solved?\n\nAlso, are the indices for tau[i, j] in the first equation in Section 2.2 correct? For cx=1, we get i>j, which seems to contradict the definition of a sub-sequence tau[i, j]. Also, isn't s_h already part of that sequence, why is it listed as a separate argument of the policy?"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "6: marginally above the acceptance threshold"
            },
            "confidence": {
                "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
            },
            "code_of_conduct": {
                "value": "Yes"
            },
            "first_time_reviewer": {
                "readers": [
                    "ICLR.cc/2024/Conference/Program_Chairs",
                    "ICLR.cc/2024/Conference/Submission4646/Senior_Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission4646/Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission4646/Reviewer_BsaB"
                ]
            }
        },
        "number": 1,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission4646/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698267710145,
        "cdate": 1698267710145,
        "tmdate": 1700529000234,
        "mdate": 1700529000234,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "5wgUUTrlSb",
        "forum": "7zY781bMDO",
        "replyto": "7zY781bMDO",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission4646/Reviewer_9pmM"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission4646/Reviewer_9pmM"
        ],
        "content": {
            "summary": {
                "value": "This paper presents MBRCSL, a return-conditioned supervised learning algorithm that improves on one of the major limitations of that algorithm category, the inability to perform trajectory stitching, by adding model-based rollouts that synthesize multiple trajectories to augment the training data. The authors also prove that under certain assumptions RCSL algorithms converge with weaker assumptions about the contents of the offline dataset compared to offline Q-learning methods."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "4 excellent"
            },
            "contribution": {
                "value": "3 good"
            },
            "strengths": {
                "value": "I found this paper very interesting- it combines non-trivial theoretical and experimental arguments in a way I don't see often, and does so in a very comprehensible way, speaking as someone who hasn't worked on offline RL and isn't deeply familiar with the literature on the topic.\n\nIn general I liked the ideas presented- they rely on some assumptions about the dataset and MDP(s) of interest, but these are mostly stated up front and seem if not trivial in practice at least a reasonable starting point for future work to relax to some degree. The point about realizability versus Bellman completeness seems well put to me."
            },
            "weaknesses": {
                "value": "My biggest criticism of this paper is that it doesn't really have any ablations or demonstrate the experimental limitations of MBRCSL at all. The theoretical assumptions are all clearly stated, but it's not clear how far these will stretch in practice.\n\nI think what's already here is clearly argued and significant, so I'm inclined to recommend acceptance regardless, but some more stress tests to see where assumptions break down would greatly improve the paper. I've added some questions below in that vein, hopefully they can be useful for either this paper or future work building on it."
            },
            "questions": {
                "value": "-For the two tasks tested on, the poor performance of CQL and co. is claimed to be due to issues with Bellman completeness. Could it be reasoned about or experimentally demonstrated what additional data is needed to bring those algorithms up to performance levels similar to MBRCSL? I imagine the additions needed are non-trivial, which would be a mark in MBRCSL's favor, but I'm curious to know how hard it is to satisfy the requirements of offline Q-learning algorithms in comparison. Basically, how hard of a constraint to satisfy is the need for Bellman completeness in practice versus theory?\n\n-I'd be interested to see a non-tabular environment testing how model size/parameter count is affected by RCSL versus Q-learning. The theoretical argument here seems strong, so I'm curious if performance as a function of model size ends up being meaningfully different between RCSL methods and Q-learning methods.\n\n-MBRCSL relies on a good forward dynamics model and a behavior policy to allow trajectory stitching, and while this is a fair requirement I'm curious what happens when those two components are lower in quality (for example, a weaker dynamics model versus a stronger one). Does performance degrade smoothly, or is a high-quality model essential?\n\n-In the same vein, what happens if the rollout budget is reduced? How does MBRCSL degrade with limited synthetic data?\n\n-What happens to MBRCSL if dataset coverage is non-uniform? I can imagine something like a constructed dataset that has a tunable degree of biased-ness in coverage being informative here."
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "8: accept, good paper"
            },
            "confidence": {
                "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
            },
            "code_of_conduct": {
                "value": "Yes"
            },
            "first_time_reviewer": {
                "value": "Yes",
                "readers": [
                    "ICLR.cc/2024/Conference/Program_Chairs",
                    "ICLR.cc/2024/Conference/Submission4646/Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission4646/Reviewer_9pmM",
                    "ICLR.cc/2024/Conference/Submission4646/Senior_Area_Chairs"
                ]
            }
        },
        "number": 2,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission4646/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698449535495,
        "cdate": 1698449535495,
        "tmdate": 1700526601416,
        "mdate": 1700526601416,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "dbsxyogASI",
        "forum": "7zY781bMDO",
        "replyto": "7zY781bMDO",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission4646/Reviewer_HXBB"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission4646/Reviewer_HXBB"
        ],
        "content": {
            "summary": {
                "value": "The paper tackles a central challenge in offline reinforcement learning - the difficulty of stitching together suboptimal trajectories into optimal behavior, while using function approximation. Standard off-policy algorithms like Q-learning rely on dynamic programming and the strong requirement of Bellman completeness, which can be problematic to satisfy with function approximation. \n\nIn contrast, the paper shows return-conditioned supervised learning (RCSL) methods that directly train policies on trajectories need only the easier-to-satisfy realizability condition. However, RCSL methods cannot stitch trajectories. To get the best of both worlds, the paper proposes model-based RCSL (MBRCSL), creatively combining RCSL and model-based RL. MBRCSL trains a dynamics model, uses it to sample high-performing trajectories, and trains an RCSL policy on these optimal trajectories. This enables trajectory stitching without requiring Bellman completeness. \n\nTheoretically, the paper sharply characterizes when RCSL can outperform Q-learning in simple settings and why RCSL fails at stitching. Empirically, MBRCSL demonstrates clear improvements over model-free and model-based baselines on Point Maze and Pick-and-Place environments."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "2 fair"
            },
            "contribution": {
                "value": "2 fair"
            },
            "strengths": {
                "value": "Provides concrete theoretical characterization showing RCSL only requires realizability while Q-learning requires stronger Bellman completeness.\n\nProves fundamental limitation that Markovian RCSL policies cannot perform trajectory stitching.\n\nInteresting idea of using model rollouts to generate near-optimal trajectories then training RCSL policy.\n\nModular framework allows flexible choice of model architecture. \n\nGood empirical results on Point Maze and Pick-and-Place. Outperforms model-free baselines."
            },
            "weaknesses": {
                "value": "Limited experimental validation on only 2 environments. More complex domains needed.\n\nNo comparison to other state-of-the-art model-based offline RL algorithms\n\nTheoretical results consider tabular case. Unclear if insights extend directly to function approximation."
            },
            "questions": {
                "value": "How does MBRCSL compare to other state-of-the-art offline RL algorithm on benchmark tasks?\n\nHow does MBRCSL compare to prior model-based offline RL methods like MOReL, MOPO, COMBO including sample complexity and compute? E.g. your approach requires accurate learned dynamics model and uncertainty modeling is less sophisticated than ensemble approaches like MOPO. No explicit handling of OOD actions unlike conservative methods means the algorithm could be brittle on highly suboptimal datasets- could you comment on this?\n\nCan you formally characterize conditions under which model rollouts provide sufficient coverage for optimality of RCSL?\n\nCan you incorporate offline constraints into RCSL policy learning?\n\nCan you analyze sample efficiency of MBRCSL with limited suboptimal data?\n\nHow many trajectories do you need before performing BC? I would imagine the performance of the algorithms depends a lot on this?\n\nIn general, I'm quite surprised the algorithms works as explained because if BC is a policy that combines the best and worst trajectories in the dataset I don't understand how it can find trajectories that are better than the best ones. Unfortunately the experiments aren't particularly convincing in this respect.\n\n\n\n\nIs end-to-end training of model and RCSL policy possible?\n\nWhat are the most important architectural choices for dynamics model and RCSL policy?\n\nCan MBRCSL be extended to stochastic environments?\n\nThe theoretical results comparing RCSL and Q-learning are derived in the tabular setting. However, function approximation is crucial for offline RL in complex environments with large state spaces. Can you discuss how the theoretical insights around Bellman completeness and realizability could be extended to the function approximation setting? Analyzing the hidden layer width requirements for MLP-RCSL versus MLP Q-learning could provide useful insights into when RCSL methods might have advantages over dynamic programming with function approximation for offline RL."
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "details_of_ethics_concerns": {
                "value": "No concers."
            },
            "rating": {
                "value": "3: reject, not good enough"
            },
            "confidence": {
                "value": "5: You are absolutely certain about your assessment. You are very familiar with the related work and checked the math/other details carefully."
            },
            "code_of_conduct": {
                "value": "Yes"
            },
            "first_time_reviewer": {
                "value": "Yes",
                "readers": [
                    "ICLR.cc/2024/Conference/Program_Chairs",
                    "ICLR.cc/2024/Conference/Submission4646/Senior_Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission4646/Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission4646/Reviewer_HXBB"
                ]
            }
        },
        "number": 3,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission4646/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698767712290,
        "cdate": 1698767712290,
        "tmdate": 1699636444678,
        "mdate": 1699636444678,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "ToHicm39XK",
        "forum": "7zY781bMDO",
        "replyto": "7zY781bMDO",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission4646/Reviewer_YXKR"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission4646/Reviewer_YXKR"
        ],
        "content": {
            "summary": {
                "value": "This paper aims to investigate how to make the RCSL method work in the off-policy RL setting. The paper first shows that RCSL can achieve better performance than DP-based algorithms in near deterministic environments, as long as the dataset contain optimal trajectories, and points out that this is due to that there is no need of Bellman-completeness for RCSL. This indicates that this type of methods should work if sufficient data coverage is obtained. Hence the authors propose a model-based RCSL (MBRCSL) algorithm which is able stitch together sub-optimal data while avoiding the Bellman-completeness requirements. Empriical results on D4RL benchmark also verify its effectiveness."
            },
            "soundness": {
                "value": "2 fair"
            },
            "presentation": {
                "value": "3 good"
            },
            "contribution": {
                "value": "2 fair"
            },
            "strengths": {
                "value": "While previous method work (Brandfonbrener et al., 2022) gives negative theoretical results for RCSL, this paper investigates how to make it work in practice in despite of those disadvantages, while preserving its advantages. The paper is well written, easy to read and demonstrates that the proposed method may significantly outperforms SOTA offline RL methods under certain environments."
            },
            "weaknesses": {
                "value": "The proposal to address the 'trajectory stitching' issue seems idealistic - how can you ensure that sufficient data coverage can be obtained simply by rolling out a learned dynamics model?"
            },
            "questions": {
                "value": "1. Theorem 1 only shows that there exists some MDPs that don't need the Bellman-completeness assumption for RCSL to work, but how to characterize such MDPs? How about other environments that lacks such characteristic?\n\n2. In section.4, it's said that 'in many cases, this generated data provides coverge over potentially optimal trajectory and return data....', in my opinion, the policy learned by behavior cloning from suboptimal offline trajectories is highly likely to be a suboptimal policy as well, even though the dynamic model is leanred accurately, would you please make it more clear that why the trajectories sampled by the behavior policy with approximat dynamic model will become optimal?  In particular, even if the training rollouts consist of those synthetic trajectories with a return greater than the ones in offline dataset, these better rollouts are based on the approximate dynamic model and cannot guarantee the optimal trajectory. If so, how can we learn the optimal policy using the RCSL algorithm?\n\n3. Has the authors tried MB+DT or MB+BC, i.e., replacing the RCSL component in MBRCSL with other methods without the requirement of Bellman-completeness?\n\n4. on p.4., below section 3.2, the paper says that \"RCSL cannot perform trajecatory stitching\", would you please make it more clear? In my opinion, RCSL works by supervised learning, in which  part of its data features (future return or goals for each state) are generated by trajactory stitching by hand."
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed.",
                    "Yes, Discrimination / bias / fairness concerns"
                ]
            },
            "details_of_ethics_concerns": {
                "value": "n/a"
            },
            "rating": {
                "value": "5: marginally below the acceptance threshold"
            },
            "confidence": {
                "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        },
        "number": 4,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission4646/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698799399588,
        "cdate": 1698799399588,
        "tmdate": 1699636444603,
        "mdate": 1699636444603,
        "license": "CC BY 4.0",
        "version": 2
    }
]