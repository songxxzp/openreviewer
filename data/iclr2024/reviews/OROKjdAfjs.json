[
    {
        "id": "1qvaDofHP6",
        "forum": "OROKjdAfjs",
        "replyto": "OROKjdAfjs",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission3359/Reviewer_5syF"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission3359/Reviewer_5syF"
        ],
        "content": {
            "summary": {
                "value": "This paper presents TransNormerLLM and claims the first linear attention-based LLM that outperforms conventional softmax-based models in terms of both accuracy and efficiency.\n\nThe adopted techniques include (1) LRPE position encoding together with an exponential decay to avoid attention dilution issues; (2) a gating mechanism following Flash; and (3) Lightning Attention to accelerate the training process.\n\nExperiments on various scale LLM models trained on self-collected corpus demonstrate outstanding performance."
            },
            "soundness": {
                "value": "2 fair"
            },
            "presentation": {
                "value": "3 good"
            },
            "contribution": {
                "value": "2 fair"
            },
            "strengths": {
                "value": "1. The pioneering work focusing on the linear attention-based LLM. This direction is of great interest and significance to the community.\n\n2. Combine various tricks to make linearized LLM work, including the aforementioned LRPE position encoding, gated linear attention or MLPs, and lightning attention.\n\n3. Through evaluation and ablation studies to reveal the core techniques that make linear attention work."
            },
            "weaknesses": {
                "value": "1. How does your linear attention handle the autoregressive decoding? As of training, you can feed the network with a batch of inputs with long token dimensions. But when it comes to the generation phase, I am afraid that only limited tokens are used to generate the next token. Then do you still have benefits for inference?\n\n2. The paper reads like a combination of various tricks as a lot of techniques were discussed in the previous paper, like LRPE, Flash, and Flash Attention. Especially for the Lightning Attention vs. Flash Attention, I did not find any difference between these two. The gated mechanism was also introduced in Flash paper. These aspects leave us a question in terms of the technical novelty of this paper.\n\n3. It looks like during training, you are still using the quadratic attention computational order as indicated in Equ. 10? I suppose it was to handle the masking part. But that loses the benefits of training with linear attention complexity.\n\n4. In terms of evaluation, although in the abstract, the authors claim that the linearized LLM extends to 175B parameters, most experiments are conducted on 375M models. For the large parameter size settings, the author only reports the memory and latency cost savings. The accuracy information is missing, without which I feel hard to evaluate the linearized LLMs."
            },
            "questions": {
                "value": "See weaknesses."
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "details_of_ethics_concerns": {
                "value": "N/A"
            },
            "rating": {
                "value": "5: marginally below the acceptance threshold"
            },
            "confidence": {
                "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        },
        "number": 1,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission3359/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698337079616,
        "cdate": 1698337079616,
        "tmdate": 1699636285956,
        "mdate": 1699636285956,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "LtRWE6FogH",
        "forum": "OROKjdAfjs",
        "replyto": "OROKjdAfjs",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission3359/Reviewer_s89T"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission3359/Reviewer_s89T"
        ],
        "content": {
            "summary": {
                "value": "This paper proposes several incremental changes upon TransNormer including: positional embedding, gated linear units and layernorm. The authors claim that the resulting model is not only more effective, but also more efficient during both training and inference, compared with the original TransNormer."
            },
            "soundness": {
                "value": "2 fair"
            },
            "presentation": {
                "value": "2 fair"
            },
            "contribution": {
                "value": "2 fair"
            },
            "strengths": {
                "value": "- Extensive empirical results with detailed ablation on the proposed changes\n- Detailed evaluation of both training and inference"
            },
            "weaknesses": {
                "value": "- changes are incremental, thus the work lack technical contribution\n- the training and inference algorithms are not novel (explained more blow)\n- the results are not convincing due to baseline setup and implementations\n\nTraining efficiency: From the appendix, it seems the implementation of the linear attention is a direct adaptation of Flash-Attention2 (I further assume it\u2019s based on the Triton implementation of Flash-Attention2). It\u2019s unfair (and not meaningful) to compare the flash-attention optimized Transnormer with a plain Pytorch Transformer. \n\nBaseline: for fair comparison, the baseline Transformer should also positional embeddings or gated linear units (which are straightforward to be added to Transformer as well). \n\nRobust inference: the proposed new inference algorithm is rather trivial. It\u2019s more natural (and conventional in the literature) to include the decay factor in the recurrence (i.e., $ h_t = \\lambda \\  h_{t-1} + k_t v_t^\\intercal $ ) rather than in the input and output."
            },
            "questions": {
                "value": "Can you compare against RetNet[1] in Sec 4.2? Transnormer is quite similar to RetNet with the very similar design of decay and positional embeddings. It'd be useful for authors to clarify the difference and make empirical comparisons.  \n\n1. Retentive Network: A Successor to Transformer for Large Language Models"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "5: marginally below the acceptance threshold"
            },
            "confidence": {
                "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        },
        "number": 2,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission3359/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698935985199,
        "cdate": 1698935985199,
        "tmdate": 1699636285895,
        "mdate": 1699636285895,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "P2efvrKb9u",
        "forum": "OROKjdAfjs",
        "replyto": "OROKjdAfjs",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission3359/Reviewer_xvcu"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission3359/Reviewer_xvcu"
        ],
        "content": {
            "summary": {
                "value": "The paper proposes TransNormerLLM, an improved linear attention-based large language model (LLM) that outperforms conventional softmax attention models in both accuracy and efficiency. \n\n- The key contributions include:\n\n1. Replacing the TransNormer's DiagAttention with Linear Attention and using LRPE (Learnable Relative Positional Encoding) with exponential decay to allow global token interactions while avoiding attention dilution. \n\n2. Introducing Lightning Attention to accelerate linear attention by 2x during training and reduce memory usage by 4x.\n\n3. Using a gating mechanism for training stability and simplified GLU/normalization for faster processing. \n\n4. Developing a robust inference algorithm for consistent speed regardless of sequence length.\n\n5. Implementing efficient model parallelism to scale the model up to 175B parameters. \n\n6. Validating the model on a 6TB corpus and benchmarking 385M, 1B and 7B parameter models, showing competitive performance to Transformer LLMs while being faster."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "3 good"
            },
            "contribution": {
                "value": "2 fair"
            },
            "strengths": {
                "value": "- The work addresses a key limitation of standard Transformer models - the quadratic complexity w.r.t sequence length - through the use of linear attention. This could enable scaling to much longer contexts.\n\n- The modifications to the original TransNormer architecture, especially Lightning Attention and robust inference, significantly improve efficiency and stability.\n\n- Thorough ablation studies validate the impact of each proposed technique. The benchmarking shows the models match state-of-the-art Transformer LLMs in accuracy while being faster.\n\n- The model parallelism enables scaling up to 175B parameters, allowing large-scale pre-training. The efficiency gains are impressive and impactful.\n\n- The code and models will be open-sourced, promoting further research and application of efficient transformers."
            },
            "weaknesses": {
                "value": "- The novelty of the work is fairly incremental, building directly on prior work like TransNormer and Flash Attention. None of the modifications substantially advance the state-of-the-art.\n\n- While the techniques improve efficiency, the gains in accuracy over standard TransNormer appear marginal based on the results. The ablations also suggest the contributions are optimizations rather than modelling improvements.\n\n- Lightning Attention, while providing speed and memory gains, is not particularly novel, simply applying similar ideas from Flash Attention.\n\n- The robust inference modification is motivated through mathematical derivations, but the practical benefits are unclear. There is no evidence it improves stability or accuracy.\n\n- The pre-training data is underspecified, making fair comparison to other models difficult."
            },
            "questions": {
                "value": "- What is the actual impact of the robust inference modification in practice? Any quantitative results?\n\n- Can the authors provide more details on the pre-training data characteristics and compute resources used? Is there any testing data leakage problem?\n\n- The gains over standard Transformers appear quite large but the gains over TransNormer are marginal. Why is this the case? Can you show the training curves for the models?"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "5: marginally below the acceptance threshold"
            },
            "confidence": {
                "value": "5: You are absolutely certain about your assessment. You are very familiar with the related work and checked the math/other details carefully."
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        },
        "number": 3,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission3359/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698956068618,
        "cdate": 1698956068618,
        "tmdate": 1699636285828,
        "mdate": 1699636285828,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "Vg7jxzqRzY",
        "forum": "OROKjdAfjs",
        "replyto": "OROKjdAfjs",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission3359/Reviewer_LFwx"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission3359/Reviewer_LFwx"
        ],
        "content": {
            "summary": {
                "value": "This work proposes the TransNormerLLM model that builds on recent advancements in linear attention model techniques such as TransNormer with gating as model architecture, LRPE with exponential decay for position encoding. This work also speeds up causal Linear attention computation to make it io-aware.  Furthermore, model parallelism is introduced for the SGLU and GLA blocks for efficient large-scale distribute training. The architectural and efficient training techniques lead to faster training while matching the performance of the Transformer architecture. Finally, a robust inference for exponential decay attention is presented for numerical stability."
            },
            "soundness": {
                "value": "4 excellent"
            },
            "presentation": {
                "value": "4 excellent"
            },
            "contribution": {
                "value": "4 excellent"
            },
            "strengths": {
                "value": "- The paper is well-written clearly explaining the contributions and motivations.\n- The experiments are well-conducted, with thoughtful ablations and comparisons to extensive range of baselines. This is an important advancement showing that linear attention can match the Transformer performance at scale. Overall I think this work will help to significantly reduce the computation and better scale LLMs. \n- Detailed information regarding the corpus, pseudo-codes, model hyper-parameters is provided,  aiding reproducibility."
            },
            "weaknesses": {
                "value": "- One suggestion would be to explicitly state what is meant by exponential decay position encoding in section 3.1.1.  My understanding is in this case $a_{st} = q_s^T k_t \\lambda^{(s-t)}$. Please correct me if I am wrong.\n- While the training efficiency is provided for TransNormerLLM models larger than 7B is provided, the performance on benchmarks is not included. It would be beneficial to include those results if possible."
            },
            "questions": {
                "value": "- Although the pre-training performance is on par with that of Transformer models, have any experiments on fine-tuning the models been conducted?\n- In Algorithm 3, why is an explicit mask $M \\in R^{N \\times N}$ necessary? Is it for general attention?"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "8: accept, good paper"
            },
            "confidence": {
                "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        },
        "number": 4,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission3359/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1699246309525,
        "cdate": 1699246309525,
        "tmdate": 1699636285742,
        "mdate": 1699636285742,
        "license": "CC BY 4.0",
        "version": 2
    }
]