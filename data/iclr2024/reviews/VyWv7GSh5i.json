[
    {
        "id": "bOyqPsSSH3",
        "forum": "VyWv7GSh5i",
        "replyto": "VyWv7GSh5i",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission7030/Reviewer_Ed3u"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission7030/Reviewer_Ed3u"
        ],
        "content": {
            "summary": {
                "value": "Inspired by Levine (2018), the paper proposes a probabilistic graphical model for IRL by introducing reward and optimality nodes. Then, it proposes a novel variational lower bound which leads to a new IRL solution. The resulting IRL method is shown to outperform state-of-the-art IRL algorithms in several discrete and continuous environments from the Mujoco library."
            },
            "soundness": {
                "value": "1 poor"
            },
            "presentation": {
                "value": "2 fair"
            },
            "contribution": {
                "value": "1 poor"
            },
            "strengths": {
                "value": "The use of variational inference and the optimality node the graphical model of IRL seems to be novel. The empirical performance of the method is promising."
            },
            "weaknesses": {
                "value": "The probabilistic graphical model is not very convincing. The derivation of ELBO in variational inference (VI) does not seem to follow the standard VI derivation. Hence, it raises a major concern whether the technical approach is correct.\n\n1. In RL and IRL, there is only 1 reward function, so $r_t$ and $r_{t'}$ should be related through the reward function parameters. Hence, the graphical model may be clearer if we include the reward function parameter node. Right now, it is unclear to me why we have the conditional independence of $\\mathcal{O}_t$ from $a_t$ and $s_t$ given $r_t$. In Levine (2018), $\\mathcal{O}_t$ is the optimality of the state-action pair given the reward function. \n\n2. In the standard VI framework, it is often that we cannot directly minimize the KL[q(Z)||p(Z|X)] (supposed that we are interested in finding the posterior distribution of Z given the observation X). That is why we need to construct an ELBO that does not involve this KL term. Surprisingly, the ELBO formulation in equation (4) directly involves the term KL[q(Z)||p(Z|X)], i.e., the term KL[q(Ot|rt) || p(Ot|st,at)] in equation (4).\n\n3. We note that $\\int_{\\mathcal{O}_t} p(\\mathcal{O}_t|s_t,a_t) = 1$ for any distribution $p(\\mathcal{O}_t|s_t,a_t)$. Furthermore, the authors claim that all terms except the KL terms are constants w.r.t.~$r_t$ (at the end of page 3). Then, any distribution $p(\\mathcal{O}_t|s_t,a_t)$ satisfies the derivation in the beginning of Section 2.2. Hence, it does not make sense to find $r_t$ by minimizing the distance between $q(\\mathcal{O}_t|r_t)$ and $p(\\mathcal{O}_t|s_t,a_t)$."
            },
            "questions": {
                "value": "Please address the above weaknesses."
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "1: strong reject"
            },
            "confidence": {
                "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        },
        "number": 1,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission7030/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698266548509,
        "cdate": 1698266548509,
        "tmdate": 1699636825207,
        "mdate": 1699636825207,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "xhSGRvH9Qb",
        "forum": "VyWv7GSh5i",
        "replyto": "VyWv7GSh5i",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission7030/Reviewer_PBAj"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission7030/Reviewer_PBAj"
        ],
        "content": {
            "summary": {
                "value": "The paper proposes a method for imitation learning that extends GAIL by introducing a second reward model that approximates the discriminator reward. This reward model also aims to unshape the GAIL reward based on the value function learnt by the RL algorithm.\nThe proposed method VB-IRL is evaluated  on MuJoCo and AssistiveGym environments, where we slightly outperforms baseline methods such as IQ-Learn."
            },
            "soundness": {
                "value": "1 poor"
            },
            "presentation": {
                "value": "2 fair"
            },
            "contribution": {
                "value": "1 poor"
            },
            "strengths": {
                "value": "I am not aware of prior work that used the RL value function for unshaping the GAIL reward. Also using a KL loss to approximate a second reward model seems to be novel."
            },
            "weaknesses": {
                "value": "1. Soundness\n------------------\na) The derivations are based on several wrong assumptions, namely, that\n- the expert actions do not depend on the state\n- the probability of an action being optimal is conditionally independent of state and action given its immediate\n\nThese assumptions are not clearly communicated, but instead hidden in a graphical model, that is presented as a matter of fact.\n\nb) There seems to be a mistake in Eq. 9, as it essentially states that $A(s,a)=\\sigma(A(s,a))$. Furthermore, eq. 10 uses $\\sigma(\\exp(A(s,a))$. There also seems to be an expectation over $s_{t+1}$ missing, unless deterministic dynamics are implicitly assumed!?\n\nc) Eq. 6 defines the \"true distribution\" $p(\\mathcal{O}_t|s_t, a_t)$ as the discriminator reward. This is wrong, because the derivations use $p(\\mathcal{O}_t|s_t, a_t)$ as the actual distribution of the optimality event given state and action (according to the graphical model). The discriminator reward is at best an approximation of this probability. Correspondingly, Theorem 2 is wrong, as it dot not bound the approximation between $q(\\mathcal{O}_t|r_t)$ and the true distribution $p(\\mathcal{O}_t|s_t, a_t)$. Furthermore, in the proof of Theorem 2, it is not clear why Eq. 15 holds.\n\n2. Presentation\n--------------------\na) $C_{\\theta}(s,a)$ is not defined. The paper just states \"To make this classification, we may simply use binary logistic regression, $C_{\\theta}(s,a)$. $C_{\\theta}(s,a)$ needs to be explicitly defined as a function of the discriminator logits (or the discriminator output if that is more convenient). If $C_{\\theta}(s,a)$ directly corresponds to the discriminator output, this needs to be clearly stated.\n\nb) It is not clear to me whether the reward network outputs a scalar, or a distribution (e.g. mean & std of a Gaussian). The paper states \"To illustrate this, consider the simplistic case where the reward value distribution is a univariate Gaussian: [...]\", but it doesn't explicitly state that a Gaussian distribution is used in the experiments.\n\n3. Evaluation\n-----------------\na) The paper claims that the results are significant according to a t-test, but it doesn't provide any further information on how the t-test was performed. It is not clear to me how the t-test was performed, because a t-test is usually used for comparing two groups. Were independent t-test performed for each combination of two groups? In general, I don't think that a t-test is appropriate in this case, not only because of non-Gaussian distributions, but in particular because the different populations can have significantly different variance.\n\nb) The evaluations are performed by using the best policy among 5 different seeds. Such procedure may favor unstable methods. It would be better to compare the average performance among different seeds.\n\nc) The paper stresses the performance of VB-IRL on noisy demonstrations and also evaluates the method in this setting. I think it would be fair to include methods that are targeted at this problem setting, e.g. [Sasaki, F., & Yamashina, 2020].\n \nd) The paper does not show learning curves. These need to be added, at least to the appendix.\n\ne) Ablations are missing with respect to $\\lambda$ and also to evaluate the effect of unshaping the reward function with the value function.\n \n\nReferences\n---------------\nSasaki, F., & Yamashina, R. (2020, October). Behavioral cloning from noisy demonstrations. In International Conference on Learning Representations."
            },
            "questions": {
                "value": "How exactly are $C_{\\theta}(s,a)$ and $r_t$ computed? \n\nHow is the t-test performed?"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "1: strong reject"
            },
            "confidence": {
                "value": "5: You are absolutely certain about your assessment. You are very familiar with the related work and checked the math/other details carefully."
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        },
        "number": 2,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission7030/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698673749746,
        "cdate": 1698673749746,
        "tmdate": 1699636825078,
        "mdate": 1699636825078,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "O63rHIqh64",
        "forum": "VyWv7GSh5i",
        "replyto": "VyWv7GSh5i",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission7030/Reviewer_uUoB"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission7030/Reviewer_uUoB"
        ],
        "content": {
            "summary": {
                "value": "This paper introduces a novel approach to IRL based on variational inference in a ''control as inference'' graphical model. For this, the authors formulate a graphical model with both reward and optimality random variables and derive a variational lower bound on trajectory log-likelihood. They discuss the validity of the approximate distribution of optimality and present an algorithm for maximizing the lower bound. The algorithm is evaluated in simulations across Mujoco environments and assistive gym."
            },
            "soundness": {
                "value": "2 fair"
            },
            "presentation": {
                "value": "3 good"
            },
            "contribution": {
                "value": "3 good"
            },
            "strengths": {
                "value": "I really enjoyed reading the paper as it offered me several new insights for approaching the IRL problem. The approach to tackle the IRL problem by means of variational inference in their graphical model seems novel and creative, and I can see wide applicability of the approach. Further, it may form a base for several new IRL methods, which are not restricted to the common maximum entropy formulation, so I believe that the paper could have a high impact on the community. The method's derivation through variational inference from the graphical model is notably elegant.\n\nThe paper is well-written, making even its technical content accessible. The approximation of the optimality distribution is discussed in sufficient detail, and the technical prerequisites are reasonable. While the paper lacks a demonstration of the tightness of the lower bound, it remains sufficient for a high-quality contribution.\n\nIn the evaluation, the algorithm reveals promising results, particularly in cases with sparse rewards."
            },
            "weaknesses": {
                "value": "The authors claim that its novelty lies in the \"control as inference\" graphical model. However, it is crucial to note that maximum-entropy-based IRL also hinges on inference within the \"control as inference\" graphical model. It can be derived as the maximum likelihood solution in this model and this is where the exponential distribution of the trajectory comes from (there are different derivations). Therefore, statements implying that the proposed method is distinct due to a lack of such modeling in IRL (\"inspired by the graphical model for forward RL [...] and a general lack of such modeling in IRL\") might be inaccurate. It would be beneficial for the paper to provide a more precise discussion of the differences between these probabilistic approaches.\n\nThe section on limitations and future work is notably brief and would benefit from more extensive exploration beyond the current concise treatment.\n\nWhile I also like really like the \"control as inference\" review paper by Levine et al., this formulation predated their work and appears to stem from [1]. Given the mulitple explicit references to the control as inference paper, it would be appropriate to acknowledge the original work at some point.\n\n__Minor:__\n\nEquation 9: It should read $exp(A(s, a))$ instead of $A(s, a)$, I suppose? \nAdditionally, the equal sign in this equation should either be replaced with a proportional sign, or it should link the first and third term, i.e., $q(\\ldots)$ and $\\sigma(\\ldots)$.\n\nThere are instances in the formulas where the bold font seems inconsistent. In Section 2.1, $s_t$ and $a_t$ are initially defined in bold, but this formatting is not maintained. If bold font indicates vectors, then the subscript $t$ should not be bold. This inconsistency also extends to the graphical model in Figure 1 (e.g., $O_t$ with bold $t$), and it impacted readability for me.\n\nBetween Equation 8 and 9, there is an extraneous period.\n\n[1] Toussaint, M. (2009). Robot trajectory optimization using approximate inference. In Proceedings of the 26th annual international conference on machine learning (pp. 1049-1056)."
            },
            "questions": {
                "value": "1. Why is it necessary to model the reward as random given the state and action? Would Equation 9 not remain unchanged if $q$ directly depended on the state and actions, thereby avoiding issues related to the gap between $p(O | s, a)$ and $p(O | r)$?\n\n2. Is it necessary to retrain the classifier completely in each iteration? What is the computational cost associated with this process?\n\n3. Do you have any insights into the potential sources of the increased performance compared to other IRL methods? It would be valuable to provide some explanation or analysis in this regard."
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "6: marginally above the acceptance threshold"
            },
            "confidence": {
                "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
            },
            "code_of_conduct": {
                "value": "Yes"
            },
            "first_time_reviewer": {
                "readers": [
                    "ICLR.cc/2024/Conference/Program_Chairs",
                    "ICLR.cc/2024/Conference/Submission7030/Senior_Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission7030/Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission7030/Reviewer_uUoB"
                ]
            }
        },
        "number": 3,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission7030/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698777509380,
        "cdate": 1698777509380,
        "tmdate": 1700668842699,
        "mdate": 1700668842699,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "IYmxuJzfQY",
        "forum": "VyWv7GSh5i",
        "replyto": "VyWv7GSh5i",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission7030/Reviewer_CGqh"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission7030/Reviewer_CGqh"
        ],
        "content": {
            "summary": {
                "value": "A new approach to imitation learning is presented, taking inspiration from the \"control as inference\" perspective. This method shares similarities with GAIL but introduces an additional step in the process. Instead of directly employing the discriminator to define the reward function, the proposed approach, known as VLB-IRL, trains a neural network to predict a Gaussian distribution over rewards when provided with state-action pairs. The policy is then updated based on rewards sampled from this distribution. The performance of this method is assessed in MuJoCo environments, where it demonstrates performance levels similar to established benchmarks like GAIL."
            },
            "soundness": {
                "value": "2 fair"
            },
            "presentation": {
                "value": "3 good"
            },
            "contribution": {
                "value": "2 fair"
            },
            "strengths": {
                "value": "- This paper tried to theoretically explain the proposed method.\n- The experimental protocol is well described."
            },
            "weaknesses": {
                "value": "- Graphical Model Clarification: The graphical model in the paper is quite unclear, particularly the representation of reward variables. Noting that the definition of V_t, representing the cumulative sum of rewards received after time t, is not adequately reflected in the graphical model. V_t captures the total reward received from time t onwards, and the reviewer suggests that this aspect should be more explicitly incorporated into the model for clarity.\n\n- Dependence of Optimality on Reward: I am unsure about the rationale behind approximating optimality based on the reward. It is unclear whether having the reward information alone is sufficient to determine whether a state action pair is optimal. My question is whether the reward can serve as a reliable indicator of optimality and whether there is a clear justification for this approximation. This question is closely related to the following validity of the graphical model.\n\n- Validity of Graphical Model: the entire theoretical development in the paper is based on the graphical model. They express concerns that if the graphical model's design is flawed or lacks clear justification, it could undermine the significance of the paper's contributions.\n\n- Theoretical Results: The theoretical aspects of this paper appear to have certain limitations. Theorem 2, doesn't offer valuable insights into the convergence rate or the asymptotic behavior of the error bound. To derive Theorem 2, the proof mainly employs the property of a graphical model, however, the justification of the proposed graphical model is unclear, hence, it is not convincing."
            },
            "questions": {
                "value": "See weakness."
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "3: reject, not good enough"
            },
            "confidence": {
                "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        },
        "number": 4,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission7030/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698816234164,
        "cdate": 1698816234164,
        "tmdate": 1699636824822,
        "mdate": 1699636824822,
        "license": "CC BY 4.0",
        "version": 2
    }
]