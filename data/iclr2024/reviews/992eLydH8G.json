[
    {
        "id": "uZh0zeZIhK",
        "forum": "992eLydH8G",
        "replyto": "992eLydH8G",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission8711/Reviewer_pVVn"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission8711/Reviewer_pVVn"
        ],
        "content": {
            "summary": {
                "value": "The paper presents arguments against the hypothesis that in context learning ICL emulates gradient descent in trained transformers. The arguments can be listed as follows:\n* The objective considered in [0] is regression and \"is very different from how real language models are trained are trained on the [causal language modeling] objective.\"\n* Gradient descent is agnostic to the sample order in the batch. ICL is not agnostic to the sample order in the batch.\n* The construction of the transformer in~\\ref{} is contrived.\n\nThe paper also presents additional empirical evidences with Llama-7b to support their argument. In summary, they argue that fine-tuning the model does not lead to model outputs that are equivalent to the one obtained with in context learning.\n\n[0] https://arxiv.org/pdf/2212.07677.pdf"
            },
            "soundness": {
                "value": "2 fair"
            },
            "presentation": {
                "value": "2 fair"
            },
            "contribution": {
                "value": "2 fair"
            },
            "strengths": {
                "value": "The paper challenges an emerging theory that transformers learn In Context Learning by gradient descent, which may help bridging the gap between the theory and practical observation. The authors make an effort to be formal about the definitions put forward in the paper, helping in clearing up some of the ideas put forward."
            },
            "weaknesses": {
                "value": "**The paper presents several arguments with little substance and cohesion.**\nFor example, the authors claims that the because [0] made their analysis with linear regression then it cannot be comparable to a model trained with causal language modeling. This claim can both be true or false. For example, one could argue that training with linear regression leads to exactly the same solution than a model trained with causal language modeling under certain condition. The authors should prove that the model trained with linear regression leads to a different solution than the model with causal language modeling and not merely state it.\n\n**The authors make several arguments that do not prove the main thesis**\nMy understanding of the main thesis of this work is that the ICL setup presented in [0] is not equivalent to gradient descent. However, the setup in [0] considers linear self-attention and not general transformers trained with causal masking. To make their point, the authors should explicitly say what is wrong in the work or setup of [0].\n\nIf what the authors is trying to say is that the setup of [0] is contrived, then the thesis is not very surprising or significant as no one would be astonished to learn that linear self-attention and hand crafted parameters are unrealistic setups.\n\nMinor:\n* The font of some of the figures is a bit too small making it hard to read.\n* The font across the figures and the text is not consistent.\n\nFinally, I would like to encourage the authors to revisit the style of their article. While reading their work, I found the writing to be adversarial against an emerging line of work, which could potentially turn out to be, at least partially, true. Instead, having a constructive writing where they, for example, build on top of the existing theory or correct part of the theory would be more enjoying for me to read than a paper that tries to prove a line of work to be wrong.\n\n[0] https://arxiv.org/pdf/2212.07677.pdf"
            },
            "questions": {
                "value": "I gave most of my comments/suggestions in the weakness section.\n\n* Under what conditions does a model as considered in [0] does not lead to transformers that learn in-context by gradient descent?\n* Prove that a model as considered in [0] does not lead to transformers that learn in-context by gradient descent.\n* What elements of [0] leads to a contradiction that models as considered in [0] does not lead to transformers that learn in-context by gradient descent?\n\n[0] https://arxiv.org/pdf/2212.07677.pdf"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "3: reject, not good enough"
            },
            "confidence": {
                "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        },
        "number": 1,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission8711/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698696848894,
        "cdate": 1698696848894,
        "tmdate": 1699637092837,
        "mdate": 1699637092837,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "CWlUGZo8h8",
        "forum": "992eLydH8G",
        "replyto": "992eLydH8G",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission8711/Reviewer_ivcd"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission8711/Reviewer_ivcd"
        ],
        "content": {
            "summary": {
                "value": "The paper conducts a deeper study into the hypothesis of in-context learning in LLMs as a simulation of gradient descent on an auxiliary model. The authors formalize a few sets of functional properties and compare in-context learning (ICL) and gradient descent (GD) on these properties.  The authors observe inconsistencies between the two algorithms in different settings and hence provide empirical evidence against the equivalence of ICL and GD in the realistic setting."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "4 excellent"
            },
            "contribution": {
                "value": "2 fair"
            },
            "strengths": {
                "value": "The paper is well-written and the logic is easy to understand. The authors mention the functional properties with which they compare in-context learning and gradient descent on a large LLM model. In their experimental study, instead of simply comparing the two algorithms in terms of performance, the authors use metrics like token overlap and cosine similarity to show a clear distinction between the two algorithms. Overall, this paper provides an extensive study pointing out the differences between the two algorithms and provides clear insights into how the community can redesign the existing hypothesis for realistic model settings."
            },
            "weaknesses": {
                "value": "I have a few questions on the experimental study. Please find them below.\n\n(a) **Hypothesis under study in section 4:**  In this section, the authors assume equivalence between ICL and GD on the same model. However, Akyurek et al.'22, and Oswald et al'23 argue that transformers train a small auxiliary model (different from the parent transformer) inside. Hence, the setting that the authors consider aligns more with the result of [1], which claims in-context learning as implicit optimization of the same parent model. So, if I understand currently, the authors are simply refuting [1]'s hypothesis. Can the authors comment on this discrepancy? If the authors want to refute the hypothesis completely, then maybe they need to search for all possible sets of auxiliary models that can fit inside.\n\n(b) **Arguments against sparsity:** I believe, the argument that trained transformers are not sparse, as given by the constructions of Akyurek et al.'22, and Oswald et al'23, isn't a valid argument for the discrepancy between the two algorithms because the previous works simply aim to give an expressivity result on transformers. It is certainly possible that transformers find a dense and more compressed solution to simulate gradient descent. To completely refute the argument, the authors need to refute the probing experiments that the previous works did to search for traces of gradient descent inside these trained models (which I believe is a herculean task).\n\nFurthermore, instead of simply looking at the movement of the transformer weights across training to argue that the model doesn't stabilize to a single sparse solution, maybe the authors can come up with experiments to suggest that the model changes its internal mechanism across training, instead of simply using different weight matrices to represent the same internal mechanism across time (which again is a herculean task).\n \n\n(c) In section 4, the model has been fine-tuned with a cross-entropy loss for GD, with the candidate set being the entire vocabulary. Are the contextual examples concatenated with the test query, like [2]? This setting is more likely since ICL uses demonstrations concatenated, which provides a prior to the right candidate set. \n\nFurthermore, instead of simply optimizing the cross-entropy loss with the entire vocabulary being the candidate set, maybe the authors can put more weight on the relevant logits during training and inference.\n\n(d) What do an overlap rate and cosine similarity of 1.0 mean and < 1.0 mean for ICL in 1 demonstration and >2 demonstration settings in Figure 4? \n\nOverall, I believe the paper attempts to take a deep dive into a very difficult question using simple experiments, which is impressive in itself. However, as far as I understand, these experiments don't refute the hypothesis of equivalence between GD and ICL completely. Instead, they simply ask the community to make small changes to the hypothesis (e.g. SGD in place of GD, auxiliary internal model isn't the same parent model, etc.). Hence, I have a slightly lower score but am happy to discuss it during the rebuttal period. \n\n\n1: Why Can GPT Learn In-Context? Language Models Implicitly Perform Gradient Descent as Meta-Optimizers. Dai et al'23.\n\n2: Making Pre-trained Language Models Better Few-shot Learners. Gao et al'21."
            },
            "questions": {
                "value": "Please see my questions in the previous section."
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "6: marginally above the acceptance threshold"
            },
            "confidence": {
                "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
            },
            "code_of_conduct": {
                "value": "Yes"
            },
            "first_time_reviewer": {
                "readers": [
                    "ICLR.cc/2024/Conference/Program_Chairs",
                    "ICLR.cc/2024/Conference/Submission8711/Senior_Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission8711/Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission8711/Reviewer_ivcd"
                ]
            }
        },
        "number": 2,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission8711/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698782710992,
        "cdate": 1698782710992,
        "tmdate": 1700667360940,
        "mdate": 1700667360940,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "fy1CSRvSHV",
        "forum": "992eLydH8G",
        "replyto": "992eLydH8G",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission8711/Reviewer_GeTu"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission8711/Reviewer_GeTu"
        ],
        "content": {
            "summary": {
                "value": "Recently, connections have been built between in-context learning (ICL) and gradient descent (GD), in order to better understand in-context learning. This paper challenges such connections from both theoretical and empirical perspectives. Specifically, the authors establish the difference between ICL and GD in terms of order sensitivity and demonstrate that the assumption regarding model parameters for the connection hardly holds in practice. Further, the paper proposes metrics to empirically evaluate to what extent ICL and GD perform differently."
            },
            "soundness": {
                "value": "2 fair"
            },
            "presentation": {
                "value": "2 fair"
            },
            "contribution": {
                "value": "2 fair"
            },
            "strengths": {
                "value": "1. The paper focuses on the topic of how to understand in-context learning, which is crucial to the field.\n\n2. The proposed perspective of order sensitivity to look into the difference between ICL and GD is interesting and looks novel to me."
            },
            "weaknesses": {
                "value": "1. I am a bit worried about the significance. The proposed order sensitivity is interesting and yet requires more in-depth analysis (see questions). However, I am not an expert in this field so I will defer to other reviewers regarding this point. \n\n2. The writing can be improved.  E.g., there are typos such as \"We know that both if ...\" and \"This is a relative metric is computed based...\"."
            },
            "questions": {
                "value": "1. As the author mentioned, the construction of Akyurek et al. \u00a8 (2022) allows for order sensitivity in GD by update on samples one by one. Do we still have the difference in terms of order sensitivity in that setting?\n\n2. What if we use specific types of positional encoding to make ICL agnostic to the order of demonstrations? Would the performance increase or not? \n\n3. Alternatively, we can use the average prediction of many random orders of demonstrations to make ICL agnostic. Is that setting explored?"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "5: marginally below the acceptance threshold"
            },
            "confidence": {
                "value": "2: You are willing to defend your assessment, but it is quite likely that you did not understand the central parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        },
        "number": 3,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission8711/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698796350212,
        "cdate": 1698796350212,
        "tmdate": 1699637092618,
        "mdate": 1699637092618,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "j61MslowFX",
        "forum": "992eLydH8G",
        "replyto": "992eLydH8G",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission8711/Reviewer_uBmS"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission8711/Reviewer_uBmS"
        ],
        "content": {
            "summary": {
                "value": "This paper scrutinizes the strong claims that LMs implement gradient descent in inference time to achieve their ICL functionality, and assesses whether specific constructions of such LMs are feasible. The claim that LMs implement internal GD to do ICL is discarded by showing that ICL in LMs are order-sensitive, and ICL output distribution is different from a GD trained model\u2019s distribution. The claim that LMs implement internal GD in a specific construction (e.g. as in Von Oswald et al. or Aky\u00fcrek et al.) is discarded by showing that the sparsity of LLama LM\u2019s weights significantly less than sparsity of the proposed constructions."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "3 good"
            },
            "contribution": {
                "value": "3 good"
            },
            "strengths": {
                "value": "1) The authors conducted an extensive set of experiments to compare ICL to fine-tuning a model with GD by comparing order-sensitivity, learning curve of two algorithms. They also compare the token overlap of the resulting predictors.\n2) Their results show a clear difference between ICL of LLama model vs fine-tuning LLama model with the same few-shot statsets.\n3) The authors also investigated parameter structure of LLama model and showed that it is far from constructed models in (Aky\u00fcrek et al., and Von Oswald et al.,)"
            },
            "weaknesses": {
                "value": "I think in general the paper needs to go over argumentations. I read both Aky\u00fcrek et al. and Von Oswald et al. very carefully and here are my issues with the current version of the paper.\n\n1) The GD is an ambiguous algorithm and it is unlucky to be GD in the title of Oswal and hence propagated to this paper. And this has important implications for the experiments presented in this paper. A proper learning algorithm for GD can be specified together with a loss function and a neural network. So, I believe the proper claim to refute should be in the form of \u201cLMs implement  internal GD on X neural network with Y loss function to achieve ICL for all X, Y\u201d  (some X, Y can also be meaningful but doesn\u2019t refute the possibility fully)\n\n2) **Definition-1 and its relation to the strong claim:** The strong claim **cannot be** \u201cLMs implement GD on cross-entropy on themselves\u201d because the Transformer can only implement internal algorithms on a strictly smaller model. For example, Aky\u00fcrek and Von Oswald show Transformers can implement GD on a linear model way smaller than the actual Transformer that does ICL. However, In Figure-1, authors compare ICL on the same model to GD on the same model with cross-entropy which is inherently impossible to be equal. The same issue of evaluating ICL of a model to GD of the same model exists in Token Overlap experiments as well.  And all of these issues arise from Definition-1 which seeks for equivalence of ICL with some fine-tuned version of the same model. \n\nOn the other hand, authors also proposes Definition-2 which is the proper version of the strong claim, however, do not present experiments where only some parts of an LM is finetuned. This unfortunately requires a search over what parameters to finetune which might be computationally expensive. But authors can search over intuitive subsets of all possible parameters.\n\n3) The GD part of the claim is a bit strong to be meaningful. For example, order sensitivity experiments are not related to **SGD** (online GD with some batch size < number of examples) which you also mentioned  in the end of P4 *\u201c... construction of Aky\u00fcrek allows for in GD as the update is performed on samples one-by-one instead \u2026\u201d*. A better experiments is to look at order-sensitivity of SGD. Those experiments left to Appendix, I suggest moving them to body and displaying together with GD.\n\n4) Aky\u00fcrek et al. does not make the strong claim that LMs implement GD to achieve ICL, and does not even imply. The paper argues that Transformers can discover learning algorithms to achieve ICL if it\u2019s trained for ICL. \n\nTheir main result is that the size of the Transformers changes the learned internal algorithm to achieve ICL. Smaller models are more close to SGD whereas large models implement Bayes optimal **Ridge Regression** solution to the linear regression problem. Even if I assume this paper implies something, it cannot be GD from reading these results. Because it suggests Bayesian learning, we expect ICL to be have a prior or a regularization that is learned during training time.\n\nOn the other hand, yes, Von Oswald et al. implies the strong claim in their intro \u201cWe find and describe one possible realization of this concept and hypothesize that the in-context learning capabilities of language models emerge through mechanisms similar to the ones we discuss here.\u201d"
            },
            "questions": {
                "value": "- Does the sparsity ratio changes from layer to layer of GPT-J?\n- Why do you switch between models GPT-J vs LLama?\n- In SGD experiments in the appendix:\n  - Did you try different mini batch sizes?\n  - Did you shuffle the examples or iterate in the same order?\n  - Did you do one pass SGD or multiple?\n\n**Summary of the Review**\n\nOverall, I find the GD vs ICL experiments interesting and highlighting that the community still needs better explanations for ICL. However, I find that the experiments do not refute some of the claims that the authors want to refute (W2), and (W1, W3, W4) important to be addressed before publication. I am hoping to raise my score if these weaknesses can be fixed or answered."
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "6: marginally above the acceptance threshold"
            },
            "confidence": {
                "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
            },
            "code_of_conduct": {
                "value": "Yes"
            },
            "first_time_reviewer": {
                "readers": [
                    "ICLR.cc/2024/Conference/Program_Chairs",
                    "ICLR.cc/2024/Conference/Submission8711/Senior_Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission8711/Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission8711/Reviewer_uBmS"
                ]
            }
        },
        "number": 4,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission8711/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698860869478,
        "cdate": 1698860869478,
        "tmdate": 1700762440172,
        "mdate": 1700762440172,
        "license": "CC BY 4.0",
        "version": 2
    }
]