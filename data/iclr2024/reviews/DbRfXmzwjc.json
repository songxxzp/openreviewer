[
    {
        "id": "Iq5ua8p0SR",
        "forum": "DbRfXmzwjc",
        "replyto": "DbRfXmzwjc",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission7546/Reviewer_bmZE"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission7546/Reviewer_bmZE"
        ],
        "content": {
            "summary": {
                "value": "The paper proposes a fragment-based VAE molecule generative model MAGNet to capture the full spectrum of molecules. Different from previous fragment-based models which use fixed fragment vocabulary and struggle to generate uncommon structures, MAGNet decomposes the generation process into two levels, i.e., shape-level and atom-level, for more flexible fragment decisions. Specifically, on the shape-level, MAGNet first generates the coarse shape/topology of molecules. Then, on the atom-level, MAGNet fills up the shape with atoms to get actual molecules. Experiments demonstrate that MAGNet can generate more topologically distinct structures and outperforms most graph-based approaches on standard benchmarks."
            },
            "soundness": {
                "value": "2 fair"
            },
            "presentation": {
                "value": "1 poor"
            },
            "contribution": {
                "value": "2 fair"
            },
            "strengths": {
                "value": "- The paper is well-motivated. While fragments are different in their atom constitution, they may share the same shape/topology with each other. Adding a shape-level generation step makes us select fragments more flexibly and capture the full spectrum of molecules more easily.\n- The paper is relatively novel. MAGNet\u2019s two-level generation style provides a reasonable way of designing molecules which as far as I know is different from main stream molecule generation methods.\n- Authors provide extensive experiment results showing MAGNet can capture the full spectrum of molecules."
            },
            "weaknesses": {
                "value": "- Not including a related work section discussing the connection between MAGNet and existing shape-based molecular generation methods [1, 2, 3].\n- The proposed method is not very clear to me. See details in Questions.\n\n[1] Long, S., Zhou, Y., Dai, X., & Zhou, H. (2022). Zero-shot 3d drug design by sketching and generating. Advances in Neural Information Processing Systems, 35, 23894-23907.\n\n[2] Adams, K., & Coley, C. W. (2022). Equivariant shape-conditioned generation of 3d molecules for ligand-based drug design. arXiv preprint arXiv:2210.04893.\n\n[3] Chen, Z., Peng, B., Parthasarathy, S., & Ning, X. (2023). Shape-conditioned 3D Molecule Generation via Equivariant Diffusion Models. arXiv preprint arXiv:2308.11890."
            },
            "questions": {
                "value": "- I do not understand how MAGNet generates the shape multiset mentioned in section 2.2. Can you give me more details?\n- Also in section 2.2, when inferring the shape connectivity, does MAGNet need to provide atom type? Why does the atom type exist on the shape-level step?\n- How does MAGNet extract fragments/shapes? Can you provide more examples in section 2.1?\n- In section 2.3, how you apply a Normalizing Flow to the latent space is confusing.\n- The paper uses the term shape to describe the intermediate results which I personally think the term topology is more appropriate."
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "3: reject, not good enough"
            },
            "confidence": {
                "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
            },
            "code_of_conduct": {
                "value": "Yes"
            },
            "first_time_reviewer": {
                "value": "Yes",
                "readers": [
                    "ICLR.cc/2024/Conference/Program_Chairs",
                    "ICLR.cc/2024/Conference/Submission7546/Senior_Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission7546/Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission7546/Reviewer_bmZE"
                ]
            }
        },
        "number": 1,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission7546/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698389531815,
        "cdate": 1698389531815,
        "tmdate": 1699636912739,
        "mdate": 1699636912739,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "Oj7hO9fREv",
        "forum": "DbRfXmzwjc",
        "replyto": "DbRfXmzwjc",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission7546/Reviewer_qQTC"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission7546/Reviewer_qQTC"
        ],
        "content": {
            "summary": {
                "value": "The paper introduces MAGNet, a novel graph-based model for molecule generation, which uniquely generates abstract shapes before allocating atom and bond types. This approach is proposed to increase flexibility across datasets and address the limitations of existing models that rely heavily on motif representations. The authors provide a comprehensive explanation of the model, its generation process, and the underlying methodology, demonstrating its improved performance on standard benchmarks and its ability to generate diverse molecular structures."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "3 good"
            },
            "contribution": {
                "value": "3 good"
            },
            "strengths": {
                "value": "Innovation: The paper presents a novel approach to molecule generation, moving away from the traditional motif-based methods. The introduction of abstract shapes as an intermediate step in the generation process is a significant innovation, potentially leading to more flexible and diverse molecule generation.\n\nComprehensive Methodology: The authors provide a detailed explanation of the MAGNet model, its generation process, and the underlying methodology. The factorisation of the data distribution of molecular graphs and the hierarchical generation process from shapes to atom and bond types are well-articulated.\n\nImproved Performance: The paper demonstrates that despite the added complexity of shape abstractions, MAGNet outperforms most other graph-based approaches on standard benchmarks. This is a strong point in favor of the proposed method.\n\nDiversity in Molecule Generation: The authors highlight and demonstrate that MAGNet\u2019s improved expressivity leads to the generation of molecules with more topologically distinct structures and diverse atom and bond assignments, which is crucial for applications in drug discovery and material science."
            },
            "weaknesses": {
                "value": "1. Insufficient Comparative Analysis:\nThe paper falls short in providing a comparative analysis with diffusion-based models, which are crucial in the domain of molecule generation. This lack of comparison might lead to an incomplete evaluation of MAGNet, as readers are left without a clear understanding of how the proposed model stands against these advanced alternatives. A thorough comparison, highlighting the strengths, weaknesses, and performance differences, would significantly enhance the paper\u2019s credibility and provide a more comprehensive assessment of MAGNet.\n\n2. Deviation from Established Terminology:\nThe terminology used to describe MAGNet\u2019s generation process, specifically the terms \"sequential\" and \"Attribute-Atom-Object (AAO),\" deviates from the established \"Sequential\" and \"One-shot\" terminology commonly used in the field. This inconsistency could potentially create confusion and hinder the paper\u2019s accessibility to readers familiar with the standard terms. Adopting the widely accepted terminology would ensure clarity and maintain consistency across the literature.\n\n3. Limited Reference to Foundational Works:\nThe paper does not adequately reference foundational works and comprehensive surveys in the field of molecule generation, which could limit the readers\u2019 ability to place MAGNet within the broader context of the field. Including references to seminal works such as \"A systematic survey on deep generative models for graph generation,\" and \"A survey on deep graph generation: Methods and applications,\" would provide a richer background, enhancing the paper\u2019s credibility and informative value.\n\n4. Exclusion of Alternative Molecule Representations:\nThe exclusive focus on a graph-based representation for molecules in the paper neglects the discussion of other popular representations like fingerprints. This exclusion limits the comprehensiveness of the paper, as readers are not provided with a comparison or rationale for the chosen representation. Discussing various molecule representations, their advantages, disadvantages, and applicability, would contribute to a more holistic view of the field and strengthen the paper\u2019s content."
            },
            "questions": {
                "value": "Would like to improve the authors have address the weakness above."
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "8: accept, good paper"
            },
            "confidence": {
                "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
            },
            "code_of_conduct": {
                "value": "Yes"
            },
            "first_time_reviewer": {
                "value": "Yes",
                "readers": [
                    "ICLR.cc/2024/Conference/Program_Chairs",
                    "ICLR.cc/2024/Conference/Submission7546/Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission7546/Reviewer_qQTC",
                    "ICLR.cc/2024/Conference/Submission7546/Senior_Area_Chairs"
                ]
            }
        },
        "number": 2,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission7546/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698604590860,
        "cdate": 1698604590860,
        "tmdate": 1700248379706,
        "mdate": 1700248379706,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "sWp6feCs2G",
        "forum": "DbRfXmzwjc",
        "replyto": "DbRfXmzwjc",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission7546/Reviewer_dbRP"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission7546/Reviewer_dbRP"
        ],
        "content": {
            "summary": {
                "value": "The authors present MAGNet, a graph-based generative model with novel molecular structure factorization. Unlike other fragment-based representation learning methods, the authors utilize abstract fragment shape templates. Shape-level structure abstract shows superior performance over fragment-level representations, which is reasonable.\n\nIn general, I find this manuscript clearly-written and easy to follow. The idea of shape-based factorization regularizes the vocabulary space to a limited number of shape templates, thus removing a large number of \"chemical degeneracy\" (i.e., different combinations of atomic species over the same structure template). It is reasonable that this method helps neural networks effectively learn the shape distribution and generate diverse molecular structures. I suggest accepting this manuscript after addressing some minor concerns discussed below."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "3 good"
            },
            "contribution": {
                "value": "3 good"
            },
            "strengths": {
                "value": "- Factorization of molecules into abstract (untyped) shapes is a reasonable and smart idea. Chemistry-agnostic shapes provide higher-level abstraction than conventional motifs, and help the representation learning model perceive molecular shape distributions.\n- Intuitively, MAGNet effectively decouples modeling structural and chemical diversity into two consecutive generation steps, hence the corresponding neural network only needs to capture distributions in a subspace instead of their product space. This may explain the reported diversity and validity of generated molecules.\n- Similar strategies have been adopted in protein design, e.g., RFDiffusion, where one first generates the backbone structure, then design a sequence that can fold into this structure.\n- Fig. 6 in Appendix is interesting. The smooth transition/interpolation between two distinct molecules shows the advantage of using shape templates over motif templates."
            },
            "weaknesses": {
                "value": "See questions."
            },
            "questions": {
                "value": "- I am curious about the reason behind not being able to effectively train the VAE model (i.e., prior matching term), but have to fit another NF to the latent space. Would you please provide more analysis here?\n- My understanding is that the model has been trained in an end-to-end manner. Atom-level inference is conditioned on the same latent vector $z$ as used in shape-level generation. If the latent space is also decoupled, would it help improve diversity of generated molecules as well as obtain a stable prior matching loss?\n- Fig 3b, does the x-axis show percentage (e.g., 0.50%) or ratio? Also, fragment-based methods model the distribution of shape&atomic species. Therefore, it is reasonable that if you marginalize over the atomic species and only analyze the shape coverage, MAGNet will by design do better at diverse shape sampling.\n- Could you please provide more details on fitting normalizing flow for the latent space?\n- Consider a particular generation task where a specific motif is desired to be present in the generated molecule, can MAGNet be tailored for this task?"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "6: marginally above the acceptance threshold"
            },
            "confidence": {
                "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        },
        "number": 3,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission7546/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698683874204,
        "cdate": 1698683874204,
        "tmdate": 1699636912402,
        "mdate": 1699636912402,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "7UOpvLfs1q",
        "forum": "DbRfXmzwjc",
        "replyto": "DbRfXmzwjc",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission7546/Reviewer_jTCd"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission7546/Reviewer_jTCd"
        ],
        "content": {
            "summary": {
                "value": "This work presents MAGNet, a generative model of small molecule graphs that uses a hierarchy of internal representations of subgraphs that make up the molecule.  The model first uses a simple connectivity pattern of nodes and edges, then names the atoms and specific bond types, and constructs the full molecule.  The authors demonstrate the use of MAGNet on existing datasets and discuss some properties of the generated molecule sets."
            },
            "soundness": {
                "value": "2 fair"
            },
            "presentation": {
                "value": "1 poor"
            },
            "contribution": {
                "value": "1 poor"
            },
            "strengths": {
                "value": "This paper has an original design of a pre-training model that makes some sense conceptually. The demonstration of conditional design prompted by a fragment or a shape is interesting as are the interpolation examples in the appendix. Unfortunately, the bulk of the paper does not come close to what I'd expect from an ICLR publication. It is hard to make a case for the significance of this work; the benchmarks are rather weak and to a degree uninteresting for practical drug discovery as there are no downstream applications of importance (logP design is trivial; SA/QED is mildly OK, but these are also simple to learn) and no uses of large pretraining sets. Given that this is ICLR I'd have liked to see something more detailed about the internal representations of this model, but there wasn't much to read about them. It also hurts the paper that the presentation of the method is unnecessarily unclear (the language and notation at the bottom of page 2 is messy but just defines the Murcko scaffolds, which one can explain concisely; more broadly much of section 2 could be denser/simpler.)"
            },
            "weaknesses": {
                "value": "If I understand correctly, then what the authors call \"shape\" is the so-called Murcko scaffold of individual fragments. Murcko scaffold basically is: turn every atom into carbon and every bond into a single one. It would have helped if the authors clarified this point early on.\n\nThe listed benchmark snippets in table 1 are not super relevant to drug discovery and the comparison models are weak compared to what one could nowadays train on a single GPU during a single week on a large dataset.  It would be nice to see the model applied to the open graph benchmark.\n\nThere is no good explanation of why one would like to use this model instead of simpler generalizable architectures, ideally pretrained on huge datasets.  I can understand the problems with generalization of the early JTVAE models, but the present model also inherently has such limitations, even if they are dramatically less likely (say if would not make a sterol if no structure with four fused rings existed in its training set.)"
            },
            "questions": {
                "value": "Why didn't the authors train this model on a large dataset (think 10s or 100s of millions of molecules) to make sure they can compare edge cases against other models, if any?  \n\nDo the authors have a reasonable argument for why at scale it would help to have their model instead of say a simple transformer model?\n\nThe hierarchical design of the model is somewhat interesting, especially given the known problems of vanilla GNNs to spontaneously discover these hierarchies themselves.  Did the authors take a view at the internal layers of their model to see examples of how the model represents molecules internally, and perhaps gain insight for how to scale up this model?\n\nDid the authors try to apply their model to the open graph benchmark (both the large-scale benchmark and the property prediction components that use small molecules)?  At least in that way it would be easier to demonstrate promise of the model architecture."
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "1: strong reject"
            },
            "confidence": {
                "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        },
        "number": 4,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission7546/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698702658877,
        "cdate": 1698702658877,
        "tmdate": 1699636912275,
        "mdate": 1699636912275,
        "license": "CC BY 4.0",
        "version": 2
    }
]