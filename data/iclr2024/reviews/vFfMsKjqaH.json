[
    {
        "id": "TZBeMWoplh",
        "forum": "vFfMsKjqaH",
        "replyto": "vFfMsKjqaH",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission6360/Reviewer_tqyH"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission6360/Reviewer_tqyH"
        ],
        "content": {
            "summary": {
                "value": "The paper proposes a novel interpretation of the distributional Bellman operator based on entropy entropy regularization. Specifically, it represents the continuous return distribution by a histogram of fixed support with equal bin size. Then the return distribution can be decomposed into a single-bin histogram (i.e. the bin the expectation of the return distribution falls into) and a term characterizing the impact of the return distribution despite its expectation. The relative weights between the two terms are regulated by a pre-defined hyperparameter. The authors then move on to show that this decomposition of the return distribution allows the distributional Bellman operation (which they call Neural Fitted Z-Iteration) to be reframed as a cross entropy-regularized Neural FQI when the distribution divergence to minimize is chosen as the KL divergence. They've demonstrated convergence of the decomposed distributional Bellman operator when minimizing the KL divergence as a consequence of the equivalence between optimizing histogram function and categorical distribution. Finally they proposed a new actor-critic algorithm incorporating the cross-entropy regularization. Experiments on Atari and Mujoco demonstrated better overall performance and analyzed the interplay between two types of entropy regularization."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "2 fair"
            },
            "contribution": {
                "value": "2 fair"
            },
            "strengths": {
                "value": "1. proposed and analyzed a novel angle to distributional RL\n2. thorough experiments"
            },
            "weaknesses": {
                "value": "1. I'm not so sure how enlighening the findings of the paper are. When you choose the KL divergence to minimize, equivalently you're maximizing cross-entropy. It doesn't come off as much of added value if you've shown the distributional Bellman operator minimizing KL is equivalent to a cross entropy regularized conventional Bellman operator when you approximate (I wouldn't say decompose, as the epsilon term renders your decomposition not exact) the return distribution as an expectation term and a categorical distribution.\n\n2. (minor) insufficient rigourousness in basic concepts, e.g., in Introduction, Q-learning is a type of TD learning not a separate category. Also TD learning is not specific to expectation-based RL, most existing distributional RL including the referenced CDRL is TD learning (i.e. bootstrapping from other timesteps) w.r.t. return distributions. And CDRL doesn't seem an actor-critic to me as the policy is just argmax of expected atom values."
            },
            "questions": {
                "value": "1. how the epsilon in Eq. 3 is pre-specified? Should it not be dependent on the actual return distribution which cannot be known in advance? Am I correct in the understanding that you are actually not learning the full return distribution, but still its expectation albeit allowing some uncertainty around it?\n\n2. if so, it seems to me you're matching the expaction whilst expanding it according to a pre-defined level of uncertainty retained from the target distribution. In this case, how would you ensure that the so expanded distribution still has the same expectation/the correct expectation?\n\n3. if you are minimizing KL divergence, how would you ensure the return distribution model is and remains as a histogram which is count-based?\n\n4. in Eq. 5, you're regularzing the cross-entropy between consecutive 'return distributions'. How is it connected to maximum-entropy RL which encourages 'policy' entropy or cross-entropy between the policy and a reference policy? There seems no bridge to me to be built between uncertainty in action selection and that in return estimate, the only connection perhaps being both can be approached by augmenting the reward function with the entropy term. In fact, I failed to understand the claim that your regularization is favouring target return distributions with large dispersion. It seems to me only to push the dispersion of the return distribution model to catch up with the dispersion of the target return distribution.\n\n5. (minor) how and why a policy can be learned to reduce the intrinsic uncertainty of the environment, shouldn't it by definition be intrinsic and thus independent from the policy?"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "details_of_ethics_concerns": {
                "value": "N/A"
            },
            "rating": {
                "value": "6: marginally above the acceptance threshold"
            },
            "confidence": {
                "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
            },
            "code_of_conduct": {
                "value": "Yes"
            },
            "first_time_reviewer": {
                "value": "Yes",
                "readers": [
                    "ICLR.cc/2024/Conference/Program_Chairs",
                    "ICLR.cc/2024/Conference/Submission6360/Senior_Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission6360/Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission6360/Reviewer_tqyH"
                ]
            }
        },
        "number": 1,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission6360/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1697820065653,
        "cdate": 1697820065653,
        "tmdate": 1699636702032,
        "mdate": 1699636702032,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "REs3VaBJ9N",
        "forum": "vFfMsKjqaH",
        "replyto": "vFfMsKjqaH",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission6360/Reviewer_rBfi"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission6360/Reviewer_rBfi"
        ],
        "content": {
            "summary": {
                "value": "This paper studies why distributional reinforcement learning (RL) can achieve successful empirical results. They mainly investigate the Categorical Distributional RL (CDRL) and indicate its strength comes from risk-sensitive entropy regularization. They showed that this regularization serves as an augmented reward function, pushing the learned distribution toward the target one. Experiments highlight this regularization's importance in distributional RL."
            },
            "soundness": {
                "value": "2 fair"
            },
            "presentation": {
                "value": "2 fair"
            },
            "contribution": {
                "value": "2 fair"
            },
            "strengths": {
                "value": "This paper studies an important question (why distributional RL is successful), and the way that they consider the distributional RL (or specifically, the categorical RL) is interesting. The theoretical claims are supported by the experiments."
            },
            "weaknesses": {
                "value": "The paper is a bit hard to follow. Some of the theoretical derivation is not followed by intuitive explanation or proof sketch. For example, eq. (3) and the subsequent remarks confused me regarding what $\\hat\\mu$ and $p_i^\\mu$ are. Does $p_i^\\mu$ mean the coefficient of the corresponding bin? I also don't see what $\\mu^{s,a}$ is two lines below. Moreover, I failed to understand eq. (6) and what Proposition 3 tries to convey, specifically regarding the integral on the right. Additionally, Theorem 2 asserts the convergence of the learned policy, yet it does not specify under what notion it converges, that is, it lacks clarity on the measure under which it converges.\n\nI found most theoretical results rely on the assumption that $\\mathcal{H}(\\mu^{s,a},q_\\theta^{s,a})$ is bounded by a constant for all $s,a$, which I think needs to be justified. I guess $\\mu$ is the resulting histogram density, so the difference here might depend on the range of support and $N$, and thus the upper bound might actually look like the results in [1].\n\nOverall, I think this paper may need some necessary polish to improve clarity before I can make an informed evaluation.\n\n\n\n[1] Rowland, M., Bellemare, M., Dabney, W., Munos, R. and Teh, Y.W., 2018, March. An analysis of categorical distributional reinforcement learning. AISTATS, 2018."
            },
            "questions": {
                "value": "The formulation of neural FZI is similar to [2]. The latter focuses on maximizing the log-likelihood, which is equivalent to minimizing the KL divergence or cross-entropy. The authors also proposed to specify the $d_p$ in eq.(2) to KL divergence, so the formulation looks almost same. Hence, I am wondering about the potential connection here.\n\n[2] Wu, R., Uehara, M. and Sun, W. Distributional Offline Policy Evaluation with Predictive Error Guarantees. ICML, 2023."
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "3: reject, not good enough"
            },
            "confidence": {
                "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        },
        "number": 2,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission6360/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698642457584,
        "cdate": 1698642457584,
        "tmdate": 1699636701823,
        "mdate": 1699636701823,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "SJd7XzfJk1",
        "forum": "vFfMsKjqaH",
        "replyto": "vFfMsKjqaH",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission6360/Reviewer_73VF"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission6360/Reviewer_73VF"
        ],
        "content": {
            "summary": {
                "value": "In this work, the authors take a closer look at the categorical\ndistributional RL framework and study the properties of the\noptimization problems therein. Inspired by their analysis, the paper\npresents a novel framework (DERPI) for model-free RL similar to MaxEnt\nRL, and an associatedc\nactor-critic algorithm (DERAC) based on this framework. Optimization\nin the DERPI framework is shown to be closely related to categorical\ndistributional RL, thereby establishing a connection between\ncategorical disatributional RL and MaxEnt RL."
            },
            "soundness": {
                "value": "2 fair"
            },
            "presentation": {
                "value": "1 poor"
            },
            "contribution": {
                "value": "3 good"
            },
            "strengths": {
                "value": "This paper presents some interesting insights into the optimization of\nreturn distributions in categorical distributional RL, and inspired by\nthese insights, proposes a new framework for exploration in RL. The\nnew framework is closely related to the highly successful MaxEnt RL,\nbut it performs reward shaping based on the mismatch between the\npredicted return distribution and its target, which I believe is novel\nand sensible. This framework also explicitly leverages the \"auxiliary\ntasks\" quality of distributional RL for exploration, which is satisfying."
            },
            "weaknesses": {
                "value": "Many of the mathematical statements and objects are not defined\nprecisely -- this is a recurring issue throughout the text, making it\nextremely difficult to follow. Please see the \"Questions\" section for\nfurther details.\n\nThe histogram parameterization given in equation (3) needs more\nclarification. Some terms are left undefined (e.g. $p_i^\\mu$), making\nit difficult to understand the model and the motivation.\n\nAs discussed more in \"Questions\", the return distribution\ndecomposition is fairly mysterious to me. It seems that the purpose is\nto show that some component of CDRL is sort of 'mimicking' expected\nvalue RL. However, this is already known, since it is known that the\ncategorical projection $\\Pi_{\\mathcal{C}}$ is mean-preserving. Thus,\nI do not undertand the value of Proposition 3: we already know that\nCDRL will learn the mean of the return distribution function.\n\nGenerally, I do not agree that the proposed algorithms are\nrisk-sensitive in any meaningful sense -- they simply have an\nadditional distribution-matching term in the reward signal. The\nrisk-seeking/risk-averse behavior is driven by a mismatch in return\ndistribution estimates and not a specified propensity for risk\n(i.e. there is no way to control or predict how risk-averse the agent\nwill be).\n\nThe connection between DERPI and CDRL is not established clearly at\nall, which is a shame, since I believe this is the most significant\nfinding. Particularly, I belive the content of Appendix I, notably\nequation (37), should be clearly written in the main text and\ndiscussed. As it stands, this part is easy to miss, and I believe it\nis crucial for tying together the claims of the paper.\n\n## Minor issues\nOn page 3 in the \"Return Density Function Decomposition\" paragraph,\nthere is a typo in \"we utilize a histgram function estimator\".\n\nProposition 1 would read better if the $\\iff$ was substituted by the\ntext \"if and only if\"."
            },
            "questions": {
                "value": "In the \"Bellman Operators vs Distributional Bellman Operators\"\nsection, it says tha random variable definition of the distributional\nBellman operator is less mathematically rigorous than the\nreturn-distribution definition -- what do you mean by this? Both\ndefinitions should be equivalent.\n\nI doubt Theorem 1 is novel, it is essentially a concentration\ninequality on histogram estimates. It is also not clear to me what is\nmeant by $O_P$ here. What is the difference between Theorem 1 and\ne.g. the DKW inequality?\n\nThe object $\\widehat{\\mu}^{s,a}$ is not defined clearly at all.\nParticularly, $p_i^\\mu$ is not defined anywhere.\nIs $\\widehat{\\mu}^{s,a}$ just the difference between the \"true\"\nhistogram of the return distribution function and the histogram with\nall mass (times $1-\\epsilon$) in $\\Delta_E$?\n\nRight after Proposition 1, what does \"this decomposition exactly keeps\nthe vanilla (categorical) distributional RL scenario without shifting\nproblems\" mean? What are shifting problems?\n\nI don't agree that the second term of equation (5) is doing\n\"risk-sensitive entropy regularization\". It is neither risk-seeking\nnor risk-neutral (at least, not intuitively). Moreover, I wouldn't\nclassify this as a regularization term -- it is directly learning the\nparameters of the model -- the only \"regularization\" here is the\nexplicit constraint of modeling categorical distributions. But\nregardless of the parameterization of the return distribution\nfunction, you can decompose the return distributions into a term\nencapsulating the mean and the other encapsulating the rest of the\nstatistics. Is the idea that under the KL loss, the loss for the mean\ncomponent does not interact with the rest of the loss?\n\n\nI don't understand the claim of equation (6). It says that with\nprobability 1, $Z_\\theta^{k+1}=\\mathcal{T}Q_{\\theta^*}(s,a)$ -- how\ncan this be true? Isn't $Z$ supposed to represent the random return?\nIn this case, why should it be deterministic?\n\nThe proof of proposition 3 is sloppy. Firstly, equation (29) is incorrect -- the KL is not\nproportional to the last line, it is missing an additive\n$\\Delta\\log\\Delta$ term I believe (though this does not change the\nminimizer).\nMore importantly, the claim that the limiting optimizer as $\\Delta\\to\n0$ is not proved correctly -- you proved that the limit of the\nminimizer tends to the Dirac, but not that the minimizer of the limit\ntends to the Dirac, as claimed. However, again I am not really\nconcerned about the correctness of the claim here.\nEquation (30) is not justified to me at all -- the target should still\ninclude the $\\mu$ term, which seems to have disappeared. I believe the\nconfusion is coming from misleading notation. To my understanding, the\nclaim of Proposition 3 is that this is the behavior if you optimize\nthe random returns only w.r.t. term (a), but then that is not really\n$Z$. So really, what this proposition is saying is that if the targets are\ndeterministic, they are at the expected return and CDRL will converge\nto the Diracs at the expected return, but we already know this from\ne.g. \"An Analysis of Categorical Distributional Reinforcement\nLearning\" by Rowland et. al."
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "5: marginally below the acceptance threshold"
            },
            "confidence": {
                "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
            },
            "code_of_conduct": {
                "value": "Yes"
            },
            "first_time_reviewer": {
                "value": "Yes",
                "readers": [
                    "ICLR.cc/2024/Conference/Program_Chairs",
                    "ICLR.cc/2024/Conference/Submission6360/Senior_Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission6360/Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission6360/Reviewer_73VF"
                ]
            }
        },
        "number": 3,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission6360/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698702021605,
        "cdate": 1698702021605,
        "tmdate": 1699636701610,
        "mdate": 1699636701610,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "ERsEAxWIKV",
        "forum": "vFfMsKjqaH",
        "replyto": "vFfMsKjqaH",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission6360/Reviewer_FbE9"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission6360/Reviewer_FbE9"
        ],
        "content": {
            "summary": {
                "value": "The paper establishes an equivalent representation of distributional RL (with a histogram representation of random variables) that seem to indicate that it takes the form of a regularized Q-iteration. This might also explain why categorical distributional RL might implicitly encourage exploration."
            },
            "soundness": {
                "value": "1 poor"
            },
            "presentation": {
                "value": "1 poor"
            },
            "contribution": {
                "value": "1 poor"
            },
            "strengths": {
                "value": "The paper investigates an important question: namely, how to explain the better performance of distributional RL algorithms. It articulates an innovative perspective on the question by decomposing the random variable representation as a mixture of a measure concentrated at the mean and a measure that embodies the spread."
            },
            "weaknesses": {
                "value": "The paper is highly obscure and filled with ambiguous statements and typos that prevented me from validating most of its claims. It also appear to support its theory using arguments that lack rigour or purely contradictory. I finally disagree with the claim on page 4 that distributional RL produces risk sensitive policies:\n\nExamples of lack of rigour:\n- the use of the concept of \"ideal case\" mentioned at the bottom of page 2 to support the idea that Neural FQI converges to optimal Q-function, which is reused in the proof of proposition 3 to assume that neural FZI's iterate recover the Bellman update. \n- a mismatch of assumption between the statement of proposition 3 and its proof, where the former assumes that the $Y_i$'s are representable while the latter assumes that $E[Y_i]$ is.\n\nExample of contradiction:\nProposition 3 is contradicting itself in equation (6). The left equation claims that the minimizer over $q_\\theta$ converges to the k+1 iterate of the Q function in FQI while on the right claiming that it converges to the actual Q-value function.\n\nTypos & inclarities include:\n- p2: defining the support of \\hat \\eta first as $z_i$ then later by $l_i$\n- Eq 1: $[y_i - Q_\\theta(s_i,a_i)]^2$ instead of $[y_i - Q_\\theta^k(s_i,a_i)]^2$\n- Eq. 2: similar issue but for $Z_\\theta^k(s_i,a_i)$\n- p.3 \"As such, this ... shifting problems\" needs rewritting\n- p.3 \"the the\"\n- p.4 I suspect that in proposition 2 $\\Delta_E^i$ represents the interval that $E[ R(s,a) + \\gamma Z_k^\\pi(s_i',\\pi_Z(s_i') ]$ and that generally there is a confusion between this expression and $E[Z^\\pi(s,a)]$. \n- p.2  why define $R(s,a)$ with capital when it is a deterministic reward? \n- p.3 in an expression like $Y_i = R(s_i,a_i)+\\gamma Z_{\\theta^*}^k(s_i',\\pi_Z(s_i'))$ there needs to be a notation warning that lower cases variables are given.\n- p4 the definition of $\\hat \\mu$ in proposition 2 is inaccurate as it seems to be the induced histogram from the decomposition of $Y_i$\n- p4 \"for $\\forall$ k\" should be \"for all k\""
            },
            "questions": {
                "value": "I do not have questions as I believe the paper needs a thorough rewriting and is currently unfit for publication."
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "3: reject, not good enough"
            },
            "confidence": {
                "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
            },
            "code_of_conduct": {
                "value": "Yes"
            },
            "first_time_reviewer": {
                "value": "Yes",
                "readers": [
                    "ICLR.cc/2024/Conference/Program_Chairs",
                    "ICLR.cc/2024/Conference/Submission6360/Senior_Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission6360/Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission6360/Reviewer_FbE9"
                ]
            }
        },
        "number": 4,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission6360/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698812992811,
        "cdate": 1698812992811,
        "tmdate": 1699636701453,
        "mdate": 1699636701453,
        "license": "CC BY 4.0",
        "version": 2
    }
]