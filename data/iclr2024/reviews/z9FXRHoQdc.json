[
    {
        "id": "G7OOQ9bDcz",
        "forum": "z9FXRHoQdc",
        "replyto": "z9FXRHoQdc",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission3705/Reviewer_1vtA"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission3705/Reviewer_1vtA"
        ],
        "content": {
            "summary": {
                "value": "This paper proposes a learning method to discover an NE solution that discovers maximum social welfare. The idea extends the LOLA and POLA works by directly applying MARL with backpropagation through the entire opponent policy. The experiments are conducted on the IPD game and the coin game."
            },
            "soundness": {
                "value": "2 fair"
            },
            "presentation": {
                "value": "2 fair"
            },
            "contribution": {
                "value": "2 fair"
            },
            "strengths": {
                "value": "In general, I appreciate the attempt to extend the existing works further, from a few RL steps to the policy change via policy conditioning. However, the paper has significant technique issues."
            },
            "weaknesses": {
                "value": "### Fundamental Issue\n\nThe fundamental issue of this work is that the paper directly assumes **symmetric NEs** throughout the entire paper. If we know **in advance** that the desire NE **must** be symmetric, then all the technical derivations in this paper are correct. However, although IPD falls into this category, this remains an extremely strong assumption and you cannot really leverage this assumption during algorithmic design, which, to some extent, is a cheating strategy. \n\nI want to remark that LOLA does not adopt parameter sharing during learning. \n\nI also want to mention that a symmetric game does not mean that the NE is symmetric. Let's consider a particular symmetric 2-player matrix game with a payoff matrix as\n```\n(0, 0), (1,1)\n(1,1), (0,0)\n```\nThis is an XOR game where the NE should be two agents taking different actions, which cannot represented by policies with shared parameters. You may refer to [this paper](https://arxiv.org/abs/2206.07505) for a discussion on the XOR game.\n\nAnother example would be a modified chicken game as shown below. \n```\n(0, 0), (0,1)\n(1,0), (-1,-1)\n```\nThe NE solution is the same as the XOR game. \n\nI also want to point out that the claims in Section 4.3.2 are particularly problematic. \n1. \"_this is equivalent to training an agent with self-play with reward sharing_\". This claim is **wrong**. Equation (7) is only equivalent to **reward sharing _with parameter sharing_**. \"Self-play with reward sharing'' should refer to the case where \"you learn two different policies with different parameters while the game reward is shared across agents\". So, self-play with reward sharing should be able to learn an NE in the XOR game while equation 7 can never due to parameter sharing\n2. \"_In zero-sum games, this update will have no effect as the gradient would be zero_\". To be frank, I was deeply shocked by such a conclusion at the very beginning when I read this sentence. Then I find it correct but meaningless: a game is both symmetric and zero-sum if and only if it is a zero game, which means you have zero gradient everywhere. \n\nFinally, the concept of _symmetric game_ only applies to two-player games. For general $N$-player games, you are essentially assuming the game is cooperative. \n\n### Minor Issues\n\n1. Section 2.1 presents a $N$-player game formulation. However, the entire paper adopts a two-player setting. \n2. At the end of section 4.1, it is stated that \"_Note that ($\\theta^{\u2217\u22171}$, $\\theta^{\u22172}$) is a nash equilibrium by definition._\" This sounds wrong to me. An NE should be defined over a minimax operator rather than two separate equations. A simple counter-example here is the rock-paper-scissor game. Suppose initially you have $\\theta^1$ to be rock. Then $\\theta^{*2}$ will be paper, and $\\theta^{\u2217\u22171}$ becomes scissor, which is clearly not an NE. \n3. The presentation of Section 4.2 is hard to follow. A few examples. What do you mean by \"detective\u2019s conditioning\"? I would be better to have a formulation of what you want to present. It is also mentioned \"the behavior of the agent against a random agent\" in Section 4.2.2. Here the word \"agent\" is mentioned twice. So which is agent 1 and which is agent 2? I guess you are using agent to refer to agent 1 while the detective to agent 2 but it is not always consistent. \n4. There are also notation issues. I'm always confused by which agent an action refers to. Moreover, in Equation 6, $b$ is used to denote the action from agent 2. However, the notation of $b$ is never introduced before."
            },
            "questions": {
                "value": "First of all, I think the paper should be substantially rewritten.\n\nBesides, I would be also curious about how your algorithm will perform on cases where (1) the NE is asymmetric and (2) the parameter sharing is turned off, i.e., two agents have two separate policies."
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "3: reject, not good enough"
            },
            "confidence": {
                "value": "5: You are absolutely certain about your assessment. You are very familiar with the related work and checked the math/other details carefully."
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        },
        "number": 1,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission3705/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1697640697821,
        "cdate": 1697640697821,
        "tmdate": 1699636326799,
        "mdate": 1699636326799,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "hVx0b1EG40",
        "forum": "z9FXRHoQdc",
        "replyto": "z9FXRHoQdc",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission3705/Reviewer_FRpg"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission3705/Reviewer_FRpg"
        ],
        "content": {
            "summary": {
                "value": "This paper proposes a novel opponent-aware framework to improve cooperation. The framework involves training a detective to approximate the opponent, training the agent based on the interaction between the detective and agent, and conducting self-play to learn to cooperate. The experiments demonstrate that the proposed method can improve social welfare."
            },
            "soundness": {
                "value": "2 fair"
            },
            "presentation": {
                "value": "3 good"
            },
            "contribution": {
                "value": "2 fair"
            },
            "strengths": {
                "value": "1) The proposed method that involves training a detective to help training the agent is interesting."
            },
            "weaknesses": {
                "value": "1) My major concern is that the explanation why BRS outperforms POLA is not very clear. The authors mention that \"When the opponent is specifically trained to maximize its own return against a fixed policy trained by POLA, the first exploits the former.\" However, it is not clear whether this issue would be avoided when POLA is replaced by the proposed BRS. Additionally, the paper claims that \"POLA can't differentiate through all opponent optimization steps,\" but more experiments are needed to support this claim. Besides, the authors also state that \"the interactions between the agent and the detective mirror the foundational Stackelberg setup,\" but it is still not clear whether convergence to Stackelberg equilibrium helps to improve social welfare. More detailed analysis is needed to clarify these points.\n\n2) Recently, [1] proposed a method for reasoning about players' future strategy through multiple lookahead steps. This suggests that scalability issues for POLA (or other related works) may not be a serious problem. It would be helpful if the authors could discuss some details about [1].\n\n3) The training curves for baselines and proposed methods are missing. Also it would be helpful to test the proposed method in more complicated social dilemma environments, such as those presented in [2].\n\n4) Some typos need to be fixed, including Alg 1., $\\theta_1' \\leftarrow \\theta_1+z$ should be $\\theta_1 \\leftarrow \\theta_1+z$."
            },
            "questions": {
                "value": "1) In Corollary D.3, the paper uses $r^1\\left(s_t, a_t, b_t\\right)+r^2\\left(s_t, b_t, a_t\\right)=0$ which implies $R^1(\\tau)=-R^2(\\tau)$. However, in proposition D.2, the authors use Lemma D.1 which assumes $r^1\\left(s_t, a_t, b_t\\right)=r^2\\left(o_t, b_t, a_t\\right)$ so as to imply  ${\\mathbb{E}}\\left[R^1(\\tau)\\right]={\\mathbb{E}}\\left[R^2(\\tau)\\right]$. Since Corollary D.3. also involves proposition D.2,This creates a potential inconsistency, and the proof of Corollary D.3 may not be correct. The authors are requested to provide clarification on this matter.\n\n\n\n\n\n\nReferences:\n\n[1] Recursive Reasoning in Minimax Games: A Level k Gradient Play Method\n\n[2] Multi-agent Reinforcement Learning in Sequential Social Dilemmas"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "5: marginally below the acceptance threshold"
            },
            "confidence": {
                "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
            },
            "code_of_conduct": {
                "value": "Yes"
            },
            "first_time_reviewer": {
                "value": "Yes",
                "readers": [
                    "ICLR.cc/2024/Conference/Program_Chairs",
                    "ICLR.cc/2024/Conference/Submission3705/Senior_Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission3705/Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission3705/Reviewer_FRpg"
                ]
            }
        },
        "number": 2,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission3705/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698727290915,
        "cdate": 1698727290915,
        "tmdate": 1699636326710,
        "mdate": 1699636326710,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "4VelzND3wP",
        "forum": "z9FXRHoQdc",
        "replyto": "z9FXRHoQdc",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission3705/Reviewer_NynT"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission3705/Reviewer_NynT"
        ],
        "content": {
            "summary": {
                "value": "The authors introduce a new scalable method to tackle general-sum games called Best Response Shaping (BRS). BRS works by differentiating through an opponent that is approximating a best response. They introduce a way for the detective to condition on the agent's policy through question answering. They show promising results in the IPD and Coin Game."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "2 fair"
            },
            "contribution": {
                "value": "2 fair"
            },
            "strengths": {
                "value": "Originality:\n\nThe author's proposed method is original and builds and contributes on top of prior work. The \"detective\" mechanism is an interesting approach to approximating the best response that I have not seen in previous literature.\n\nQuality:\n\nThe author's evaluate in the challenging Coin Game environment and the IPD and run a large number of relevant ablatoins. \n\nClarity:\n\nThe authors describe the IPD, Coin Game, and related literature in depth.\n\nSignificance:\n\nAI systems that perform well in general-sum scenarios are becoming increasingly important as AI systems become more widely-deployed."
            },
            "weaknesses": {
                "value": "Originality:\n\n- The training paradigm described here is closely related to [PSRO](https://arxiv.org/pdf/1711.00832.pdf), which is not mentioned in the paper.\n\nClarity:\n\n- The writing does not make it clear that the detective and agent take turns during optimization. The title of Algorithm 1 (that it says \"a single iteration\") is the *only* way I knew that this is how the training is done. Otherwise, it seems as though the detective is first trained on a pre-selected buffer B, which *significantly changes the reader's understanding of the method*.\n\n- Section 4.1 and 4.2 really make it seem like the detective is pre-trained when it is not.\n\n- BRS-NOSP is an important part of Figure 2, but is not defined until significantly later. \n\n- It's still not clear which player is $\\theta_1$ and which is $\\theta_2$. Presumably the agent would be $\\theta_1$ and the detective would be $\\theta_2$, but that is flipped in Equation 4 where $\\theta_r$ takes the place of $\\theta_1$ but actually represents the detective and the agent is now $\\theta_2$ (?)\n\n- The whole description of \"Simulation-Based Question Answering\" makes the setup far more confusing than it needs to be. Here is my understanding: The conditioning vector consists of the Q-Values of each action of a random opponent policy in that state. The Q-Values are estimated by sampling trajectories. It is not described in the paper like this, and is instead treated as a complicated \"Question-Answering\" scheme.\n\n- Describing and defining $\\delta_A$ before describing or motivating what $Q^\\text{simulation}$ was confusing as a reader, as it is uncertain how $\\delta_A$ is related to anything.\n\n- It's unclear why the authors have a paragraph about Diplomacy in the related work and a paragraph about self-play from human data. It's fine to include it, but the authors should explain, *in the paper*, why they include it.\n\n- The authors do not write out the bi-level optimization in Equation 12, making it seem like a single-level optimization. Writing it out would make this significantly more clear that it's a bi-level process.\n\nQuality:\n\n- The analysis is only done on three seeds (stated in the Appendix). This is  small, considering the high variance we observe from POLA. Using more seeds for POLA because the authors \"observed higher variance\" is problematic from a statistical point of view. (See: Stopping rules in statistics).\n\n- The authors state that \"in this paper, [they] advocate that a reasonable point of comparison is the agent\u2019s outcome when facing a best response opponent, which we approximate by Monte Carlo Tree Search (MCTS).\" I cannot find where in the paper the authors advocate for this. This is a significant claim, since arguably POLA and LOLA are not interested in this setting as much and seem to be far more interested in learning *online* against opponents that are also *learning online*. This is rather important, as it makes head-to-head comparisons with POLA a bit more questionable, seeing as it was designed for a different setting. \n\nSignificance:\n\n- BRS is *more exploitable than POLA* in Figure 3 against AD, seemingly contradicting the purpose of the paper. BRS-NOSP performs better, but at the cost of social welfare. However, I understand that you can't get the best of everything in general-sum games (See Q4 below).\n\n- The authors collected head-to-head results of POLA and BRS (in the Appendix Figure 7), but have elected not to show them in the main text. It seems as though POLA outperforms BRS in the head-to-head, further indicating that BRS is exploitable.\n\n- The authors write that the Good Shepherd is not scalable; however, their approach also seems similarly difficult to scale. (See Q3: below). What is the sample efficiency in terms of simulated environment steps?"
            },
            "questions": {
                "value": "1. Why not just train directly against the MCTS opponent?\n\n2. BRS-NORB performs near-identically to BRS in Figure 4 and is *significantly simpler*. Why not just make the method BRS-NORB?\n\n3. Isn't calculating $\\delta_A$ at every single timestep extremely expensive and not very scalable? What is the sample efficiency of BRS in terms of the total number of simulator steps? \n\n4. Why did you run head-to-head results for the BRS variants and POLA in the Appendix, but not include them in the main text? I understand that evaluations in general-sum games can be odd, since the ultimate objective is not well-defined. I would be more convinced that BRS is valuable if there was a more explicit metric demonstrating reciprocity.\n\n5. What is the intuition for the choice of conditioning? Why is an estimate of Q-Values of a random policy in the current state a good metric?\n\n6. Misc: What is the reasoning for the separate optimizers? (Equation 8). Have you ablated this?"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "6: marginally above the acceptance threshold"
            },
            "confidence": {
                "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
            },
            "code_of_conduct": {
                "value": "Yes"
            },
            "first_time_reviewer": {
                "readers": [
                    "ICLR.cc/2024/Conference/Program_Chairs",
                    "ICLR.cc/2024/Conference/Submission3705/Senior_Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission3705/Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission3705/Reviewer_NynT"
                ]
            }
        },
        "number": 3,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission3705/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698806231411,
        "cdate": 1698806231411,
        "tmdate": 1700587270719,
        "mdate": 1700587270719,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "T5ylW1SgBy",
        "forum": "z9FXRHoQdc",
        "replyto": "z9FXRHoQdc",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission3705/Reviewer_Hmjc"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission3705/Reviewer_Hmjc"
        ],
        "content": {
            "summary": {
                "value": "The paper introduces a new opponent modelling tool which differentiates through a constructed opponent that approximates the\nagent's best response policy in a best-response algorithm-like manner. The paper include various empirical evaluations to validate the proposed mechanisms."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "4 excellent"
            },
            "contribution": {
                "value": "2 fair"
            },
            "strengths": {
                "value": "The paper introduces a neat method for overcoming some of the weaknesses in current opponent modelling approaches. The paper is both well-written and well structured with good empirical results to support the authors' claims."
            },
            "weaknesses": {
                "value": "**Missing references**\n\nSome important references have been missed such as [1] and [2].\nFor example [1] introduces a method for incorporating diversity into best-response dynamics leading to a diverse fictitious play/diverse best response dynamics. Since fictitious play is based on a type of best-response method, a discussion on how the authors\u2019 paper compares to [1] is needed to be able to properly evaluate the authors\u2019 current contribution.\n\n**Limitations**\nIt seems that method requires the agent to have access to the detectives received rewards (and vice-versa) \u2013 this seems to limit the application to various non-cooperative multi-agent settings where at least the reward may be privately received.\n\nIn the abstract, the authors state the focus of the paper is in partially-competitive games, however the study of the cooperation regularization method does not shed any light on games that may be of mixed character (for example games in which $r^1(s,\\cdot)=-r^2(s,\\cdot)$ and $r^1(s',\\cdot)=r^2(s',\\cdot)+k$ for $s\\neq s'$). \n\nIn the conclusion, the authors state that one of the aims is improving the scalability and non-exploitability of agents. However, it is unclear about the practicalities of such a method in larger scale games as well as how it could ever be adapted beyond two-player games.\n\n \n\n[1] Perez-Nieves, Nicolas, et al. \"Modelling behavioural diversity for learning in open-ended games.\" International conference on machine learning. PMLR, 2021.\n[2] Yang, Yaodong, et al. \"Multi-agent determinantal q-learning.\" International Conference on Machine Learning. PMLR, 2020."
            },
            "questions": {
                "value": "Q1: How does the method compare to other approaches that introduce diversity into opponent modelling such as [1] and [2]?\n\nQ2: Can the authors comment on whether or not (and how) this could be applied in games where the opponent\u2019s rewards are unobserved?\n\nQ3: Although the cooperation regularization method yields a useful tool that does not produce cooperative effects in zero-sum games, its effect in games in which some game states the players ought to behave adversarially and other game states cooperatively (for example the weakest link) is unclear to me. Can the authors shed any light on this?\n\n[1] Perez-Nieves, Nicolas, et al. \"Modelling behavioural diversity for learning in open-ended games.\" International conference on machine learning. PMLR, 2021.\n[2] Yang, Yaodong, et al. \"Multi-agent determinantal q-learning.\" International Conference on Machine Learning. PMLR, 2020."
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "5: marginally below the acceptance threshold"
            },
            "confidence": {
                "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        },
        "number": 4,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission3705/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698843206616,
        "cdate": 1698843206616,
        "tmdate": 1699636326571,
        "mdate": 1699636326571,
        "license": "CC BY 4.0",
        "version": 2
    }
]