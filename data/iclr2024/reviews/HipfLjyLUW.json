[
    {
        "id": "NvIwzXRV63",
        "forum": "HipfLjyLUW",
        "replyto": "HipfLjyLUW",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission2095/Reviewer_a89B"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission2095/Reviewer_a89B"
        ],
        "content": {
            "summary": {
                "value": "This paper presents a hierarchical GFlowNet designed to generate crystal material structures. The proposed method decomposes the material space into a hierarchy of subspaces, including space groups, lattice parameters, and atoms. The core generative model is the GFlowNet, which is trained using a set of physics-informed reward functions. Experiments have been conducted focusing on battery material discovery to demonstrate the effectiveness of the proposed method."
            },
            "soundness": {
                "value": "2 fair"
            },
            "presentation": {
                "value": "2 fair"
            },
            "contribution": {
                "value": "2 fair"
            },
            "strengths": {
                "value": "+ The proposed method is straightforward and easy to understand.\n\n+ Enough level of detail on the method is given, easy for reimplementation."
            },
            "weaknesses": {
                "value": "- The paper lacks clarity in explaining the motivation behind the proposed method and its components, making it challenging to discern the specific advantages or necessity of employing GFlowNet in crystal material generation. The introduction of physics-informed reward functions also lacks motivation. There are totally four new reward functions introduced. While their individual effectiveness is showcased through an ablation study, without a robust theoretical underpinning or discussion compared with existing approaches, it is not convincing enough. Does any existing work try similar stuff already? I could possibly raise some random ideas of some physic-related reward functions but how to prove the authors' proposed set of functions are optimal?\n\n- The writing of the paper feels hurried and overloaded with technical details, at the expense of coherence and contextual depth.  The introduction is full of many technical details but lacks many discussions related to current literature, what the exact problem is which existing methods either do not aim to tackle or cannot deal with. There is no illustrative figure until page 4., hindering a clear comprehension of the proposed components. A high-level overview and an initial presentation of the experimental evaluations and aims could mitigate these issues and enhance the paper's overall accessibility.\n\n- The paper\u2019s experimental section does not convincingly demonstrate the superiority of the proposed method. Observing Tables 1 and 2, it\u2019s evident that the proposed methodology struggles to outperform baseline models consistently across various evaluation metrics. This modest performance raises questions about the fundamental contributions and practical viability of the proposed approach. A clearer demonstration of the proposed method's unique advantages, or a clearer justification of its design choices, is crucial. Without such improvements, the paper\u2019s contribution remains uncertain and inadequately supported."
            },
            "questions": {
                "value": "- Section 3.1, \"atom list L\" should be \"atom list A\"\n\n- Section 3.1, what are the 230 space groups? Add references or explanation or hyperlink to appendix.\n\n- Figure 1 caption is missing period.\n\n- Section 4.1, what are the edges of the graph?"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "3: reject, not good enough"
            },
            "confidence": {
                "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
            },
            "code_of_conduct": {
                "value": "Yes"
            },
            "first_time_reviewer": {
                "value": "Yes",
                "readers": [
                    "ICLR.cc/2024/Conference/Program_Chairs",
                    "ICLR.cc/2024/Conference/Submission2095/Senior_Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission2095/Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission2095/Reviewer_a89B"
                ]
            }
        },
        "number": 1,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission2095/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698707429387,
        "cdate": 1698707429387,
        "tmdate": 1699636141805,
        "mdate": 1699636141805,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "8gyf839AJp",
        "forum": "HipfLjyLUW",
        "replyto": "HipfLjyLUW",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission2095/Reviewer_SEfh"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission2095/Reviewer_SEfh"
        ],
        "content": {
            "summary": {
                "value": "In this paper, the authors propose CHGFlowNet, a novel application of GFlowNet for crystal generation. The proposed framework employs a hierarchical approach to sample the crystal structure at two levels: the high-level policy determines the space group symmetry of the entire crystal, while the low-level policy refines the lattice parameters and atomic positions based on the space group constraints. The reward functions of CHGFlowNet consider the formation energy, bond distances, structure density and composition validity. Experiments demonstrate the effectiveness of the hierarchical modeling and the incorporation of physics priors."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "2 fair"
            },
            "contribution": {
                "value": "2 fair"
            },
            "strengths": {
                "value": "1. The paper focuses on crystal generation, a significant problem in materials science, and is the first to apply GFlowNet to address this challenge.\n\n2. The authors utilize a bilevel generation framework to capture space group symmetry and combine four types of physics-inspired reward functions as priors. The experiments provide evidence for the effectiveness of these approaches."
            },
            "weaknesses": {
                "value": "1. The presentation of the proposed method lacks important details. For instance, the paper does not mention the initialization method. To improve understanding, it would be beneficial to provide a detailed algorithm outlining the generation process.\n\n2. The proposed method does not consider translation invariance. In Section 4.1, fractional coordinates are directly used as inputs for the GCN model, which violates the translation invariance of 3D crystals. This issue has been well-studied in previous predictive [1] and generative [2] methods, and its omission is a notable weakness.\n\n3. The paper does not include comparisons with some relevant baseline methods. Specifically, the authors do not compare their approach with CDVAE [2], a method focused on general crystal generation that could be applicable to the tasks presented in this paper. Additionally, the paper lacks a thorough discussion of recent generative methods in the field [3,4]. Addressing these omissions would strengthen the evaluation of the proposed method."
            },
            "questions": {
                "value": "1. As mentioned in Weakness 1, how to sample the initial state? \n\n2. The paper does not discuss Wyckoff positions [5], which are crucial for understanding how the proposed method handles space groups with large multiplicities. Consider a space group with n group elements (i.e. symmetry operations), not all atoms are copied n times. Some of the \"replicas\" are overlapped, leading to special Wyckoff positions. For instance, space group Fm-3m (No. 225) has a maximum multiplicity of 192. How does the proposed method manage a system with such a large multiplicity? Are atoms duplicated 192 times, or is there a deduplication strategy to determine the special Wyckoff positions?\n\n3. (Minor) In Section 4.3, the authors propose four reward functions, but only three are analyzed in the ablation studies. Could the authors provide insights into the impact of the composition validity term on the overall performance of the proposed method?\n\n[1] Yan, Keqiang, et al. \"Periodic graph transformers for crystal material property prediction.\" Advances in Neural Information Processing Systems. 2022.\n[2] Xie, Tian, et al. \"Crystal Diffusion Variational Autoencoder for Periodic Material Generation.\" International Conference on Learning Representations. 2021.\n[3] Jiao, Rui, et al. \"Crystal Structure Prediction by Joint Equivariant Diffusion.\" arXiv preprint.\n[4] Luo, Youzhi, et al. \"Towards Symmetry-Aware Generation of Periodic Materials.\" arXiv preprint.\n[5] https://en.wikipedia.org/wiki/Wyckoff_positions"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "5: marginally below the acceptance threshold"
            },
            "confidence": {
                "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        },
        "number": 2,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission2095/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698716035459,
        "cdate": 1698716035459,
        "tmdate": 1699636141735,
        "mdate": 1699636141735,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "gYxPG82Ywb",
        "forum": "HipfLjyLUW",
        "replyto": "HipfLjyLUW",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission2095/Reviewer_45US"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission2095/Reviewer_45US"
        ],
        "content": {
            "summary": {
                "value": "This paper tackles the problem of generating crystal structures with generative models. In particular, this paper uses the recently introduced generative flow networks (GFlowNets), which allow for the generation of diverse objects in a compositional space. This paper leverages some of the advantages of GFlowNets to design a state space that decomposes crystals into their space group, lattice parameters and atom positions, by preserving some of the geometrical properties imposed by the sequential selection of these crystal features. The authors propose to introduce further constraints via the reward function of the GFlowNet, which consists of a combination of multiple rewards that introduce a penalty if a condition is not met. The evaluation procedure studies the validity, diversity and formation energy of generated crystals, compared to the Physics Guided Crystal Generative Model (PGCGM) and a simpler GFlowNet without some of the aforementioned features."
            },
            "soundness": {
                "value": "1 poor"
            },
            "presentation": {
                "value": "1 poor"
            },
            "contribution": {
                "value": "2 fair"
            },
            "strengths": {
                "value": "There are some strong aspects of this paper I would like to highlight. \n\nFirst of all, the authors have identified some of the current challenges in the problem of crystal structure generation that can be potentially tackled by the relatively recent framework of GFlowNets. In particular, the abstract already mentions the difficulty of discovering new crystals due to the vast search space and the rarity of stable materials in this space, as well as the need for diversity in the exploration and discovery process. These are indeed the challenges that GFlowNets have been shown to address effectively. Furthermore, the authors have also leveraged the potential of GFlowNets to generate objects in a compositional space by designing a generation graph that sequentially reduces the search space.\n\nIn particular, in my opinion there are good ideas in the design of the generation process, such as the application of the symmetry operations from a previously selected space group to sample atom positions, as well as the constraints imposed by the space group on the lattice parameters. I also positively receive the fact that the authors have proposed an approach to incorporate information regarding the inter-atomic interactions (see my comments in the next section regarding the specific approach proposed).\n\nAnother strong point is the concise but insightful revision of the literature on crystal structure generation."
            },
            "weaknesses": {
                "value": "I also have some major concerns that generally dominate my assessment of the paper. In broad terms, my main concerns have all to do with the rigour of the presentation and claims, as well as the fact that the descriptions of important parts of the presented methods are too vague for me to be able understand the details, despite having first-hand experience with both GFlowNets and crystal structure generation. Below, I will elaborate on some specific examples.\n\nAn important aspect that is very vaguely described is the procedure to sample atom positions with GFlowNets. After carefully studying the manuscript, I only found a couple of places that tangentially refer to the procedure to obtain atom positions, which, crucially, is not trivial in the task of crystal structure generation. In Figure 1, a flowchart on the left contains a box with the text \"Atom positions\", but without any further information. The caption of the figure provides a little more information, but still not enough for me to form a sufficiently informed understanding of the method: \"The initial state has one atom O at position (0, 0, 0) [...]. The action of choosing space group P4(2)/mmc provides a symmetry operation to generate another atom O at position (0, 0, 0.5).\" This statement refers implicitly to one of the Wyckoff positions of space group P4(2)/mmc (international number 131), with multiplicity 2, but no further information is provided about, for example: why does the initial state has one atom at (0, 0, 0)? How are other atom positions sampled? What is the generation process to sample the total number of atoms in a crystal? \n\nSection 4.2 contains more information about the selection of atom coordinates: \"The atom fraction coordinates state $s_{ac}$ transition probability is parameterized by the Multivariate Gaussian distribution given by the mean $\\mu$ and covariance matrix $\\Sigma$\". While this seems to provide direct information about the process to select atom positions, no further details are provided, which leaves me with more questions than answers. First, the questions posed above remain, for example, how many atoms are selected? Assuming a fix number of atoms, are they sampled at once, one by one? Second, the fact that a Gaussian distribution is used to sample coordinates is surprising, since the Gaussian distribution is unbounded and can for instance sample negative (fractional) coordinates, which would be invalid. Alternatively, I suggest using a Beta distribution, as in Lahlou et al. (2023), which seems to better suit this use case.\n\nThese questions are relevant not only because atom coordinates in crystal are subject to very specific geometric and physical constraints in a crystal - some of which are addressed in the method - but also because they involve sampling in a continuous state space, which has proven to be notoriously non-trivial, as one has to make sure that the set of assumptions discussed by Lahlou et al. are properly preserved. In other words, a naive design of a hybrid (mix of discrete and continuous) state space is likely to be incorrect. Nonetheless, the only mention to this aspect in the present paper is the following: \"As the original GFlowNets only work on the discrete space, we adapt it to work on the continuous space of the atoms\u2019 coordinates and lattice parameters (Lahlou et al., 2023)\". In this regard, I would also like to mention that the phrasing may be misleading, as it seems to indicate that the adaptation to continuous spaces is introduced in this paper, despite providing the correct reference.\n\nI have elaborated on the question of the selection of atom coordinates, but it is not the only aspect that is vaguely described. Other aspects are the selection of lattice parameters, the criteria used in the evaluation (\"A structure $m$ and its optimized structure $m'$ are matched if their atoms translation and angle are _within certain thresholds_\" (emphasis mine), the criteria for diversity in the evaluation, the definition of a mode in Section 5.2, etc. \n\nAn essential aspect of all GFlowNets including the particular instance presented in this paper is the reward function. While Section 4.3 describes the decomposition of the reward function into _sub-rewards_ that encode various (soft) constraints, the main component of the reward function is the formation energy of the sampled crystal. The only piece of information provided in the paper is the following: \"$E(x)$ is the predicted formation energy per atom given by the prediction model\". However, no further mention or reference of the model is provided and the reader is left to guess what that model might be, including throughout the evaluation procedure, which crucially depends on the formation energy itself. After inspection of the supplementary material, one can find a short, non-referenced section (A.2.2) that mentions M3GNet as the predictive model. Incidentally, this section also contains vague descriptions: \"Therefore, we put the negative cut-off for the prediction. Any prediction lower than the cut-off is set to 10 eV/atom.\" What is the cut-off? How often does it occur?\n\nWithout getting into details, I would like to mention other parts of the manuscript that either lack details or are potentially incorrect:\n\n- The lattice parameters used to illustrate the sampling process in Figure 1 (a = 4, b = 6, c = 4) do not seem to match the drawing.\n- \"HGFlowNets generalize GFlowNets\": this seems like a strong claim that receives no further attention in the paper. I would have appreciated an elaboration on how the proposed method generalises GFlowNets.\n- \"The key insight to solving the large state space problem is breaking space exploration into more meaningful hierarchical sub-tasks. Here the higher-level tasks explore more meaningful actions that are closely related to the reward function while lower-level tasks handle the configuration adjustment corresponding to the action taken at higher-level tasks.\" It is unclear to me what the authors mean by \"more meaningful actions\", why the are closer to the reward function (what do they mean by \"close\"?). I understand that the authors are describing the inherent hierarchical decomposition of the generating graph of GFlowNets. If that is the case, I would note that although the authors seem to claim the novel introduction of this notion, this is an intrinsic feature of GFlowNets, which rely on the decomposition of the sampling process to enable generalisation.\n- \"In the hierarchy, lower states represent discrete concepts constrained by the higher states that represent more abstract concepts\" What do the authors mean by \"discrete concepts\"? It would be great if the authors could provide a more formal definition if possible, or more details of their intuition.\n- The paper contains a number of typos or errors in the description of the methods. For example:\n    - \"a triplet (L, A, X) of lattice parameters L, atom list L, and atom coordinates X\"\n    - \"$\\tau = s0, \\ldots, s_n, \\tau \\in \\tau$ where $\\tau$ is the trajectory set\" (note the repetition of lowercase $\\tau$ to indicate the trajectory set).\n    - \"for all the state s\"\n    - \"the flow of the trajectory is defined as...\" Here the authors are defining the forward probability of a trajectory, not the flow of a trajectory.\n    - To indicate atom position, the authors use both lowercase $o$ and uppercase $O$, inconsistently.\n    - In Section 4.2, the authors provide probability of transitions, but mention \"flow transitions\" in the text.\n    - In general, it is hard to easily make sense of the equations in Section 4.2. I wonder if they shed more light than confusion.\n\nWhile I mentioned that a strength of the paper is the incorporation of certain constraints in the method, I would like to note that the specific approach via additional terms in the reward function is suboptimal to the capabilities of GFlowNets. The compositional nature of GFlowNets allows for the incorporation of hard constraints in the sampling process, while penalties as reward terms are only soft constraints. Further, this approach introduces multiple hyper-parameters (all the coefficients of the rewards) that I also see as a weakness.\n\nRegarding the evaluation, I would like to first note that is also hard to draw insights because of the lacks of details about the training procedure and evaluation criteria (as mentioned above). From a direct analysis of the results provided in the tables, we can see that the method proposed by the authors generally obtains better metrics than a simpler GFlowNet (no details provided either) and that the recently published PGCGM. For example, the average formation energy of the PGCGM, GFlowNet and CHGFlowNet (method introduced in the paper) are 4.558, 1.433 and 0.882, respectively. From a naive interpretation, we would conclude that CHGFlowNet is better because the average formation energy is lower. However, first of all an average positive formation energy of the top samples is practically not useful, since the formation energy should be negative for the materials to be potentially stable, as discussed by the authors of PGCGM, for instance. Second, in the PGCGM paper, the authors report that 39.6 % of the generated structures have negative formation energy. While both results are in principle compatible, the PGCGM paper provides a plot of the distribution of the formation energy, showing a mode at around 0 eV/atom, that is far from the average 4.558 reported in this paper. This example, together with the lack of details cast doubt on the results provided in the paper.\n\nFinally, I would like to mention the existence of concurrent work with significant overlap with the present paper, which I suppose the authors might find relevant: https://arxiv.org/abs/2310.04925"
            },
            "questions": {
                "value": "I have organised most of my questions for the authors in my discussion of the weakness. Therefore, I kindly refer the authors to the previous section regarding my questions."
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "3: reject, not good enough"
            },
            "confidence": {
                "value": "5: You are absolutely certain about your assessment. You are very familiar with the related work and checked the math/other details carefully."
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        },
        "number": 3,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission2095/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698791846596,
        "cdate": 1698791846596,
        "tmdate": 1699636141661,
        "mdate": 1699636141661,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "VFk4BHWjll",
        "forum": "HipfLjyLUW",
        "replyto": "HipfLjyLUW",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission2095/Reviewer_ni6Z"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission2095/Reviewer_ni6Z"
        ],
        "content": {
            "summary": {
                "value": "The paper presents an extension of GFlowNets designed specifically for the generation of crystal structures. The proposed method Crystal Hierarchical Generative Flow Network  (CHGlownet) utilizes the hierarchical structure for crystals to more efficiently explore the space of possible crystals to find structures with desired properties. \n\nThe proposed approach incorporates a hierarchical policy for the crystal structure that is composed of determining the crystal space group on a higher level and the atomic lattice that consists of the crystal lattice, the atom coordinates, and atom types. The method also includes a physics-informed reward function.  \n\nThe approach is validated on the Battery material discovery task where it presents with improved performance over the PGCGM method and the 'flat GFLowNet."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "4 excellent"
            },
            "contribution": {
                "value": "4 excellent"
            },
            "strengths": {
                "value": "The proposed approach is well-motivated and presented clearly. A good background has been presented on the crystallography task. \n\nThe empirical analysis is aligned with the key goals of the material discovery task, assessing diversity and stability as well as an ablation study."
            },
            "weaknesses": {
                "value": "The experimental section seems quite weak. The method is tested on one task and one dataset. There is only one baseline model and the original GFlownet is used as a baseline. \n\nThere are many tasks such as the generation of MOF or Zeolites that are very well suited for the evaluation of this extension of GFlownets. There is a large number of methods that form the state of the art on these tasks that would be great candidates for baselines."
            },
            "questions": {
                "value": "Given that the relaxation results in such large changes in the lattice structure and the atom positions, how much of a role does the lower level (in the hierarchy) policy actually play a role in the generation process?\n\nCan the crystal be defined only by the atom positions without the lattice parameters? Even though these two data structures are definitely coupled, does the model generally treat them independently?"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "5: marginally below the acceptance threshold"
            },
            "confidence": {
                "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        },
        "number": 4,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission2095/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1699310799764,
        "cdate": 1699310799764,
        "tmdate": 1699636141589,
        "mdate": 1699636141589,
        "license": "CC BY 4.0",
        "version": 2
    }
]