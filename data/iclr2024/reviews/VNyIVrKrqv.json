[
    {
        "id": "BvHPMZrzhz",
        "forum": "VNyIVrKrqv",
        "replyto": "VNyIVrKrqv",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission5916/Reviewer_3BVe"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission5916/Reviewer_3BVe"
        ],
        "content": {
            "summary": {
                "value": "This paper explores the methodology of addressing constrained reinforcement learning by framing sequential decision-making problems as probabilistic inference problems. The focus is on utilizing the Wasserstein distance as a measure to discern the difference between the approximate posterior distribution of the trajectories and the posterior conditioned on the optimality operator. However, due to the computational intractability of the Wasserstein distance, the study employs the Generalized Sliced Wasserstein Distance (GSWD) as a proxy for the original distance. This is subsequently expanded by incorporating a neural network to determine the hyperparameters in GSWD, resulting in a metric named the Adaptive Generalized Sliced Wasserstein Distance (AGSWD).\n\nIn the development of the algorithm, the paper introduces a distributional representation to represent the cumulative rewards' distribution. The Distributional Bellman operator is then utilized to upate the critic function within the algorithm. The paper also provides theoretical results for the method, demonstrating that AGSWD is a metric and justifying the global convergence as well as the convergence rate.\n\nMoreover, the paper conducts empirical studies on the performance of the proposed algorithm within both a simulated robotic control environment and a realistic Unmanned Aerial Vehicle control environment. These results highlight a leading convergence rate and robust, safe control performance."
            },
            "soundness": {
                "value": "1 poor"
            },
            "presentation": {
                "value": "2 fair"
            },
            "contribution": {
                "value": "2 fair"
            },
            "strengths": {
                "value": "1. The overall structure of the paper is generally easy to follow.\n\n2. The paper adeptly integrates a multitude of concepts such as Wasserstein distance approximation, interpretability, distributional Reinforcement Learning (RL), variational inference, constrained RL, and probabilistic inference. These topics have been at the forefront of recent research trends.\n\n3. The empirical results emphasize the superior performance of the proposed Adaptive Wasserstein Variational Optimization (AWaVO) relative to other baseline models in both simulated and realistic environments. This underscores the practical effectiveness of the proposed methodology in real-world applications."
            },
            "weaknesses": {
                "value": "1. This paper covers a wide variety of concepts. However, there seems to be issues with key definitions and notations, which remain ambiguous or undefined, thus making several key ideas challenging to comprehend. For instance:\n\n- In Formula 2), the subscript 'i' is left undefined, and $b_i$ is also undefined.\n\n-  In Section 4.1, the definition of $q_\\theta$ appears flawed. There seems to be a duplicate probability over '$a$'. The second term should likely be $p(s|a,\\theta)$ instead.\n\n- In Section 4.1, the definition of $p(\\tau|O)$ seems incorrect. The term \"equivalence\" should likely be replaced with \"proportional to\" (please refer to formula (1)).\n\n- Formula 3) is incomprehensible without the definitions provided in the appendix. The hyperparameter $l$ and the function $\\mathcal(G)$ are undefined in the formula and its introductory explanation. It would be helpful to move this content from the appendix into the main body of the paper.\n\n- In Formula 3), it's unclear what the omitted term in $\\cdot$ is. According to the appendix, it's supposed to be a hyperparameter $l$. If that's the case, it's generally inappropriate to omit the hyperparameter in the formula.\n\n- The definition of $R_\\mu(l,\\tilde{\\theta})$ in the appendix is also confusing. Please verify whether the $x$ in the formula should be $\\mu$ and provide clarification.\n\n- In Section 4.2, for consistency with the expectation in the objective (4), there should be an expectation in the definition of the trajectory reward $\\tilde{r}(\\tau)$. Or is it intended to be the random variable of cumulative rewards, with the aim being to estimate the distribution? If so, perhaps it should not be termed a function.\n\n- The inference step of $p(\\theta|D)$ in Algorithm 2 needs clarification. Its reference cannot be found in Section 3. Please specify the exact location or formula. Please also distinguish between $\\theta$, $\\theta^\\mu$, and $\\theta^Q$. The rationale behind employing different updating methods for $\\theta$ and the others also needs to be elucidated.\n\nTypos:\n- The \"hupersurface\" before the formula (3) -> hypersurface.\n-  In Section 4.2, the defintion of $\\tilde{g}_i(\\tau)$ lacks a square bracket on the right.\n\n\n2. The theoretical results appear to lack key assumptions. Many conclusions are questionable and would benefit from further contemplation.\n\n- The proof of Proposition 1 claims that A-GSWD is a pseudometric rather than a metric. More significantly, it's questionable whether the proof can leverage the fact that \"Wasserstein distance is a metric,\" given that A-GSWD is defined between $\\mu$ and $\\nu$, not $\\mathcal{G}\\mu$ and $\\mathcal{G}\\nu$. If you swap $\\mu$ and $\\nu$, their corresponding hyperparameters in $\\mathcal{G}$ (as output by the neural network) will not be interchanged. Thus, symmetry might not generally hold.\n\n- In the proof of Proposition 3, the expectation following the max operator should be eliminated. If the action is selected based on an existing policy, the max operator becomes irrelevant.\n\n- In Equation (16), the first inequality does not generally hold. It often holds when $\\pi_{new}$ corresponds to the argmax Q in the Bellman optimality function. This point needs clarification.\n\n- The Wasserstein distance cannot be related to the discrepancy between quantiles in (18) unless $p$ (parameter) and $d$ (dimension) are both 1 in Wasserstein distance.\n\n- In Formula (19), Lemma 5.1 in Cai et al. (2019) relies on the linearity of the action-value function, which does not generally apply in value networks.\n\n3. The empirical results lack certain key definitions, and their credibility is questionable in several respects:\n\n- The constraint limit in the plots is undefined. Is this intended to represent the tolerance?\n\n- In Figure 3, the plots for cartpole, walker, and guard do not seem to demonstrate signs of convergence. The curves are still rising. An early stop might give the impression that the baseline methods are inferior, but they could potentially surpass the proposed method in the end. The incomplete nature of these experiments means that no definitive conclusions can be drawn.\n\n4. **Motivation.** The implementation of distributional Reinforcement Learning (RL) in this paper lacks a clear rationale. Despite its application, it remains unclear why it's necessary and what benefits it brings to the study.\n\n5. **Novelty.** While the introduction of AGSWD stands as a significant contribution, given that GSWD has already been investigated, simply integrating GSWD with neural network outputs doesn't constitute a major advancement in the field."
            },
            "questions": {
                "value": "- How should we interpret $g_{rl}$? Its role in Formula (3) isn't clear. Is it intended to be a hyperparameter that defines the plane on which $\\Tilde{\\theta}$ lies? Or is it a term returned by the RL algorithm?\n\n- In the proof of Proposition 3, what is the relationship between the operators and the new and old policies? Is the output of the operators meant to be the new policy? And, what does $\\pi^{\\prime}$ represent?\n\n- In Formula (18), what does the symbol $H$ denote?"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "3: reject, not good enough"
            },
            "confidence": {
                "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        },
        "number": 1,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission5916/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1697908260778,
        "cdate": 1697908260778,
        "tmdate": 1699636629185,
        "mdate": 1699636629185,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "DD3iVS7Dc1",
        "forum": "VNyIVrKrqv",
        "replyto": "VNyIVrKrqv",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission5916/Reviewer_e4UV"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission5916/Reviewer_e4UV"
        ],
        "content": {
            "summary": {
                "value": "Treating RL problems in terms of variational inference is a promising approach\nto building interpretable policies, but it suffers from high computational\nexpense. In particular, the cost of computing distance metrics between\nprobability distributions over high dimensional spaces is intractable. This\npaper proposes a new metric (A-GWSD) on probability distributions which can be\ncomputed efficiently and used to solve RL-as-inference problems. This metric is\nused to solve constrained RL problems. This algorithm is shown to theoretically\nsatisfy a global convergence property, and empirically achieves similar rewards\nand constraint violation rates to state-of-the-art safe RL algorithms. In\naddition, the proposed approach yields a clear interpretation of policy actions\nbased on conditional probability evaluation."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "2 fair"
            },
            "contribution": {
                "value": "3 good"
            },
            "strengths": {
                "value": "Interpretability is a key challenge in reinforcement learning, and this paper\noffers a promising approach to providing explanations for agent behavior.\n\nConstraints are also important in real-world reinforcement learning. This paper\nproposes a way to extend a popular RL framework (RL as inference) to the\nconstrained setting.\n\nThe experimental results show that improvements in interpretability can be\nachieved with minimal sacrifices in terms of rewards or constraint violations."
            },
            "weaknesses": {
                "value": "Given that the main improvement over prior work is in intpretability, I would\nhave liked to see more discussion of interpretability in the experimental\nresults. There is some information in Figure 4 (but see the questions below),\nbut I think the paper would benefit from some discussion of intepretability in\nthe other environments."
            },
            "questions": {
                "value": "I found it difficult to understand Figure 4, which is where the key advantage of\nthis approach over prior work is shown. Some explanation of why this diagram is\nevidence of improved interpretability would be helpful. I can see that roughly\nspeaking, when the wind estimation in 4(a) is higher, the probability in 4(b) is\nhigher as well, which demonstrates some sensitivity to the wind. But the two\ngraphs do not line up that closely and I'm not sure if I'm interpreting them\ncorrectly. What should I be looking for in this figure?"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "6: marginally above the acceptance threshold"
            },
            "confidence": {
                "value": "2: You are willing to defend your assessment, but it is quite likely that you did not understand the central parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
            },
            "code_of_conduct": {
                "value": "Yes"
            },
            "first_time_reviewer": {
                "value": "Yes",
                "readers": [
                    "ICLR.cc/2024/Conference/Program_Chairs",
                    "ICLR.cc/2024/Conference/Submission5916/Senior_Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission5916/Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission5916/Reviewer_e4UV"
                ]
            }
        },
        "number": 2,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission5916/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698788325717,
        "cdate": 1698788325717,
        "tmdate": 1699636629083,
        "mdate": 1699636629083,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "3PEO48nu9V",
        "forum": "VNyIVrKrqv",
        "replyto": "VNyIVrKrqv",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission5916/Reviewer_x9MY"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission5916/Reviewer_x9MY"
        ],
        "content": {
            "summary": {
                "value": "The authors propose a distributional approach to infer a policy in the constrained reinforcement learning setting. The central idea is to alternatively perform Wasserstein variational inference (WVI) and distributional policy optimization (PPO-DR). WVI learns a variational approximation $q(a)$ to the optimality likelihood $p(O|\\tau)$ (similar to the control as inference framework [1]) while PPO-DR maximizes the expected reward within the feasible region, and minimizes the expected constraint outside the feasible region (using distributional networks). The variational approximation $q(a)$ is represented by the critic distribution, while the Wasserstein distance is computed using the hypersurfaces given by the actor distribution. Overall, the idea of using adaptive GSWD for distributional constrained RL is interesting, and supported by theoretical and empirical results, but the work can be improved in terms of clarity."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "2 fair"
            },
            "contribution": {
                "value": "3 good"
            },
            "strengths": {
                "value": "1. Extensive discussion on convergence results\n2. The variational inference process is interesting, and it minimizes a Wasserstein distance (better for distributional RL) while ensuring that the actor distribution is used in computing the distance.\n3. Real world experiments"
            },
            "weaknesses": {
                "value": "On page 3, last line: \"where, upon satisfying the constraints, the agent enters a state considered as safe\". In my understanding, in the expected constraint formulation (Equation 2), if the constraints are satisfied, then the policy is considered \"safe\". \"Safe/unsafe\" states typically refer to a CMDP formulation with constraint sets, i.e. a part of the state-action space is safe, and the rest is unsafe. While it is useful to obtain a graphical model framework equivalent to the control as inference framework [1], a more appropriate justification of Figure 1 should have been that the optimality variables are influenced by the constraint, rather than saying that the agent enters a safe state. This means that $p(\\tau|O)$ becomes 0 as soon as the constraint is not satisfied in expectation. The authors do not model the probability in this way, but rather learn a policy by maximizing reward when within the feasible region, and minimizing constraint when outside the feasible region (to get within the feasible region). This makes sense intuitively, but equivalence to constrained RL (equation 2) is not formally established."
            },
            "questions": {
                "value": "1. In Equation 1, isn't it more appropriate to use $p(\\tau|\\theta)$ instead of $p(s,a|\\theta)$ for the second term of the right hand side? \n2. In equation 2, what is $b_i$? Maybe I missed it, but why are there two thresholds?\n3. (Suggestion) Page 4, after equation 3: \"$\\tilde \\theta$ are the returns from the actor networks\" could be re-worded. Returns have a specific meaning in RL literature, and in this context, I think return just means the output of the actor network, and not the usual return. (please ignore if my understanding is incorrect)\n4. Maybe I missed this, but how are the individual $p(L_i|D)$ obtained (in the flight task setup)?\n\n**References**\n\n1. Reinforcement learning and control as probabilistic inference: Tutorial and review, Levine (2018)"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "details_of_ethics_concerns": {
                "value": "_"
            },
            "rating": {
                "value": "6: marginally above the acceptance threshold"
            },
            "confidence": {
                "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
            },
            "code_of_conduct": {
                "value": "Yes"
            },
            "first_time_reviewer": {
                "value": "Yes",
                "readers": [
                    "ICLR.cc/2024/Conference/Program_Chairs",
                    "ICLR.cc/2024/Conference/Submission5916/Senior_Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission5916/Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission5916/Reviewer_x9MY"
                ]
            }
        },
        "number": 3,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission5916/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698909999161,
        "cdate": 1698909999161,
        "tmdate": 1699636628950,
        "mdate": 1699636628950,
        "license": "CC BY 4.0",
        "version": 2
    }
]