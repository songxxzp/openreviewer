[
    {
        "id": "f0byAromLb",
        "forum": "J9wzKfgZVK",
        "replyto": "J9wzKfgZVK",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission6732/Reviewer_b1Tv"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission6732/Reviewer_b1Tv"
        ],
        "content": {
            "summary": {
                "value": "The paper conducts a theoretical investigation into in-context learning (ICL) and addresses three key questions: the choice of ICL estimator, the performance metric for ICL along with its associated error rate, and the role of the transformer architecture in ICL."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "2 fair"
            },
            "contribution": {
                "value": "3 good"
            },
            "strengths": {
                "value": "1.\tThe paper provides a more general theoretical model on the response and hidden variables compared with previous works in this direction.\n2.\tThe authors propose a new regret metric to quantify the performance of ICL and develops a $\\mathcal{O}(1/T)$ regret rate for this metric. \n3.\tBesides, the authors analyze the error incurred during the pretraining phase, and the error decays exponentially in terms of the depth of the network."
            },
            "weaknesses": {
                "value": "1.\tAs this paper primarily focuses on theoretical aspects, it is encouraged to enhance the clarity of the presented proofs. Given that most of the proofs are intense, providing a big picture to roughly explain and outline how the proof works is crucial for readers' comprehension. Otherwise, readers can easily get confused. For instance, in the proof of Theorem 5.3, it would be beneficial to further explain why we should pick the distributions $P$ and $Q$ in this way when we bound the terms in error decomposition. Similarly, in the proof of Proposition 5.4, why should we first construct an approximator for $g^*$, and then $\\rho^*$, $\\phi^*$? These will be clearer if a big picture is provided.\n\n2.\tFollowing the above point, the authors should explain the reasons from one step to the next step more concretely. For instance, in the proof of Proposition 5.4, the assumptions 5.2 and F.3 do not appear. If there are some steps obtained with these assumptions implicitly, it is encouraged to point it out explicitly. There may be more areas throughout the paper where such improvements in clarity are needed, and the authors are encouraged to address them to enhance overall presentation.\n\n3.\tWith all these bounds obtained, it is recommended to validate them empirically, even if through synthetic experiments. Such empirical verification would not only enhance the credibility of the theoretical results but also provide an additional perspective on their soundness."
            },
            "questions": {
                "value": "1.\tAccording to the definition of the assumed model on $r_t$, is it not related to the true hidden concept? Is this a common assumption on realistic data? \n2.\tIs there any reason that the authors consider the regret in the form of average instead of the usual accumulative regret? Under this new regret, the rate is $\\mathcal{O}(1/T)$. Does that mean in terms of the usual accumulative regret, the rate is constant? How do the authors interpret this?\n3.\tIn the proof of Proposition 4.1, how do the authors obtain the first and the third equalities formally? For the current first equality, does it mean $h_{t+1}$ is independent of $c_{t+1}$? Even though the authors mention these equalities come from model (4.2) (by the way, should it be model (4.1) instead?), more concrete explanations are expected.  \n4.\tRegarding the proof of Corollary 4.2, In the first formula, why $P(S_t|z)$ only relates to responses $r_{i}$? In the third formula, should the most outer sum be $\\sum_{t=0}^{T}$, or $\\sum_{t=1}^{T}$? If the second equality is derived through telescoping, it is not immediately clear why only one term remains. Also, how is the last equality obtained? \n5.\tRegarding the proof of Theorem 5.3, in the last inequality of (F.2), do we have an expectation over $S_t^n$ for the first term? According to lemma I.5, there is an expectation over $X\\sim\\nu$ for the squared TV. Also, the authors note the bound of $P_{\\hat{\\theta}}(x|S) $ in (F.6), but how is this obtained? How is the TV bound located between (F.6) and (F.7) satisfied? Why $ 2\\epsilon/b_y$ is in $\\mathcal{O}(\\frac{1}{NT})$? \n6.\tIn the proof of Proposition 5.4, the authors obtain the bound for the difference in L1 norm to be in terms of $B_{A,1}^{D''}$, which is an exponential growth term, but how does this later become exponentially decay in terms of D? What does it mean for the sentence \u201cWe take that D\u2019=\u2026 in Lemma I.9\u201d? Do we let D\u2019 and D\u2019\u2019 be these quantities or C in D\u2019 and D\u2019\u2019 be these quantities? How is the TV bound in step 3 satisfied? Please clean up the proof to make it clearer."
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "details_of_ethics_concerns": {
                "value": "NA"
            },
            "rating": {
                "value": "5: marginally below the acceptance threshold"
            },
            "confidence": {
                "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        },
        "number": 1,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission6732/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698699685240,
        "cdate": 1698699685240,
        "tmdate": 1699636774215,
        "mdate": 1699636774215,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "NVdHMAecN2",
        "forum": "J9wzKfgZVK",
        "replyto": "J9wzKfgZVK",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission6732/Reviewer_MVTm"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission6732/Reviewer_MVTm"
        ],
        "content": {
            "summary": {
                "value": "The paper provides a theoretical analysis of in-context learning (ICL) in transformers used in large language models (LLMs), framing the attention mechanism as a Bayesian Model Averaging (BMA) process. It proposes that LLMs use attention weights to perform BMA, contributing to our understanding of model generalization from few-shot examples. The authors develop a series of propositions and theorems that articulate the role of the attention mechanism in facilitating ICL. Specifically, they demonstrate how the attention weights can be seen as performing a type of BMA. Furthermore, the paper extends the theoretical framework to provide regret bounds for ICL, which quantify how well the learning model performs in comparison to the best possible model chosen in hindsight. It also offers an in-depth error analysis that establishes bounds on the error rates of pretrained models. This work aims to deepen the theoretical foundations of ICL, offering a framework that connects with practical machine-learning challenges.\n\n-----\n\nPost rebuttal: Raising to 5 in light of authors' detailed evaluations. It would be good to see those results incorporated in the next version of the paper."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "2 fair"
            },
            "contribution": {
                "value": "2 fair"
            },
            "strengths": {
                "value": "By adopting a Bayesian perspective and formulating ICL as a prediction problem based on examples from a latent variable model, the paper unifies the understanding of transformer architecture's ability to enable ICL.\n\nPropositions and theorems are well-formulated, providing substantial theoretical contributions to the field, such as establishing regret bounds for ICL and demonstrating the parameterization of Bayesian Model Averaging through attention mechanisms.\n\nIt includes a fine-grained analysis of pretraining under realistic assumptions, offering a bound on the error of pretrained models."
            },
            "weaknesses": {
                "value": "The paper lacks empirical validation for its theoretical claims. This is a significant gap, as the practical impact of the theoretical insights on real-world tasks remains unclear without empirical evidence.\n\nSome of the assumptions made for the theoretical analysis are not justified with respect to their applicability in practical scenarios. The paper does not sufficiently discuss how these assumptions can be relaxed without losing the theoretical results.\n\nThe complexity of the mathematical content could limit the paper's accessibility to a broader audience. Additionally, there is a lack of clear guidance on the reproducibility of the theoretical results, which is critical for the advancement of the field.\n\nWhile the paper attempts to address important questions, its insights as compared to the existing works seem very limited at this point."
            },
            "questions": {
                "value": "- How can the theoretical findings be empirically validated in the absence of practical experiments within the paper?\n\n- Is there a possibility to simplify the presentation to make the paper more accessible to non-experts?\n\n- Could the authors clarify the process of deriving the posterior distributions within the context of ICL and how they relate to the attention weights?\n\n- Can the authors provide more details on the assumptions made for the error analysis and how these assumptions can be justified from a practical standpoint?\n\n- Are there specific mathematical models or theories that could challenge or complement the authors' approach to understanding in-context learning?"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "5: marginally below the acceptance threshold"
            },
            "confidence": {
                "value": "2: You are willing to defend your assessment, but it is quite likely that you did not understand the central parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
            },
            "code_of_conduct": {
                "value": "Yes"
            },
            "first_time_reviewer": {
                "readers": [
                    "ICLR.cc/2024/Conference/Program_Chairs",
                    "ICLR.cc/2024/Conference/Submission6732/Senior_Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission6732/Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission6732/Reviewer_MVTm"
                ]
            }
        },
        "number": 2,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission6732/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698813891829,
        "cdate": 1698813891829,
        "tmdate": 1700587825974,
        "mdate": 1700587825974,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "mvPPAlGvgX",
        "forum": "J9wzKfgZVK",
        "replyto": "J9wzKfgZVK",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission6732/Reviewer_xbQq"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission6732/Reviewer_xbQq"
        ],
        "content": {
            "summary": {
                "value": "The paper provides a study of in-context learning (ICL) through a Bayesian view and addresses related questions. They first show that large language models perform ICL by adopting a Bayesian model averaging (BMA) algorithm during inference by showing that a prediction for a prompt from a perfectly pretrained model equals the prediction of BMA. Then, to measure the ICL performance, the authors consider ICL regret as a performance metric that measures the difference from prediction to the best hidden concept. The regret is shown to converge with increasingly more examples. To show the connection between the transformer network and the BMA algorithm, the authors define a variant of the attention layers, which then show that the modified attention mechanism encodes the BMA algorithm for the Gaussian linear model. For the sequence length going to infinity, the provided attention variant coincides with the softmax attention.\nAdditionally, the authors provide the pretraining analysis that can measure the pretraining error with approximation and generalization errors. Under certain smoothness conditions, approximation error converges with bigger models. Finally, for an imperfect pretrained model, the authors can successfully upper-bound the ICL regret."
            },
            "soundness": {
                "value": "4 excellent"
            },
            "presentation": {
                "value": "3 good"
            },
            "contribution": {
                "value": "4 excellent"
            },
            "strengths": {
                "value": "+ The progression and steps make sense.\n\n+ The theoretical results seem to be new and are a nice addition to ICL setting.\n\n+ The theoretical contribution seems to be a generalization for some ICL settings assumed in previous works."
            },
            "weaknesses": {
                "value": "- How big is the ICL regret in practice? It is hard to tell how tight the bound is in practice. How can it be measured for LLMs?\nSince there is no application of the results, it is hard to tell how far the bound is really in practice. \n\n- How can we in practice measure the validation performance of ICL?"
            },
            "questions": {
                "value": "- What is sequentially mean? Are we not really doing sequential but all at once prompting, which is different from iterative prompting?\n\n- What is the \"wrong\" input-ouput mapping? There is no real wrong or right here. How can you get $z_*$?\n\n- Is KL divergence the best to measure distribution gap, which are key in measuring the generalization gap? What is the embedding space it has to use? Is there a better divergence metrics to measure that?\n\n- Even though the progression and paper is smooth, it would be nice to add visualization to main paper rather than in Appendix.\n\n- The analysis only involves pretraining in relation to the ICL performance. However, large language models also have fine-tuning distribution involved as an \"intermediate\" between the two aforementioned stages. Should that introduce some +/- gaps in divergence?\n\n- Where do we get the hidden concept in the LLM?\n\n**Minor:**\n\n+ Why LLMs the ability for ICL (page1)\n\n+ Hiddn Markov Model (page 3)\n\n+ Variables are undefined (or defined later than introduced):\n  + N and d, d_k,  d_v \n  + What is W?\n  + Large T and small t difference?\n+ Pertaining distribution (page 7)\n+ xIn section (page 9)\n+ correctly inference (page 9)"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "6: marginally above the acceptance threshold"
            },
            "confidence": {
                "value": "2: You are willing to defend your assessment, but it is quite likely that you did not understand the central parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
            },
            "code_of_conduct": {
                "value": "Yes"
            },
            "first_time_reviewer": {
                "value": "Yes",
                "readers": [
                    "ICLR.cc/2024/Conference/Program_Chairs",
                    "ICLR.cc/2024/Conference/Submission6732/Senior_Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission6732/Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission6732/Reviewer_xbQq"
                ]
            }
        },
        "number": 3,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission6732/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698829175418,
        "cdate": 1698829175418,
        "tmdate": 1699636773926,
        "mdate": 1699636773926,
        "license": "CC BY 4.0",
        "version": 2
    }
]