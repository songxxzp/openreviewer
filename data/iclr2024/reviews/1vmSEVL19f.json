[
    {
        "id": "nlfccki5Vh",
        "forum": "1vmSEVL19f",
        "replyto": "1vmSEVL19f",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission8236/Reviewer_tWnQ"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission8236/Reviewer_tWnQ"
        ],
        "content": {
            "summary": {
                "value": "The paper propose Direct Reward Fine-Tuning (DRaFT) for finetuning diffusion models to maximize a differentiable reward functions. Several techniques are applied to circumvent large memory consumption and gradient exploding problem when they perform BPTT for diffusion models: gradient checkpointing, LoRA, ignoring early gradients. A variance-reduced alternative for DRaFT-1 is proposed. The authors provide solid evaluation on a vast set of differentiable rewards, with impressive qualitative results."
            },
            "soundness": {
                "value": "4 excellent"
            },
            "presentation": {
                "value": "4 excellent"
            },
            "contribution": {
                "value": "2 fair"
            },
            "strengths": {
                "value": "Optimizing a diffusion model with direct backprop through a differentiable reward has several technical difficulties and the authors managed to solve them.\n\n(1) increased memory consumption. The authors solve the problem by combining two existing methods gradient checkpointing and LoRA. \n\n(2) gradient exploding/vanishing problem for BPTT. The authors solve the problem by DRaFT-K, i.e., ignore gradients from earlier steps. \n\nThe base model is Stable-Diffusion v1.4. The authors include a vast range of differentiable rewards: (1) aesthetic classifier, (2) trained reward models from HPSv2, PickScore \n(3) JPEG compressibility (4) Object Detector (5) ImageNet classifier. The experiments are solid and the qualitative results look impressive. \n\nSeveral interesting observation: \n\n\n1. compared to ReLF: it seems that DRaFT-1 (the same as ReFL with $m=1$) works better than ReLF with a random $m$. \n\n2. Manipulating LoRA weights have predictable influence on the outputs."
            },
            "weaknesses": {
                "value": "The main concern is the significance of the contribution: \n\n1. DRaFT-1 works the best but the improvement over ReFL is a bit marginal (Figs 3 and 4).  Furthermore, DRaFT-1 is the same as ReFL with $m$ fixed to 1. Increasing $K$ does not improve the performance. \n\n2. As DRaFT-1 (and LV version) already works well, in this case, we might not need gradient checkpointing and LoRA, right? How does finetuning the full parameter influence the result?"
            },
            "questions": {
                "value": "This is a bit minor, but why do you choose Stable-Diffusion v1.4 instead of SD v1.5 or a higher version?"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "5: marginally below the acceptance threshold"
            },
            "confidence": {
                "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        },
        "number": 1,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission8236/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698808660147,
        "cdate": 1698808660147,
        "tmdate": 1699637023691,
        "mdate": 1699637023691,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "1l05mgYMoM",
        "forum": "1vmSEVL19f",
        "replyto": "1vmSEVL19f",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission8236/Reviewer_m5FM"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission8236/Reviewer_m5FM"
        ],
        "content": {
            "summary": {
                "value": "The paper introduces \"Direct Reward Fine-Tuning (DRaFT)\", as an efficient framework for fine-tuning diffusion models on differentiable rewards. As opposed to previous work, they develop tools to differentiate through the entire diffusion process and use the resulting gradients for fine-tuning. However, they find that the truncated versions of their method which only differentiate through the last time step (similar to previous work such as ReFL(Xu. et al 2023)) works the best. They introduce a variant of this method which computes a lower variance last step gradient by averaging across multiple noise samples. They show that this variant outperforms all baselines and show various interesting use cases of their method."
            },
            "soundness": {
                "value": "4 excellent"
            },
            "presentation": {
                "value": "4 excellent"
            },
            "contribution": {
                "value": "3 good"
            },
            "strengths": {
                "value": "1. I think the biggest strength of this paper lies in the exhaustive ablations and use cases the authors show. \n   - I particularly liked the experimentation with interpolating and scaling different LORA parameters and the corresponding effects.\n   - I also appreciated the comparisons of the different reward functions and the qualitative differences between the model fine-tuned with them. \n   - I also found some of the applications of this method very interesting, such as the object removal/inclusion example in section 5.3\n   - Lastly, I also liked the reward hacking examples presented in the paper.\n2) The paper is also very well written and was a pleasure to read.\n3) The related work description was thorough and I enjoyed (and learnt from) reading the descriptions and comparisons."
            },
            "weaknesses": {
                "value": "The main methodological contributions of the paper seem to be the usage of LoRA and gradient checkpointing techniques to allow differentiating through the full diffusion chain. However, the paper shows that differentiating through the diffusion chain leads to exploding gradients without providing sufficient analysis of it beyond Fig 8 or any attempts to mitigate the issues. Instead most of the benefits in the results are attributed to DRaFT-LV which is (methodologically) a very minor improvement over ReFL. Although the usage of LoRA for fine-tuning even in this single step setting provides interesting possibilities (which the authors exploit rather well in the experiments), I feel the paper would have benefited from additional analysis and fixes for the full DRaFT setting as well."
            },
            "questions": {
                "value": "I have a broader philosophical question about the approach. I find the broader approach taken by the paper (and previous work) a little perplexing. For example, the paper at various points shows the perils of over-optimizing a specific objective due to effects like reward hacking. An obvious solution I would assume to a problem like this would be, using a dataset of (prompt, image) pairs with the image as x_0 in an algorithm like DRaFT-LV instead of sampling it using the diffusion process? or perhaps augmenting this as an auxiliary objective along with the regular DRaFT-LV objective? This seems 1) faster and 2) less susceptible to issues like reward hacking etc, as the model stays grounded to remain close to the real image distribution. I would be curious if the authors have experimented with similar methods?\n- Other Minor comments:\n    1) As a general comment, it would be helpful if all the generated images shown in the paper also mention the prompt used. There are \ncertain figures where I couldn\u2019t spot the prompt used to generate the image. Eg. Fig 7.\n    2) Further, in Fig 7, left, it would help if the paper used the same prompt for all 3 examples to contrast how the interpolations vary across the models."
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "8: accept, good paper"
            },
            "confidence": {
                "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
            },
            "code_of_conduct": {
                "value": "Yes"
            },
            "first_time_reviewer": {
                "readers": [
                    "ICLR.cc/2024/Conference/Program_Chairs",
                    "ICLR.cc/2024/Conference/Submission8236/Senior_Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission8236/Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission8236/Reviewer_m5FM"
                ]
            }
        },
        "number": 2,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission8236/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698813742274,
        "cdate": 1698813742274,
        "tmdate": 1700696029068,
        "mdate": 1700696029068,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "kravdR17RK",
        "forum": "1vmSEVL19f",
        "replyto": "1vmSEVL19f",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission8236/Reviewer_pZzS"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission8236/Reviewer_pZzS"
        ],
        "content": {
            "summary": {
                "value": "This paper is another addition to a line of work which fine-tunes diffusion models on reward functions to generate samples with desirable properties. The closest work is ReFL, which backpropagates gradients through a differentiable reward function for a single-step denoising operation. The proposed method, DRaFT, calculates gradients for the entire diffusion sampling chain, which is facilitated by using two existing techniques: low-rank adaption (LoRA) and gradient checkpointing. Different variations of DRaFT are proposed to improve efficiency, reduce memory footprint and reduce variance of the gradient estimates. Experiments use Stable Diffusion 1.4 as the backbone and consider several reward functions such as the LAION aesthetic score, Human Preference Score v2 and PickScore."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "3 good"
            },
            "contribution": {
                "value": "3 good"
            },
            "strengths": {
                "value": "This is primarily an empirical contribution. While the novelty on the algorithmic side is somewhat limited, this paper applies the idea to large pre-trained models and demonstrates effective performance on generation of realistic images. In terms of significance, this work is an improvement over existing stable diffusion models, with the benefit that using different reward functions enables fine-tuning for different types of characteristics in the generated samples. \n\nThe experiments are comprehensive and compare DRaFT against relevant baselines. The results showcasing interpolation between pre-trained and fine-tuned weights, as well as between LoRA weights for different reward functions are interesting and insightful. The various ablation studies and considering specific problems such as compression, object detection and adversarial examples demonstrate the wide applicability of this method."
            },
            "weaknesses": {
                "value": "The relatively minor weakness is related to the organization of the paper to improve clarity. Figure 2 can be moved in Section 4 to match the text with the corresponding model diagram. Section 5.2 discusses the results of many different experiments and while they are organized by paragraphs, splitting them into sub-sections with informative titles, or perhaps a description of the contents of Section 5 (similar to the one for the Appendix) can help navigate this section more easily."
            },
            "questions": {
                "value": "None"
            },
            "flag_for_ethics_review": {
                "value": [
                    "Yes, Discrimination / bias / fairness concerns",
                    "Yes, Privacy, security and safety"
                ]
            },
            "details_of_ethics_concerns": {
                "value": "Since the backbone of this work is Stable Diffusion, the ethical concerns associated with such models also apply to this work.\nParticularly, the training data for such models can use copyrighted images, and may violate the privacy of users in case the images contain humans. Generative models may also suffer from bias in their sampling procedures (usually a result of bias in the training data) and adequate measures must be taken to ensure fairness and safety when using such models."
            },
            "rating": {
                "value": "8: accept, good paper"
            },
            "confidence": {
                "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        },
        "number": 3,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission8236/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698931069868,
        "cdate": 1698931069868,
        "tmdate": 1699637023450,
        "mdate": 1699637023450,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "wY87E98Acu",
        "forum": "1vmSEVL19f",
        "replyto": "1vmSEVL19f",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission8236/Reviewer_LgKe"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission8236/Reviewer_LgKe"
        ],
        "content": {
            "summary": {
                "value": "The paper presents DRaFT for optimizing diffusion models using differentiable reward functions. While the direct fine-tuning idea has been around, the memory issue has been a bottleneck to scale this idea to a large-scale diffusion model. DRaFT uses LoRA/grad checkpointing to solve this problem. The authors propose show that DRaFT can successfully finetune image generative models, better than a reinforcement learning-based approach."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "3 good"
            },
            "contribution": {
                "value": "2 fair"
            },
            "strengths": {
                "value": "The paper presents an original approach to fine-tuning diffusion models using differentiable reward functions. The proposed method, DRaFT, and its variants, DRaFT-K and DRaFT-LV, demonstrate strong performance across a variety of reward functions, outperforming one reinforcement learning-based method. The paper is generally well-written and clear, and the experimental results are promising. The significance of the work lies in its potential to enhance the aesthetic quality of images generated by diffusion models, a valuable contribution to the field of generative models."
            },
            "weaknesses": {
                "value": "The paper lacks a thorough discussion of related work. \n1) \u201cBlack et al. (2023) and Fan et al. (2023) interpret the denoising process as a multi-step decision-making task, and use policy gradient algorithms to fine-tune diffusion models for arbitrary black-box objectives.\u201d => This interpretation is originally from [1]. \n2) the idea of directly fine-tuning diffusion models on differentiable rewards is also studied in [1], but the authors do not seem to be aware of it. (See Sec 3.3)\n\nAlso, I wonder if other PEFT methods such as Adapters, Normalization training, and IA3 could be used instead of LoRA.\n\n(very minor) The use of the \"stop_grad\" function in the pseudocode is not properly explained, which could lead to confusion for readers unfamiliar with this function.\n\n[1] Reinforcement learning for faster DDPM sampling"
            },
            "questions": {
                "value": "- Could you elaborate on the relationship between your work and that of [1], especially regarding the idea of directly fine-tuning diffusion models on differentiable rewards?\n- Can DRaFT work with other PEFT methods such as Adapters, Normalization training, and IA3?\n- The paper does not report the performance of DPOK. Could you clarify how your approach compares to this method?"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "3: reject, not good enough"
            },
            "confidence": {
                "value": "5: You are absolutely certain about your assessment. You are very familiar with the related work and checked the math/other details carefully."
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        },
        "number": 4,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission8236/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1699052356716,
        "cdate": 1699052356716,
        "tmdate": 1699637023347,
        "mdate": 1699637023347,
        "license": "CC BY 4.0",
        "version": 2
    }
]