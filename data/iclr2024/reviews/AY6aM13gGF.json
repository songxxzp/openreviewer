[
    {
        "id": "mqldrZPwTM",
        "forum": "AY6aM13gGF",
        "replyto": "AY6aM13gGF",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission5414/Reviewer_ei7j"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission5414/Reviewer_ei7j"
        ],
        "content": {
            "summary": {
                "value": "This paper introduces a novel framework, termed LaMo, aimed at enhancing the utilization of pre-trained Large Language Models (LLMs) in the context of offline Reinforcement Learning (RL). The novelty of the proposed framework is threefold: Firstly, it employs Low-rank Adaptation (LoRA) during the fine-tuning process, targeting a specific subset of model weights and finetuning with offline experience data. Secondly, it innovatively replaces the conventional linear projections for Query (Q), Key (K), and Value (V) within each attention block with Multi-Layer Perceptrons (MLPs). Thirdly, LaMo incorporates a next-word prediction loss in addition to the primary sequence modeling loss to mitigate overfitting concerns."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "3 good"
            },
            "contribution": {
                "value": "2 fair"
            },
            "strengths": {
                "value": "Originality: The framework introduced in this paper demonstrates novelty through a unique amalgamation of established fine-tuning techniques. It draws inspiration from the wiki-RL paradigm but stands out by effectively addressing limitations that hindered previous work.\nQuality: This paper exhibits a commendable level of quality. The authors meticulously design their experiments to empirically validate the individual components of the framework.\nClarity: The manuscript exhibits a high degree of clarity in its presentation. The conceptual underpinnings and experimental setups are readily comprehensible.\nSignificance: The findings presented in this paper hold great promise. Notably, the results span a diverse array of scenarios, including sparse and dense reward tasks, varying data scales, and a comprehensive ablation study."
            },
            "weaknesses": {
                "value": "In section 5.5 Ablations, while empirical results indicate the superiority of the former, the absence of a deeper analysis of the choice to use MLPs warrants consideration. It is advisable to provide further insight into the theoretical basis and motivations for this decision."
            },
            "questions": {
                "value": "Several questions and suggestions:\n1. In section 4.2 you mentioned that you used LORA to inject low-rank matrices into attention weights Q, K and V only and freeze all other weights inside the Transformer, given that there are other large MLPs inside it, what is the rationale of only applying LoRA to Q, K and V?\n2. In section 5.5, the benchmark tasks you used for comparison change sometimes, I\u2019m curious how you select ablation benchmarks for showing different components in your framework works better?\n3. It would be nice to see how different scales of GPT-2 could affect the performance on your benchmarks."
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "6: marginally above the acceptance threshold"
            },
            "confidence": {
                "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        },
        "number": 1,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission5414/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698712922824,
        "cdate": 1698712922824,
        "tmdate": 1699636549308,
        "mdate": 1699636549308,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "a1TZllJVvW",
        "forum": "AY6aM13gGF",
        "replyto": "AY6aM13gGF",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission5414/Reviewer_1Dwk"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission5414/Reviewer_1Dwk"
        ],
        "content": {
            "summary": {
                "value": "The paper proposes a method to utilize the power of pretrained LLMs for offline RL with 3 important design choices: 1) use non-linear MLPs for token embedding and prediction layers; 2) Finetune the pretrained model with LoRA; and 3) regularize the fine-tuned model with a language loss. The experiments show that the proposed method boosts the performance of DT in both sparse and dense reward settings, especially in the low-data regime. The paper conducted several ablation studies to show the importance of each of the proposed design choices."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "3 good"
            },
            "contribution": {
                "value": "2 fair"
            },
            "strengths": {
                "value": "- Presentation: the paper was easy to follow because of its simplicity and clear writing. \n- The idea is intuitive and simple, and can potentially be adapted to other LLMs as well as other offline RL models and tasks.\n- The empirical results are good and the ablation studies are comprehensive, proving the importance of each proposed component."
            },
            "weaknesses": {
                "value": "- Since the paper only studied one LLM (GPT-2) and one RL model (DT), I wonder if the same methodology generalizes to other LLMs and RL models. Since LLMs are improving quickly, it's important that the conclusion in the paper also holds for newer and stronger LLMs.\n- The baselines used for comparison seem a bit outdated. There have been much stronger baselines in offline RL in recent years, especially diffusion-based methods such as Diffusion-QL [1] and DD [2]. The authors should include these as stronger baselines.\n- The experiments only include the medium datasets in D4RL and are missing the medium-replay and medium-expert datasets. I expect LaMO to perform well on medium-replay as these datasets are of low-quality and should highlight the advantage of language pretraining.\n\nMinor comments:\n- The first paragraph of Section 4.1 is a bit confusing, it made me think that the authors pretrained GPT-2 themselves. It should be stated clearly that the authors used the pretrained GPT-2 from HF and only pretrained its special variants.\n\n[1] Wang, Zhendong, Jonathan J. Hunt, and Mingyuan Zhou. \"Diffusion policies as an expressive policy class for offline reinforcement learning.\" arXiv preprint arXiv:2208.06193 (2022).\n\n[2] Ajay, Anurag, et al. \"Is conditional generative modeling all you need for decision-making?.\" arXiv preprint arXiv:2211.15657 (2022)."
            },
            "questions": {
                "value": "- Can we replace the language loss with a regularization loss so that the fine-tuned model is not too far away from the original pretrained model? For example, we can minimize the discrepancy between the embeddings of the fine-tuned and pretrained models."
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "6: marginally above the acceptance threshold"
            },
            "confidence": {
                "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        },
        "number": 2,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission5414/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698780282500,
        "cdate": 1698780282500,
        "tmdate": 1699636549208,
        "mdate": 1699636549208,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "0pw73JoDYO",
        "forum": "AY6aM13gGF",
        "replyto": "AY6aM13gGF",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission5414/Reviewer_mYMk"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission5414/Reviewer_mYMk"
        ],
        "content": {
            "summary": {
                "value": "This paper studies the use of decision transformer (DT) and pretrained language models for offline RL control. The authors propose a new framework Language Models for Motion Control (LaMo) that improves upon a naive use of a pretrained LM for DT training. The framework 1) uses a pretrained LM model, 2) uses LoRA fine-tuning, 3) use higher capacity input embedding and output networks and 4) use auxiliary language prediction loss during finetune. Empirical results are provided to show the proposed method outperform other transformer-based methods and also offline RL methods in a number of benchmark tasks."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "4 excellent"
            },
            "contribution": {
                "value": "2 fair"
            },
            "strengths": {
                "value": "**originality**\n- Main novelty of the paper is an improved framework to finetune pretrained LM on RL task. Compared to the Reid et al paper, the main additions are the finetuning technique and the increased capacity of the projection layer for input embeddings and output layer. Though the changes are relatively simple, they are shown to provide much stronger performance, can be a novel contribution. \n\n**quality**\n- technical details provided for reproducing the results. \n- good discussion of related works\n\n**clarity**\n- paper is written clearly and easy to follow \n\n**significance**\n- some insights are provided on potential reason that DT methods work better on sparse reward setting. \n- ablations showing the contribution of each component. \n- the proposed changes are not too complex, I appreciate the simplicity.  \n- empirical resutls show significant improvement over DT and DT+Wiki over all 3 benchmarks."
            },
            "weaknesses": {
                "value": "Comparisons: \n- Figure 1, in Reid et al paper, they show that a pretrained DT tend to give improved performance, why in your figure DT gets better performance in Kitchen and Atari? \n- Did you finetune the methods you are comparing to on the benchmarks you are studying? \n- The other thing is only some of the tasks in each benchmark are studied, so it is also a bit concerning whether there will still be a big perforrmance gap between proposed method and baseline when other tasks are also tested. \n\nNovelty and significance:\n- Technical novelty of the method is a bit lacking. Essentially compared to DT+Wiki, a different finetuning method is used, and the projection and output layers are made bigger. Neither of these are new techniques."
            },
            "questions": {
                "value": "It is unclear why language pretraining can help RL tasks which have a large domain gap?"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "5: marginally below the acceptance threshold"
            },
            "confidence": {
                "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        },
        "number": 3,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission5414/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698816626103,
        "cdate": 1698816626103,
        "tmdate": 1699636549105,
        "mdate": 1699636549105,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "lFwN3eCFOk",
        "forum": "AY6aM13gGF",
        "replyto": "AY6aM13gGF",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission5414/Reviewer_GHKm"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission5414/Reviewer_GHKm"
        ],
        "content": {
            "summary": {
                "value": "The authors observe shortcomings in previous applications of pre-trained (transformer) language models (LM) in reinforcement learning (RL) and in particular in control: they are only used as initializations or as interfaces and do not outperform non-pre-trained transformer models such as decision transformers (DT).\n\nThey propose LoMa which adds 3 components to better leverage (or \"unleash\") pre-trained LMs in RL: 1) replacing the linear embedding with trainable MLPs, 2) performing low-rank adaptation (LoRA) for the RL training, and 3) maintaining the original language model loss while training with RL.\n\nThe authors claim that LoMa outperforms competitive offline RL baselines and DT on sparse-reward tasks and in low-data regimes."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "4 excellent"
            },
            "contribution": {
                "value": "3 good"
            },
            "strengths": {
                "value": "The paper attempts to overcome important shortcomings of leveraging foundation models (here LMs) in RL in particular offline RL.\n\nOriginality:\n- Adding the sparse-reward experiments compared to the dense-reward environments in the Wiki-RL reference paper [1] to show the benefits of using pre-trained models is original and well-motivated.\n- Using LoRA to fine-tune the LM to a policy is interesting, ~~although not well-motivated.~~\n- The ablation with a model pre-trained on a random corpus to show the importance of sequential modeling is original.\n\n\nClarity:\n- The motivation and the contributions of the paper are very clear. \n- The structure of the paper is easy to follow.\n- Overall the paper is well written.\n\nSignificance:\n- LaMo performs competitively in the low-data regime as opposed to Wiki-RL showing that it potentially leverages/\u201dunleashes\u201d pre-trained LMs in a better way.\n- Overfitting, and other capacity loss phenomena, arising when more gradient steps are performed on the same data are major problems in offline RL. Observing that the auxiliary language loss (and maybe LoRA) introduced in LaMo helps in overcoming this issue is relevant beyond the scope of this paper.\n\n[1] Reid, Machel, Yutaro Yamada, and Shixiang Shane Gu. \"Can Wikipedia help offline reinforcement learning?.\" arXiv preprint arXiv:2201.12122 (2022)."
            },
            "weaknesses": {
                "value": "*(update: all the weaknesses below have been addressed by the authors.)*\n\nThe points about the experimental results raised below and the questions raised in the question sections make it hard for me to confirm the validity of the claim made in the paper that LoMa outperforms baselines and that its components are crucial.\nClarifications on the experimental setup and results if valid would help raise my soundness and overall score.\n\n**Major:**\n\n1) \nI have a major concern over the validity of the experimental protocol and results presented in the paper from the observation that the performance reported for the baselines differs significantly from their performance as reported in their original papers. In particular\n- BC and CQL in the D4RL paper [2] obtain scores significantly divergent from the scores reported in this paper. Can the authors explain this divergence, and if due to different training budgets/settings explain the motivation behind the different settings?\nE.g. CQL and BC achieve 43.8 and 33.8, respectively, on Franka-complete in D4RL [2], but are reported to achieve 0 scores in this paper. (Overfitting of CQL is mentioned, but does not clarify the discrepancy)\n- Also BC and CQL are reported to perform better on Kitchen with 1% of the datasets (or other fractions) than on Kitchen with full datasets. Same for Wiki-RL and DT on some specific splits.\n- Similarly, Wiki-RL is reported to perform worse than the same model (ChibiT) in its original paper on Atari. Whereas DT is reported to perform better than in the wiki-RL paper. E.g. in Breakout 350 DT  and 130 Wiki-RL in this paper vs 267 DT and 280 Wiki-RL in the Wiki-RL paper.\n\n2) \n The ablation studies are presented each time on a different task&dataset-ratio combination and the full ablation results are not in the appendix (only the pre-training ablation is given). This can lead to a biased evaluation of LaMo if only good results are presented.\nThe combination of components of LaMo is a major contribution of the paper, claimed to \"unleash\" the potential of pre-trained LMs, and ablation experiments are thus crucial to assess the validity of this claim and the significance of the paper.\n\n\n**Significant:**\n- I don't find LoRA to be well-motivated, or at least that its benefits are. The authors mention early overfitting but this is not clear from Figure 5 (LoMa also experiences small drops in performance).\n-  Several elements of the paper can be mistakenly interpreted as original contributions of the paper, such as the language modeling loss (also used in Wiki-RL), the ablation on ImageGPT (also used in Wiki-RL), the selection of the baseline (similar to Wiki-RL).\nWhile not being novel was not the issue, it was often not clear if those contributions were original.\n- It\u2019s hard to assess the significance of an improvement when curves are shown with shaded areas in [\u03bc \u2212 0.5\u03c3, \u03bc + 0.5\u03c3].\n\n**Minor:**\n- Notation is not ambiguous for readers familiar with the topics but would benefit from better presentation. Some variables are undefined in some equations e.g. the expectation distributions are underspecified in equation 1, $a'$ in equation 3, $T$ in equation 4.\n- Citations don\u2019t include the journal/proceedings details which makes it hard to identify which version of a paper was used in some cases.\n\n[2] Fu, Justin, et al. \"D4rl: Datasets for deep data-driven reinforcement learning.\" arXiv preprint arXiv:2004.07219 (2020)."
            },
            "questions": {
                "value": "*(update: all the questions below have been addressed by the authors.)*\n\n**Major:**\n\n- Can the authors point to the specifications of the Reacher2d environment they used? The Reacher I\u2019m familiar with[2] would not be considered a sparse-reward environment. This would also help to confirm the expert score.\nIt would also help to have the score of the policy that generated the medium dataset.\n- Can the authors indicate which Atari offline datasets they have used? D4RL does not seem to provide Atari datasets in its original version.\n- How much hyperparameter tuning has been spent on the value of the language loss hyperparameter and the fraction of parameters to train with LoRA?\n- Are the hyperparameters in Appendix E, used with all transformers in the paper? (LoMa, Wiki-RL, DT)?\n- Do the transformers and non-transformers used in the paper have a comparable number of parameters to ensure a fair comparison of performance?\n\n**Minor:**\n- Figure 6(a): why do the curves not start from the same point at training step 0? How can the authors explain that the cross-entropy loss decreases significantly for an already pre-trained model (red curve)? and also eventually decreases for the ablation (blue curve)\n\n[3] https://gymnasium.farama.org/environments/mujoco/reacher/"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "8: accept, good paper"
            },
            "confidence": {
                "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
            },
            "code_of_conduct": {
                "value": "Yes"
            },
            "first_time_reviewer": {
                "value": "Yes",
                "readers": [
                    "ICLR.cc/2024/Conference/Program_Chairs",
                    "ICLR.cc/2024/Conference/Submission5414/Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission5414/Reviewer_GHKm",
                    "ICLR.cc/2024/Conference/Submission5414/Senior_Area_Chairs"
                ]
            }
        },
        "number": 4,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission5414/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698858462852,
        "cdate": 1698858462852,
        "tmdate": 1700642153338,
        "mdate": 1700642153338,
        "license": "CC BY 4.0",
        "version": 2
    }
]