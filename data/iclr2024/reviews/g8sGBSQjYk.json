[
    {
        "id": "djuIB2tkAb",
        "forum": "g8sGBSQjYk",
        "replyto": "g8sGBSQjYk",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission4603/Reviewer_SW4H"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission4603/Reviewer_SW4H"
        ],
        "content": {
            "summary": {
                "value": "This paper considers finding the optimal hyperparameters for two second-order methods KFAC and Shampoo when training a neural network with a large width or when the width is infinite. These hyperparameters include the learning rate and the initialization hyperparameters. This optimal setting could help the network to learn features in a stable manner. This work is built upon the previous works that find the optimal setting for the first-order optimization methods."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "3 good"
            },
            "contribution": {
                "value": "3 good"
            },
            "strengths": {
                "value": "Analyzing the optimal hyper-parameters for the second-order methods is provided in this work for the first time. Empirically they show that their suggested values for the hyperparameters help to find useful features when they increase the width of the layers i.e. their experimental results confirm their theoretical analysis. As a side contribution, they show that for a specific parameter setting KFAC has an implicit bias toward NNGP."
            },
            "weaknesses": {
                "value": "The paper mentions some conditions for the stable feature learning that comes from the previous works. However, I think it needs more context for a reader who is not aware of previous work. \nIn the experiments, for example in Table 3, there isn\u2019t any standard deviation next to the accuracies."
            },
            "questions": {
                "value": "I was wondering if we change the layer width for different layers what part of your analysis would change?"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "6: marginally above the acceptance threshold"
            },
            "confidence": {
                "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        },
        "number": 1,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission4603/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698720043136,
        "cdate": 1698720043136,
        "tmdate": 1699636439147,
        "mdate": 1699636439147,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "QmBTAYoUF3",
        "forum": "g8sGBSQjYk",
        "replyto": "g8sGBSQjYk",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission4603/Reviewer_Xrk9"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission4603/Reviewer_Xrk9"
        ],
        "content": {
            "summary": {
                "value": "This paper is a continuation of [1] in the context of second-order optimization. The initial idea consists in tuning simultaneously several hyperparameters (HPs) related to neural network (NN) training based on the following heuristic: after one training step, the pre-activations of each layer should have made a move of order $1$. More specifically, this heuristic should hold when the number of neurons of each layer tends to infinity. In order-$1$ optimization, the HPs include: variance of the initialization distribution of the weights, scaling of the weights, scaling of the learning rate. In the present work, the authors propose to tune the HPs specific to order-$2$ optimization, such as the damping parameters.\n\nIn practice, the authors focus on two order-$2$ optimization techniques (K-FAC and Shampoo), and test experimentally their heuristic with multilayer perceptrons (MLPs), convolutional NNs (CNNs) and ResNets. The authors find out that their method leads to better test losses, especially for NNs with very large layers. Moreover, one choice of learning rate seems to lead to results stable w.r.t. the size of the layers.\n\n[1] *Tensor programs IV: Feature learning in infinite-width neural networks*, Yang and Hu, 2021.\n\n=== Edit ===\nI acknowledge the other reviews and the authors' answers. I keep my rating (8: Accept)."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "3 good"
            },
            "contribution": {
                "value": "3 good"
            },
            "strengths": {
                "value": "## Originality\n\nGeneralizing the heuristic of [1] to second order methods is new.\n\n## Clarity\n\nOverall, the paper is clear for a reader who is already aware of the works of Greg Yang (see [1]). \n\n## Quality\n\n* This work is technically correct.\n* The initial heuristic is tested (Fig. 1): $\\Delta h$ behaves as expected when using $\\mu \\mathrm{P}$.\n* In order to compare fairly $\\mu \\mathrm{P}$ with SP, the authors have performed a sanity check (Fig. 5): the results are stable for a wide range of learning rates.\n* The experiments show that $\\mu \\mathrm{P}$ is better than SP, especially when the number of neurons per layer tends to infinity. This result was expected and is explained by the \"infinite width limit assumption\"."
            },
            "weaknesses": {
                "value": "## Section 5.2 and Figure 6\n\nThere is a mix of lack of clarity and unconvincing results in this section.\n\nFirst, the authors claim in Section 5.2 that $\\mu \\mathrm{P}$ allows better \"transfer\" of learning rate than SP. The term \"transfer\" is not so clear to me, but apparently, it means that the optimal learning is stable by width change. But, when looking at Figure 6, this is barely true: actually, the transfer is better with K-FAC SP than with $\\mu \\mathrm{P}$ in the MLP case. \n\nSecond, in the legend of Figure 6, the authors claim something else: according to the context, \"transferring the learning rate\" means that, with a fixed l.r., the results get better and better as the width of the layers increases. This claim is more convincing, but differs substantially from the claim provided in Section 5.2. \n\n## Significance\n\nThe narrowness of the focus on K-FAC and Shampoo is a limitation of this work. What do the authors think about Newton, Gauss-Newton and generalized Gauss-Newton? \n\nBesides, the results presented in Table 1 are somewhat disappointing: basically, the usual NTK scaling corresponds to $\\mu \\mathrm{P}$ for all the hidden weights, in all the settings (SGD, Shampoo, K-FAC). The only difference lies in the input and output weights. Naturally, the authors cannot do anything about that."
            },
            "questions": {
                "value": "What do the authors think about apply $\\mu \\mathrm{P}$ to other second order methods, such as Newton, Gauss-Newton and generalized Gauss-Newton? \n\nCould the authors clarify the meaning of \"transferring the learning rate\" in Section 5.2 and in Figure 6, and clarify the claims of the corresponding paragraphs?"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "8: accept, good paper"
            },
            "confidence": {
                "value": "5: You are absolutely certain about your assessment. You are very familiar with the related work and checked the math/other details carefully."
            },
            "code_of_conduct": {
                "value": "Yes"
            },
            "first_time_reviewer": {
                "readers": [
                    "ICLR.cc/2024/Conference/Program_Chairs",
                    "ICLR.cc/2024/Conference/Submission4603/Senior_Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission4603/Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission4603/Reviewer_Xrk9"
                ]
            }
        },
        "number": 2,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission4603/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698937675416,
        "cdate": 1698937675416,
        "tmdate": 1700646380812,
        "mdate": 1700646380812,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "408mNLqdTJ",
        "forum": "g8sGBSQjYk",
        "replyto": "g8sGBSQjYk",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission4603/Reviewer_ZUFF"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission4603/Reviewer_ZUFF"
        ],
        "content": {
            "summary": {
                "value": "The authors derive scaling laws for two second-order optimization methods (K-FAC (Martens & Grosse, 2015) and Shampoo (Gupta et al, 2018)), based on the muP approach from (Yang & Hu, 2021). This approach has previously been used for first-order methods, including with momentum. It is used to determine how the weight initialization and per-layer learning rate for deep neural networks should scale based on layer width. This allows 'parameter transfer', where good hyperparameters can be trained on small networks and suitably scaled up for wider networks. The derived scalings are successfully tested on some simple example problems."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "3 good"
            },
            "contribution": {
                "value": "3 good"
            },
            "strengths": {
                "value": "This is a new application of the muP framework to a useful class of methods. I think the new scaling laws are useful and beneficial to the community. The authors apply a successful approach for deriving scaling laws to the case of specific second-order networks. The results are clearly stated and yield new insights into the merit of existing choices of damping parameter for K-FAC, and the use of zero initial weights for the last layer. The paper is reasonably clearly written and the presented experiments thorough."
            },
            "weaknesses": {
                "value": "I found the mathematical presentation fairly informal, both in terms of the exposition of the approach (Prop 4.1 has \"the optimization becomes valid for...\", for example) and the actual derivation in Appendix A. This is a presentational comment, not a critique of the correctness of the work. \n\nTheory is only given for least-squares losses, although the numerics suggest the results hold for other losses. If the authors could derive these laws - and Appendix A seems to suggest it might not be a huge piece of work - this would help the paper. \n\nWhile the empirical results show merit, their real benefit would only be clear if applied for larger-scale networks than those tested. I understand the practical issues around doing this and recognize that it isn't feasible for all researchers, but those results would strengthen the paper.\n\n=========== AFTER REBUTTAL ===========\nThe new sections on layer-wise Gauss-Newton and extension to other loss functions are helpful here. I would suggest the authors mention the Gauss-Newton work somewhere in the main text (just like they did for the alternative loss functions), as I couldn't see clear reference to this extra contribution."
            },
            "questions": {
                "value": "To me, it appears that the extent of the theoretical contribution is not huge (largely based on combining existing methods), and I take the main benefit of the paper to be the actual derived scaling laws (i.e. choices of $a$, $b$, $c$, etc) rather than the overall approach/techniques.  Does this work introduce any new theoretical results/mathematical techniques of wider interest/applicability, or is the theoretical approach quite restricted to the specific methods being considered?\n\n=========== AFTER REBUTTAL ===========\nThe new version of the work includes a mild strengthening of the mathematical formatlity in Appendix A, plus new results deriving scaling laws for layer-wise Gauss-Newton and other loss functions such as cross-entropy. This I think improves the paper by showing that their adaptation of muP to second-order methods yields a systematic approach rather than needing ad-hoc approaches, giving it wider interest."
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "8: accept, good paper"
            },
            "confidence": {
                "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
            },
            "code_of_conduct": {
                "value": "Yes"
            },
            "first_time_reviewer": {
                "value": "Yes",
                "readers": [
                    "ICLR.cc/2024/Conference/Program_Chairs",
                    "ICLR.cc/2024/Conference/Submission4603/Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission4603/Reviewer_ZUFF",
                    "ICLR.cc/2024/Conference/Submission4603/Senior_Area_Chairs"
                ]
            }
        },
        "number": 3,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission4603/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1699329269654,
        "cdate": 1699329269654,
        "tmdate": 1700630651730,
        "mdate": 1700630651730,
        "license": "CC BY 4.0",
        "version": 2
    }
]