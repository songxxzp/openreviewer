[
    {
        "id": "7ZEetWWr0p",
        "forum": "1XDG1Z5Nhk",
        "replyto": "1XDG1Z5Nhk",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission4184/Reviewer_yUXn"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission4184/Reviewer_yUXn"
        ],
        "content": {
            "summary": {
                "value": "This work investigates the problem non-differentiable of the expert selection, which is relevant in today Sparse Mixture of Experts (SMoE) implementations. Motivated from ODE methods, the proposed method, SparseMixer, derives a mid-point method to approximate the gradient with neglectable overhead. Experiments on pre-training, finetuning, and machine translation show that SparseMixer consistently outperforms SwitchTransformer and Dense training."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "3 good"
            },
            "contribution": {
                "value": "2 fair"
            },
            "strengths": {
                "value": "- SMoE has shown to be a promising direction to massively scale transformer models. This works investigates the non-differentiable problem of selection experts, which is at heart of existing SMoE strategies. \n- The proposed method is sound.\n- The empirical results are encouraging where SparseMixer consistently outperforms SwitchTransformer with neglectable overhead."
            },
            "weaknesses": {
                "value": "## Major concern - limited broad impact\nAlthough the method is sound, it seems to be only applicable to the case of choosing only $1$ expert per layer. However, most modern architecture employ a TopK function that choose $k=2$ experts, which has shown to achieve better results, e.g.[A]. Thus, despite the encouraging results, it may not bring immediate impact.\n\n## Major concern - contribution of $\\omega$-scaling\n$\\omega$-scaling essentially makes the network deeper, thus using it improves the performance is easy to understand. However, it also makes comparing with SwitchTransformer to be unfair because of the additional trainable parameters. How would SwitchTransformer+$\\omega$-scaling performs against SparseMixer?\n\n## Major concern - complexity analysis\nI found the results in Table 3 to be questionable where SwitchTranformer and SparseMixer have identically average training costs. However, SparseMixer introduces several components such as $\\omega$-scaling, computing the gradient $\\nabla_0$, all of which contribute to the forward and backward computation. Thus, I think reporting the **total** training is more accurate to understand the overhead of SparseMixer.\n\n## Minor concern - limited baselines\nThe number of baselines considered is quite limited. The authors also considered a simple naive Transformer architecture. Other advanced architecture such as GLAM [A] and other SMoE strategies such as XMoE [B] should be included to make the experiment more comprehensive.\n\n## Minor concern - presentation\n- I suggest the author to replace \"MoE\" to \"SMoE\" as MoE usually refers to using all experts. This work consider the selecting only 1 expert, thus adding the \"sparse\" keyword would make the presentation clearer. \n- Best results are not highlighted in Table 2. \n\n[A] Du, Nan, et al. \"Glam: Efficient scaling of language models with mixture-of-experts.\" International Conference on Machine Learning. PMLR, 2022.\n\n[B] Chi, Zewen, et al. \"On the representation collapse of sparse mixture of experts.\" Advances in Neural Information Processing Systems 35 (2022): 34600-34613."
            },
            "questions": {
                "value": "- Can SparseMixer be extended to $k>1$ easily?\n- Please clarify the empirical contribution of $\\omega$-scaling, i.e. comparing SparseMixer without $\\omega$-scaling with SwitchTransformer **OR** SparseMixer with SwitchTransformer + $\\omega$-scaling.\n- Please clarify the overhead in SparseMixer in Table 3 and report the total training time."
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "3: reject, not good enough"
            },
            "confidence": {
                "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
            },
            "code_of_conduct": {
                "value": "Yes"
            },
            "first_time_reviewer": {
                "value": "Yes",
                "readers": [
                    "ICLR.cc/2024/Conference/Program_Chairs",
                    "ICLR.cc/2024/Conference/Submission4184/Senior_Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission4184/Area_Chairs",
                    "ICLR.cc/2024/Conference/Submission4184/Reviewer_yUXn"
                ]
            }
        },
        "number": 1,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission4184/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698675634754,
        "cdate": 1698675634754,
        "tmdate": 1699636384492,
        "mdate": 1699636384492,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "OAVdFfhefE",
        "forum": "1XDG1Z5Nhk",
        "replyto": "1XDG1Z5Nhk",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission4184/Reviewer_tyBo"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission4184/Reviewer_tyBo"
        ],
        "content": {
            "summary": {
                "value": "This paper proposes SparseMixer to move beyond discrete and bridge the gap between sparse MoE routing and backpropagation. SparseMixer utilizes a second-order ODE solver to deliver precise gradient approximations. Their experiments show SparseMixer not only accelerates training convergence by up to two times but also facilitates MoE with properly trained expert routing."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "2 fair"
            },
            "contribution": {
                "value": "2 fair"
            },
            "strengths": {
                "value": "1. The pre-training of LLMs is costly, and MoE is one promising sparse training method to reduce the training overhead. The paper makes some contributions to improving the backpropagation of MoE Training.\n\n2. The experiment results show the effectiveness of the proposed methods on a specific model."
            },
            "weaknesses": {
                "value": "My concern includes two aspects:\n\n1. The experiment is kind of weak since there are also some other MoE architecture and other base models, while the authors only focus on Switch. Currently, the author only focuses on a simplified setting of the switch Transformer layer (Fedus et al., 2021). However, there are also other popular MoE architectures, e.g. (Shazeer et al., 2017; Lepikhin et al., 2020; Lewis et al., 2021) as mentioned in the paper, and (Yanqi et al., 2022; Nan et al., 2022) in the following.\n\nZhou, Yanqi, Tao Lei, Hanxiao Liu, Nan Du, Yanping Huang, Vincent Zhao, Andrew M. Dai, Quoc V. Le, and James Laudon. \"Mixture-of-experts with expert choice routing.\" Advances in Neural Information Processing Systems 35 (2022): 7103-7114. Du, Nan, Yanping Huang, \n\nAndrew M. Dai, Simon Tong, Dmitry Lepikhin, Yuanzhong Xu, Maxim Krikun et al. \"Glam: Efficient scaling of language models with mixture-of-experts.\" In International Conference on Machine Learning, pp. 5547-5569. PMLR, 2022.\n\n2. The writing of Section 3 is too fragmented and can be improved a lot. I would recommend authors to enrich Sections 3.2 and 3.2, since currently, they read like an experiment report with step-by-step procedures, instead of a well-written technical paper with good motivation and intuition of the proposed techniques."
            },
            "questions": {
                "value": "1. Can the authors explicitly present the physical running time? The results in the experiment section do not give a clear comparison.\n\n2. What is the experiment platform, e.g. torch version or GPU model?"
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "6: marginally above the acceptance threshold"
            },
            "confidence": {
                "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        },
        "number": 2,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission4184/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698759671237,
        "cdate": 1698759671237,
        "tmdate": 1699636384403,
        "mdate": 1699636384403,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "9Obodj9J6a",
        "forum": "1XDG1Z5Nhk",
        "replyto": "1XDG1Z5Nhk",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission4184/Reviewer_D3YK"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission4184/Reviewer_D3YK"
        ],
        "content": {
            "summary": {
                "value": "The paper presents SparseMixer, a scalable gradient estimator that bridges the gap between backpropagation and sparse expert routing.  In specific, the paper presents SparseMixer to provide scalable gradient approximations for the gradients terms that are not taken into account, enabling reliable gradient estimation in MoE training. The authors demonstrate SparseMixer to Switch Transformer on both pre-training and machine translation tasks, with the claim of considerable performance gain, accelerating training convergence by up to 2 times."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "3 good"
            },
            "contribution": {
                "value": "3 good"
            },
            "strengths": {
                "value": "1. The idea of improving gradient computation at scale to improve MoE training is novel to me.\n\n2.The paper consistently demonstrate the impact of neglecting $\\Delta_0$ in the pre-training with MoE.\n\n3. The paper is written well and the results back up the improvement."
            },
            "weaknesses": {
                "value": "1. Straight-Through (ST) -- > straight through estimator (STE) ? \n\n2. Please define ODE first in the abstract before using the abbr.\n\n3. Please introduce definitions of $\\Delta_0$ and $\\Delta_1$.\n\n4. It is not quite clear why the training speed improves.\n\n5. Please demonstrate results with other MoE gating methods. as few of them tried to improve MoE training."
            },
            "questions": {
                "value": "Please see weakness."
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "rating": {
                "value": "5: marginally below the acceptance threshold"
            },
            "confidence": {
                "value": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked."
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        },
        "number": 3,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission4184/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698768034868,
        "cdate": 1698768034868,
        "tmdate": 1699636384333,
        "mdate": 1699636384333,
        "license": "CC BY 4.0",
        "version": 2
    },
    {
        "id": "CiRkoiJCgs",
        "forum": "1XDG1Z5Nhk",
        "replyto": "1XDG1Z5Nhk",
        "signatures": [
            "ICLR.cc/2024/Conference/Submission4184/Reviewer_4GtZ"
        ],
        "nonreaders": [],
        "readers": [
            "everyone"
        ],
        "writers": [
            "ICLR.cc/2024/Conference",
            "ICLR.cc/2024/Conference/Submission4184/Reviewer_4GtZ"
        ],
        "content": {
            "summary": {
                "value": "This paper attempts to address the backpropagation issue of Mixture of Experts (MoE). There is a growing interest in sparsely activated networks, specifically Mixture-of-Experts (MoE), which selectively activate parts of modules for specific inputs, leading to efficiency improvements. However, gradient estimation in MoE is challenging due to the non-differentiable nature of expert routing. Existing methods like Straight-Through (ST) estimators are not compatible with MoE, which leads to the neglect of gradient computation for routing during training, impacting convergence and model quality. The paper introduces SparseMixer, a novel approach that reconciles sparse MoE routing and backpropagation using numerical methods for ordinary differential equations. SparseMixer provides reliable gradient approximations even with a subset of experts activated and accelerates training convergence by up to two times. It also enables MoE models to consistently outperform dense models when used with Switch Transformer."
            },
            "soundness": {
                "value": "3 good"
            },
            "presentation": {
                "value": "3 good"
            },
            "contribution": {
                "value": "2 fair"
            },
            "strengths": {
                "value": "(1) This paper discusses an very important research question in MoE, the backpropoagation issue of routing function, which is easily be overlooked by researchers if not be pointed out specifically. This research question is timely and important. \n\n(2)  The first order approximation used in this paper only requires the output of one expert, not sacrificing scalability.\n\n(3) SparseMixer does not require hessian or other second-order derivatives, having negligible computation overheads."
            },
            "weaknesses": {
                "value": "(1) While SparseMixer achieves consistently improvement over the vanilla Switch Transformer, what I can see is the improvement is a bit marginal in Table1. Esp. as the number of experts increases, the performance gains become more marginal. My conjecture is that the main evaluation task in the paper, GLUE, is two simple to demonstrate the empirical benefits of SparseMixer. I would like to see more results on more challenging tasks, where the performance gains of S+S might be larger. \n\n(2) The marginal performance improvement is also contradictory to the authors' motivation. If the neglect of the gradient computation for\nrouting is indeed crucial for MoE, we should see much significant improvements. \n\n(3) What is the cost induced by SparseMixer? Table 3 does not provide enough information to justify the overheads. Can we see any time difference as the number of experts continues to increase?"
            },
            "questions": {
                "value": "Please see the above Weaknesses."
            },
            "flag_for_ethics_review": {
                "value": [
                    "No ethics review needed."
                ]
            },
            "details_of_ethics_concerns": {
                "value": "n/a"
            },
            "rating": {
                "value": "5: marginally below the acceptance threshold"
            },
            "confidence": {
                "value": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work."
            },
            "code_of_conduct": {
                "value": "Yes"
            }
        },
        "number": 4,
        "invitations": [
            "ICLR.cc/2024/Conference/Submission4184/-/Official_Review",
            "ICLR.cc/2024/Conference/-/Edit"
        ],
        "domain": "ICLR.cc/2024/Conference",
        "tcdate": 1698947665570,
        "cdate": 1698947665570,
        "tmdate": 1699636384264,
        "mdate": 1699636384264,
        "license": "CC BY 4.0",
        "version": 2
    }
]