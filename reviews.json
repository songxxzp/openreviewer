[
    {
        "id": "MXV1TACjo_",
        "original": null,
        "number": 1,
        "cdate": 1666251648361,
        "mdate": null,
        "ddate": null,
        "tcdate": 1666251648361,
        "tmdate": 1669196188530,
        "tddate": null,
        "forum": "zzqBoIFOQ1",
        "replyto": "zzqBoIFOQ1",
        "invitation": "ICLR.cc/2023/Conference/Paper3283/-/Official_Review",
        "content": {
            "confidence": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work.",
            "summary_of_the_paper": "This paper deals with safe exploration in reinforcement learning in which an agent is required to ensure safety during training. The authors present a neuro-symbolic approach called SPICE. based on symbolic weakest preconditions. Empirically, they evaluate their approach on toy benchmarks, and show that it is able to achieve comparable performance to existing safe learning techniques while incurring fewer safety violations. ",
            "strength_and_weaknesses": "### Strength\n- Interesting and importance problem formulation on safe exploration.\n- Unique approach for safe exploration. As far as I know, there is no existing method using weakest precondition.\n\n### Weakness\n- Though the number and quality of baselines looks sufficient to me, benchmark problem is very easy. I think the authors should have tested their method in MuJoCo or SafetyGym benchmarks. The proposed method depends on environment approximation; hence, it is particularly important to know whether it is applicable to non-linear complicated system (I think even negative results are ok, and it is significant to know the limitations).\n- Low applicability to real problems. As the authors discuss the experimental results in the first paragraph on page 8, the proposed method works better than baselines when the environment can be approximated with linear equations. I think this is a huge limitation of the proposed method. I personally recommend the authors to connect this work with Linear MDP (https://arxiv.org/pdf/1907.05388.pdf), which would provide much richer theoretical results and good empirical results under the assumption of feature mapping functions.\n\n### Questions\n- How did the author choose weakest preconditions for each experiments? Is it possible to decrease the constraints violation while tuning the parameter of the weakest preconditions?\n\n### Other comments\n- The equation in Section 2 should be rewritten\n    - (Section 2) $\\text{Safe}(\\pi)$ is not defined.\n    - Is $P_{x\u223cS{_{\\pi_i}}}(x \\in S_U ) < \\delta$ really what the authors want to represent? I think the probability of an agent's trajectory being safe is $(1-\\delta)^N$ when the length of episode is $N$. I guess the authors should have represented in other equations.",
            "clarity,_quality,_novelty_and_reproducibility": "### Clarity\nThis paper is mostly well-written and easy to follow.\n\n### Quality\nI have several concerns regarding the quality of experiments and method itself. Especially, I am not fully convinced whether this proposed method is really useful or not.\n\n### Novelty\nAs far as I know, the proposed approach using weakest precondition is new.\n\n### Reproducibility\nThe source-doe is attached, and reproducibility is high.",
            "summary_of_the_review": "Though this paper presents a new, promising method for an interesting problems, there are several issues and concerns about the applicability and empirical evaluations. Hence, I recommend rejection for now.",
            "correctness": "2: Several of the paper\u2019s claims are incorrect or not well-supported.",
            "technical_novelty_and_significance": "3: The contributions are significant and somewhat new. Aspects of the contributions exist in prior work.",
            "empirical_novelty_and_significance": "2: The contributions are only marginally significant or novel.",
            "flag_for_ethics_review": [
                "NO."
            ],
            "recommendation": "6: marginally above the acceptance threshold"
        },
        "signatures": [
            "ICLR.cc/2023/Conference/Paper3283/Reviewer_aN3N"
        ],
        "readers": [
            "everyone"
        ],
        "nonreaders": [],
        "writers": [
            "ICLR.cc/2023/Conference",
            "ICLR.cc/2023/Conference/Paper3283/Reviewer_aN3N"
        ]
    },
    {
        "id": "AQTBBXOc898",
        "original": null,
        "number": 2,
        "cdate": 1666651351449,
        "mdate": null,
        "ddate": null,
        "tcdate": 1666651351449,
        "tmdate": 1666651351449,
        "tddate": null,
        "forum": "zzqBoIFOQ1",
        "replyto": "zzqBoIFOQ1",
        "invitation": "ICLR.cc/2023/Conference/Paper3283/-/Official_Review",
        "content": {
            "confidence": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked.",
            "summary_of_the_paper": "This paper adapts ideas from formal program analysis, i.e. weakest preconditions, to the constrained  reinforcement learning. Here an emphasis is made for (i) working in an a-priori unknown MDP and (ii) minimizing constraint violations during deployment *and* training. \n\nThe key idea is to alternate (i) shielded exploration (ii) system identification/ model learning and (iii) computing a new avoid predicate for the shield. Again, this is done by adapting a classic idea from program analysis (called weakest preconditions) where one tries to identify the largest set such of inputs (the precondition) that guarantees the property (here not violating the constraint) is satisfied.\n\nTechnically, this by linearizing the learned model and learning a (union) of precondition polyhedra. These polyhedra are then used to project the actions proposed by the learned control policy to a safe action (according the learned model).\n\nEmpirically this seems to be very effective and future extensions are proposed (using non-linear models) that would likely yield unambigously state-of-the-art performance.",
            "strength_and_weaknesses": "# Strengths\n\nThe technique is well motivated and a good proof of concept regarding combining model based safety analysis with model free RL. There is a clear path towards having robust theoretical guarantees (see weaknesses below) and a there is a literature of techniques on abstract interpretation that are likely to improve the representations of the preconditions.\n\n# Weaknesses\n\n1. Some of the assumptions in the theorems seems difficult to realize. In particular, because the learned safety shield biases the exploration, it seems difficult to assert that the final model will always achieve a given PAC bound. Perhaps I am missing something.\n\n2. The analysis is done using a linearization of the model. This limits the class of models for which the shield can accurately forecast safety. This is acknowledged in the paper and the proposed directions for mitigation seem reasonable.\n\n3. Missing from the related work seems to the literature on abstract interpretation that (from my outsider knowledge) offers a similar promise of learning pre-conditions for safety. Since the preconditions considered in this work are (under?) approximations for the learned model, it seems good to compare.",
            "clarity,_quality,_novelty_and_reproducibility": "The technique and motivation are clearly communicated and the algorithm is (to my knowledge) distinct from other shielding techniques. While the individual building blocks are well established, this seems to be a novel application well worth studying.",
            "summary_of_the_review": "The paper contributes a novel algorithm for creating safety shields during the training of RL-agents. It provides a nice demonstration of the power of alternating model learning and state-of-the-art RL techniques for safe RL. In particular, the paper highlights how model learning in this setting need only deal with qualitative semantics (i.e., is it possible to reach state s) and can let the RL algorithm handle the quantitative optimizations.",
            "correctness": "4: All of the claims and statements are well-supported and correct.",
            "technical_novelty_and_significance": "3: The contributions are significant and somewhat new. Aspects of the contributions exist in prior work.",
            "empirical_novelty_and_significance": "3: The contributions are significant and somewhat new. Aspects of the contributions exist in prior work.",
            "flag_for_ethics_review": [
                "NO."
            ],
            "recommendation": "8: accept, good paper"
        },
        "signatures": [
            "ICLR.cc/2023/Conference/Paper3283/Reviewer_PYp3"
        ],
        "readers": [
            "everyone"
        ],
        "nonreaders": [],
        "writers": [
            "ICLR.cc/2023/Conference",
            "ICLR.cc/2023/Conference/Paper3283/Reviewer_PYp3"
        ]
    },
    {
        "id": "aib0K4Qbbj",
        "original": null,
        "number": 3,
        "cdate": 1666735486524,
        "mdate": null,
        "ddate": null,
        "tcdate": 1666735486524,
        "tmdate": 1666735486524,
        "tddate": null,
        "forum": "zzqBoIFOQ1",
        "replyto": "zzqBoIFOQ1",
        "invitation": "ICLR.cc/2023/Conference/Paper3283/-/Official_Review",
        "content": {
            "confidence": "3: You are fairly confident in your assessment. It is possible that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work. Math/other details were not carefully checked.",
            "summary_of_the_paper": "The paper proposes a method for safe reinforcement learning whereby it uses a\nlearnt environment to not only optimise policies but also to improve safe\nexploration. Concretely, this is realised by taking a linear approximation of\nthe environment, which in conjunction with the safety specification gives\nlinear constraints (called weakest preconditions in the paper) on the actions\nthat are safe to be performed.",
            "strength_and_weaknesses": "+ The approach reduces the number of safety violations during training when\ncompared with the state-of-the-art in the area.\n\n- Somewhat straightforward and incremental: straightforward in that it relies\n  on linear approximations of the environment and incremental in that the\n  contribution is limited to the derivation of safety predicates within a\n  previously studied framework.",
            "clarity,_quality,_novelty_and_reproducibility": "The paper is overall well written and presented. The contribution includes some\nnovel aspects pertaining to the computation of the weakest preconditions. The\nsignificance of the overall method is adequately evaluated.",
            "summary_of_the_review": "The paper builds on previous work on safe reinforcement learning  to derive a\nmethod which although makes strong, linearity assumptions on the environment is\nable to outperform the state-of-the-art in terms of the number of safety\nviolations during training.",
            "correctness": "4: All of the claims and statements are well-supported and correct.",
            "technical_novelty_and_significance": "3: The contributions are significant and somewhat new. Aspects of the contributions exist in prior work.",
            "empirical_novelty_and_significance": "2: The contributions are only marginally significant or novel.",
            "flag_for_ethics_review": [
                "NO."
            ],
            "recommendation": "6: marginally above the acceptance threshold"
        },
        "signatures": [
            "ICLR.cc/2023/Conference/Paper3283/Reviewer_HV3z"
        ],
        "readers": [
            "everyone"
        ],
        "nonreaders": [],
        "writers": [
            "ICLR.cc/2023/Conference",
            "ICLR.cc/2023/Conference/Paper3283/Reviewer_HV3z"
        ]
    },
    {
        "id": "d3-kXa-Agu",
        "original": null,
        "number": 4,
        "cdate": 1667459319188,
        "mdate": null,
        "ddate": null,
        "tcdate": 1667459319188,
        "tmdate": 1670985996556,
        "tddate": null,
        "forum": "zzqBoIFOQ1",
        "replyto": "zzqBoIFOQ1",
        "invitation": "ICLR.cc/2023/Conference/Paper3283/-/Official_Review",
        "content": {
            "confidence": "4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work.",
            "summary_of_the_paper": "The paper proposes a safe RL algorithm, Symbolic Preconditions for Constrained Exploration (SPICE), that uses a model-based shielding mechanism to produce safe actions. A linearization of the model and polyhedral state constraints are used to determine which actions are safe, and then the proposed action is projected onto the space of safe actions. The paper provides a regret bound for the algorithm and demonstrates that SPICE can attain fewer safety violations during training than model-free baselines.",
            "strength_and_weaknesses": "Strengths:\n* SPICE\u2019s use of formal methods provides strong safety guarantees if the assumptions hold. This is very desirable in safety critical applications.\n* In experiments, SPICE substantially reduces the number of violations substantially compared to CPO and CSC.\n\nWeaknesses:\n* A footnote states \"We use a modified version of our approach instead of comparing to Bharadhwaj et al. (2021) directly because the code for that paper is unavailable.\" While this is reasonable, the present paper does not provide a description of your modifications. It is difficult for the reader to compare the performance of SPICE vs. \u201cCSC\u201d without knowing exactly what \u201cCSC\u201d means.\n* From Figure 3, the variance of the policy\u2019s performance appears extremely high for both SPICE and CSC. The plots in the CSC paper look much less noisy. This raises questions about the quality of the implementation.\n* SPICE converges to a suboptimal policy (worse than CPO) in many cases.\n* The experiments do not compare to any other model-based safe RL algorithms.\n* Linearization of the model may limit what types of problems SPICE can solve effectively.",
            "clarity,_quality,_novelty_and_reproducibility": "The paper is generally clear. I appreciate the use of examples to demonstrate the approach.\nHowever, the statement of theorem 2 should be improved:\n* Some of the symbols that appear in the regret bound are only defined in the appendix ($L_R$, $\\sigma$) or in the following text ($\\zeta$).\n* To be precise, $\\epsilon_m$ and $\\epsilon_\\pi$ are upper bounds on the divergences that hold for all $T$. (This is stated in the appendix, but not in the main text.) The actual divergences are changing throughout training as the model and policy are updated.\n\nThe proposed approach is novel, to my knowledge.\n\nRegarding reproducibility, the lack of details regarding the CSC implementation is a significant concern.\n\nThe paper is missing some relevant references to model-based safe RL papers, such as\n* Safe Reinforcement Learning Using Robust MPC. M. Zanon, S. Gros\n* Safe Reinforcement Learning by Imagining the Near Future. G. Thomas, Y. Luo, T. Ma\n",
            "summary_of_the_review": "I like the proposed approach and its associated guarantees. My main issues are in the experiments, as detailed above. The state of the experiments makes it hard to recommend acceptance in the paper\u2019s current form, in spite of other positive attributes of the paper.",
            "correctness": "4: All of the claims and statements are well-supported and correct.",
            "technical_novelty_and_significance": "3: The contributions are significant and somewhat new. Aspects of the contributions exist in prior work.",
            "empirical_novelty_and_significance": "2: The contributions are only marginally significant or novel.",
            "flag_for_ethics_review": [
                "NO."
            ],
            "recommendation": "6: marginally above the acceptance threshold"
        },
        "signatures": [
            "ICLR.cc/2023/Conference/Paper3283/Reviewer_euEh"
        ],
        "readers": [
            "everyone"
        ],
        "nonreaders": [],
        "writers": [
            "ICLR.cc/2023/Conference",
            "ICLR.cc/2023/Conference/Paper3283/Reviewer_euEh"
        ]
    }
]